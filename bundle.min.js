(function(){function l(s,e,r){function t(d,i){if(!e[d]){if(!s[d]){var n="function"==typeof require&&require;if(!i&&n)return n(d,!0);if(o)return o(d,!0);var c=new Error("Cannot find module '"+d+"'");throw c.code="MODULE_NOT_FOUND",c}var a=e[d]={exports:{}};s[d][0].call(a.exports,function(e){var a=s[d][1][e];return t(a||e)},a,a.exports,l,s,e,r)}return e[d].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)t(r[a]);return t}return l})()({1:[function(e,t){function a(e){this.track_all_contacts=!0,this.state=void 0,this.body=e,this.interaction_callback=void 0,this.uuid=o(),this.location=void 0,this.home=void 0,this.cohorts=[],this.color=void 0,this.home_state={},this.migrating=!1}var o=e("uniqid");a.prototype.add_body=function(e){this.body=e},a.prototype.register_interaction_callback=function(e){this.interaction_callback=e},a.prototype.handle_agent_contact=function(e){this.interaction_callback(e)},t.exports=a},{uniqid:1332}],2:[function(e,t){function a(){this.members=[]}a.prototype.move_cohort=function(e,t){for(let a=0,o;a<this.members.length;a++)o=this.members[a],o.location.migrate_to(e,o,t)},a.prototype.send_cohort_home=function(e){for(let t=0,a;t<this.members.length;t++)a=this.members[t],a.location.migrate_to(a.home,a,e)},a.prototype.add_agent=function(e,t){this.members.push(e),e.cohorts.push(this),t&&t(e)},t.exports=a},{}],3:[function(e,t){function a(){this.fast_queue=new o(function(e,t){return e.time<t.time})}let o=e("fastpriorityqueue"),r=e("assert");a.prototype.add_event=function(e,t){r(t.time&&t.callback),t.original_time=t.time,t.time+=e,this.fast_queue.add(t)},a.prototype.run_events_fired=function(e,t){for(let o=0;this.fast_queue.peek()&&this.fast_queue.peek().time<e&&o<t;){var a=this.fast_queue.poll();a.recurring&&this.add_event(e,{time:a.original_time,callback:a.callback,recurring:!0}),a.callback(),o+=1}},a.prototype.clear_events=function(){this.fast_queue=null,this.fast_queue=new o(function(e,t){return e.time<t.time})},t.exports=a},{assert:1414,fastpriorityqueue:202}],4:[function(e,t){function a(e,t){return Math.random()*(t-e)+e}function o(e){return e[Math.floor(e.length*Math.random())]}function r(e){this.name=e,this.bounds=void 0,this.friction=.2,this.occupants=[],this.border_color=void 0}r.prototype.draw_borders=function(e,t){t=t&&this.border_color?t||this.border_color:"black";let a=this.bounds.max.x-this.bounds.min.x,o=this.bounds.max.y-this.bounds.min.y;e.beginPath(),e.rect(this.bounds.min.x-2,this.bounds.min.y-2,a+4,o+4),e.strokeStyle=t,e.lineWidth=2,e.stroke()},r.prototype.get_random_position=function(){return this.bounds?{x:a(this.bounds.min.x,this.bounds.max.x),y:a(this.bounds.min.y,this.bounds.max.y)}:{x:0,y:0}},r.prototype.remove_agent=function(e){this.occupants=this.occupants.filter(function(t){return t!==e}),e.location=void 0},r.prototype.set_bounds=function(e){this.bounds=e},r.prototype.migrate_to=function(e,t,a){this.remove_agent(t),e.add_agent(t),a&&a(t)},r.prototype.migrate_random_to=function(e,t){if(0<this.occupants.length){let a=o(this.occupants);this.migrate_to(e,a,t)}},r.prototype.add_agent=function(e){this.occupants.push(e),e.location=this},t.exports=r},{}],5:[function(e,t){var o=Math.max;function a(e,t,a,o,r){if(this.simulation_params=Matter.Common.extend(_,a),this.infection_params=Matter.Common.extend(b,o),this.simulation_colors=Matter.Common.extend(v,r),this.matter_world=y.create(),this.headless=t||!1,this.matter_engine=m.create({positionIterations:15,velocityIterations:15,constraintIterations:10}),this.matter_engine.world.gravity.y=0,this.event_queue=new p,!this.headless){let t=document.getElementById(e);this.matter_render=h.create({element:t,engine:this.matter_engine,options:{height:t.offsetHeight,width:t.offsetWidth,background:"rgba(229,229,229)",wireframes:!1}});var i=Mouse.create(this.matter_render.canvas);this.mouseConstraint=MouseConstraint.create(this.matter_engine,{mouse:i,constraint:{stiffness:.1,render:{visible:!0}}}),this.matter_render.mouse=i,y.add(this.matter_engine.world,this.mouseConstraint),h.run(this.matter_render),m.run(this.matter_engine)}}Matter=e("matter-js"),e("matter-wrap");var{MatterCollisionEvents:r}=e("matter-collision-events");Matter.use("matter-wrap",r);var{jStat:i}=e("jstat");Matter._seed=5,Math.random=Matter.Common.random,i._random_fn=Matter.Common.random;var n=e("assert");let l=e("vivagraphjs");var s=new l.Graph.graph,d=e("./location.js"),c=e("./cohort.js"),p=e("./event_queue.js"),u=e("./agent.js"),g={SUSCEPTIBLE:0,EXPOSED:1,A_INFECTED:2,S_INFECTED:3,RECOVERED:4,size:5},m=Matter.Engine,h=Matter.Render,y=Matter.World,f=Matter.Body,x=Matter.Bodies;Bounds=Matter.Bounds,Mouse=Matter.Mouse,MouseConstraint=Matter.MouseConstraint,Events=Matter.Events;var _={sim_time_per_day:2e3,agent_size:2,link_lifetime:4e3},b={per_contact_infection:.5,incubation_period_mu:5,incubation_period_sigma:3,infectious_period_mu:7,infectious_period_sigma:4,fraction_asymptomatic:.2,asymptomatic_infectious_period_mu:1.5,asymptomatic_infectious_period_sigma:1.5,fraction_seek_care:.5,fraction_isolate:.2,time_to_seek_care:2.5,movement_scale:.2},v={viva_colors:[2332068863,16711935,4294902015,4289003775,65535,2846468607,4278255615,13554175,2566625535,3448061951],matter_colors:["darkmagenta","lime","yellow","orange","blue","darkgrey","fuchsia","darkturquoise","palegreen","peru"]};a.prototype.run_headless=function(e){if(e=e||30,this.run_headless)for(let a=0;a<e*this.simulation_params.sim_time_per_day;a++){this.event_queue.run_events_fired(this.cur_sim_time,500);Matter.Common.choose(this.agents);m.update(this.matter_engine,1e3/60),this.cur_sim_time=this.matter_engine.timing.timestamp}},a.prototype.setup_matter_env=function(){s.clear(),this.locations=[],this.agents=[],this.cohorts=[],this.cur_sim_time=0,this.state_counts=[],this.matter_engine.timing.timestamp=0;for(let e=0;e<g.size;e++)this.state_counts.push(0);this.headless||(Events.on(this.mouseConstraint,"mousedown",()=>{this.mouseConstraint.body&&this.mouseConstraint.body.agent_object&&this.expose_org(this.mouseConstraint.body,g.S_INFECTED)}),Events.on(this.matter_render,"beforeRender",t=>{this.cur_sim_time=t.timestamp,this.event_queue.run_events_fired(this.cur_sim_time,500)}),Events.on(this.matter_render,"afterRender",()=>{let e=this.matter_render.context;if(e)for(let t=0;t<this.locations.length;t++)this.locations[t].draw_borders(e)})),this.add_event({time:100,callback:this.pulse_orgs_event(),recurring:!0})},a.prototype.update_org_state=function(e,t){let a=e.agent_object.state;e.agent_object.state=t,"undefined"!=typeof a&&(this.state_counts[a]-=1),this.state_counts[t]+=1,e.render.lineWidth=2;let o=e.render.strokeStyle,r;return t===g.EXPOSED?o="orange":t===g.S_INFECTED?(o="red",r=4278190335):t===g.A_INFECTED?(o="red",r=4278190335):t===g.RECOVERED?(o="green",r=4294967295):t===g.SENSITIVE?e.render.lineWidth=0:void 0,e.render.strokeStyle=o,e},a.prototype.add_location=function(e,t){let a=new d(e);return a.border_color=t.border_color,a.set_bounds(t.bounds),a.friction=t.friction,a.type=t.type||"none",a.home_color=this.simulation_colors.matter_colors[this.locations.length],a.viva_node_color=this.simulation_colors.viva_colors[this.locations.length],this.locations.push(a),a},a.prototype.add_cohort=function(){let e=new c;return this.cohorts.push(e),e},a.prototype.assign_cohort=function(e,t){t.add_agent(e.agent_object)},a.prototype.expose_org=function(e,t){this.update_org_state(e,g.EXPOSED),this.add_event({time:o(i.normal.sample(this.infection_params.incubation_period_mu,this.infection_params.incubation_period_sigma),1)*this.simulation_params.sim_time_per_day,callback:()=>{this.update_org_state(e,t);let a=0;a=t==g.A_INFECTED?o(i.normal.sample(this.infection_params.asymptomatic_infectious_period_mu,this.infection_params.asymptomatic_infectious_period_sigma),.5):o(i.normal.sample(this.infection_params.infectious_period_mu,this.infection_params.infectious_period_sigma),4),this.add_event({time:a*this.simulation_params.sim_time_per_day,callback:()=>{this.update_org_state(e,g.RECOVERED)}})}})},a.prototype.add_agent=function(e,t){"undefined"==typeof t&&(t=g.SUSCEPTIBLE),n(e&&e.get_random_position);let a=e.get_random_position(),o=x.circle(a.x,a.y,this.simulation_params.agent_size,{plugin:{wrap:e.bounds}});o.render.fillStyle=e.home_color||"black",o.strokeStyle="black",o.lineWidth=2,o.agent_object=new u(o),o.frictionAir=e.friction,o.friction=0,o.restitution=1.1,o.node=s.addNode(o.agent_object.uuid,{something:!0}),e.add_agent(o.agent_object),o.agent_object.register_interaction_callback(e=>{if((e.state==g.S_INFECTED||e.state==g.A_INFECTED)&&o.agent_object.state==g.SUSCEPTIBLE&&Matter.Common.random(0,1)<this.infection_params.per_contact_infection){let e;e=Matter.Common.random(0,1)<this.infection_params.fraction_asymptomatic?g.A_INFECTED:g.S_INFECTED,this.expose_org(o,e)}n(e.uuid&&o.agent_object.uuid);var t=s.hasLink(o.agent_object.uuid,e.uuid)||s.hasLink(e.uuid,o.agent_object.uuid);t?t.data.timestamp=this.cur_sim_time:(n(s.hasNode(o.agent_object.uuid)&&s.hasNode(o.agent_object.uuid)),t=s.addLink(o.agent_object.uuid,e.uuid,{origin:o.agent_object.uuid,timestamp:this.cur_sim_time})),this.add_event({time:this.simulation_params.link_lifetime+1,callback:r(t)})});var r=e=>()=>{e.data.timestamp<this.cur_sim_time-this.simulation_params.link_lifetime?s.removeLink(e):this.add_event({time:this.cur_sim_time+this.simulation_params.link_lifetime-e.data.timestamp,callback:r(e)})};return o.onCollide(e=>{e.bodyA===o&&e.bodyB.agent_object?e.bodyA.agent_object.handle_agent_contact(e.bodyB.agent_object):e.bodyB===o&&e.bodyA.agent_object&&e.bodyB.agent_object.handle_agent_contact(e.bodyA.agent_object)}),y.add(this.matter_engine.world,o),this.agents.push(o.agent_object),this.update_org_state(o,t),o},a.prototype.add_event=function(e){n(e.time&&e.callback),this.event_queue.add_event(this.cur_sim_time,e)},a.prototype.set_agent_contact_callback=function(e){this.agent_contact_callback=e},a.prototype.clear_simulator=function(){y.clear(this.matter_engine.world),m.clear(this.matter_engine),this.event_queue.clear_events()},a.prototype.remove_simulator=function(){this.clear_simulator(),h.stop(),this.matter_engine.events={},this.matter_render.canvas.remove(),this.matter_render.canvas=null,this.matter_render.context=null,this.matter_render.textures={},this.matter_world=null,this.matter_engine=null,this.event_queue=null,this.matter_render=null,this.mouseConstraint=null},a.prototype.pulse_orgs_event=function(){return()=>{for(let e=0,t;100>e;e++)t=Matter.Common.choose(this.agents),Matter.Body.applyForce(t.body,t.body.position,{x:Matter.Common.random(-2e-5*this.infection_params.movement_scale,2e-5*this.infection_params.movement_scale),y:Matter.Common.random(-2e-5*this.infection_params.movement_scale,2e-5*this.infection_params.movement_scale)})}},t.exports={InfectiousMatter:a,AgentStates:g,ContactGraph:s}},{"./agent.js":1,"./cohort.js":2,"./event_queue.js":3,"./location.js":4,assert:1414,jstat:394,"matter-collision-events":405,"matter-js":407,"matter-wrap":408,vivagraphjs:1389}],6:[function(e,t){'use strict';var o=Math.max;function a(e,t){this._controllerNames=Object.keys(e),this._controllerList=this._controllerNames.map(function(t){return e[t]}),this._mode=t,this._active=e[t],this._active||(this._mode="turntable",this._active=e.turntable),this.modes=this._controllerNames,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}t.exports=function(e){e=e||{};var t=e.eye||[0,0,1],o=e.center||[0,0,0],l=e.up||[0,1,0],s=e.distanceLimits||[0,1/0],d=e.mode||"turntable",c=r(),p=i(),u=n();return c.setDistanceLimits(s[0],s[1]),c.lookAt(0,t,o,l),p.setDistanceLimits(s[0],s[1]),p.lookAt(0,t,o,l),u.setDistanceLimits(s[0],s[1]),u.lookAt(0,t,o,l),new a({turntable:c,orbit:p,matrix:u},d)};var r=e("turntable-camera-controller"),i=e("orbit-camera-controller"),n=e("matrix-camera-controller"),l=a.prototype;[["flush",1],["idle",1],["lookAt",4],["rotate",4],["pan",4],["translate",4],["setMatrix",2],["setDistanceLimits",2],["setDistance",2]].forEach(function(e){for(var t=e[0],a=[],o=0;o<e[1];++o)a.push("a"+o);var r="var cc=this._controllerList;for(var i=0;i<cc.length;++i){cc[i]."+e[0]+"("+a.join()+")}";l[t]=Function.apply(null,a.concat(r))}),l.recalcMatrix=function(e){this._active.recalcMatrix(e)},l.getDistance=function(e){return this._active.getDistance(e)},l.getDistanceLimits=function(e){return this._active.getDistanceLimits(e)},l.lastT=function(){return this._active.lastT()},l.setMode=function(e){if(e!==this._mode){var t=this._controllerNames.indexOf(e);if(!(0>t)){var a=this._active,r=this._controllerList[t],i=o(a.lastT(),r.lastT());a.recalcMatrix(i),r.setMatrix(i,a.computedMatrix),this._active=r,this._mode=e,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}}},l.getMode=function(){return this._mode}},{"matrix-camera-controller":403,"orbit-camera-controller":440,"turntable-camera-controller":1314}],7:[function(e,t,a){var o=Math.pow,r=Math.tan,i=Math.abs,n=Math.max,l=Math.floor;(function(o,r){"object"==typeof a&&"undefined"!=typeof t?r(a,e("d3-array"),e("d3-collection"),e("d3-shape"),e("elementary-circuits-directed-graph")):"function"==typeof define&&define.amd?define(["exports","d3-array","d3-collection","d3-shape","elementary-circuits-directed-graph"],r):r(o.d3=o.d3||{},o.d3,o.d3,o.d3,null)})(this,function(e,t,a,s,d){'use strict';function c(e){return e.target.depth}function p(e,t){return e.sourceLinks.length?e.depth:t-1}function u(e){return function(){return e}}function g(e,t){return h(e.source,t.source)||e.index-t.index}function m(e,t){return h(e.target,t.target)||e.index-t.index}function h(e,t){return e.partOfCycle===t.partOfCycle?e.y0-t.y0:"top"===e.circularLinkType||"bottom"===t.circularLinkType?-1:1}function y(e){return e.value}function f(e){return(e.y0+e.y1)/2}function x(e){return f(e.source)}function _(e){return f(e.target)}function b(e){return e.index}function v(e){return e.nodes}function w(e){return e.links}function k(e,t){var a=e.get(t);if(!a)throw new Error("missing: "+t);return a}function T(e,t){return t(e)}function A(){function e(){var e={nodes:M.apply(null,arguments),links:j.apply(null,arguments)};o(e),S(e,O,N),r(e),d(e),C(e,O),c(e,B,O),T(e);for(var t=0;t<4;t++)W(e,P,O),X(e,P,O),q(e,L,P,O),W(e,P,O),X(e,P,O);return J(e,L,P),D(e,F,P,O),e}function o(e){e.nodes.forEach(function(e,t){e.index=t,e.sourceLinks=[],e.targetLinks=[]});var t=a.map(e.nodes,O);return e.links.forEach(function(e,a){e.index=a;var o=e.source,r=e.target;"object"!==("undefined"==typeof o?"undefined":Q(o))&&(o=e.source=k(t,o)),"object"!==("undefined"==typeof r?"undefined":Q(r))&&(r=e.target=k(t,r)),o.sourceLinks.push(e),r.targetLinks.push(e)}),e}function r(e){e.nodes.forEach(function(e){e.partOfCycle=!1,e.value=n(t.sum(e.sourceLinks,y),t.sum(e.targetLinks,y)),e.sourceLinks.forEach(function(t){t.circular&&(e.partOfCycle=!0,e.circularLinkType=t.circularLinkType)}),e.targetLinks.forEach(function(t){t.circular&&(e.partOfCycle=!0,e.circularLinkType=t.circularLinkType)})})}function i(e){var a=0,o=0,r=0,i=0,n=t.max(e.nodes,function(e){return e.column});return e.links.forEach(function(e){e.circular&&("top"==e.circularLinkType?a+=e.width:o+=e.width,0==e.target.column&&(i+=e.width),e.source.column==n&&(r+=e.width))}),a=0<a?a+25+10:a,o=0<o?o+25+10:o,r=0<r?r+25+10:r,i=0<i?i+25+10:i,{top:a,bottom:o,left:i,right:r}}function s(e,a){var o=t.max(e.nodes,function(e){return e.column}),r=E-A,i=P-L,n=r+a.right+a.left,l=i+a.top+a.bottom,s=r/n,d=i/l;return A=A*s+a.left,E=0==a.right?E:E*s,L=L*d+a.top,P*=d,e.nodes.forEach(function(e){e.x0=A+e.column*((E-A-z)/o),e.x1=e.x0+z}),d}function d(e){var t,a,o;for(t=e.nodes,a=[],o=0;t.length;++o,t=a,a=[])t.forEach(function(e){e.depth=o,e.sourceLinks.forEach(function(e){0>a.indexOf(e.target)&&!e.circular&&a.push(e.target)})});for(t=e.nodes,a=[],o=0;t.length;++o,t=a,a=[])t.forEach(function(e){e.height=o,e.targetLinks.forEach(function(e){0>a.indexOf(e.source)&&!e.circular&&a.push(e.source)})});e.nodes.forEach(function(e){e.column=l(R.call(null,e,o))})}function c(e,o,r){function l(a){if(U){var o=1/0;p.forEach(function(e){var t=P*U/(e.length+1);o=t<o?t:o}),V=o}var r=t.min(p,function(e){return(P-L-(e.length-1)*V)/t.sum(e,y)});r*=ee,e.links.forEach(function(e){e.width=e.value*r});var n=i(e),l=s(e,n);r*=l,e.links.forEach(function(e){e.width=e.value*r}),p.forEach(function(e){var t=e.length;e.forEach(function(e,o){e.depth==p.length-1&&1==t?(e.y0=P/2-e.value*r,e.y1=e.y0+e.value*r):0==e.depth&&1==t?(e.y0=P/2-e.value*r,e.y1=e.y0+e.value*r):e.partOfCycle?0==I(e,a)?(e.y0=P/2+o,e.y1=e.y0+e.value*r):"top"==e.circularLinkType?(e.y0=L+o,e.y1=e.y0+e.value*r):(e.y0=P-e.value*r-o,e.y1=e.y0+e.value*r):0==n.top||0==n.bottom?(e.y0=(P-L)/t*o,e.y1=e.y0+e.value*r):(e.y0=(P-L)/2-t/2+o,e.y1=e.y0+e.value*r)})})}function d(e,a){var o=p.length;p.forEach(function(r){var i=r.length,n=r[0].depth;r.forEach(function(r){var l;if(r.sourceLinks.length||r.targetLinks.length)if(r.partOfCycle&&0<I(r,a));else if(0==n&&1==i)l=r.y1-r.y0,r.y0=P/2-l/2,r.y1=P/2+l/2;else if(n==o-1&&1==i)l=r.y1-r.y0,r.y0=P/2-l/2,r.y1=P/2+l/2;else{var s=0,d=t.mean(r.sourceLinks,_),c=t.mean(r.targetLinks,x);s=d&&c?(d+c)/2:d||c;var p=(s-f(r))*e;r.y0+=p,r.y1+=p}})})}function c(){p.forEach(function(e){var t=L,a=e.length,o,r,n;for(e.sort(h),n=0;n<a;++n)o=e[n],r=t-o.y0,0<r&&(o.y0+=r,o.y1+=r),t=o.y1+V;if(r=t-V-P,0<r)for(t=o.y0-=r,o.y1-=r,n=a-2;0<=n;--n)o=e[n],r=o.y1+V-t,0<r&&(o.y0-=r,o.y1-=r),t=o.y0})}var p=a.nest().key(function(e){return e.column}).sortKeys(t.ascending).entries(e.nodes).map(function(e){return e.values});l(r),c();for(var u=1,g=o;0<g;--g)d(u*=.99,r),c()}function T(e){e.nodes.forEach(function(e){e.sourceLinks.sort(m),e.targetLinks.sort(g)}),e.nodes.forEach(function(e){var t=e.y0,a=t,o=e.y1,r=o;e.sourceLinks.forEach(function(e){e.circular?(e.y0=o-e.width/2,o-=e.width):(e.y0=t+e.width/2,t+=e.width)}),e.targetLinks.forEach(function(e){e.circular?(e.y1=r-e.width/2,r-=e.width):(e.y1=a+e.width/2,a+=e.width)})})}var A=0,L=0,E=1,P=1,z=24,O=b,R=p,M=v,j=w,B=32,F=2,N=null,V,U;return e.nodeId=function(t){return arguments.length?(O="function"==typeof t?t:u(t),e):O},e.nodeAlign=function(t){return arguments.length?(R="function"==typeof t?t:u(t),e):R},e.nodeWidth=function(t){return arguments.length?(z=+t,e):z},e.nodePadding=function(t){return arguments.length?(V=+t,e):V},e.nodes=function(t){return arguments.length?(M="function"==typeof t?t:u(t),e):M},e.links=function(t){return arguments.length?(j="function"==typeof t?t:u(t),e):j},e.size=function(t){return arguments.length?(A=L=0,E=+t[0],P=+t[1],e):[E-A,P-L]},e.extent=function(t){return arguments.length?(A=+t[0][0],E=+t[1][0],L=+t[0][1],P=+t[1][1],e):[[A,L],[E,P]]},e.iterations=function(t){return arguments.length?(B=+t,e):B},e.circularLinkGap=function(t){return arguments.length?(F=+t,e):F},e.nodePaddingRatio=function(t){return arguments.length?(U=+t,e):U},e.sortNodes=function(t){return arguments.length?(N=t,e):N},e.update=function(e){return C(e,O),T(e),e.links.forEach(function(e){e.circular&&(e.circularLinkType=e.y0+e.y1<P?"top":"bottom",e.source.circularLinkType=e.circularLinkType,e.target.circularLinkType=e.circularLinkType)}),W(e,P,O,!1),X(e,P,O),D(e,F,P,O),e},e}function S(e,t,a){var o=0;if(null===a){for(var r=[],n=0;n<e.links.length;n++){var l=e.links[n],s=l.source.index,c=l.target.index;r[s]||(r[s]=[]),r[c]||(r[c]=[]),-1===r[s].indexOf(c)&&r[s].push(c)}var p=d(r);p.sort(function(e,t){return e.length-t.length});var u={};for(n=0;n<p.length;n++){var g=p[n],m=g.slice(-2);u[m[0]]||(u[m[0]]={}),u[m[0]][m[1]]=!0}e.links.forEach(function(e){var t=e.target.index,a=e.source.index;t===a||u[a]&&u[a][t]?(e.circular=!0,e.circularLinkID=o,++o):e.circular=!1})}else e.links.forEach(function(e){e.source[a]<e.target[a]?e.circular=!1:(e.circular=!0,e.circularLinkID=o,++o)})}function C(e,t){var a=0,o=0;e.links.forEach(function(r){r.circular&&(r.circularLinkType=r.source.circularLinkType||r.target.circularLinkType?r.source.circularLinkType?r.source.circularLinkType:r.target.circularLinkType:a<o?"top":"bottom","top"==r.circularLinkType?++a:++o,e.nodes.forEach(function(e){(T(e,t)==T(r.source,t)||T(e,t)==T(r.target,t))&&(e.circularLinkType=r.circularLinkType)}))}),e.links.forEach(function(e){e.circular&&(e.source.circularLinkType==e.target.circularLinkType&&(e.circularLinkType=e.source.circularLinkType),$(e,t)&&(e.circularLinkType=e.source.circularLinkType))})}function L(e){var t=i(e.y1-e.y0),a=i(e.target.x0-e.source.x1);return Math.atan(a/t)}function E(e,t){return!(e.source.column<t.target.column)&&!(e.target.column>t.source.column)}function I(e,t){var a=0;e.sourceLinks.forEach(function(e){a=e.circular&&!$(e,t)?a+1:a});var o=0;return e.targetLinks.forEach(function(e){o=e.circular&&!$(e,t)?o+1:o}),a+o}function P(e){var t=e.source.sourceLinks,a=0;t.forEach(function(e){a=e.circular?a+1:a});var o=e.target.targetLinks,r=0;return o.forEach(function(e){r=e.circular?r+1:r}),!(1<a||1<r)}function z(e,t,a){return e.sort(R),e.forEach(function(o,r){var i=0;if($(o,a)&&P(o))o.circularPathData.verticalBuffer=i+o.width/2;else{var n=0;for(n;n<r;n++)if(E(e[r],e[n])){var l=e[n].circularPathData.verticalBuffer+e[n].width/2+t;i=l>i?l:i}o.circularPathData.verticalBuffer=i+o.width/2}}),e}function D(e,a,o,r){var i=t.min(e.links,function(e){return e.source.y0});e.links.forEach(function(e){e.circular&&(e.circularPathData={})});var l=e.links.filter(function(e){return"top"==e.circularLinkType});z(l,a,r);var d=e.links.filter(function(e){return"bottom"==e.circularLinkType});z(d,a,r),e.links.forEach(function(t){if(t.circular){if(t.circularPathData.arcRadius=t.width+10,t.circularPathData.leftNodeBuffer=5,t.circularPathData.rightNodeBuffer=5,t.circularPathData.sourceWidth=t.source.x1-t.source.x0,t.circularPathData.sourceX=t.source.x0+t.circularPathData.sourceWidth,t.circularPathData.targetX=t.target.x0,t.circularPathData.sourceY=t.y0,t.circularPathData.targetY=t.y1,$(t,r)&&P(t))t.circularPathData.leftSmallArcRadius=10+t.width/2,t.circularPathData.leftLargeArcRadius=10+t.width/2,t.circularPathData.rightSmallArcRadius=10+t.width/2,t.circularPathData.rightLargeArcRadius=10+t.width/2,"bottom"==t.circularLinkType?(t.circularPathData.verticalFullExtent=t.source.y1+25+t.circularPathData.verticalBuffer,t.circularPathData.verticalLeftInnerExtent=t.circularPathData.verticalFullExtent-t.circularPathData.leftLargeArcRadius,t.circularPathData.verticalRightInnerExtent=t.circularPathData.verticalFullExtent-t.circularPathData.rightLargeArcRadius):(t.circularPathData.verticalFullExtent=t.source.y0-25-t.circularPathData.verticalBuffer,t.circularPathData.verticalLeftInnerExtent=t.circularPathData.verticalFullExtent+t.circularPathData.leftLargeArcRadius,t.circularPathData.verticalRightInnerExtent=t.circularPathData.verticalFullExtent+t.circularPathData.rightLargeArcRadius);else{var d=t.source.column,c=t.circularLinkType,p=e.links.filter(function(e){return e.source.column==d&&e.circularLinkType==c});"bottom"==t.circularLinkType?p.sort(j):p.sort(M);var u=0;p.forEach(function(e,o){e.circularLinkID==t.circularLinkID&&(t.circularPathData.leftSmallArcRadius=10+t.width/2+u,t.circularPathData.leftLargeArcRadius=10+t.width/2+o*a+u),u+=e.width}),d=t.target.column,p=e.links.filter(function(e){return e.target.column==d&&e.circularLinkType==c}),"bottom"==t.circularLinkType?p.sort(F):p.sort(B),u=0,p.forEach(function(e,o){e.circularLinkID==t.circularLinkID&&(t.circularPathData.rightSmallArcRadius=10+t.width/2+u,t.circularPathData.rightLargeArcRadius=10+t.width/2+o*a+u),u+=e.width}),"bottom"==t.circularLinkType?(t.circularPathData.verticalFullExtent=n(o,t.source.y1,t.target.y1)+25+t.circularPathData.verticalBuffer,t.circularPathData.verticalLeftInnerExtent=t.circularPathData.verticalFullExtent-t.circularPathData.leftLargeArcRadius,t.circularPathData.verticalRightInnerExtent=t.circularPathData.verticalFullExtent-t.circularPathData.rightLargeArcRadius):(t.circularPathData.verticalFullExtent=i-25-t.circularPathData.verticalBuffer,t.circularPathData.verticalLeftInnerExtent=t.circularPathData.verticalFullExtent+t.circularPathData.leftLargeArcRadius,t.circularPathData.verticalRightInnerExtent=t.circularPathData.verticalFullExtent+t.circularPathData.rightLargeArcRadius)}t.circularPathData.leftInnerExtent=t.circularPathData.sourceX+t.circularPathData.leftNodeBuffer,t.circularPathData.rightInnerExtent=t.circularPathData.targetX-t.circularPathData.rightNodeBuffer,t.circularPathData.leftFullExtent=t.circularPathData.sourceX+t.circularPathData.leftLargeArcRadius+t.circularPathData.leftNodeBuffer,t.circularPathData.rightFullExtent=t.circularPathData.targetX-t.circularPathData.rightLargeArcRadius-t.circularPathData.rightNodeBuffer}if(t.circular)t.path=O(t);else{var g=s.linkHorizontal().source(function(e){var t=e.source.x0+(e.source.x1-e.source.x0),a=e.y0;return[t,a]}).target(function(e){var t=e.target.x0,a=e.y1;return[t,a]});t.path=g(t)}})}function O(e){var t="";return t="top"==e.circularLinkType?"M"+e.circularPathData.sourceX+" "+e.circularPathData.sourceY+" L"+e.circularPathData.leftInnerExtent+" "+e.circularPathData.sourceY+" A"+e.circularPathData.leftLargeArcRadius+" "+e.circularPathData.leftSmallArcRadius+" 0 0 0 "+e.circularPathData.leftFullExtent+" "+(e.circularPathData.sourceY-e.circularPathData.leftSmallArcRadius)+" L"+e.circularPathData.leftFullExtent+" "+e.circularPathData.verticalLeftInnerExtent+" A"+e.circularPathData.leftLargeArcRadius+" "+e.circularPathData.leftLargeArcRadius+" 0 0 0 "+e.circularPathData.leftInnerExtent+" "+e.circularPathData.verticalFullExtent+" L"+e.circularPathData.rightInnerExtent+" "+e.circularPathData.verticalFullExtent+" A"+e.circularPathData.rightLargeArcRadius+" "+e.circularPathData.rightLargeArcRadius+" 0 0 0 "+e.circularPathData.rightFullExtent+" "+e.circularPathData.verticalRightInnerExtent+" L"+e.circularPathData.rightFullExtent+" "+(e.circularPathData.targetY-e.circularPathData.rightSmallArcRadius)+" A"+e.circularPathData.rightLargeArcRadius+" "+e.circularPathData.rightSmallArcRadius+" 0 0 0 "+e.circularPathData.rightInnerExtent+" "+e.circularPathData.targetY+" L"+e.circularPathData.targetX+" "+e.circularPathData.targetY:"M"+e.circularPathData.sourceX+" "+e.circularPathData.sourceY+" L"+e.circularPathData.leftInnerExtent+" "+e.circularPathData.sourceY+" A"+e.circularPathData.leftLargeArcRadius+" "+e.circularPathData.leftSmallArcRadius+" 0 0 1 "+e.circularPathData.leftFullExtent+" "+(e.circularPathData.sourceY+e.circularPathData.leftSmallArcRadius)+" L"+e.circularPathData.leftFullExtent+" "+e.circularPathData.verticalLeftInnerExtent+" A"+e.circularPathData.leftLargeArcRadius+" "+e.circularPathData.leftLargeArcRadius+" 0 0 1 "+e.circularPathData.leftInnerExtent+" "+e.circularPathData.verticalFullExtent+" L"+e.circularPathData.rightInnerExtent+" "+e.circularPathData.verticalFullExtent+" A"+e.circularPathData.rightLargeArcRadius+" "+e.circularPathData.rightLargeArcRadius+" 0 0 1 "+e.circularPathData.rightFullExtent+" "+e.circularPathData.verticalRightInnerExtent+" L"+e.circularPathData.rightFullExtent+" "+(e.circularPathData.targetY+e.circularPathData.rightSmallArcRadius)+" A"+e.circularPathData.rightLargeArcRadius+" "+e.circularPathData.rightSmallArcRadius+" 0 0 1 "+e.circularPathData.rightInnerExtent+" "+e.circularPathData.targetY+" L"+e.circularPathData.targetX+" "+e.circularPathData.targetY,t}function R(e,t){return N(e)==N(t)?"bottom"==e.circularLinkType?j(e,t):M(e,t):N(t)-N(e)}function M(e,t){return e.y0-t.y0}function j(e,t){return t.y0-e.y0}function B(e,t){return e.y1-t.y1}function F(e,t){return t.y1-e.y1}function N(e){return e.target.column-e.source.column}function V(e){return e.target.x0-e.source.x1}function U(e,t){var a=L(e),o=V(t)/r(a),i="up"==K(e)?e.y1+o:e.y1-o;return i}function H(e,t){var a=L(e),o=V(t)/r(a),i="up"==K(e)?e.y1-o:e.y1+o;return i}function q(e,a,r,t){e.links.forEach(function(n){if(!n.circular&&1<n.target.column-n.source.column){var l=n.source.column+1,s=n.target.column-1,d=1,c=s-l+1;for(d=1;l<=s;l++,d++)e.nodes.forEach(function(i){if(i.column==l){var s=d/(c+1),p=o(1-s,3),u=3*s*o(1-s,2),g=3*o(s,2)*(1-s),m=o(s,3),h=p*n.y0+u*n.y0+g*n.y1+m*n.y1,y=h-n.width/2,f=h+n.width/2,x;y>i.y0&&y<i.y1?(x=i.y1-y+10,x="bottom"==i.circularLinkType?x:-x,i=Y(i,x,a,r),e.nodes.forEach(function(e){T(e,t)==T(i,t)||e.column!=i.column||G(i,e)&&Y(e,x,a,r)})):f>i.y0&&f<i.y1?(x=f-i.y0+10,i=Y(i,x,a,r),e.nodes.forEach(function(e){T(e,t)==T(i,t)||e.column!=i.column||e.y0<i.y1&&e.y1>i.y1&&Y(e,x,a,r)})):y<i.y0&&f>i.y1&&(x=f-i.y0+10,i=Y(i,x,a,r),e.nodes.forEach(function(e){T(e,t)==T(i,t)||e.column!=i.column||e.y0<i.y1&&e.y1>i.y1&&Y(e,x,a,r)}))}})}})}function G(e,t){return!!(e.y0>t.y0&&e.y0<t.y1)||!!(e.y1>t.y0&&e.y1<t.y1)||!!(e.y0<t.y0&&e.y1>t.y1)}function Y(e,t,a,o){return e.y0+t>=a&&e.y1+t<=o&&(e.y0+=t,e.y1+=t,e.targetLinks.forEach(function(e){e.y1+=t}),e.sourceLinks.forEach(function(e){e.y0+=t})),e}function W(e,t,a,o){e.nodes.forEach(function(r){o&&r.y+(r.y1-r.y0)>t&&(r.y-=r.y+(r.y1-r.y0)-t);var i=e.links.filter(function(e){return T(e.source,a)==T(r,a)}),n=i.length;1<n&&i.sort(function(e,t){if(!e.circular&&!t.circular){if(e.target.column==t.target.column)return e.y1-t.y1;if(!Z(e,t))return e.y1-t.y1;if(e.target.column>t.target.column){var a=H(t,e);return e.y1-a}if(t.target.column>e.target.column){var o=H(e,t);return o-t.y1}}return e.circular&&!t.circular?"top"==e.circularLinkType?-1:1:t.circular&&!e.circular?"top"==t.circularLinkType?1:-1:e.circular&&t.circular?e.circularLinkType===t.circularLinkType&&"top"==e.circularLinkType?e.target.column===t.target.column?e.target.y1-t.target.y1:t.target.column-e.target.column:e.circularLinkType===t.circularLinkType&&"bottom"==e.circularLinkType?e.target.column===t.target.column?t.target.y1-e.target.y1:e.target.column-t.target.column:"top"==e.circularLinkType?-1:1:void 0});var l=r.y0;i.forEach(function(e){e.y0=l+e.width/2,l+=e.width}),i.forEach(function(e,t){if("bottom"==e.circularLinkType){var a=t+1,o=0;for(a;a<n;a++)o+=i[a].width;e.y0=r.y1-o-e.width/2}})})}function X(e,t,a){e.nodes.forEach(function(t){var o=e.links.filter(function(e){return T(e.target,a)==T(t,a)}),r=o.length;1<r&&o.sort(function(e,t){if(!e.circular&&!t.circular){if(e.source.column==t.source.column)return e.y0-t.y0;if(!Z(e,t))return e.y0-t.y0;if(t.source.column<e.source.column){var a=U(t,e);return e.y0-a}if(e.source.column<t.source.column){var o=U(e,t);return o-t.y0}}return e.circular&&!t.circular?"top"==e.circularLinkType?-1:1:t.circular&&!e.circular?"top"==t.circularLinkType?1:-1:e.circular&&t.circular?e.circularLinkType===t.circularLinkType&&"top"==e.circularLinkType?e.source.column===t.source.column?e.source.y1-t.source.y1:e.source.column-t.source.column:e.circularLinkType===t.circularLinkType&&"bottom"==e.circularLinkType?e.source.column===t.source.column?e.source.y1-t.source.y1:t.source.column-e.source.column:"top"==e.circularLinkType?-1:1:void 0});var i=t.y0;o.forEach(function(e){e.y1=i+e.width/2,i+=e.width}),o.forEach(function(e,a){if("bottom"==e.circularLinkType){var i=a+1,n=0;for(i;i<r;i++)n+=o[i].width;e.y1=t.y1-n-e.width/2}})})}function Z(e,t){return K(e)==K(t)}function K(e){return 0<e.y0-e.y1?"up":"down"}function $(e,t){return T(e.source,t)==T(e.target,t)}function J(e,a,o){var r=e.nodes,i=e.links,n=!1,l=!1;if(i.forEach(function(e){"top"==e.circularLinkType?n=!0:"bottom"==e.circularLinkType&&(l=!0)}),!1==n||!1==l){var s=t.min(r,function(e){return e.y0}),d=t.max(r,function(e){return e.y1}),c=(o-a)/(d-s);r.forEach(function(e){var t=(e.y1-e.y0)*c;e.y0=(e.y0-s)*c,e.y1=e.y0+t}),i.forEach(function(e){e.y0=(e.y0-s)*c,e.y1=(e.y1-s)*c,e.width*=c})}}d=d&&d.hasOwnProperty("default")?d["default"]:d;var Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ee=.3;e.sankeyCircular=A,e.sankeyCenter=function(e){return e.targetLinks.length?e.depth:e.sourceLinks.length?t.min(e.sourceLinks,c)-1:0},e.sankeyLeft=function(e){return e.depth},e.sankeyRight=function(e,t){return t-1-e.height},e.sankeyJustify=p,Object.defineProperty(e,"__esModule",{value:!0})})},{"d3-array":97,"d3-collection":98,"d3-shape":106,"elementary-circuits-directed-graph":119}],8:[function(e,t,a){var o=Math.min,r=Math.max,i=Math.floor;(function(o,r){"object"==typeof a&&"undefined"!=typeof t?r(a,e("d3-array"),e("d3-collection"),e("d3-shape")):"function"==typeof define&&define.amd?define(["exports","d3-array","d3-collection","d3-shape"],r):r(o.d3=o.d3||{},o.d3,o.d3,o.d3)})(this,function(e,t,a,n){'use strict';function l(e){return e.target.depth}function s(e,t){return e.sourceLinks.length?e.depth:t-1}function d(e){return function(){return e}}function c(e,t){return u(e.source,t.source)||e.index-t.index}function p(e,t){return u(e.target,t.target)||e.index-t.index}function u(e,t){return e.y0-t.y0}function g(e){return e.value}function m(e){return(e.y0+e.y1)/2}function h(e){return m(e.source)*e.value}function y(e){return m(e.target)*e.value}function f(e){return e.index}function x(e){return e.nodes}function _(e){return e.links}function b(e,t){var a=e.get(t);if(!a)throw new Error("missing: "+t);return a}function v(e){return[e.source.x1,e.y0]}function w(e){return[e.target.x0,e.y1]}e.sankey=function(){function e(){var e={nodes:z.apply(null,arguments),links:D.apply(null,arguments)};return n(e),l(e),v(e),w(e,O),k(e),e}function n(e){e.nodes.forEach(function(e,t){e.index=t,e.sourceLinks=[],e.targetLinks=[]});var t=a.map(e.nodes,I);e.links.forEach(function(e,a){e.index=a;var o=e.source,r=e.target;"object"!=typeof o&&(o=e.source=b(t,o)),"object"!=typeof r&&(r=e.target=b(t,r)),o.sourceLinks.push(e),r.targetLinks.push(e)})}function l(e){e.nodes.forEach(function(e){e.value=r(t.sum(e.sourceLinks,g),t.sum(e.targetLinks,g))})}function v(e){var t,a,n;for(t=e.nodes,a=[],n=0;t.length;++n,t=a,a=[])t.forEach(function(e){e.depth=n,e.sourceLinks.forEach(function(e){0>a.indexOf(e.target)&&a.push(e.target)})});for(t=e.nodes,a=[],n=0;t.length;++n,t=a,a=[])t.forEach(function(e){e.height=n,e.targetLinks.forEach(function(e){0>a.indexOf(e.source)&&a.push(e.source)})});var l=(S-T-L)/(n-1);e.nodes.forEach(function(e){e.x1=(e.x0=T+r(0,o(n-1,i(P.call(null,e,n))))*l)+L})}function w(e){function o(){var a=t.max(s,function(e){return e.length}),o=R*(C-A)/(a-1);E>o&&(E=o);var r=t.min(s,function(e){return(C-A-(e.length-1)*E)/t.sum(e,g)});s.forEach(function(e){e.forEach(function(e,t){e.y1=(e.y0=t)+e.value*r})}),e.links.forEach(function(e){e.width=e.value*r})}function r(e){s.forEach(function(a){a.forEach(function(a){if(a.targetLinks.length){var o=(t.sum(a.targetLinks,h)/t.sum(a.targetLinks,g)-m(a))*e;a.y0+=o,a.y1+=o}})})}function i(e){s.slice().reverse().forEach(function(a){a.forEach(function(a){if(a.sourceLinks.length){var o=(t.sum(a.sourceLinks,y)/t.sum(a.sourceLinks,g)-m(a))*e;a.y0+=o,a.y1+=o}})})}function l(){s.forEach(function(e){var t=A,a=e.length,o,r,n;for(e.sort(u),n=0;n<a;++n)o=e[n],r=t-o.y0,0<r&&(o.y0+=r,o.y1+=r),t=o.y1+E;if(r=t-E-C,0<r)for(t=o.y0-=r,o.y1-=r,n=a-2;0<=n;--n)o=e[n],r=o.y1+E-t,0<r&&(o.y0-=r,o.y1-=r),t=o.y0})}var s=a.nest().key(function(e){return e.x0}).sortKeys(t.ascending).entries(e.nodes).map(function(e){return e.values});o(),l();for(var d=1,c=O;0<c;--c)i(d*=.99),l(),r(d),l()}function k(e){e.nodes.forEach(function(e){e.sourceLinks.sort(p),e.targetLinks.sort(c)}),e.nodes.forEach(function(e){var t=e.y0,a=t;e.sourceLinks.forEach(function(e){e.y0=t+e.width/2,t+=e.width}),e.targetLinks.forEach(function(e){e.y1=a+e.width/2,a+=e.width})})}var T=0,A=0,S=1,C=1,L=24,E=8,I=f,P=s,z=x,D=_,O=32,R=2/3;return e.update=function(e){return k(e),e},e.nodeId=function(t){return arguments.length?(I="function"==typeof t?t:d(t),e):I},e.nodeAlign=function(t){return arguments.length?(P="function"==typeof t?t:d(t),e):P},e.nodeWidth=function(t){return arguments.length?(L=+t,e):L},e.nodePadding=function(t){return arguments.length?(E=+t,e):E},e.nodes=function(t){return arguments.length?(z="function"==typeof t?t:d(t),e):z},e.links=function(t){return arguments.length?(D="function"==typeof t?t:d(t),e):D},e.size=function(t){return arguments.length?(T=A=0,S=+t[0],C=+t[1],e):[S-T,C-A]},e.extent=function(t){return arguments.length?(T=+t[0][0],S=+t[1][0],A=+t[0][1],C=+t[1][1],e):[[T,A],[S,C]]},e.iterations=function(t){return arguments.length?(O=+t,e):O},e},e.sankeyCenter=function(e){return e.targetLinks.length?e.depth:e.sourceLinks.length?t.min(e.sourceLinks,l)-1:0},e.sankeyLeft=function(e){return e.depth},e.sankeyRight=function(e,t){return t-1-e.height},e.sankeyJustify=s,e.sankeyLinkHorizontal=function(){return n.linkHorizontal().source(v).target(w)},Object.defineProperty(e,"__esModule",{value:!0})})},{"d3-array":97,"d3-collection":98,"d3-shape":106}],9:[function(e,t,a){"use strict";var s=Math.sin,d=Math.abs;function o(e){var t=0,a;switch(e.type){case"Polygon":return r(e.coordinates);case"MultiPolygon":for(a=0;a<e.coordinates.length;a++)t+=r(e.coordinates[a]);return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;}return 0}function r(e){var t=0;if(e&&0<e.length){t+=d(n(e[0]));for(var a=1;a<e.length;a++)t-=d(n(e[a]))}return t}function n(e){var t=0,a=e.length,o,r,n,d,c,p,u;if(2<a){for(u=0;u<a;u++)u===a-2?(d=a-2,c=a-1,p=0):u===a-1?(d=a-1,c=0,p=1):(d=u,c=u+1,p=u+2),o=e[d],r=e[c],n=e[p],t+=(l(n[0])-l(o[0]))*s(l(r[1]));t=t*6378137*6378137/2}return t}function l(e){return e*Math.PI/180}Object.defineProperty(a,"__esModule",{value:!0});var c=e("@turf/meta");a.default=function(e){return c.geomReduce(e,function(e,t){return e+o(t)},0)}},{"@turf/meta":13}],10:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var o=e("@turf/meta");a.default=function(e){var t=[1/0,1/0,-Infinity,-Infinity];return o.coordEach(e,function(e){t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])}),t}},{"@turf/meta":13}],11:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var o=e("@turf/meta"),r=e("@turf/helpers");a.default=function(e,t){void 0===t&&(t={});var a=0,i=0,n=0;return o.coordEach(e,function(e){a+=e[0],i+=e[1],n++}),r.point([a/n,i/n],t.properties)}},{"@turf/helpers":12,"@turf/meta":13}],12:[function(e,t,a){"use strict";var h=Math.round,y=Math.PI,f=Math.pow;function o(e,t,a){void 0===a&&(a={});var o={type:"Feature"};return(0===a.id||a.id)&&(o.id=a.id),a.bbox&&(o.bbox=a.bbox),o.properties=t||{},o.geometry=e,o}function r(e,t,a){void 0===a&&(a={});return o({type:"Point",coordinates:e},t,a)}function i(e,t,a){void 0===a&&(a={});for(var r=0,i=e,n;r<i.length;r++){if(n=i[r],4>n.length)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var l=0;l<n[n.length-1].length;l++)if(n[n.length-1][l]!==n[0][l])throw new Error("First and last Position are not equivalent.")}return o({type:"Polygon",coordinates:e},t,a)}function n(e,t,a){if(void 0===a&&(a={}),2>e.length)throw new Error("coordinates must be an array of two or more positions");return o({type:"LineString",coordinates:e},t,a)}function l(e,t){void 0===t&&(t={});var a={type:"FeatureCollection"};return t.id&&(a.id=t.id),t.bbox&&(a.bbox=t.bbox),a.features=e,a}function s(e,t,a){void 0===a&&(a={});return o({type:"MultiLineString",coordinates:e},t,a)}function d(e,t,a){void 0===a&&(a={});return o({type:"MultiPoint",coordinates:e},t,a)}function c(e,t,a){void 0===a&&(a={});return o({type:"MultiPolygon",coordinates:e},t,a)}function p(e,t){void 0===t&&(t="kilometers");var o=a.factors[t];if(!o)throw new Error(t+" units is invalid");return e*o}function u(e,t){void 0===t&&(t="kilometers");var o=a.factors[t];if(!o)throw new Error(t+" units is invalid");return e/o}function g(e){return 180*(e%(2*y))/y}function m(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)&&!/^\s*$/.test(e)}Object.defineProperty(a,"__esModule",{value:!0}),a.earthRadius=6371008.8,a.factors={centimeters:100*a.earthRadius,centimetres:100*a.earthRadius,degrees:a.earthRadius/111325,feet:3.28084*a.earthRadius,inches:39.37*a.earthRadius,kilometers:a.earthRadius/1e3,kilometres:a.earthRadius/1e3,meters:a.earthRadius,metres:a.earthRadius,miles:a.earthRadius/1609.344,millimeters:1e3*a.earthRadius,millimetres:1e3*a.earthRadius,nauticalmiles:a.earthRadius/1852,radians:1,yards:a.earthRadius/1.0936},a.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/a.earthRadius,yards:1/1.0936},a.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},a.feature=o,a.geometry=function(e,t,a){switch(void 0===a&&(a={}),e){case"Point":return r(t).geometry;case"LineString":return n(t).geometry;case"Polygon":return i(t).geometry;case"MultiPoint":return d(t).geometry;case"MultiLineString":return s(t).geometry;case"MultiPolygon":return c(t).geometry;default:throw new Error(e+" is invalid");}},a.point=r,a.points=function(e,t,a){return void 0===a&&(a={}),l(e.map(function(e){return r(e,t)}),a)},a.polygon=i,a.polygons=function(e,t,a){return void 0===a&&(a={}),l(e.map(function(e){return i(e,t)}),a)},a.lineString=n,a.lineStrings=function(e,t,a){return void 0===a&&(a={}),l(e.map(function(e){return n(e,t)}),a)},a.featureCollection=l,a.multiLineString=s,a.multiPoint=d,a.multiPolygon=c,a.geometryCollection=function(e,t,a){void 0===a&&(a={});return o({type:"GeometryCollection",geometries:e},t,a)},a.round=function(e,t){if(void 0===t&&(t=0),t&&!(0<=t))throw new Error("precision must be a positive number");var a=f(10,t||0);return h(e*a)/a},a.radiansToLength=p,a.lengthToRadians=u,a.lengthToDegrees=function(e,t){return g(u(e,t))},a.bearingToAzimuth=function(e){var t=e%360;return 0>t&&(t+=360),t},a.radiansToDegrees=g,a.degreesToRadians=function(e){return e%360*y/180},a.convertLength=function(e,t,a){if(void 0===t&&(t="kilometers"),void 0===a&&(a="kilometers"),!(0<=e))throw new Error("length must be a positive number");return p(u(e,t),a)},a.convertArea=function(e,t,o){if(void 0===t&&(t="meters"),void 0===o&&(o="kilometers"),!(0<=e))throw new Error("area must be a positive number");var r=a.areaFactors[t];if(!r)throw new Error("invalid original units");var i=a.areaFactors[o];if(!i)throw new Error("invalid final units");return e/r*i},a.isNumber=m,a.isObject=function(e){return!!e&&e.constructor===Object},a.validateBBox=function(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach(function(e){if(!m(e))throw new Error("bbox must only contain numbers")})},a.validateId=function(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof e))throw new Error("id must be a number or a string")},a.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},a.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},a.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},a.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},a.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},a.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},a.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}},{}],13:[function(e,t,a){'use strict';function o(e,t,a){if(null!==e)for(var r=0,i=0,n=e.type,s="FeatureCollection"===n,d=s?e.features.length:1,c=0,p,u,g,m,h,y,f,x;c<d;c++){f=s?e.features[c].geometry:"Feature"===n?e.geometry:e,x=!!f&&"GeometryCollection"===f.type,h=x?f.geometries.length:1;for(var _=0;_<h;_++){var b=0,v=0;if(m=x?f.geometries[_]:f,null!==m){y=m.coordinates;var w=m.type;switch(r=a&&("Polygon"===w||"MultiPolygon"===w)?1:0,w){case null:break;case"Point":if(!1===t(y,i,c,b,v))return!1;i++,b++;break;case"LineString":case"MultiPoint":for(p=0;p<y.length;p++){if(!1===t(y[p],i,c,b,v))return!1;i++,"MultiPoint"===w&&b++}"LineString"===w&&b++;break;case"Polygon":case"MultiLineString":for(p=0;p<y.length;p++){for(u=0;u<y[p].length-r;u++){if(!1===t(y[p][u],i,c,b,v))return!1;i++}"MultiLineString"===w&&b++,"Polygon"===w&&v++}"Polygon"===w&&b++;break;case"MultiPolygon":for(p=0;p<y.length;p++){for(v=0,u=0;u<y[p].length;u++){for(g=0;g<y[p][u].length-r;g++){if(!1===t(y[p][u][g],i,c,b,v))return!1;i++}v++}b++}break;case"GeometryCollection":for(p=0;p<m.geometries.length;p++)if(!1===o(m.geometries[p],t,a))return!1;break;default:throw new Error("Unknown Geometry Type");}}}}}function r(e,t){var a;switch(e.type){case"FeatureCollection":for(a=0;a<e.features.length&&!(!1===t(e.features[a].properties,a));a++);break;case"Feature":t(e.properties,0);}}function i(e,t){if("Feature"===e.type)t(e,0);else if("FeatureCollection"===e.type)for(var a=0;a<e.features.length&&!1!==t(e.features[a],a);a++);}function n(e,t){var a=0,o="FeatureCollection"===e.type,r="Feature"===e.type,n=o?e.features.length:1,l,s,d,c,p,u,m,h,y,f;for(l=0;l<n;l++){for(u=o?e.features[l].geometry:r?e.geometry:e,h=o?e.features[l].properties:r?e.properties:{},y=o?e.features[l].bbox:r?e.bbox:void 0,f=o?e.features[l].id:r?e.id:void 0,m=!!u&&"GeometryCollection"===u.type,p=m?u.geometries.length:1,d=0;d<p;d++){if(c=m?u.geometries[d]:u,null===c){if(!1===t(null,a,h,y,f))return!1;continue}switch(c.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(!1===t(c,a,h,y,f))return!1;break}case"GeometryCollection":{for(s=0;s<c.geometries.length;s++)if(!1===t(c.geometries[s],a,h,y,f))return!1;break}default:throw new Error("Unknown Geometry Type");}}a++}}function l(e,t){n(e,function(e,a,o,r,i){var n=null===e?null:e.type;switch(n){case null:case"Point":case"LineString":case"Polygon":return!1!==t(c.feature(e,o,{bbox:r,id:i}),a,0)&&void 0;}var l;"MultiPoint"===n?l="Point":"MultiLineString"===n?l="LineString":"MultiPolygon"===n?l="Polygon":void 0;for(var s=0;s<e.coordinates.length;s++){var d=e.coordinates[s],p={type:l,coordinates:d};if(!1===t(c.feature(p,o),a,s))return!1}})}function s(e,t){l(e,function(e,a,r){var i=0;if(e.geometry){var n=e.geometry.type;if("Point"!==n&&"MultiPoint"!==n){var l=0,s=0,d=0,p;if(!1===o(e,function(o,n,u,g,m){if(void 0===p||a>l||g>s||m>d)return p=o,l=a,s=g,d=m,void(i=0);var h=c.lineString([p,o],e.properties);return!1!==t(h,a,r,m,i)&&void(i++,p=o)}))return!1}}})}function d(e,t){if(!e)throw new Error("geojson is required");l(e,function(e,a,o){if(null!==e.geometry){var r=e.geometry.type,i=e.geometry.coordinates;switch(r){case"LineString":if(!1===t(e,a,o,0,0))return!1;break;case"Polygon":for(var n=0;n<i.length;n++)if(!1===t(c.lineString(i[n],e.properties),a,o,n))return!1;}}})}Object.defineProperty(a,"__esModule",{value:!0});var c=e("@turf/helpers");a.coordEach=o,a.coordReduce=function(e,t,a,r){var i=a;return o(e,function(e,o,r,n,l){i=0===o&&void 0===a?e:t(i,e,o,r,n,l)},r),i},a.propEach=r,a.propReduce=function(e,t,a){var o=a;return r(e,function(e,r){o=0===r&&void 0===a?e:t(o,e,r)}),o},a.featureEach=i,a.featureReduce=function(e,t,a){var o=a;return i(e,function(e,r){o=0===r&&void 0===a?e:t(o,e,r)}),o},a.coordAll=function(e){var t=[];return o(e,function(e){t.push(e)}),t},a.geomEach=n,a.geomReduce=function(e,t,a){var o=a;return n(e,function(e,r,i,n,l){o=0===r&&void 0===a?e:t(o,e,r,i,n,l)}),o},a.flattenEach=l,a.flattenReduce=function(e,t,a){var o=a;return l(e,function(e,r,i){o=0===r&&0===i&&void 0===a?e:t(o,e,r,i)}),o},a.segmentEach=s,a.segmentReduce=function(e,t,a){var o=a,r=!1;return s(e,function(e,i,n,l,s){o=!1===r&&void 0===a?e:t(o,e,i,n,l,s),r=!0}),o},a.lineEach=d,a.lineReduce=function(e,t,a){var o=a;return d(e,function(e,r,i,n){o=0===r&&void 0===a?e:t(o,e,r,i,n)}),o},a.findSegment=function(e,t){if(t=t||{},!c.isObject(t))throw new Error("options is invalid");var a=t.featureIndex||0,o=t.multiFeatureIndex||0,r=t.geometryIndex||0,i=t.segmentIndex||0,n=t.properties,l;switch(e.type){case"FeatureCollection":0>a&&(a=e.features.length+a),n=n||e.features[a].properties,l=e.features[a].geometry;break;case"Feature":n=n||e.properties,l=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":l=e;break;default:throw new Error("geojson is invalid");}if(null===l)return null;var s=l.coordinates;switch(l.type){case"Point":case"MultiPoint":return null;case"LineString":return 0>i&&(i=s.length+i-1),c.lineString([s[i],s[i+1]],n,t);case"Polygon":return 0>r&&(r=s.length+r),0>i&&(i=s[r].length+i-1),c.lineString([s[r][i],s[r][i+1]],n,t);case"MultiLineString":return 0>o&&(o=s.length+o),0>i&&(i=s[o].length+i-1),c.lineString([s[o][i],s[o][i+1]],n,t);case"MultiPolygon":return 0>o&&(o=s.length+o),0>r&&(r=s[o].length+r),0>i&&(i=s[o][r].length-i-1),c.lineString([s[o][r][i],s[o][r][i+1]],n,t);}throw new Error("geojson is invalid")},a.findPoint=function(e,t){if(t=t||{},!c.isObject(t))throw new Error("options is invalid");var a=t.featureIndex||0,o=t.multiFeatureIndex||0,r=t.geometryIndex||0,i=t.coordIndex||0,n=t.properties,l;switch(e.type){case"FeatureCollection":0>a&&(a=e.features.length+a),n=n||e.features[a].properties,l=e.features[a].geometry;break;case"Feature":n=n||e.properties,l=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":l=e;break;default:throw new Error("geojson is invalid");}if(null===l)return null;var s=l.coordinates;switch(l.type){case"Point":return c.point(s,n,t);case"MultiPoint":return 0>o&&(o=s.length+o),c.point(s[o],n,t);case"LineString":return 0>i&&(i=s.length+i),c.point(s[i],n,t);case"Polygon":return 0>r&&(r=s.length+r),0>i&&(i=s[r].length+i),c.point(s[r][i],n,t);case"MultiLineString":return 0>o&&(o=s.length+o),0>i&&(i=s[o].length+i),c.point(s[o][i],n,t);case"MultiPolygon":return 0>o&&(o=s.length+o),0>r&&(r=s[o].length+r),0>i&&(i=s[o][r].length-i),c.point(s[o][r][i],n,t);}throw new Error("geojson is invalid")}},{"@turf/helpers":12}],14:[function(e,t){'use strict';var a="undefined"==typeof WeakMap?e("weak-map"):WeakMap,o=e("gl-buffer"),r=e("gl-vao"),i=new a;t.exports=function(e){var t=i.get(e),a=t&&(t._triangleBuffer.handle||t._triangleBuffer.buffer);if(!a||!e.isBuffer(a)){var n=o(e,new Float32Array([-1,-1,-1,4,4,-1]));t=r(e,[{buffer:n,type:e.FLOAT,size:2}]),t._triangleBuffer=n,i.set(e,t)}t.bind(),e.drawArrays(e.TRIANGLES,0,3),t.unbind()}},{"gl-buffer":220,"gl-vao":297,"weak-map":1390}],15:[function(e,t){t.exports=function(e){var t=0,a=0,o=0,r=0;return e.map(function(e){e=e.slice();var n=e[0],l=n.toUpperCase();if(n!=l)switch(e[0]=l,n){case"a":e[6]+=o,e[7]+=r;break;case"v":e[1]+=r;break;case"h":e[1]+=o;break;default:for(var s=1;s<e.length;)e[s++]+=o,e[s++]+=r;}return"Z"===l?(o=t,r=a):"H"===l?o=e[1]:"V"===l?r=e[1]:"M"===l?(o=t=e[1],r=a=e[2]):(o=e[e.length-2],r=e[e.length-1]),e})}},{}],16:[function(e,t){function a(e,t,a,o){return s=s||(document.addEventListener?{add:r,rm:i}:{add:n,rm:l}),s.add(e,t,a,o)}function o(e,t,a,o){return s=s||(document.addEventListener?{add:r,rm:i}:{add:n,rm:l}),s.rm(e,t,a,o)}function r(e,t,a,o){e.addEventListener(t,a,o)}function i(e,t,a,o){e.removeEventListener(t,a,o)}function n(e,t,a,o){if(o)throw new Error("cannot useCapture in oldIE");e.attachEvent("on"+t,a)}function l(e,t,a){e.detachEvent("on"+t,a)}a.removeEventListener=o,a.addEventListener=a,t.exports=a;var s=null},{}],17:[function(e,t){var a=e("pad-left");t.exports=function(e,t,o){t="number"==typeof t?t:1,o=o||": ";var r=e.split(/\r?\n/),n=(r.length+t-1+"").length;return r.map(function(e,r){var i=r+t,l=(i+"").length,s=a(i,n-l);return s+o+e}).join("\n")}},{"pad-left":441}],18:[function(e,t){'use strict';function a(e,t){for(var a=Array(t+1),n=0;n<e.length;++n)a[n]=e[n];for(var n=0;n<=e.length;++n){for(var l=e.length,s;l<=t;++l){s=Array(t);for(var d=0;d<t;++d)s[d]=Math.pow(l+1-n,d);a[l]=s}var c=r.apply(void 0,a);if(c)return!0}return!1}t.exports=function(e){var t=e.length;if(0===t)return[];if(1===t)return[0];for(var o=e[0].length,r=[e[0]],n=[0],l=1;l<t;++l){if(r.push(e[l]),!a(r,o)){r.pop();continue}if(n.push(l),n.length===o+1)return n}return n};var r=e("robust-orientation")},{"robust-orientation":1277}],19:[function(e,t){'use strict';t.exports=function(e,t){return a(t).filter(function(a){for(var r=Array(a.length),n=0;n<a.length;++n)r[n]=t[a[n]];return 1>o(r)*e})};var a=e("delaunay-triangulate"),o=e("circumradius")},{circumradius:61,"delaunay-triangulate":111}],20:[function(e,t){t.exports=function(e,t){return o(a(e,t))};var a=e("alpha-complex"),o=e("simplicial-complex-boundary")},{"alpha-complex":19,"simplicial-complex-boundary":1288}],21:[function(e,t){'use strict';var a=Math.floor;t.exports=function(e,t){if(!e||null==e.length)throw Error("Argument should be an array");t=null==t?1:a(t);for(var o=Array(2*t),r=0;r<t;r++){for(var n=-Infinity,s=1/0,d=r,c=e.length;d<c;d+=t)e[d]>n&&(n=e[d]),e[d]<s&&(s=e[d]);o[r]=s,o[t+r]=n}return o}},{}],22:[function(e,t){'use strict';var a=e("array-bounds");t.exports=function(e,t,o){if(!e||null==e.length)throw Error("Argument should be an array");null==t&&(t=1),null==o&&(o=a(e,t));for(var r=0;r<t;r++){var n=o[t+r],s=o[r],d=r,c=e.length;if(n===1/0&&s===-Infinity)for(d=r;d<c;d+=t)e[d]=e[d]===n?1:e[d]===s?0:.5;else if(n===1/0)for(d=r;d<c;d+=t)e[d]=e[d]===n?1:0;else if(s===-Infinity)for(d=r;d<c;d+=t)e[d]=e[d]===s?0:1;else{var l=n-s;for(d=r;d<c;d+=t)isNaN(e[d])||(e[d]=0===l?.5:(e[d]-s)/l)}}return e}},{"array-bounds":21}],23:[function(e,t){t.exports=function(e,t){var o="number"==typeof e,r="number"==typeof t;o&&!r?(t=e,e=0):!o&&!r&&(e=0,t=0),e|=0,t|=0;var n=t-e;if(0>n)throw new Error("array length must be positive");for(var l=Array(n),a=0,s=e;a<n;a++,s++)l[a]=s;return l}},{}],24:[function(e,t){t.exports=function(e){return atob(e)}},{}],25:[function(e,t){'use strict';function a(e){for(var t=0,a=0;a<e.length;++a)t+=e[a];return t}t.exports=function(e,t){for(var r=t.length,n=Array(r+1),l=0,s;l<r;++l){s=Array(r+1);for(var d=0;d<=r;++d)s[d]=e[d][l];n[l]=s}n[r]=Array(r+1);for(var l=0;l<=r;++l)n[r][l]=1;for(var c=Array(r+1),l=0;l<r;++l)c[l]=t[l];c[r]=1;var p=o(n,c),u=a(p[r+1]);0===u&&(u=1);for(var g=Array(r+1),l=0;l<=r;++l)g[l]=a(p[l])/u;return g};var o=e("robust-linear-solve")},{"robust-linear-solve":1276}],26:[function(e,t){'use strict';var o=e("./lib/rationalize");t.exports=function(e,t){return o(e[0].mul(t[1]).add(t[0].mul(e[1])),e[1].mul(t[1]))}},{"./lib/rationalize":36}],27:[function(e,t){'use strict';t.exports=function(e,t){return e[0].mul(t[1]).cmp(t[0].mul(e[1]))}},{}],28:[function(e,t){'use strict';var o=e("./lib/rationalize");t.exports=function(e,t){return o(e[0].mul(t[1]),e[1].mul(t[0]))}},{"./lib/rationalize":36}],29:[function(e,t){'use strict';var r=Math.pow,i=Math.floor;function o(e,t){if(n(e))return t?p(e,o(t)):[e[0].clone(),e[1].clone()];var u=0,g,m;if(l(e))g=e.clone();else if("string"==typeof e)g=d(e);else{if(0===e)return[s(0),s(1)];if(e===i(e))g=s(e);else{for(;e!==i(e);)e*=r(2,256),u-=256;g=s(e)}}if(n(t))g.mul(t[1]),m=t[0].clone();else if(l(t))m=t.clone();else if("string"==typeof t)m=d(t);else if(!t)m=s(1);else if(t===i(t))m=s(t);else{for(;t!==i(t);)t*=r(2,256),u+=256;m=s(t)}return 0<u?g=g.ushln(u):0>u&&(m=m.ushln(-u)),c(g,m)}var n=e("./is-rat"),l=e("./lib/is-bn"),s=e("./lib/num-to-bn"),d=e("./lib/str-to-bn"),c=e("./lib/rationalize"),p=e("./div");t.exports=o},{"./div":28,"./is-rat":30,"./lib/is-bn":34,"./lib/num-to-bn":35,"./lib/rationalize":36,"./lib/str-to-bn":37}],30:[function(e,t){'use strict';var a=e("./lib/is-bn");t.exports=function(e){return Array.isArray(e)&&2===e.length&&a(e[0])&&a(e[1])}},{"./lib/is-bn":34}],31:[function(e,t){'use strict';var a=e("bn.js");t.exports=function(e){return e.cmp(new a(0))}},{"bn.js":45}],32:[function(e,t){'use strict';var a=Math.pow,o=e("./bn-sign");t.exports=function(e){var t=e.length,r=e.words,n=0;if(1===t)n=r[0];else if(2===t)n=r[0]+67108864*r[1];else for(var l=0,s;l<t;l++)s=r[l],n+=s*a(67108864,l);return o(e)*n}},{"./bn-sign":31}],33:[function(e,t){'use strict';var a=e("double-bits"),o=e("bit-twiddle").countTrailingZeros;t.exports=function(e){var t=o(a.lo(e));if(32>t)return t;var r=o(a.hi(e));return 20<r?52:r+32}},{"bit-twiddle":43,"double-bits":113}],34:[function(e,t){'use strict';e("bn.js");t.exports=function(e){return e&&"object"==typeof e&&!!e.words}},{"bn.js":45}],35:[function(e,t){'use strict';var a=Math.pow,o=e("bn.js"),r=e("double-bits");t.exports=function(t){var i=r.exponent(t);return 52>i?new o(t):new o(t*a(2,52-i)).ushln(i-52)}},{"bn.js":45,"double-bits":113}],36:[function(e,t){'use strict';var a=e("./num-to-bn"),o=e("./bn-sign");t.exports=function(e,t){var r=o(e),i=o(t);if(0===r)return[a(0),a(1)];if(0===i)return[a(0),a(0)];0>i&&(e=e.neg(),t=t.neg());var n=e.gcd(t);return n.cmpn(1)?[e.div(n),t.div(n)]:[e,t]}},{"./bn-sign":31,"./num-to-bn":35}],37:[function(e,t){'use strict';var a=e("bn.js");t.exports=function(e){return new a(e)}},{"bn.js":45}],38:[function(e,t){'use strict';var o=e("./lib/rationalize");t.exports=function(e,t){return o(e[0].mul(t[0]),e[1].mul(t[1]))}},{"./lib/rationalize":36}],39:[function(e,t){'use strict';var a=e("./lib/bn-sign");t.exports=function(e){return a(e[0])*a(e[1])}},{"./lib/bn-sign":31}],40:[function(e,t){'use strict';var o=e("./lib/rationalize");t.exports=function(e,t){return o(e[0].mul(t[1]).sub(e[1].mul(t[0])),e[1].mul(t[1]))}},{"./lib/rationalize":36}],41:[function(e,t){'use strict';var o=Math.pow,r=e("./lib/bn-to-num"),i=e("./lib/ctz");t.exports=function(e){var t=e[0],a=e[1];if(0===t.cmpn(0))return 0;var n=t.abs().divmod(a.abs()),l=n.div,d=r(l),c=n.mod,p=t.negative===a.negative?1:-1;if(0===c.cmpn(0))return p*d;if(d){var u=i(d)+4,s=r(c.ushln(u).divRound(a));return p*(d+s*o(2,-u))}var g=a.bitLength()-c.bitLength()+53,s=r(c.ushln(g).divRound(a));return 1023>g?p*s*o(2,-g):(s*=o(2,-1023),p*s*o(2,1023-g))}},{"./lib/bn-to-num":32,"./lib/ctz":33}],42:[function(e,t){"use strict";function a(e,t,a,o,r){var i=["function ",e,"(a,l,h,",o.join(","),"){",r?"":"var i=",a?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a[m]"];return r?0>t.indexOf("c")?i.push(";if(x===y){return m}else if(x<=y){"):i.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):i.push(";if(",t,"){i=m;"),a?i.push("l=m+1}else{h=m-1}"):i.push("h=m-1}else{l=m+1}"),i.push("}"),r?i.push("return -1};"):i.push("return i};"),i.join("")}function o(e,t,o,r){var i=new Function([a("A","x"+e+"y",t,["y"],r),a("P","c(x,y)"+e+"0",t,["y","c"],r),"function dispatchBsearch",o,"(a,y,c,l,h){if(typeof(c)==='function'){return P(a,(l===void 0)?0:l|0,(h===void 0)?a.length-1:h|0,y,c)}else{return A(a,(c===void 0)?0:c|0,(l===void 0)?a.length-1:l|0,y)}}return dispatchBsearch",o].join(""));return i()}t.exports={ge:o(">=",!1,"GE"),gt:o(">",!1,"GT"),lt:o("<",!0,"LT"),le:o("<=",!0,"LE"),eq:o("-",!0,"EQ",!0)}},{}],43:[function(e,t,a){"use strict";"use restrict";function o(e){var t=32;return e&=-e,e&&t--,65535&e&&(t-=16),16711935&e&&(t-=8),252645135&e&&(t-=4),858993459&e&&(t-=2),1431655765&e&&(t-=1),t}a.INT_BITS=32,a.INT_MAX=2147483647,a.INT_MIN=-2147483648,a.sign=function(e){return(0<e)-(0>e)},a.abs=function(e){var t=e>>31;return(e^t)-t},a.min=function(e,t){return t^(e^t)&-(e<t)},a.max=function(e,t){return e^(e^t)&-(e<t)},a.isPow2=function(e){return!(e&e-1)&&!!e},a.log2=function(e){var t,a;return t=(65535<e)<<4,e>>>=t,a=(255<e)<<3,e>>>=a,t|=a,a=(15<e)<<2,e>>>=a,t|=a,a=(3<e)<<1,e>>>=a,t|=a,t|e>>1},a.log10=function(e){return 1e9<=e?9:1e8<=e?8:1e7<=e?7:1e6<=e?6:1e5<=e?5:1e4<=e?4:1e3<=e?3:100<=e?2:10<=e?1:0},a.popCount=function(e){return e-=1431655765&e>>>1,e=(858993459&e)+(858993459&e>>>2),16843009*(252645135&e+(e>>>4))>>>24},a.countTrailingZeros=o,a.nextPow2=function(e){return e+=0===e,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e+1},a.prevPow2=function(e){return e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e-(e>>>1)},a.parity=function(e){return e^=e>>>16,e^=e>>>8,e^=e>>>4,e&=15,1&27030>>>e};var r=Array(256);(function(e){for(var t=0;256>t;++t){var a=t,o=t,n=7;for(a>>>=1;a;a>>>=1)o<<=1,o|=1&a,--n;e[t]=255&o<<n}})(r),a.reverse=function(e){return r[255&e]<<24|r[255&e>>>8]<<16|r[255&e>>>16]<<8|r[255&e>>>24]},a.interleave2=function(e,t){return e&=65535,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t&=65535,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e|t<<1},a.deinterleave2=function(e,t){return e=1431655765&e>>>t,e=858993459&(e|e>>>1),e=252645135&(e|e>>>2),e=16711935&(e|e>>>4),e=65535&(e|e>>>16),e<<16>>16},a.interleave3=function(e,t,a){return e&=1023,e=4278190335&(e|e<<16),e=251719695&(e|e<<8),e=3272356035&(e|e<<4),e=1227133513&(e|e<<2),t&=1023,t=4278190335&(t|t<<16),t=251719695&(t|t<<8),t=3272356035&(t|t<<4),t=1227133513&(t|t<<2),e|=t<<1,a&=1023,a=4278190335&(a|a<<16),a=251719695&(a|a<<8),a=3272356035&(a|a<<4),a=1227133513&(a|a<<2),e|a<<2},a.deinterleave3=function(e,t){return e=1227133513&e>>>t,e=3272356035&(e|e>>>2),e=251719695&(e|e>>>4),e=4278190335&(e|e>>>8),e=1023&(e|e>>>16),e<<22>>22},a.nextCombination=function(e){var a=e|e-1;return a+1|(~a&-~a)-1>>>o(e)+1}},{}],44:[function(e,t){'use strict';var n=Math.pow,s=Math.max,d=Math.floor;function o(e,t,a,o,i,n,l){for(var s=0;s<t;s++){for(var d=0;d<a;d++)o[d]=e[d*t+s];for(r(o,i,n,l,a),d=0;d<a;d++)e[d*t+s]=i[d]}for(d=0;d<a;d++){for(s=0;s<t;s++)o[s]=e[d*t+s];for(r(o,i,n,l,t),s=0;s<t;s++)e[d*t+s]=Math.sqrt(i[s])}}function r(e,t,a,o,r){a[0]=0,o[0]=-100000000000000000000,o[1]=100000000000000000000;for(var i=1,n=0,l;i<r;i++){for(l=(e[i]+i*i-(e[a[n]]+a[n]*a[n]))/(2*i-2*a[n]);l<=o[n];)n--,l=(e[i]+i*i-(e[a[n]]+a[n]*a[n]))/(2*i-2*a[n]);n++,a[n]=i,o[n]=l,o[n+1]=100000000000000000000}for(i=0,n=0;i<r;i++){for(;o[n+1]<i;)n++;t[i]=(i-a[n])*(i-a[n])+e[a[n]]}}var c=e("clamp");t.exports=function(e,t){t||(t={});var r=null==t.cutoff?.25:t.cutoff,p=null==t.radius?8:t.radius,u=t.channel||0,g,m,y,x,_,b,k,T,A,S,C;if(ArrayBuffer.isView(e)||Array.isArray(e)){if(!t.width||!t.height)throw Error("For raw data width and height should be provided by options");g=t.width,m=t.height,x=e,b=t.stride?t.stride:d(e.length/g/m)}else window.HTMLCanvasElement&&e instanceof window.HTMLCanvasElement?(T=e,k=T.getContext("2d"),g=T.width,m=T.height,A=k.getImageData(0,0,g,m),x=A.data,b=4):window.CanvasRenderingContext2D&&e instanceof window.CanvasRenderingContext2D?(T=e.canvas,k=e,g=T.width,m=T.height,A=k.getImageData(0,0,g,m),x=A.data,b=4):window.ImageData&&e instanceof window.ImageData&&(A=e,g=e.width,m=e.height,x=A.data,b=4);if(y=s(g,m),window.Uint8ClampedArray&&x instanceof window.Uint8ClampedArray||window.Uint8Array&&x instanceof window.Uint8Array)for(_=x,x=Array(g*m),(S=0,C=_.length);S<C;S++)x[S]=_[S*b+u]/255;else if(1!==b)throw Error("Raw data can have only 1 value per pixel");var L=Array(g*m),E=Array(g*m),I=Array(y),f=Array(y),P=Array(y+1),z=Array(y);for(S=0,C=g*m;S<C;S++){var v=x[S];L[S]=1===v?0:0===v?100000000000000000000:n(s(0,.5-v),2),E[S]=1===v?100000000000000000000:0===v?0:n(s(0,v-.5),2)}o(L,g,m,I,f,z,P),o(E,g,m,I,f,z,P);var a=window.Float32Array?new Float32Array(g*m):Array(g*m);for(S=0,C=g*m;S<C;S++)a[S]=c(1-((L[S]-E[S])/p+r),0,1);return a}},{clamp:62}],45:[function(e,t){var a=Math.cos,o=Math.ceil,r=Math.round,i=Math.PI,n=Math.sin,l=Math.min,d=Math.max;(function(t,s){'use strict';var C=Math.imul,L=Math.clz32;function u(e,t){if(!e)throw new Error(t||"Assertion failed")}function g(e,t){e.super_=t;var a=function(){};a.prototype=t.prototype,e.prototype=new a,e.prototype.constructor=e}function h(e,t,a){return h.isBN(e)?e:void(this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&(("le"===t||"be"===t)&&(a=t,t=10),this._init(e||0,t||10,a||"be")))}function c(e,t,a){for(var o=0,n=l(e.length,a),s=t,d;s<n;s++)d=e.charCodeAt(s)-48,o<<=4,o|=49<=d&&54>=d?d-49+10:17<=d&&22>=d?d-17+10:15&d;return o}function p(e,t,a,o){for(var n=0,s=l(e.length,a),d=t,p;d<s;d++)p=e.charCodeAt(d)-48,n*=o,n+=49<=p?p-49+10:17<=p?p-17+10:p;return n}function m(e){for(var t=Array(e.bitLength()),a=0;a<t.length;a++){var o=0|a/26,r=a%26;t[a]=(e.words[o]&1<<r)>>>r}return t}function y(e,t,o){o.negative=t.negative^e.negative;var n=0|e.length+t.length;o.length=n,n=0|n-1;var s=0|e.words[0],c=0|t.words[0],p=s*c,u=67108863&p,g=0|p/67108864;o.words[0]=u;for(var m=1;m<n;m++){for(var h=g>>>26,y=67108863&g,f=l(m,t.length-1),x=d(0,m-e.length+1),_;x<=f;x++)_=0|m-x,s=0|e.words[_],c=0|t.words[x],p=s*c+y,h+=0|p/67108864,y=67108863&p;o.words[m]=0|y,g=0|h}return 0===g?o.length--:o.words[m]=0|g,o.strip()}function f(e,t,o){o.negative=t.negative^e.negative,o.length=e.length+t.length;for(var n=0,s=0,c=0,p;c<o.length-1;c++){p=s,s=0;for(var u=67108863&n,g=l(c,t.length-1),m=d(0,c-e.length+1);m<=g;m++){var h=c-m,i=0|e.words[h],a=0|t.words[m],y=i*a,r=67108863&y;p=0|p+(0|y/67108864),r=0|r+u,u=67108863&r,p=0|p+(r>>>26),s+=p>>>26,p&=67108863}o.words[c]=u,n=p,p=s}return 0===n?o.length--:o.words[c]=n,o.strip()}function x(e,t,a){var o=new _;return o.mulp(e,t,a)}function _(e,t){this.x=e,this.y=t}function b(e,t){this.name=e,this.p=new h(t,16),this.n=this.p.bitLength(),this.k=new h(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function v(){b.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function w(){b.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function k(){b.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function T(){b.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function A(e){if("string"==typeof e){var t=h._prime(e);this.m=t.p,this.prime=t}else u(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function S(e){A.call(this,e),this.shift=this.m.bitLength(),0!=this.shift%26&&(this.shift+=26-this.shift%26),this.r=new h(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}"object"==typeof t?t.exports=h:s.BN=h,h.BN=h,h.wordSize=26;var E;try{E=e("buffer").Buffer}catch(t){}h.isBN=function(e){return!!(e instanceof h)||null!==e&&"object"==typeof e&&e.constructor.wordSize===h.wordSize&&Array.isArray(e.words)},h.max=function(e,t){return 0<e.cmp(t)?e:t},h.min=function(e,t){return 0>e.cmp(t)?e:t},h.prototype._init=function(e,t,a){if("number"==typeof e)return this._initNumber(e,t,a);if("object"==typeof e)return this._initArray(e,t,a);"hex"===t&&(t=16),u(t===(0|t)&&2<=t&&36>=t),e=e.toString().replace(/\s+/g,"");var o=0;"-"===e[0]&&o++,16===t?this._parseHex(e,o):this._parseBase(e,t,o),"-"===e[0]&&(this.negative=1),this.strip();"le"!==a||this._initArray(this.toArray(),t,a)},h.prototype._initNumber=function(e,t,a){0>e&&(this.negative=1,e=-e),67108864>e?(this.words=[67108863&e],this.length=1):4503599627370496>e?(this.words=[67108863&e,67108863&e/67108864],this.length=2):(u(9007199254740992>e),this.words=[67108863&e,67108863&e/67108864,1],this.length=3);"le"!==a||this._initArray(this.toArray(),t,a)},h.prototype._initArray=function(e,t,a){if(u("number"==typeof e.length),0>=e.length)return this.words=[0],this.length=1,this;this.length=o(e.length/3),this.words=Array(this.length);for(var r=0;r<this.length;r++)this.words[r]=0;var n=0,l,s;if("be"===a)for(r=e.length-1,l=0;0<=r;r-=3)s=e[r]|e[r-1]<<8|e[r-2]<<16,this.words[l]|=67108863&s<<n,this.words[l+1]=67108863&s>>>26-n,n+=24,26<=n&&(n-=26,l++);else if("le"===a)for(r=0,l=0;r<e.length;r+=3)s=e[r]|e[r+1]<<8|e[r+2]<<16,this.words[l]|=67108863&s<<n,this.words[l+1]=67108863&s>>>26-n,n+=24,26<=n&&(n-=26,l++);return this.strip()},h.prototype._parseHex=function(e,t){this.length=o((e.length-t)/6),this.words=Array(this.length);for(var a=0;a<this.length;a++)this.words[a]=0;var r=0,n,l;for(a=e.length-6,n=0;a>=t;a-=6)l=c(e,a,a+6),this.words[n]|=67108863&l<<r,this.words[n+1]|=4194303&l>>>26-r,r+=24,26<=r&&(r-=26,n++);a+6!==t&&(l=c(e,t,a+6),this.words[n]|=67108863&l<<r,this.words[n+1]|=4194303&l>>>26-r),this.strip()},h.prototype._parseBase=function(e,t,a){this.words=[0],this.length=1;for(var o=0,r=1;67108863>=r;r*=t)o++;o--,r=0|r/t;for(var n=e.length-a,s=n%o,d=l(n,n-s)+a,c=0,u=a;u<d;u+=o)c=p(e,u,u+o,t),this.imuln(r),67108864>this.words[0]+c?this.words[0]+=c:this._iaddn(c);if(0!==s){var g=1;for(c=p(e,u,e.length,t),u=0;u<s;u++)g*=t;this.imuln(g),67108864>this.words[0]+c?this.words[0]+=c:this._iaddn(c)}},h.prototype.copy=function(e){e.words=Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},h.prototype.clone=function(){var e=new h(null);return this.copy(e),e},h.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},h.prototype.strip=function(){for(;1<this.length&&0===this.words[this.length-1];)this.length--;return this._normSign()},h.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},h.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var I=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],P=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],z=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];h.prototype.toString=function(e,t){e=e||10,t=0|t||1;var a;if(16===e||"hex"===e){a="";for(var o=0,n=0,l=0;l<this.length;l++){var s=this.words[l],d=(16777215&(s<<o|n)).toString(16);n=16777215&s>>>24-o,a=0!==n||l!==this.length-1?I[6-d.length]+d+a:d+a,o+=2,26<=o&&(o-=26,l--)}for(0!==n&&(a=n.toString(16)+a);0!=a.length%t;)a="0"+a;return 0!==this.negative&&(a="-"+a),a}if(e===(0|e)&&2<=e&&36>=e){var p=P[e],g=z[e];a="";var m=this.clone();for(m.negative=0;!m.isZero();){var h=m.modn(g).toString(e);m=m.idivn(g),a=m.isZero()?h+a:I[p-h.length]+h+a}for(this.isZero()&&(a="0"+a);0!=a.length%t;)a="0"+a;return 0!==this.negative&&(a="-"+a),a}u(!1,"Base should be between 2 and 36")},h.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:2<this.length&&u(!1,"Number can only safely store up to 53 bits"),0===this.negative?e:-e},h.prototype.toJSON=function(){return this.toString(16)},h.prototype.toBuffer=function(e,t){return u("undefined"!=typeof E),this.toArrayLike(E,e,t)},h.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},h.prototype.toArrayLike=function(e,t,a){var o=this.byteLength(),r=a||d(1,o);u(o<=r,"byte array longer than desired length"),u(0<r,"Requested array length <= 0"),this.strip();var n=new e(r),l=this.clone(),s,c;if(!("le"===t)){for(c=0;c<r-o;c++)n[c]=0;for(c=0;!l.isZero();c++)s=l.andln(255),l.iushrn(8),n[r-c-1]=s}else{for(c=0;!l.isZero();c++)s=l.andln(255),l.iushrn(8),n[c]=s;for(;c<r;c++)n[c]=0}return n},h.prototype._countBits=L?function(e){return 32-L(e)}:function(e){var a=e,o=0;return 4096<=a&&(o+=13,a>>>=13),64<=a&&(o+=7,a>>>=7),8<=a&&(o+=4,a>>>=4),2<=a&&(o+=2,a>>>=2),o+a},h.prototype._zeroBits=function(e){if(0===e)return 26;var a=e,o=0;return 0==(8191&a)&&(o+=13,a>>>=13),0==(127&a)&&(o+=7,a>>>=7),0==(15&a)&&(o+=4,a>>>=4),0==(3&a)&&(o+=2,a>>>=2),0==(1&a)&&o++,o},h.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},h.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0,a;t<this.length&&(a=this._zeroBits(this.words[t]),e+=a,26===a);t++);return e},h.prototype.byteLength=function(){return o(this.bitLength()/8)},h.prototype.toTwos=function(e){return 0===this.negative?this.clone():this.abs().inotn(e).iaddn(1)},h.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},h.prototype.isNeg=function(){return 0!==this.negative},h.prototype.neg=function(){return this.clone().ineg()},h.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},h.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]|=e.words[t];return this.strip()},h.prototype.ior=function(e){return u(0==(this.negative|e.negative)),this.iuor(e)},h.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},h.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},h.prototype.iuand=function(e){var t=this.length>e.length?e:this;for(var a=0;a<t.length;a++)this.words[a]&=e.words[a];return this.length=t.length,this.strip()},h.prototype.iand=function(e){return u(0==(this.negative|e.negative)),this.iuand(e)},h.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},h.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},h.prototype.iuxor=function(e){var t,o;this.length>e.length?(t=this,o=e):(t=e,o=this);for(var r=0;r<o.length;r++)this.words[r]=t.words[r]^o.words[r];if(this!==t)for(;r<t.length;r++)this.words[r]=t.words[r];return this.length=t.length,this.strip()},h.prototype.ixor=function(e){return u(0==(this.negative|e.negative)),this.iuxor(e)},h.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},h.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},h.prototype.inotn=function(e){u("number"==typeof e&&0<=e);var t=0|o(e/26),a=e%26;this._expand(t),0<a&&t--;for(var r=0;r<t;r++)this.words[r]=67108863&~this.words[r];return 0<a&&(this.words[r]=~this.words[r]&67108863>>26-a),this.strip()},h.prototype.notn=function(e){return this.clone().inotn(e)},h.prototype.setn=function(e,t){u("number"==typeof e&&0<=e);var a=0|e/26,o=e%26;return this._expand(a+1),t?this.words[a]|=1<<o:this.words[a]&=~(1<<o),this.strip()},h.prototype.iadd=function(e){var t;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();var o,n;this.length>e.length?(o=this,n=e):(o=e,n=this);for(var l=0,s=0;s<n.length;s++)t=(0|o.words[s])+(0|n.words[s])+l,this.words[s]=67108863&t,l=t>>>26;for(;0!==l&&s<o.length;s++)t=(0|o.words[s])+l,this.words[s]=67108863&t,l=t>>>26;if(this.length=o.length,0!==l)this.words[this.length]=l,this.length++;else if(o!==this)for(;s<o.length;s++)this.words[s]=o.words[s];return this},h.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},h.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var o=this.cmp(e);if(0===o)return this.negative=0,this.length=1,this.words[0]=0,this;var n,l;0<o?(n=this,l=e):(n=e,l=this);for(var s=0,c=0;c<l.length;c++)t=(0|n.words[c])-(0|l.words[c])+s,s=t>>26,this.words[c]=67108863&t;for(;0!==s&&c<n.length;c++)t=(0|n.words[c])+s,s=t>>26,this.words[c]=67108863&t;if(0===s&&c<n.length&&n!==this)for(;c<n.length;c++)this.words[c]=n.words[c];return this.length=d(this.length,c),n!==this&&(this.negative=1),this.strip()},h.prototype.sub=function(e){return this.clone().isub(e)};var D=function(e,t,r){var i=e.words,a=t.words,n=r.words,o=0,l=0|i[0],s=8191&l,d=l>>>13,p=0|i[1],u=8191&p,g=p>>>13,m=0|i[2],h=8191&m,y=m>>>13,f=0|i[3],x=8191&f,_=f>>>13,b=0|i[4],v=8191&b,w=b>>>13,k=0|i[5],T=8191&k,A=k>>>13,S=0|i[6],L=8191&S,E=S>>>13,I=0|i[7],P=8191&I,z=I>>>13,D=0|i[8],O=8191&D,R=D>>>13,M=0|i[9],j=8191&M,B=M>>>13,F=0|a[0],N=8191&F,V=F>>>13,U=0|a[1],H=8191&U,q=U>>>13,G=0|a[2],Y=8191&G,W=G>>>13,X=0|a[3],Z=8191&X,K=X>>>13,$=0|a[4],J=8191&$,Q=$>>>13,ee=0|a[5],te=8191&ee,ae=ee>>>13,oe=0|a[6],re=8191&oe,ie=oe>>>13,ne=0|a[7],le=8191&ne,se=ne>>>13,de=0|a[8],ce=8191&de,pe=de>>>13,ue=0|a[9],ge=8191&ue,me=ue>>>13,he,ye,fe;r.negative=e.negative^t.negative,r.length=19,he=C(s,N),ye=C(s,V),ye=0|ye+C(d,N),fe=C(d,V);var xe=0|(0|o+he)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(xe>>>26),xe&=67108863,he=C(u,N),ye=C(u,V),ye=0|ye+C(g,N),fe=C(g,V),he=0|he+C(s,H),ye=0|ye+C(s,q),ye=0|ye+C(d,H),fe=0|fe+C(d,q);var _e=0|(0|o+he)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(_e>>>26),_e&=67108863,he=C(h,N),ye=C(h,V),ye=0|ye+C(y,N),fe=C(y,V),he=0|he+C(u,H),ye=0|ye+C(u,q),ye=0|ye+C(g,H),fe=0|fe+C(g,q),he=0|he+C(s,Y),ye=0|ye+C(s,W),ye=0|ye+C(d,Y),fe=0|fe+C(d,W);var be=0|(0|o+he)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(be>>>26),be&=67108863,he=C(x,N),ye=C(x,V),ye=0|ye+C(_,N),fe=C(_,V),he=0|he+C(h,H),ye=0|ye+C(h,q),ye=0|ye+C(y,H),fe=0|fe+C(y,q),he=0|he+C(u,Y),ye=0|ye+C(u,W),ye=0|ye+C(g,Y),fe=0|fe+C(g,W),he=0|he+C(s,Z),ye=0|ye+C(s,K),ye=0|ye+C(d,Z),fe=0|fe+C(d,K);var ve=0|(0|o+he)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(ve>>>26),ve&=67108863,he=C(v,N),ye=C(v,V),ye=0|ye+C(w,N),fe=C(w,V),he=0|he+C(x,H),ye=0|ye+C(x,q),ye=0|ye+C(_,H),fe=0|fe+C(_,q),he=0|he+C(h,Y),ye=0|ye+C(h,W),ye=0|ye+C(y,Y),fe=0|fe+C(y,W),he=0|he+C(u,Z),ye=0|ye+C(u,K),ye=0|ye+C(g,Z),fe=0|fe+C(g,K),he=0|he+C(s,J),ye=0|ye+C(s,Q),ye=0|ye+C(d,J),fe=0|fe+C(d,Q);var we=0|(0|o+he)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(we>>>26),we&=67108863,he=C(T,N),ye=C(T,V),ye=0|ye+C(A,N),fe=C(A,V),he=0|he+C(v,H),ye=0|ye+C(v,q),ye=0|ye+C(w,H),fe=0|fe+C(w,q),he=0|he+C(x,Y),ye=0|ye+C(x,W),ye=0|ye+C(_,Y),fe=0|fe+C(_,W),he=0|he+C(h,Z),ye=0|ye+C(h,K),ye=0|ye+C(y,Z),fe=0|fe+C(y,K),he=0|he+C(u,J),ye=0|ye+C(u,Q),ye=0|ye+C(g,J),fe=0|fe+C(g,Q),he=0|he+C(s,te),ye=0|ye+C(s,ae),ye=0|ye+C(d,te),fe=0|fe+C(d,ae);var ke=0|(0|o+he)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(ke>>>26),ke&=67108863,he=C(L,N),ye=C(L,V),ye=0|ye+C(E,N),fe=C(E,V),he=0|he+C(T,H),ye=0|ye+C(T,q),ye=0|ye+C(A,H),fe=0|fe+C(A,q),he=0|he+C(v,Y),ye=0|ye+C(v,W),ye=0|ye+C(w,Y),fe=0|fe+C(w,W),he=0|he+C(x,Z),ye=0|ye+C(x,K),ye=0|ye+C(_,Z),fe=0|fe+C(_,K),he=0|he+C(h,J),ye=0|ye+C(h,Q),ye=0|ye+C(y,J),fe=0|fe+C(y,Q),he=0|he+C(u,te),ye=0|ye+C(u,ae),ye=0|ye+C(g,te),fe=0|fe+C(g,ae),he=0|he+C(s,re),ye=0|ye+C(s,ie),ye=0|ye+C(d,re),fe=0|fe+C(d,ie);var Te=0|(0|o+he)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(Te>>>26),Te&=67108863,he=C(P,N),ye=C(P,V),ye=0|ye+C(z,N),fe=C(z,V),he=0|he+C(L,H),ye=0|ye+C(L,q),ye=0|ye+C(E,H),fe=0|fe+C(E,q),he=0|he+C(T,Y),ye=0|ye+C(T,W),ye=0|ye+C(A,Y),fe=0|fe+C(A,W),he=0|he+C(v,Z),ye=0|ye+C(v,K),ye=0|ye+C(w,Z),fe=0|fe+C(w,K),he=0|he+C(x,J),ye=0|ye+C(x,Q),ye=0|ye+C(_,J),fe=0|fe+C(_,Q),he=0|he+C(h,te),ye=0|ye+C(h,ae),ye=0|ye+C(y,te),fe=0|fe+C(y,ae),he=0|he+C(u,re),ye=0|ye+C(u,ie),ye=0|ye+C(g,re),fe=0|fe+C(g,ie),he=0|he+C(s,le),ye=0|ye+C(s,se),ye=0|ye+C(d,le),fe=0|fe+C(d,se);var Ae=0|(0|o+he)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(Ae>>>26),Ae&=67108863,he=C(O,N),ye=C(O,V),ye=0|ye+C(R,N),fe=C(R,V),he=0|he+C(P,H),ye=0|ye+C(P,q),ye=0|ye+C(z,H),fe=0|fe+C(z,q),he=0|he+C(L,Y),ye=0|ye+C(L,W),ye=0|ye+C(E,Y),fe=0|fe+C(E,W),he=0|he+C(T,Z),ye=0|ye+C(T,K),ye=0|ye+C(A,Z),fe=0|fe+C(A,K),he=0|he+C(v,J),ye=0|ye+C(v,Q),ye=0|ye+C(w,J),fe=0|fe+C(w,Q),he=0|he+C(x,te),ye=0|ye+C(x,ae),ye=0|ye+C(_,te),fe=0|fe+C(_,ae),he=0|he+C(h,re),ye=0|ye+C(h,ie),ye=0|ye+C(y,re),fe=0|fe+C(y,ie),he=0|he+C(u,le),ye=0|ye+C(u,se),ye=0|ye+C(g,le),fe=0|fe+C(g,se),he=0|he+C(s,ce),ye=0|ye+C(s,pe),ye=0|ye+C(d,ce),fe=0|fe+C(d,pe);var Se=0|(0|o+he)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(Se>>>26),Se&=67108863,he=C(j,N),ye=C(j,V),ye=0|ye+C(B,N),fe=C(B,V),he=0|he+C(O,H),ye=0|ye+C(O,q),ye=0|ye+C(R,H),fe=0|fe+C(R,q),he=0|he+C(P,Y),ye=0|ye+C(P,W),ye=0|ye+C(z,Y),fe=0|fe+C(z,W),he=0|he+C(L,Z),ye=0|ye+C(L,K),ye=0|ye+C(E,Z),fe=0|fe+C(E,K),he=0|he+C(T,J),ye=0|ye+C(T,Q),ye=0|ye+C(A,J),fe=0|fe+C(A,Q),he=0|he+C(v,te),ye=0|ye+C(v,ae),ye=0|ye+C(w,te),fe=0|fe+C(w,ae),he=0|he+C(x,re),ye=0|ye+C(x,ie),ye=0|ye+C(_,re),fe=0|fe+C(_,ie),he=0|he+C(h,le),ye=0|ye+C(h,se),ye=0|ye+C(y,le),fe=0|fe+C(y,se),he=0|he+C(u,ce),ye=0|ye+C(u,pe),ye=0|ye+C(g,ce),fe=0|fe+C(g,pe),he=0|he+C(s,ge),ye=0|ye+C(s,me),ye=0|ye+C(d,ge),fe=0|fe+C(d,me);var Ce=0|(0|o+he)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(Ce>>>26),Ce&=67108863,he=C(j,H),ye=C(j,q),ye=0|ye+C(B,H),fe=C(B,q),he=0|he+C(O,Y),ye=0|ye+C(O,W),ye=0|ye+C(R,Y),fe=0|fe+C(R,W),he=0|he+C(P,Z),ye=0|ye+C(P,K),ye=0|ye+C(z,Z),fe=0|fe+C(z,K),he=0|he+C(L,J),ye=0|ye+C(L,Q),ye=0|ye+C(E,J),fe=0|fe+C(E,Q),he=0|he+C(T,te),ye=0|ye+C(T,ae),ye=0|ye+C(A,te),fe=0|fe+C(A,ae),he=0|he+C(v,re),ye=0|ye+C(v,ie),ye=0|ye+C(w,re),fe=0|fe+C(w,ie),he=0|he+C(x,le),ye=0|ye+C(x,se),ye=0|ye+C(_,le),fe=0|fe+C(_,se),he=0|he+C(h,ce),ye=0|ye+C(h,pe),ye=0|ye+C(y,ce),fe=0|fe+C(y,pe),he=0|he+C(u,ge),ye=0|ye+C(u,me),ye=0|ye+C(g,ge),fe=0|fe+C(g,me);var Le=0|(0|o+he)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(Le>>>26),Le&=67108863,he=C(j,Y),ye=C(j,W),ye=0|ye+C(B,Y),fe=C(B,W),he=0|he+C(O,Z),ye=0|ye+C(O,K),ye=0|ye+C(R,Z),fe=0|fe+C(R,K),he=0|he+C(P,J),ye=0|ye+C(P,Q),ye=0|ye+C(z,J),fe=0|fe+C(z,Q),he=0|he+C(L,te),ye=0|ye+C(L,ae),ye=0|ye+C(E,te),fe=0|fe+C(E,ae),he=0|he+C(T,re),ye=0|ye+C(T,ie),ye=0|ye+C(A,re),fe=0|fe+C(A,ie),he=0|he+C(v,le),ye=0|ye+C(v,se),ye=0|ye+C(w,le),fe=0|fe+C(w,se),he=0|he+C(x,ce),ye=0|ye+C(x,pe),ye=0|ye+C(_,ce),fe=0|fe+C(_,pe),he=0|he+C(h,ge),ye=0|ye+C(h,me),ye=0|ye+C(y,ge),fe=0|fe+C(y,me);var Ee=0|(0|o+he)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(Ee>>>26),Ee&=67108863,he=C(j,Z),ye=C(j,K),ye=0|ye+C(B,Z),fe=C(B,K),he=0|he+C(O,J),ye=0|ye+C(O,Q),ye=0|ye+C(R,J),fe=0|fe+C(R,Q),he=0|he+C(P,te),ye=0|ye+C(P,ae),ye=0|ye+C(z,te),fe=0|fe+C(z,ae),he=0|he+C(L,re),ye=0|ye+C(L,ie),ye=0|ye+C(E,re),fe=0|fe+C(E,ie),he=0|he+C(T,le),ye=0|ye+C(T,se),ye=0|ye+C(A,le),fe=0|fe+C(A,se),he=0|he+C(v,ce),ye=0|ye+C(v,pe),ye=0|ye+C(w,ce),fe=0|fe+C(w,pe),he=0|he+C(x,ge),ye=0|ye+C(x,me),ye=0|ye+C(_,ge),fe=0|fe+C(_,me);var Ie=0|(0|o+he)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(Ie>>>26),Ie&=67108863,he=C(j,J),ye=C(j,Q),ye=0|ye+C(B,J),fe=C(B,Q),he=0|he+C(O,te),ye=0|ye+C(O,ae),ye=0|ye+C(R,te),fe=0|fe+C(R,ae),he=0|he+C(P,re),ye=0|ye+C(P,ie),ye=0|ye+C(z,re),fe=0|fe+C(z,ie),he=0|he+C(L,le),ye=0|ye+C(L,se),ye=0|ye+C(E,le),fe=0|fe+C(E,se),he=0|he+C(T,ce),ye=0|ye+C(T,pe),ye=0|ye+C(A,ce),fe=0|fe+C(A,pe),he=0|he+C(v,ge),ye=0|ye+C(v,me),ye=0|ye+C(w,ge),fe=0|fe+C(w,me);var Pe=0|(0|o+he)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(Pe>>>26),Pe&=67108863,he=C(j,te),ye=C(j,ae),ye=0|ye+C(B,te),fe=C(B,ae),he=0|he+C(O,re),ye=0|ye+C(O,ie),ye=0|ye+C(R,re),fe=0|fe+C(R,ie),he=0|he+C(P,le),ye=0|ye+C(P,se),ye=0|ye+C(z,le),fe=0|fe+C(z,se),he=0|he+C(L,ce),ye=0|ye+C(L,pe),ye=0|ye+C(E,ce),fe=0|fe+C(E,pe),he=0|he+C(T,ge),ye=0|ye+C(T,me),ye=0|ye+C(A,ge),fe=0|fe+C(A,me);var ze=0|(0|o+he)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(ze>>>26),ze&=67108863,he=C(j,re),ye=C(j,ie),ye=0|ye+C(B,re),fe=C(B,ie),he=0|he+C(O,le),ye=0|ye+C(O,se),ye=0|ye+C(R,le),fe=0|fe+C(R,se),he=0|he+C(P,ce),ye=0|ye+C(P,pe),ye=0|ye+C(z,ce),fe=0|fe+C(z,pe),he=0|he+C(L,ge),ye=0|ye+C(L,me),ye=0|ye+C(E,ge),fe=0|fe+C(E,me);var De=0|(0|o+he)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(De>>>26),De&=67108863,he=C(j,le),ye=C(j,se),ye=0|ye+C(B,le),fe=C(B,se),he=0|he+C(O,ce),ye=0|ye+C(O,pe),ye=0|ye+C(R,ce),fe=0|fe+C(R,pe),he=0|he+C(P,ge),ye=0|ye+C(P,me),ye=0|ye+C(z,ge),fe=0|fe+C(z,me);var Oe=0|(0|o+he)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(Oe>>>26),Oe&=67108863,he=C(j,ce),ye=C(j,pe),ye=0|ye+C(B,ce),fe=C(B,pe),he=0|he+C(O,ge),ye=0|ye+C(O,me),ye=0|ye+C(R,ge),fe=0|fe+C(R,me);var Re=0|(0|o+he)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(Re>>>26),Re&=67108863,he=C(j,ge),ye=C(j,me),ye=0|ye+C(B,ge),fe=C(B,me);var Me=0|(0|o+he)+((8191&ye)<<13);return o=0|(0|fe+(ye>>>13))+(Me>>>26),Me&=67108863,n[0]=xe,n[1]=_e,n[2]=be,n[3]=ve,n[4]=we,n[5]=ke,n[6]=Te,n[7]=Ae,n[8]=Se,n[9]=Ce,n[10]=Le,n[11]=Ee,n[12]=Ie,n[13]=Pe,n[14]=ze,n[15]=De,n[16]=Oe,n[17]=Re,n[18]=Me,0!==o&&(n[19]=o,r.length++),r};C||(D=y),h.prototype.mulTo=function(e,t){var a=this.length+e.length,o;return o=10===this.length&&10===e.length?D(this,e,t):63>a?y(this,e,t):1024>a?f(this,e,t):x(this,e,t),o},_.prototype.makeRBT=function(e){for(var a=Array(e),t=h.prototype._countBits(e)-1,o=0;o<e;o++)a[o]=this.revBin(o,t,e);return a},_.prototype.revBin=function(e,t,a){if(0===e||e===a-1)return e;for(var o=0,r=0;r<t;r++)o|=(1&e)<<t-r-1,e>>=1;return o},_.prototype.permute=function(e,t,a,o,r,n){for(var l=0;l<n;l++)o[l]=t[e[l]],r[l]=a[e[l]]},_.prototype.transform=function(e,t,o,r,d,c){this.permute(c,e,t,o,r,d);for(var u=1;u<d;u<<=1)for(var g=u<<1,l=a(2*i/g),m=n(2*i/g),h=0;h<d;h+=g)for(var y=l,f=m,x=0;x<u;x++){var _=o[h+x],b=r[h+x],v=o[h+x+u],w=r[h+x+u],k=y*v-f*w;w=y*w+f*v,v=k,o[h+x]=_+v,r[h+x]=b+w,o[h+x+u]=_-v,r[h+x+u]=b-w,x!==g&&(k=l*y-m*f,f=l*f+m*y,y=k)}},_.prototype.guessLen13b=function(e,t){var a=1|d(t,e),o=1&a,r=0;for(a=0|a/2;a;a>>>=1)r++;return 1<<r+1+o},_.prototype.conjugate=function(e,a,o){if(!(1>=o))for(var r=0,n;r<o/2;r++)n=e[r],e[r]=e[o-r-1],e[o-r-1]=n,n=a[r],a[r]=-a[o-r-1],a[o-r-1]=-n},_.prototype.normalize13b=function(e,t){for(var a=0,o=0,n;o<t/2;o++)n=8192*r(e[2*o+1]/t)+r(e[2*o]/t)+a,e[o]=67108863&n,a=67108864>n?0:0|n/67108864;return e},_.prototype.convert13b=function(e,t,a,o){for(var r=0,n=0;n<t;n++)r+=0|e[n],a[2*n]=8191&r,r>>>=13,a[2*n+1]=8191&r,r>>>=13;for(n=2*t;n<o;++n)a[n]=0;u(0===r),u(0==(-8192&r))},_.prototype.stub=function(e){for(var t=Array(e),a=0;a<e;a++)t[a]=0;return t},_.prototype.mulp=function(e,t,a){var o=2*this.guessLen13b(e.length,t.length),r=this.makeRBT(o),n=this.stub(o),l=Array(o),s=Array(o),d=Array(o),c=Array(o),p=Array(o),u=Array(o),g=a.words;g.length=o,this.convert13b(e.words,e.length,l,o),this.convert13b(t.words,t.length,c,o),this.transform(l,n,s,d,o,r),this.transform(c,n,p,u,o,r);for(var m=0,h;m<o;m++)h=s[m]*p[m]-d[m]*u[m],d[m]=s[m]*u[m]+d[m]*p[m],s[m]=h;return this.conjugate(s,d,o),this.transform(s,d,g,n,o,r),this.conjugate(g,n,o),this.normalize13b(g,o),a.negative=e.negative^t.negative,a.length=e.length+t.length,a.strip()},h.prototype.mul=function(e){var t=new h(null);return t.words=Array(this.length+e.length),this.mulTo(e,t)},h.prototype.mulf=function(e){var t=new h(null);return t.words=Array(this.length+e.length),x(this,e,t)},h.prototype.imul=function(e){return this.clone().mulTo(e,this)},h.prototype.imuln=function(e){u("number"==typeof e),u(67108864>e);for(var t=0,a=0;a<this.length;a++){var o=(0|this.words[a])*e,r=(67108863&o)+(67108863&t);t>>=26,t+=0|o/67108864,t+=r>>>26,this.words[a]=67108863&r}return 0!==t&&(this.words[a]=t,this.length++),this},h.prototype.muln=function(e){return this.clone().imuln(e)},h.prototype.sqr=function(){return this.mul(this)},h.prototype.isqr=function(){return this.imul(this.clone())},h.prototype.pow=function(e){var t=m(e);if(0===t.length)return new h(1);for(var a=this,o=0;o<t.length&&!(0!==t[o]);o++,a=a.sqr());if(++o<t.length)for(var r=a.sqr();o<t.length;o++,r=r.sqr())0!==t[o]&&(a=a.mul(r));return a},h.prototype.iushln=function(e){u("number"==typeof e&&0<=e);var t=e%26,a=(e-t)/26,o;if(0!=t){var r=0;for(o=0;o<this.length;o++){var n=this.words[o]&67108863>>>26-t<<26-t,l=(0|this.words[o])-n<<t;this.words[o]=l|r,r=n>>>26-t}r&&(this.words[o]=r,this.length++)}if(0!==a){for(o=this.length-1;0<=o;o--)this.words[o+a]=this.words[o];for(o=0;o<a;o++)this.words[o]=0;this.length+=a}return this.strip()},h.prototype.ishln=function(e){return u(0===this.negative),this.iushln(e)},h.prototype.iushrn=function(e,t,a){u("number"==typeof e&&0<=e);var o=t?(t-t%26)/26:0;var n=e%26,r=l((e-n)/26,this.length),s=a;if(o-=r,o=d(0,o),s){for(var c=0;c<r;c++)s.words[c]=this.words[c];s.length=r}if(0===r);else if(this.length>r)for(this.length-=r,c=0;c<this.length;c++)this.words[c]=this.words[c+r];else this.words[0]=0,this.length=1;var p=0;for(c=this.length-1;0<=c&&(0!==p||c>=o);c--){var g=0|this.words[c];this.words[c]=p<<26-n|g>>>n,p=g&(67108863^67108863>>>n<<n)}return s&&0!==p&&(s.words[s.length++]=p),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},h.prototype.ishrn=function(e,t,a){return u(0===this.negative),this.iushrn(e,t,a)},h.prototype.shln=function(e){return this.clone().ishln(e)},h.prototype.ushln=function(e){return this.clone().iushln(e)},h.prototype.shrn=function(e){return this.clone().ishrn(e)},h.prototype.ushrn=function(e){return this.clone().iushrn(e)},h.prototype.testn=function(e){u("number"==typeof e&&0<=e);var t=e%26,a=(e-t)/26;if(this.length<=a)return!1;var o=this.words[a];return!!(o&1<<t)},h.prototype.imaskn=function(e){u("number"==typeof e&&0<=e);var t=e%26,a=(e-t)/26;if(u(0===this.negative,"imaskn works only with positive numbers"),this.length<=a)return this;if(0!=t&&a++,this.length=l(a,this.length),0!=t){this.words[this.length-1]&=67108863^67108863>>>t<<t}return this.strip()},h.prototype.maskn=function(e){return this.clone().imaskn(e)},h.prototype.iaddn=function(e){return u("number"==typeof e),u(67108864>e),0>e?this.isubn(-e):0===this.negative?this._iaddn(e):1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this)},h.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&67108864<=this.words[t];t++)this.words[t]-=67108864,t==this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=d(this.length,t+1),this},h.prototype.isubn=function(e){if(u("number"==typeof e),u(67108864>e),0>e)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&0>this.words[0])this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&0>this.words[t];t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.strip()},h.prototype.addn=function(e){return this.clone().iaddn(e)},h.prototype.subn=function(e){return this.clone().isubn(e)},h.prototype.iabs=function(){return this.negative=0,this},h.prototype.abs=function(){return this.clone().iabs()},h.prototype._ishlnsubmul=function(e,t,a){var o=e.length+a,r;this._expand(o);var n=0,l;for(r=0;r<e.length;r++){l=(0|this.words[r+a])+n;var s=(0|e.words[r])*t;l-=67108863&s,n=(l>>26)-(0|s/67108864),this.words[r+a]=67108863&l}for(;r<this.length-a;r++)l=(0|this.words[r+a])+n,n=l>>26,this.words[r+a]=67108863&l;if(0===n)return this.strip();for(u(-1===n),n=0,r=0;r<this.length;r++)l=-(0|this.words[r])+n,n=l>>26,this.words[r]=67108863&l;return this.negative=1,this.strip()},h.prototype._wordDiv=function(e,t){var o=this.length-e.length,r=this.clone(),n=e,s=0|n.words[n.length-1],d=this._countBits(s);o=26-d,0!=o&&(n=n.ushln(o),r.iushln(o),s=0|n.words[n.length-1]);var c=r.length-n.length,p;if("mod"!==t){p=new h(null),p.length=c+1,p.words=Array(p.length);for(var u=0;u<p.length;u++)p.words[u]=0}var g=r.clone()._ishlnsubmul(n,1,c);0===g.negative&&(r=g,p&&(p.words[c]=1));for(var m=c-1,y;0<=m;m--){for(y=67108864*(0|r.words[n.length+m])+(0|r.words[n.length+m-1]),y=l(0|y/s,67108863),r._ishlnsubmul(n,y,m);0!==r.negative;)y--,r.negative=0,r._ishlnsubmul(n,1,m),r.isZero()||(r.negative^=1);p&&(p.words[m]=y)}return p&&p.strip(),r.strip(),"div"!==t&&0!==o&&r.iushrn(o),{div:p||null,mod:r}},h.prototype.divmod=function(e,t,a){if(u(!e.isZero()),this.isZero())return{div:new h(0),mod:new h(0)};var o,r,i;return 0!==this.negative&&0===e.negative?(i=this.neg().divmod(e,t),"mod"!==t&&(o=i.div.neg()),"div"!==t&&(r=i.mod.neg(),a&&0!==r.negative&&r.iadd(e)),{div:o,mod:r}):0===this.negative&&0!==e.negative?(i=this.divmod(e.neg(),t),"mod"!==t&&(o=i.div.neg()),{div:o,mod:i.mod}):0==(this.negative&e.negative)?e.length>this.length||0>this.cmp(e)?{div:new h(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new h(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new h(this.modn(e.words[0]))}:this._wordDiv(e,t):(i=this.neg().divmod(e.neg(),t),"div"!==t&&(r=i.mod.neg(),a&&0!==r.negative&&r.isub(e)),{div:i.div,mod:r})},h.prototype.div=function(e){return this.divmod(e,"div",!1).div},h.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},h.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},h.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var a=0===t.div.negative?t.mod:t.mod.isub(e),o=e.ushrn(1),r=e.andln(1),i=a.cmp(o);return 0>i||1===r&&0===i?t.div:0===t.div.negative?t.div.iaddn(1):t.div.isubn(1)},h.prototype.modn=function(e){u(67108863>=e);for(var t=0,a=this.length-1;0<=a;a--)t=(67108864%e*t+(0|this.words[a]))%e;return t},h.prototype.idivn=function(e){u(67108863>=e);for(var t=0,a=this.length-1,o;0<=a;a--)o=(0|this.words[a])+67108864*t,this.words[a]=0|o/e,t=o%e;return this.strip()},h.prototype.divn=function(e){return this.clone().idivn(e)},h.prototype.egcd=function(e){u(0===e.negative),u(!e.isZero());var t=this,a=e.clone();t=0===t.negative?t.clone():t.umod(e);for(var o=new h(1),r=new h(0),n=new h(0),l=new h(1),s=0;t.isEven()&&a.isEven();)t.iushrn(1),a.iushrn(1),++s;for(var d=a.clone(),c=t.clone();!t.isZero();){for(var p=0,m=1;0==(t.words[0]&m)&&26>p;++p,m<<=1);if(0<p)for(t.iushrn(p);0<p--;)(o.isOdd()||r.isOdd())&&(o.iadd(d),r.isub(c)),o.iushrn(1),r.iushrn(1);for(var y=0,f=1;0==(a.words[0]&f)&&26>y;++y,f<<=1);if(0<y)for(a.iushrn(y);0<y--;)(n.isOdd()||l.isOdd())&&(n.iadd(d),l.isub(c)),n.iushrn(1),l.iushrn(1);0<=t.cmp(a)?(t.isub(a),o.isub(n),r.isub(l)):(a.isub(t),n.isub(o),l.isub(r))}return{a:n,b:l,gcd:a.iushln(s)}},h.prototype._invmp=function(e){u(0===e.negative),u(!e.isZero());var t=this,o=e.clone();t=0===t.negative?t.clone():t.umod(e);for(var r=new h(1),n=new h(0),l=o.clone();0<t.cmpn(1)&&0<o.cmpn(1);){for(var s=0,d=1;0==(t.words[0]&d)&&26>s;++s,d<<=1);if(0<s)for(t.iushrn(s);0<s--;)r.isOdd()&&r.iadd(l),r.iushrn(1);for(var c=0,p=1;0==(o.words[0]&p)&&26>c;++c,p<<=1);if(0<c)for(o.iushrn(c);0<c--;)n.isOdd()&&n.iadd(l),n.iushrn(1);0<=t.cmp(o)?(t.isub(o),r.isub(n)):(o.isub(t),n.isub(r))}var g;return g=0===t.cmpn(1)?r:n,0>g.cmpn(0)&&g.iadd(e),g},h.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var o=this.clone(),i=e.clone();o.negative=0,i.negative=0;for(var n=0;o.isEven()&&i.isEven();n++)o.iushrn(1),i.iushrn(1);do{for(;o.isEven();)o.iushrn(1);for(;i.isEven();)i.iushrn(1);var l=o.cmp(i);if(0>l){var r=o;o=i,i=r}else if(0===l||0===i.cmpn(1))break;o.isub(i)}while(!0);return i.iushln(n)},h.prototype.invm=function(e){return this.egcd(e).a.umod(e)},h.prototype.isEven=function(){return 0==(1&this.words[0])},h.prototype.isOdd=function(){return 1==(1&this.words[0])},h.prototype.andln=function(e){return this.words[0]&e},h.prototype.bincn=function(e){u("number"==typeof e);var t=e%26,a=(e-t)/26,o=1<<t;if(this.length<=a)return this._expand(a+1),this.words[a]|=o,this;for(var r=o,n=a,l;0!==r&&n<this.length;n++)l=0|this.words[n],l+=r,r=l>>>26,l&=67108863,this.words[n]=l;return 0!==r&&(this.words[n]=r,this.length++),this},h.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},h.prototype.cmpn=function(e){var t=0>e;if(0!==this.negative&&!t)return-1;if(0===this.negative&&t)return 1;this.strip();var a;if(1<this.length)a=1;else{t&&(e=-e),u(67108863>=e,"Number is too big");var o=0|this.words[0];a=o===e?0:o<e?-1:1}return 0===this.negative?a:0|-a},h.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0===this.negative?t:0|-t},h.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,o=this.length-1;0<=o;o--){var r=0|this.words[o],a=0|e.words[o];if(r!==a){r<a?t=-1:r>a&&(t=1);break}}return t},h.prototype.gtn=function(e){return 1===this.cmpn(e)},h.prototype.gt=function(e){return 1===this.cmp(e)},h.prototype.gten=function(e){return 0<=this.cmpn(e)},h.prototype.gte=function(e){return 0<=this.cmp(e)},h.prototype.ltn=function(e){return-1===this.cmpn(e)},h.prototype.lt=function(e){return-1===this.cmp(e)},h.prototype.lten=function(e){return 0>=this.cmpn(e)},h.prototype.lte=function(e){return 0>=this.cmp(e)},h.prototype.eqn=function(e){return 0===this.cmpn(e)},h.prototype.eq=function(e){return 0===this.cmp(e)},h.red=function(e){return new A(e)},h.prototype.toRed=function(e){return u(!this.red,"Already a number in reduction context"),u(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},h.prototype.fromRed=function(){return u(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},h.prototype._forceRed=function(e){return this.red=e,this},h.prototype.forceRed=function(e){return u(!this.red,"Already a number in reduction context"),this._forceRed(e)},h.prototype.redAdd=function(e){return u(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},h.prototype.redIAdd=function(e){return u(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},h.prototype.redSub=function(e){return u(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},h.prototype.redISub=function(e){return u(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},h.prototype.redShl=function(e){return u(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},h.prototype.redMul=function(e){return u(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},h.prototype.redIMul=function(e){return u(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},h.prototype.redSqr=function(){return u(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},h.prototype.redISqr=function(){return u(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},h.prototype.redSqrt=function(){return u(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},h.prototype.redInvm=function(){return u(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},h.prototype.redNeg=function(){return u(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},h.prototype.redPow=function(e){return u(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var O={k256:null,p224:null,p192:null,p25519:null};b.prototype._tmp=function(){var e=new h(null);return e.words=Array(o(this.n/13)),e},b.prototype.ireduce=function(e){var t=e,a;do this.split(t,this.tmp),t=this.imulK(t),t=t.iadd(this.tmp),a=t.bitLength();while(a>this.n);var o=a<this.n?-1:t.ucmp(this.p);return 0===o?(t.words[0]=0,t.length=1):0<o?t.isub(this.p):t.strip(),t},b.prototype.split=function(e,t){e.iushrn(this.n,0,t)},b.prototype.imulK=function(e){return e.imul(this.k)},g(v,b),v.prototype.split=function(e,t){for(var a=4194303,o=l(e.length,9),r=0;r<o;r++)t.words[r]=e.words[r];if(t.length=o,9>=e.length)return e.words[0]=0,void(e.length=1);var n=e.words[9];for(t.words[t.length++]=n&a,r=10;r<e.length;r++){var s=0|e.words[r];e.words[r-10]=(s&a)<<4|n>>>22,n=s}n>>>=22,e.words[r-10]=n,e.length-=0===n&&10<e.length?10:9},v.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,a=0,o;a<e.length;a++)o=0|e.words[a],t+=977*o,e.words[a]=67108863&t,t=64*o+(0|t/67108864);return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},g(w,b),g(k,b),g(T,b),T.prototype.imulK=function(e){for(var t=0,a=0;a<e.length;a++){var o=19*(0|e.words[a])+t,r=67108863&o;o>>>=26,e.words[a]=r,t=o}return 0!==t&&(e.words[e.length++]=t),e},h._prime=function e(t){if(O[t])return O[t];var e;if("k256"===t)e=new v;else if("p224"===t)e=new w;else if("p192"===t)e=new k;else if("p25519"===t)e=new T;else throw new Error("Unknown prime "+t);return O[t]=e,e},A.prototype._verify1=function(e){u(0===e.negative,"red works only with positives"),u(e.red,"red works only with red numbers")},A.prototype._verify2=function(e,t){u(0==(e.negative|t.negative),"red works only with positives"),u(e.red&&e.red===t.red,"red works only with red numbers")},A.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},A.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},A.prototype.add=function(e,t){this._verify2(e,t);var a=e.add(t);return 0<=a.cmp(this.m)&&a.isub(this.m),a._forceRed(this)},A.prototype.iadd=function(e,t){this._verify2(e,t);var a=e.iadd(t);return 0<=a.cmp(this.m)&&a.isub(this.m),a},A.prototype.sub=function(e,t){this._verify2(e,t);var a=e.sub(t);return 0>a.cmpn(0)&&a.iadd(this.m),a._forceRed(this)},A.prototype.isub=function(e,t){this._verify2(e,t);var a=e.isub(t);return 0>a.cmpn(0)&&a.iadd(this.m),a},A.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},A.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},A.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},A.prototype.isqr=function(e){return this.imul(e,e.clone())},A.prototype.sqr=function(e){return this.mul(e,e)},A.prototype.sqrt=function(e){if(e.isZero())return e.clone();var a=this.m.andln(3);if(u(1==a%2),3===a){var o=this.m.add(new h(1)).iushrn(2);return this.pow(e,o)}for(var n=this.m.subn(1),l=0;!n.isZero()&&0===n.andln(1);)l++,n.iushrn(1);u(!n.isZero());var d=new h(1).toRed(this),p=d.redNeg(),g=this.m.subn(1).iushrn(1),y=this.m.bitLength();for(y=new h(2*y*y).toRed(this);0!==this.pow(y,g).cmp(p);)y.redIAdd(p);for(var f=this.pow(y,n),x=this.pow(e,n.addn(1).iushrn(1)),_=this.pow(e,n),v=l;0!==_.cmp(d);){for(var w=_,k=0;0!==w.cmp(d);k++)w=w.redSqr();u(k<v);var T=this.pow(f,new h(1).iushln(v-k-1));x=x.redMul(T),f=T.redSqr(),_=_.redMul(f),v=k}return x},A.prototype.invm=function(e){var t=e._invmp(this.m);return 0===t.negative?this.imod(t):(t.negative=0,this.imod(t).redNeg())},A.prototype.pow=function(e,t){if(t.isZero())return new h(1).toRed(this);if(0===t.cmpn(1))return e.clone();var a=Array(16);a[0]=new h(1).toRed(this),a[1]=e;for(var o=2;o<a.length;o++)a[o]=this.mul(a[o-1],e);var r=a[0],n=0,l=0,s=t.bitLength()%26;for(0===s&&(s=26),o=t.length-1;0<=o;o--){for(var d=t.words[o],c=s-1,p;0<=c;c--){if(p=1&d>>c,r!==a[0]&&(r=this.sqr(r)),0===p&&0===n){l=0;continue}n<<=1,n|=p,l++,4!==l&&(0!==o||0!==c)||(r=this.mul(r,a[n]),l=0,n=0)}s=26}return r},A.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},A.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},h.mont=function(e){return new S(e)},g(S,A),S.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},S.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},S.prototype.imul=function(e,a){if(e.isZero()||a.isZero())return e.words[0]=0,e.length=1,e;var o=e.imul(a),t=o.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),r=o.isub(t).iushrn(this.shift),i=r;return 0<=r.cmp(this.m)?i=r.isub(this.m):0>r.cmpn(0)&&(i=r.iadd(this.m)),i._forceRed(this)},S.prototype.mul=function(e,a){if(e.isZero()||a.isZero())return new h(0)._forceRed(this);var o=e.mul(a),t=o.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),r=o.isub(t).iushrn(this.shift),i=r;return 0<=r.cmp(this.m)?i=r.isub(this.m):0>r.cmpn(0)&&(i=r.iadd(this.m)),i._forceRed(this)},S.prototype.invm=function(e){var t=this.imod(e._invmp(this.m).mul(this.r2));return t._forceRed(this)}})("undefined"==typeof t||t,this)},{buffer:1419}],46:[function(e,t){'use strict';t.exports=function(e){var t=e.length,a=0,o,r,n;for(o=0;o<t;++o)a+=e[o].length;var l=Array(a),s=0;for(o=0;o<t;++o){var u=e[o],c=u.length;for(r=0;r<c;++r){var d=l[s++]=Array(c-1),g=0;for(n=0;n<c;++n)n!==r&&(d[g++]=u[n]);if(1&r){var m=d[1];d[1]=d[0],d[0]=m}}}return l}},{}],47:[function(e,t){'use strict';function a(e,t){for(var a=0;a<e;++a)if(!(t[a]<=t[a+e]))return!0;return!1}function o(e,t,o,r){for(var l=0,s=0,d=0,c=e.length,n;d<c;++d)if(n=e[d],!a(t,n)){for(var p=0;p<2*t;++p)o[l++]=n[p];r[s++]=d}return s}function r(e,t,a,r){var i=e.length,l=t.length;if(!(0>=i||0>=l)){var u=e[0].length>>>1;if(!(0>=u)){var d=s.mallocDouble(2*u*i),g=s.mallocInt32(i),h;if(i=o(e,u,d,g),0<i){if(1===u&&r)c.init(i),h=c.sweepComplete(u,a,0,i,d,g,0,i,d,g);else{var y=s.mallocDouble(2*u*l),f=s.mallocInt32(l);l=o(t,u,y,f),0<l&&(c.init(i+l),h=1===u?c.sweepBipartite(u,a,0,i,d,g,0,l,y,f):p(u,a,r,i,d,g,l,y,f),s.free(y),s.free(f))}s.free(d),s.free(g)}return h}}}function i(e,t){u.push([e,t])}function n(e){return u=[],r(e,e,i,!0),u}function l(e,t){return u=[],r(e,t,i,!1),u}t.exports=function(e,t,a){switch(arguments.length){case 1:return n(e);case 2:return"function"==typeof t?r(e,e,t,!0):l(e,t);case 3:return r(e,t,a,!1);default:throw new Error("box-intersect: Invalid arguments");}};var s=e("typedarray-pool"),c=e("./lib/sweep"),p=e("./lib/intersect"),u},{"./lib/intersect":49,"./lib/sweep":53,"typedarray-pool":1328}],48:[function(e,t,a){'use strict';function o(e,t,a){var o="bruteForce"+(e?"Red":"Blue")+(t?"Flip":"")+(a?"Full":""),r=["function ",o,"(",i.join(),"){","var ","es","=2*","d",";"],n="for(var i=rs,rp=es*rs;i<re;++i,rp+=es){var x0=rb[ax+rp],x1=rb[ax+rp+d],xi=ri[i];",l="for(var j=bs,bp=es*bs;j<be;++j,bp+=es){var y0=bb[ax+bp],"+(a?"y1=bb[ax+bp+d],":"")+"yi=bi[j];";return e?r.push(n,"Q",":",l):r.push(l,"Q",":",n),a?r.push("if(y1<x0||x1<y0)continue;"):t?r.push("if(y0<=x0||x1<y0)continue;"):r.push("if(y0<x0||x1<y0)continue;"),r.push("for(var k=ax+1;k<d;++k){var r0=rb[k+rp],r1=rb[k+d+rp],b0=bb[k+bp],b1=bb[k+d+bp];if(r1<b0||b1<r0)continue Q;}var rv=vv("),t?r.push("yi,xi"):r.push("xi,yi"),r.push(");if(rv!==void 0)return rv;}}}"),{name:o,code:r.join("")}}function r(e){function t(t,a){var n=o(t,a,e);r.push(n.code),l.push("return "+n.name+"("+i.join()+");")}var a="bruteForce"+(e?"Full":"Partial"),r=[],n=i.slice();e||n.splice(3,0,"fp");var l=["function "+a+"("+n.join()+"){"];l.push("if(re-rs>be-bs){"),e?(t(!0,!1),l.push("}else{"),t(!1,!1)):(l.push("if(fp){"),t(!0,!0),l.push("}else{"),t(!0,!1),l.push("}}else{if(fp){"),t(!1,!0),l.push("}else{"),t(!1,!1),l.push("}")),l.push("}}return "+a);var s=r.join("")+l.join(""),d=new Function(s);return d()}var i=["d","ax","vv","rs","re","rb","ri","bs","be","bb","bi"];a.partial=r(!1),a.full=r(!0)},{}],49:[function(e,t){'use strict';var l=Math.min;function a(e,t){var a=0|8*c.log2(t+1)*(e+1),o=c.nextPow2(6*a);T.length<o&&(s.free(T),T=s.mallocInt32(o));var r=c.nextPow2(2*a);A.length<r&&(s.free(A),A=s.mallocDouble(r))}function o(e,t,a,o,r,i,n,l,s){var d=6*e;T[d]=t,T[d+1]=a,T[d+2]=o,T[d+3]=r,T[d+4]=i,T[d+5]=n;var c=2*e;A[c]=l,A[c+1]=s}function r(e,t,a,o,r,n,l,s,d,c,p){var u=2*e,g=d*u,m=c[g+t];red_loop:for(var h=r,y=r*u;h<n;++h,y+=u){var f=l[y+t],x=l[y+t+e];if(!(m<f||x<m)&&!(o&&m===f)){for(var _=s[h],b=t+1;b<e;++b){var f=l[y+b],x=l[y+b+e],v=c[g+b],w=c[g+b+e];if(x<v||w<f)continue red_loop}var k;if(k=o?a(p,_):a(_,p),void 0!==k)return k}}}function i(e,t,a,o,r,n,l,s,d,c){var p=2*e,u=s*p,g=d[u+t];red_loop:for(var m=o,h=o*p,y;m<r;++m,h+=p)if(y=l[m],y!==c){var f=n[h+t],x=n[h+t+e];if(!(g<f||x<g)){for(var _=t+1;_<e;++_){var f=n[h+_],x=n[h+_+e],b=d[u+_],v=d[u+_+e];if(x<b||v<f)continue red_loop}var w=a(y,c);if(void 0!==w)return w}}}function n(e,t,n,s,d,c,p,y,k){a(e,s+p);var S=0,C;for(o(S++,0,0,s,0,p,n?16:0,-Infinity,1/0),n||o(S++,0,0,p,0,s,1,-Infinity,1/0);0<S;){S-=1;var L=6*S,E=T[L],I=T[L+1],P=T[L+2],z=T[L+3],D=T[L+4],O=T[L+5],R=2*S,M=A[R],j=A[R+1],B=1&O,F=!!(16&O),N=d,V=c,U=y,H=k;if((B&&(N=y,V=k,U=d,H=c),!(2&O&&(P=_(e,E,I,P,N,V,j),I>=P)))&&!(4&O&&(I=b(e,E,I,P,N,V,M),I>=P))){var q=P-I,G=D-z;if(F){if(4194304>e*q*(q+G)){if(C=m.scanComplete(e,E,t,I,P,N,V,z,D,U,H),void 0!==C)return C;continue}}else if(128>e*l(q,G)){if(C=u(e,E,t,B,I,P,N,V,z,D,U,H),void 0!==C)return C;continue}else if(4194304>e*q*G){if(C=m.scanBipartite(e,E,t,B,I,P,N,V,z,D,U,H),void 0!==C)return C;continue}var Y=f(e,E,I,P,N,V,M,j);if(I<Y)if(128>e*(Y-I)){if(C=g(e,E+1,t,I,Y,N,V,z,D,U,H),void 0!==C)return C;}else if(E!==e-2)o(S++,E+1,I,Y,z,D,B,-Infinity,1/0),o(S++,E+1,z,D,I,Y,1^B,-Infinity,1/0);else if(C=B?m.sweepBipartite(e,t,z,D,U,H,I,Y,N,V):m.sweepBipartite(e,t,I,Y,N,V,z,D,U,H),void 0!==C)return C;if(Y<P){var W=h(e,E,z,D,U,H),X=U[2*e*W+E],Z=x(e,E,W,D,U,H,X);if(Z<D&&o(S++,E,Y,P,Z,D,(4|B)+(F?16:0),X,j),z<W&&o(S++,E,Y,P,z,W,(2|B)+(F?16:0),M,X),W+1===Z){if(C=F?i(e,E,t,Y,P,N,V,W,U,H[W]):r(e,E,t,B,Y,P,N,V,W,U,H[W]),void 0!==C)return C;}else if(W<Z){var K;if(!F)K=B?w(e,E,Y,P,N,V,X):v(e,E,Y,P,N,V,X),Y<K&&(E===e-2?B?C=m.sweepBipartite(e,t,W,Z,U,H,Y,K,N,V):C=m.sweepBipartite(e,t,Y,K,N,V,W,Z,U,H):(o(S++,E+1,Y,K,W,Z,B,-Infinity,1/0),o(S++,E+1,W,Z,Y,K,1^B,-Infinity,1/0)));else if(K=v(e,E,Y,P,N,V,X),Y<K){var $=x(e,E,Y,K,N,V,X);if(E===e-2){if(Y<$&&(C=m.sweepComplete(e,t,Y,$,N,V,W,Z,U,H),void 0!==C))return C;if($<K&&(C=m.sweepBipartite(e,t,$,K,N,V,W,Z,U,H),void 0!==C))return C}else Y<$&&o(S++,E+1,Y,$,W,Z,16,-Infinity,1/0),$<K&&(o(S++,E+1,$,K,W,Z,0,-Infinity,1/0),o(S++,E+1,W,Z,$,K,1,-Infinity,1/0))}}}}}}t.exports=n;var s=e("typedarray-pool"),c=e("bit-twiddle"),p=e("./brute"),u=p.partial,g=p.full,m=e("./sweep"),h=e("./median"),y=e("./partition"),f=y("!(lo>=p0)&&!(p1>=hi)",["p0","p1"]),x=y("lo===p0",["p0"]),_=y("lo<p0",["p0"]),b=y("hi<=p0",["p0"]),v=y("lo<=p0&&p0<=hi",["p0"]),w=y("lo<p0&&p0<=hi",["p0"]),k=1024,T=s.mallocInt32(k),A=s.mallocDouble(k)},{"./brute":48,"./median":50,"./partition":51,"./sweep":53,"bit-twiddle":43,"typedarray-pool":1328}],50:[function(e,t){'use strict';function a(e,t,a,o,r,n){for(var l=2*e,s=l*(a+1)+t,d=a+1,c;d<o;++d,s+=l){c=r[s];for(var p=d,u=l*(d-1);p>a&&r[u+t]>c;--p,u-=l){for(var g=u,m=u+l,h=0,f;h<l;++h,++g,++m)f=r[g],r[g]=r[m],r[m]=f;var _=n[p];n[p]=n[p-1],n[p-1]=_}}}t.exports=function(e,t,o,n,l,s){if(n<=o+1)return o;for(var d=o,c=n,p=n+o>>>1,u=2*e,g=p,m=l[u*p+t];d<c;){if(8>c-d){a(e,t,d,c,l,s),m=l[u*p+t];break}var h=c-d,f=0|Math.random()*h+d,_=l[u*f+t],b=0|Math.random()*h+d,v=l[u*b+t],w=0|Math.random()*h+d,k=l[u*w+t];_<=v?k>=v?(g=b,m=v):_>=k?(g=f,m=_):(g=w,m=k):v>=k?(g=b,m=v):k>=_?(g=f,m=_):(g=w,m=k);for(var T=u*(c-1),A=u*g,S=0,C;S<u;++S,++T,++A)C=l[T],l[T]=l[A],l[A]=C;var L=s[c-1];s[c-1]=s[g],s[g]=L,g=r(e,t,d,c-1,l,s,m);for(var T=u*(c-1),A=u*g,S=0,C;S<u;++S,++T,++A)C=l[T],l[T]=l[A],l[A]=C;var L=s[c-1];if(s[c-1]=s[g],s[g]=L,p<g){for(c=g-1;d<c&&l[u*(c-1)+t]===m;)c-=1;c+=1}else if(g<p)for(d=g+1;d<c&&l[u*d+t]===m;)d+=1;else break}return r(e,t,o,p,l,s,l[u*p+t])};var o=e("./partition"),r=o("lo<p0",["p0"])},{"./partition":51}],51:[function(e,t){'use strict';t.exports=function(e,t){var a=["a","b","c","d","e","f"].concat(t),o=[];return 0<=e.indexOf("lo")&&o.push("lo=e[k+n]"),0<=e.indexOf("hi")&&o.push("hi=e[k+o]"),a.push("for(var j=2*a,k=j*c,l=k,m=c,n=b,o=a+b,p=c;d>p;++p,k+=j){var _;if($)if(m===p)m+=1,l+=j;else{for(var s=0;j>s;++s){var t=e[k+s];e[k+s]=e[l],e[l++]=t}var u=f[p];f[p]=f[m],f[m++]=u}}return m".replace("_",o.join()).replace("$",e)),Function.apply(void 0,a)}},{}],52:[function(e,t){'use strict';function a(e,t,o){for(var r=2*(e+1),n=e+1;n<=t;++n){for(var l=o[r++],a=o[r++],s=n,d=r-2;s-->e;){var c=o[d-2],p=o[d-1];if(c<l)break;else if(c===l&&p<a)break;o[d]=c,o[d+1]=p,d-=2}o[d]=l,o[d+1]=a}}function o(e,t,a){e*=2,t*=2;var o=a[e],r=a[e+1];a[e]=a[t],a[e+1]=a[t+1],a[t]=o,a[t+1]=r}function r(e,t,a){e*=2,t*=2,a[e]=a[t],a[e+1]=a[t+1]}function i(e,t,a,o){e*=2,t*=2,a*=2;var r=o[e],n=o[e+1];o[e]=o[t],o[e+1]=o[t+1],o[t]=o[a],o[t+1]=o[a+1],o[a]=r,o[a+1]=n}function n(e,t,a,o,r){e*=2,t*=2,r[e]=r[t],r[t]=a,r[e+1]=r[t+1],r[t+1]=o}function l(e,t,a){e*=2,t*=2;var o=a[e],r=a[t];if(o<r)return!1;return o!==r||a[e+1]>a[t+1]}function s(e,t,a,o){e*=2;var r=o[e];if(r<t)return!0;return!(r!==t)&&o[e+1]<a}function d(e,t,c){var p=0|(t-e+1)/6,u=e+p,g=t-p,m=e+t>>1,h=m-p,f=m+p,_=u,b=h,v=m,w=f,T=g,A=e+1,S=t-1,C=0;l(_,b,c)&&(C=_,_=b,b=C),l(w,T,c)&&(C=w,w=T,T=C),l(_,v,c)&&(C=_,_=v,v=C),l(b,v,c)&&(C=b,b=v,v=C),l(_,w,c)&&(C=_,_=w,w=C),l(v,w,c)&&(C=v,v=w,w=C),l(b,T,c)&&(C=b,b=T,T=C),l(b,v,c)&&(C=b,b=v,v=C),l(w,T,c)&&(C=w,w=T,T=C);for(var L=c[2*b],E=c[2*b+1],I=c[2*w],P=c[2*w+1],D=2*_,O=2*v,R=2*T,M=0;2>M;++M){var j=c[D+M],x=c[O+M],y=c[R+M];c[2*u+M]=j,c[2*m+M]=x,c[2*g+M]=y}r(h,e,c),r(f,t,c);for(var z=A;z<=S;++z)if(s(z,L,E,c))z!==A&&o(z,A,c),++A;else if(!s(z,I,P,c))for(;;)if(!s(S,I,P,c)){if(--S<z)break;continue}else{s(S,L,E,c)?(i(z,A,S,c),++A,--S):(o(z,S,c),--S);break}n(e,A-1,L,E,c),n(t,S+1,I,P,c),A-2-e<=32?a(e,A-2,c):d(e,A-2,c),t-(S+2)<=32?a(S+2,t,c):d(S+2,t,c),S-A<=32?a(A,S,c):d(A,S,c)}t.exports=function(e,t){t<=128?a(0,t-1,e):d(0,t-1,e)}},{}],53:[function(e,t){'use strict';function a(e){var t=c.nextPow2(e);g.length<t&&(d.free(g),g=d.mallocInt32(t)),m.length<t&&(d.free(m),m=d.mallocInt32(t)),h.length<t&&(d.free(h),h=d.mallocInt32(t)),y.length<t&&(d.free(y),y=d.mallocInt32(t)),f.length<t&&(d.free(f),f=d.mallocInt32(t)),x.length<t&&(d.free(x),x=d.mallocInt32(t));var a=8*t;_.length<a&&(d.free(_),_=d.mallocDouble(a))}function o(e,t,a,o){var r=t[o],i=e[a-1];e[r]=i,t[i]=r}function r(e,t,a,o){e[a]=o,t[o]=a}function i(t,a,l,s,d,c,u,f,x,b){for(var v=0,w=2*t,k=t-1,T=w-1,A=l;A<s;++A){var S=c[A],C=w*A;_[v++]=d[C+k],_[v++]=-(S+1),_[v++]=d[C+T],_[v++]=S}for(var A=u;A<f;++A){var S=b[A]+268435456,L=w*A;_[v++]=x[L+k],_[v++]=-S,_[v++]=x[L+T],_[v++]=S}var E=v>>>1;p(_,E);for(var n=0,I=0,A=0,P;A<E;++A)if(P=0|_[2*A+1],268435456<=P)P=0|P-268435456,o(h,y,I--,P);else if(0<=P)o(g,m,n--,P);else if(-268435456>=P){P=0|-P-268435456;for(var z=0,D;z<n;++z)if(D=a(g[z],P),void 0!==D)return D;r(h,y,I++,P)}else{P=0|-P-1;for(var z=0,D;z<I;++z)if(D=a(P,h[z]),void 0!==D)return D;r(g,m,n++,P)}}function n(t,a,l,s,d,c,u,b,v,w){for(var k=0,T=2*t,A=t-1,S=T-1,C=l;C<s;++C){var L=c[C]+1<<1,E=T*C;_[k++]=d[E+A],_[k++]=-L,_[k++]=d[E+S],_[k++]=L}for(var C=u;C<b;++C){var L=w[C]+1<<1,I=T*C;_[k++]=v[I+A],_[k++]=1|-L,_[k++]=v[I+S],_[k++]=1|L}var P=k>>>1;p(_,P);for(var n=0,z=0,D=0,C=0;C<P;++C){var O=0|_[2*C+1],e=1&O;if(C<P-1&&O>>1==_[2*C+3]>>1&&(e=2,C+=1),0>O){for(var R=-(O>>1)-1,M=0,B;M<D;++M)if(B=a(f[M],R),void 0!==B)return B;if(0!==e)for(var M=0,B;M<n;++M)if(B=a(g[M],R),void 0!==B)return B;if(1!==e)for(var M=0,B;M<z;++M)if(B=a(h[M],R),void 0!==B)return B;0===e?r(g,m,n++,R):1===e?r(h,y,z++,R):2===e&&r(f,x,D++,R)}else{var R=(O>>1)-1;0===e?o(g,m,n--,R):1===e?o(h,y,z--,R):2===e&&o(f,x,D--,R)}}}function l(t,a,l,s,d,c,u,h,y,f,x,b){var v=0,w=2*t,T=a,A=1,S=1;s?S=268435456:A=268435456;for(var C=d;C<c;++C){var L=C+A,E=w*C;_[v++]=u[E+T],_[v++]=-L,_[v++]=u[E+(a+t)],_[v++]=L}for(var C=y;C<f;++C){var L=C+S,I=w*C;_[v++]=x[I+T],_[v++]=-L}var P=v>>>1;p(_,P);for(var n=0,C=0,z;C<P;++C)if(z=0|_[2*C+1],0>z){var L=-z,D=!1;if(268435456<=L?(D=!s,L-=268435456):(D=!!s,L-=1),D)r(g,m,n++,L);else{var O=b[L],R=w*L,M=x[R+a+1],B=x[R+a+1+t];red_loop:for(var F=0;F<n;++F){var N=g[F],V=w*N;if(!(B<u[V+a+1]||u[V+a+1+t]<M)){for(var U=a+2;U<t;++U)if(x[R+U+t]<u[V+U]||u[V+U+t]<x[R+U])continue red_loop;var H=h[N],q;if(q=s?l(O,H):l(H,O),void 0!==q)return q}}}}else o(g,m,n--,z-A)}function s(t,a,o,r,l,s,d,c,u,m,h){for(var y=0,f=2*t,x=a,b=r;b<l;++b){var v=b+268435456,w=f*b;_[y++]=s[w+x],_[y++]=-v,_[y++]=s[w+(a+t)],_[y++]=v}for(var b=c;b<u;++b){var v=b+1,T=f*b;_[y++]=m[T+x],_[y++]=-v}var A=y>>>1;p(_,A);for(var n=0,b=0,S;b<A;++b)if(S=0|_[2*b+1],0>S){var v=-S;if(268435456<=v)g[n++]=v-268435456;else{v-=1;var C=h[v],L=f*v,E=m[L+a+1],I=m[L+a+1+t];red_loop:for(var P=0;P<n;++P){var z=g[P],D=d[z];if(D===C)break;var O=f*z;if(!(I<s[O+a+1]||s[O+a+1+t]<E)){for(var R=a+2;R<t;++R)if(m[L+R+t]<s[O+R]||s[O+R+t]<m[L+R])continue red_loop;var M=o(D,C);if(void 0!==M)return M}}}}else{for(var v=S-268435456,P=n-1;0<=P;--P)if(g[P]===v){for(var R=P+1;R<n;++R)g[R-1]=g[R];break}--n}}t.exports={init:a,sweepBipartite:i,sweepComplete:n,scanBipartite:l,scanComplete:s};var d=e("typedarray-pool"),c=e("bit-twiddle"),p=e("./sort"),u=1024,g=d.mallocInt32(u),m=d.mallocInt32(u),h=d.mallocInt32(u),y=d.mallocInt32(u),f=d.mallocInt32(u),x=d.mallocInt32(u),_=d.mallocDouble(8*u)},{"./sort":52,"bit-twiddle":43,"typedarray-pool":1328}],54:[function(e,t){'use strict';function a(t){return[Math.min(t[0],t[1]),Math.max(t[0],t[1])]}function o(e,t){return e[0]-t[0]||e[1]-t[1]}function r(e){return e.map(a).sort(o)}function n(e,t,a){return t in e?e[t]:a}var l=e("./lib/monotone"),s=e("./lib/triangulation"),d=e("./lib/delaunay"),c=e("./lib/filter");t.exports=function(e,t,a){Array.isArray(t)?(a=a||{},t=t||[]):(a=t||{},t=[]);var o=!!n(a,"delaunay",!0),p=!!n(a,"interior",!0),u=!!n(a,"exterior",!0),g=!!n(a,"infinity",!1);if(!p&&!u||0===e.length)return[];var m=l(e,t);if(o||p!==u||g){for(var h=s(e.length,r(t)),y=0,x;y<m.length;++y)x=m[y],h.addTriangle(x[0],x[1],x[2]);return o&&d(e,h),u?p?g?c(h,0,g):h.cells():c(h,1,g):c(h,-1)}return m}},{"./lib/delaunay":55,"./lib/filter":56,"./lib/monotone":57,"./lib/triangulation":58}],55:[function(e,t){'use strict';function o(e,t,o,i,n,l){var s=t.opposite(i,n);if(!(0>s)){if(n<i){var d=i;i=n,n=d,d=l,l=s,s=d}t.isConstraint(i,n)||0>r(e[i],e[n],e[l],e[s])&&o.push(i,n)}}var r=e("robust-in-sphere")[4],i=e("binary-search-bounds");t.exports=function(e,n){for(var l=[],d=e.length,c=n.stars,p=0,u;p<d;++p){u=c[p];for(var g=1,m;g<u.length;g+=2)if((m=u[g],!(m<p))&&!n.isConstraint(p,m)){for(var h=u[g-1],f=-1,_=1;_<u.length;_+=2)if(u[_-1]===m){f=u[_];break}0>f||0>r(e[p],e[m],e[h],e[f])&&l.push(p,m)}}for(;0<l.length;){for(var m=l.pop(),p=l.pop(),h=-1,f=-1,u=c[p],v=1;v<u.length;v+=2){var w=u[v-1],s=u[v];w===m?f=s:s===m&&(h=w)}0>h||0>f||0<=r(e[p],e[m],e[h],e[f])||(n.flip(p,m),o(e,n,l,h,p,f),o(e,n,l,p,f,h),o(e,n,l,f,m,h),o(e,n,l,m,h,f))}}},{"binary-search-bounds":42,"robust-in-sphere":1275}],56:[function(e,t){'use strict';function o(e,t,a,o,r,i,n){this.cells=e,this.neighbor=t,this.flags=o,this.constraint=a,this.active=r,this.next=i,this.boundary=n}function r(e,t){return e[0]-t[0]||e[1]-t[1]||e[2]-t[2]}function i(e,t){for(var n=e.cells(),l=n.length,s=0;s<l;++s){var d=n[s],p=d[0],u=d[1],g=d[2];u<g?u<p&&(d[0]=u,d[1]=g,d[2]=p):g<p&&(d[0]=g,d[1]=p,d[2]=u)}n.sort(r);for(var m=Array(l),s=0;s<m.length;++s)m[s]=0;var h=[],f=[],_=Array(3*l),v=Array(3*l),w=null;t&&(w=[]);for(var k=new o(n,_,v,m,h,f,w),s=0,d;s<l;++s){d=n[s];for(var T=0;3>T;++T){var p=d[T],u=d[(T+1)%3],A=_[3*s+T]=k.locate(u,p,e.opposite(u,p)),a=v[3*s+T]=e.isConstraint(p,u);0>A&&(a?f.push(s):(h.push(s),m[s]=1),t&&w.push([u,p,-1]))}}return k}function n(e,t,a){for(var o=0,r=0;r<e.length;++r)t[r]===a&&(e[o++]=e[r]);return e.length=o,e}var l=e("binary-search-bounds");t.exports=function(e,a,o){var r=i(e,o);if(0===a)return o?r.cells.concat(r.boundary):r.cells;for(var l=1,s=r.active,d=r.next,p=r.flags,u=r.cells,g=r.constraint,m=r.neighbor;0<s.length||0<d.length;){for(;0<s.length;){var h=s.pop();if(p[h]!==-l){p[h]=l;for(var t=u[h],c=0,y;3>c;++c)y=m[3*h+c],0<=y&&0===p[y]&&(g[3*h+c]?d.push(y):(s.push(y),p[y]=l))}}var x=d;d=s,s=x,d.length=0,l=-l}var _=n(u,p,a);return o?_.concat(r.boundary):_};var s=o.prototype;s.locate=function(){var e=[0,0,0];return function(t,a,o){var i=t,n=a,s=o;return(a<o?a<t&&(i=a,n=o,s=t):o<t&&(i=o,n=t,s=a),0>i)?-1:(e[0]=i,e[1]=n,e[2]=s,l.eq(this.cells,e,r))}}()},{"binary-search-bounds":42}],57:[function(e,t){'use strict';function a(e,t,a,o,r){this.a=e,this.b=t,this.idx=a,this.lowerIds=o,this.upperIds=r}function o(e,t,a,o){this.a=e,this.b=t,this.type=a,this.idx=o}function r(e,t){var a=e.a[0]-t.a[0]||e.a[1]-t.a[1]||e.type-t.type;return a?a:0!==e.type&&(a=g(e.a,e.b,t.b),a)?a:e.idx-t.idx}function n(e,t){return g(e.a,e.b,t)}function l(e,t,a,o,r){for(var l=u.lt(t,o,n),s=u.gt(t,o,n),d=l;d<s;++d){for(var c=t[d],p=c.lowerIds,h=p.length;1<h&&0<g(a[p[h-2]],a[p[h-1]],o);)e.push([p[h-1],p[h-2],r]),h-=1;p.length=h,p.push(r);for(var y=c.upperIds,h=y.length;1<h&&0>g(a[y[h-2]],a[y[h-1]],o);)e.push([y[h-2],y[h-1],r]),h-=1;y.length=h,y.push(r)}}function s(e,t){var a;return(a=e.a[0]<t.a[0]?g(e.a,e.b,t.a):g(t.b,t.a,e.a),a)?a:(a=t.b[0]<e.b[0]?g(e.a,e.b,t.b):g(t.b,t.a,e.b),a||e.idx-t.idx)}function d(e,t,o){var r=u.le(e,o,s),i=e[r],n=i.upperIds,l=n[n.length-1];i.upperIds=[l],e.splice(r+1,0,new a(o.a,o.b,o.idx,[l],n))}function c(e,t,a){var o=a.a;a.a=a.b,a.b=o;var r=u.eq(e,a,s),i=e[r],n=e[r-1];n.upperIds=i.upperIds,e.splice(r,1)}var u=e("binary-search-bounds"),g=e("robust-orientation")[3];t.exports=function(t,n){for(var s=t.length,p=n.length,u=[],g=0;g<s;++g)u.push(new o(t[g],null,0,g));for(var g=0;g<p;++g){var m=n[g],e=t[m[0]],h=t[m[1]];e[0]<h[0]?u.push(new o(e,h,2,g),new o(h,e,1,g)):e[0]>h[0]&&u.push(new o(h,e,2,g),new o(e,h,1,g))}u.sort(r);for(var y=u[0].a[0]-(1+Math.abs(u[0].a[0]))*Math.pow(2,-52),f=[new a([y,1],[y,0],-1,[],[],[],[])],x=[],g=0,_=u.length;g<_;++g){var b=u[g],v=b.type;v===0?l(x,f,t,b.a,b.idx):v===2?d(f,t,b):c(f,t,b)}return x}},{"binary-search-bounds":42,"robust-orientation":1277}],58:[function(e,t){'use strict';var r=Math.min,n=Math.max;function a(e,t){this.stars=e,this.edges=t}function o(e,t,a){for(var o=1,r=e.length;o<r;o+=2)if(e[o-1]===t&&e[o]===a)return e[o-1]=e[r-2],e[o]=e[r-1],void(e.length=r-2)}var l=e("binary-search-bounds");t.exports=function(e,t){for(var o=Array(e),r=0;r<e;++r)o[r]=[];return new a(o,t)};var s=a.prototype;s.isConstraint=function(){function t(e,t){return e[0]-t[0]||e[1]-t[1]}var a=[0,0];return function(e,o){return a[0]=r(e,o),a[1]=n(e,o),0<=l.eq(this.edges,a,t)}}(),s.removeTriangle=function(e,t,a){var r=this.stars;o(r[e],t,a),o(r[t],a,e),o(r[a],e,t)},s.addTriangle=function(e,t,a){var o=this.stars;o[e].push(t,a),o[t].push(a,e),o[a].push(e,t)},s.opposite=function(e,t){for(var a=this.stars[t],o=1,r=a.length;o<r;o+=2)if(a[o]===e)return a[o-1];return-1},s.flip=function(e,t){var o=this.opposite(e,t),a=this.opposite(t,e);this.removeTriangle(e,t,o),this.removeTriangle(t,e,a),this.addTriangle(e,a,o),this.addTriangle(t,o,a)},s.edges=function(){for(var e=this.stars,t=[],a=0,o=e.length,r;a<o;++a){r=e[a];for(var n=0,l=r.length;n<l;n+=2)t.push([r[n],r[n+1]])}return t},s.cells=function(){for(var e=this.stars,a=[],o=0,l=e.length,n;o<l;++o){n=e[o];for(var d=0,c=n.length;d<c;d+=2){var p=n[d],s=n[d+1];o<r(p,s)&&a.push([o,p,s])}}return a}},{"binary-search-bounds":42}],59:[function(e,t){'use strict';t.exports=function(e){for(var t=1,a=1;a<e.length;++a)for(var o=0;o<a;++o)if(e[a]<e[o])t=-t;else if(e[o]===e[a])return 0;return t}},{}],60:[function(e,t){"use strict";function a(e,t){for(var a=0,o=e.length,r=0;r<o;++r)a+=e[r]*t[r];return a}function o(e){var t=e.length;if(0===t)return[];var o=e[0].length,r=n([e.length+1,e.length+1],1),s=n([e.length+1],1);r[t][t]=0;for(var d=0;d<t;++d){for(var c=0;c<=d;++c)r[c][d]=r[d][c]=2*a(e[d],e[c]);s[d]=a(e[d],e[d])}for(var p=l(r,s),u=0,g=p[t+1],d=0;d<g.length;++d)u+=g[d];for(var m=Array(t),d=0;d<t;++d){for(var g=p[d],y=0,c=0;c<g.length;++c)y+=g[c];m[d]=y/u}return m}function r(e){if(0===e.length)return[];for(var t=e[0].length,a=n([t]),r=o(e),l=0;l<e.length;++l)for(var s=0;s<t;++s)a[s]+=e[l][s]*r[l];return a}var n=e("dup"),l=e("robust-linear-solve");r.barycenetric=o,t.exports=r},{dup:116,"robust-linear-solve":1276}],61:[function(e,t){t.exports=function(e){for(var t=a(e),o=0,r=0,n;r<e.length;++r){n=e[r];for(var l=0;l<t.length;++l)o+=Math.pow(n[l]-t[l],2)}return Math.sqrt(o/e.length)};var a=e("circumcenter")},{circumcenter:60}],62:[function(e,t){t.exports=function(e,t,a){return t<a?e<t?t:e>a?a:e:e<a?a:e>t?t:e}},{}],63:[function(e,t){'use strict';var m=Math.min,h=Math.max;function a(e){var t=k(e);return[A(t,-Infinity),A(t,1/0)]}function o(t,o){for(var r=Array(o.length),n=0;n<o.length;++n){var l=o[n],e=t[l[0]],a=t[l[1]];r[n]=[A(m(e[0],a[0]),-Infinity),A(m(e[1],a[1]),-Infinity),A(h(e[0],a[0]),1/0),A(h(e[1],a[1]),1/0)]}return r}function r(e){for(var t=Array(e.length),a=0,o;a<e.length;++a)o=e[a],t[a]=[A(o[0],-Infinity),A(o[1],-Infinity),A(o[0],1/0),A(o[1],1/0)];return t}function i(t,o,r){var n=[];return f(r,function(r,i){var l=o[r],e=o[i];if(l[0]!==e[0]&&l[0]!==e[1]&&l[1]!==e[0]&&l[1]!==e[1]){var s=t[l[0]],a=t[l[1]],p=t[e[0]],c=t[e[1]];x(s,a,p,c)&&n.push([r,i])}}),n}function n(t,o,r,i){var n=[];return f(r,i,function(r,i){var l=o[r];if(l[0]!==i&&l[1]!==i){var e=t[i],s=t[l[0]],a=t[l[1]];x(s,a,e,e)&&n.push([r,i])}}),n}function l(o,r,n,l,d){var c=o.map(function(e){return[_(e[0]),_(e[1])]}),p,u;for(p=0;p<n.length;++p){var g=n[p];u=g[0];var m=g[1],h=r[u],y=r[m],f=S(T(o[h[0]]),T(o[h[1]]),T(o[y[0]]),T(o[y[1]]));if(f){var x=o.length;o.push([k(f[0]),k(f[1])]),c.push(f),l.push([u,x],[m,x])}}for(l.sort(function(e,t){if(e[0]!==t[0])return e[0]-t[0];var a=c[e[1]],o=c[t[1]];return w(a[0],o[0])||w(a[1],o[1])}),p=l.length-1;0<=p;--p){var v=l[p];u=v[0];var A=r[u],C=A[0],L=A[1],E=o[C],a=o[L];if(0>(E[0]-a[0]||E[1]-a[1])){var b=C;C=L,L=b}A[0]=C;var I=A[1]=v[1],P;for(d&&(P=A[2]);0<p&&l[p-1][0]===u;){var v=l[--p],z=v[1];d?r.push([I,z,P]):r.push([I,z]),I=z}d?r.push([I,L,P]):r.push([I,L])}return c}function s(e,t){for(var o=t.length,r=new y(o),n=[],l=0;l<t.length;++l){var s=t[l],d=a(s[0]),c=a(s[1]);n.push([A(d[0],-Infinity),A(c[0],-Infinity),A(d[1],1/0),A(c[1],1/0)])}f(n,function(e,t){r.link(e,t)});for(var p=!0,u=Array(o),l=0,g;l<o;++l)g=r.find(l),g!==l&&(p=!1,e[g]=[m(e[l][0],e[g][0]),m(e[l][1],e[g][1])]);if(p)return null;for(var h=0,l=0,g;l<o;++l)g=r.find(l),g===l?(u[l]=h,e[h++]=e[l]):u[l]=-1;e.length=h;for(var l=0;l<o;++l)0>u[l]&&(u[l]=u[r.find(l)]);return u}function d(e,t){return e[0]-t[0]||e[1]-t[1]}function c(e,t){var a=e[0]-t[0]||e[1]-t[1];if(a)return a;return e[2]<t[2]?-1:e[2]>t[2]?1:0}function p(t,o,r){if(0!==t.length){if(o)for(var n=0;n<t.length;++n){var l=t[n],s=o[l[0]],p=o[l[1]];l[0]=m(s,p),l[1]=h(s,p)}else for(var n=0;n<t.length;++n){var l=t[n],s=l[0],p=l[1];l[0]=m(s,p),l[1]=h(s,p)}r?t.sort(c):t.sort(d);for(var u=1,n=1;n<t.length;++n){var g=t[n-1],y=t[n];(y[0]!==g[0]||y[1]!==g[1]||r&&y[2]!==g[2])&&(t[u++]=y)}t.length=u}}function u(e,t,a){var o=s(e,[],r(e));return p(t,o,a),!!o}function g(e,t,a){var d=o(e,t),c=i(e,t,d),u=r(e),g=n(e,t,d,u),m=l(e,t,c,g,a),h=s(e,m,u);return p(t,h,a),!!h||0<c.length||0<g.length}t.exports=function(t,a,o){var r;if(o){r=a;for(var n=Array(a.length),l=0,s;l<a.length;++l)s=a[l],n[l]=[s[0],s[1],o[l]];a=n}for(var d=u(t,a,!!o);g(t,a,!!o);)d=!0;if(!!o&&d){r.length=0,o.length=0;for(var l=0,s;l<a.length;++l)s=a[l],r.push([s[0],s[1]]),o.push(s[2])}return d};var y=e("union-find"),f=e("box-intersect"),x=e("robust-segment-intersect"),_=e("big-rat"),w=e("big-rat/cmp"),k=e("big-rat/to-float"),T=e("rat-vec"),A=e("nextafter"),S=e("./lib/rat-seg-intersect")},{"./lib/rat-seg-intersect":64,"big-rat":29,"big-rat/cmp":27,"big-rat/to-float":41,"box-intersect":47,nextafter:426,"rat-vec":1261,"robust-segment-intersect":1280,"union-find":1330}],64:[function(e,t){'use strict';function o(e,t){return n(r(e[0],t[1]),r(e[1],t[0]))}t.exports=function(e,a,n,c){var d=p(a,e),m=p(c,n),h=o(d,m);if(0===l(h))return null;var y=p(e,n),f=o(m,y),x=i(f,h),t=g(d,x),s=u(e,t);return s};var r=e("big-rat/mul"),i=e("big-rat/div"),n=e("big-rat/sub"),l=e("big-rat/sign"),p=e("rat-vec/sub"),u=e("rat-vec/add"),g=e("rat-vec/muls")},{"big-rat/div":28,"big-rat/mul":38,"big-rat/sign":39,"big-rat/sub":40,"rat-vec/add":1260,"rat-vec/muls":1262,"rat-vec/sub":1263}],65:[function(e,t){'use strict';function a(e,t){null==t&&(t=!0);var i=e[0],l=e[1],s=e[2],d=e[3];null==d&&(d=t?1:255),t&&(i*=255,l*=255,s*=255,d*=255),i=255&o(i,0,255),l=255&o(l,0,255),s=255&o(s,0,255),d=255&o(d,0,255);var c=16777216*i+(l<<16)+(s<<8)+d;return c}var o=e("clamp");t.exports=a,t.exports.to=a,t.exports.from=function(e,t){e=+e;var o=e>>>24,r=(16711680&e)>>>16,i=(65280&e)>>>8,l=255&e;return!1===t?[o,r,i,l]:[o/255,r/255,i/255,l/255]}},{clamp:62}],66:[function(e,t){'use strict';t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],67:[function(e,t){'use strict';var o=Math.floor;function a(e){return!!(e instanceof Uint8Array||e instanceof Uint8ClampedArray)||!!(Array.isArray(e)&&(1<e[0]||0===e[0])&&(1<e[1]||0===e[1])&&(1<e[2]||0===e[2])&&(!e[3]||1<e[3]))}var r=e("color-rgba"),i=e("clamp"),n=e("dtype");t.exports=function e(t,l){"float"!==l&&l||(l="array"),"uint"===l&&(l="uint8"),"uint_clamped"===l&&(l="uint8_clamped");var s=n(l),d=new s(4),e="uint8"!==l&&"uint8_clamped"!==l;return(t.length&&"string"!=typeof t||(t=r(t),t[0]/=255,t[1]/=255,t[2]/=255),a(t))?(d[0]=t[0],d[1]=t[1],d[2]=t[2],d[3]=null==t[3]?255:t[3],e&&(d[0]/=255,d[1]/=255,d[2]/=255,d[3]/=255),d):(e?(d[0]=t[0],d[1]=t[1],d[2]=t[2],d[3]=null==t[3]?1:t[3]):(d[0]=i(o(255*t[0]),0,255),d[1]=i(o(255*t[1]),0,255),d[2]=i(o(255*t[2]),0,255),d[3]=null==t[3]?255:i(o(255*t[3]),0,255)),d)}},{clamp:62,"color-rgba":69,dtype:115}],68:[function(e,t){(function(a){'use strict';var o=e("color-name"),i=e("is-plain-obj"),n=e("defined");t.exports=function(e){var t=[],s=1,d,c;if("string"==typeof e){if(o[e])t=o[e].slice(),c="rgb";else if("transparent"===e)s=0,c="rgb",t=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(e)){var p=e.slice(1),u=p.length,g=4>=u;s=1,g?(t=[parseInt(p[0]+p[0],16),parseInt(p[1]+p[1],16),parseInt(p[2]+p[2],16)],4===u&&(s=parseInt(p[3]+p[3],16)/255)):(t=[parseInt(p[0]+p[1],16),parseInt(p[2]+p[3],16),parseInt(p[4]+p[5],16)],8===u&&(s=parseInt(p[6]+p[7],16)/255)),t[0]||(t[0]=0),t[1]||(t[1]=0),t[2]||(t[2]=0),c="rgb"}else if(d=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(e)){var h=d[1],p=h.replace(/a$/,"");c=p;var u="cmyk"===p?4:"gray"===p?1:3;t=d[2].trim().split(/\s*,\s*/).map(function(e,t){if(/%$/.test(e))return t===u?parseFloat(e)/100:"rgb"===p?255*parseFloat(e)/100:parseFloat(e);if("h"===p[t]){if(/deg$/.test(e))return parseFloat(e);if(void 0!==l[e])return l[e]}return parseFloat(e)}),h===p&&t.push(1),s="rgb"===h?1:void 0===t[u]?1:t[u],t=t.slice(0,u)}else 10<e.length&&/[0-9](?:\s|\/)/.test(e)&&(t=e.match(/([0-9]+)/g).map(function(e){return parseFloat(e)}),c=e.match(/([a-z])/ig).join("").toLowerCase());}else if(!isNaN(e))c="rgb",t=[e>>>16,(65280&e)>>>8,255&e];else if(i(e)){var y=n(e.r,e.red,e.R,null);null===y?(c="hsl",t=[n(e.h,e.hue,e.H),n(e.s,e.saturation,e.S),n(e.l,e.lightness,e.L,e.b,e.brightness)]):(c="rgb",t=[y,n(e.g,e.green,e.G),n(e.b,e.blue,e.B)]),s=n(e.a,e.alpha,e.opacity,1),null!=e.opacity&&(s/=100)}else(Array.isArray(e)||a.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(e))&&(t=[e[0],e[1],e[2]],c="rgb",s=4===e.length?e[3]:1);return{space:c,values:t,alpha:s}};var l={red:0,orange:60,yellow:120,green:180,blue:240,purple:300}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"color-name":66,defined:110,"is-plain-obj":391}],69:[function(e,t){'use strict';var a=e("color-parse"),o=e("color-space/hsl"),r=e("clamp");t.exports=function(e){var t=a(e),i;return t.space?(i=[,,,],i[0]=r(t.values[0],0,255),i[1]=r(t.values[1],0,255),i[2]=r(t.values[2],0,255),"h"===t.space[0]&&(i=o.rgb(i)),i.push(r(t.alpha,0,1)),i):[]}},{clamp:62,"color-parse":68,"color-space/hsl":70}],70:[function(e,t){'use strict';var a=Math.min,o=Math.max,r=e("./rgb");t.exports={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(e){var t=e[0]/360,a=e[1]/100,o=e[2]/100,r,n,l,s,d;if(0==a)return d=255*o,[d,d,d];n=.5>o?o*(1+a):o+a-o*a,r=2*o-n,s=[0,0,0];for(var c=0;3>c;c++)l=t+1/3*-(c-1),0>l?l++:1<l&&l--,d=1>6*l?r+6*(n-r)*l:1>2*l?n:2>3*l?r+6*((n-r)*(2/3-l)):r,s[c]=255*d;return s}},r.hsl=function(e){var t=e[0]/255,r=e[1]/255,i=e[2]/255,n=a(t,r,i),d=o(t,r,i),c=d-n,p,u,g;return d===n?p=0:t===d?p=(r-i)/c:r===d?p=2+(i-t)/c:i===d&&(p=4+(t-r)/c),p=a(60*p,360),0>p&&(p+=360),g=(n+d)/2,u=d===n?0:.5>=g?c/(d+n):c/(2-d-n),[p,100*u,100*g]}},{"./rgb":71}],71:[function(e,t){'use strict';t.exports={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]}},{}],72:[function(e,t){t.exports={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],cool:[{index:0,rgb:[0,255,255]},{index:1,rgb:[255,0,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]}},{}],73:[function(e,t){'use strict';var i=Math.round,n=Math.min,l=Math.max;function a(e){return[e[0]/255,e[1]/255,e[2]/255,e[3]]}function o(e){for(var t="#",a=0,o;3>a;++a)o=e[a],o=o.toString(16),t+=("00"+o).substr(o.length);return t}function r(e){return"rgba("+e.join(",")+")"}var s=e("./colorScale"),d=e("lerp");t.exports=function(e){var t,c,p,u,g,m,h,y,f,x,_;if(e||(e={}),y=(e.nshades||72)-1,h=e.format||"hex",m=e.colormap,m||(m="jet"),"string"==typeof m){if(m=m.toLowerCase(),!s[m])throw Error(m+" not a supported colorscale");g=s[m]}else if(Array.isArray(m))g=m.slice();else throw Error("unsupported colormap option",m);if(g.length>y+1)throw new Error(m+" map requires nshades to be at least size "+g.length);x=Array.isArray(e.alpha)?2===e.alpha.length?e.alpha.slice():[1,1]:"number"==typeof e.alpha?[e.alpha,e.alpha]:[1,1],t=g.map(function(e){return i(e.index*y)}),x[0]=n(l(x[0],0),1),x[1]=n(l(x[1],0),1);var b=g.map(function(e,t){var a=g[t].index,o=g[t].rgb.slice();return 4===o.length&&0<=o[3]&&1>=o[3]?o:(o[3]=x[0]+(x[1]-x[0])*a,o)}),f=[];for(_=0;_<t.length-1;++_){u=t[_+1]-t[_],c=b[_],p=b[_+1];for(var v=0,w;v<u;v++)w=v/u,f.push([i(d(c[0],p[0],w)),i(d(c[1],p[1],w)),i(d(c[2],p[2],w)),d(c[3],p[3],w)])}return f.push(g[g.length-1].rgb.concat(x[1])),"hex"===h?f=f.map(o):"rgbaString"===h?f=f.map(r):"float"===h&&(f=f.map(a)),f}},{"./colorScale":72,lerp:395}],74:[function(e,t){"use strict";function o(e,t,a){var o=n(e[0],-t[0]),r=n(e[1],-t[1]),i=n(a[0],-t[0]),c=n(a[1],-t[1]),p=s(l(o,i),l(r,c));return 0<=p[p.length-1]}t.exports=function(e,t,a,n){var l=r(t,a,n);if(0===l){var s=i(r(e,t,a)),d=i(r(e,t,n));if(s===d){if(0===s){var c=o(e,t,a),p=o(e,t,n);return c===p?0:c?1:-1}return 0}return 0===d?0<s?-1:o(e,t,n)?-1:1:0===s?0<d?1:o(e,t,a)?1:-1:i(d-s)}var u=r(e,t,a);if(0<u)return 0<l&&0<r(e,t,n)?1:-1;if(0>u)return 0<l||0<r(e,t,n)?1:-1;var g=r(e,t,n);return 0<g?1:o(e,t,a)?1:-1};var r=e("robust-orientation"),i=e("signum"),n=e("two-sum"),l=e("robust-product"),s=e("robust-sum")},{"robust-orientation":1277,"robust-product":1278,"robust-sum":1282,signum:1283,"two-sum":1316}],75:[function(e,t){function o(e,t){return e-t}t.exports=function(e,a){var l=e.length,n=e.length-a.length;if(n)return n;switch(l){case 0:return 0;case 1:return e[0]-a[0];case 2:return e[0]+e[1]-a[0]-a[1]||r(e[0],e[1])-r(a[0],a[1]);case 3:var s=e[0]+e[1],d=a[0]+a[1];if(n=s+e[2]-(d+a[2]),n)return n;var c=r(e[0],e[1]),p=r(a[0],a[1]);return r(c,e[2])-r(p,a[2])||r(c+e[2],s)-r(p+a[2],d);case 4:var u=e[0],g=e[1],m=e[2],h=e[3],y=a[0],f=a[1],x=a[2],_=a[3];return u+g+m+h-(y+f+x+_)||r(u,g,m,h)-r(y,f,x,_,y)||r(u+g,u+m,u+h,g+m,g+h,m+h)-r(y+f,y+x,y+_,f+x,f+_,x+_)||r(u+g+m,u+g+h,u+m+h,g+m+h)-r(y+f+x,y+f+_,y+x+_,f+x+_);default:for(var b=e.slice().sort(o),v=a.slice().sort(o),w=0;w<l;++w)if(n=b[w]-v[w],n)return n;return 0;}};var r=Math.min},{}],76:[function(e,t){'use strict';var o=e("compare-cell"),r=e("cell-orientation");t.exports=function(e,t){return o(e,t)||r(e)-r(t)}},{"cell-orientation":59,"compare-cell":75}],77:[function(e,t){"use strict";var a=e("./lib/ch1d"),o=e("./lib/ch2d"),r=e("./lib/chnd");t.exports=function(e){var t=e.length;if(0===t)return[];if(1===t)return[[0]];var i=e[0].length;if(0===i)return[];return 1===i?a(e):2===i?o(e):r(e,i)}},{"./lib/ch1d":78,"./lib/ch2d":79,"./lib/chnd":80}],78:[function(e,t){"use strict";t.exports=function(e){for(var t=0,a=0,o=1;o<e.length;++o)e[o][0]<e[t][0]&&(t=o),e[o][0]>e[a][0]&&(a=o);return t<a?[[t],[a]]:t>a?[[a],[t]]:[[t]]}},{}],79:[function(e,t){'use strict';t.exports=function(e){var t=o(e),r=t.length;if(2>=r)return[];for(var n=Array(r),l=t[r-1],s=0,d;s<r;++s)d=t[s],n[s]=[l,d],l=d;return n};var o=e("monotone-convex-hull-2d")},{"monotone-convex-hull-2d":409}],80:[function(e,t){'use strict';function a(e,t){for(var a=e.length,o=Array(a),r=0;r<t.length;++r)o[r]=e[t[r]];for(var n=t.length,r=0;r<a;++r)0>t.indexOf(r)&&(o[n++]=e[r]);return o}function o(e,t){for(var a=e.length,o=t.length,r=0,n;r<a;++r){n=e[r];for(var l=0,s;l<n.length;++l)if(s=n[l],s<o)n[l]=t[s];else{s-=o;for(var d=0;d<o;++d)s>=t[d]&&(s+=1);n[l]=s}}return e}t.exports=function(t,n){try{return r(t,!0)}catch(c){var l=i(t);if(l.length<=n)return[];var s=a(t,l),d=r(s,!0);return o(d,l)}};var r=e("incremental-convex-hull"),i=e("affine-hull")},{"affine-hull":18,"incremental-convex-hull":381}],81:[function(e,t){t.exports={AFG:"afghan",ALA:"\\b\\wland",ALB:"albania",DZA:"algeria",ASM:"^(?=.*americ).*samoa",AND:"andorra",AGO:"angola",AIA:"anguill?a",ATA:"antarctica",ATG:"antigua",ARG:"argentin",ARM:"armenia",ABW:"^(?!.*bonaire).*\\baruba",AUS:"australia",AUT:"^(?!.*hungary).*austria|\\baustri.*\\bemp",AZE:"azerbaijan",BHS:"bahamas",BHR:"bahrain",BGD:"bangladesh|^(?=.*east).*paki?stan",BRB:"barbados",BLR:"belarus|byelo",BEL:"^(?!.*luxem).*belgium",BLZ:"belize|^(?=.*british).*honduras",BEN:"benin|dahome",BMU:"bermuda",BTN:"bhutan",BOL:"bolivia",BES:"^(?=.*bonaire).*eustatius|^(?=.*carib).*netherlands|\\bbes.?islands",BIH:"herzegovina|bosnia",BWA:"botswana|bechuana",BVT:"bouvet",BRA:"brazil",IOT:"british.?indian.?ocean",BRN:"brunei",BGR:"bulgaria",BFA:"burkina|\\bfaso|upper.?volta",BDI:"burundi",CPV:"verde",KHM:"cambodia|kampuchea|khmer",CMR:"cameroon",CAN:"canada",CYM:"cayman",CAF:"\\bcentral.african.republic",TCD:"\\bchad",CHL:"\\bchile",CHN:"^(?!.*\\bmac)(?!.*\\bhong)(?!.*\\btai)(?!.*\\brep).*china|^(?=.*peo)(?=.*rep).*china",CXR:"christmas",CCK:"\\bcocos|keeling",COL:"colombia",COM:"comoro",COG:"^(?!.*\\bdem)(?!.*\\bd[\\.]?r)(?!.*kinshasa)(?!.*zaire)(?!.*belg)(?!.*l.opoldville)(?!.*free).*\\bcongo",COK:"\\bcook",CRI:"costa.?rica",CIV:"ivoire|ivory",HRV:"croatia",CUB:"\\bcuba",CUW:"^(?!.*bonaire).*\\bcura(c|\xE7)ao",CYP:"cyprus",CSK:"czechoslovakia",CZE:"^(?=.*rep).*czech|czechia|bohemia",COD:"\\bdem.*congo|congo.*\\bdem|congo.*\\bd[\\.]?r|\\bd[\\.]?r.*congo|belgian.?congo|congo.?free.?state|kinshasa|zaire|l.opoldville|drc|droc|rdc",DNK:"denmark",DJI:"djibouti",DMA:"dominica(?!n)",DOM:"dominican.rep",ECU:"ecuador",EGY:"egypt",SLV:"el.?salvador",GNQ:"guine.*eq|eq.*guine|^(?=.*span).*guinea",ERI:"eritrea",EST:"estonia",ETH:"ethiopia|abyssinia",FLK:"falkland|malvinas",FRO:"faroe|faeroe",FJI:"fiji",FIN:"finland",FRA:"^(?!.*\\bdep)(?!.*martinique).*france|french.?republic|\\bgaul",GUF:"^(?=.*french).*guiana",PYF:"french.?polynesia|tahiti",ATF:"french.?southern",GAB:"gabon",GMB:"gambia",GEO:"^(?!.*south).*georgia",DDR:"german.?democratic.?republic|democratic.?republic.*germany|east.germany",DEU:"^(?!.*east).*germany|^(?=.*\\bfed.*\\brep).*german",GHA:"ghana|gold.?coast",GIB:"gibraltar",GRC:"greece|hellenic|hellas",GRL:"greenland",GRD:"grenada",GLP:"guadeloupe",GUM:"\\bguam",GTM:"guatemala",GGY:"guernsey",GIN:"^(?!.*eq)(?!.*span)(?!.*bissau)(?!.*portu)(?!.*new).*guinea",GNB:"bissau|^(?=.*portu).*guinea",GUY:"guyana|british.?guiana",HTI:"haiti",HMD:"heard.*mcdonald",VAT:"holy.?see|vatican|papal.?st",HND:"^(?!.*brit).*honduras",HKG:"hong.?kong",HUN:"^(?!.*austr).*hungary",ISL:"iceland",IND:"india(?!.*ocea)",IDN:"indonesia",IRN:"\\biran|persia",IRQ:"\\biraq|mesopotamia",IRL:"(^ireland)|(^republic.*ireland)",IMN:"^(?=.*isle).*\\bman",ISR:"israel",ITA:"italy",JAM:"jamaica",JPN:"japan",JEY:"jersey",JOR:"jordan",KAZ:"kazak",KEN:"kenya|british.?east.?africa|east.?africa.?prot",KIR:"kiribati",PRK:"^(?=.*democrat|people|north|d.*p.*.r).*\\bkorea|dprk|korea.*(d.*p.*r)",KWT:"kuwait",KGZ:"kyrgyz|kirghiz",LAO:"\\blaos?\\b",LVA:"latvia",LBN:"lebanon",LSO:"lesotho|basuto",LBR:"liberia",LBY:"libya",LIE:"liechtenstein",LTU:"lithuania",LUX:"^(?!.*belg).*luxem",MAC:"maca(o|u)",MDG:"madagascar|malagasy",MWI:"malawi|nyasa",MYS:"malaysia",MDV:"maldive",MLI:"\\bmali\\b",MLT:"\\bmalta",MHL:"marshall",MTQ:"martinique",MRT:"mauritania",MUS:"mauritius",MYT:"\\bmayotte",MEX:"\\bmexic",FSM:"fed.*micronesia|micronesia.*fed",MCO:"monaco",MNG:"mongolia",MNE:"^(?!.*serbia).*montenegro",MSR:"montserrat",MAR:"morocco|\\bmaroc",MOZ:"mozambique",MMR:"myanmar|burma",NAM:"namibia",NRU:"nauru",NPL:"nepal",NLD:"^(?!.*\\bant)(?!.*\\bcarib).*netherlands",ANT:"^(?=.*\\bant).*(nether|dutch)",NCL:"new.?caledonia",NZL:"new.?zealand",NIC:"nicaragua",NER:"\\bniger(?!ia)",NGA:"nigeria",NIU:"niue",NFK:"norfolk",MNP:"mariana",NOR:"norway",OMN:"\\boman|trucial",PAK:"^(?!.*east).*paki?stan",PLW:"palau",PSE:"palestin|\\bgaza|west.?bank",PAN:"panama",PNG:"papua|new.?guinea",PRY:"paraguay",PER:"peru",PHL:"philippines",PCN:"pitcairn",POL:"poland",PRT:"portugal",PRI:"puerto.?rico",QAT:"qatar",KOR:"^(?!.*d.*p.*r)(?!.*democrat)(?!.*people)(?!.*north).*\\bkorea(?!.*d.*p.*r)",MDA:"moldov|b(a|e)ssarabia",REU:"r(e|\xE9)union",ROU:"r(o|u|ou)mania",RUS:"\\brussia|soviet.?union|u\\.?s\\.?s\\.?r|socialist.?republics",RWA:"rwanda",BLM:"barth(e|\xE9)lemy",SHN:"helena",KNA:"kitts|\\bnevis",LCA:"\\blucia",MAF:"^(?=.*collectivity).*martin|^(?=.*france).*martin(?!ique)|^(?=.*french).*martin(?!ique)",SPM:"miquelon",VCT:"vincent",WSM:"^(?!.*amer).*samoa",SMR:"san.?marino",STP:"\\bs(a|\xE3)o.?tom(e|\xE9)",SAU:"\\bsa\\w*.?arabia",SEN:"senegal",SRB:"^(?!.*monte).*serbia",SYC:"seychell",SLE:"sierra",SGP:"singapore",SXM:"^(?!.*martin)(?!.*saba).*maarten",SVK:"^(?!.*cze).*slovak",SVN:"slovenia",SLB:"solomon",SOM:"somali",ZAF:"south.africa|s\\\\..?africa",SGS:"south.?georgia|sandwich",SSD:"\\bs\\w*.?sudan",ESP:"spain",LKA:"sri.?lanka|ceylon",SDN:"^(?!.*\\bs(?!u)).*sudan",SUR:"surinam|dutch.?guiana",SJM:"svalbard",SWZ:"swaziland",SWE:"sweden",CHE:"switz|swiss",SYR:"syria",TWN:"taiwan|taipei|formosa|^(?!.*peo)(?=.*rep).*china",TJK:"tajik",THA:"thailand|\\bsiam",MKD:"macedonia|fyrom",TLS:"^(?=.*leste).*timor|^(?=.*east).*timor",TGO:"togo",TKL:"tokelau",TON:"tonga",TTO:"trinidad|tobago",TUN:"tunisia",TUR:"turkey",TKM:"turkmen",TCA:"turks",TUV:"tuvalu",UGA:"uganda",UKR:"ukrain",ARE:"emirates|^u\\.?a\\.?e\\.?$|united.?arab.?em",GBR:"united.?kingdom|britain|^u\\.?k\\.?$",TZA:"tanzania",USA:"united.?states\\b(?!.*islands)|\\bu\\.?s\\.?a\\.?\\b|^\\s*u\\.?s\\.?\\b(?!.*islands)",UMI:"minor.?outlying.?is",URY:"uruguay",UZB:"uzbek",VUT:"vanuatu|new.?hebrides",VEN:"venezuela",VNM:"^(?!.*republic).*viet.?nam|^(?=.*socialist).*viet.?nam",VGB:"^(?=.*\\bu\\.?\\s?k).*virgin|^(?=.*brit).*virgin|^(?=.*kingdom).*virgin",VIR:"^(?=.*\\bu\\.?\\s?s).*virgin|^(?=.*states).*virgin",WLF:"futuna|wallis",ESH:"western.sahara",YEM:"^(?!.*arab)(?!.*north)(?!.*sana)(?!.*peo)(?!.*dem)(?!.*south)(?!.*aden)(?!.*\\bp\\.?d\\.?r).*yemen",YMD:"^(?=.*peo).*yemen|^(?!.*rep)(?=.*dem).*yemen|^(?=.*south).*yemen|^(?=.*aden).*yemen|^(?=.*\\bp\\.?d\\.?r).*yemen",YUG:"yugoslavia",ZMB:"zambia|northern.?rhodesia",EAZ:"zanzibar",ZWE:"zimbabwe|^(?!.*northern).*rhodesia"}},{}],82:[function(e,t){t.exports=["xx-small","x-small","small","medium","large","x-large","xx-large","larger","smaller"]},{}],83:[function(e,t){t.exports=["normal","condensed","semi-condensed","extra-condensed","ultra-condensed","expanded","semi-expanded","extra-expanded","ultra-expanded"]},{}],84:[function(e,t){t.exports=["normal","italic","oblique"]},{}],85:[function(e,t){t.exports=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"]},{}],86:[function(e,t){'use strict';t.exports={parse:e("./parse"),stringify:e("./stringify")}},{"./parse":88,"./stringify":89}],87:[function(e,t){'use strict';var a=e("css-font-size-keywords");t.exports={isSize:function(e){return /^[\d\.]/.test(e)||-1!==e.indexOf("/")||-1!==a.indexOf(e)}}},{"css-font-size-keywords":82}],88:[function(e,t){'use strict';function a(e){if("string"!=typeof e)throw new Error("Font argument must be a string.");if(u[e])return u[e];if(""===e)throw new Error("Cannot parse an empty string.");if(-1!==n.indexOf(e))return u[e]={system:e};for(var t={style:"normal",variant:"normal",weight:"normal",stretch:"normal",lineHeight:"normal",size:"1rem",family:["serif"]},a=c(e,/\s+/),g;g=a.shift();){if(-1!==i.indexOf(g))return["style","variant","weight","stretch"].forEach(function(e){t[e]=g}),u[e]=t;if(-1!==s.indexOf(g)){t.style=g;continue}if("normal"===g||"small-caps"===g){t.variant=g;continue}if(-1!==d.indexOf(g)){t.stretch=g;continue}if(-1!==l.indexOf(g)){t.weight=g;continue}if(p(g)){var m=c(g,"/");if(t.size=m[0],null==m[1]?"/"===a[0]&&(a.shift(),t.lineHeight=o(a.shift())):t.lineHeight=o(m[1]),!a.length)throw new Error("Missing required font-family.");return t.family=c(a.join(" "),/\s*,\s*/).map(r),u[e]=t}throw new Error("Unknown or unsupported font token: "+g)}throw new Error("Missing required font-size.")}function o(e){var t=parseFloat(e);return t.toString()===e?t:e}var r=e("unquote"),i=e("css-global-keywords"),n=e("css-system-font-keywords"),l=e("css-font-weight-keywords"),s=e("css-font-style-keywords"),d=e("css-font-stretch-keywords"),c=e("string-split-by"),p=e("./lib/util").isSize;t.exports=a;var u=a.cache={}},{"./lib/util":87,"css-font-stretch-keywords":83,"css-font-style-keywords":84,"css-font-weight-keywords":85,"css-global-keywords":90,"css-system-font-keywords":91,"string-split-by":1301,unquote:1333}],89:[function(e,t){'use strict';function a(e,t){if(e&&!t[e]&&!n[e])throw Error("Unknown keyword `"+e+"`");return e}function o(e){for(var t={},a=0;a<e.length;a++)t[e[a]]=1;return t}var r=e("pick-by-alias"),i=e("./lib/util").isSize,n=o(e("css-global-keywords")),l=o(e("css-system-font-keywords")),s=o(e("css-font-weight-keywords")),d=o(e("css-font-style-keywords")),c=o(e("css-font-stretch-keywords")),p={normal:1,"small-caps":1},u={serif:1,"sans-serif":1,monospace:1,cursive:1,fantasy:1,"system-ui":1},g={style:"normal",variant:"normal",weight:"normal",stretch:"normal",size:"1rem",lineHeight:"normal",family:"serif"};t.exports=function(e){if(e=r(e,{style:"style fontstyle fontStyle font-style slope distinction",variant:"variant font-variant fontVariant fontvariant var capitalization",weight:"weight w font-weight fontWeight fontweight",stretch:"stretch font-stretch fontStretch fontstretch width",size:"size s font-size fontSize fontsize height em emSize",lineHeight:"lh line-height lineHeight lineheight leading",family:"font family fontFamily font-family fontfamily type typeface face",system:"system reserved default global"}),e.system)return e.system&&a(e.system,l),e.system;if(a(e.style,d),a(e.variant,p),a(e.weight,s),a(e.stretch,c),null==e.size&&(e.size=g.size),"number"==typeof e.size&&(e.size+="px"),!i)throw Error("Bad size value `"+e.size+"`");e.family||(e.family=g.family),Array.isArray(e.family)&&(!e.family.length&&(e.family=[g.family]),e.family=e.family.map(function(e){return u[e]?e:"\""+e+"\""}).join(", "));var t=[];return t.push(e.style),e.variant!==e.style&&t.push(e.variant),e.weight!==e.variant&&e.weight!==e.style&&t.push(e.weight),e.stretch!==e.weight&&e.stretch!==e.variant&&e.stretch!==e.style&&t.push(e.stretch),t.push(e.size+(null==e.lineHeight||"normal"===e.lineHeight||"1"==e.lineHeight+""?"":"/"+e.lineHeight)),t.push(e.family),t.filter(Boolean).join(" ")}},{"./lib/util":87,"css-font-stretch-keywords":83,"css-font-style-keywords":84,"css-font-weight-keywords":85,"css-global-keywords":90,"css-system-font-keywords":91,"pick-by-alias":449}],90:[function(e,t){t.exports=["inherit","initial","unset"]},{}],91:[function(e,t){t.exports=["caption","icon","menu","message-box","small-caption","status-bar"]},{}],92:[function(e,t){"use strict";t.exports=function(e,a,o,r,n,t){var l=n-1,s=n*n,d=l*l,c=(1+2*n)*d,p=n*d,u=s*(3-2*n),g=s*l;if(e.length){t||(t=Array(e.length));for(var m=e.length-1;0<=m;--m)t[m]=c*e[m]+p*a[m]+u*o[m]+g*r[m];return t}return c*e+p*a+u*o+g*r},t.exports.derivative=function(e,a,o,r,n,t){var l=6*n*n-6*n,s=3*n*n-4*n+1,d=-6*n*n+6*n,c=3*n*n-2*n;if(e.length){t||(t=Array(e.length));for(var p=e.length-1;0<=p;--p)t[p]=l*e[p]+s*a[p]+d*o[p]+c*r[p];return t}return l*e+s*a+d*o[p]+c*r}},{}],93:[function(e,t){"use strict";function a(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}var o=e("./lib/thunk.js");t.exports=function(e){var t=new a;t.pre=e.pre,t.body=e.body,t.post=e.post;var r=e.args.slice(0);t.argTypes=r;for(var n=0,l;n<r.length;++n)if(l=r[n],"array"===l||"object"==typeof l&&l.blockIndices){if(t.argTypes[n]="array",t.arrayArgs.push(n),t.arrayBlockIndices.push(l.blockIndices?l.blockIndices:0),t.shimArgs.push("array"+n),n<t.pre.args.length&&0<t.pre.args[n].count)throw new Error("cwise: pre() block may not reference array args");if(n<t.post.args.length&&0<t.post.args[n].count)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===l)t.scalarArgs.push(n),t.shimArgs.push("scalar"+n);else if("index"===l){if(t.indexArgs.push(n),n<t.pre.args.length&&0<t.pre.args[n].count)throw new Error("cwise: pre() block may not reference array index");if(n<t.body.args.length&&t.body.args[n].lvalue)throw new Error("cwise: body() block may not write to array index");if(n<t.post.args.length&&0<t.post.args[n].count)throw new Error("cwise: post() block may not reference array index")}else if("shape"===l){if(t.shapeArgs.push(n),n<t.pre.args.length&&t.pre.args[n].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(n<t.body.args.length&&t.body.args[n].lvalue)throw new Error("cwise: body() block may not write to array shape");if(n<t.post.args.length&&t.post.args[n].lvalue)throw new Error("cwise: post() block may not write to array shape")}else if("object"==typeof l&&l.offset)t.argTypes[n]="offset",t.offsetArgs.push({array:l.array,offset:l.offset}),t.offsetArgIndex.push(n);else throw new Error("cwise: Unknown argument type "+r[n]);if(0>=t.arrayArgs.length)throw new Error("cwise: No array arguments specified");if(t.pre.args.length>r.length)throw new Error("cwise: Too many arguments in pre() block");if(t.body.args.length>r.length)throw new Error("cwise: Too many arguments in body() block");if(t.post.args.length>r.length)throw new Error("cwise: Too many arguments in post() block");return t.debug=!!e.printCode||!!e.debug,t.funcName=e.funcName||"cwise",t.blockSize=e.blockSize||64,o(t)}},{"./lib/thunk.js":95}],94:[function(e,t){"use strict";var s=Math.abs;function a(e,t,a){var o=e.length,r=t.arrayArgs.length,n=0<t.indexArgs.length,l=[],s=[],d=0,c=0,p,u;for(p=0;p<o;++p)s.push(["i",p,"=0"].join(""));for(u=0;u<r;++u)for(p=0;p<o;++p)c=d,d=e[p],0===p?s.push(["d",u,"s",p,"=t",u,"p",d].join("")):s.push(["d",u,"s",p,"=(t",u,"p",d,"-s",c,"*t",u,"p",c,")"].join(""));for(0<s.length&&l.push("var "+s.join(",")),p=o-1;0<=p;--p)d=e[p],l.push(["for(i",p,"=0;i",p,"<s",d,";++i",p,"){"].join(""));for(l.push(a),p=0;p<o;++p){for(c=d,d=e[p],u=0;u<r;++u)l.push(["p",u,"+=d",u,"s",p].join(""));n&&(0<p&&l.push(["index[",c,"]-=s",c].join("")),l.push(["++index[",d,"]"].join(""))),l.push("}")}return l.join("\n")}function o(e,t,o,r){for(var n=t.length,l=o.arrayArgs.length,s=o.blockSize,d=0<o.indexArgs.length,c=[],p=0;p<l;++p)c.push(["var offset",p,"=p",p].join(""));for(var p=e;p<n;++p)c.push(["for(var j"+p+"=SS[",t[p],"]|0;j",p,">0;){"].join("")),c.push(["if(j",p,"<",s,"){"].join("")),c.push(["s",t[p],"=j",p].join("")),c.push(["j",p,"=0"].join("")),c.push(["}else{s",t[p],"=",s].join("")),c.push(["j",p,"-=",s,"}"].join("")),d&&c.push(["index[",t[p],"]=j",p].join(""));for(var p=0,u;p<l;++p){u=["offset"+p];for(var g=e;g<n;++g)u.push(["j",g,"*t",p,"p",t[g]].join(""));c.push(["p",p,"=(",u.join("+"),")"].join(""))}c.push(a(t,o,r));for(var p=e;p<n;++p)c.push("}");return c.join("\n")}function r(e){for(var t=0,a=e[0].length;t<a;){for(var o=1;o<e.length;++o)if(e[o][t]!==e[0][t])return t;++t}return t}function n(e,t,a){for(var o=e.body,r=[],n=[],l=0,d;l<e.args.length;++l)if(d=e.args[l],!(0>=d.count)){var c=new RegExp(d.name,"g"),p="",u=t.arrayArgs.indexOf(l);switch(t.argTypes[l]){case"offset":var g=t.offsetArgIndex.indexOf(l),m=t.offsetArgs[g];u=m.array,p="+q"+g;case"array":p="p"+u+p;var h="l"+l,y="a"+u;if(0===t.arrayBlockIndices[u])1===d.count?"generic"===a[u]?d.lvalue?(r.push(["var ",h,"=",y,".get(",p,")"].join("")),o=o.replace(c,h),n.push([y,".set(",p,",",h,")"].join(""))):o=o.replace(c,[y,".get(",p,")"].join("")):o=o.replace(c,[y,"[",p,"]"].join("")):"generic"===a[u]?(r.push(["var ",h,"=",y,".get(",p,")"].join("")),o=o.replace(c,h),d.lvalue&&n.push([y,".set(",p,",",h,")"].join(""))):(r.push(["var ",h,"=",y,"[",p,"]"].join("")),o=o.replace(c,h),d.lvalue&&n.push([y,"[",p,"]=",h].join("")));else{for(var f=[d.name],x=[p],_=0;_<s(t.arrayBlockIndices[u]);_++)f.push("\\s*\\[([^\\]]+)\\]"),x.push("$"+(_+1)+"*t"+u+"b"+_);if(c=new RegExp(f.join(""),"g"),p=x.join("+"),"generic"===a[u])throw new Error("cwise: Generic arrays not supported in combination with blocks!");else o=o.replace(c,[y,"[",p,"]"].join(""))}break;case"scalar":o=o.replace(c,"Y"+t.scalarArgs.indexOf(l));break;case"index":o=o.replace(c,"index");break;case"shape":o=o.replace(c,"shape");}}return[r.join("\n"),o,n.join("\n")].join("\n").trim()}function l(e){for(var a=Array(e.length),o=!0,r=0;r<e.length;++r){var n=e[r],t=n.match(/\d+/);t=t?t[0]:"",a[r]=0===n.charAt(0)?"u"+n.charAt(1)+t:n.charAt(0)+t,0<r&&(o=o&&a[r]===a[r-1])}return o?a[0]:a.join("")}var d=e("uniq");t.exports=function(e,t){for(var c=0|t[1].length-s(e.arrayBlockIndices[0]),p=Array(e.arrayArgs.length),u=Array(e.arrayArgs.length),g=0;g<e.arrayArgs.length;++g)u[g]=t[2*g],p[g]=t[2*g+1];for(var m=[],h=[],y=[],x=[],_=[],g=0;g<e.arrayArgs.length;++g){0>e.arrayBlockIndices[g]?(y.push(0),x.push(c),m.push(c),h.push(c+e.arrayBlockIndices[g])):(y.push(e.arrayBlockIndices[g]),x.push(e.arrayBlockIndices[g]+c),m.push(0),h.push(e.arrayBlockIndices[g]));for(var b=[],v=0;v<p[g].length;v++)y[g]<=p[g][v]&&p[g][v]<x[g]&&b.push(p[g][v]-y[g]);_.push(b)}for(var w=["SS"],k=["'use strict'"],T=[],v=0;v<c;++v)T.push(["s",v,"=SS[",v,"]"].join(""));for(var g=0;g<e.arrayArgs.length;++g){w.push("a"+g),w.push("t"+g),w.push("p"+g);for(var v=0;v<c;++v)T.push(["t",g,"p",v,"=t",g,"[",y[g]+v,"]"].join(""));for(var v=0;v<s(e.arrayBlockIndices[g]);++v)T.push(["t",g,"b",v,"=t",g,"[",m[g]+v,"]"].join(""))}for(var g=0;g<e.scalarArgs.length;++g)w.push("Y"+g);if(0<e.shapeArgs.length&&T.push("shape=SS.slice(0)"),0<e.indexArgs.length){for(var A=Array(c),g=0;g<c;++g)A[g]="0";T.push(["index=[",A.join(","),"]"].join(""))}for(var g=0;g<e.offsetArgs.length;++g){for(var S=e.offsetArgs[g],C=[],v=0;v<S.offset.length;++v)if(0===S.offset[v])continue;else 1===S.offset[v]?C.push(["t",S.array,"p",v].join("")):C.push([S.offset[v],"*t",S.array,"p",v].join(""));0===C.length?T.push("q"+g+"=0"):T.push(["q",g,"=",C.join("+")].join(""))}var L=d([].concat(e.pre.thisVars).concat(e.body.thisVars).concat(e.post.thisVars));T=T.concat(L),0<T.length&&k.push("var "+T.join(","));for(var g=0;g<e.arrayArgs.length;++g)k.push("p"+g+"|=0");3<e.pre.body.length&&k.push(n(e.pre,e,u));var E=n(e.body,e,u),I=r(_);I<c?k.push(o(I,_[0],e,E)):k.push(a(_[0],e,E)),3<e.post.body.length&&k.push(n(e.post,e,u)),e.debug&&console.log("-----Generated cwise routine for ",t,":\n"+k.join("\n")+"\n----------");var P=[e.funcName||"unnamed","_cwise_loop_",p[0].join("s"),"m",I,l(u)].join(""),z=new Function(["function ",P,"(",w.join(","),"){",k.join("\n"),"} return ",P].join(""));return z()}},{uniq:1331}],95:[function(e,t){"use strict";var a=Math.abs,o=Math.max,r=e("./compile.js");t.exports=function(e){var t=["'use strict'","var CACHED={}"],n=[],l=e.funcName+"_cwise_thunk";t.push(["return function ",l,"(",e.shimArgs.join(","),"){"].join(""));for(var s=[],d=[],c=[["array",e.arrayArgs[0],".shape.slice(",o(0,e.arrayBlockIndices[0]),0>e.arrayBlockIndices[0]?","+e.arrayBlockIndices[0]+")":")"].join("")],p=[],u=[],g=0,m;g<e.arrayArgs.length;++g)m=e.arrayArgs[g],n.push(["t",m,"=array",m,".dtype,","r",m,"=array",m,".order"].join("")),s.push("t"+m),s.push("r"+m),d.push("t"+m),d.push("r"+m+".join()"),c.push("array"+m+".data"),c.push("array"+m+".stride"),c.push("array"+m+".offset|0"),0<g&&(p.push("array"+e.arrayArgs[0]+".shape.length===array"+m+".shape.length+"+(a(e.arrayBlockIndices[0])-a(e.arrayBlockIndices[g]))),u.push("array"+e.arrayArgs[0]+".shape[shapeIndex+"+o(0,e.arrayBlockIndices[0])+"]===array"+m+".shape[shapeIndex+"+o(0,e.arrayBlockIndices[g])+"]"));1<e.arrayArgs.length&&(t.push("if (!("+p.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),t.push("for(var shapeIndex=array"+e.arrayArgs[0]+".shape.length-"+a(e.arrayBlockIndices[0])+"; shapeIndex-->0;) {"),t.push("if (!("+u.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),t.push("}"));for(var g=0;g<e.scalarArgs.length;++g)c.push("scalar"+e.scalarArgs[g]);n.push(["type=[",d.join(","),"].join()"].join("")),n.push("proc=CACHED[type]"),t.push("var "+n.join(",")),t.push(["if(!proc){","CACHED[type]=proc=compile([",s.join(","),"])}","return proc(",c.join(","),")}"].join("")),e.debug&&console.log("-----Generated thunk:\n"+t.join("\n")+"\n----------");var h=new Function("compile",t.join("\n"));return h(r.bind(void 0,e))}},{"./compile.js":94}],96:[function(e,t){t.exports=e("cwise-compiler")},{"cwise-compiler":93}],97:[function(e,t,a){var o=Math.LN10,r=Math.log,l=Math.ceil,s=Math.sqrt,d=Math.pow,c=Math.abs,p=Math.max,u=Math.floor;(function(e,o){"object"==typeof a&&"undefined"!=typeof t?o(a):"function"==typeof define&&define.amd?define(["exports"],o):o(e.d3=e.d3||{})})(this,function(e){'use strict';function t(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function a(e){return 1===e.length&&(e=i(e)),{left:function(t,a,o,r){for(null==o&&(o=0),null==r&&(r=t.length);o<r;){var i=o+r>>>1;0>e(t[i],a)?o=i+1:r=i}return o},right:function(t,a,o,r){for(null==o&&(o=0),null==r&&(r=t.length);o<r;){var i=o+r>>>1;0<e(t[i],a)?r=i:o=i+1}return o}}}function i(e){return function(a,o){return t(e(a),o)}}function n(e,t){null==t&&(t=g);for(var a=0,o=e.length-1,r=e[0],n=Array(0>o?0:o);a<o;)n[a]=t(r,r=e[++a]);return n}function g(e,t){return[e,t]}function h(e){return null===e?NaN:+e}function y(e,t){var a=e.length,o=0,r=-1,n=0,l=0,s,d;if(null==t)for(;++r<a;)isNaN(s=h(e[r]))||(d=s-n,n+=d/++o,l+=d*(s-n));else for(;++r<a;)isNaN(s=h(t(e[r],r,e)))||(d=s-n,n+=d/++o,l+=d*(s-n));return 1<o?l/(o-1):void 0}function f(e,t){var a=y(e,t);return a?s(a):a}function x(e,t){var a=e.length,o=-1,r,n,l;if(null==t){for(;++o<a;)if(null!=(r=e[o])&&r>=r)for(n=l=r;++o<a;)null!=(r=e[o])&&(n>r&&(n=r),l<r&&(l=r));}else for(;++o<a;)if(null!=(r=t(e[o],o,e))&&r>=r)for(n=l=r;++o<a;)null!=(r=t(e[o],o,e))&&(n>r&&(n=r),l<r&&(l=r));return[n,l]}function b(e){return function(){return e}}function v(e){return e}function w(e,t,a){e=+e,t=+t,a=2>(r=arguments.length)?(t=e,e=0,1):3>r?1:+a;for(var o=-1,r=0|p(0,l((t-e)/a)),s=Array(r);++o<r;)s[o]=e+o*a;return s}function k(e,t,a){var o=-1,r,s,d,c;if(t=+t,e=+e,a=+a,e===t&&0<a)return[e];if((r=t<e)&&(s=e,e=t,t=s),0===(c=T(e,t,a))||!isFinite(c))return[];if(0<c)for(e=l(e/c),t=u(t/c),d=Array(s=l(t-e+1));++o<s;)d[o]=(e+o)*c;else for(e=u(e*c),t=l(t*c),d=Array(s=l(e-t+1));++o<s;)d[o]=(e-o)/c;return r&&d.reverse(),d}function T(e,t,a){var i=(t-e)/p(0,a),n=u(r(i)/o),l=i/d(10,n);return 0<=n?(l>=N?10:l>=V?5:l>=m?2:1)*d(10,n):-d(10,-n)/(l>=N?10:l>=V?5:l>=m?2:1)}function A(e,t,a){var i=c(t-e)/p(0,a),n=d(10,u(r(i)/o)),l=i/n;return l>=N?n*=10:l>=V?n*=5:l>=m&&(n*=2),t<e?-n:n}function S(e){return l(r(e.length)/Math.LN2)+1}function C(){function e(e){var r=e.length,n=Array(r),s,d;for(s=0;s<r;++s)n[s]=t(e[s],s,e);var c=a(n),p=c[0],u=c[1],g=o(n,p,u);Array.isArray(g)||(g=A(p,u,g),g=w(l(p/g)*g,u,g));for(var h=g.length;g[0]<=p;)g.shift(),--h;for(;g[h-1]>u;)g.pop(),--h;var y=Array(h+1),f;for(s=0;s<=h;++s)f=y[s]=[],f.x0=0<s?g[s-1]:p,f.x1=s<h?g[s]:u;for(s=0;s<r;++s)d=n[s],p<=d&&d<=u&&y[R(g,d,0,h)].push(e[s]);return y}var t=v,a=x,o=S;return e.value=function(a){return arguments.length?(t="function"==typeof a?a:b(a),e):t},e.domain=function(t){return arguments.length?(a="function"==typeof t?t:b([t[0],t[1]]),e):a},e.thresholds=function(t){return arguments.length?(o="function"==typeof t?t:Array.isArray(t)?b(B.call(t)):b(t),e):o},e}function L(e,t,a){if(null==a&&(a=h),!!(s=e.length)){if(0>=(t=+t)||2>s)return+a(e[0],0,e);if(1<=t)return+a(e[s-1],s-1,e);var o=(s-1)*t,r=u(o),i=+a(e[r],r,e),l=+a(e[r+1],r+1,e),s;return i+(l-i)*(o-r)}}function E(e,t){var a=e.length,o=-1,r,n;if(null==t){for(;++o<a;)if(null!=(r=e[o])&&r>=r)for(n=r;++o<a;)null!=(r=e[o])&&r>n&&(n=r);}else for(;++o<a;)if(null!=(r=t(e[o],o,e))&&r>=r)for(n=r;++o<a;)null!=(r=t(e[o],o,e))&&r>n&&(n=r);return n}function I(e,t){var a=e.length,o=-1,r,n;if(null==t){for(;++o<a;)if(null!=(r=e[o])&&r>=r)for(n=r;++o<a;)null!=(r=e[o])&&n>r&&(n=r);}else for(;++o<a;)if(null!=(r=t(e[o],o,e))&&r>=r)for(n=r;++o<a;)null!=(r=t(e[o],o,e))&&n>r&&(n=r);return n}function P(e,t){var a=e.length,o=-1,r=0,n;if(null==t)for(;++o<a;)(n=+e[o])&&(r+=n);else for(;++o<a;)(n=+t(e[o],o,e))&&(r+=n);return r}function z(e){if(!(s=e.length))return[];for(var t=-1,a=I(e,D),o=Array(a);++t<a;)for(var r=-1,l=o[t]=Array(s),s;++r<s;)l[r]=e[r][t];return o}function D(e){return e.length}var O=a(t),R=O.right,M=O.left,j=Array.prototype,B=j.slice,F=j.map,N=s(50),V=s(10),m=s(2);e.bisect=R,e.bisectRight=R,e.bisectLeft=M,e.ascending=t,e.bisector=a,e.cross=function(e,t,a){var o=e.length,r=t.length,n=Array(o*r),l,s,d,c;for(null==a&&(a=g),l=d=0;l<o;++l)for(c=e[l],s=0;s<r;++s,++d)n[d]=a(c,t[s]);return n},e.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},e.deviation=f,e.extent=x,e.histogram=C,e.thresholdFreedmanDiaconis=function(e,a,o){return e=F.call(e,h).sort(t),l((o-a)/(2*(L(e,.75)-L(e,.25))*d(e.length,-1/3)))},e.thresholdScott=function(e,t,a){return l((a-t)/(3.5*f(e)*d(e.length,-1/3)))},e.thresholdSturges=S,e.max=E,e.mean=function(e,t){var a=e.length,o=a,r=-1,n=0,l;if(null==t)for(;++r<a;)isNaN(l=h(e[r]))?--o:n+=l;else for(;++r<a;)isNaN(l=h(t(e[r],r,e)))?--o:n+=l;return o?n/o:void 0},e.median=function(e,a){var o=e.length,r=-1,n=[],l;if(null==a)for(;++r<o;)isNaN(l=h(e[r]))||n.push(l);else for(;++r<o;)isNaN(l=h(a(e[r],r,e)))||n.push(l);return L(n.sort(t),.5)},e.merge=function(e){for(var t=e.length,a=-1,o=0,r,l,s;++a<t;)o+=e[a].length;for(l=Array(o);0<=--t;)for(s=e[t],r=s.length;0<=--r;)l[--o]=s[r];return l},e.min=I,e.pairs=n,e.permute=function(e,t){for(var a=t.length,o=Array(a);a--;)o[a]=e[t[a]];return o},e.quantile=L,e.range=w,e.scan=function(e,a){if(s=e.length){var o=0,r=0,l=e[r],s,d;for(null==a&&(a=t);++o<s;)(0>a(d=e[o],l)||0!==a(l,l))&&(l=d,r=o);if(0===a(l,l))return r}},e.shuffle=function(e,a,o){for(var r=(null==o?e.length:o)-(a=null==a?0:+a),n,l;r;)l=0|Math.random()*r--,n=e[r+a],e[r+a]=e[l+a],e[l+a]=n;return e},e.sum=P,e.ticks=k,e.tickIncrement=T,e.tickStep=A,e.transpose=z,e.variance=y,e.zip=function(){return z(arguments)},Object.defineProperty(e,"__esModule",{value:!0})})},{}],98:[function(e,t,a){(function(e,o){"object"==typeof a&&"undefined"!=typeof t?o(a):"function"==typeof define&&define.amd?define(["exports"],o):o(e.d3=e.d3||{})})(this,function(e){'use strict';function t(){}function a(e,a){var r=new t;if(e instanceof t)e.each(function(e,t){r.set(t,e)});else if(Array.isArray(e)){var l=-1,s=e.length,n;if(null==a)for(;++l<s;)r.set(l,e[l]);else for(;++l<s;)r.set(a(n=e[l],l,e),n)}else if(e)for(var d in e)r.set(d,e[d]);return r}function o(){function e(t,r,l,s){if(r>=o.length)return null!=d&&t.sort(d),null==c?t:c(t);for(var p=-1,u=t.length,n=o[r++],g=a(),m=l(),h,y,f;++p<u;)(f=g.get(h=n(y=t[p])+""))?f.push(y):g.set(h,[y]);return g.each(function(t,a){s(m,a,e(t,r,l,s))}),m}function t(e,a){if(++a>o.length)return e;var r=s[a-1],i;return null!=c&&a>=o.length?i=e.entries():(i=[],e.each(function(e,o){i.push({key:o,values:t(e,a)})})),null==r?i:i.sort(function(e,t){return r(e.key,t.key)})}var o=[],s=[],d,c,p;return p={object:function(t){return e(t,0,r,i)},map:function(t){return e(t,0,n,l)},entries:function(a){return t(e(a,0,n,l),0)},key:function(e){return o.push(e),p},sortKeys:function(e){return s[o.length-1]=e,p},sortValues:function(e){return d=e,p},rollup:function(e){return c=e,p}}}function r(){return{}}function i(e,t,a){e[t]=a}function n(){return a()}function l(e,t,a){e.set(t,a)}function s(){}function d(e,t){var a=new s;if(e instanceof s)e.each(function(e){a.add(e)});else if(e){var o=-1,r=e.length;if(null==t)for(;++o<r;)a.add(e[o]);else for(;++o<r;)a.add(t(e[o],o,e))}return a}function c(e){var t=[];for(var a in e)t.push(a);return t}function p(e){var t=[];for(var a in e)t.push(e[a]);return t}function u(e){var t=[];for(var a in e)t.push({key:a,value:e[a]});return t}t.prototype=a.prototype={constructor:t,has:function(e){return"$"+e in this},get:function(e){return this["$"+e]},set:function(e,t){return this["$"+e]=t,this},remove:function(e){var t="$"+e;return t in this&&delete this[t]},clear:function(){for(var e in this)"$"===e[0]&&delete this[e]},keys:function(){var e=[];for(var t in this)"$"===t[0]&&e.push(t.slice(1));return e},values:function(){var e=[];for(var t in this)"$"===t[0]&&e.push(this[t]);return e},entries:function(){var e=[];for(var t in this)"$"===t[0]&&e.push({key:t.slice(1),value:this[t]});return e},size:function(){var e=0;for(var t in this)"$"===t[0]&&++e;return e},empty:function(){for(var e in this)if(e[0]==="$")return!1;return!0},each:function(e){for(var t in this)"$"===t[0]&&e(this[t],t.slice(1),this)}};var g=a.prototype;s.prototype=d.prototype={constructor:s,has:g.has,add:function(e){return e+="",this["$"+e]=e,this},remove:g.remove,clear:g.clear,values:g.keys,size:g.size,empty:g.empty,each:g.each},e.nest=o,e.set=d,e.map=a,e.keys=c,e.values=p,e.entries=u,Object.defineProperty(e,"__esModule",{value:!0})})},{}],99:[function(e,t,a){var i=Math.atan2,n=Math.cos,d=Math.sqrt,c=Math.round,p=Math.PI,u=Math.sin,m=Math.min,h=Math.pow,y=Math.max;(function(e,o){"object"==typeof a&&"undefined"!=typeof t?o(a):"function"==typeof define&&define.amd?define(["exports"],o):(e=e||self,o(e.d3=e.d3||{}))})(this,function(e){'use strict';function t(e,t,a){e.prototype=t.prototype=a,a.constructor=e}function a(e,t){var a=Object.create(e.prototype);for(var o in t)a[o]=t[o];return a}function f(){}function x(){return this.rgb().formatHex()}function _(){return this.rgb().formatRgb()}function v(e){var t,a;return e=(e+"").trim().toLowerCase(),(t=ne.exec(e))?(a=t[1].length,t=parseInt(t[1],16),6===a?w(t):3===a?new L(15&t>>8|240&t>>4,15&t>>4|240&t,(15&t)<<4|15&t,1):8===a?k(255&t>>24,255&t>>16,255&t>>8,(255&t)/255):4===a?k(15&t>>12|240&t>>8,15&t>>8|240&t>>4,15&t>>4|240&t,((15&t)<<4|15&t)/255):null):(t=le.exec(e))?new L(t[1],t[2],t[3],1):(t=se.exec(e))?new L(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=de.exec(e))?k(t[1],t[2],t[3],t[4]):(t=ce.exec(e))?k(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=pe.exec(e))?O(t[1],t[2]/100,t[3]/100,1):(t=ue.exec(e))?O(t[1],t[2]/100,t[3]/100,t[4]):ge.hasOwnProperty(e)?w(ge[e]):"transparent"===e?new L(NaN,NaN,NaN,0):null}function w(e){return new L(255&e>>16,255&e>>8,255&e,1)}function k(e,t,o,i){return 0>=i&&(e=t=o=NaN),new L(e,t,o,i)}function T(e){return(e instanceof f||(e=v(e)),!e)?new L:(e=e.rgb(),new L(e.r,e.g,e.b,e.opacity))}function S(e,t,a,o){return 1===arguments.length?T(e):new L(e,t,a,null==o?1:o)}function L(e,t,a,o){this.r=+e,this.g=+t,this.b=+a,this.opacity=+o}function I(){return"#"+z(this.r)+z(this.g)+z(this.b)}function P(){var e=this.opacity;return e=isNaN(e)?1:y(0,m(1,e)),(1===e?"rgb(":"rgba(")+y(0,m(255,c(this.r)||0))+", "+y(0,m(255,c(this.g)||0))+", "+y(0,m(255,c(this.b)||0))+(1===e?")":", "+e+")")}function z(e){return e=y(0,m(255,c(e)||0)),(16>e?"0":"")+e.toString(16)}function O(e,t,o,r){return 0>=r?e=t=o=NaN:0>=o||1<=o?e=t=NaN:0>=t&&(e=NaN),new j(e,t,o,r)}function R(e){if(e instanceof j)return new j(e.h,e.s,e.l,e.opacity);if(e instanceof f||(e=v(e)),!e)return new j;if(e instanceof j)return e;e=e.rgb();var t=e.r/255,a=e.g/255,r=e.b/255,i=m(t,a,r),n=y(t,a,r),d=NaN,c=n-i,p=(n+i)/2;return c?(d=t===n?(a-r)/c+6*(a<r):a===n?(r-t)/c+2:(t-a)/c+4,c/=.5>p?n+i:2-n-i,d*=60):c=0<p&&1>p?0:d,new j(d,c,p,e.opacity)}function M(e,t,a,o){return 1===arguments.length?R(e):new j(e,t,a,null==o?1:o)}function j(e,t,a,o){this.h=+e,this.s=+t,this.l=+a,this.opacity=+o}function F(e,t,a){return 255*(60>e?t+(a-t)*e/60:180>e?a:240>e?t+(a-t)*(240-e)/60:t)}function N(e){if(e instanceof U)return new U(e.l,e.a,e.b,e.opacity);if(e instanceof Z)return $(e);e instanceof L||(e=T(e));var t=Y(e.r),a=Y(e.g),r=Y(e.b),i=H((.2225045*t+.7168786*a+.0606169*r)/1),n,d;return t===a&&a===r?n=d=i:(n=H((.4360747*t+.3850649*a+.1430804*r)/l),d=H((.0139322*t+.0971045*a+.7141733*r)/s)),new U(116*i-16,500*(n-i),200*(i-d),e.opacity)}function V(e,t,a,o){return 1===arguments.length?N(e):new U(e,t,a,null==o?1:o)}function U(e,t,a,o){this.l=+e,this.a=+t,this.b=+a,this.opacity=+o}function H(e){return e>b?h(e,1/3):e/g+o}function q(e){return e>r?e*e*e:g*(e-o)}function G(e){return 255*(.0031308>=e?12.92*e:1.055*h(e,1/2.4)-.055)}function Y(e){return .04045>=(e/=255)?e/12.92:h((e+.055)/1.055,2.4)}function W(e){if(e instanceof Z)return new Z(e.h,e.c,e.l,e.opacity);if(e instanceof U||(e=N(e)),0===e.a&&0===e.b)return new Z(NaN,0<e.l&&100>e.l?0:NaN,e.l,e.opacity);var t=i(e.b,e.a)*he;return new Z(0>t?t+360:t,d(e.a*e.a+e.b*e.b),e.l,e.opacity)}function X(e,t,a,o){return 1===arguments.length?W(e):new Z(e,t,a,null==o?1:o)}function Z(e,t,a,o){this.h=+e,this.c=+t,this.l=+a,this.opacity=+o}function $(e){if(isNaN(e.h))return new U(e.l,0,0,e.opacity);var t=e.h*me;return new U(e.l,n(t)*e.c,u(t)*e.c,e.opacity)}function J(e){if(e instanceof ee)return new ee(e.h,e.s,e.l,e.opacity);e instanceof L||(e=T(e));var t=e.r/255,a=e.g/255,r=e.b/255,n=(xe*r+E*t-fe*a)/(xe+E-fe),l=r-n,c=(D*(a-n)-B*l)/C,p=d(c*c+l*l)/(D*n*(1-n)),s=p?i(c,l)*he-120:NaN;return new ee(0>s?s+360:s,p,n,e.opacity)}function Q(e,t,a,o){return 1===arguments.length?J(e):new ee(e,t,a,null==o?1:o)}function ee(e,t,a,o){this.h=+e,this.s=+t,this.l=+a,this.opacity=+o}var te=.7,ae=1/te,oe="\\s*([+-]?\\d+)\\s*",re="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",ie="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ne=/^#([0-9a-f]{3,8})$/,le=new RegExp("^rgb\\("+[oe,oe,oe]+"\\)$"),se=new RegExp("^rgb\\("+[ie,ie,ie]+"\\)$"),de=new RegExp("^rgba\\("+[oe,oe,oe,re]+"\\)$"),ce=new RegExp("^rgba\\("+[ie,ie,ie,re]+"\\)$"),pe=new RegExp("^hsl\\("+[re,ie,ie]+"\\)$"),ue=new RegExp("^hsla\\("+[re,ie,ie,re]+"\\)$"),ge={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};t(f,v,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:x,formatHex:x,formatHsl:function(){return R(this).formatHsl()},formatRgb:_,toString:_}),t(L,S,a(f,{brighter:function(e){return e=null==e?ae:h(ae,e),new L(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?te:h(te,e),new L(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&255.5>this.r&&-.5<=this.g&&255.5>this.g&&-.5<=this.b&&255.5>this.b&&0<=this.opacity&&1>=this.opacity},hex:I,formatHex:I,formatRgb:P,toString:P})),t(j,M,a(f,{brighter:function(e){return e=null==e?ae:h(ae,e),new j(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?te:h(te,e),new j(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(0>this.h),t=isNaN(e)||isNaN(this.s)?0:this.s,a=this.l,o=a+(.5>a?a:1-a)*t,r=2*a-o;return new L(F(240<=e?e-240:e+120,r,o),F(e,r,o),F(120>e?e+240:e-120,r,o),this.opacity)},displayable:function(){return(0<=this.s&&1>=this.s||isNaN(this.s))&&0<=this.l&&1>=this.l&&0<=this.opacity&&1>=this.opacity},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:y(0,m(1,e)),(1===e?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));var me=p/180,he=180/p,ye=18,l=.96422,s=.82521,o=4/29,r=6/29,g=3*r*r,b=r*r*r;t(U,V,a(f,{brighter:function(e){return new U(this.l+ye*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new U(this.l-ye*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,a=isNaN(this.b)?e:e-this.b/200;return t=l*q(t),e=1*q(e),a=s*q(a),new L(G(3.1338561*t-1.6168667*e-.4906146*a),G(-.9787684*t+1.9161415*e+.033454*a),G(.0719453*t-.2289914*e+1.4052427*a),this.opacity)}})),t(Z,X,a(f,{brighter:function(e){return new Z(this.h,this.c,this.l+ye*(null==e?1:e),this.opacity)},darker:function(e){return new Z(this.h,this.c,this.l-ye*(null==e?1:e),this.opacity)},rgb:function(){return $(this).rgb()}}));var K=-.14861,A=+1.78277,B=-.29227,C=-.90649,D=+1.97294,E=D*C,fe=D*A,xe=A*B-C*K;t(ee,Q,a(f,{brighter:function(e){return e=null==e?ae:h(ae,e),new ee(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?te:h(te,e),new ee(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*me,t=+this.l,o=isNaN(this.s)?0:this.s*t*(1-t),a=n(e),r=u(e);return new L(255*(t+o*(K*a+A*r)),255*(t+o*(B*a+C*r)),255*(t+o*(D*a)),this.opacity)}})),e.color=v,e.cubehelix=Q,e.gray=function(e,t){return new U(e,0,0,null==t?1:t)},e.hcl=X,e.hsl=M,e.lab=V,e.lch=function(e,t,a,o){return 1===arguments.length?W(e):new Z(a,t,e,null==o?1:o)},e.rgb=S,Object.defineProperty(e,"__esModule",{value:!0})})},{}],100:[function(e,t,a){(function(e,o){"object"==typeof a&&"undefined"!=typeof t?o(a):"function"==typeof define&&define.amd?define(["exports"],o):(e=e||self,o(e.d3=e.d3||{}))})(this,function(e){'use strict';function t(){for(var e=0,o=arguments.length,r={},n;e<o;++e){if(!(n=arguments[e]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new a(r)}function a(e){this._=e}function o(e,a){return e.trim().split(/^|\s+/).map(function(e){var o="",r=e.indexOf(".");if(0<=r&&(o=e.slice(r+1),e=e.slice(0,r)),e&&!a.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:o}})}function r(e,t){for(var a=0,o=e.length,r;a<o;++a)if((r=e[a]).name===t)return r.value}function l(e,t,a){for(var o=0,r=e.length;o<r;++o)if(e[o].name===t){e[o]=s,e=e.slice(0,o).concat(e.slice(o+1));break}return null!=a&&e.push({name:t,value:a}),e}var s={value:function(){}};a.prototype=t.prototype={constructor:a,on:function(e,a){var s=this._,d=o(e+"",s),c=-1,p=d.length,n;if(2>arguments.length){for(;++c<p;)if((n=(e=d[c]).type)&&(n=r(s[n],e.name)))return n;return}if(null!=a&&"function"!=typeof a)throw new Error("invalid callback: "+a);for(;++c<p;)if(n=(e=d[c]).type)s[n]=l(s[n],e.name,a);else if(null==a)for(n in s)s[n]=l(s[n],e.name,null);return this},copy:function(){var e={},o=this._;for(var r in o)e[r]=o[r].slice();return new a(e)},call:function(e,a){if(0<(l=arguments.length-2))for(var o=Array(l),r=0,l,s;r<l;++r)o[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,l=s.length;r<l;++r)s[r].value.apply(a,o)},apply:function(e,a,o){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],t=0,l=r.length;t<l;++t)r[t].value.apply(a,o)}},e.dispatch=t,Object.defineProperty(e,"__esModule",{value:!0})})},{}],101:[function(e,t,a){var o=Math.cos,s=Math.sqrt,d=Math.sin,c=Math.min,p=Math.pow,u=Math.abs;(function(o,r){"object"==typeof a&&"undefined"!=typeof t?r(a,e("d3-quadtree"),e("d3-collection"),e("d3-dispatch"),e("d3-timer")):"function"==typeof define&&define.amd?define(["exports","d3-quadtree","d3-collection","d3-dispatch","d3-timer"],r):r(o.d3=o.d3||{},o.d3,o.d3,o.d3,o.d3)})(this,function(e,t,a,r,i){'use strict';function n(e){return function(){return e}}function g(){return 1e-6*(Math.random()-.5)}function m(e){return e.x+e.vx}function l(e){return e.y+e.vy}function h(e){return e.index}function y(e,t){var a=e.get(t);if(!a)throw new Error("missing: "+t);return a}function f(e){return e.x}function x(e){return e.y}function _(e){function t(){n(),v.call("tick",w),u<g&&(x.stop(),v.call("end",w))}function n(t){var a=e.length,o,r;void 0===t&&(t=1);for(var n=0;n<t;++n)for(u+=(h-u)*m,f.each(function(e){e(u)}),o=0;o<a;++o)r=e[o],null==r.fx?r.x+=r.vx*=y:(r.x=r.fx,r.vx=0),null==r.fy?r.y+=r.vy*=y:(r.y=r.fy,r.vy=0);return w}function l(){for(var t=0,a=e.length,r;t<a;++t){if(r=e[t],r.index=t,null!=r.fx&&(r.x=r.fx),null!=r.fy&&(r.y=r.fy),isNaN(r.x)||isNaN(r.y)){var n=10*s(t),l=t*b;r.x=n*o(l),r.y=n*d(l)}(isNaN(r.vx)||isNaN(r.vy))&&(r.vx=r.vy=0)}}function c(t){return t.initialize&&t.initialize(e),t}var u=1,g=.001,m=1-p(g,1/300),h=0,y=.6,f=a.map(),x=i.timer(t),v=r.dispatch("tick","end"),w;return null==e&&(e=[]),l(),w={tick:n,restart:function(){return x.restart(t),w},stop:function(){return x.stop(),w},nodes:function(t){return arguments.length?(e=t,l(),f.each(c),w):e},alpha:function(e){return arguments.length?(u=+e,w):u},alphaMin:function(e){return arguments.length?(g=+e,w):g},alphaDecay:function(e){return arguments.length?(m=+e,w):+m},alphaTarget:function(e){return arguments.length?(h=+e,w):h},velocityDecay:function(e){return arguments.length?(y=1-e,w):1-y},force:function(e,t){return 1<arguments.length?(null==t?f.remove(e):f.set(e,c(t)),w):f.get(e)},find:function(t,a,o){var r=0,l=e.length,n,s,d,c,p;for(null==o?o=1/0:o*=o,r=0;r<l;++r)c=e[r],n=t-c.x,s=a-c.y,d=n*n+s*s,d<o&&(p=c,o=d);return p},on:function(e,t){return 1<arguments.length?(v.on(e,t),w):v.on(e)}}}var b=Math.PI*(3-s(5));e.forceCenter=function(e,t){function a(){var a=o.length,r=0,n=0,l,s;for(l=0;l<a;++l)s=o[l],r+=s.x,n+=s.y;for(r=r/a-e,n=n/a-t,l=0;l<a;++l)s=o[l],s.x-=r,s.y-=n}var o;return null==e&&(e=0),null==t&&(t=0),a.initialize=function(e){o=e},a.x=function(t){return arguments.length?(e=+t,a):e},a.y=function(e){return arguments.length?(t=+e,a):t},a},e.forceCollide=function(e){function a(){function e(e,t,a,o,n){var d=e.data,c=e.r,p=b+c;if(d){if(d.index>h.index){var u=f-d.x-d.vx,m=_-d.y-d.vy,w=u*u+m*m;w<p*p&&(0===u&&(u=g(),w+=u*u),0===m&&(m=g(),w+=m*m),w=(p-(w=s(w)))/w*i,h.vx+=(u*=w)*(p=(c*=c)/(v+c)),h.vy+=(m*=w)*p,d.vx-=u*(p=1-p),d.vy-=m*p)}return}return t>f+p||o<f-p||a>_+p||n<_-p}for(var a=c.length,r=0,n,u,h,f,_,b,v;r<d;++r)for(u=t.quadtree(c,m,l).visitAfter(o),n=0;n<a;++n)h=c[n],b=p[h.index],v=b*b,f=h.x+h.vx,_=h.y+h.vy,u.visit(e)}function o(e){if(e.data)return e.r=p[e.data.index];for(var t=e.r=0;4>t;++t)e[t]&&e[t].r>e.r&&(e.r=e[t].r)}function r(){if(c){var t=c.length,a,o;for(p=Array(t),a=0;a<t;++a)o=c[a],p[o.index]=+e(o,a,c)}}var i=1,d=1,c,p;return"function"!=typeof e&&(e=n(null==e?1:+e)),a.initialize=function(e){c=e,r()},a.iterations=function(e){return arguments.length?(d=+e,a):d},a.strength=function(e){return arguments.length?(i=+e,a):i},a.radius=function(t){return arguments.length?(e="function"==typeof t?t:n(+t),r(),a):e},a},e.forceLink=function(e){function t(e){return 1/c(k[e.source.index],k[e.target.index])}function o(t){for(var a=0,o=e.length;a<f;++a)for(var r=0,n,d,c,p,u,m,h;r<o;++r)n=e[r],d=n.source,c=n.target,p=c.x+c.vx-d.x-d.vx||g(),u=c.y+c.vy-d.y-d.vy||g(),m=s(p*p+u*u),m=(m-v[r])/m*t*_[r],p*=m,u*=m,c.vx-=p*(h=T[r]),c.vy-=u*h,d.vx+=p*(h=1-h),d.vy+=u*h}function r(){if(w){var t=w.length,o=e.length,r=a.map(w,p),n,s;for(n=0,k=Array(t);n<o;++n)s=e[n],s.index=n,"object"!=typeof s.source&&(s.source=y(r,s.source)),"object"!=typeof s.target&&(s.target=y(r,s.target)),k[s.source.index]=(k[s.source.index]||0)+1,k[s.target.index]=(k[s.target.index]||0)+1;for(n=0,T=Array(o);n<o;++n)s=e[n],T[n]=k[s.source.index]/(k[s.source.index]+k[s.target.index]);_=Array(o),l(),v=Array(o),d()}}function l(){if(w)for(var t=0,a=e.length;t<a;++t)_[t]=+u(e[t],t,e)}function d(){if(w)for(var t=0,a=e.length;t<a;++t)v[t]=+m(e[t],t,e)}var p=h,u=t,m=n(30),f=1,_,v,w,k,T;return null==e&&(e=[]),o.initialize=function(e){w=e,r()},o.links=function(t){return arguments.length?(e=t,r(),o):e},o.id=function(e){return arguments.length?(p=e,o):p},o.iterations=function(e){return arguments.length?(f=+e,o):f},o.strength=function(e){return arguments.length?(u="function"==typeof e?e:n(+e),l(),o):u},o.distance=function(e){return arguments.length?(m="function"==typeof e?e:n(+e),d(),o):m},o},e.forceManyBody=function(){function e(e){var a=m.length,n=t.quadtree(m,f,x).visitAfter(o),l;for(b=e,l=0;l<a;++l)h=m[l],n.visit(r)}function a(){if(m){var e=m.length,t,a;for(v=Array(e),t=0;t<e;++t)a=m[t],v[a.index]=+l(a,t,m)}}function o(e){var t=0,a=0,o,r,n,l,s;if(e.length){for(n=l=s=0;4>s;++s)(o=e[s])&&(r=u(o.value))&&(t+=o.value,a+=r,n+=r*o.x,l+=r*o.y);e.x=n/a,e.y=l/a}else{o=e,o.x=o.data.x,o.y=o.data.y;do t+=v[o.data.index];while(o=o.next)}e.value=t}function r(e,t,a,o){if(!e.value)return!0;var r=e.x-h.x,i=e.y-h.y,n=o-t,u=r*r+i*i;if(n*n/p<u)return u<c&&(0===r&&(r=g(),u+=r*r),0===i&&(i=g(),u+=i*i),u<d&&(u=s(d*u)),h.vx+=r*e.value*b/u,h.vy+=i*e.value*b/u),!0;if(!(e.length||u>=c)){(e.data!==h||e.next)&&(0===r&&(r=g(),u+=r*r),0===i&&(i=g(),u+=i*i),u<d&&(u=s(d*u)));do e.data!==h&&(n=v[e.data.index]*b/u,h.vx+=r*n,h.vy+=i*n);while(e=e.next)}}var l=n(-30),d=1,c=1/0,p=.81,m,h,b,v;return e.initialize=function(e){m=e,a()},e.strength=function(t){return arguments.length?(l="function"==typeof t?t:n(+t),a(),e):l},e.distanceMin=function(t){return arguments.length?(d=t*t,e):s(d)},e.distanceMax=function(t){return arguments.length?(c=t*t,e):s(c)},e.theta=function(t){return arguments.length?(p=t*t,e):s(p)},e},e.forceRadial=function(e,t,a){function o(e){for(var o=0,l=d.length;o<l;++o){var n=d[o],u=n.x-t||1e-6,g=n.y-a||1e-6,m=s(u*u+g*g),r=(p[o]-m)*c[o]*e/m;n.vx+=u*r,n.vy+=g*r}}function r(){if(d){var t=d.length,a;for(c=Array(t),p=Array(t),a=0;a<t;++a)p[a]=+e(d[a],a,d),c[a]=isNaN(p[a])?0:+l(d[a],a,d)}}var l=n(.1),d,c,p;return"function"!=typeof e&&(e=n(+e)),null==t&&(t=0),null==a&&(a=0),o.initialize=function(e){d=e,r()},o.strength=function(e){return arguments.length?(l="function"==typeof e?e:n(+e),r(),o):l},o.radius=function(t){return arguments.length?(e="function"==typeof t?t:n(+t),r(),o):e},o.x=function(e){return arguments.length?(t=+e,o):t},o.y=function(e){return arguments.length?(a=+e,o):a},o},e.forceSimulation=_,e.forceX=function(e){function t(e){for(var t=0,a=r.length,o;t<a;++t)o=r[t],o.vx+=(s[t]-o.x)*l[t]*e}function a(){if(r){var t=r.length,a;for(l=Array(t),s=Array(t),a=0;a<t;++a)l[a]=isNaN(s[a]=+e(r[a],a,r))?0:+o(r[a],a,r)}}var o=n(.1),r,l,s;return"function"!=typeof e&&(e=n(null==e?0:+e)),t.initialize=function(e){r=e,a()},t.strength=function(e){return arguments.length?(o="function"==typeof e?e:n(+e),a(),t):o},t.x=function(o){return arguments.length?(e="function"==typeof o?o:n(+o),a(),t):e},t},e.forceY=function(e){function t(e){for(var t=0,a=r.length,o;t<a;++t)o=r[t],o.vy+=(s[t]-o.y)*l[t]*e}function a(){if(r){var t=r.length,a;for(l=Array(t),s=Array(t),a=0;a<t;++a)l[a]=isNaN(s[a]=+e(r[a],a,r))?0:+o(r[a],a,r)}}var o=n(.1),r,l,s;return"function"!=typeof e&&(e=n(null==e?0:+e)),t.initialize=function(e){r=e,a()},t.strength=function(e){return arguments.length?(o="function"==typeof e?e:n(+e),a(),t):o},t.y=function(o){return arguments.length?(e="function"==typeof o?o:n(+o),a(),t):e},t},Object.defineProperty(e,"__esModule",{value:!0})})},{"d3-collection":98,"d3-dispatch":100,"d3-quadtree":105,"d3-timer":107}],102:[function(e,t,a){var o=Math.sqrt,r=Math.round,i=Math.min,l=Math.max;(function(e,o){"object"==typeof a&&"undefined"!=typeof t?o(a):"function"==typeof define&&define.amd?define(["exports"],o):(e=e||self,o(e.d3=e.d3||{}))})(this,function(e){'use strict';function t(e,t){return e.parent===t.parent?1:2}function a(e){return e.reduce(n,0)/e.length}function n(e,t){return e+t.x}function s(e){return 1+e.reduce(d,0)}function d(e,t){return l(e,t.y)}function c(e){for(var t;t=e.children;)e=t[0];return e}function p(e){for(var t;t=e.children;)e=t[t.length-1];return e}function u(){function e(e){var t=0,l;e.eachAfter(function(e){var r=e.children;r?(e.x=a(r),e.y=s(r)):(e.x=l?t+=o(e,l):0,e.y=0,l=e)});var d=c(e),u=p(e),g=d.x-o(d,u)/2,m=u.x+o(u,d)/2;return e.eachAfter(n?function(t){t.x=(t.x-e.x)*r,t.y=(e.y-t.y)*i}:function(t){t.x=(t.x-g)/(m-g)*r,t.y=(1-(e.y?t.y/e.y:1))*i})}var o=t,r=1,i=1,n=!1;return e.separation=function(t){return arguments.length?(o=t,e):o},e.size=function(t){return arguments.length?(n=!1,r=+t[0],i=+t[1],e):n?null:[r,i]},e.nodeSize=function(t){return arguments.length?(n=!0,r=+t[0],i=+t[1],e):n?[r,i]:null},e}function g(e){var t=0,a=e.children,o=a&&a.length;if(!o)t=1;else for(;0<=--o;)t+=a[o].value;e.value=t}function m(e,t){if(e===t)return e;var o=e.ancestors(),r=t.ancestors(),i=null;for(e=o.pop(),t=r.pop();e===t;)i=e,e=o.pop(),t=r.pop();return i}function h(e,t){var a=new _(e),o=+e.value&&(a.value=e.value),r=[a],l,s,d,c,p;for(null==t&&(t=y);l=r.pop();)if(o&&(l.value=+l.data.value),(d=t(l.data))&&(p=d.length))for(l.children=Array(p),c=p-1;0<=c;--c)r.push(s=l.children[c]=new _(d[c])),s.parent=l,s.depth=l.depth+1;return a.eachBefore(x)}function y(e){return e.children}function f(e){e.data=e.data.data}function x(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function _(e){this.data=e,this.depth=this.height=0,this.parent=null}function b(e){for(var a=e.length,o,r;a;)r=0|Math.random()*a--,o=e[a],e[a]=e[r],e[r]=o;return e}function v(t){for(var a=0,o=(t=b(ne.call(t))).length,r=[],n,l;a<o;)n=t[a],l&&T(l,n)?++a:(l=S(r=w(r,n)),a=0);return l}function w(e,t){var a,o;if(A(t,e))return[t];for(a=0;a<e.length;++a)if(k(t,e[a])&&A(L(e[a],t),e))return[e[a],t];for(a=0;a<e.length-1;++a)for(o=a+1;o<e.length;++o)if(k(L(e[a],e[o]),t)&&k(L(e[a],t),e[o])&&k(L(e[o],t),e[a])&&A(E(e[a],e[o],t),e))return[e[a],e[o],t];throw new Error}function k(e,t){var a=e.r-t.r,o=t.x-e.x,r=t.y-e.y;return 0>a||a*a<o*o+r*r}function T(e,t){var a=e.r-t.r+1e-6,o=t.x-e.x,r=t.y-e.y;return 0<a&&a*a>o*o+r*r}function A(e,t){for(var a=0;a<t.length;++a)if(!T(e,t[a]))return!1;return!0}function S(e){switch(e.length){case 1:return C(e[0]);case 2:return L(e[0],e[1]);case 3:return E(e[0],e[1],e[2]);}}function C(e){return{x:e.x,y:e.y,r:e.r}}function L(e,t){var a=e.x,r=e.y,i=e.r,n=t.x,s=t.y,d=t.r,c=n-a,p=s-r,u=d-i,g=o(c*c+p*p);return{x:(a+n+c/g*u)/2,y:(r+s+p/g*u)/2,r:(g+i+d)/2}}function E(e,t,a){var i=e.x,n=e.y,l=e.r,s=t.x,d=t.y,c=t.r,p=a.x,u=a.y,g=a.r,m=i-s,h=i-p,y=n-d,f=n-u,x=c-l,_=g-l,b=i*i+n*n-l*l,v=b-s*s-d*d+c*c,w=b-p*p-u*u+g*g,k=h*y-m*f,T=(y*w-f*v)/(2*k)-i,S=(f*x-y*_)/k,L=(h*v-m*w)/(2*k)-n,E=(m*_-h*x)/k,I=S*S+E*E-1,A=2*(l+T*S+L*E),P=T*T+L*L-l*l,C=-(I?(A+o(A*A-4*I*P))/(2*I):P/A);return{x:i+T+S*C,y:n+L+E*C,r:C}}function I(e,t,a){var r=e.x-t.x,i=e.y-t.y,n=r*r+i*i,s,d,c,p;n?(d=t.r+a.r,d*=d,p=e.r+a.r,p*=p,d>p?(s=(n+p-d)/(2*n),c=o(l(0,p/n-s*s)),a.x=e.x-s*r-c*i,a.y=e.y-s*i+c*r):(s=(n+d-p)/(2*n),c=o(l(0,d/n-s*s)),a.x=t.x+s*r-c*i,a.y=t.y+s*i+c*r)):(a.x=t.x+a.r,a.y=t.y)}function P(e,t){var a=e.r+t.r-1e-6,o=t.x-e.x,r=t.y-e.y;return 0<a&&a*a>o*o+r*r}function z(e){var t=e._,a=e.next._,o=t.r+a.r,r=(t.x*a.r+a.x*t.r)/o,i=(t.y*a.r+a.y*t.r)/o;return r*r+i*i}function D(e){this._=e,this.next=null,this.previous=null}function O(e){if(!(l=e.length))return 0;var t,o,r,l,s,d,p,u,g,m,h;if(t=e[0],t.x=0,t.y=0,!(1<l))return t.r;if(o=e[1],t.x=-o.r,o.x=t.r,o.y=0,!(2<l))return t.r+o.r;I(o,t,r=e[2]),t=new D(t),o=new D(o),r=new D(r),t.next=r.previous=o,o.next=t.previous=r,r.next=o.previous=t;pack:for(p=3;p<l;++p){I(t._,o._,r=e[p]),r=new D(r),u=o.next,g=t.previous,m=o._.r,h=t._.r;do if(m<=h){if(P(u._,r._)){o=u,t.next=o,o.previous=t,--p;continue pack}m+=u._.r,u=u.next}else{if(P(g._,r._)){t=g,t.next=o,o.previous=t,--p;continue pack}h+=g._.r,g=g.previous}while(u!==g.next);for(r.previous=t,r.next=o,t.next=o.previous=o=r,s=z(t);(r=r.next)!==o;)(d=z(r))<s&&(t=r,s=d);o=t.next}for(t=[o._],r=o;(r=r.next)!==o;)t.push(r._);for(r=v(t),p=0;p<l;++p)t=e[p],t.x-=r.x,t.y-=r.y;return r.r}function R(e){return null==e?null:M(e)}function M(e){if("function"!=typeof e)throw new Error;return e}function j(){return 0}function B(e){return function(){return e}}function F(e){return o(e.value)}function N(e){return function(t){t.children||(t.r=l(0,+e(t)||0))}}function V(t,a){return function(o){if(r=o.children){var l=r.length,n=t(o)*a||0,r,s,d;if(n)for(s=0;s<l;++s)r[s].r+=n;if(d=O(r),n)for(s=0;s<l;++s)r[s].r-=n;o.r=d+n}}}function U(e){return function(t){var a=t.parent;t.r*=e,a&&(t.x=a.x+e*t.x,t.y=a.y+e*t.y)}}function H(e){e.x0=r(e.x0),e.y0=r(e.y0),e.x1=r(e.x1),e.y1=r(e.y1)}function q(e,t,a,o,r){for(var l=e.children,s=-1,d=l.length,n=e.value&&(o-t)/e.value,c;++s<d;)c=l[s],c.y0=a,c.y1=r,c.x0=t,c.x1=t+=c.value*n}function G(){function e(e){var l=e.height+1;return e.x0=e.y0=r,e.x1=a,e.y1=o/l,e.eachBefore(t(o,l)),i&&e.eachBefore(H),e}function t(e,t){return function(a){a.children&&q(a,a.x0,e*(a.depth+1)/t,a.x1,e*(a.depth+2)/t);var o=a.x0,i=a.y0,n=a.x1-r,l=a.y1-r;n<o&&(o=n=(o+n)/2),l<i&&(i=l=(i+l)/2),a.x0=o,a.y0=i,a.x1=n,a.y1=l}}var a=1,o=1,r=0,i=!1;return e.round=function(t){return arguments.length?(i=!!t,e):i},e.size=function(t){return arguments.length?(a=+t[0],o=+t[1],e):[a,o]},e.padding=function(t){return arguments.length?(r=+t,e):r},e}function Y(e){return e.id}function W(e){return e.parentId}function X(){function e(e){var o=e.length,r=Array(o),l={},s,c,p,u,g,m,h;for(c=0;c<o;++c)s=e[c],g=r[c]=new _(s),null!=(m=t(s,c,e))&&(m+="")&&(h="$"+(g.id=m),l[h]=h in l?se:g);for(c=0;c<o;++c)if(g=r[c],m=a(e[c],c,e),null==m||!(m+="")){if(p)throw new Error("multiple roots");p=g}else{if(u=l["$"+m],!u)throw new Error("missing: "+m);if(u===se)throw new Error("ambiguous: "+m);u.children?u.children.push(g):u.children=[g],g.parent=u}if(!p)throw new Error("no root");if(p.parent=le,p.eachBefore(function(e){e.depth=e.parent.depth+1,--o}).eachBefore(x),p.parent=null,0<o)throw new Error("cycle");return p}var t=Y,a=W;return e.id=function(a){return arguments.length?(t=M(a),e):t},e.parentId=function(t){return arguments.length?(a=M(t),e):a},e}function Z(e,t){return e.parent===t.parent?1:2}function K(e){var t=e.children;return t?t[0]:e.t}function $(e){var t=e.children;return t?t[t.length-1]:e.t}function J(e,t,a){var o=a/(t.i-e.i);t.c-=o,t.s+=a,e.c+=o,t.z+=a,t.m+=a}function Q(e){for(var t=0,a=0,o=e.children,r=o.length,n;0<=--r;)n=o[r],n.z+=t,n.m+=t,t+=n.s+(a+=n.c)}function ee(e,t,a){return e.a.parent===t.parent?e.a:a}function te(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}function ae(e){for(var t=new te(e,0),a=[t],o,r,l,s,d;o=a.pop();)if(l=o._.children)for(o.children=Array(d=l.length),s=d-1;0<=s;--s)a.push(r=o.children[s]=new te(l[s],s)),r.parent=o;return(t.parent=new te(null,0)).children=[t],t}function oe(){function e(e){var r=ae(e);if(r.eachAfter(a),r.parent.m=-r.z,r.eachBefore(o),d)e.eachBefore(i);else{var c=e,p=e,u=e;e.eachBefore(function(e){e.x<c.x&&(c=e),e.x>p.x&&(p=e),e.depth>u.depth&&(u=e)});var g=c===p?1:n(c,p)/2,s=g-c.x,m=l/(p.x+g+s),h=t/(u.depth||1);e.eachBefore(function(e){e.x=(e.x+s)*m,e.y=e.depth*h})}return e}function a(e){var t=e.children,a=e.parent.children,o=e.i?a[e.i-1]:null;if(t){Q(e);var i=(t[0].z+t[t.length-1].z)/2;o?(e.z=o.z+n(e._,o._),e.m=e.z-i):e.z=i}else o&&(e.z=o.z+n(e._,o._));e.parent.A=r(e,o,e.parent.A||a[0])}function o(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function r(e,t,a){if(t){for(var o=e,r=e,i=t,l=o.parent.children[0],s=o.m,d=r.m,c=i.m,p=l.m,u;i=$(i),o=K(o),i&&o;)l=K(l),r=$(r),r.a=e,u=i.z+c-o.z-s+n(i._,o._),0<u&&(J(ee(i,e,a),e,u),s+=u,d+=u),c+=i.m,s+=o.m,p+=l.m,d+=r.m;i&&!$(r)&&(r.t=i,r.m+=c-d),o&&!K(l)&&(l.t=o,l.m+=s-p,a=e)}return a}function i(e){e.x*=l,e.y=e.depth*t}var n=Z,l=1,t=1,d=null;return e.separation=function(t){return arguments.length?(n=t,e):n},e.size=function(a){return arguments.length?(d=!1,l=+a[0],t=+a[1],e):d?null:[l,t]},e.nodeSize=function(a){return arguments.length?(d=!0,l=+a[0],t=+a[1],e):d?[l,t]:null},e}function re(e,t,a,o,r){for(var l=e.children,s=-1,d=l.length,n=e.value&&(r-a)/e.value,c;++s<d;)c=l[s],c.x0=t,c.x1=o,c.y0=a,c.y1=a+=c.value*n}function ie(e,t,a,o,r,i){for(var s=[],d=t.children,c=0,p=0,u=d.length,n=t.value,g,m,h,y,f,x,_,b,v,w,k;c<u;){h=r-a,y=i-o;do f=d[p++].value;while(!f&&p<u);for(x=_=f,w=l(y/h,h/y)/(n*e),k=f*f*w,v=l(_/k,k/x);p<u;++p){if(f+=m=d[p].value,m<x&&(x=m),m>_&&(_=m),k=f*f*w,b=l(_/k,k/x),b>v){f-=m;break}v=b}s.push(g={value:f,dice:h<y,children:d.slice(c,p)}),g.dice?q(g,a,o,r,n?o+=y*f/n:i):re(g,a,o,n?a+=h*f/n:r,i),n-=f,c=p}return s}_.prototype=h.prototype={constructor:_,count:function(){return this.eachAfter(g)},each:function(e){var t=this,a=[t],o,r,l,s;do for(o=a.reverse(),a=[];t=o.pop();)if(e(t),r=t.children,r)for(l=0,s=r.length;l<s;++l)a.push(r[l]);while(a.length);return this},eachAfter:function(e){for(var t=this,a=[t],o=[],r,l,s;t=a.pop();)if(o.push(t),r=t.children,r)for(l=0,s=r.length;l<s;++l)a.push(r[l]);for(;t=o.pop();)e(t);return this},eachBefore:function(e){for(var t=this,a=[t],o,r;t=a.pop();)if(e(t),o=t.children,o)for(r=o.length-1;0<=r;--r)a.push(o[r]);return this},sum:function(e){return this.eachAfter(function(t){for(var a=+e(t.data)||0,o=t.children,r=o&&o.length;0<=--r;)a+=o[r].value;t.value=a})},sort:function(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})},path:function(e){for(var t=this,a=m(t,e),o=[t];t!==a;)t=t.parent,o.push(t);for(var r=o.length;e!==a;)o.splice(r,0,e),e=e.parent;return o},ancestors:function(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t},descendants:function(){var e=[];return this.each(function(t){e.push(t)}),e},leaves:function(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e},links:function(){var e=this,t=[];return e.each(function(a){a!==e&&t.push({source:a.parent,target:a})}),t},copy:function(){return h(this).eachBefore(f)}};var ne=Array.prototype.slice,le={depth:-1},se={};te.prototype=Object.create(_.prototype);var de=(1+o(5))/2,ce=function e(t){function a(e,a,o,r,i){ie(t,e,a,o,r,i)}return a.ratio=function(t){return e(1<(t=+t)?t:1)},a}(de),pe=function e(t){function a(e,a,o,r,l){if((p=e._squarify)&&p.ratio===t)for(var s=-1,d=p.length,c=e.value,p,u,g,m,h;++s<d;){for(u=p[s],g=u.children,(m=u.value=0,h=g.length);m<h;++m)u.value+=g[m].value;u.dice?q(u,a,o,r,o+=(l-o)*u.value/c):re(u,a,o,a+=(r-a)*u.value/c,l),c-=u.value}else e._squarify=p=ie(t,e,a,o,r,l),p.ratio=t}return a.ratio=function(t){return e(1<(t=+t)?t:1)},a}(de);e.cluster=u,e.hierarchy=h,e.pack=function(){function e(e){return e.x=a/2,e.y=o/2,t?e.eachBefore(N(t)).eachAfter(V(r,.5)).eachBefore(U(1)):e.eachBefore(N(F)).eachAfter(V(j,1)).eachAfter(V(r,e.r/i(a,o))).eachBefore(U(i(a,o)/(2*e.r))),e}var t=null,a=1,o=1,r=j;return e.radius=function(a){return arguments.length?(t=R(a),e):t},e.size=function(t){return arguments.length?(a=+t[0],o=+t[1],e):[a,o]},e.padding=function(t){return arguments.length?(r="function"==typeof t?t:B(+t),e):r},e},e.packEnclose=v,e.packSiblings=function(e){return O(e),e},e.partition=G,e.stratify=X,e.tree=oe,e.treemap=function(){function e(e){return e.x0=e.y0=0,e.x1=r,e.y1=i,e.eachBefore(t),n=[0],o&&e.eachBefore(H),e}function t(e){var t=n[e.depth],o=e.x0+t,r=e.y0+t,i=e.x1-t,g=e.y1-t;i<o&&(o=i=(o+i)/2),g<r&&(r=g=(r+g)/2),e.x0=o,e.y0=r,e.x1=i,e.y1=g,e.children&&(t=n[e.depth+1]=l(e)/2,o+=u(e)-t,r+=s(e)-t,i-=d(e)-t,g-=c(e)-t,i<o&&(o=i=(o+i)/2),g<r&&(r=g=(r+g)/2),a(e,o,r,i,g))}var a=ce,o=!1,r=1,i=1,n=[0],l=j,s=j,d=j,c=j,u=j;return e.round=function(t){return arguments.length?(o=!!t,e):o},e.size=function(t){return arguments.length?(r=+t[0],i=+t[1],e):[r,i]},e.tile=function(t){return arguments.length?(a=M(t),e):a},e.padding=function(t){return arguments.length?e.paddingInner(t).paddingOuter(t):e.paddingInner()},e.paddingInner=function(t){return arguments.length?(l="function"==typeof t?t:B(+t),e):l},e.paddingOuter=function(t){return arguments.length?e.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):e.paddingTop()},e.paddingTop=function(t){return arguments.length?(s="function"==typeof t?t:B(+t),e):s},e.paddingRight=function(t){return arguments.length?(d="function"==typeof t?t:B(+t),e):d},e.paddingBottom=function(t){return arguments.length?(c="function"==typeof t?t:B(+t),e):c},e.paddingLeft=function(t){return arguments.length?(u="function"==typeof t?t:B(+t),e):u},e},e.treemapBinary=function(e,t,a,o,r){function l(e,t,a,o,r,i,d){if(e>=t-1){var c=s[e];return c.x0=o,c.y0=r,c.x1=i,void(c.y1=d)}for(var p=n[e],u=a/2+p,g=e+1,m=t-1;g<m;){var h=g+m>>>1;n[h]<u?g=h+1:m=h}u-n[g-1]<n[g]-u&&e+1<g&&--g;var y=n[g]-p,f=a-y;if(i-o>d-r){var x=(o*f+i*y)/a;l(e,g,y,o,r,x,d),l(g,t,f,x,r,i,d)}else{var _=(r*f+d*y)/a;l(e,g,y,o,r,i,_),l(g,t,f,o,_,i,d)}}var s=e.children,d=s.length,n=Array(d+1),c,p;for(n[0]=p=c=0;c<d;++c)n[c+1]=p+=s[c].value;l(0,d,e.value,t,a,o,r)},e.treemapDice=q,e.treemapResquarify=pe,e.treemapSlice=re,e.treemapSliceDice=function(e,t,a,o,r){(1&e.depth?re:q)(e,t,a,o,r)},e.treemapSquarify=ce,Object.defineProperty(e,"__esModule",{value:!0})})},{}],103:[function(e,t,a){var o=Math.exp,r=Math.atan2,n=Math.log,l=Math.sqrt,s=Math.round,d=Math.min,c=Math.pow,p=Math.atan,u=Math.max,g=Math.floor;(function(o,r){"object"==typeof a&&"undefined"!=typeof t?r(a,e("d3-color")):"function"==typeof define&&define.amd?define(["exports","d3-color"],r):(o=o||self,r(o.d3=o.d3||{},o.d3))})(this,function(e,m){'use strict';function h(e,t,a,o,r){var i=e*e,n=i*e;return((1-3*e+3*i-n)*t+(4-6*i+3*n)*a+(1+3*e+3*i-3*n)*o+n*r)/6}function y(e){var a=e.length-1;return function(o){var r=0>=o?o=0:1<=o?(o=1,a-1):g(o*a),i=e[r],n=e[r+1],l=0<r?e[r-1]:2*i-n,s=r<a-1?e[r+2]:2*n-i;return h((o-r/a)*a,l,i,n,s)}}function f(e){var a=e.length;return function(o){var r=g((0>(o%=1)?++o:o)*a),i=e[(r+a-1)%a],n=e[r%a],l=e[(r+1)%a],s=e[(r+2)%a];return h((o-r/a)*a,i,n,l,s)}}function x(e){return function(){return e}}function _(e,a){return function(o){return e+o*a}}function v(e,o,r){return e=c(e,r),o=c(o,r)-e,r=1/r,function(a){return c(e+a*o,r)}}function w(e,t){var a=t-e;return a?_(e,180<a||-180>a?a-360*s(a/360):a):x(isNaN(e)?t:e)}function k(e){return 1==(e=+e)?T:function(t,a){return a-t?v(t,a,e):x(isNaN(t)?a:t)}}function T(e,t){var a=t-e;return a?_(e,a):x(isNaN(e)?t:e)}function A(e){return function(t){var a=t.length,o=Array(a),n=Array(a),l=Array(a),s,d;for(s=0;s<a;++s)d=m.rgb(t[s]),o[s]=d.r||0,n[s]=d.g||0,l[s]=d.b||0;return o=e(o),n=e(n),l=e(l),d.opacity=1,function(e){return d.r=o(e),d.g=n(e),d.b=l(e),d+""}}}function S(e,a){a||(a=[]);var o=e?d(a.length,e.length):0,r=a.slice(),n;return function(i){for(n=0;n<o;++n)r[n]=e[n]*(1-i)+a[n]*i;return r}}function C(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function L(e,t){var a=t?t.length:0,o=e?d(a,e.length):0,r=Array(o),n=Array(a),l;for(l=0;l<o;++l)r[l]=R(e[l],t[l]);for(;l<a;++l)n[l]=t[l];return function(e){for(l=0;l<o;++l)n[l]=r[l](e);return n}}function E(e,o){var r=new Date;return e=+e,o=+o,function(a){return r.setTime(e*(1-a)+o*a),r}}function I(e,o){return e=+e,o=+o,function(a){return e*(1-a)+o*a}}function P(e,t){var o={},r={},i;for(i in(null===e||"object"!=typeof e)&&(e={}),(null===t||"object"!=typeof t)&&(t={}),t)i in e?o[i]=R(e[i],t[i]):r[i]=t[i];return function(e){for(i in o)r[i]=o[i](e);return r}}function z(e){return function(){return e}}function D(e){return function(a){return e(a)+""}}function O(e,r){var t=Z.lastIndex=K.lastIndex=0,o=-1,n=[],l=[],s,d,c;for(e+="",r+="";(s=Z.exec(e))&&(d=K.exec(r));)(c=d.index)>t&&(c=r.slice(t,c),n[o]?n[o]+=c:n[++o]=c),(s=s[0])===(d=d[0])?n[o]?n[o]+=d:n[++o]=d:(n[++o]=null,l.push({i:o,x:I(s,d)})),t=K.lastIndex;return t<r.length&&(c=r.slice(t),n[o]?n[o]+=c:n[++o]=c),2>n.length?l[0]?D(l[0].x):z(r):(r=l.length,function(e){for(var t=0,a;t<r;++t)n[(a=l[t]).i]=a.x(e);return n.join("")})}function R(e,a){var o=typeof a,t;return null==a||"boolean"===o?x(a):("number"===o?I:"string"===o?(t=m.color(a))?(a=t,Y):O:a instanceof m.color?Y:a instanceof Date?E:C(a)?S:Array.isArray(a)?L:"function"!=typeof a.valueOf&&"function"!=typeof a.toString||isNaN(a)?P:I)(e,a)}function M(t,o,i,n,s,e){var u,g,m;return(u=l(t*t+o*o))&&(t/=u,o/=u),(m=t*i+o*n)&&(i-=t*m,n-=o*m),(g=l(i*i+n*n))&&(i/=g,n/=g,m/=g),t*n<o*i&&(t=-t,o=-o,m=-m,u=-u),{translateX:s,translateY:e,rotate:r(o,t)*$,skewX:p(m)*$,scaleX:u,scaleY:g}}function j(e){return"none"===e?J:(se||(se=document.createElement("DIV"),de=document.documentElement,ce=document.defaultView),se.style.transform=e,e=ce.getComputedStyle(de.appendChild(se),null).getPropertyValue("transform"),de.removeChild(se),e=e.slice(7,-1).split(","),M(+e[0],+e[1],+e[2],+e[3],+e[4],+e[5]))}function B(e){return null==e?J:(pe||(pe=document.createElementNS("http://www.w3.org/2000/svg","g")),pe.setAttribute("transform",e),!(e=pe.transform.baseVal.consolidate()))?J:(e=e.matrix,M(e.a,e.b,e.c,e.d,e.e,e.f))}function F(e,t,a,o){function r(e){return e.length?e.pop()+" ":""}function i(e,o,r,n,l,s){if(e!==r||o!==n){var d=l.push("translate(",null,t,null,a);s.push({i:d-4,x:I(e,r)},{i:d-2,x:I(o,n)})}else(r||n)&&l.push("translate("+r+t+n+a)}function n(e,t,i,n){e===t?t&&i.push(r(i)+"rotate("+t+o):(180<e-t?t+=360:180<t-e&&(e+=360),n.push({i:i.push(r(i)+"rotate(",null,o)-2,x:I(e,t)}))}function l(e,t,a,i){e===t?t&&a.push(r(a)+"skewX("+t+o):i.push({i:a.push(r(a)+"skewX(",null,o)-2,x:I(e,t)})}function d(e,t,a,o,n,l){if(e!==a||t!==o){var s=n.push(r(n)+"scale(",null,",",null,")");l.push({i:s-4,x:I(e,a)},{i:s-2,x:I(t,o)})}else(1!==a||1!==o)&&n.push(r(n)+"scale("+a+","+o+")")}return function(t,o){var r=[],s=[];return t=e(t),o=e(o),i(t.translateX,t.translateY,o.translateX,o.translateY,r,s),n(t.rotate,o.rotate,r,s),l(t.skewX,o.skewX,r,s),d(t.scaleX,t.scaleY,o.scaleX,o.scaleY,r,s),t=o=null,function(e){for(var t=-1,a=s.length,n;++t<a;)r[(n=s[t]).i]=n.x(e);return r.join("")}}}function N(e){return((e=o(e))+1/e)/2}function V(e){return((e=o(e))-1/e)/2}function U(e){return((e=o(2*e))-1)/(e+1)}function H(e){return function(a,o){var r=e((a=m.hsl(a)).h,(o=m.hsl(o)).h),i=T(a.s,o.s),n=T(a.l,o.l),l=T(a.opacity,o.opacity);return function(e){return a.h=r(e),a.s=i(e),a.l=n(e),a.opacity=l(e),a+""}}}function q(e){return function(a,o){var r=e((a=m.hcl(a)).h,(o=m.hcl(o)).h),i=T(a.c,o.c),n=T(a.l,o.l),l=T(a.opacity,o.opacity);return function(e){return a.h=r(e),a.c=i(e),a.l=n(e),a.opacity=l(e),a+""}}}function G(e){return function t(a){function o(o,r){var i=e((o=m.cubehelix(o)).h,(r=m.cubehelix(r)).h),n=T(o.s,r.s),s=T(o.l,r.l),l=T(o.opacity,r.opacity);return function(e){return o.h=i(e),o.s=n(e),o.l=s(c(e,a)),o.opacity=l(e),o+""}}return a=+a,o.gamma=t,o}(1)}var Y=function e(t){function a(e,t){var a=o((e=m.rgb(e)).r,(t=m.rgb(t)).r),r=o(e.g,t.g),i=o(e.b,t.b),n=T(e.opacity,t.opacity);return function(o){return e.r=a(o),e.g=r(o),e.b=i(o),e.opacity=n(o),e+""}}var o=k(t);return a.gamma=e,a}(1),W=A(y),X=A(f),Z=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,K=new RegExp(Z.source,"g"),$=180/Math.PI,J={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},Q=F(j,"px, ","px)","deg)"),ee=F(B,", ",")",")"),te=Math.SQRT2,ae=H(w),oe=H(T),re=q(w),ie=q(T),ne=G(w),le=G(T),se,de,ce,pe;e.interpolate=R,e.interpolateArray=function(e,t){return(C(t)?S:L)(e,t)},e.interpolateBasis=y,e.interpolateBasisClosed=f,e.interpolateCubehelix=ne,e.interpolateCubehelixLong=le,e.interpolateDate=E,e.interpolateDiscrete=function(e){var a=e.length;return function(o){return e[u(0,d(a-1,g(o*a)))]}},e.interpolateHcl=re,e.interpolateHclLong=ie,e.interpolateHsl=ae,e.interpolateHslLong=oe,e.interpolateHue=function(e,t){var a=w(+e,+t);return function(e){var t=a(e);return t-360*g(t/360)}},e.interpolateLab=function(e,t){var o=T((e=m.lab(e)).l,(t=m.lab(t)).l),r=T(e.a,t.a),a=T(e.b,t.b),i=T(e.opacity,t.opacity);return function(n){return e.l=o(n),e.a=r(n),e.b=a(n),e.opacity=i(n),e+""}},e.interpolateNumber=I,e.interpolateNumberArray=S,e.interpolateObject=P,e.interpolateRgb=Y,e.interpolateRgbBasis=W,e.interpolateRgbBasisClosed=X,e.interpolateRound=function(e,o){return e=+e,o=+o,function(a){return s(e*(1-a)+o*a)}},e.interpolateString=O,e.interpolateTransformCss=Q,e.interpolateTransformSvg=ee,e.interpolateZoom=function(e,t){var a=e[0],r=e[1],d=e[2],s=t[0],c=t[1],p=t[2],g=s-a,m=c-r,u=g*g+m*m,h,y;if(u<1e-12)y=n(p/d)/te,h=function(e){return[a+e*g,r+e*m,d*o(te*e*y)]};else{var f=l(u),x=(p*p-d*d+4*u)/(2*(2*d)*f),_=(p*p-d*d-4*u)/(2*(2*p)*f),b=n(l(x*x+1)-x),v=n(l(_*_+1)-_);y=(v-b)/te,h=function(e){var t=e*y,o=N(b),i=d/(2*f)*(o*U(te*t+b)-V(b));return[a+i*g,r+i*m,d*o/N(te*t+b)]}}return h.duration=1e3*y,h},e.piecewise=function(e,t){for(var a=0,o=t.length-1,r=t[0],n=Array(0>o?0:o);a<o;)n[a]=e(r,r=t[++a]);return function(e){var a=u(0,d(o-1,g(e*=o)));return n[a](e-a)}},e.quantize=function(e,t){for(var a=Array(t),o=0;o<t;++o)a[o]=e(o/(t-1));return a},Object.defineProperty(e,"__esModule",{value:!0})})},{"d3-color":99}],104:[function(e,t,a){var o=Math.acos,i=Math.cos,n=Math.sqrt,l=Math.sin,s=Math.tan,d=Math.abs;(function(e,o){"object"==typeof a&&"undefined"!=typeof t?o(a):"function"==typeof define&&define.amd?define(["exports"],o):(e=e||self,o(e.d3=e.d3||{}))})(this,function(e){'use strict';function t(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function a(){return new t}var c=Math.PI,p=2*c,u=1e-6;t.prototype=a.prototype={constructor:t,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,a,o){this._+="Q"+ +e+","+ +t+","+(this._x1=+a)+","+(this._y1=+o)},bezierCurveTo:function(e,t,a,o,r,i){this._+="C"+ +e+","+ +t+","+ +a+","+ +o+","+(this._x1=+r)+","+(this._y1=+i)},arcTo:function(e,t,a,i,p){e=+e,t=+t,a=+a,i=+i,p=+p;var g=this._x1,m=this._y1,h=a-e,y=i-t,f=g-e,x=m-t,_=f*f+x*x;if(0>p)throw new Error("negative radius: "+p);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(!(_>u));else if(!(d(x*h-y*f)>u)||!p)this._+="L"+(this._x1=e)+","+(this._y1=t);else{var b=a-g,v=i-m,w=h*h+y*y,k=n(w),T=n(_),A=p*s((c-o((w+_-(b*b+v*v))/(2*k*T)))/2),l=A/T,S=A/k;d(l-1)>u&&(this._+="L"+(e+l*f)+","+(t+l*x)),this._+="A"+p+","+p+",0,0,"+ +(x*b>f*v)+","+(this._x1=e+S*h)+","+(this._y1=t+S*y)}},arc:function(e,t,a,o,n,s){e=+e,t=+t,a=+a,s=!!s;var g=a*i(o),m=a*l(o),h=e+g,f=t+m,_=1^s,b=s?o-n:n-o;if(0>a)throw new Error("negative radius: "+a);null===this._x1?this._+="M"+h+","+f:(d(this._x1-h)>u||d(this._y1-f)>u)&&(this._+="L"+h+","+f);a&&(0>b&&(b=b%p+p),b>p-u?this._+="A"+a+","+a+",0,1,"+_+","+(e-g)+","+(t-m)+"A"+a+","+a+",0,1,"+_+","+(this._x1=h)+","+(this._y1=f):b>u&&(this._+="A"+a+","+a+",0,"+ +(b>=c)+","+_+","+(this._x1=e+a*i(n))+","+(this._y1=t+a*l(n))))},rect:function(e,t,a,o){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +a+"v"+ +o+"h"+-a+"Z"},toString:function(){return this._}},e.path=a,Object.defineProperty(e,"__esModule",{value:!0})})},{}],105:[function(e,t,a){var o=Math.sqrt,r=Math.floor;(function(e,o){"object"==typeof a&&"undefined"!=typeof t?o(a):"function"==typeof define&&define.amd?define(["exports"],o):(e=e||self,o(e.d3=e.d3||{}))})(this,function(e){'use strict';function t(e,t,a,o){if(isNaN(t)||isNaN(a))return e;var r=e._root,n={data:o},l=e._x0,s=e._y0,d=e._x1,c=e._y1,p,u,g,m,h,y,f,x,_;if(!r)return e._root=n,e;for(;r.length;)if((y=t>=(u=(l+d)/2))?l=u:d=u,(f=a>=(g=(s+c)/2))?s=g:c=g,(p=r,!(r=r[x=f<<1|y])))return p[x]=n,e;if(m=+e._x.call(null,r.data),h=+e._y.call(null,r.data),t===m&&a===h)return n.next=r,p?p[x]=n:e._root=n,e;do p=p?p[x]=[,,,,]:e._root=[,,,,],(y=t>=(u=(l+d)/2))?l=u:d=u,(f=a>=(g=(s+c)/2))?s=g:c=g;while((x=f<<1|y)==(_=(h>=g)<<1|m>=u));return p[_]=r,p[x]=n,e}function a(e,t,a,o,r){this.node=e,this.x0=t,this.y0=a,this.x1=o,this.y1=r}function i(e){return e[0]}function n(e){return e[1]}function l(e,t,a){var o=new s(null==t?i:t,null==a?n:a,NaN,NaN,NaN,NaN);return null==e?o:o.addAll(e)}function s(e,t,a,o,r,i){this._x=e,this._y=t,this._x0=a,this._y0=o,this._x1=r,this._y1=i,this._root=void 0}function d(e){for(var t={data:e.data},a=t;e=e.next;)a=a.next={data:e.data};return t}var c=l.prototype=s.prototype;c.copy=function(){var e=new s(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,a,o;if(!t)return e;if(!t.length)return e._root=d(t),e;for(a=[{source:t,target:e._root=[,,,,]}];t=a.pop();)for(var r=0;4>r;++r)(o=t.source[r])&&(o.length?a.push({source:o,target:t.target[r]=[,,,,]}):t.target[r]=d(o));return e},c.add=function(e){var a=+this._x.call(null,e),o=+this._y.call(null,e);return t(this.cover(a,o),a,o,e)},c.addAll=function(e){var a=e.length,o=Array(a),r=Array(a),n=1/0,l=1/0,s=-Infinity,c=-Infinity,p,u,g,m;for(u=0;u<a;++u)isNaN(g=+this._x.call(null,p=e[u]))||isNaN(m=+this._y.call(null,p))||(o[u]=g,r[u]=m,g<n&&(n=g),g>s&&(s=g),m<l&&(l=m),m>c&&(c=m));if(n>s||l>c)return this;for(this.cover(n,l).cover(s,c),u=0;u<a;++u)t(this,o[u],r[u],e[u]);return this},c.cover=function(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var a=this._x0,o=this._y0,n=this._x1,l=this._y1;if(isNaN(a))n=(a=r(e))+1,l=(o=r(t))+1;else{for(var s=n-a,d=this._root,c,p;a>e||e>=n||o>t||t>=l;)p=(t<o)<<1|e<a,c=[,,,,],c[p]=d,d=c,s*=2,0===p?(n=a+s,l=o+s):1===p?(a=n-s,l=o+s):2===p?(n=a+s,o=l-s):3===p?(a=n-s,o=l-s):void 0;this._root&&this._root.length&&(this._root=d)}return this._x0=a,this._y0=o,this._x1=n,this._y1=l,this},c.data=function(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e},c.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},c.find=function(e,t,r){var n=this._x0,l=this._y0,s=this._x1,c=this._y1,p=[],u=this._root,g,m,h,y,f,x,_;for(u&&p.push(new a(u,n,l,s,c)),null==r?r=1/0:(n=e-r,l=t-r,s=e+r,c=t+r,r*=r);x=p.pop();)if(!(!(u=x.node)||(m=x.x0)>s||(h=x.y0)>c||(y=x.x1)<n||(f=x.y1)<l))if(u.length){var b=(m+y)/2,v=(h+f)/2;p.push(new a(u[3],b,v,y,f),new a(u[2],m,v,b,f),new a(u[1],b,h,y,v),new a(u[0],m,h,b,v)),(_=(t>=v)<<1|e>=b)&&(x=p[p.length-1],p[p.length-1]=p[p.length-1-_],p[p.length-1-_]=x)}else{var w=e-+this._x.call(null,u.data),k=t-+this._y.call(null,u.data),T=w*w+k*k;if(T<r){var A=o(r=T);n=e-A,l=t-A,s=e+A,c=t+A,g=u.data}}return g},c.remove=function(e){if(isNaN(p=+this._x.call(null,e))||isNaN(u=+this._y.call(null,e)))return this;var t=this._root,a=this._x0,o=this._y0,r=this._x1,n=this._y1,l,s,d,c,p,u,g,m,h,f,_,b;if(!t)return this;if(t.length)for(;;){if((h=p>=(g=(a+r)/2))?a=g:r=g,(f=u>=(m=(o+n)/2))?o=m:n=m,(l=t,!(t=t[_=f<<1|h])))return this;if(!t.length)break;(l[3&_+1]||l[3&_+2]||l[3&_+3])&&(s=l,b=_)}for(;t.data!==e;)if(d=t,!(t=t.next))return this;return((c=t.next)&&delete t.next,d)?(c?d.next=c:delete d.next,this):l?(c?l[_]=c:delete l[_],(t=l[0]||l[1]||l[2]||l[3])&&t===(l[3]||l[2]||l[1]||l[0])&&!t.length&&(s?s[b]=t:this._root=t),this):(this._root=c,this)},c.removeAll=function(e){for(var t=0,a=e.length;t<a;++t)this.remove(e[t]);return this},c.root=function(){return this._root},c.size=function(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e},c.visit=function(e){var t=[],o=this._root,r,i,n,l,s,d;for(o&&t.push(new a(o,this._x0,this._y0,this._x1,this._y1));r=t.pop();)if(!e(o=r.node,n=r.x0,l=r.y0,s=r.x1,d=r.y1)&&o.length){var c=(n+s)/2,p=(l+d)/2;(i=o[3])&&t.push(new a(i,c,p,s,d)),(i=o[2])&&t.push(new a(i,n,p,c,d)),(i=o[1])&&t.push(new a(i,c,l,s,p)),(i=o[0])&&t.push(new a(i,n,l,c,p))}return this},c.visitAfter=function(e){var t=[],o=[],r;for(this._root&&t.push(new a(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var n=r.x0,l=r.y0,s=r.x1,d=r.y1,c=(n+s)/2,p=(l+d)/2,u;(u=i[0])&&t.push(new a(u,n,l,c,p)),(u=i[1])&&t.push(new a(u,c,l,s,p)),(u=i[2])&&t.push(new a(u,n,p,c,d)),(u=i[3])&&t.push(new a(u,c,p,s,d))}o.push(r)}for(;r=o.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this},c.x=function(e){return arguments.length?(this._x=e,this):this._x},c.y=function(e){return arguments.length?(this._y=e,this):this._y},e.quadtree=l,Object.defineProperty(e,"__esModule",{value:!0})})},{}],106:[function(e,t,a){var o=Math.cos,n=Math.sqrt,l=Math.PI,d=Math.sin,u=Math.min,g=Math.pow,m=Math.abs,h=Math.max;(function(o,r){"object"==typeof a&&"undefined"!=typeof t?r(a,e("d3-path")):"function"==typeof define&&define.amd?define(["exports","d3-path"],r):(o=o||self,r(o.d3=o.d3||{},o.d3))})(this,function(e,a){'use strict';function r(e){return function(){return e}}function i(e){return 1<e?0:-1>e?De:Math.acos(e)}function p(e){return 1<=e?Oe:-1>=e?-Oe:Math.asin(e)}function f(e){return e.innerRadius}function _(e){return e.outerRadius}function b(e){return e.startAngle}function v(e){return e.endAngle}function w(e){return e&&e.padAngle}function T(e,a,o,r,i,n,l,s){var d=o-e,c=r-a,p=l-i,u=s-n,g=u*d-p*c;if(!(g*g<ze))return g=(p*(a-n)-u*(e-i))/g,[e+g*d,a+g*c]}function A(e,t,a,o,i,n,l){var s=e-a,c=t-o,p=(l?n:-n)/Pe(s*s+c*c),u=p*c,g=-p*s,m=e+u,h=t+g,y=a+u,f=o+g,x=(m+y)/2,_=(h+f)/2,b=y-m,v=f-h,w=b*b+v*v,k=i-n,r=m*f-y*h,T=(0>v?-1:1)*Pe(Le(0,k*k*w-r*r)),d=(r*v-b*T)/w,A=(-r*b-v*T)/w,S=(r*v+b*T)/w,C=(-r*b+v*T)/w,L=d-x,E=A-_,I=S-x,P=C-_;return L*L+E*E>I*I+P*P&&(d=S,A=C),{cx:d,cy:A,x01:-u,y01:-g,x11:d*(i/k-1),y11:A*(i/k-1)}}function S(){function e(){var e=+t.apply(this,arguments),g=+o.apply(this,arguments),m=s.apply(this,arguments)-Oe,h=d.apply(this,arguments)-Oe,y=Ae(h-m),f=h>m,x,_;if(u||(u=x=a.path()),g<e&&(_=g,g=e,e=_),!(g>ze))u.moveTo(0,0);else if(y>Re-ze)u.moveTo(g*Ce(m),g*Ie(m)),u.arc(0,0,g,m,h,!f),e>ze&&(u.moveTo(e*Ce(h),e*Ie(h)),u.arc(0,0,e,h,m,f));else{var b=m,v=h,w=m,k=h,S=y,C=y,L=c.apply(this,arguments)/2,E=L>ze&&(l?+l.apply(this,arguments):Pe(e*e+g*g)),I=Ee(Ae(g-e)/2,+n.apply(this,arguments)),P=I,z=I,D,O;if(E>ze){var R=p(E/e*Ie(L)),M=p(E/g*Ie(L));(S-=2*R)>ze?(R*=f?1:-1,w+=R,k-=R):(S=0,w=k=(m+h)/2),(C-=2*M)>ze?(M*=f?1:-1,b+=M,v-=M):(C=0,b=v=(m+h)/2)}var j=g*Ce(b),B=g*Ie(b),F=e*Ce(k),N=e*Ie(k);if(I>ze){var V=g*Ce(v),U=g*Ie(v),H=e*Ce(w),q=e*Ie(w),G;if(y<De&&(G=T(j,B,H,q,V,U,F,N))){var Y=j-G[0],W=B-G[1],X=V-G[0],Z=U-G[1],K=1/Ie(i((Y*X+W*Z)/(Pe(Y*Y+W*W)*Pe(X*X+Z*Z)))/2),$=Pe(G[0]*G[0]+G[1]*G[1]);P=Ee(I,(e-$)/(K-1)),z=Ee(I,(g-$)/(K+1))}}C>ze?z>ze?(D=A(H,q,j,B,g,z,f),O=A(V,U,F,N,g,z,f),u.moveTo(D.cx+D.x01,D.cy+D.y01),z<I?u.arc(D.cx,D.cy,z,Se(D.y01,D.x01),Se(O.y01,O.x01),!f):(u.arc(D.cx,D.cy,z,Se(D.y01,D.x01),Se(D.y11,D.x11),!f),u.arc(0,0,g,Se(D.cy+D.y11,D.cx+D.x11),Se(O.cy+O.y11,O.cx+O.x11),!f),u.arc(O.cx,O.cy,z,Se(O.y11,O.x11),Se(O.y01,O.x01),!f))):(u.moveTo(j,B),u.arc(0,0,g,b,v,!f)):u.moveTo(j,B),e>ze&&S>ze?P>ze?(D=A(F,N,V,U,e,-P,f),O=A(j,B,H,q,e,-P,f),u.lineTo(D.cx+D.x01,D.cy+D.y01),P<I?u.arc(D.cx,D.cy,P,Se(D.y01,D.x01),Se(O.y01,O.x01),!f):(u.arc(D.cx,D.cy,P,Se(D.y01,D.x01),Se(D.y11,D.x11),!f),u.arc(0,0,e,Se(D.cy+D.y11,D.cx+D.x11),Se(O.cy+O.y11,O.cx+O.x11),f),u.arc(O.cx,O.cy,P,Se(O.y11,O.x11),Se(O.y01,O.x01),!f))):u.arc(0,0,e,k,w,f):u.lineTo(F,N)}return(u.closePath(),x)?(u=null,x+""||null):void 0}var t=f,o=_,n=r(0),l=null,s=b,d=v,c=w,u=null;return e.centroid=function(){var e=(+t.apply(this,arguments)+ +o.apply(this,arguments))/2,r=(+s.apply(this,arguments)+ +d.apply(this,arguments))/2-De/2;return[Ce(r)*e,Ie(r)*e]},e.innerRadius=function(a){return arguments.length?(t="function"==typeof a?a:r(+a),e):t},e.outerRadius=function(t){return arguments.length?(o="function"==typeof t?t:r(+t),e):o},e.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:r(+t),e):n},e.padRadius=function(t){return arguments.length?(l=null==t?null:"function"==typeof t?t:r(+t),e):l},e.startAngle=function(t){return arguments.length?(s="function"==typeof t?t:r(+t),e):s},e.endAngle=function(t){return arguments.length?(d="function"==typeof t?t:r(+t),e):d},e.padAngle=function(t){return arguments.length?(c="function"==typeof t?t:r(+t),e):c},e.context=function(t){return arguments.length?(u=null==t?null:t,e):u},e}function C(e){this._context=e}function L(e){return new C(e)}function E(e){return e[0]}function t(e){return e[1]}function y(){function e(e){var t=e.length,r=!1,n,g,m;for(null==c&&(u=p(m=a.path())),n=0;n<=t;++n)!(n<t&&s(g=e[n],n,e))===r&&((r=!r)?u.lineStart():u.lineEnd()),r&&u.point(+o(g,n,e),+l(g,n,e));if(m)return u=null,m+""||null}var o=E,l=t,s=r(!0),c=null,p=L,u=null;return e.x=function(t){return arguments.length?(o="function"==typeof t?t:r(+t),e):o},e.y=function(t){return arguments.length?(l="function"==typeof t?t:r(+t),e):l},e.defined=function(t){return arguments.length?(s="function"==typeof t?t:r(!!t),e):s},e.curve=function(t){return arguments.length?(p=t,null!=c&&(u=p(c)),e):p},e.context=function(t){return arguments.length?(null==t?c=u=null:u=p(c=t),e):c},e}function x(){function e(e){var t=e.length,o=!1,r=Array(t),n=Array(t),y,f,x,_,b;for(null==g&&(h=m(b=a.path())),y=0;y<=t;++y){if(!(y<t&&u(_=e[y],y,e))===o)if(o=!o)f=y,h.areaStart(),h.lineStart();else{for(h.lineEnd(),h.lineStart(),x=y-1;x>=f;--x)h.point(r[x],n[x]);h.lineEnd(),h.areaEnd()}o&&(r[y]=+l(_,y,e),n[y]=+c(_,y,e),h.point(s?+s(_,y,e):r[y],p?+p(_,y,e):n[y]))}if(b)return h=null,b+""||null}function o(){return y().defined(u).curve(m).context(g)}var l=E,s=null,c=r(0),p=t,u=r(!0),g=null,m=L,h=null;return e.x=function(t){return arguments.length?(l="function"==typeof t?t:r(+t),s=null,e):l},e.x0=function(t){return arguments.length?(l="function"==typeof t?t:r(+t),e):l},e.x1=function(t){return arguments.length?(s=null==t?null:"function"==typeof t?t:r(+t),e):s},e.y=function(t){return arguments.length?(c="function"==typeof t?t:r(+t),p=null,e):c},e.y0=function(t){return arguments.length?(c="function"==typeof t?t:r(+t),e):c},e.y1=function(t){return arguments.length?(p=null==t?null:"function"==typeof t?t:r(+t),e):p},e.lineX0=e.lineY0=function(){return o().x(l).y(c)},e.lineY1=function(){return o().x(l).y(p)},e.lineX1=function(){return o().x(s).y(c)},e.defined=function(t){return arguments.length?(u="function"==typeof t?t:r(!!t),e):u},e.curve=function(t){return arguments.length?(m=t,null!=g&&(h=m(g)),e):m},e.context=function(t){return arguments.length?(null==t?g=h=null:h=m(g=t),e):g},e}function I(e,t){return t<e?-1:t>e?1:t>=e?0:NaN}function P(e){return e}function z(){function e(e){var r=e.length,n=0,c=Array(r),g=Array(r),y=+l.apply(this,arguments),f=u(Re,h(-Re,s.apply(this,arguments)-y)),x=u(m(f)/r,d.apply(this,arguments)),p=x*(0>f?-1:1),_,b,w,T,A;for(_=0;_<r;++_)0<(A=g[c[_]=_]=+t(e[_],_,e))&&(n+=A);for(null==a?null!=o&&c.sort(function(t,a){return o(e[t],e[a])}):c.sort(function(e,t){return a(g[e],g[t])}),_=0,w=n?(f-r*p)/n:0;_<r;++_,y=T)b=c[_],A=g[b],T=y+(0<A?A*w:0)+p,g[b]={data:e[b],index:_,value:A,startAngle:y,endAngle:T,padAngle:x};return g}var t=P,a=I,o=null,l=r(0),s=r(Re),d=r(0);return e.value=function(a){return arguments.length?(t="function"==typeof a?a:r(+a),e):t},e.sortValues=function(t){return arguments.length?(a=t,o=null,e):a},e.sort=function(t){return arguments.length?(o=t,a=null,e):o},e.startAngle=function(t){return arguments.length?(l="function"==typeof t?t:r(+t),e):l},e.endAngle=function(t){return arguments.length?(s="function"==typeof t?t:r(+t),e):s},e.padAngle=function(t){return arguments.length?(d="function"==typeof t?t:r(+t),e):d},e}function D(e){this._curve=e}function O(e){function t(t){return new D(e(t))}return t._curve=e,t}function R(e){var t=e.curve;return e.angle=e.x,delete e.x,e.radius=e.y,delete e.y,e.curve=function(e){return arguments.length?t(O(e)):t()._curve},e}function M(){return R(y().curve(Me))}function j(){var e=x().curve(Me),t=e.curve,a=e.lineX0,o=e.lineX1,r=e.lineY0,i=e.lineY1;return e.angle=e.x,delete e.x,e.startAngle=e.x0,delete e.x0,e.endAngle=e.x1,delete e.x1,e.radius=e.y,delete e.y,e.innerRadius=e.y0,delete e.y0,e.outerRadius=e.y1,delete e.y1,e.lineStartAngle=function(){return R(a())},delete e.lineX0,e.lineEndAngle=function(){return R(o())},delete e.lineX1,e.lineInnerRadius=function(){return R(r())},delete e.lineY0,e.lineOuterRadius=function(){return R(i())},delete e.lineY1,e.curve=function(e){return arguments.length?t(O(e)):t()._curve},e}function B(e,t){return[(t=+t)*o(e-=l/2),t*d(e)]}function F(e){return e.source}function N(e){return e.target}function V(e){function o(){var o=je.call(arguments),r=i.apply(this,o),s=n.apply(this,o),t;if(c||(c=t=a.path()),e(c,+l.apply(this,(o[0]=r,o)),+d.apply(this,o),+l.apply(this,(o[0]=s,o)),+d.apply(this,o)),t)return c=null,t+""||null}var i=F,n=N,l=E,d=t,c=null;return o.source=function(e){return arguments.length?(i=e,o):i},o.target=function(e){return arguments.length?(n=e,o):n},o.x=function(e){return arguments.length?(l="function"==typeof e?e:r(+e),o):l},o.y=function(e){return arguments.length?(d="function"==typeof e?e:r(+e),o):d},o.context=function(e){return arguments.length?(c=null==e?null:e,o):c},o}function U(e,t,a,o,r){e.moveTo(t,a),e.bezierCurveTo(t=(t+o)/2,a,t,r,o,r)}function H(e,t,a,o,r){e.moveTo(t,a),e.bezierCurveTo(t,a=(a+r)/2,o,a,o,r)}function q(e,t,a,o,r){var i=B(t,a),n=B(t,a=(a+r)/2),l=B(o,a),s=B(o,r);e.moveTo(i[0],i[1]),e.bezierCurveTo(n[0],n[1],l[0],l[1],s[0],s[1])}function G(){function e(){var e;if(i||(i=e=a.path()),t.apply(this,arguments).draw(i,+o.apply(this,arguments)),e)return i=null,e+""||null}var t=r(Be),o=r(64),i=null;return e.type=function(a){return arguments.length?(t="function"==typeof a?a:r(a),e):t},e.size=function(t){return arguments.length?(o="function"==typeof t?t:r(+t),e):o},e.context=function(t){return arguments.length?(i=null==t?null:t,e):i},e}function Y(){}function W(e,t,a){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+a)/6)}function X(e){this._context=e}function Z(e){this._context=e}function K(e){this._context=e}function $(e,t){this._basis=new X(e),this._beta=t}function J(e,t,a){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-a),e._x2,e._y2)}function Q(e,t){this._context=e,this._k=(1-t)/6}function ee(e,t){this._context=e,this._k=(1-t)/6}function te(e,t){this._context=e,this._k=(1-t)/6}function ae(e,t,o){var r=e._x1,i=e._y1,l=e._x2,s=e._y2;if(e._l01_a>ze){var d=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,a=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*d-e._x0*e._l12_2a+e._x2*e._l01_2a)/a,i=(i*d-e._y0*e._l12_2a+e._y2*e._l01_2a)/a}if(e._l23_a>ze){var n=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);l=(l*n+e._x1*e._l23_2a-t*e._l12_2a)/c,s=(s*n+e._y1*e._l23_2a-o*e._l12_2a)/c}e._context.bezierCurveTo(r,i,l,s,e._x2,e._y2)}function oe(e,t){this._context=e,this._alpha=t}function re(e,t){this._context=e,this._alpha=t}function ie(e,t){this._context=e,this._alpha=t}function ne(e){this._context=e}function le(e){return 0>e?-1:1}function se(e,t,a){var o=e._x1-e._x0,r=t-e._x1,i=(e._y1-e._y0)/(o||0>r&&-0),n=(a-e._y1)/(r||0>o&&-0);return(le(i)+le(n))*u(m(i),m(n),.5*m((i*r+n*o)/(o+r)))||0}function de(e,a){var t=e._x1-e._x0;return t?(3*(e._y1-e._y0)/t-a)/2:a}function ce(e,t,a){var o=e._x0,r=e._y0,i=e._x1,n=e._y1,l=(i-o)/3;e._context.bezierCurveTo(o+l,r+l*t,i-l,n-l*a,i,n)}function pe(e){this._context=e}function ue(e){this._context=new ge(e)}function ge(e){this._context=e}function me(e){this._context=e}function he(e){var t=e.length-1,o=Array(t),a=Array(t),n=Array(t),r,l;for(o[0]=0,a[0]=2,n[0]=e[0]+2*e[1],r=1;r<t-1;++r)o[r]=1,a[r]=4,n[r]=4*e[r]+2*e[r+1];for(o[t-1]=2,a[t-1]=7,n[t-1]=8*e[t-1]+e[t],r=1;r<t;++r)l=o[r]/a[r-1],a[r]-=l,n[r]-=l*n[r-1];for(o[t-1]=n[t-1]/a[t-1],r=t-2;0<=r;--r)o[r]=(n[r]-o[r+1])/a[r];for(a[t-1]=(e[t]+o[t-1])/2,r=0;r<t-1;++r)a[r]=2*e[r+1]-o[r+1];return[o,a]}function ye(e,a){this._context=e,this._t=a}function fe(e,t){if(1<(d=e.length))for(var a=1,o=e[t[0]],r=o.length,l,s,d;a<d;++a)for(s=o,o=e[t[a]],l=0;l<r;++l)o[l][1]+=o[l][0]=isNaN(s[l][1])?s[l][0]:s[l][1]}function xe(e){for(var t=e.length,a=Array(t);0<=--t;)a[t]=t;return a}function _e(e,t){return e[t]}function be(){function e(e){var r=t.apply(this,arguments),l=e.length,s=r.length,d=Array(s),c,p;for(c=0;c<s;++c){for(var u=r[c],g=d[c]=Array(l),m=0,h;m<l;++m)g[m]=h=[0,+n(e[m],u,m,e)],h.data=e[m];g.key=u}for(c=0,p=a(d);c<s;++c)d[p[c]].index=c;return o(d,p),d}var t=r([]),a=xe,o=fe,n=_e;return e.keys=function(a){return arguments.length?(t="function"==typeof a?a:r(je.call(a)),e):t},e.value=function(t){return arguments.length?(n="function"==typeof t?t:r(+t),e):n},e.order=function(t){return arguments.length?(a=null==t?xe:"function"==typeof t?t:r(je.call(t)),e):a},e.offset=function(t){return arguments.length?(o=null==t?fe:t,e):o},e}function ve(e){var t=e.map(we);return xe(e).sort(function(e,a){return t[e]-t[a]})}function we(e){for(var t=-1,a=0,o=e.length,r=-Infinity,n;++t<o;)(n=+e[t][1])>r&&(r=n,a=t);return a}function ke(e){var t=e.map(Te);return xe(e).sort(function(e,a){return t[e]-t[a]})}function Te(e){for(var t=0,a=-1,o=e.length,r;++a<o;)(r=+e[a][1])&&(t+=r);return t}var Ae=m,Se=Math.atan2,Ce=o,Le=h,Ee=u,Ie=d,Pe=n,ze=1e-12,De=l,Oe=De/2,Re=2*De;C.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);}}};var Me=O(L);D.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(e,t){this._curve.point(t*d(e),t*-o(e))}};var je=Array.prototype.slice,Be={draw:function(e,t){var a=n(t/De);e.moveTo(a,0),e.arc(0,0,a,0,Re)}},Fe={draw:function(e,t){var a=n(t/5)/2;e.moveTo(-3*a,-a),e.lineTo(-a,-a),e.lineTo(-a,-3*a),e.lineTo(a,-3*a),e.lineTo(a,-a),e.lineTo(3*a,-a),e.lineTo(3*a,a),e.lineTo(a,a),e.lineTo(a,3*a),e.lineTo(-a,3*a),e.lineTo(-a,a),e.lineTo(-3*a,a),e.closePath()}},Ne=n(1/3),Ve={draw:function(e,t){var a=n(t/(2*Ne)),o=a*Ne;e.moveTo(0,-a),e.lineTo(o,0),e.lineTo(0,a),e.lineTo(-o,0),e.closePath()}},Ue=d(De/10)/d(7*De/10),He=d(Re/10)*Ue,qe=-o(Re/10)*Ue,Ge={draw:function(e,t){var l=n(t*.8908130915292852),r=He*l,p=qe*l;e.moveTo(0,-l),e.lineTo(r,p);for(var u=1;5>u;++u){var g=Re*u/5,a=o(g),c=d(g);e.lineTo(c*l,-a*l),e.lineTo(a*r-c*p,c*r+a*p)}e.closePath()}},Ye={draw:function(e,t){var a=n(t),o=-a/2;e.rect(o,o,a,a)}},We=n(3),Xe={draw:function(e,t){var a=-n(t/(3*We));e.moveTo(0,2*a),e.lineTo(-We*a,-a),e.lineTo(We*a,-a),e.closePath()}},Ze=-.5,c=n(3)/2,s=1/n(12),k={draw:function(e,t){var a=n(t/(3*(s/2+1))),o=a/2,r=a*s,i=o,l=a*s+a,d=-i,p=l;e.moveTo(o,r),e.lineTo(i,l),e.lineTo(d,p),e.lineTo(Ze*o-c*r,c*o+Ze*r),e.lineTo(Ze*i-c*l,c*i+Ze*l),e.lineTo(Ze*d-c*p,c*d+Ze*p),e.lineTo(Ze*o+c*r,Ze*r-c*o),e.lineTo(Ze*i+c*l,Ze*l-c*i),e.lineTo(Ze*d+c*p,Ze*p-c*d),e.closePath()}};X.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:W(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:W(this,e,t);}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},Z.prototype={areaStart:Y,areaEnd:Y,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:W(this,e,t);}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},K.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var a=(this._x0+4*this._x1+e)/6,o=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(a,o):this._context.moveTo(a,o);break;case 3:this._point=4;default:W(this,e,t);}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},$.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,a=this._y,o=e.length-1;if(0<o)for(var r=e[0],n=a[0],l=e[o]-r,s=a[o]-n,d=-1,c;++d<=o;)c=d/o,this._basis.point(this._beta*e[d]+(1-this._beta)*(r+c*l),this._beta*a[d]+(1-this._beta)*(n+c*s));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var Ke=function e(t){function a(e){return 1===t?new X(e):new $(e,t)}return a.beta=function(t){return e(+t)},a}(.85);Q.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:J(this,this._x1,this._y1);}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:J(this,e,t);}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var $e=function e(t){function a(e){return new Q(e,t)}return a.tension=function(t){return e(+t)},a}(0);ee.prototype={areaStart:Y,areaEnd:Y,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:J(this,e,t);}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Je=function e(t){function a(e){return new ee(e,t)}return a.tension=function(t){return e(+t)},a}(0);te.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:J(this,e,t);}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Qe=function e(t){function a(e){return new te(e,t)}return a.tension=function(t){return e(+t)},a}(0);oe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var a=this._x2-e,o=this._y2-t;this._l23_a=n(this._l23_2a=g(a*a+o*o,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:ae(this,e,t);}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var et=function e(t){function a(e){return t?new oe(e,t):new Q(e,0)}return a.alpha=function(t){return e(+t)},a}(.5);re.prototype={areaStart:Y,areaEnd:Y,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var a=this._x2-e,o=this._y2-t;this._l23_a=n(this._l23_2a=g(a*a+o*o,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:ae(this,e,t);}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var tt=function e(t){function a(e){return t?new re(e,t):new ee(e,0)}return a.alpha=function(t){return e(+t)},a}(.5);ie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var a=this._x2-e,o=this._y2-t;this._l23_a=n(this._l23_2a=g(a*a+o*o,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:ae(this,e,t);}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var at=function e(t){function a(e){return t?new ie(e,t):new te(e,0)}return a.alpha=function(t){return e(+t)},a}(.5);ne.prototype={areaStart:Y,areaEnd:Y,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},pe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:ce(this,this._t0,de(this,this._t0));}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var a=NaN;if(e=+e,t=+t,e!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,ce(this,de(this,a=se(this,e,t)),a);break;default:ce(this,this._t0,a=se(this,e,t));}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=a}}},(ue.prototype=Object.create(pe.prototype)).point=function(e,t){pe.prototype.point.call(this,t,e)},ge.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,a,o,r,i){this._context.bezierCurveTo(t,e,o,a,i,r)}},me.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,a=e.length;if(a)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===a)this._context.lineTo(e[1],t[1]);else for(var o=he(e),r=he(t),i=0,n=1;n<a;++i,++n)this._context.bezierCurveTo(o[0][i],r[0][i],o[1][i],r[1][i],e[n],t[n]);(this._line||0!==this._line&&1===a)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},ye.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&1>this._t&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),0<=this._line&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(0>=this._t)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var a=this._x*(1-this._t)+e*this._t;this._context.lineTo(a,this._y),this._context.lineTo(a,t)}break}}this._x=e,this._y=t}},e.arc=S,e.area=x,e.areaRadial=j,e.curveBasis=function(e){return new X(e)},e.curveBasisClosed=function(e){return new Z(e)},e.curveBasisOpen=function(e){return new K(e)},e.curveBundle=Ke,e.curveCardinal=$e,e.curveCardinalClosed=Je,e.curveCardinalOpen=Qe,e.curveCatmullRom=et,e.curveCatmullRomClosed=tt,e.curveCatmullRomOpen=at,e.curveLinear=L,e.curveLinearClosed=function(e){return new ne(e)},e.curveMonotoneX=function(e){return new pe(e)},e.curveMonotoneY=function(e){return new ue(e)},e.curveNatural=function(e){return new me(e)},e.curveStep=function(e){return new ye(e,.5)},e.curveStepAfter=function(e){return new ye(e,1)},e.curveStepBefore=function(e){return new ye(e,0)},e.line=y,e.lineRadial=M,e.linkHorizontal=function(){return V(U)},e.linkRadial=function(){var e=V(q);return e.angle=e.x,delete e.x,e.radius=e.y,delete e.y,e},e.linkVertical=function(){return V(H)},e.pie=z,e.pointRadial=B,e.radialArea=j,e.radialLine=M,e.stack=be,e.stackOffsetDiverging=function(e,t){if(0<(u=e.length))for(var a=0,o=e[t[0]].length,r,l,s,c,p,u;a<o;++a)for(c=p=0,r=0;r<u;++r)0<(s=(l=e[t[r]][a])[1]-l[0])?(l[0]=c,l[1]=c+=s):0>s?(l[1]=p,l[0]=p+=s):(l[0]=0,l[1]=s)},e.stackOffsetExpand=function(e,t){if(0<(l=e.length)){for(var a=0,o=e[0].length,r,l,s;a<o;++a){for(s=r=0;r<l;++r)s+=e[r][a][1]||0;if(s)for(r=0;r<l;++r)e[r][a][1]/=s}fe(e,t)}},e.stackOffsetNone=fe,e.stackOffsetSilhouette=function(e,t){if(0<(l=e.length)){for(var a=0,o=e[t[0]],r=o.length,l;a<r;++a){for(var s=0,d=0;s<l;++s)d+=e[s][a][1]||0;o[a][1]+=o[a][0]=-d/2}fe(e,t)}},e.stackOffsetWiggle=function(e,t){if(0<(s=e.length)&&0<(l=(r=e[t[0]]).length)){for(var a=0,o=1,r,l,s;o<l;++o){for(var d=0,c=0,p=0;d<s;++d){for(var u=e[t[d]],g=u[o][1]||0,h=u[o-1][1]||0,f=(g-h)/2,x=0;x<d;++x){var _=e[t[x]],b=_[o][1]||0,v=_[o-1][1]||0;f+=b-v}c+=g,p+=f*g}r[o-1][1]+=r[o-1][0]=a,c&&(a-=p/c)}r[o-1][1]+=r[o-1][0]=a,fe(e,t)}},e.stackOrderAppearance=ve,e.stackOrderAscending=ke,e.stackOrderDescending=function(e){return ke(e).reverse()},e.stackOrderInsideOut=function(e){var t=e.length,a=e.map(Te),o=ve(e),r=0,n=0,l=[],s=[],d,c;for(d=0;d<t;++d)c=o[d],r<n?(r+=a[c],l.push(c)):(n+=a[c],s.push(c));return s.reverse().concat(l)},e.stackOrderNone=xe,e.stackOrderReverse=function(e){return xe(e).reverse()},e.symbol=G,e.symbolCircle=Be,e.symbolCross=Fe,e.symbolDiamond=Ve,e.symbolSquare=Ye,e.symbolStar=Ge,e.symbolTriangle=Xe,e.symbolWye=k,e.symbols=[Be,Fe,Ve,Ye,Ge,Xe,k],Object.defineProperty(e,"__esModule",{value:!0})})},{"d3-path":104}],107:[function(e,t,a){(function(e,o){"object"==typeof a&&"undefined"!=typeof t?o(a):"function"==typeof define&&define.amd?define(["exports"],o):(e=e||self,o(e.d3=e.d3||{}))})(this,function(e){'use strict';function a(){return h||(x(o),h=f.now()+y)}function o(){h=0}function r(){this._call=this._time=this._next=null}function i(e,a,o){var i=new r;return i.restart(e,a,o),i}function n(){a(),++p;for(var o=_,r;o;)0<=(r=h-o._time)&&o._call.call(null,r),o=o._next;--p}function l(){h=(m=f.now())+y,p=u=0;try{n()}finally{p=0,d(),h=0}}function s(){var e=f.now(),t=e-m;t>1000&&(y-=t,m=e)}function d(){for(var e=_,t=1/0,a,o;e;)e._call?(t>e._time&&(t=e._time),a=e,e=e._next):(o=e._next,e._next=null,e=a?a._next=o:_=o);b=a,c(t)}function c(e){if(!p){u&&(u=clearTimeout(u));var t=e-h;24<t?(e<1/0&&(u=setTimeout(l,e-f.now()-y)),g&&(g=clearInterval(g))):(!g&&(m=f.now(),g=setInterval(s,1000)),p=1,x(l))}}var p=0,u=0,g=0,m=0,h=0,y=0,f="object"==typeof performance&&performance.now?performance:Date,x="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)},_,b;r.prototype=i.prototype={constructor:r,restart:function(e,t,o){if("function"!=typeof e)throw new TypeError("callback is not a function");o=(null==o?a():+o)+(null==t?0:+t),this._next||b===this||(b?b._next=this:_=this,b=this),this._call=e,this._time=o,c()},stop:function(){this._call&&(this._call=null,this._time=1/0,c())}},e.interval=function(e,o,i){var n=new r,t=o;return null==o?(n.restart(e,o,i),n):(o=+o,i=null==i?a():+i,n.restart(function a(r){r+=t,n.restart(a,t+=o,i),e(r)},o,i),n)},e.now=a,e.timeout=function(e,a,o){var i=new r;return a=null==a?0:+a,i.restart(function(t){i.stop(),e(t+a)},a,o),i},e.timer=i,e.timerFlush=n,Object.defineProperty(e,"__esModule",{value:!0})})},{}],108:[function(e,t){var a=String.fromCharCode,o=Math.asin,r=Math.acos,i=Math.SQRT2,n=Math.exp,s=Math.atan2,d=Math.LN2,c=Math.LN10,u=Math.log,g=Math.cos,h=Math.ceil,f=Math.sqrt,_=Math.round,b=Math.PI,T=Math.sin,A=Math.min,S=Math.pow,C=Math.tan,L=Math.atan,E=Math.abs,I=Math.max,P=Math.floor;!function(){function e(e){return e&&(e.ownerDocument||e.document||e).documentElement}function l(e){return e&&(e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView)}function p(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function y(e){return null===e?NaN:+e}function v(e){return!isNaN(e)}function w(e){return{left:function(t,a,o,r){for(3>arguments.length&&(o=0),4>arguments.length&&(r=t.length);o<r;){var i=o+r>>>1;0>e(t[i],a)?o=i+1:r=i}return o},right:function(t,a,o,r){for(3>arguments.length&&(o=0),4>arguments.length&&(r=t.length);o<r;){var i=o+r>>>1;0<e(t[i],a)?r=i:o=i+1}return o}}}function k(e){return e.length}function z(e){for(var t=1;e*t%1;)t*=10;return t}function D(e,t){for(var a in t)Object.defineProperty(e.prototype,a,{value:t[a],enumerable:!1})}function O(){this._=Object.create(null)}function R(e){return"__proto__"===(e+="")||"\0"===e[0]?"\0"+e:e}function M(e){return"\0"===(e+="")[0]?e.slice(1):e}function j(e){return R(e)in this._}function B(e){return(e=R(e))in this._&&delete this._[e]}function F(){var e=[];for(var t in this._)e.push(M(t));return e}function N(){var e=0;for(var t in this._)++e;return e}function V(){for(var e in this._)return!1;return!0}function U(){this._=Object.create(null)}function H(e){return e}function q(e,t,a){return function(){var o=a.apply(t,arguments);return o===t?e:o}}function G(e,t){if(t in e)return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(var a=0,o=An.length,r;a<o;++a)if(r=An[a]+t,r in e)return r}function Y(){}function W(){}function X(e){function t(){for(var t=a,o=-1,r=t.length,n;++o<r;)(n=t[o].on)&&n.apply(this,arguments);return e}var a=[],o=new O;return t.on=function(t,r){var n=o.get(t),l;return 2>arguments.length?n&&n.on:(n&&(n.on=null,a=a.slice(0,l=a.indexOf(n)).concat(a.slice(l+1)),o.remove(t)),r&&a.push(o.set(t,{on:r})),e)},t}function Z(){yn.event.preventDefault()}function K(){for(var t=yn.event,a;a=t.sourceEvent;)t=a;return t}function $(e){for(var t=new W,a=0,o=arguments.length;++a<o;)t[arguments[a]]=X(t);return t.of=function(a,o){return function(r){try{var i=r.sourceEvent=yn.event;r.target=e,yn.event=r,t[r.type].apply(a,o)}finally{yn.event=i}}},t}function J(e){return Cn(e,Pn),e}function Q(e){return"function"==typeof e?e:function(){return Ln(e,this)}}function ee(e){return"function"==typeof e?e:function(){return En(e,this)}}function te(e,t){function a(){this.removeAttribute(e)}function o(){this.removeAttributeNS(e.space,e.local)}function r(){this.setAttribute(e,t)}function i(){this.setAttributeNS(e.space,e.local,t)}function n(){var a=t.apply(this,arguments);null==a?this.removeAttribute(e):this.setAttribute(e,a)}function l(){var a=t.apply(this,arguments);null==a?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,a)}return e=yn.ns.qualify(e),null==t?e.local?o:a:"function"==typeof t?e.local?l:n:e.local?i:r}function ae(e){return e.trim().replace(/\s+/g," ")}function oe(e){return new RegExp("(?:^|\\s+)"+yn.requote(e)+"(?:\\s+|$)","g")}function re(e){return(e+"").trim().split(/^|\s+/)}function ie(e,t){function a(){for(var a=-1;++a<r;)e[a](this,t)}function o(){for(var a=-1,o=t.apply(this,arguments);++a<r;)e[a](this,o)}e=re(e).map(ne);var r=e.length;return"function"==typeof t?o:a}function ne(e){var t=oe(e);return function(a,o){if(r=a.classList)return o?r.add(e):r.remove(e);var r=a.getAttribute("class")||"";o?(t.lastIndex=0,!t.test(r)&&a.setAttribute("class",ae(r+" "+e))):a.setAttribute("class",ae(r.replace(t," ")))}}function le(e,t,a){return null==t?function(){this.style.removeProperty(e)}:"function"==typeof t?function(){var o=t.apply(this,arguments);null==o?this.style.removeProperty(e):this.style.setProperty(e,o,a)}:function(){this.style.setProperty(e,t,a)}}function se(e,t){return null==t?function(){delete this[e]}:"function"==typeof t?function(){var a=t.apply(this,arguments);null==a?delete this[e]:this[e]=a}:function(){this[e]=t}}function de(e){function t(){var t=this.ownerDocument,a=this.namespaceURI;return"http://www.w3.org/1999/xhtml"===a&&"http://www.w3.org/1999/xhtml"===t.documentElement.namespaceURI?t.createElement(e):t.createElementNS(a,e)}function a(){return this.ownerDocument.createElementNS(e.space,e.local)}return"function"==typeof e?e:(e=yn.ns.qualify(e)).local?a:t}function ce(){var e=this.parentNode;e&&e.removeChild(this)}function pe(e){return{__data__:e}}function ue(e){return function(){return In(this,e)}}function ge(e){return arguments.length||(e=p),function(t,a){return t&&a?e(t.__data__,a.__data__):!t-!a}}function me(e,t){for(var a=0,o=e.length;a<o;a++)for(var r=e[a],l=0,s=r.length,n;l<s;l++)(n=r[l])&&t(n,l,a);return e}function he(e){return Cn(e,Dn),e}function ye(e){var t,a;return function(o,r,i){var l=e[i].update,s=l.length,n;for(i!=a&&(a=i,t=0),r>=t&&(t=r+1);!(n=l[t])&&++t<s;);return n}}function fe(e,t,a){function o(){var t=this[s];t&&(this.removeEventListener(e,t,t.$),delete this[s])}function r(){var r=i(t,dt(arguments));o.call(this),this.addEventListener(e,this[s]=r,r.$=a),r._=t}function n(){var t=new RegExp("^__on([^.]+)"+yn.requote(e)+"$"),a;for(var o in this)if(a=o.match(t)){var r=this[o];this.removeEventListener(a[1],r,r.$),delete this[o]}}var s="__on"+e,d=e.indexOf("."),i=xe;0<d&&(e=e.slice(0,d));var l=On.get(e);return l&&(e=l,i=_e),d?t?r:o:t?Y:n}function xe(e,t){return function(a){var r=yn.event;yn.event=a,t[0]=this.__data__;try{e.apply(this,t)}finally{yn.event=r}}}function _e(e,t){var a=xe(e,t);return function(t){var e=this,o=t.relatedTarget;o&&(o===e||8&o.compareDocumentPosition(e))||a.call(e,t)}}function be(t){var a=".dragsuppress-"+ ++Rn,o="click"+a,r=yn.select(l(t)).on("touchmove"+a,Z).on("dragstart"+a,Z).on("selectstart"+a,Z);if(null==Mn&&(Mn=!("onselectstart"in t)&&G(t.style,"userSelect")),Mn){var i=e(t).style,n=i[Mn];i[Mn]="none"}return function(e){if(r.on(a,null),Mn&&(i[Mn]=n),e){var t=function(){r.on(o,null)};r.on(o,function(){Z(),t()},!0),setTimeout(t,0)}}}function ve(t,a){a.changedTouches&&(a=a.changedTouches[0]);var o=t.ownerSVGElement||t;if(o.createSVGPoint){var r=o.createSVGPoint();if(0>jn){var i=l(t);if(i.scrollX||i.scrollY){o=yn.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var n=o[0][0].getScreenCTM();jn=!(n.f||n.e),o.remove()}}return jn?(r.x=a.pageX,r.y=a.pageY):(r.x=a.clientX,r.y=a.clientY),r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}var s=t.getBoundingClientRect();return[a.clientX-s.left-t.clientLeft,a.clientY-s.top-t.clientTop]}function we(){return yn.event.changedTouches[0].identifier}function ke(e){return 0<e?1:0>e?-1:0}function Te(e,t,a){return(t[0]-e[0])*(a[1]-e[1])-(t[1]-e[1])*(a[0]-e[0])}function Ae(e){return 1<e?0:-1>e?Nn:r(e)}function Se(e){return 1<e?m:-1>e?-m:o(e)}function Ce(e){return((e=n(e))-1/e)/2}function Le(e){return((e=n(e))+1/e)/2}function Ee(e){return((e=n(2*e))-1)/(e+1)}function Ie(e){return(e=T(e/2))*e}function Pe(){}function ze(e,t,a){return this instanceof ze?void(this.h=+e,this.s=+t,this.l=+a):2>arguments.length?e instanceof ze?new ze(e.h,e.s,e.l):Ye(""+e,We,ze):new ze(e,t,a)}function De(e,t,a){function o(e){return 360<e?e-=360:0>e&&(e+=360),60>e?i+(n-i)*e/60:180>e?n:240>e?i+(n-i)*(240-e)/60:i}function r(e){return _(255*o(e))}var i,n;return e=isNaN(e)?0:0>(e%=360)?e+360:e,t=isNaN(t)?0:0>t?0:1<t?1:t,a=0>a?0:1<a?1:a,n=.5>=a?a*(1+t):a+t-a*t,i=2*a-n,new Ue(r(e+120),r(e),r(e-120))}function Oe(e,t,a){return this instanceof Oe?void(this.h=+e,this.c=+t,this.l=+a):2>arguments.length?e instanceof Oe?new Oe(e.h,e.c,e.l):e instanceof Me?Be(e.l,e.a,e.b):Be((e=Xe((e=yn.rgb(e)).r,e.g,e.b)).l,e.a,e.b):new Oe(e,t,a)}function Re(e,t,a){return isNaN(e)&&(e=0),isNaN(t)&&(t=0),new Me(a,g(e*=Un)*t,T(e)*t)}function Me(e,t,a){return this instanceof Me?void(this.l=+e,this.a=+t,this.b=+a):2>arguments.length?e instanceof Me?new Me(e.l,e.a,e.b):e instanceof Oe?Re(e.h,e.c,e.l):Xe((e=Ue(e)).r,e.g,e.b):new Me(e,t,a)}function je(e,t,a){var o=(e+16)/116,r=o+t/500,i=o-a/200;return r=Fe(r)*Qn,o=1*Fe(o),i=Fe(i)*el,new Ue(Ve(3.2404542*r-1.5371385*o-.4985314*i),Ve(-.969266*r+1.8760108*o+.041556*i),Ve(.0556434*r-.2040259*o+1.0572252*i))}function Be(e,t,a){return 0<e?new Oe(s(a,t)*Hn,f(t*t+a*a),e):new Oe(NaN,NaN,e)}function Fe(e){return .206893034<e?e*e*e:(e-4/29)/7.787037}function Ne(e){return .008856<e?S(e,1/3):7.787037*e+4/29}function Ve(e){return _(255*(.00304>=e?12.92*e:1.055*S(e,1/2.4)-.055))}function Ue(e,t,a){return this instanceof Ue?void(this.r=~~e,this.g=~~t,this.b=~~a):2>arguments.length?e instanceof Ue?new Ue(e.r,e.g,e.b):Ye(""+e,Ue,De):new Ue(e,t,a)}function He(e){return new Ue(e>>16,255&e>>8,255&e)}function qe(e){return He(e)+""}function Ge(e){return 16>e?"0"+I(0,e).toString(16):A(255,e).toString(16)}function Ye(e,t,a){var o=0,i=0,n=0,l,s,d;if(l=/([a-z]+)\((.*)\)/.exec(e=e.toLowerCase()),l)switch(s=l[2].split(","),l[1]){case"hsl":return a(parseFloat(s[0]),parseFloat(s[1])/100,parseFloat(s[2])/100);case"rgb":return t(Ke(s[0]),Ke(s[1]),Ke(s[2]));}return(d=ol.get(e))?t(d.r,d.g,d.b):(null==e||"#"!==e.charAt(0)||isNaN(d=parseInt(e.slice(1),16))||(4===e.length?(o=(3840&d)>>4,o=o>>4|o,i=240&d,i=i>>4|i,n=15&d,n=n<<4|n):7===e.length&&(o=(16711680&d)>>16,i=(65280&d)>>8,n=255&d)),t(o,i,n))}function We(e,t,a){var o=A(e/=255,t/=255,a/=255),i=I(e,t,a),n=i-o,d=(i+o)/2,l,c;return n?(c=.5>d?n/(i+o):n/(2-i-o),l=e==i?(t-a)/n+(t<a?6:0):t==i?(a-e)/n+2:(e-t)/n+4,l*=60):(l=NaN,c=0<d&&1>d?0:l),new ze(l,c,d)}function Xe(e,t,a){e=Ze(e),t=Ze(t),a=Ze(a);var o=Ne((.4124564*e+.3575761*t+.1804375*a)/Qn),i=Ne((.2126729*e+.7151522*t+.072175*a)/1),n=Ne((.0193339*e+.119192*t+.9503041*a)/el);return Me(116*i-16,500*(o-i),200*(i-n))}function Ze(e){return .04045>=(e/=255)?e/12.92:S((e+.055)/1.055,2.4)}function Ke(e){var t=parseFloat(e);return"%"===e.charAt(e.length-1)?_(2.55*t):t}function $e(e){return"function"==typeof e?e:function(){return e}}function Je(e){return function(t,a,o){return 2===arguments.length&&"function"==typeof a&&(o=a,a=null),Qe(t,a,e,o)}}function Qe(e,t,a,o){function r(){var e=s.status,t;if(!e&&tt(s)||200<=e&&300>e||304===e){try{t=a.call(i,s)}catch(t){return void n.error.call(i,t)}n.load.call(i,t)}else n.error.call(i,s)}var i={},n=yn.dispatch("beforesend","progress","load","error"),l={},s=new XMLHttpRequest,d=null;return this.XDomainRequest&&!("withCredentials"in s)&&/^(http(s)?:)?\/\//.test(e)&&(s=new XDomainRequest),"onload"in s?s.onload=s.onerror=r:s.onreadystatechange=function(){3<s.readyState&&r()},s.onprogress=function(e){var t=yn.event;yn.event=e;try{n.progress.call(i,s)}finally{yn.event=t}},i.header=function(e,t){return(e=(e+"").toLowerCase(),2>arguments.length)?l[e]:(null==t?delete l[e]:l[e]=t+"",i)},i.mimeType=function(e){return arguments.length?(t=null==e?null:e+"",i):t},i.responseType=function(e){return arguments.length?(d=e,i):d},i.response=function(e){return a=e,i},["get","post"].forEach(function(e){i[e]=function(){return i.send.apply(i,[e].concat(dt(arguments)))}}),i.send=function(a,o,r){if(2===arguments.length&&"function"==typeof o&&(r=o,o=null),s.open(a,e,!0),null==t||"accept"in l||(l.accept=t+",*/*"),s.setRequestHeader)for(var c in l)s.setRequestHeader(c,l[c]);return null!=t&&s.overrideMimeType&&s.overrideMimeType(t),null!=d&&(s.responseType=d),null!=r&&i.on("error",r).on("load",function(e){r(null,e)}),n.beforesend.call(i,s),s.send(null==o?null:o),i},i.abort=function(){return s.abort(),i},yn.rebind(i,n,"on"),null==o?i:i.get(et(o))}function et(e){return 1===e.length?function(t,a){e(null==t?a:null)}:e}function tt(e){var t=e.responseType;return t&&"text"!==t?e.response:e.responseText}function at(e,t,a){var o=arguments.length;2>o&&(t=0),3>o&&(a=Date.now());var r=a+t,i={c:e,t:r,n:null};return nl?nl.n=i:il=i,nl=i,ll||(sl=clearTimeout(sl),ll=1,rl(ot)),i}function ot(){var e=rt(),t=it()-e;24<t?(isFinite(t)&&(clearTimeout(sl),sl=setTimeout(ot,t)),ll=0):(ll=1,rl(ot))}function rt(){for(var e=Date.now(),t=il;t;)e>=t.t&&t.c(e-t.t)&&(t.c=null),t=t.n;return e}function it(){for(var e=il,t=1/0,a;e;)e.c?(e.t<t&&(t=e.t),e=(a=e).n):e=a?a.n=e.n:il=e.n;return nl=a,t}function nt(e,t){return t-(e?h(u(e)/c):1)}function lt(e){var t=e.decimal,a=e.thousands,o=e.grouping,r=e.currency,n=o&&a?function(e,r){for(var n=e.length,l=[],t=0,s=o[0],d=0;0<n&&0<s&&(d+s+1>r&&(s=I(1,r-d)),l.push(e.substring(n-=s,n+s)),!((d+=s+1)>r));)s=o[t=(t+1)%o.length];return l.reverse().join(a)}:H;return function(e){var a=cl.exec(e),o=a[1]||" ",l=a[2]||">",s=a[3]||"-",d=a[4]||"",c=a[5],p=+a[6],u=a[7],g=a[8],m=a[9],h=1,y="",f="",x=!1,_=!0;switch(g&&(g=+g.substring(1)),(c||"0"===o&&"="===l)&&(c=o="0",l="="),m){case"n":u=!0,m="g";break;case"%":h=100,f="%",m="f";break;case"p":h=100,f="%",m="r";break;case"b":case"o":case"x":case"X":"#"===d&&(y="0"+m.toLowerCase());case"c":_=!1;case"d":x=!0,g=0;break;case"s":h=-1,m="r";}"$"===d&&(y=r[0],f=r[1]),"r"!=m||g||(m="g"),null!=g&&("g"==m?g=I(1,A(21,g)):("e"==m||"f"==m)&&(g=I(0,A(20,g)))),m=pl.get(m)||st;var b=c&&u;return function(e){var a=f;if(x&&e%1)return"";var r=0>e||0===e&&0>1/e?(e=-e,"-"):"-"===s?"":s;if(0>h){var d=yn.formatPrefix(e,g);e=d.scale(e),a=d.symbol+f}else e*=h;e=m(e,g);var v=e.lastIndexOf("."),i,w;if(0>v){var k=_?e.lastIndexOf("e"):-1;0>k?(i=e,w=""):(i=e.substring(0,k),w=e.substring(k))}else i=e.substring(0,v),w=t+e.substring(v+1);!c&&u&&(i=n(i,1/0));var T=y.length+i.length+w.length+(b?0:r.length),A=T<p?Array(T=p-T+1).join(o):"";return b&&(i=n(A+i,A.length?p-w.length:1/0)),r+=y,e=i+w,("<"===l?r+e+A:">"===l?A+r+e:"^"===l?A.substring(0,T>>=1)+r+e+A.substring(T):r+(b?e:A+e))+a}}}function st(e){return e+""}function ct(){this._=new Date(1<arguments.length?Date.UTC.apply(this,arguments):arguments[0])}function pt(e,t,a){function o(t){var a=e(t),o=i(a,1);return t-a<o-t?a:o}function r(a){return t(a=e(new ml(a-1)),1),a}function i(e,a){return t(e=new ml(+e),a),e}function n(e,o,i){var n=r(e),l=[];if(1<i)for(;n<o;)a(n)%i||l.push(new Date(+n)),t(n,1);else for(;n<o;)l.push(new Date(+n)),t(n,1);return l}e.floor=e,e.round=o,e.ceil=r,e.offset=i,e.range=n;var l=e.utc=ut(e);return l.floor=l,l.round=ut(o),l.ceil=ut(r),l.offset=ut(i),l.range=function(e,t,a){try{ml=ct;var o=new ct;return o._=e,n(o,t,a)}finally{ml=Date}},e}function ut(e){return function(t,a){try{ml=ct;var o=new ct;return o._=t,e(o,a)._}finally{ml=Date}}}function gt(e){function t(e){function t(t){for(var a=[],r=-1,n=0,l,s,d;++r<o;)37===e.charCodeAt(r)&&(a.push(e.slice(n,r)),null!=(s=yl[l=e.charAt(++r)])&&(l=e.charAt(++r)),(d=v[l])&&(l=d(t,null==s?"e"===l?" ":"0":s)),a.push(l),n=r+1);return a.push(e.slice(n,r)),a.join("")}var o=e.length;return t.parse=function(t){var o={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},r=a(o,e,t,0);if(r!=t.length)return null;"p"in o&&(o.H=o.H%12+12*o.p);var i=null!=o.Z&&ml!==ct,n=new(i?ct:ml);return"j"in o?n.setFullYear(o.y,0,o.j):"W"in o||"U"in o?(!("w"in o)&&(o.w="W"in o?1:0),n.setFullYear(o.y,0,1),n.setFullYear(o.y,0,"W"in o?(o.w+6)%7+7*o.W-(n.getDay()+5)%7:o.w+7*o.U-(n.getDay()+6)%7)):n.setFullYear(o.y,o.m,o.d),n.setHours(o.H+(0|o.Z/100),o.M+o.Z%100,o.S,o.L),i?n._:n},t.toString=function(){return e},t}function a(e,a,o,r){for(var l=0,s=a.length,n=o.length,d,u,g;l<s;){if(r>=n)return-1;if(d=a.charCodeAt(l++),37===d){if(g=a.charAt(l++),u=w[g in yl?a.charAt(l++):g],!u||0>(r=u(e,o,r)))return-1;}else if(d!=o.charCodeAt(r++))return-1}return r}var o=e.dateTime,r=e.date,i=e.time,n=e.periods,l=e.days,s=e.shortDays,c=e.months,p=e.shortMonths;t.utc=function(e){function a(e){try{ml=ct;var t=new ml;return t._=e,o(t)}finally{ml=Date}}var o=t(e);return a.parse=function(e){try{ml=ct;var t=o.parse(e);return t&&t._}finally{ml=Date}},a.toString=o.toString,a},t.multi=t.utc.multi=Dt;var u=yn.map(),g=ht(l),m=yt(l),h=ht(s),y=yt(s),f=ht(c),x=yt(c),_=ht(p),b=yt(p);n.forEach(function(e,t){u.set(e.toLowerCase(),t)});var v={a:function(e){return s[e.getDay()]},A:function(e){return l[e.getDay()]},b:function(e){return p[e.getMonth()]},B:function(e){return c[e.getMonth()]},c:t(o),d:function(e,t){return mt(e.getDate(),t,2)},e:function(e,t){return mt(e.getDate(),t,2)},H:function(e,t){return mt(e.getHours(),t,2)},I:function(e,t){return mt(e.getHours()%12||12,t,2)},j:function(e,t){return mt(1+ul.dayOfYear(e),t,3)},L:function(e,t){return mt(e.getMilliseconds(),t,3)},m:function(e,t){return mt(e.getMonth()+1,t,2)},M:function(e,t){return mt(e.getMinutes(),t,2)},p:function(e){return n[+(12<=e.getHours())]},S:function(e,t){return mt(e.getSeconds(),t,2)},U:function(e,t){return mt(ul.sundayOfYear(e),t,2)},w:function(e){return e.getDay()},W:function(e,t){return mt(ul.mondayOfYear(e),t,2)},x:t(r),X:t(i),y:function(e,t){return mt(e.getFullYear()%100,t,2)},Y:function(e,t){return mt(e.getFullYear()%1e4,t,4)},Z:Pt,"%":function(){return"%"}},w={a:function(e,t,a){h.lastIndex=0;var o=h.exec(t.slice(a));return o?(e.w=y.get(o[0].toLowerCase()),a+o[0].length):-1},A:function(e,t,a){g.lastIndex=0;var o=g.exec(t.slice(a));return o?(e.w=m.get(o[0].toLowerCase()),a+o[0].length):-1},b:function(e,t,a){_.lastIndex=0;var o=_.exec(t.slice(a));return o?(e.m=b.get(o[0].toLowerCase()),a+o[0].length):-1},B:function(e,t,a){f.lastIndex=0;var o=f.exec(t.slice(a));return o?(e.m=x.get(o[0].toLowerCase()),a+o[0].length):-1},c:function(e,t,o){return a(e,v.c.toString(),t,o)},d:At,e:At,H:Ct,I:Ct,j:St,L:It,m:Tt,M:Lt,p:function(e,t,a){var o=u.get(t.slice(a,a+=2).toLowerCase());return null==o?-1:(e.p=o,a)},S:Et,U:xt,w:ft,W:_t,x:function(e,t,o){return a(e,v.x.toString(),t,o)},X:function(e,t,o){return a(e,v.X.toString(),t,o)},y:vt,Y:bt,Z:wt,"%":zt};return t}function mt(e,t,a){var o=0>e?"-":"",r=(o?-e:e)+"",i=r.length;return o+(i<a?Array(a-i+1).join(t)+r:r)}function ht(e){return new RegExp("^(?:"+e.map(yn.requote).join("|")+")","i")}function yt(e){for(var t=new O,a=-1,o=e.length;++a<o;)t.set(e[a].toLowerCase(),a);return t}function ft(e,t,a){fl.lastIndex=0;var o=fl.exec(t.slice(a,a+1));return o?(e.w=+o[0],a+o[0].length):-1}function xt(e,t,a){fl.lastIndex=0;var o=fl.exec(t.slice(a));return o?(e.U=+o[0],a+o[0].length):-1}function _t(e,t,a){fl.lastIndex=0;var o=fl.exec(t.slice(a));return o?(e.W=+o[0],a+o[0].length):-1}function bt(e,t,a){fl.lastIndex=0;var o=fl.exec(t.slice(a,a+4));return o?(e.y=+o[0],a+o[0].length):-1}function vt(e,t,a){fl.lastIndex=0;var o=fl.exec(t.slice(a,a+2));return o?(e.y=kt(+o[0]),a+o[0].length):-1}function wt(e,t,a){return /^[+-]\d{4}$/.test(t=t.slice(a,a+5))?(e.Z=-t,a+5):-1}function kt(e){return e+(68<e?1900:2e3)}function Tt(e,t,a){fl.lastIndex=0;var o=fl.exec(t.slice(a,a+2));return o?(e.m=o[0]-1,a+o[0].length):-1}function At(e,t,a){fl.lastIndex=0;var o=fl.exec(t.slice(a,a+2));return o?(e.d=+o[0],a+o[0].length):-1}function St(e,t,a){fl.lastIndex=0;var o=fl.exec(t.slice(a,a+3));return o?(e.j=+o[0],a+o[0].length):-1}function Ct(e,t,a){fl.lastIndex=0;var o=fl.exec(t.slice(a,a+2));return o?(e.H=+o[0],a+o[0].length):-1}function Lt(e,t,a){fl.lastIndex=0;var o=fl.exec(t.slice(a,a+2));return o?(e.M=+o[0],a+o[0].length):-1}function Et(e,t,a){fl.lastIndex=0;var o=fl.exec(t.slice(a,a+2));return o?(e.S=+o[0],a+o[0].length):-1}function It(e,t,a){fl.lastIndex=0;var o=fl.exec(t.slice(a,a+3));return o?(e.L=+o[0],a+o[0].length):-1}function Pt(e){var t=e.getTimezoneOffset(),a=0<t?"-":"+",o=0|Tn(t)/60,r=Tn(t)%60;return a+mt(o,"0",2)+mt(r,"0",2)}function zt(e,t,a){xl.lastIndex=0;var o=xl.exec(t.slice(a,a+1));return o?a+o[0].length:-1}function Dt(e){for(var t=e.length,a=-1;++a<t;)e[a][0]=this(e[a][0]);return function(t){for(var a=0,o=e[a];!o[1](t);)o=e[++a];return o[0](t)}}function Ot(){}function Rt(e,t,a){var o=a.s=e+t,r=o-e;a.t=e-(o-r)+(t-r)}function Mt(e,t){e&&wl.hasOwnProperty(e.type)&&wl[e.type](e,t)}function jt(e,t,a){var o=-1,r=e.length-a,n;for(t.lineStart();++o<r;)n=e[o],t.point(n[0],n[1],n[2]);t.lineEnd()}function Bt(e,t){var a=-1,o=e.length;for(t.polygonStart();++a<o;)jt(e[a],t,1);t.polygonEnd()}function Ft(){function e(e,t){e*=Un,t=t*Un/2+Nn/4;var a=e-o,n=0<=a?1:-1,l=n*a,d=g(t),c=T(t),p=i*c,m=r*d+p*g(l),u=p*n*T(l);kl.add(s(u,m)),o=e,r=d,i=c}var t,a,o,r,i;Tl.point=function(n,l){Tl.point=e,o=(t=n)*Un,r=g(l=(a=l)*Un/2+Nn/4),i=T(l)},Tl.lineEnd=function(){e(t,a)}}function Nt(e){var t=e[0],a=e[1],o=g(a);return[o*g(t),o*T(t),T(a)]}function Vt(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Ut(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Ht(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function qt(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Gt(e){var t=f(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function Yt(e){return[s(e[1],e[0]),Se(e[2])]}function Wt(e,t){return Tn(e[0]-t[0])<Bn&&Tn(e[1]-t[1])<Bn}function Xt(e,t){e*=Un;var a=g(t*=Un);Zt(a*g(e),a*T(e),T(t))}function Zt(e,t,a){++Ll,Il+=(e-Il)/Ll,Pl+=(t-Pl)/Ll,zl+=(a-zl)/Ll}function Kt(){function e(e,r){e*=Un;var i=g(r*=Un),n=i*g(e),l=i*T(e),d=T(r),c=s(f((c=a*d-o*l)*c+(c=o*n-t*d)*c+(c=t*l-a*n)*c),t*n+a*l+o*d);El+=c,Dl+=c*(t+(t=n)),Ol+=c*(a+(a=l)),Rl+=c*(o+(o=d)),Zt(t,a,o)}var t,a,o;Sl.point=function(r,i){r*=Un;var n=g(i*=Un);t=n*g(r),a=n*T(r),o=T(i),Sl.point=e,Zt(t,a,o)}}function $t(){Sl.point=Xt}function Jt(){function e(e,t){e*=Un;var a=g(t*=Un),n=a*g(e),l=a*T(e),d=T(t),c=r*d-i*l,p=i*n-o*d,h=o*l-r*n,y=f(c*c+p*p+h*h),m=o*n+r*l+i*d,u=y&&-Ae(m)/y,x=s(y,m);Ml+=u*c,jl+=u*p,Bl+=u*h,El+=x,Dl+=x*(o+(o=n)),Ol+=x*(r+(r=l)),Rl+=x*(i+(i=d)),Zt(o,r,i)}var t,a,o,r,i;Sl.point=function(n,l){t=n,a=l,Sl.point=e,n*=Un;var s=g(l*=Un);o=s*g(n),r=s*T(n),i=T(l),Zt(o,r,i)},Sl.lineEnd=function(){e(t,a),Sl.lineEnd=$t,Sl.point=Xt}}function Qt(e,t){function a(a,o){return a=e(a,o),t(a[0],a[1])}return e.invert&&t.invert&&(a.invert=function(a,o){return a=t.invert(a,o),a&&e.invert(a[0],a[1])}),a}function ea(){return!0}function ta(e,t,a,o,r){var l=[],s=[];if(e.forEach(function(e){if(!(0>=(d=e.length-1))){var t=e[0],o=e[d],d;if(Wt(t,o)){r.lineStart();for(var c=0;c<d;++c)r.point((t=e[c])[0],t[1]);return void r.lineEnd()}var p=new oa(t,e,null,!0),u=new oa(t,null,p,!1);p.o=u,l.push(p),s.push(u),p=new oa(o,e,null,!1),u=new oa(o,null,p,!0),p.o=u,l.push(p),s.push(u)}}),s.sort(t),aa(l),aa(s),!!l.length){for(var d=0,c=a,p=s.length;d<p;++d)s[d].e=c=!c;for(var u=l[0],g,m;;){for(var h=u,y=!0;h.v;)if((h=h.n)===u)return;g=h.z,r.lineStart();do{if(h.v=h.o.v=!0,h.e){if(y)for(var d=0,p=g.length;d<p;++d)r.point((m=g[d])[0],m[1]);else o(h.x,h.n.x,1,r);h=h.n}else{if(y){g=h.p.z;for(var d=g.length-1;0<=d;--d)r.point((m=g[d])[0],m[1])}else o(h.x,h.p.x,-1,r);h=h.p}h=h.o,g=h.z,y=!y}while(!h.v);r.lineEnd()}}}function aa(e){if(r=e.length){for(var t=0,o=e[0],r,l;++t<r;)o.n=l=e[t],l.p=o,o=l;o.n=l=e[0],l.p=o}}function oa(e,t,a,o){this.x=e,this.z=t,this.o=a,this.e=o,this.v=!1,this.n=this.p=null}function ra(e,t,a,o){return function(r,l){function s(t,a){var o=r(t,a);e(t=o[0],a=o[1])&&l.point(t,a)}function d(e,t){var a=r(e,t);h.point(a[0],a[1])}function c(){f.point=d,h.lineStart()}function p(){f.point=s,h.lineEnd()}function u(e,t){k.push([e,t]);var a=r(e,t);_.point(a[0],a[1])}function g(){_.lineStart(),k=[]}function m(){u(k[0][0],k[0][1]),_.lineEnd();var e=_.clean(),t=x.buffer(),a=t.length,o;if(k.pop(),w.push(k),k=null,!!a){if(1&e){o=t[0];var a=o.length-1,r=-1,s;if(0<a){for(b||(l.polygonStart(),b=!0),l.lineStart();++r<a;)l.point((s=o[r])[0],s[1]);l.lineEnd()}return}1<a&&2&e&&t.push(t.pop().concat(t.shift())),v.push(t.filter(ia))}}var h=t(l),y=r.invert(o[0],o[1]),f={point:s,lineStart:c,lineEnd:p,polygonStart:function(){f.point=u,f.lineStart=g,f.lineEnd=m,v=[],w=[]},polygonEnd:function(){f.point=s,f.lineStart=c,f.lineEnd=p,v=yn.merge(v);var e=da(y,w);v.length?(!b&&(l.polygonStart(),b=!0),ta(v,la,e,a,l)):e&&(!b&&(l.polygonStart(),b=!0),l.lineStart(),a(null,null,1,l),l.lineEnd()),b&&(l.polygonEnd(),b=!1),v=w=null},sphere:function(){l.polygonStart(),l.lineStart(),a(null,null,1,l),l.lineEnd(),l.polygonEnd()}},x=na(),_=t(x),b=!1,v,w,k;return f}}function ia(e){return 1<e.length}function na(){var e=[],t;return{lineStart:function(){e.push(t=[])},point:function(e,a){t.push([e,a])},lineEnd:Y,buffer:function(){var a=e;return e=[],t=null,a},rejoin:function(){1<e.length&&e.push(e.pop().concat(e.shift()))}}}function la(e,t){return(0>(e=e.x)[0]?e[1]-m-Bn:m-e[1])-(0>(t=t.x)[0]?t[1]-m-Bn:m-t[1])}function sa(e,t,a,o){var r=T(e-a),i,n;return Tn(r)>Bn?L((T(t)*(n=g(o))*T(a)-T(o)*(i=g(t))*T(e))/(i*n*r)):(t+o)/2}function da(e,t){var a=e[0],o=e[1],r=[T(a),-g(a),0],l=0,d=0;kl.reset();for(var c=0,p=t.length;c<p;++c){var n=t[c],u=n.length;if(u)for(var m=n[0],h=m[0],y=m[1]/2+Nn/4,f=T(y),x=g(y),_=1;;){_===u&&(_=0),e=n[_];var b=e[0],v=e[1]/2+Nn/4,w=T(v),A=g(v),S=b-h,C=0<=S?1:-1,L=C*S,E=L>Nn,I=f*w;if(kl.add(s(I*C*T(L),x*A+I*g(L))),l+=E?S+C*Vn:S,E^h>=a^b>=a){var k=Ut(Nt(m),Nt(e));Gt(k);var P=Ut(r,k);Gt(P);var z=(E^0<=S?-1:1)*Se(P[2]);(o>z||o===z&&(k[0]||k[1]))&&(d+=E^0<=S?1:-1)}if(!_++)break;h=b,f=w,x=A,m=e}}return(l<-Bn||l<Bn&&kl<-Bn)^1&d}function ca(e){function a(e,t){return g(e)*g(t)>i}function o(e,a,o){var r=Nt(e),n=Nt(a),l=[1,0,0],s=Ut(r,n),d=Vt(s,s),c=s[0],p=d-c*c;if(!p)return!o&&e;var g=Ut(l,s),m=qt(l,i*d/p),h=qt(s,-i*c/p);Ht(m,h);var y=g,u=Vt(m,y),x=Vt(y,y),_=u*u-x*(Vt(m,m)-1);if(!(0>_)){var b=f(_),t=qt(y,(-u-b)/x);if(Ht(t,m),t=Yt(t),!o)return t;var v=e[0],w=a[0],k=e[1],T=a[1],A;w<v&&(A=v,v=w,w=A);var S=w-v,C=Tn(S-Nn)<Bn;if(!C&&T<k&&(A=k,k=T,T=A),C||S<Bn?C?0<k+T^t[1]<(Tn(t[0]-v)<Bn?k:T):k<=t[1]&&t[1]<=T:S>Nn^(v<=t[0]&&t[0]<=w)){var L=qt(y,(-u+b)/x);return Ht(L,m),[t,Yt(L)]}}}function r(t,a){var o=n?e:Nn-e,r=0;return t<-o?r|=1:t>o&&(r|=2),a<-o?r|=4:a>o&&(r|=8),r}var i=g(e),n=0<i,l=Tn(i)>Bn,s=ja(e,6*Un);return ra(a,function(e){var i,s,d,p,u;return{lineStart:function(){p=d=!1,u=1},point:function(g,m){var h=[g,m],y=a(g,m),f=n?y?0:r(g,m):y?r(g+(0>g?Nn:-Nn),m):0,c;if(!i&&(p=d=y)&&e.lineStart(),y!==d&&(c=o(i,h),(Wt(i,c)||Wt(h,c))&&(h[0]+=Bn,h[1]+=Bn,y=a(h[0],h[1]))),y!==d)u=0,y?(e.lineStart(),c=o(h,i),e.point(c[0],c[1])):(c=o(i,h),e.point(c[0],c[1]),e.lineEnd()),i=c;else if(l&&i&&n^y){var x;!(f&s)&&(x=o(h,i,!0))&&(u=0,n?(e.lineStart(),e.point(x[0][0],x[0][1]),e.point(x[1][0],x[1][1]),e.lineEnd()):(e.point(x[1][0],x[1][1]),e.lineEnd(),e.lineStart(),e.point(x[0][0],x[0][1])))}!y||i&&Wt(i,h)||e.point(h[0],h[1]),i=h,d=y,s=f},lineEnd:function(){d&&e.lineEnd(),i=null},clean:function(){return u|(p&&d)<<1}}},s,n?[0,-e]:[-Nn,e-Nn])}function pa(e,t,a,o){return function(i){var n=i.a,l=i.b,s=n.x,d=n.y,c=l.x,p=l.y,u=0,g=1,m=c-s,h=p-d,y;if(y=e-s,m||!(0<y)){if(y/=m,0>m){if(y<u)return;y<g&&(g=y)}else if(0<m){if(y>g)return;y>u&&(u=y)}if(y=a-s,m||!(0>y)){if(y/=m,0>m){if(y>g)return;y>u&&(u=y)}else if(0<m){if(y<u)return;y<g&&(g=y)}if(y=t-d,h||!(0<y)){if(y/=h,0>h){if(y<u)return;y<g&&(g=y)}else if(0<h){if(y>g)return;y>u&&(u=y)}if(y=o-d,h||!(0>y)){if(y/=h,0>h){if(y>g)return;y>u&&(u=y)}else if(0<h){if(y<u)return;y<g&&(g=y)}return 0<u&&(i.a={x:s+u*m,y:d+u*h}),1>g&&(i.b={x:s+g*m,y:d+g*h}),i}}}}}}function ua(e,t,o,r){function i(a,r){return Tn(a[0]-e)<Bn?0<r?0:3:Tn(a[0]-o)<Bn?0<r?2:1:Tn(a[1]-t)<Bn?0<r?1:0:0<r?3:2}function n(e,t){return l(e.x,t.x)}function l(e,t){var a=i(e,1),o=i(t,1);return a===o?0===a?t[1]-e[1]:1===a?e[0]-t[0]:2===a?e[1]-t[1]:t[0]-e[0]:a-o}return function(a){function s(e){for(var t=0,o=w.length,r=e[1],n=0;n<o;++n)for(var l=1,s=w[n],d=s.length,c=s[0],p;l<d;++l)p=s[l],c[1]<=r?p[1]>r&&0<Te(c,p,e)&&++t:p[1]<=r&&0>Te(c,p,e)&&--t,c=p;return 0!==t}function d(n,s,d,c){var p=0,u=0;if(null==n||(p=i(n,d))!==(u=i(s,d))||0>l(n,s)^0<d)do c.point(0===p||3===p?e:o,1<p?r:t);while((p=(p+d+4)%4)!==u);else c.point(s[0],s[1])}function c(a,i){return e<=a&&a<=o&&t<=i&&i<=r}function p(e,t){c(e,t)&&a.point(e,t)}function u(){x.point=m,w&&w.push(k=[]),P=!0,E=!1,L=b=NaN}function g(){_&&(m(T,S),C&&E&&y.rejoin(),_.push(y.buffer())),x.point=p,E&&a.lineEnd()}function m(e,t){e=I(-1000000000,A(1000000000,e)),t=I(-1000000000,A(1000000000,t));var o=c(e,t);if(w&&k.push([e,t]),P)T=e,S=t,C=o,P=!1,o&&(a.lineStart(),a.point(e,t));else if(o&&E)a.point(e,t);else{var r={a:{x:L,y:b},b:{x:e,y:t}};f(r)?(!E&&(a.lineStart(),a.point(r.a.x,r.a.y)),a.point(r.b.x,r.b.y),!o&&a.lineEnd(),z=!1):o&&(a.lineStart(),a.point(e,t),z=!1)}L=e,b=t,E=o}var h=a,y=na(),f=pa(e,t,o,r),x={point:p,lineStart:u,lineEnd:g,polygonStart:function(){a=y,_=[],w=[],z=!0},polygonEnd:function(){a=h,_=yn.merge(_);var t=s([e,r]),o=z&&t,i=_.length;(o||i)&&(a.polygonStart(),o&&(a.lineStart(),d(null,null,1,a),a.lineEnd()),i&&ta(_,n,t,d,a),a.polygonEnd()),_=w=k=null}},_,w,k,T,S,C,L,b,E,P,z;return x}}function ga(e){var t=0,a=Nn/3,o=Ea(e),r=o(t,a);return r.parallels=function(e){return arguments.length?o(t=e[0]*Nn/180,a=e[1]*Nn/180):[180*(t/Nn),180*(a/Nn)]},r}function ma(e,t){function a(e,t){var a=f(i-2*r*T(t))/r;return[a*T(e*=r),n-a*g(e)]}var o=T(e),r=(o+T(t))/2,i=1+o*(2*r-o),n=f(i)/r;return a.invert=function(e,t){var a=n-t;return[s(e,a)/r,Se((i-(e*e+a*a)*r*r)/(2*r))]},a}function ha(){function e(e,t){Hl+=r*e-o*t,o=e,r=t}var t,a,o,r;Fl.point=function(i,n){Fl.point=e,t=o=i,a=r=n},Fl.lineEnd=function(){e(t,a)}}function ya(e,t){e<ql&&(ql=e),e>Yl&&(Yl=e),t<Gl&&(Gl=t),t>Wl&&(Wl=t)}function fa(){function e(e,t){n.push("M",e,",",t,i)}function t(e,t){n.push("M",e,",",t),l.point=a}function a(e,t){n.push("L",e,",",t)}function o(){l.point=e}function r(){n.push("Z")}var i=xa(4.5),n=[],l={point:e,lineStart:function(){l.point=t},lineEnd:o,polygonStart:function(){l.lineEnd=r},polygonEnd:function(){l.lineEnd=o,l.point=e},pointRadius:function(e){return i=xa(e),l},result:function(){if(n.length){var e=n.join("");return n=[],e}}};return l}function xa(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function _a(e,t){Il+=e,Pl+=t,++zl}function ba(){function e(e,o){var r=e-t,i=o-a,n=f(r*r+i*i);Dl+=n*(t+e)/2,Ol+=n*(a+o)/2,Rl+=n,_a(t=e,a=o)}var t,a;Vl.point=function(o,r){Vl.point=e,_a(t=o,a=r)}}function va(){Vl.point=_a}function wa(){function e(e,t){var a=e-o,i=t-r,n=f(a*a+i*i);Dl+=n*(o+e)/2,Ol+=n*(r+t)/2,Rl+=n,n=r*e-o*t,Ml+=n*(o+e),jl+=n*(r+t),Bl+=3*n,_a(o=e,r=t)}var t,a,o,r;Vl.point=function(i,n){Vl.point=e,_a(t=o=i,a=r=n)},Vl.lineEnd=function(){e(t,a)}}function ka(e){function t(t,a){e.moveTo(t+n,a),e.arc(t,a,n,0,Vn)}function a(t,a){e.moveTo(t,a),l.point=o}function o(t,a){e.lineTo(t,a)}function r(){l.point=t}function i(){e.closePath()}var n=4.5,l={point:t,lineStart:function(){l.point=a},lineEnd:r,polygonStart:function(){l.lineEnd=i},polygonEnd:function(){l.lineEnd=r,l.point=t},pointRadius:function(e){return n=e,l},result:Y};return l}function Ta(e){function t(e){return(d?r:a)(e)}function a(t){return Ca(t,function(a,o){a=e(a,o),t.point(a[0],a[1])})}function r(t){function a(a,o){a=e(a,o),t.point(a[0],a[1])}function o(){b=NaN,p.point=r,t.lineStart()}function r(a,o){var r=Nt([a,o]),n=e(a,o);i(b,v,_,w,k,T,b=n[0],v=n[1],_=a,w=r[0],k=r[1],T=r[2],d,t),t.point(b,v)}function n(){p.point=a,t.lineEnd()}function l(){o(),p.point=s,p.lineEnd=c}function s(e,t){r(u=e,g=t),m=b,h=v,y=w,f=k,x=T,p.point=r}function c(){i(b,v,_,w,k,T,m,h,u,y,f,x,d,t),p.lineEnd=n,n()}var p={point:a,lineStart:o,lineEnd:n,polygonStart:function(){t.polygonStart(),p.lineStart=l},polygonEnd:function(){t.polygonEnd(),p.lineStart=o}},u,g,m,h,y,f,x,_,b,v,w,k,T;return p}function i(t,r,d,u,g,h,y,x,_,v,w,k,T,A){var S=y-t,C=x-r,L=S*S+C*C;if(L>4*n&&T--){var E=u+v,I=g+w,P=h+k,z=f(E*E+I*I+P*P),m=o(P/=z),D=Tn(Tn(P)-1)<Bn||Tn(d-_)<Bn?(d+_)/2:s(I,E),O=e(D,m),p=O[0],R=O[1],M=p-t,j=R-r,B=C*M-S*j;(B*B/L>n||.3<Tn((S*M+C*j)/L-.5)||u*v+g*w+h*k<l)&&(i(t,r,d,u,g,h,p,R,D,E/=z,I/=z,P,T,A),A.point(p,R),i(p,R,D,E,I,P,y,x,_,v,w,k,T,A))}}var n=.5,l=g(30*Un),d=16;return t.precision=function(e){return arguments.length?(d=0<(n=e*e)&&16,t):f(n)},t}function Aa(e){var t=Ta(function(t,a){return e([t*Hn,a*Hn])});return function(e){return Ia(t(e))}}function Sa(e){this.stream=e}function Ca(e,t){return{point:t,sphere:function(){e.sphere()},lineStart:function(){e.lineStart()},lineEnd:function(){e.lineEnd()},polygonStart:function(){e.polygonStart()},polygonEnd:function(){e.polygonEnd()}}}function La(e){return Ea(function(){return e})()}function Ea(e){function t(e){return e=T(e[0]*Un,e[1]*Un),[e[0]*n+A,_-e[1]*n]}function a(e){return e=T.invert((e[0]-A)/n,(_-e[1])/n),e&&[e[0]*Hn,e[1]*Hn]}function o(){T=Qt(w=Da(p,u,g),v);var e=v(d,c);return A=l-e[0]*n,_=s+e[1]*n,r()}function r(){return S&&(S.valid=!1,S=null),t}var i=Ta(function(e,t){return e=v(e,t),[e[0]*n+A,_-e[1]*n]}),n=150,l=480,s=250,d=0,c=0,p=0,u=0,g=0,m=Cl,h=H,f=null,b=null,v,w,T,A,_,S;return t.stream=function(e){return S&&(S.valid=!1),S=Ia(m(w,i(h(e)))),S.valid=!0,S},t.clipAngle=function(e){return arguments.length?(m=null==e?(f=e,Cl):ca((f=+e)*Un),r()):f},t.clipExtent=function(e){return arguments.length?(b=e,h=e?ua(e[0][0],e[0][1],e[1][0],e[1][1]):H,r()):b},t.scale=function(e){return arguments.length?(n=+e,o()):n},t.translate=function(e){return arguments.length?(l=+e[0],s=+e[1],o()):[l,s]},t.center=function(e){return arguments.length?(d=e[0]%360*Un,c=e[1]%360*Un,o()):[d*Hn,c*Hn]},t.rotate=function(e){return arguments.length?(p=e[0]%360*Un,u=e[1]%360*Un,g=2<e.length?e[2]%360*Un:0,o()):[p*Hn,u*Hn,g*Hn]},yn.rebind(t,i,"precision"),function(){return v=e.apply(this,arguments),t.invert=v.invert&&a,o()}}function Ia(e){return Ca(e,function(t,a){e.point(t*Un,a*Un)})}function Pa(e,t){return[e,t]}function za(e,t){return[e>Nn?e-Vn:e<-Nn?e+Vn:e,t]}function Da(e,t,a){return e?t||a?Qt(Ra(e),Ma(t,a)):Ra(e):t||a?Ma(t,a):za}function Oa(e){return function(t,a){return t+=e,[t>Nn?t-Vn:t<-Nn?t+Vn:t,a]}}function Ra(e){var t=Oa(e);return t.invert=Oa(-e),t}function Ma(e,t){function a(e,t){var a=g(t),l=g(e)*a,d=T(e)*a,c=T(t),p=c*o+l*r;return[s(d*i-p*n,l*o-c*r),Se(p*i+d*n)]}var o=g(e),r=T(e),i=g(t),n=T(t);return a.invert=function(e,t){var a=g(t),l=g(e)*a,d=T(e)*a,c=T(t),p=c*i-d*n;return[s(d*i+c*n,l*o+p*r),Se(p*o-l*r)]},a}function ja(e,a){var o=g(e),r=T(e);return function(i,n,l,s){var d=l*a;null==i?(i=e+l*Vn,n=e-.5*d):(i=Ba(o,i),n=Ba(o,n),(0<l?i<n:i>n)&&(i+=l*Vn));for(var c=i,p;0<l?c>n:c<n;c-=d)s.point((p=Yt([o,-r*g(c),-r*T(c)]))[0],p[1])}}function Ba(e,t){var o=Nt(t);o[0]-=e,Gt(o);var a=Ae(-o[1]);return((0>-o[2]?-a:a)+2*b-Bn)%(2*b)}function Fa(e,t,a){var o=yn.range(e,t-Bn,a).concat(t);return function(e){return o.map(function(t){return[e,t]})}}function Na(e,t,a){var o=yn.range(e,t-Bn,a).concat(t);return function(e){return o.map(function(t){return[t,e]})}}function Va(e){return e.source}function Ua(e){return e.target}function Ha(e,t,a,r){var i=g(t),n=T(t),l=g(r),c=T(r),p=i*g(e),u=i*T(e),m=l*g(a),h=l*T(a),_=2*o(f(Ie(r-t)+i*l*Ie(a-e))),d=1/T(_),y=_?function(e){var a=T(e*=_)*d,o=T(_-e)*d,r=o*p+a*m,i=o*u+a*h;return[s(i,r)*Hn,s(o*n+a*c,f(r*r+i*i))*Hn]}:function(){return[e*Hn,t*Hn]};return y.distance=_,y}function qa(e,t){function a(t,a){var o=g(t),r=g(a),i=e(o*r);return[i*r*T(t),i*T(a)]}return a.invert=function(e,a){var r=f(e*e+a*a),i=t(r),n=T(i),l=g(i);return[s(e*n,r*l),o(r&&a*n/r)]},a}function Ga(e,a){function o(e,a){0<n?a<-m+Bn&&(a=-m+Bn):a>m-Bn&&(a=m-Bn);var o=n/S(i(a),t);return[o*T(t*e),n-o*g(t*e)]}var r=g(e),i=function(e){return C(Nn/4+e/2)},t=e===a?T(e):u(r/g(a))/u(i(a)/i(e)),n=r*S(i(e),t)/t;return t?(o.invert=function(e,a){var o=n-a,r=ke(t)*f(e*e+o*o);return[s(e,o)/t,2*L(S(n/r,1/t))-m]},o):Wa}function Ya(e,t){function a(e,t){var a=i-t;return[a*T(r*e),i-a*g(r*e)]}var o=g(e),r=e===t?T(e):(o-g(t))/(t-e),i=o/r+e;return Tn(r)<Bn?Pa:(a.invert=function(e,t){var a=i-t;return[s(e,a)/r,i-ke(r)*f(e*e+a*a)]},a)}function Wa(e,t){return[e,u(C(Nn/4+t/2))]}function Xa(e){var a=La(e),o=a.scale,r=a.translate,i=a.clipExtent,n;return a.scale=function(){var e=o.apply(a,arguments);return e===a?n?a.clipExtent(null):a:e},a.translate=function(){var e=r.apply(a,arguments);return e===a?n?a.clipExtent(null):a:e},a.clipExtent=function(e){var l=i.apply(a,arguments);if(l!==a)n&&(l=null);else if(n=null==e){var s=Nn*o(),d=r();i([[d[0]-s,d[1]-s],[d[0]+s,d[1]+s]])}return l},a.clipExtent(null)}function Za(e,t){return[u(C(Nn/4+t/2)),-e]}function Ka(e){return e[0]}function $a(e){return e[1]}function Ja(e){for(var t=e.length,a=[0,1],o=2,r=2;r<t;r++){for(;1<o&&0>=Te(e[a[o-2]],e[a[o-1]],e[r]);)--o;a[o++]=r}return a.slice(0,o)}function Qa(e,t){return e[0]-t[0]||e[1]-t[1]}function eo(e,t,a){return(a[0]-t[0])*(e[1]-t[1])<(a[1]-t[1])*(e[0]-t[0])}function to(e,t,o,a){var r=e[0],i=o[0],n=t[0]-r,l=a[0]-i,s=e[1],d=o[1],c=t[1]-s,p=a[1]-d,u=(l*(s-d)-p*(r-i))/(p*n-l*c);return[r+u*n,s+u*c]}function ao(e){var t=e[0],a=e[e.length-1];return!(t[0]-a[0]||t[1]-a[1])}function oo(){Ao(this),this.edge=this.site=this.circle=null}function ro(e){var t=as.pop()||new oo;return t.site=e,t}function io(e){yo(e),ns.remove(e),as.push(e),Ao(e)}function no(e){var t=e.circle,a=t.x,o=t.cy,r={x:a,y:o},i=e.P,n=e.N,l=[e];io(e);for(var s=i;s.circle&&Tn(a-s.circle.x)<Bn&&Tn(o-s.circle.cy)<Bn;)i=s.P,l.unshift(s),io(s),s=i;l.unshift(s),yo(s);for(var d=n;d.circle&&Tn(a-d.circle.x)<Bn&&Tn(o-d.circle.cy)<Bn;)n=d.N,l.push(d),io(d),d=n;l.push(d),yo(d);var c=l.length,p;for(p=1;p<c;++p)d=l[p],s=l[p-1],wo(d.edge,s.site,d.site,r);s=l[0],d=l[c-1],d.edge=bo(s.site,d.site,null,r),ho(s),ho(d)}function lo(e){for(var t=e.x,a=e.y,o=ns._,r,i,n,l;o;)if(n=so(o,a)-t,n>Bn)o=o.L;else if(l=t-co(o,a),l>Bn){if(!o.R){r=o;break}o=o.R}else{n>-Bn?(r=o.P,i=o):l>-Bn?(r=o,i=o.N):r=i=o;break}var s=ro(e);if(ns.insert(r,s),r||i){if(r===i)return yo(r),i=ro(r.site),ns.insert(s,i),s.edge=i.edge=bo(r.site,s.site),ho(r),void ho(i);if(!i)return void(s.edge=bo(r.site,s.site));yo(r),yo(i);var c=r.site,p=c.x,u=c.y,g=e.x-p,m=e.y-u,h=i.site,y=h.x-p,f=h.y-u,x=2*(g*f-m*y),d=g*g+m*m,_=y*y+f*f,b={x:(f*d-m*_)/x+p,y:(g*_-y*d)/x+u};wo(i.edge,c,h,b),s.edge=bo(c,e,null,b),i.edge=bo(e,h,null,b),ho(r),ho(i)}}function so(e,t){var a=e.site,o=a.x,r=a.y,i=r-t;if(!i)return o;var n=e.P;if(!n)return-Infinity;a=n.site;var l=a.x,s=a.y,d=s-t;if(!d)return l;var c=l-o,p=1/i-1/d,u=c/d;return p?(-u+f(u*u-2*p*(c*c/(-2*d)-s+d/2+r-i/2)))/p+o:(o+l)/2}function co(e,t){var a=e.N;if(a)return so(a,t);var o=e.site;return o.y===t?o.x:1/0}function po(e){this.site=e,this.edges=[]}function uo(e){for(var t=e[0][0],a=e[1][0],o=e[0][1],r=e[1][1],i=is,n=i.length,l,s,d,c,p,u,g,m,h,y;n--;)if(p=i[n],p&&p.prepare())for(g=p.edges,m=g.length,u=0;u<m;)y=g[u].end(),d=y.x,c=y.y,h=g[++u%m].start(),l=h.x,s=h.y,(Tn(d-l)>Bn||Tn(c-s)>Bn)&&(g.splice(u,0,new ko(vo(p.site,y,Tn(d-t)<Bn&&r-c>Bn?{x:t,y:Tn(l-t)<Bn?s:r}:Tn(c-r)<Bn&&a-d>Bn?{x:Tn(s-r)<Bn?l:a,y:r}:Tn(d-a)<Bn&&c-o>Bn?{x:a,y:Tn(l-a)<Bn?s:o}:Tn(c-o)<Bn&&d-t>Bn?{x:Tn(s-o)<Bn?l:t,y:o}:null),p.site,null)),++m)}function go(e,t){return t.angle-e.angle}function mo(){Ao(this),this.x=this.y=this.arc=this.site=this.cy=null}function ho(e){var t=e.P,a=e.N;if(t&&a){var o=t.site,r=e.site,i=a.site;if(o!==i){var n=r.x,l=r.y,s=o.x-n,c=o.y-l,p=i.x-n,u=i.y-l,g=2*(s*u-c*p);if(!(g>=-Fn)){var d=s*s+c*c,m=p*p+u*u,h=(u*d-c*m)/g,x=(s*m-p*d)/g,u=x+l,y=os.pop()||new mo;y.arc=e,y.site=r,y.x=h+n,y.y=u+f(h*h+x*x),y.cy=u,e.circle=y;for(var _=null,b=ss._;b;)if(y.y<b.y||y.y===b.y&&y.x<=b.x){if(b.L)b=b.L;else{_=b.P;break}}else if(b.R)b=b.R;else{_=b;break}ss.insert(_,y),_||(ls=y)}}}}function yo(e){var t=e.circle;t&&(!t.P&&(ls=t.N),ss.remove(t),os.push(t),Ao(t),e.circle=null)}function fo(t){for(var a=rs,o=pa(t[0][0],t[0][1],t[1][0],t[1][1]),r=a.length,n;r--;)n=a[r],(!xo(n,t)||!o(n)||Tn(n.a.x-n.b.x)<Bn&&Tn(n.a.y-n.b.y)<Bn)&&(n.a=n.b=null,a.splice(r,1))}function xo(e,t){var a=e.b;if(a)return!0;var o=e.a,r=t[0][0],i=t[1][0],n=t[0][1],l=t[1][1],s=e.l,d=e.r,c=s.x,p=s.y,u=d.x,g=d.y,m=(c+u)/2,h,y;if(g===p){if(m<r||m>=i)return;if(c>u){if(!o)o={x:m,y:n};else if(o.y>=l)return;a={x:m,y:l}}else{if(!o)o={x:m,y:l};else if(o.y<n)return;a={x:m,y:n}}}else if(h=(c-u)/(g-p),y=(p+g)/2-h*m,-1>h||1<h){if(c>u){if(!o)o={x:(n-y)/h,y:n};else if(o.y>=l)return;a={x:(l-y)/h,y:l}}else{if(!o)o={x:(l-y)/h,y:l};else if(o.y<n)return;a={x:(n-y)/h,y:n}}}else if(p<g){if(!o)o={x:r,y:h*r+y};else if(o.x>=i)return;a={x:i,y:h*i+y}}else{if(!o)o={x:i,y:h*i+y};else if(o.x<r)return;a={x:r,y:h*r+y}}return e.a=o,e.b=a,!0}function _o(e,t){this.l=e,this.r=t,this.a=this.b=null}function bo(e,t,a,o){var r=new _o(e,t);return rs.push(r),a&&wo(r,e,t,a),o&&wo(r,t,e,o),is[e.i].edges.push(new ko(r,e,t)),is[t.i].edges.push(new ko(r,t,e)),r}function vo(e,t,a){var o=new _o(e,null);return o.a=t,o.b=a,rs.push(o),o}function wo(e,t,a,o){e.a||e.b?e.l===a?e.b=o:e.a=o:(e.a=o,e.l=t,e.r=a)}function ko(e,t,a){var o=e.a,r=e.b;this.edge=e,this.site=t,this.angle=a?s(a.y-t.y,a.x-t.x):e.l===t?s(r.x-o.x,o.y-r.y):s(o.x-r.x,r.y-o.y)}function To(){this._=null}function Ao(e){e.U=e.C=e.L=e.R=e.P=e.N=null}function So(e,t){var a=t,o=t.R,r=a.U;r?r.L===a?r.L=o:r.R=o:e._=o,o.U=r,a.U=o,a.R=o.L,a.R&&(a.R.U=a),o.L=a}function Co(e,t){var a=t,o=t.L,r=a.U;r?r.L===a?r.L=o:r.R=o:e._=o,o.U=r,a.U=o,a.L=o.R,a.L&&(a.L.U=a),o.R=a}function Lo(e){for(;e.L;)e=e.L;return e}function Eo(e,t){var a=e.sort(Io).pop(),o,r,i;for(rs=[],is=Array(e.length),ns=new To,ss=new To;;)if(i=ls,a&&(!i||a.y<i.y||a.y===i.y&&a.x<i.x))(a.x!==o||a.y!==r)&&(is[a.i]=new po(a),lo(a),o=a.x,r=a.y),a=e.pop();else if(i)no(i.arc);else break;t&&(fo(t),uo(t));var n={cells:is,edges:rs};return ns=ss=rs=is=null,n}function Io(e,t){return t.y-e.y||t.x-e.x}function Po(e,t,a){return(e.x-a.x)*(t.y-e.y)-(e.x-t.x)*(a.y-e.y)}function zo(e){return e.x}function Do(e){return e.y}function Oo(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function Ro(e,t,a,o,r,i){if(!e(t,a,o,r,i)){var n=.5*(a+r),l=.5*(o+i),s=t.nodes;s[0]&&Ro(e,s[0],a,o,n,l),s[1]&&Ro(e,s[1],n,o,r,l),s[2]&&Ro(e,s[2],a,l,n,i),s[3]&&Ro(e,s[3],n,l,r,i)}}function Mo(e,t,a,o,r,n,l){var i=1/0,s;return function e(d,c,p,u,g){if(!(c>n||p>l||u<o||g<r)){if(x=d.point){var m=t-d.x,h=a-d.y,y=m*m+h*h,x;if(y<i){var _=f(i=y);o=t-_,r=a-_,n=t+_,l=a+_,s=x}}for(var b=d.nodes,v=.5*(c+u),w=.5*(p+g),k=(a>=w)<<1|t>=v;void 0>k;++k)if(d=b[3&k])switch(3&k){case 0:e(d,c,p,v,w);break;case 1:e(d,v,p,u,w);break;case 2:e(d,c,w,v,g);break;case 3:e(d,v,w,u,g);}}}(e,o,r,n,l),s}function jo(e,t){e=yn.rgb(e),t=yn.rgb(t);var o=e.r,r=e.g,i=e.b,n=t.r-o,l=t.g-r,s=t.b-i;return function(e){return"#"+Ge(_(o+n*e))+Ge(_(r+l*e))+Ge(_(i+s*e))}}function Bo(e,t){var a={},o={},r;for(r in e)r in t?a[r]=Vo(e[r],t[r]):o[r]=e[r];for(r in t)r in e||(o[r]=t[r]);return function(e){for(r in a)o[r]=a[r](e);return o}}function Fo(e,o){return e=+e,o=+o,function(a){return e*(1-a)+o*a}}function No(e,r){var t=cs.lastIndex=ps.lastIndex=0,o=-1,n=[],l=[],s,d,c;for(e+="",r+="";(s=cs.exec(e))&&(d=ps.exec(r));)(c=d.index)>t&&(c=r.slice(t,c),n[o]?n[o]+=c:n[++o]=c),(s=s[0])===(d=d[0])?n[o]?n[o]+=d:n[++o]=d:(n[++o]=null,l.push({i:o,x:Fo(s,d)})),t=ps.lastIndex;return t<r.length&&(c=r.slice(t),n[o]?n[o]+=c:n[++o]=c),2>n.length?l[0]?(r=l[0].x,function(e){return r(e)+""}):function(){return r}:(r=l.length,function(e){for(var t=0,a;t<r;++t)n[(a=l[t]).i]=a.x(e);return n.join("")})}function Vo(e,t){for(var a=yn.interpolators.length,o;0<=--a&&!(o=yn.interpolators[a](e,t)););return o}function Uo(e,t){var a=[],o=[],r=e.length,n=t.length,l=A(e.length,t.length),s;for(s=0;s<l;++s)a.push(Vo(e[s],t[s]));for(;s<r;++s)o[s]=e[s];for(;s<n;++s)o[s]=t[s];return function(e){for(s=0;s<l;++s)o[s]=a[s](e);return o}}function Ho(e){return function(a){return 0>=a?0:1<=a?1:e(a)}}function qo(e){return function(a){return 1-e(1-a)}}function Go(e){return function(a){return .5*(.5>a?e(2*a):2-e(2-2*a))}}function Yo(e){return e*e}function Wo(e){return e*e*e}function Xo(e){if(0>=e)return 0;if(1<=e)return 1;var t=e*e,a=t*e;return 4*(.5>e?a:3*(e-t)+a-.75)}function Zo(e){return 1-g(e*m)}function Ko(e){return S(2,10*(e-1))}function $o(e){return 1-f(1-e*e)}function Jo(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}function Qo(e,a){return a-=e,function(o){return _(e+a*o)}}function er(e){var t=[e.a,e.b],a=[e.c,e.d],o=ar(t),r=tr(t,a),i=ar(or(a,t,-r))||0;t[0]*a[1]<a[0]*t[1]&&(t[0]*=-1,t[1]*=-1,o*=-1,r*=-1),this.rotate=(o?s(t[1],t[0]):s(-a[0],a[1]))*Hn,this.translate=[e.e,e.f],this.scale=[o,i],this.skew=i?s(r,i)*Hn:0}function tr(e,t){return e[0]*t[0]+e[1]*t[1]}function ar(e){var t=f(tr(e,e));return t&&(e[0]/=t,e[1]/=t),t}function or(e,t,a){return e[0]+=a*t[0],e[1]+=a*t[1],e}function rr(e){return e.length?e.pop()+",":""}function ir(e,t,a,o){if(e[0]!==t[0]||e[1]!==t[1]){var r=a.push("translate(",null,",",null,")");o.push({i:r-4,x:Fo(e[0],t[0])},{i:r-2,x:Fo(e[1],t[1])})}else(t[0]||t[1])&&a.push("translate("+t+")")}function nr(e,t,a,o){e===t?t&&a.push(rr(a)+"rotate("+t+")"):(180<e-t?t+=360:180<t-e&&(e+=360),o.push({i:a.push(rr(a)+"rotate(",null,")")-2,x:Fo(e,t)}))}function lr(e,t,a,o){e===t?t&&a.push(rr(a)+"skewX("+t+")"):o.push({i:a.push(rr(a)+"skewX(",null,")")-2,x:Fo(e,t)})}function sr(e,t,a,o){if(e[0]!==t[0]||e[1]!==t[1]){var r=a.push(rr(a)+"scale(",null,",",null,")");o.push({i:r-4,x:Fo(e[0],t[0])},{i:r-2,x:Fo(e[1],t[1])})}else(1!==t[0]||1!==t[1])&&a.push(rr(a)+"scale("+t+")")}function dr(e,t){var r=[],l=[];return e=yn.transform(e),t=yn.transform(t),ir(e.translate,t.translate,r,l),nr(e.rotate,t.rotate,r,l),lr(e.skew,t.skew,r,l),sr(e.scale,t.scale,r,l),e=t=null,function(e){for(var t=-1,a=l.length,n;++t<a;)r[(n=l[t]).i]=n.x(e);return r.join("")}}function cr(e,t){return t=(t-=e=+e)||1/t,function(a){return(a-e)/t}}function pr(e,t){return t=(t-=e=+e)||1/t,function(a){return I(0,A(1,(a-e)/t))}}function ur(e){for(var t=e.source,a=e.target,o=mr(t,a),r=[t];t!==o;)t=t.parent,r.push(t);for(var i=r.length;a!==o;)r.splice(i,0,a),a=a.parent;return r}function gr(e){for(var t=[],a=e.parent;null!=a;)t.push(e),e=a,a=a.parent;return t.push(e),t}function mr(e,t){if(e===t)return e;for(var a=gr(e),o=gr(t),r=a.pop(),i=o.pop(),n=null;r===i;)n=r,r=a.pop(),i=o.pop();return n}function hr(e){e.fixed|=2}function yr(e){e.fixed&=-7}function fr(e){e.fixed|=4,e.px=e.x,e.py=e.y}function xr(e){e.fixed&=-5}function _r(e,t,a){var o=0,r=0;if(e.charge=0,!e.leaf)for(var l=e.nodes,s=l.length,n=-1,d;++n<s;)d=l[n],null==d||(_r(d,t,a),e.charge+=d.charge,o+=d.charge*d.cx,r+=d.charge*d.cy);if(e.point){e.leaf||(e.point.x+=Math.random()-.5,e.point.y+=Math.random()-.5);var p=t*a[e.point.index];e.charge+=e.pointCharge=p,o+=p*e.point.x,r+=p*e.point.y}e.cx=o/e.charge,e.cy=r/e.charge}function br(e,t){return yn.rebind(e,t,"sort","children","value"),e.nodes=e,e.links=Sr,e}function vr(e,t){for(var a=[e];null!=(e=a.pop());)if(t(e),(r=e.children)&&(o=r.length))for(var o,r;0<=--o;)a.push(r[o])}function wr(e,t){for(var a=[e],o=[];null!=(e=a.pop());)if(o.push(e),(s=e.children)&&(l=s.length))for(var r=-1,l,s;++r<l;)a.push(s[r]);for(;null!=(e=o.pop());)t(e)}function kr(e){return e.children}function Tr(e){return e.value}function Ar(e,t){return t.value-e.value}function Sr(e){return yn.merge(e.map(function(e){return(e.children||[]).map(function(t){return{source:e,target:t}})}))}function Cr(e){return e.x}function Lr(e){return e.y}function Er(e,t,a){e.y0=t,e.y=a}function Ir(e){return yn.range(e.length)}function Pr(e){for(var t=-1,a=e[0].length,o=[];++t<a;)o[t]=0;return o}function zr(e){for(var t=1,a=0,o=e[0][1],r=e.length,n;t<r;++t)(n=e[t][1])>o&&(a=t,o=n);return a}function Dr(e){return e.reduce(Or,0)}function Or(e,t){return e+t[1]}function Rr(e,t){return Mr(e,h(u(t.length)/d+1))}function Mr(e,t){for(var a=-1,o=+e[0],r=(e[1]-o)/t,i=[];++a<=t;)i[a]=r*a+o;return i}function jr(e){return[yn.min(e),yn.max(e)]}function Br(e,t){return e.value-t.value}function Fr(e,t){var a=e._pack_next;e._pack_next=t,t._pack_prev=e,t._pack_next=a,a._pack_prev=t}function Nr(e,t){e._pack_next=t,t._pack_prev=e}function Vr(e,t){var a=t.x-e.x,o=t.y-e.y,r=e.r+t.r;return .999*r*r>a*a+o*o}function Ur(e){function t(e){o=A(e.x-e.r,o),r=I(e.x+e.r,r),l=A(e.y-e.r,l),s=I(e.y+e.r,s)}if((d=e.children)&&(x=d.length)){var o=1/0,r=-Infinity,l=1/0,s=-Infinity,d,p,u,g,m,h,y,x;if(d.forEach(Hr),p=d[0],p.x=-p.r,p.y=0,t(p),1<x&&(u=d[1],u.x=u.r,u.y=0,t(u),2<x))for(g=d[2],Yr(p,u,g),t(g),Fr(p,g),p._pack_prev=g,Fr(g,u),u=p._pack_next,m=3;m<x;m++){Yr(p,u,g=d[m]);var _=0,v=1,w=1;for(h=u._pack_next;h!==u;h=h._pack_next,v++)if(Vr(h,g)){_=1;break}if(1==_)for(y=p._pack_prev;y!==h._pack_prev&&!Vr(y,g);y=y._pack_prev,w++);_?(v<w||v==w&&u.r<p.r?Nr(p,u=h):Nr(p=y,u),m--):(Fr(p,g),u=g,t(g))}var T=(o+r)/2,S=(l+s)/2,C=0;for(m=0;m<x;m++)g=d[m],g.x-=T,g.y-=S,C=I(C,g.r+f(g.x*g.x+g.y*g.y));e.r=C,d.forEach(qr)}}function Hr(e){e._pack_next=e._pack_prev=e}function qr(e){delete e._pack_next,delete e._pack_prev}function Gr(e,t,a,o){var r=e.children;if(e.x=t+=o*e.x,e.y=a+=o*e.y,e.r*=o,r)for(var l=-1,s=r.length;++l<s;)Gr(r[l],t,a,o)}function Yr(e,t,a){var o=e.r+a.r,r=t.x-e.x,i=t.y-e.y;if(o&&(r||i)){var n=t.r+a.r,l=r*r+i*i;n*=n,o*=o;var s=.5+(o-n)/(2*l),d=f(I(0,2*n*(o+l)-(o-=l)*o-n*n))/(2*l);a.x=e.x+s*r+d*i,a.y=e.y+s*i-d*r}else a.x=e.x+o,a.y=e.y}function Wr(e,t){return e.parent==t.parent?1:2}function Xr(e){var t=e.children;return t.length?t[0]:e.t}function Zr(e){var t=e.children,a;return(a=t.length)?t[a-1]:e.t}function Kr(e,t,a){var o=a/(t.i-e.i);t.c-=o,t.s+=a,e.c+=o,t.z+=a,t.m+=a}function $r(e){for(var t=0,a=0,o=e.children,r=o.length,n;0<=--r;)n=o[r],n.z+=t,n.m+=t,t+=n.s+(a+=n.c)}function Jr(e,t,a){return e.a.parent===t.parent?e.a:a}function Qr(e){return 1+yn.max(e,function(e){return e.y})}function ei(e){return e.reduce(function(e,t){return e+t.x},0)/e.length}function ti(e){var t=e.children;return t&&t.length?ti(t[0]):e}function ai(e){var t=e.children,a;return t&&(a=t.length)?ai(t[a-1]):e}function oi(e){return{x:e.x,y:e.y,dx:e.dx,dy:e.dy}}function ri(e,t){var a=e.x+t[3],o=e.y+t[0],r=e.dx-t[1]-t[3],i=e.dy-t[0]-t[2];return 0>r&&(a+=r/2,r=0),0>i&&(o+=i/2,i=0),{x:a,y:o,dx:r,dy:i}}function ii(e){var t=e[0],a=e[e.length-1];return t<a?[t,a]:[a,t]}function ni(e){return e.rangeExtent?e.rangeExtent():ii(e.range())}function li(e,t,a,o){var r=a(e[0],e[1]),n=o(t[0],t[1]);return function(e){return n(r(e))}}function si(e,t){var a=0,o=e.length-1,r=e[a],i=e[o],n;return i<r&&(n=a,a=o,o=n,n=r,r=i,i=n),e[a]=t.floor(r),e[o]=t.ceil(i),e}function di(e){return e?{floor:function(t){return P(t/e)*e},ceil:function(t){return h(t/e)*e}}:ws}function ci(e,t,a,o){var r=[],n=[],i=0,l=A(e.length,t.length)-1;for(e[l]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++i<=l;)r.push(a(e[i-1],e[i])),n.push(o(t[i-1],t[i]));return function(t){var a=yn.bisect(e,t,1,l)-1;return n[a](r[a](t))}}function pi(e,t,a,o){function r(){var r=2<A(e.length,t.length)?ci:li,s=o?pr:cr;return n=r(e,t,s,a),l=r(t,e,s,Vo),i}function i(e){return n(e)}var n,l;return i.invert=function(e){return l(e)},i.domain=function(t){return arguments.length?(e=t.map(Number),r()):e},i.range=function(e){return arguments.length?(t=e,r()):t},i.rangeRound=function(e){return i.range(e).interpolate(Qo)},i.clamp=function(e){return arguments.length?(o=e,r()):o},i.interpolate=function(e){return arguments.length?(a=e,r()):a},i.ticks=function(t){return hi(e,t)},i.tickFormat=function(t,a){return yi(e,t,a)},i.nice=function(t){return gi(e,t),r()},i.copy=function(){return pi(e,t,a,o)},r()}function ui(e,t){return yn.rebind(e,t,"range","rangeRound","interpolate","clamp")}function gi(e,t){return si(e,di(mi(e,t)[2])),si(e,di(mi(e,t)[2])),e}function mi(e,t){null==t&&(t=10);var a=ii(e),o=a[1]-a[0],r=S(10,P(u(o/t)/c)),i=t/o*r;return .15>=i?r*=10:.35>=i?r*=5:.75>=i&&(r*=2),a[0]=h(a[0]/r)*r,a[1]=P(a[1]/r)*r+.5*r,a[2]=r,a}function hi(e,t){return yn.range.apply(yn,mi(e,t))}function yi(e,t,a){var o=mi(e,t);if(a){var r=cl.exec(a);if(r.shift(),"s"===r[8]){var i=yn.formatPrefix(I(Tn(o[0]),Tn(o[1])));return r[7]||(r[7]="."+fi(i.scale(o[2]))),r[8]="f",a=yn.format(r.join("")),function(e){return a(i.scale(e))+i.symbol}}r[7]||(r[7]="."+xi(r[8],o)),a=r.join("")}else a=",."+fi(o[2])+"f";return yn.format(a)}function fi(e){return-P(u(e)/c+.01)}function xi(e,t){var a=fi(t[2]);return e in ks?E(a-fi(I(Tn(t[0]),Tn(t[1]))))+ +("e"!==e):a-2*("%"===e)}function _i(e,t,a,o){function r(e){return(a?u(0>e?0:e):-u(0<e?0:-e))/u(t)}function l(e){return a?S(t,e):-S(t,-e)}function s(t){return e(r(t))}return s.invert=function(t){return l(e.invert(t))},s.domain=function(t){return arguments.length?(a=0<=t[0],e.domain((o=t.map(Number)).map(r)),s):o},s.base=function(a){return arguments.length?(t=+a,e.domain(o.map(r)),s):t},s.nice=function(){var t=si(o.map(r),a?Math:As);return e.domain(t),o=t.map(l),s},s.ticks=function(){var e=ii(o),s=[],d=e[0],c=e[1],p=P(r(d)),u=h(r(c)),g=t%1?2:t;if(isFinite(u-p)){if(a){for(;p<u;p++)for(var n=1;n<g;n++)s.push(l(p)*n);s.push(l(p))}else for(s.push(l(p));p++<u;)for(var n=g-1;0<n;n--)s.push(l(p)*n);for(p=0;s[p]<d;p++);for(u=s.length;s[u-1]>c;u--);s=s.slice(p,u)}return s},s.tickFormat=function(e,a){if(!arguments.length)return Ts;2>arguments.length?a=Ts:"function"!=typeof a&&(a=yn.format(a));var o=I(1,t*e/s.ticks().length);return function(e){var n=e/l(_(r(e)));return n*t<t-.5&&(n*=t),n<=o?a(e):""}},s.copy=function(){return _i(e.copy(),t,a,o)},ui(s,e)}function bi(e,t,a){function o(t){return e(r(t))}var r=vi(t),i=vi(1/t);return o.invert=function(t){return i(e.invert(t))},o.domain=function(t){return arguments.length?(e.domain((a=t.map(Number)).map(r)),o):a},o.ticks=function(e){return hi(a,e)},o.tickFormat=function(e,t){return yi(a,e,t)},o.nice=function(e){return o.domain(gi(a,e))},o.exponent=function(n){return arguments.length?(r=vi(t=n),i=vi(1/t),e.domain(a.map(r)),o):t},o.copy=function(){return bi(e.copy(),t,a)},ui(o,e)}function vi(t){return function(e){return 0>e?-S(-e,t):S(e,t)}}function wi(e,t){function a(a){return i[((r.get(a)||("range"===t.t?r.set(a,e.push(a)):NaN))-1)%i.length]}function o(t,a){return yn.range(e.length).map(function(e){return t+a*e})}var r,i,n;return a.domain=function(o){if(!arguments.length)return e;e=[],r=new O;for(var l=-1,s=o.length,n;++l<s;)r.has(n=o[l])||r.set(n,e.push(n));return a[t.t].apply(a,t.a)},a.range=function(e){return arguments.length?(i=e,n=0,t={t:"range",a:arguments},a):i},a.rangePoints=function(r,l){2>arguments.length&&(l=0);var s=r[0],d=r[1],c=2>e.length?(s=(s+d)/2,0):(d-s)/(e.length-1+l);return i=o(s+c*l/2,c),n=0,t={t:"rangePoints",a:arguments},a},a.rangeRoundPoints=function(r,l){2>arguments.length&&(l=0);var s=r[0],d=r[1],c=2>e.length?(s=d=_((s+d)/2),0):0|(d-s)/(e.length-1+l);return i=o(s+_(c*l/2+(d-s-(e.length-1+l)*c)/2),c),n=0,t={t:"rangeRoundPoints",a:arguments},a},a.rangeBands=function(r,l,s){2>arguments.length&&(l=0),3>arguments.length&&(s=l);var d=r[1]<r[0],c=r[d-0],p=r[1-d],u=(p-c)/(e.length-l+2*s);return i=o(c+u*s,u),d&&i.reverse(),n=u*(1-l),t={t:"rangeBands",a:arguments},a},a.rangeRoundBands=function(r,l,s){2>arguments.length&&(l=0),3>arguments.length&&(s=l);var d=r[1]<r[0],c=r[d-0],p=r[1-d],u=P((p-c)/(e.length-l+2*s));return i=o(c+_((p-c-(e.length-l)*u)/2),u),d&&i.reverse(),n=_(u*(1-l)),t={t:"rangeRoundBands",a:arguments},a},a.rangeBand=function(){return n},a.rangeExtent=function(){return ii(t.a[0])},a.copy=function(){return wi(e,t)},a.domain(e)}function ki(e,t){function a(){var a=0,i=t.length;for(r=[];++a<i;)r[a-1]=yn.quantile(e,a/i);return o}function o(e){if(!isNaN(e=+e))return t[yn.bisect(r,e)]}var r;return o.domain=function(t){return arguments.length?(e=t.map(y).filter(v).sort(p),a()):e},o.range=function(e){return arguments.length?(t=e,a()):t},o.quantiles=function(){return r},o.invertExtent=function(a){return a=t.indexOf(a),0>a?[NaN,NaN]:[0<a?r[a-1]:e[0],a<r.length?r[a]:e[e.length-1]]},o.copy=function(){return ki(e,t)},a()}function Ti(e,t,a){function o(t){return a[I(0,A(l,P(n*(t-e))))]}function r(){return n=a.length/(t-e),l=a.length-1,o}var n,l;return o.domain=function(a){return arguments.length?(e=+a[0],t=+a[a.length-1],r()):[e,t]},o.range=function(e){return arguments.length?(a=e,r()):a},o.invertExtent=function(t){return t=a.indexOf(t),t=0>t?NaN:t/n+e,[t,t+1/n]},o.copy=function(){return Ti(e,t,a)},r()}function Ai(e,t){function a(a){if(a<=a)return t[yn.bisect(e,a)]}return a.domain=function(t){return arguments.length?(e=t,a):e},a.range=function(e){return arguments.length?(t=e,a):t},a.invertExtent=function(a){return a=t.indexOf(a),[e[a-1],e[a]]},a.copy=function(){return Ai(e,t)},a}function Si(e){function t(e){return+e}return t.invert=t,t.domain=t.range=function(a){return arguments.length?(e=a.map(t),t):e},t.ticks=function(t){return hi(e,t)},t.tickFormat=function(t,a){return yi(e,t,a)},t.copy=function(){return Si(e)},t}function Ci(){return 0}function Li(e){return e.innerRadius}function Ei(e){return e.outerRadius}function Ii(e){return e.startAngle}function Pi(e){return e.endAngle}function zi(e){return e&&e.padAngle}function Di(e,t,a,o){return 0<(e-a)*t-(t-o)*e?0:1}function Oi(e,t,a,o,i){var n=e[0]-t[0],l=e[1]-t[1],s=(i?o:-o)/f(n*n+l*l),c=s*l,p=-s*n,u=e[0]+c,g=e[1]+p,m=t[0]+c,h=t[1]+p,y=(u+m)/2,x=(g+h)/2,_=m-u,b=h-g,v=_*_+b*b,w=a-o,r=u*h-m*g,k=(0>b?-1:1)*f(I(0,w*w*v-r*r)),d=(r*b-_*k)/v,T=(-r*_-b*k)/v,A=(r*b+_*k)/v,S=(-r*_+b*k)/v,C=d-y,L=T-x,E=A-y,P=S-x;return C*C+L*L>E*E+P*P&&(d=A,T=S),[[d-c,T-p],[d*a/w,T*a/w]]}function Ri(e){function t(t){function s(){c.push("M",i(e(p),l))}for(var c=[],p=[],u=-1,g=t.length,n=$e(a),m=$e(o),h;++u<g;)r.call(this,h=t[u],u)?p.push([+n.call(this,h,u),+m.call(this,h,u)]):p.length&&(s(),p=[]);return p.length&&s(),c.length?c.join(""):null}var a=Ka,o=$a,r=ea,i=Mi,n=i.key,l=.7;return t.x=function(e){return arguments.length?(a=e,t):a},t.y=function(e){return arguments.length?(o=e,t):o},t.defined=function(e){return arguments.length?(r=e,t):r},t.interpolate=function(e){return arguments.length?(n="function"==typeof e?i=e:(i=Ps.get(e)||Mi).key,t):n},t.tension=function(e){return arguments.length?(l=e,t):l},t}function Mi(e){return 1<e.length?e.join("L"):e+"Z"}function ji(e){return e.join("L")+"Z"}function Bi(e){for(var t=0,a=e.length,o=e[0],r=[o[0],",",o[1]];++t<a;)r.push("V",(o=e[t])[1],"H",o[0]);return r.join("")}function Fi(e){for(var t=0,a=e.length,o=e[0],r=[o[0],",",o[1]];++t<a;)r.push("H",(o=e[t])[0],"V",o[1]);return r.join("")}function Ni(e,a){if(1>a.length||e.length!=a.length&&e.length!=a.length+2)return Mi(e);var o=e.length!=a.length,r="",n=e[0],l=e[1],s=a[0],d=s,c=1;if(o&&(r+="Q"+(l[0]-2*s[0]/3)+","+(l[1]-2*s[1]/3)+","+l[0]+","+l[1],n=e[1],c=2),1<a.length){d=a[1],l=e[c],c++,r+="C"+(n[0]+s[0])+","+(n[1]+s[1])+","+(l[0]-d[0])+","+(l[1]-d[1])+","+l[0]+","+l[1];for(var u=2;u<a.length;u++,c++)l=e[c],d=a[u],r+="S"+(l[0]-d[0])+","+(l[1]-d[1])+","+l[0]+","+l[1]}if(o){var g=e[c];r+="Q"+(l[0]+2*d[0]/3)+","+(l[1]+2*d[1]/3)+","+g[0]+","+g[1]}return r}function Vi(e,t){for(var o=[],r=(1-t)/2,a=e[0],l=e[1],s=1,d=e.length,n;++s<d;)n=a,a=l,l=e[s],o.push([r*(l[0]-n[0]),r*(l[1]-n[1])]);return o}function Ui(e){if(3>e.length)return Mi(e);var t=1,a=e.length,o=e[0],r=o[0],n=o[1],l=[r,r,r,(o=e[1])[0]],s=[n,n,n,o[1]],d=[r,",",n,"L",Hi(Os,l),",",Hi(Os,s)];for(e.push(e[a-1]);++t<=a;)o=e[t],l.shift(),l.push(o[0]),s.shift(),s.push(o[1]),qi(d,l,s);return e.pop(),d.push("L",o),d.join("")}function Hi(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function qi(e,t,a){e.push("C",Hi(zs,t),",",Hi(zs,a),",",Hi(Ds,t),",",Hi(Ds,a),",",Hi(Os,t),",",Hi(Os,a))}function Gi(e,t){return(t[1]-e[1])/(t[0]-e[0])}function Yi(e){for(var t=0,a=e.length-1,o=[],r=e[0],n=e[1],l=o[0]=Gi(r,n);++t<a;)o[t]=(l+(l=Gi(r=n,n=e[t+1])))/2;return o[t]=l,o}function Wi(e){for(var t=[],o=Yi(e),r=-1,n=e.length-1,l,c,p,u;++r<n;)l=Gi(e[r],e[r+1]),Tn(l)<Bn?o[r]=o[r+1]=0:(c=o[r]/l,p=o[r+1]/l,u=c*c+p*p,9<u&&(u=3*l/f(u),o[r]=u*c,o[r+1]=u*p));for(r=-1;++r<=n;)u=(e[A(n,r+1)][0]-e[I(0,r-1)][0])/(6*(1+o[r]*o[r])),t.push([u||0,o[r]*u||0]);return t}function Xi(e){for(var t=-1,o=e.length,n,l,s;++t<o;)n=e[t],l=n[0],s=n[1]-m,n[0]=l*g(s),n[1]=l*T(s);return e}function Zi(e){function t(t){function c(){g.push("M",d(e(h),i),u,p(e(m.reverse()),i),"Z")}for(var g=[],m=[],h=[],f=-1,_=t.length,n=$e(a),b=$e(r),v=a===o?function(){return T}:$e(o),w=r===l?function(){return A}:$e(l),k,T,A;++f<_;)s.call(this,k=t[f],f)?(m.push([T=+n.call(this,k,f),A=+b.call(this,k,f)]),h.push([+v.call(this,k,f),+w.call(this,k,f)])):m.length&&(c(),m=[],h=[]);return m.length&&c(),g.length?g.join(""):null}var a=Ka,o=Ka,r=0,l=$a,s=ea,d=Mi,c=d.key,p=d,u="L",i=.7;return t.x=function(e){return arguments.length?(a=o=e,t):o},t.x0=function(e){return arguments.length?(a=e,t):a},t.x1=function(e){return arguments.length?(o=e,t):o},t.y=function(e){return arguments.length?(r=l=e,t):l},t.y0=function(e){return arguments.length?(r=e,t):r},t.y1=function(e){return arguments.length?(l=e,t):l},t.defined=function(e){return arguments.length?(s=e,t):s},t.interpolate=function(e){return arguments.length?(c="function"==typeof e?d=e:(d=Ps.get(e)||Mi).key,p=d.reverse||d,u=d.closed?"M":"L",t):c},t.tension=function(e){return arguments.length?(i=e,t):i},t}function Ki(e){return e.radius}function $i(e){return[e.x,e.y]}function Ji(e){return function(){var t=e.apply(this,arguments),o=t[0],r=t[1]-m;return[o*g(r),o*T(r)]}}function Qi(){return 64}function en(){return"circle"}function tn(e){var t=f(e/Nn);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}function an(e){return function(){var t,a,o;(t=this[e])&&(o=t[a=t.active])&&(o.timer.c=null,o.timer.t=NaN,--t.count?delete t[a]:delete this[e],t.active+=.5,o.event&&o.event.interrupt.call(this,this.__data__,o.index))}}function on(e,t,a){return Cn(e,Fs),e.namespace=t,e.id=a,e}function rn(e,t,a,o){var r=e.id,n=e.namespace;return me(e,"function"==typeof a?function(e,l,i){e[n][r].tween.set(t,o(a.call(e,e.__data__,l,i)))}:(a=o(a),function(e){e[n][r].tween.set(t,a)}))}function nn(e){return null==e&&(e=""),function(){this.textContent=e}}function ln(e){return null==e?"__transition__":"__transition_"+e+"__"}function sn(a,o,r,i,e){function t(e){var t=d.delay;return p.t=t+c,t<=e?n(e-t):void(p.c=n)}function n(e){var t=s.active,r=s[t];for(var n in r&&(r.timer.c=null,r.timer.t=NaN,--s.count,delete s[t],r.event&&r.event.interrupt.call(a,a.__data__,r.index)),s)if(+n<i){var h=s[n];h.timer.c=null,h.timer.t=NaN,--s.count,delete s[n]}p.c=l,at(function(){return p.c&&l(e||1)&&(p.c=null,p.t=NaN),1},0,c),s.active=i,d.event&&d.event.start.call(a,a.__data__,o),m=[],d.tween.forEach(function(e,t){(t=t.call(a,a.__data__,o))&&m.push(t)}),g=d.ease,u=d.duration}function l(l){for(var c=l/u,t=g(c),e=m.length;0<e;)m[--e].call(a,t);if(1<=c)return d.event&&d.event.end.call(a,a.__data__,o),--s.count?delete s[i]:delete a[r],1}var s=a[r]||(a[r]={active:0,count:0}),d=s[i],c,p,u,g,m;d||(c=e.time,p=at(t,0,c),d=s[i]={tween:new O,time:c,timer:p,delay:e.delay,duration:e.duration,ease:e.ease,index:o},e=null,++s.count)}function dn(e,t,a){e.attr("transform",function(e){var o=t(e);return"translate("+(isFinite(o)?o:a(e))+",0)"})}function cn(e,t,a){e.attr("transform",function(e){var o=t(e);return"translate(0,"+(isFinite(o)?o:a(e))+")"})}function pn(e){return e.toISOString()}function un(e,t,a){function o(t){return e(t)}function r(e,a){var o=e[1]-e[0],r=o/a,n=yn.bisect(Ks,r);return n==Ks.length?[t.year,mi(e.map(function(e){return e/31536e6}),a)[2]]:n?t[r/Ks[n-1]<Ks[n]/r?n-1:n]:[Qs,mi(e,a)[2]]}return o.invert=function(t){return gn(e.invert(t))},o.domain=function(t){return arguments.length?(e.domain(t),o):e.domain().map(gn)},o.nice=function(e,t){function a(a){return!isNaN(a)&&!e.range(a,gn(+a+1),t).length}var i=o.domain(),n=ii(i),l=null==e?r(n,10):"number"==typeof e&&r(n,e);return l&&(e=l[0],t=l[1]),o.domain(si(i,1<t?{floor:function(t){for(;a(t=e.floor(t));)t=gn(t-1);return t},ceil:function(t){for(;a(t=e.ceil(t));)t=gn(+t+1);return t}}:e))},o.ticks=function(e,t){var a=ii(o.domain()),i=null==e?r(a,10):"number"==typeof e?r(a,e):!e.range&&[{range:e},t];return i&&(e=i[0],t=i[1]),e.range(a[0],gn(+a[1]+1),1>t?1:t)},o.tickFormat=function(){return a},o.copy=function(){return un(e.copy(),t,a)},ui(o,e)}function gn(e){return new Date(e)}function mn(e){return JSON.parse(e.responseText)}function hn(e){var t=fn.createRange();return t.selectNode(fn.body),t.createContextualFragment(e.responseText)}var yn={version:"3.5.17"},x=[].slice,dt=function(e){return x.call(e)},fn=this.document;if(fn)try{dt(fn.documentElement.childNodes)[0].nodeType}catch(t){dt=function(e){for(var t=e.length,a=Array(t);t--;)a[t]=e[t];return a}}if(Date.now||(Date.now=function(){return+new Date}),fn)try{fn.createElement("DIV").style.setProperty("opacity",0,"")}catch(e){var xn=this.Element.prototype,_n=xn.setAttribute,bn=xn.setAttributeNS,vn=this.CSSStyleDeclaration.prototype,wn=vn.setProperty;xn.setAttribute=function(e,t){_n.call(this,e,t+"")},xn.setAttributeNS=function(e,t,a){bn.call(this,e,t,a+"")},vn.setProperty=function(e,t,a){wn.call(this,e,t+"",a)}}yn.ascending=p,yn.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},yn.min=function(e,t){var o=-1,r=e.length,n,l;if(1===arguments.length){for(;++o<r;)if(null!=(l=e[o])&&l>=l){n=l;break}for(;++o<r;)null!=(l=e[o])&&n>l&&(n=l)}else{for(;++o<r;)if(null!=(l=t.call(e,e[o],o))&&l>=l){n=l;break}for(;++o<r;)null!=(l=t.call(e,e[o],o))&&n>l&&(n=l)}return n},yn.max=function(e,t){var o=-1,r=e.length,n,l;if(1===arguments.length){for(;++o<r;)if(null!=(l=e[o])&&l>=l){n=l;break}for(;++o<r;)null!=(l=e[o])&&l>n&&(n=l)}else{for(;++o<r;)if(null!=(l=t.call(e,e[o],o))&&l>=l){n=l;break}for(;++o<r;)null!=(l=t.call(e,e[o],o))&&l>n&&(n=l)}return n},yn.extent=function(e,t){var o=-1,r=e.length,n,l,s;if(1===arguments.length){for(;++o<r;)if(null!=(l=e[o])&&l>=l){n=s=l;break}for(;++o<r;)null!=(l=e[o])&&(n>l&&(n=l),s<l&&(s=l))}else{for(;++o<r;)if(null!=(l=t.call(e,e[o],o))&&l>=l){n=s=l;break}for(;++o<r;)null!=(l=t.call(e,e[o],o))&&(n>l&&(n=l),s<l&&(s=l))}return[n,s]},yn.sum=function(e,t){var o=0,r=e.length,n=-1,l;if(1===arguments.length)for(;++n<r;)v(l=+e[n])&&(o+=l);else for(;++n<r;)v(l=+t.call(e,e[n],n))&&(o+=l);return o},yn.mean=function(e,t){var o=0,r=e.length,n=-1,l=r,d;if(1===arguments.length)for(;++n<r;)v(d=y(e[n]))?o+=d:--l;else for(;++n<r;)v(d=y(t.call(e,e[n],n)))?o+=d:--l;return l?o/l:void 0},yn.quantile=function(t,a){var o=(t.length-1)*a+1,r=P(o),i=+t[r-1],n=o-r;return n?i+n*(t[r]-i):i},yn.median=function(e,t){var o=[],r=e.length,n=-1,l;if(1===arguments.length)for(;++n<r;)v(l=y(e[n]))&&o.push(l);else for(;++n<r;)v(l=y(t.call(e,e[n],n)))&&o.push(l);return o.length?yn.quantile(o.sort(p),.5):void 0},yn.variance=function(e,t){var o=e.length,r=0,n=0,l=-1,c=0,p,u;if(1===arguments.length)for(;++l<o;)v(p=y(e[l]))&&(u=p-r,r+=u/++c,n+=u*(p-r));else for(;++l<o;)v(p=y(t.call(e,e[l],l)))&&(u=p-r,r+=u/++c,n+=u*(p-r));return 1<c?n/(c-1):void 0},yn.deviation=function(){var e=yn.variance.apply(this,arguments);return e?f(e):e};var kn=w(p);yn.bisectLeft=kn.left,yn.bisect=yn.bisectRight=kn.right,yn.bisector=function(e){return w(1===e.length?function(t,a){return p(e(t),a)}:e)},yn.shuffle=function(e,a,o){3>(r=arguments.length)&&(o=e.length,2>r&&(a=0));for(var r=o-a,n,l;r;)l=0|Math.random()*r--,n=e[r+a],e[r+a]=e[l+a],e[l+a]=n;return e},yn.permute=function(e,t){for(var a=t.length,o=Array(a);a--;)o[a]=e[t[a]];return o},yn.pairs=function(e){for(var t=0,a=e.length-1,o=e[0],r=Array(0>a?0:a),n;t<a;)r[t]=[n=o,o=e[++t]];return r},yn.transpose=function(e){if(!(s=e.length))return[];for(var t=-1,a=yn.min(e,k),o=Array(a);++t<a;)for(var r=-1,l=o[t]=Array(s),s;++r<s;)l[r]=e[r][t];return o},yn.zip=function(){return yn.transpose(arguments)},yn.keys=function(e){var t=[];for(var a in e)t.push(a);return t},yn.values=function(e){var t=[];for(var a in e)t.push(e[a]);return t},yn.entries=function(e){var t=[];for(var a in e)t.push({key:a,value:e[a]});return t},yn.merge=function(e){for(var t=e.length,a=-1,o=0,r,l,s;++a<t;)o+=e[a].length;for(l=Array(o);0<=--t;)for(s=e[t],r=s.length;0<=--r;)l[--o]=s[r];return l};var Tn=E;yn.range=function(e,t,a){if(3>arguments.length&&(a=1,2>arguments.length&&(t=e,e=0)),(t-e)/a==1/0)throw new Error("infinite range");var o=[],r=z(Tn(a)),n=-1,l;if(e*=r,t*=r,a*=r,0>a)for(;(l=e+a*++n)>t;)o.push(l/r);else for(;(l=e+a*++n)<t;)o.push(l/r);return o},yn.map=function(e,t){var a=new O;if(e instanceof O)e.forEach(function(e,t){a.set(e,t)});else if(Array.isArray(e)){var r=-1,l=e.length,n;if(1===arguments.length)for(;++r<l;)a.set(r,e[r]);else for(;++r<l;)a.set(t.call(e,n=e[r],r),n)}else for(var s in e)a.set(s,e[s]);return a};D(O,{has:j,get:function(e){return this._[R(e)]},set:function(e,t){return this._[R(e)]=t},remove:B,keys:F,values:function(){var e=[];for(var t in this._)e.push(this._[t]);return e},entries:function(){var e=[];for(var t in this._)e.push({key:M(t),value:this._[t]});return e},size:N,empty:V,forEach:function(e){for(var t in this._)e.call(this,M(t),this._[t])}}),yn.nest=function(){function e(t,r,d){if(d>=o.length)return s?s.call(a,r):l?r.sort(l):r;for(var c=-1,p=r.length,n=o[d++],u=new O,g,m,h,y;++c<p;)(y=u.get(g=n(m=r[c])))?y.push(m):u.set(g,[m]);return t?(m=t(),h=function(a,o){m.set(a,e(t,o,d))}):(m={},h=function(a,o){m[a]=e(t,o,d)}),u.forEach(h),m}function t(e,a){if(a>=o.length)return e;var i=[],n=r[a++];return e.forEach(function(e,o){i.push({key:e,values:t(o,a)})}),n?i.sort(function(e,t){return n(e.key,t.key)}):i}var a={},o=[],r=[],l,s;return a.map=function(t,a){return e(a,t,0)},a.entries=function(a){return t(e(yn.map,a,0),0)},a.key=function(e){return o.push(e),a},a.sortKeys=function(e){return r[o.length-1]=e,a},a.sortValues=function(e){return l=e,a},a.rollup=function(e){return s=e,a},a},yn.set=function(e){var t=new U;if(e)for(var a=0,o=e.length;a<o;++a)t.add(e[a]);return t},D(U,{has:j,add:function(e){return this._[R(e+="")]=!0,e},remove:B,values:F,size:N,empty:V,forEach:function(e){for(var t in this._)e.call(this,M(t))}}),yn.behavior={},yn.rebind=function(e,t){for(var a=1,o=arguments.length,r;++a<o;)e[r=arguments[a]]=q(e,t,t[r]);return e};var An=["webkit","ms","moz","Moz","o","O"];yn.dispatch=function(){for(var e=new W,t=-1,a=arguments.length;++t<a;)e[arguments[t]]=X(e);return e},W.prototype.on=function(e,t){var a=e.indexOf("."),o="";if(0<=a&&(o=e.slice(a+1),e=e.slice(0,a)),e)return 2>arguments.length?this[e].on(o):this[e].on(o,t);if(2===arguments.length){if(null==t)for(e in this)this.hasOwnProperty(e)&&this[e].on(o,null);return this}},yn.event=null,yn.requote=function(e){return e.replace(Sn,"\\$&")};var Sn=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,Cn={}.__proto__?function(e,t){e.__proto__=t}:function(e,t){for(var a in t)e[a]=t[a]},Ln=function(e,t){return t.querySelector(e)},En=function(e,t){return t.querySelectorAll(e)},In=function(e,t){var a=e.matches||e[G(e,"matchesSelector")];return In=function(e,t){return a.call(e,t)},In(e,t)};"function"==typeof Sizzle&&(Ln=function(e,t){return Sizzle(e,t)[0]||null},En=Sizzle,In=Sizzle.matchesSelector),yn.selection=function(){return yn.select(fn.documentElement)};var Pn=yn.selection.prototype=[];Pn.select=function(e){var t=[],a,o,r,l;e=Q(e);for(var s=-1,d=this.length;++s<d;){t.push(a=[]),a.parentNode=(r=this[s]).parentNode;for(var c=-1,p=r.length;++c<p;)(l=r[c])?(a.push(o=e.call(l,l.__data__,c,s)),o&&"__data__"in l&&(o.__data__=l.__data__)):a.push(null)}return J(t)},Pn.selectAll=function(e){var t=[],a,o;e=ee(e);for(var r=-1,l=this.length;++r<l;)for(var s=this[r],d=-1,c=s.length;++d<c;)(o=s[d])&&(t.push(a=dt(e.call(o,o.__data__,d,r))),a.parentNode=o);return J(t)};var zn={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};yn.ns={prefix:zn,qualify:function(e){var t=e.indexOf(":"),a=e;return 0<=t&&"xmlns"!==(a=e.slice(0,t))&&(e=e.slice(t+1)),zn.hasOwnProperty(a)?{space:zn[a],local:e}:e}},Pn.attr=function(e,t){if(2>arguments.length){if("string"==typeof e){var a=this.node();return e=yn.ns.qualify(e),e.local?a.getAttributeNS(e.space,e.local):a.getAttribute(e)}for(t in e)this.each(te(t,e[t]));return this}return this.each(te(e,t))},Pn.classed=function(e,t){if(2>arguments.length){if("string"==typeof e){var a=this.node(),o=(e=re(e)).length,r=-1;if(t=a.classList){for(;++r<o;)if(!t.contains(e[r]))return!1;}else for(t=a.getAttribute("class");++r<o;)if(!oe(e[r]).test(t))return!1;return!0}for(t in e)this.each(ie(t,e[t]));return this}return this.each(ie(e,t))},Pn.style=function(e,t,a){var o=arguments.length;if(3>o){if("string"!=typeof e){for(a in 2>o&&(t=""),e)this.each(le(a,e[a],t));return this}if(2>o){var r=this.node();return l(r).getComputedStyle(r,null).getPropertyValue(e)}a=""}return this.each(le(e,t,a))},Pn.property=function(e,t){if(2>arguments.length){if("string"==typeof e)return this.node()[e];for(t in e)this.each(se(t,e[t]));return this}return this.each(se(e,t))},Pn.text=function(e){return arguments.length?this.each("function"==typeof e?function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}:null==e?function(){this.textContent=""}:function(){this.textContent=e}):this.node().textContent},Pn.html=function(e){return arguments.length?this.each("function"==typeof e?function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}:null==e?function(){this.innerHTML=""}:function(){this.innerHTML=e}):this.node().innerHTML},Pn.append=function(e){return e=de(e),this.select(function(){return this.appendChild(e.apply(this,arguments))})},Pn.insert=function(e,t){return e=de(e),t=Q(t),this.select(function(){return this.insertBefore(e.apply(this,arguments),t.apply(this,arguments)||null)})},Pn.remove=function(){return this.each(ce)},Pn.data=function(e,t){function a(e,a){var o=e.length,r=a.length,n=A(o,r),l=Array(r),s=Array(r),u=Array(o),g,m,h;if(t){var y=new O,f=Array(o),x;for(g=-1;++g<o;)(m=e[g])&&(y.has(x=t.call(m,m.__data__,g))?u[g]=m:y.set(x,m),f[g]=x);for(g=-1;++g<r;)(m=y.get(x=t.call(a,h=a[g],g)))?!0!==m&&(l[g]=m,m.__data__=h):s[g]=pe(h),y.set(x,!0);for(g=-1;++g<o;)g in f&&!0!==y.get(f[g])&&(u[g]=e[g])}else{for(g=-1;++g<n;)m=e[g],h=a[g],m?(m.__data__=h,l[g]=m):s[g]=pe(h);for(;g<r;++g)s[g]=pe(a[g]);for(;g<o;++g)u[g]=e[g]}s.update=l,s.parentNode=l.parentNode=u.parentNode=e.parentNode,d.push(s),c.push(l),p.push(u)}var o=-1,r=this.length,l,s;if(!arguments.length){for(e=Array(r=(l=this[0]).length);++o<r;)(s=l[o])&&(e[o]=s.__data__);return e}var d=he([]),c=J([]),p=J([]);if("function"==typeof e)for(;++o<r;)a(l=this[o],e.call(l,l.parentNode.__data__,o));else for(;++o<r;)a(l=this[o],e);return c.enter=function(){return d},c.exit=function(){return p},c},Pn.datum=function(e){return arguments.length?this.property("__data__",e):this.property("__data__")},Pn.filter=function(e){var t=[],a,o,r;"function"!=typeof e&&(e=ue(e));for(var l=0,s=this.length;l<s;l++){t.push(a=[]),a.parentNode=(o=this[l]).parentNode;for(var d=0,c=o.length;d<c;d++)(r=o[d])&&e.call(r,r.__data__,d,l)&&a.push(r)}return J(t)},Pn.order=function(){for(var e=-1,t=this.length;++e<t;)for(var a=this[e],o=a.length-1,r=a[o],n;0<=--o;)(n=a[o])&&(r&&r!==n.nextSibling&&r.parentNode.insertBefore(n,r),r=n);return this},Pn.sort=function(e){e=ge.apply(this,arguments);for(var t=-1,a=this.length;++t<a;)this[t].sort(e);return this.order()},Pn.each=function(e){return me(this,function(t,a,o){e.call(t,t.__data__,a,o)})},Pn.call=function(e){var t=dt(arguments);return e.apply(t[0]=this,t),this},Pn.empty=function(){return!this.node()},Pn.node=function(){for(var e=0,t=this.length;e<t;e++)for(var a=this[e],o=0,r=a.length,n;o<r;o++)if(n=a[o],n)return n;return null},Pn.size=function(){var e=0;return me(this,function(){++e}),e};var Dn=[];yn.selection.enter=he,yn.selection.enter.prototype=Dn,Dn.append=Pn.append,Dn.empty=Pn.empty,Dn.node=Pn.node,Dn.call=Pn.call,Dn.size=Pn.size,Dn.select=function(e){for(var t=[],a=-1,o=this.length,r,l,s,d,c;++a<o;){s=(d=this[a]).update,t.push(r=[]),r.parentNode=d.parentNode;for(var p=-1,u=d.length;++p<u;)(c=d[p])?(r.push(s[p]=l=e.call(d.parentNode,c.__data__,p,a)),l.__data__=c.__data__):r.push(null)}return J(t)},Dn.insert=function(e,t){return 2>arguments.length&&(t=ye(this)),Pn.insert.call(this,e,t)},yn.select=function(t){var a;return"string"==typeof t?(a=[Ln(t,fn)],a.parentNode=fn.documentElement):(a=[t],a.parentNode=e(t)),J([a])},yn.selectAll=function(e){var t;return"string"==typeof e?(t=dt(En(e,fn)),t.parentNode=fn.documentElement):(t=dt(e),t.parentNode=null),J([t])},Pn.on=function(e,t,a){var o=arguments.length;if(3>o){if("string"!=typeof e){for(a in 2>o&&(t=!1),e)this.each(fe(a,e[a],t));return this}if(2>o)return(o=this.node()["__on"+e])&&o._;a=!1}return this.each(fe(e,t,a))};var On=yn.map({mouseenter:"mouseover",mouseleave:"mouseout"});fn&&On.forEach(function(e){"on"+e in fn&&On.remove(e)});var Rn=0,Mn;yn.mouse=function(e){return ve(e,K())};var jn=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;yn.touch=function(e,t,a){if(3>arguments.length&&(a=t,t=K().changedTouches),t)for(var o=0,r=t.length,n;o<r;++o)if((n=t[o]).identifier===a)return ve(e,n)},yn.behavior.drag=function(){function e(){this.on("mousedown.drag",r).on("touchstart.drag",i)}function t(e,t,r,i,n){return function(){function l(){var e=t(p,m),a,o;e&&(a=e[0]-x[0],o=e[1]-x[1],g|=a|o,x=e,u({type:"drag",x:e[0]+_[0],y:e[1]+_[1],dx:a,dy:o}))}function s(){t(p,m)&&(y.on(i+h,null).on(n+h,null),f(g),u({type:"dragend"}))}var d=this,c=yn.event.target.correspondingElement||yn.event.target,p=d.parentNode,u=a.of(d,arguments),g=0,m=e(),h=".drag"+(null==m?"":"-"+m),y=yn.select(r(c)).on(i+h,l).on(n+h,s),f=be(c),x=t(p,m),_;o?(_=o.apply(d,arguments),_=[_.x-x[0],_.y-x[1]]):_=[0,0],u({type:"dragstart"})}}var a=$(e,"drag","dragstart","dragend"),o=null,r=t(Y,yn.mouse,l,"mousemove","mouseup"),i=t(we,yn.touch,H,"touchmove","touchend");return e.origin=function(t){return arguments.length?(o=t,e):o},yn.rebind(e,a,"on")},yn.touches=function(e,t){return 2>arguments.length&&(t=K().touches),t?dt(t).map(function(t){var a=ve(e,t);return a.identifier=t.identifier,a}):[]};var Bn=1e-6,Fn=Bn*Bn,Nn=b,Vn=2*Nn,m=Nn/2,Un=Nn/180,Hn=180/Nn,qn=i,Gn=2,Yn=4;yn.interpolateZoom=function(e,t){var a=e[0],o=e[1],r=e[2],l=t[0],s=t[1],d=t[2],c=l-a,p=s-o,g=c*c+p*p,m,h;if(g<Fn)h=u(d/r)/qn,m=function(e){return[a+e*c,o+e*p,r*n(qn*e*h)]};else{var y=f(g),x=(d*d-r*r+Yn*g)/(2*r*Gn*y),_=(d*d-r*r-Yn*g)/(2*d*Gn*y),b=u(f(x*x+1)-x),v=u(f(_*_+1)-_);h=(v-b)/qn,m=function(e){var t=e*h,i=Le(b),n=r/(Gn*y)*(i*Ee(qn*t+b)-Ce(b));return[a+n*c,o+n*p,r*i/Le(qn*t+b)]}}return m.duration=1e3*h,m},yn.behavior.zoom=function(){function e(e){e.on("mousedown.zoom",x).on(Zn+".zoom",b).on("dblclick.zoom",v).on("touchstart.zoom",_)}function a(e){return[(e[0]-w.x)/w.k,(e[1]-w.y)/w.k]}function o(e){return[e[0]*w.k+w.x,e[1]*w.k+w.y]}function r(e){w.k=I(T[0],A(T[1],e))}function s(e,t){t=o(t),w.x+=e[0]-t[0],w.y+=e[1]-t[1]}function c(t,a,o,i){t.__chart__={x:w.x,y:w.y,k:w.k},r(S(2,i)),s(D=a,o),t=yn.select(t),0<C&&(t=t.transition().duration(C)),t.call(e.event)}function p(){t&&t.domain(j.range().map(function(e){return(e-w.x)/w.k}).map(j.invert)),n&&n.domain(i.range().map(function(e){return(e-w.y)/w.k}).map(i.invert))}function g(e){L++||e({type:"zoomstart"})}function m(e){p(),e({type:"zoom",scale:w.k,translate:[w.x,w.y]})}function y(e){--L||(e({type:"zoomend"}),D=null)}function x(){function e(){i.on("mousemove.zoom",null).on("mouseup.zoom",null),d(r),y(o)}var t=this,o=E.of(t,arguments),r=0,i=yn.select(l(t)).on("mousemove.zoom",function(){r=1,s(yn.mouse(t),n),m(o)}).on("mouseup.zoom",e),n=a(yn.mouse(t)),d=be(t);Bs.call(t),g(o)}function _(){function e(){var e=yn.touches(h);return z=w.k,e.forEach(function(e){e.identifier in v&&(v[e.identifier]=a(e))}),e}function t(){var t=yn.event.target;yn.select(t).on(A,o).on(S,l),C.push(t);for(var a=yn.event.changedTouches,r=0,s=a.length;r<s;++r)v[a[r].identifier]=null;var n=e(),g=Date.now();if(1===n.length){if(500>g-M){var m=n[0];c(h,m,v[m.identifier],P(u(w.k)/d)+1),Z()}M=g}else if(1<n.length){var m=n[0],y=n[1],f=m[0]-y[0],x=m[1]-y[1];k=f*f+x*x}}function o(){var e=yn.touches(h),t,a,o,l;Bs.call(h);for(var d=0,c=e.length;d<c;++d,l=null)if(o=e[d],l=v[o.identifier]){if(a)break;t=o,a=l}if(l){var n=(n=o[0]-t[0])*n+(n=o[1]-t[1])*n,p=k&&f(n/k);t=[(t[0]+o[0])/2,(t[1]+o[1])/2],a=[(a[0]+l[0])/2,(a[1]+l[1])/2],r(p*z)}M=null,s(t,a),m(b)}function l(){if(yn.event.touches.length){for(var t=yn.event.changedTouches,a=0,o=t.length;a<o;++a)delete v[t[a].identifier];for(var r in v)return void e()}yn.selectAll(C).on(T,null),L.on("mousedown.zoom",x).on("touchstart.zoom",_),I(),y(b)}var h=this,b=E.of(h,arguments),v={},k=0,T=".zoom-"+yn.event.changedTouches[0].identifier,A="touchmove"+T,S="touchend"+T,C=[],L=yn.select(h),I=be(h),z;t(),g(b),L.on("mousedown.zoom",null).on("touchstart.zoom",t)}function b(){var e=E.of(this,arguments);R?clearTimeout(R):(Bs.call(this),z=a(D=O||yn.mouse(this)),g(e)),R=setTimeout(function(){R=null,y(e)},50),Z(),r(S(2,.002*Xn())*w.k),s(D,z),m(e)}function v(){var e=yn.mouse(this),t=u(w.k)/d;c(this,e,a(e),yn.event.shiftKey?h(t)-1:P(t)+1)}var w={x:0,y:0,k:1},k=[960,500],T=Wn,C=250,L=0,E=$(e,"zoomstart","zoom","zoomend"),z,D,O,R,M,j,t,i,n;return Zn||(Zn="onwheel"in fn?(Xn=function(){return-yn.event.deltaY*(yn.event.deltaMode?120:1)},"wheel"):"onmousewheel"in fn?(Xn=function(){return yn.event.wheelDelta},"mousewheel"):(Xn=function(){return-yn.event.detail},"MozMousePixelScroll")),e.event=function(e){e.each(function(){var e=E.of(this,arguments),t=w;Vs?yn.select(this).transition().each("start.zoom",function(){w=this.__chart__||{x:0,y:0,k:1},g(e)}).tween("zoom:zoom",function(){var a=k[0],o=k[1],r=D?D[0]:a/2,n=D?D[1]:o/2,s=yn.interpolateZoom([(r-w.x)/w.k,(n-w.y)/w.k,a/w.k],[(r-t.x)/t.k,(n-t.y)/t.k,a/t.k]);return function(o){var t=s(o),i=a/t[2];this.__chart__=w={x:r-t[0]*i,y:n-t[1]*i,k:i},m(e)}}).each("interrupt.zoom",function(){y(e)}).each("end.zoom",function(){y(e)}):(this.__chart__=w,g(e),m(e),y(e))})},e.translate=function(t){return arguments.length?(w={x:+t[0],y:+t[1],k:w.k},p(),e):[w.x,w.y]},e.scale=function(t){return arguments.length?(w={x:w.x,y:w.y,k:null},r(+t),p(),e):w.k},e.scaleExtent=function(t){return arguments.length?(T=null==t?Wn:[+t[0],+t[1]],e):T},e.center=function(t){return arguments.length?(O=t&&[+t[0],+t[1]],e):O},e.size=function(t){return arguments.length?(k=t&&[+t[0],+t[1]],e):k},e.duration=function(t){return arguments.length?(C=+t,e):C},e.x=function(a){return arguments.length?(t=a,j=a.copy(),w={x:0,y:0,k:1},e):t},e.y=function(t){return arguments.length?(n=t,i=t.copy(),w={x:0,y:0,k:1},e):n},yn.rebind(e,E,"on")};var Wn=[0,1/0],Xn,Zn;yn.color=Pe,Pe.prototype.toString=function(){return this.rgb()+""},yn.hsl=ze;var Kn=ze.prototype=new Pe;Kn.brighter=function(e){return e=S(.7,arguments.length?e:1),new ze(this.h,this.s,this.l/e)},Kn.darker=function(e){return e=S(.7,arguments.length?e:1),new ze(this.h,this.s,e*this.l)},Kn.rgb=function(){return De(this.h,this.s,this.l)},yn.hcl=Oe;var $n=Oe.prototype=new Pe;$n.brighter=function(e){return new Oe(this.h,this.c,A(100,this.l+Jn*(arguments.length?e:1)))},$n.darker=function(e){return new Oe(this.h,this.c,I(0,this.l-Jn*(arguments.length?e:1)))},$n.rgb=function(){return Re(this.h,this.c,this.l).rgb()},yn.lab=Me;var Jn=18,Qn=.95047,el=1.08883,tl=Me.prototype=new Pe;tl.brighter=function(e){return new Me(A(100,this.l+18*(arguments.length?e:1)),this.a,this.b)},tl.darker=function(e){return new Me(I(0,this.l-18*(arguments.length?e:1)),this.a,this.b)},tl.rgb=function(){return je(this.l,this.a,this.b)},yn.rgb=Ue;var al=Ue.prototype=new Pe;al.brighter=function(e){e=S(.7,arguments.length?e:1);var t=this.r,a=this.g,o=this.b;return t||a||o?(t&&30>t&&(t=30),a&&30>a&&(a=30),o&&30>o&&(o=30),new Ue(A(255,t/e),A(255,a/e),A(255,o/e))):new Ue(30,30,30)},al.darker=function(e){return e=S(.7,arguments.length?e:1),new Ue(e*this.r,e*this.g,e*this.b)},al.hsl=function(){return We(this.r,this.g,this.b)},al.toString=function(){return"#"+Ge(this.r)+Ge(this.g)+Ge(this.b)};var ol=yn.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});ol.forEach(function(e,t){ol.set(e,He(t))}),yn.functor=$e,yn.xhr=Je(H),yn.dsv=function(e,t){function a(e,a,i){3>arguments.length&&(i=a,a=null);var n=Qe(e,t,null==a?o:r(a),i);return n.row=function(e){return arguments.length?n.response(null==(a=e)?o:r(e)):a},n}function o(e){return a.parse(e.responseText)}function r(e){return function(t){return a.parse(t.responseText,e)}}function i(t){return t.map(n).join(e)}function n(e){return l.test(e)?"\""+e.replace(/\"/g,"\"\"")+"\"":e}var l=new RegExp("[\""+e+"\n]"),s=e.charCodeAt(0);return a.parse=function(e,t){var r;return a.parseRows(e,function(e,o){if(r)return r(e,o-1);var n=new Function("d","return {"+e.map(function(e,t){return JSON.stringify(e)+": d["+t+"]"}).join(",")+"}");r=t?function(e,a){return t(n(e),a)}:n})},a.parseRows=function(e,o){function r(){if(u>=p)return d;if(m)return m=!1,l;var t=u;if(34===e.charCodeAt(t)){for(var a=t;a++<p;)if(34===e.charCodeAt(a)){if(34!==e.charCodeAt(a+1))break;++a}u=a+2;var o=e.charCodeAt(a+1);return 13===o?(m=!0,10===e.charCodeAt(a+2)&&++u):10===o&&(m=!0),e.slice(t+1,a).replace(/""/g,"\"")}for(;u<p;){var o=e.charCodeAt(u++),r=1;if(10===o)m=!0;else if(13===o)m=!0,10===e.charCodeAt(u)&&(++u,++r);else if(o!==s)continue;return e.slice(t,u-r)}return e.slice(t)}for(var l={},d={},c=[],p=e.length,u=0,i=0,g,m;(g=r())!==d;){for(var h=[];g!==l&&g!==d;)h.push(g),g=r();o&&null==(h=o(h,i++))||c.push(h)}return c},a.format=function(t){if(Array.isArray(t[0]))return a.formatRows(t);var o=new U,r=[];return t.forEach(function(e){for(var t in e)o.has(t)||r.push(o.add(t))}),[r.map(n).join(e)].concat(t.map(function(t){return r.map(function(e){return n(t[e])}).join(e)})).join("\n")},a.formatRows=function(e){return e.map(i).join("\n")},a},yn.csv=yn.dsv(",","text/csv"),yn.tsv=yn.dsv("\t","text/tab-separated-values");var rl=this[G(this,"requestAnimationFrame")]||function(e){setTimeout(e,17)},il,nl,ll,sl;yn.timer=function(){at.apply(this,arguments)},yn.timer.flush=function(){rt(),it()},yn.round=function(e,t){return t?_(e*(t=S(10,t)))/t:_(e)};var dl=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"].map(function(e,t){var a=S(10,3*Tn(8-t));return{scale:8<t?function(e){return e/a}:function(e){return e*a},symbol:e}});yn.formatPrefix=function(e,t){var a=0;return(e=+e)&&(0>e&&(e*=-1),t&&(e=yn.round(e,nt(e,t))),a=1+P(1e-12+u(e)/c),a=I(-24,A(24,3*P((a-1)/3)))),dl[8+a/3]};var cl=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,pl=yn.map({b:function(e){return e.toString(2)},c:function(e){return a(e)},o:function(e){return e.toString(8)},x:function(e){return e.toString(16)},X:function(e){return e.toString(16).toUpperCase()},g:function(e,t){return e.toPrecision(t)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},r:function(e,t){return(e=yn.round(e,nt(e,t))).toFixed(I(0,A(20,nt(e*(1+1e-15),t))))}}),ul=yn.time={},ml=Date;ct.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){hl.setUTCDate.apply(this._,arguments)},setDay:function(){hl.setUTCDay.apply(this._,arguments)},setFullYear:function(){hl.setUTCFullYear.apply(this._,arguments)},setHours:function(){hl.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){hl.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){hl.setUTCMinutes.apply(this._,arguments)},setMonth:function(){hl.setUTCMonth.apply(this._,arguments)},setSeconds:function(){hl.setUTCSeconds.apply(this._,arguments)},setTime:function(){hl.setTime.apply(this._,arguments)}};var hl=Date.prototype;ul.year=pt(function(e){return e=ul.day(e),e.setMonth(0,1),e},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e){return e.getFullYear()}),ul.years=ul.year.range,ul.years.utc=ul.year.utc.range,ul.day=pt(function(e){var t=new ml(2e3,0);return t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t},function(e,t){e.setDate(e.getDate()+t)},function(e){return e.getDate()-1}),ul.days=ul.day.range,ul.days.utc=ul.day.utc.range,ul.dayOfYear=function(e){var t=ul.year(e);return P((e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(e,t){t=7-t;var a=ul[e]=pt(function(e){return(e=ul.day(e)).setDate(e.getDate()-(e.getDay()+t)%7),e},function(e,t){e.setDate(e.getDate()+7*P(t))},function(e){var a=ul.year(e).getDay();return P((ul.dayOfYear(e)+(a+t)%7)/7)-(a!==t)});ul[e+"s"]=a.range,ul[e+"s"].utc=a.utc.range,ul[e+"OfYear"]=function(e){var a=ul.year(e).getDay();return P((ul.dayOfYear(e)+(a+t)%7)/7)}}),ul.week=ul.sunday,ul.weeks=ul.sunday.range,ul.weeks.utc=ul.sunday.utc.range,ul.weekOfYear=ul.sundayOfYear;var yl={"-":"",_:" ",0:"0"},fl=/^\s*\d+/,xl=/^%/;yn.locale=function(e){return{numberFormat:lt(e),timeFormat:gt(e)}};var _l=yn.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});yn.format=_l.numberFormat,yn.geo={},Ot.prototype={s:0,t:0,add:function(e){Rt(e,this.t,bl),Rt(bl.s,this.s,this),this.s?this.t+=bl.t:this.s=bl.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var bl=new Ot;yn.geo.stream=function(e,t){e&&vl.hasOwnProperty(e.type)?vl[e.type](e,t):Mt(e,t)};var vl={Feature:function(e,t){Mt(e.geometry,t)},FeatureCollection:function(e,t){for(var a=e.features,o=-1,r=a.length;++o<r;)Mt(a[o].geometry,t)}},wl={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var a=e.coordinates,o=-1,r=a.length;++o<r;)e=a[o],t.point(e[0],e[1],e[2])},LineString:function(e,t){jt(e.coordinates,t,0)},MultiLineString:function(e,t){for(var a=e.coordinates,o=-1,r=a.length;++o<r;)jt(a[o],t,0)},Polygon:function(e,t){Bt(e.coordinates,t)},MultiPolygon:function(e,t){for(var a=e.coordinates,o=-1,r=a.length;++o<r;)Bt(a[o],t)},GeometryCollection:function(e,t){for(var a=e.geometries,o=-1,r=a.length;++o<r;)Mt(a[o],t)}};yn.geo.area=function(e){return Al=0,yn.geo.stream(e,Tl),Al};var kl=new Ot,Tl={sphere:function(){Al+=4*Nn},point:Y,lineStart:Y,lineEnd:Y,polygonStart:function(){kl.reset(),Tl.lineStart=Ft},polygonEnd:function(){var e=2*kl;Al+=0>e?4*Nn+e:e,Tl.lineStart=Tl.lineEnd=Tl.point=Y}},Al;yn.geo.bounds=function(){function e(e,t){v.push(w=[u=e,m=e]),t<g&&(g=t),t>h&&(h=t)}function t(t,a){var o=Nt([t*Un,a*Un]);if(x){var r=Ut(x,o),i=[r[1],-r[0],0],n=Ut(i,r);Gt(n),n=Yt(n);var d=t-y,c=0<d?1:-1,s=n[0]*Hn*c,p=180<Tn(d);if(p^(c*y<s&&s<c*t)){var f=n[1]*Hn;f>h&&(h=f)}else if(s=(s+360)%360-180,p^(c*y<s&&s<c*t)){var f=-n[1]*Hn;f<g&&(g=f)}else a<g&&(g=a),a>h&&(h=a);p?t<y?l(u,t)>l(u,m)&&(m=t):l(t,m)>l(u,m)&&(u=t):m>=u?(t<u&&(u=t),t>m&&(m=t)):t>y?l(u,t)>l(u,m)&&(m=t):l(t,m)>l(u,m)&&(u=t)}else e(t,a);x=o,y=t}function a(){c.point=t}function o(){w[0]=u,w[1]=m,c.point=e,x=null}function r(e,a){if(x){var o=e-y;_+=180<Tn(o)?o+(0<o?360:-360):o}else p=e,f=a;Tl.point(e,a),t(e,a)}function i(){Tl.lineStart()}function n(){r(p,f),Tl.lineEnd(),Tn(_)>Bn&&(u=-(m=180)),w[0]=u,w[1]=m,x=null}function l(e,t){return 0>(t-=e)?t+360:t}function s(e,t){return e[0]-t[0]}function d(e,t){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var c={point:e,lineStart:a,lineEnd:o,polygonStart:function(){c.point=r,c.lineStart=i,c.lineEnd=n,_=0,Tl.polygonStart()},polygonEnd:function(){Tl.polygonEnd(),c.point=e,c.lineStart=a,c.lineEnd=o,0>kl?(u=-(m=180),g=-(h=90)):_>Bn?h=90:_<-Bn&&(g=-90),w[0]=u,w[1]=m}},u,g,m,h,y,p,f,x,_,v,w;return function(e){h=m=-(u=g=1/0),v=[],yn.geo.stream(e,c);var t=v.length;if(t){v.sort(s);for(var o=1,r=v[0],p=[r],y;o<t;++o)y=v[o],d(y[0],r)||d(y[1],r)?(l(r[0],y[1])>l(r[0],r[1])&&(r[1]=y[1]),l(y[0],r[1])>l(r[0],r[1])&&(r[0]=y[0])):p.push(r=y);for(var f=-Infinity,t=p.length-1,o=0,r=p[t],x,y;o<=t;r=y,++o)y=p[o],(x=l(r[1],y[0]))>f&&(f=x,u=y[0],m=r[1])}return v=w=null,u===1/0||g===1/0?[[NaN,NaN],[NaN,NaN]]:[[u,g],[m,h]]}}(),yn.geo.centroid=function(e){Ll=El=Il=Pl=zl=Dl=Ol=Rl=Ml=jl=Bl=0,yn.geo.stream(e,Sl);var t=Ml,a=jl,o=Bl,r=t*t+a*a+o*o;return r<Fn&&(t=Dl,a=Ol,o=Rl,El<Bn&&(t=Il,a=Pl,o=zl),r=t*t+a*a+o*o,r<Fn)?[NaN,NaN]:[s(a,t)*Hn,Se(o/f(r))*Hn]};var Sl={sphere:Y,point:Xt,lineStart:Kt,lineEnd:$t,polygonStart:function(){Sl.lineStart=Jt},polygonEnd:function(){Sl.lineStart=Kt}},Cl=ra(ea,function(e){var t=NaN,a=NaN,o=NaN,r;return{lineStart:function(){e.lineStart(),r=1},point:function(i,n){var l=0<i?Nn:-Nn,s=Tn(i-t);Tn(s-Nn)<Bn?(e.point(t,a=0<(a+n)/2?m:-m),e.point(o,a),e.lineEnd(),e.lineStart(),e.point(l,a),e.point(i,a),r=0):o!==l&&s>=Nn&&(Tn(t-o)<Bn&&(t-=o*Bn),Tn(i-l)<Bn&&(i-=l*Bn),a=sa(t,a,i,n),e.point(o,a),e.lineEnd(),e.lineStart(),e.point(l,a),r=0),e.point(t=i,a=n),o=l},lineEnd:function(){e.lineEnd(),t=a=NaN},clean:function(){return 2-r}}},function(e,t,a,o){var r;if(null==e)r=a*m,o.point(-Nn,r),o.point(0,r),o.point(Nn,r),o.point(Nn,0),o.point(Nn,-r),o.point(0,-r),o.point(-Nn,-r),o.point(-Nn,0),o.point(-Nn,r);else if(Tn(e[0]-t[0])>Bn){var i=e[0]<t[0]?Nn:-Nn;r=a*i/2,o.point(-i,r),o.point(0,r),o.point(i,r)}else o.point(t[0],t[1])},[-Nn,-Nn/2]),Ll,El,Il,Pl,zl,Dl,Ol,Rl,Ml,jl,Bl;yn.geo.clipExtent=function(){var e={stream:function(e){return i&&(i.valid=!1),i=n(e),i.valid=!0,i},extent:function(l){return arguments.length?(n=ua(t=+l[0][0],a=+l[0][1],o=+l[1][0],r=+l[1][1]),i&&(i.valid=!1,i=null),e):[[t,a],[o,r]]}},t,a,o,r,i,n;return e.extent([[0,0],[960,500]])},(yn.geo.conicEqualArea=function(){return ga(ma)}).raw=ma,yn.geo.albers=function(){return yn.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},yn.geo.albersUsa=function(){function e(e){var t=e[0],a=e[1];return n=null,(l(t,a),n)||(s(t,a),n)||d(t,a),n}var a=yn.geo.albers(),o=yn.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),r=yn.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),i={point:function(e,t){n=[e,t]}},n,l,s,d;return e.invert=function(e){var i=a.scale(),n=a.translate(),t=(e[0]-n[0])/i,l=(e[1]-n[1])/i;return(.12<=l&&.234>l&&-.425<=t&&-.214>t?o:.166<=l&&.234>l&&-.214<=t&&-.115>t?r:a).invert(e)},e.stream=function(e){var t=a.stream(e),i=o.stream(e),n=r.stream(e);return{point:function(e,a){t.point(e,a),i.point(e,a),n.point(e,a)},sphere:function(){t.sphere(),i.sphere(),n.sphere()},lineStart:function(){t.lineStart(),i.lineStart(),n.lineStart()},lineEnd:function(){t.lineEnd(),i.lineEnd(),n.lineEnd()},polygonStart:function(){t.polygonStart(),i.polygonStart(),n.polygonStart()},polygonEnd:function(){t.polygonEnd(),i.polygonEnd(),n.polygonEnd()}}},e.precision=function(t){return arguments.length?(a.precision(t),o.precision(t),r.precision(t),e):a.precision()},e.scale=function(t){return arguments.length?(a.scale(t),o.scale(.35*t),r.scale(t),e.translate(a.translate())):a.scale()},e.translate=function(t){if(!arguments.length)return a.translate();var n=a.scale(),c=+t[0],p=+t[1];return l=a.translate(t).clipExtent([[c-.455*n,p-.238*n],[c+.455*n,p+.238*n]]).stream(i).point,s=o.translate([c-.307*n,p+.201*n]).clipExtent([[c-.425*n+Bn,p+.12*n+Bn],[c-.214*n-Bn,p+.234*n-Bn]]).stream(i).point,d=r.translate([c-.205*n,p+.212*n]).clipExtent([[c-.214*n+Bn,p+.166*n+Bn],[c-.115*n-Bn,p+.234*n-Bn]]).stream(i).point,e},e.scale(1070)};var Fl={point:Y,lineStart:Y,lineEnd:Y,polygonStart:function(){Hl=0,Fl.lineStart=ha},polygonEnd:function(){Fl.lineStart=Fl.lineEnd=Fl.point=Y,Ul+=Tn(Hl/2)}},Nl={point:ya,lineStart:Y,lineEnd:Y,polygonStart:Y,polygonEnd:Y},Vl={point:_a,lineStart:ba,lineEnd:va,polygonStart:function(){Vl.lineStart=wa},polygonEnd:function(){Vl.point=_a,Vl.lineStart=ba,Vl.lineEnd=va}},Ul,Hl,ql,Gl,Yl,Wl;yn.geo.path=function(){function e(e){return e&&("function"==typeof a&&n.pointRadius(+a.apply(this,arguments)),(!l||!l.valid)&&(l=i(n)),yn.geo.stream(e,l)),n.result()}function t(){return l=null,e}var a=4.5,o,r,i,n,l;return e.area=function(e){return Ul=0,yn.geo.stream(e,i(Fl)),Ul},e.centroid=function(e){return Il=Pl=zl=Dl=Ol=Rl=Ml=jl=Bl=0,yn.geo.stream(e,i(Vl)),Bl?[Ml/Bl,jl/Bl]:Rl?[Dl/Rl,Ol/Rl]:zl?[Il/zl,Pl/zl]:[NaN,NaN]},e.bounds=function(e){return Yl=Wl=-(ql=Gl=1/0),yn.geo.stream(e,i(Nl)),[[ql,Gl],[Yl,Wl]]},e.projection=function(e){return arguments.length?(i=(o=e)?e.stream||Aa(e):H,t()):o},e.context=function(e){return arguments.length?(n=null==(r=e)?new fa:new ka(e),"function"!=typeof a&&n.pointRadius(a),t()):r},e.pointRadius=function(t){return arguments.length?(a="function"==typeof t?t:(n.pointRadius(+t),+t),e):a},e.projection(yn.geo.albersUsa()).context(null)},yn.geo.transform=function(e){return{stream:function(t){var a=new Sa(t);for(var o in e)a[o]=e[o];return a}}},Sa.prototype={point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},yn.geo.projection=La,yn.geo.projectionMutator=Ea,(yn.geo.equirectangular=function(){return La(Pa)}).raw=Pa.invert=Pa,yn.geo.rotation=function(e){function t(t){return t=e(t[0]*Un,t[1]*Un),t[0]*=Hn,t[1]*=Hn,t}return e=Da(e[0]%360*Un,e[1]*Un,2<e.length?e[2]*Un:0),t.invert=function(t){return t=e.invert(t[0]*Un,t[1]*Un),t[0]*=Hn,t[1]*=Hn,t},t},za.invert=Pa,yn.geo.circle=function(){function e(){var e="function"==typeof t?t.apply(this,arguments):t,a=Da(-e[0]*Un,-e[1]*Un,0).invert,o=[];return r(null,null,1,{point:function(e,t){o.push(e=a(e,t)),e[0]*=Hn,e[1]*=Hn}}),{type:"Polygon",coordinates:[o]}}var t=[0,0],a=6,o,r;return e.origin=function(a){return arguments.length?(t=a,e):t},e.angle=function(t){return arguments.length?(r=ja((o=+t)*Un,a*Un),e):o},e.precision=function(t){return arguments.length?(r=ja(o*Un,(a=+t)*Un),e):a},e.angle(90)},yn.geo.distance=function(e,a){var o=(a[0]-e[0])*Un,r=e[1]*Un,i=a[1]*Un,n=T(o),l=g(o),d=T(r),c=g(r),p=T(i),u=g(i),m;return s(f((m=u*n)*m+(m=c*p-d*u*l)*m),d*p+c*u*l)},yn.geo.graticule=function(){function e(){return{type:"MultiLineString",coordinates:t()}}function t(){return yn.range(h(c/r)*r,d,r).map(v).concat(yn.range(h(m/i)*i,g,i).map(w)).concat(yn.range(h(s/a)*a,l,a).filter(function(e){return Tn(e%r)>Bn}).map(f)).concat(yn.range(h(u/o)*o,p,o).filter(function(e){return Tn(e%i)>Bn}).map(b))}var a=10,o=a,r=90,i=360,n=2.5,l,s,d,c,p,u,g,m,f,b,v,w;return e.lines=function(){return t().map(function(e){return{type:"LineString",coordinates:e}})},e.outline=function(){return{type:"Polygon",coordinates:[v(c).concat(w(g).slice(1),v(d).reverse().slice(1),w(m).reverse().slice(1))]}},e.extent=function(t){return arguments.length?e.majorExtent(t).minorExtent(t):e.minorExtent()},e.majorExtent=function(t){return arguments.length?(c=+t[0][0],d=+t[1][0],m=+t[0][1],g=+t[1][1],c>d&&(t=c,c=d,d=t),m>g&&(t=m,m=g,g=t),e.precision(n)):[[c,m],[d,g]]},e.minorExtent=function(t){return arguments.length?(s=+t[0][0],l=+t[1][0],u=+t[0][1],p=+t[1][1],s>l&&(t=s,s=l,l=t),u>p&&(t=u,u=p,p=t),e.precision(n)):[[s,u],[l,p]]},e.step=function(t){return arguments.length?e.majorStep(t).minorStep(t):e.minorStep()},e.majorStep=function(t){return arguments.length?(r=+t[0],i=+t[1],e):[r,i]},e.minorStep=function(t){return arguments.length?(a=+t[0],o=+t[1],e):[a,o]},e.precision=function(t){return arguments.length?(n=+t,f=Fa(u,p,90),b=Na(s,l,n),v=Fa(m,g,90),w=Na(c,d,n),e):n},e.majorExtent([[-180,-90+Bn],[180,90-Bn]]).minorExtent([[-180,-80-Bn],[180,80+Bn]])},yn.geo.greatArc=function(){function e(){return{type:"LineString",coordinates:[o||t.apply(this,arguments),r||a.apply(this,arguments)]}}var t=Va,a=Ua,o,r;return e.distance=function(){return yn.geo.distance(o||t.apply(this,arguments),r||a.apply(this,arguments))},e.source=function(a){return arguments.length?(t=a,o="function"==typeof a?null:a,e):t},e.target=function(t){return arguments.length?(a=t,r="function"==typeof t?null:t,e):a},e.precision=function(){return arguments.length?e:0},e},yn.geo.interpolate=function(e,t){return Ha(e[0]*Un,e[1]*Un,t[0]*Un,t[1]*Un)},yn.geo.length=function(e){return Kl=0,yn.geo.stream(e,Xl),Kl};var Xl={sphere:Y,point:Y,lineStart:function(){function e(e,i){var n=T(i*=Un),l=g(i),d=Tn((e*=Un)-a),c=g(d);Kl+=s(f((d=l*T(d))*d+(d=r*n-o*l*c)*d),o*n+r*l*c),a=e,o=n,r=l}var a,o,r;Xl.point=function(t,i){a=t*Un,o=T(i*=Un),r=g(i),Xl.point=e},Xl.lineEnd=function(){Xl.point=Xl.lineEnd=Y}},lineEnd:Y,polygonStart:Y,polygonEnd:Y},Zl=qa(function(e){return f(2/(1+e))},function(e){return 2*o(e/2)}),Kl;(yn.geo.azimuthalEqualArea=function(){return La(Zl)}).raw=Zl;var $l=qa(function(e){var t=r(e);return t&&t/T(t)},H);(yn.geo.azimuthalEquidistant=function(){return La($l)}).raw=$l,(yn.geo.conicConformal=function(){return ga(Ga)}).raw=Ga,(yn.geo.conicEquidistant=function(){return ga(Ya)}).raw=Ya;var Jl=qa(function(e){return 1/e},Math.atan);(yn.geo.gnomonic=function(){return La(Jl)}).raw=Jl,Wa.invert=function(e,t){return[e,2*L(n(t))-m]},(yn.geo.mercator=function(){return Xa(Wa)}).raw=Wa;var Ql=qa(function(){return 1},Math.asin);(yn.geo.orthographic=function(){return La(Ql)}).raw=Ql;var es=qa(function(e){return 1/(1+e)},function(e){return 2*L(e)});(yn.geo.stereographic=function(){return La(es)}).raw=es,Za.invert=function(e,t){return[-t,2*L(n(e))-m]},(yn.geo.transverseMercator=function(){var e=Xa(Za),t=e.center,a=e.rotate;return e.center=function(e){return e?t([-e[1],e[0]]):(e=t(),[e[1],-e[0]])},e.rotate=function(e){return e?a([e[0],e[1],2<e.length?e[2]+90:90]):(e=a(),[e[0],e[1],e[2]-90])},a([0,0,90])}).raw=Za,yn.geom={},yn.geom.hull=function(e){function t(e){if(3>e.length)return[];var t=$e(a),r=$e(o),l=e.length,n=[],s=[],d;for(d=0;d<l;d++)n.push([+t.call(this,e[d],d),+r.call(this,e[d],d),d]);for(n.sort(Qa),d=0;d<l;d++)s.push([n[d][0],-n[d][1]]);var c=Ja(n),p=Ja(s),u=p[0]===c[0],g=p[p.length-1]===c[c.length-1],m=[];for(d=c.length-1;0<=d;--d)m.push(e[n[c[d]][2]]);for(d=+u;d<p.length-g;++d)m.push(e[n[p[d]][2]]);return m}var a=Ka,o=$a;return arguments.length?t(e):(t.x=function(e){return arguments.length?(a=e,t):a},t.y=function(e){return arguments.length?(o=e,t):o},t)},yn.geom.polygon=function(e){return Cn(e,ts),e};var ts=yn.geom.polygon.prototype=[];ts.area=function(){for(var e=-1,t=this.length,o=this[t-1],r=0,n;++e<t;)n=o,o=this[e],r+=n[1]*o[0]-n[0]*o[1];return .5*r},ts.centroid=function(e){var t=-1,o=this.length,r=0,n=0,l=this[o-1],s,d;for(arguments.length||(e=-1/(6*this.area()));++t<o;)s=l,l=this[t],d=s[0]*l[1]-l[0]*s[1],r+=(s[0]+l[0])*d,n+=(s[1]+l[1])*d;return[r*e,n*e]},ts.clip=function(e){for(var t=ao(e),o=-1,r=this.length-ao(this),n=this[r-1],l,s,p,u,g,h;++o<r;){for(l=e.slice(),e.length=0,u=this[o],g=l[(p=l.length-t)-1],s=-1;++s<p;)h=l[s],eo(h,n,u)?(!eo(g,n,u)&&e.push(to(g,h,n,u)),e.push(h)):eo(g,n,u)&&e.push(to(g,h,n,u)),g=h;t&&e.push(e[0]),n=u}return e};var as=[],os=[],rs,is,ns,ls,ss;po.prototype.prepare=function(){for(var e=this.edges,t=e.length,a;t--;)a=e[t].edge,a.b&&a.a||e.splice(t,1);return e.sort(go),e.length},ko.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},To.prototype={insert:function(e,t){var a,o,r;if(e){if(t.P=e,t.N=e.N,e.N&&(e.N.P=t),e.N=t,e.R){for(e=e.R;e.L;)e=e.L;e.L=t}else e.R=t;a=e}else this._?(e=Lo(this._),t.P=null,t.N=e,e.P=e.L=t,a=e):(t.P=t.N=null,this._=t,a=null);for(t.L=t.R=null,t.U=a,t.C=!0,e=t;a&&a.C;)o=a.U,a===o.L?(r=o.R,r&&r.C?(a.C=r.C=!1,o.C=!0,e=o):(e===a.R&&(So(this,a),e=a,a=e.U),a.C=!1,o.C=!0,Co(this,o))):(r=o.L,r&&r.C?(a.C=r.C=!1,o.C=!0,e=o):(e===a.L&&(Co(this,a),e=a,a=e.U),a.C=!1,o.C=!0,So(this,o))),a=e.U;this._.C=!1},remove:function(e){e.N&&(e.N.P=e.P),e.P&&(e.P.N=e.N),e.N=e.P=null;var t=e.U,a=e.L,o=e.R,r,i,n;if(i=a?o?Lo(o):a:o,t?t.L===e?t.L=i:t.R=i:this._=i,a&&o?(n=i.C,i.C=e.C,i.L=a,a.U=i,i===o?(i.U=t,t=i,e=i.R):(t=i.U,i.U=e.U,e=i.R,t.L=e,i.R=o,o.U=i)):(n=e.C,e=i),e&&(e.U=t),!n){if(e&&e.C)return void(e.C=!1);do{if(e===this._)break;if(e===t.L){if(r=t.R,r.C&&(r.C=!1,t.C=!0,So(this,t),r=t.R),r.L&&r.L.C||r.R&&r.R.C){r.R&&r.R.C||(r.L.C=!1,r.C=!0,Co(this,r),r=t.R),r.C=t.C,t.C=r.R.C=!1,So(this,t),e=this._;break}}else if(r=t.L,r.C&&(r.C=!1,t.C=!0,Co(this,t),r=t.L),r.L&&r.L.C||r.R&&r.R.C){r.L&&r.L.C||(r.R.C=!1,r.C=!0,So(this,r),r=t.L),r.C=t.C,t.C=r.L.C=!1,Co(this,t),e=this._;break}r.C=!0,e=t,t=t.U}while(!e.C);e&&(e.C=!1)}}},yn.geom.voronoi=function(e){function t(e){var t=Array(e.length),o=i[0][0],r=i[0][1],n=i[1][0],l=i[1][1];return Eo(a(e),i).cells.forEach(function(a,s){var i=a.edges,d=a.site,c=t[s]=i.length?i.map(function(t){var e=t.start();return[e.x,e.y]}):d.x>=o&&d.x<=n&&d.y>=r&&d.y<=l?[[o,l],[n,l],[n,r],[o,r]]:[];c.point=e[s]}),t}function a(e){return e.map(function(e,t){return{x:_(n(e,t)/Bn)*Bn,y:_(l(e,t)/Bn)*Bn,i:t}})}var o=Ka,r=$a,n=o,l=r,i=ds;return e?t(e):(t.links=function(e){return Eo(a(e)).edges.filter(function(e){return e.l&&e.r}).map(function(t){return{source:e[t.l.i],target:e[t.r.i]}})},t.triangles=function(e){var t=[];return Eo(a(e)).cells.forEach(function(a,o){for(var r=a.site,i=a.edges.sort(go),n=-1,l=i.length,s=i[l-1].edge,d=s.l===r?s.r:s.l,c,p;++n<l;)c=s,p=d,s=i[n].edge,d=s.l===r?s.r:s.l,o<p.i&&o<d.i&&0>Po(r,p,d)&&t.push([e[o],e[p.i],e[d.i]])}),t},t.x=function(e){return arguments.length?(n=$e(o=e),t):o},t.y=function(e){return arguments.length?(l=$e(r=e),t):r},t.clipExtent=function(e){return arguments.length?(i=null==e?ds:e,t):i===ds?null:i},t.size=function(e){return arguments.length?t.clipExtent(e&&[[0,0],e]):i===ds?null:i&&i[1]},t)};var ds=[[-1e6,-1e6],[1e6,1e6]];yn.geom.delaunay=function(e){return yn.geom.voronoi().triangles(e)},yn.geom.quadtree=function(e,t,a,o,r){function i(e){function p(e,t,a,o,r,i,n,l){if(!(isNaN(a)||isNaN(o)))if(e.leaf){var s=e.x,d=e.y;if(null==s)e.x=a,e.y=o,e.point=t;else if(.01>Tn(s-a)+Tn(d-o))u(e,t,a,o,r,i,n,l);else{var c=e.point;e.x=e.y=e.point=null,u(e,c,s,d,r,i,n,l),u(e,t,a,o,r,i,n,l)}}else u(e,t,a,o,r,i,n,l)}function u(e,t,a,o,r,l,s,d){var c=.5*(r+s),u=.5*(l+d),g=a>=c,m=o>=u,h=m<<1|g;e.leaf=!1,e=e.nodes[h]||(e.nodes[h]=Oo()),g?r=c:s=c,m?l=u:d=u,p(e,t,a,o,r,l,s,d)}var g=$e(l),m=$e(s),h,y,f,x,_,b,v,w,k;if(null!=t)b=t,v=a,w=o,k=r;else if(w=k=-(b=v=1/0),y=[],f=[],_=e.length,c)for(x=0;x<_;++x)h=e[x],h.x<b&&(b=h.x),h.y<v&&(v=h.y),h.x>w&&(w=h.x),h.y>k&&(k=h.y),y.push(h.x),f.push(h.y);else for(x=0;x<_;++x){var T=+g(h=e[x],x),A=+m(h,x);T<b&&(b=T),A<v&&(v=A),T>w&&(w=T),A>k&&(k=A),y.push(T),f.push(A)}var S=w-b,C=k-v;S>C?k=v+S:w=b+C;var L=Oo();if(L.add=function(e){p(L,e,+g(e,++x),+m(e,x),b,v,w,k)},L.visit=function(e){Ro(e,L,b,v,w,k)},L.find=function(e){return Mo(L,e[0],e[1],b,v,w,k)},x=-1,null==t){for(;++x<_;)p(L,e[x],y[x],f[x],b,v,w,k);--x}else e.forEach(L.add);return y=f=e=h=null,L}var l=Ka,s=$a,c;return(c=arguments.length)?(l=zo,s=Do,3===c&&(r=a,o=t,a=t=0),i(e)):(i.x=function(e){return arguments.length?(l=e,i):l},i.y=function(e){return arguments.length?(s=e,i):s},i.extent=function(e){return arguments.length?(null==e?t=a=o=r=null:(t=+e[0][0],a=+e[0][1],o=+e[1][0],r=+e[1][1]),i):null==t?null:[[t,a],[o,r]]},i.size=function(e){return arguments.length?(null==e?t=a=o=r=null:(t=a=0,o=+e[0],r=+e[1]),i):null==t?null:[o-t,r-a]},i)},yn.interpolateRgb=jo,yn.interpolateObject=Bo,yn.interpolateNumber=Fo,yn.interpolateString=No;var cs=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ps=new RegExp(cs.source,"g");yn.interpolate=Vo,yn.interpolators=[function(e,a){var o=typeof a;return("string"==o?ol.has(a.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(a)?jo:No:a instanceof Pe?jo:Array.isArray(a)?Uo:"object"===o&&isNaN(a)?Bo:Fo)(e,a)}],yn.interpolateArray=Uo;var us=function(){return H},gs=yn.map({linear:us,poly:function(a){return function(e){return S(e,a)}},quad:function(){return Yo},cubic:function(){return Wo},sin:function(){return Zo},exp:function(){return Ko},circle:function(){return $o},elastic:function(e,r){var i;return 2>arguments.length&&(r=.45),arguments.length?i=r/Vn*o(1/e):(e=1,i=r/4),function(a){return 1+e*S(2,-10*a)*T((a-i)*Vn/r)}},back:function(e){return e||(e=1.70158),function(a){return a*a*((e+1)*a-e)}},bounce:function(){return Jo}}),ms=yn.map({in:H,out:qo,"in-out":Go,"out-in":function(e){return Go(qo(e))}});yn.ease=function(e){var a=e.indexOf("-"),o=0<=a?e.slice(0,a):e,r=0<=a?e.slice(a+1):"in";return o=gs.get(o)||us,r=ms.get(r)||H,Ho(r(o.apply(null,x.call(arguments,1))))},yn.interpolateHcl=function(e,t){e=yn.hcl(e),t=yn.hcl(t);var o=e.h,r=e.c,i=e.l,n=t.h-o,l=t.c-r,s=t.l-i;return isNaN(l)&&(l=0,r=isNaN(r)?t.c:r),isNaN(n)?(n=0,o=isNaN(o)?t.h:o):180<n?n-=360:-180>n&&(n+=360),function(e){return Re(o+n*e,r+l*e,i+s*e)+""}},yn.interpolateHsl=function(e,t){e=yn.hsl(e),t=yn.hsl(t);var o=e.h,r=e.s,i=e.l,n=t.h-o,l=t.s-r,s=t.l-i;return isNaN(l)&&(l=0,r=isNaN(r)?t.s:r),isNaN(n)?(n=0,o=isNaN(o)?t.h:o):180<n?n-=360:-180>n&&(n+=360),function(e){return De(o+n*e,r+l*e,i+s*e)+""}},yn.interpolateLab=function(e,t){e=yn.lab(e),t=yn.lab(t);var o=e.l,r=e.a,i=e.b,n=t.l-o,l=t.a-r,s=t.b-i;return function(e){return je(o+n*e,r+l*e,i+s*e)+""}},yn.interpolateRound=Qo,yn.transform=function(e){var t=fn.createElementNS(yn.ns.prefix.svg,"g");return(yn.transform=function(e){if(null!=e){t.setAttribute("transform",e);var a=t.transform.baseVal.consolidate()}return new er(a?a.matrix:hs)})(e)},er.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var hs={a:1,b:0,c:0,d:1,e:0,f:0};yn.interpolateTransform=dr,yn.layout={},yn.layout.bundle=function(){return function(e){for(var t=[],a=-1,o=e.length;++a<o;)t.push(ur(e[a]));return t}},yn.layout.chord=function(){function e(){var e={},n=[],g=yn.range(d),m=[],h,a,y,f,_;for(r=[],l=[],h=0,f=-1;++f<d;){for(a=0,_=-1;++_<d;)a+=s[f][_];n.push(a),m.push(yn.range(d)),h+=a}for(c&&g.sort(function(e,t){return c(n[e],n[t])}),p&&m.forEach(function(e,t){e.sort(function(e,a){return p(s[t][e],s[t][a])})}),h=(Vn-o*d)/h,a=0,f=-1;++f<d;){for(y=a,_=-1;++_<d;){var b=g[f],w=m[b][_],T=s[b][w],v=a,A=a+=T*h;e[b+"-"+w]={index:b,subindex:w,startAngle:v,endAngle:A,value:T}}l[b]={index:b,startAngle:y,endAngle:a,value:n[b]},a+=o}for(f=-1;++f<d;)for(_=f-1;++_<d;){var S=e[f+"-"+_],C=e[_+"-"+f];(S.value||C.value)&&r.push(S.value<C.value?{source:C,target:S}:{source:S,target:C})}u&&t()}function t(){r.sort(function(e,t){return u((e.source.value+e.target.value)/2,(t.source.value+t.target.value)/2)})}var a={},o=0,r,l,s,d,c,p,u;return a.matrix=function(e){return arguments.length?(d=(s=e)&&s.length,r=l=null,a):s},a.padding=function(e){return arguments.length?(o=e,r=l=null,a):o},a.sortGroups=function(e){return arguments.length?(c=e,r=l=null,a):c},a.sortSubgroups=function(e){return arguments.length?(p=e,r=null,a):p},a.sortChords=function(e){return arguments.length?(u=e,r&&t(),a):u},a.chords=function(){return r||e(),r},a.groups=function(){return l||e(),l},a},yn.layout.force=function(){function e(e){return function(t,a,o,r){if(t.point!==e){var i=t.cx-e.x,n=t.cy-e.y,l=r-a,s=i*i+n*n;if(l*l/y<s){if(s<m){var d=t.charge/s;e.px-=i*d,e.py-=n*d}return!0}if(t.point&&s&&s<m){var d=t.pointCharge/s;e.px-=i*d,e.py-=n*d}}return!t.charge}}function t(e){e.px=yn.event.x,e.py=yn.event.y,a.resume()}var a={},r=yn.dispatch("start","tick","end"),d=[1,1],c=.9,p=ys,u=fs,g=-30,m=xs,h=.1,y=.64,_=[],b=[],v,w,T,A,S,C;return a.tick=function(){if(.005>(T*=.99))return v=null,r.end({type:"end",alpha:T=0}),!0;var a=_.length,n=b.length,p,u,m,w,L,E,I,P,z;for(u=0;u<n;++u)m=b[u],w=m.source,L=m.target,P=L.x-w.x,z=L.y-w.y,(E=P*P+z*z)&&(E=T*S[u]*((E=f(E))-A[u])/E,P*=E,z*=E,L.x-=P*(I=w.weight+L.weight?w.weight/(w.weight+L.weight):.5),L.y-=z*I,w.x+=P*(I=1-I),w.y+=z*I);if((I=T*h)&&(P=d[0]/2,z=d[1]/2,u=-1,I))for(;++u<a;)m=_[u],m.x+=(P-m.x)*I,m.y+=(z-m.y)*I;if(g)for(_r(p=yn.geom.quadtree(_),T,C),u=-1;++u<a;)(m=_[u]).fixed||p.visit(e(m));for(u=-1;++u<a;)m=_[u],m.fixed?(m.x=m.px,m.y=m.py):(m.x-=(m.px-(m.px=m.x))*c,m.y-=(m.py-(m.py=m.y))*c);r.tick({type:"tick",alpha:T})},a.nodes=function(e){return arguments.length?(_=e,a):_},a.links=function(e){return arguments.length?(b=e,a):b},a.size=function(e){return arguments.length?(d=e,a):d},a.linkDistance=function(e){return arguments.length?(p="function"==typeof e?e:+e,a):p},a.distance=a.linkDistance,a.linkStrength=function(e){return arguments.length?(u="function"==typeof e?e:+e,a):u},a.friction=function(e){return arguments.length?(c=+e,a):c},a.charge=function(e){return arguments.length?(g="function"==typeof e?e:+e,a):g},a.chargeDistance=function(e){return arguments.length?(m=e*e,a):f(m)},a.gravity=function(e){return arguments.length?(h=+e,a):h},a.theta=function(e){return arguments.length?(y=e*e,a):f(y)},a.alpha=function(e){return arguments.length?(e=+e,T?0<e?T=e:(v.c=null,v.t=NaN,v=null,r.end({type:"end",alpha:T=0})):0<e&&(r.start({type:"start",alpha:T=e}),v=at(a.tick)),a):T},a.start=function(){function e(e,a){if(!c){for(c=Array(t),n=0;n<t;++n)c[n]=[];for(n=0;n<r;++n){var i=b[n];c[i.source.index].push(i.target),c[i.target.index].push(i.source)}}for(var o=c[s],n=-1,d=o.length,l;++n<d;)if(!isNaN(l=o[n][e]))return l;return Math.random()*a}var t=_.length,r=b.length,n=d[0],l=d[1],s,c,m;for(s=0;s<t;++s)(m=_[s]).index=s,m.weight=0;for(s=0;s<r;++s)m=b[s],"number"==typeof m.source&&(m.source=_[m.source]),"number"==typeof m.target&&(m.target=_[m.target]),++m.source.weight,++m.target.weight;for(s=0;s<t;++s)m=_[s],isNaN(m.x)&&(m.x=e("x",n)),isNaN(m.y)&&(m.y=e("y",l)),isNaN(m.px)&&(m.px=m.x),isNaN(m.py)&&(m.py=m.y);if(A=[],"function"==typeof p)for(s=0;s<r;++s)A[s]=+p.call(this,b[s],s);else for(s=0;s<r;++s)A[s]=p;if(S=[],"function"==typeof u)for(s=0;s<r;++s)S[s]=+u.call(this,b[s],s);else for(s=0;s<r;++s)S[s]=u;if(C=[],"function"==typeof g)for(s=0;s<t;++s)C[s]=+g.call(this,_[s],s);else for(s=0;s<t;++s)C[s]=g;return a.resume()},a.resume=function(){return a.alpha(.1)},a.stop=function(){return a.alpha(0)},a.drag=function(){return w||(w=yn.behavior.drag().origin(H).on("dragstart.force",hr).on("drag.force",t).on("dragend.force",yr)),arguments.length?void this.on("mouseover.force",fr).on("mouseout.force",xr).call(w):w},yn.rebind(a,r,"on")};var ys=20,fs=1,xs=1/0;yn.layout.hierarchy=function(){function e(r){var i=[r],l=[],s;for(r.depth=0;null!=(s=i.pop());)if(l.push(s),(c=a.call(e,s,s.depth))&&(d=c.length)){for(var d,c,p;0<=--d;)i.push(p=c[d]),p.parent=s,p.depth=s.depth+1;o&&(s.value=0),s.children=c}else o&&(s.value=+o.call(e,s,s.depth)||0),delete s.children;return wr(r,function(e){var a,r;t&&(a=e.children)&&a.sort(t),o&&(r=e.parent)&&(r.value+=e.value)}),l}var t=Ar,a=kr,o=Tr;return e.sort=function(a){return arguments.length?(t=a,e):t},e.children=function(t){return arguments.length?(a=t,e):a},e.value=function(t){return arguments.length?(o=t,e):o},e.revalue=function(t){return o&&(vr(t,function(e){e.children&&(e.value=0)}),wr(t,function(t){var a;t.children||(t.value=+o.call(e,t,t.depth)||0),(a=t.parent)&&(a.value+=t.value)})),t},e},yn.layout.partition=function(){function e(t,a,o,r){var l=t.children;if(t.x=a,t.y=t.depth*r,t.dx=o,t.dy=r,l&&(p=l.length)){var s=-1,p,u,g;for(o=t.value?o/t.value:0;++s<p;)e(u=l[s],a,g=u.value*o,r),a+=g}}function t(e){var a=e.children,o=0;if(a&&(l=a.length))for(var r=-1,l;++r<l;)o=I(o,t(a[r]));return 1+o}function a(a,n){var i=o.call(this,a,n);return e(i[0],0,r[0],r[1]/t(i[0])),i}var o=yn.layout.hierarchy(),r=[1,1];return a.size=function(e){return arguments.length?(r=e,a):r},br(a,o)},yn.layout.pie=function(){function e(s){var d=s.length,n=s.map(function(a,o){return+t.call(e,a,o)}),c=+("function"==typeof r?r.apply(this,arguments):r),u=("function"==typeof i?i.apply(this,arguments):i)-c,g=A(E(u)/d,+("function"==typeof l?l.apply(this,arguments):l)),p=g*(0>u?-1:1),m=yn.sum(n),h=m?(u-d*p)/m:0,y=yn.range(d),f=[],x;return null!=o&&y.sort(o===_s?function(e,t){return n[t]-n[e]}:function(e,t){return o(s[e],s[t])}),y.forEach(function(e){f[e]={data:s[e],value:x=n[e],startAngle:c,endAngle:c+=x*h+p,padAngle:g}}),f}var t=Number,o=_s,r=0,i=Vn,l=0;return e.value=function(a){return arguments.length?(t=a,e):t},e.sort=function(t){return arguments.length?(o=t,e):o},e.startAngle=function(t){return arguments.length?(r=t,e):r},e.endAngle=function(t){return arguments.length?(i=t,e):i},e.padAngle=function(t){return arguments.length?(l=t,e):l},e};var _s={};yn.layout.stack=function(){function e(d,c){if(!(m=d.length))return d;var p=d.map(function(a,o){return t.call(e,a,o)}),u=p.map(function(t){return t.map(function(t,a){return[s.call(e,t,a),o.call(e,t,a)]})}),g=a.call(e,u,c);p=yn.permute(p,g),u=yn.permute(u,g);var h=r.call(e,u,c),y=p[0].length,m,f,x,_;for(x=0;x<y;++x)for(l.call(e,p[0][x],_=h[x],u[0][x][1]),f=1;f<m;++f)l.call(e,p[f][x],_+=u[f-1][x][1],u[f][x][1]);return d}var t=H,a=Ir,r=Pr,l=Er,s=Cr,o=Lr;return e.values=function(a){return arguments.length?(t=a,e):t},e.order=function(t){return arguments.length?(a="function"==typeof t?t:bs.get(t)||Ir,e):a},e.offset=function(t){return arguments.length?(r="function"==typeof t?t:vs.get(t)||Pr,e):r},e.x=function(t){return arguments.length?(s=t,e):s},e.y=function(t){return arguments.length?(o=t,e):o},e.out=function(t){return arguments.length?(l=t,e):l},e};var bs=yn.map({"inside-out":function(e){var t=e.length,o=e.map(zr),r=e.map(Dr),n=yn.range(t).sort(function(e,t){return o[e]-o[t]}),l=0,s=0,d=[],c=[],p,a;for(p=0;p<t;++p)a=n[p],l<s?(l+=r[a],d.push(a)):(s+=r[a],c.push(a));return c.reverse().concat(d)},reverse:function(e){return yn.range(e.length).reverse()},default:Ir}),vs=yn.map({silhouette:function(e){var t=e.length,a=e[0].length,r=[],n=0,l=[],s,d,c;for(d=0;d<a;++d){for(s=0,c=0;s<t;s++)c+=e[s][d][1];c>n&&(n=c),r.push(c)}for(d=0;d<a;++d)l[d]=(n-r[d])/2;return l},wiggle:function(e){var t=e.length,a=e[0],r=a.length,n=[],l,s,d,c,p,u,g,m,h;for(n[0]=m=h=0,s=1;s<r;++s){for(l=0,c=0;l<t;++l)c+=e[l][s][1];for(l=0,p=0,g=a[s][0]-a[s-1][0];l<t;++l){for(d=0,u=(e[l][s][1]-e[l][s-1][1])/(2*g);d<l;++d)u+=(e[d][s][1]-e[d][s-1][1])/g;p+=u*e[l][s][1]}n[s]=m-=c?p/c*g:0,m<h&&(h=m)}for(s=0;s<r;++s)n[s]-=h;return n},expand:function(e){var t=e.length,a=e[0].length,r=[],n,l,s;for(l=0;l<a;++l){for(n=0,s=0;n<t;n++)s+=e[n][l][1];if(s)for(n=0;n<t;n++)e[n][l][1]/=s;else for(n=0;n<t;n++)e[n][l][1]=1/t}for(l=0;l<a;++l)r[l]=0;return r},zero:Pr});yn.layout.histogram=function(){function e(e,l){for(var s=[],d=e.map(a,this),c=o.call(this,d,l),p=r.call(this,c,d,l),l=-1,u=d.length,n=p.length-1,g=t?1:1/u,m,h;++l<n;)m=s[l]=[],m.dx=p[l+1]-(m.x=p[l]),m.y=0;if(0<n)for(l=-1;++l<u;)h=d[l],h>=c[0]&&h<=c[1]&&(m=s[yn.bisect(p,h,1,n)-1],m.y+=g,m.push(e[l]));return s}var t=!0,a=Number,o=jr,r=Rr;return e.value=function(t){return arguments.length?(a=t,e):a},e.range=function(t){return arguments.length?(o=$e(t),e):o},e.bins=function(t){return arguments.length?(r="number"==typeof t?function(e){return Mr(e,t)}:$e(t),e):r},e.frequency=function(a){return arguments.length?(t=!!a,e):t},e},yn.layout.pack=function(){function e(e,l){var i=t.call(this,e,l),s=i[0],d=o[0],c=o[1],p=null==n?f:"function"==typeof n?n:function(){return n};if(s.x=s.y=0,wr(s,function(e){e.r=+p(e.value)}),wr(s,Ur),a){var r=a*(n?1:I(2*s.r/d,2*s.r/c))/2;wr(s,function(e){e.r+=r}),wr(s,Ur),wr(s,function(e){e.r-=r})}return Gr(s,d/2,c/2,n?1:1/I(2*s.r/d,2*s.r/c)),i}var t=yn.layout.hierarchy().sort(Br),a=0,o=[1,1],n;return e.size=function(t){return arguments.length?(o=t,e):o},e.radius=function(t){return arguments.length?(n=null==t||"function"==typeof t?t:+t,e):n},e.padding=function(t){return arguments.length?(a=+t,e):a},br(e,t)},yn.layout.tree=function(){function e(e,r){var i=l.call(this,e,r),p=i[0],u=t(p);if(wr(u,a),u.parent.m=-u.z,vr(u,o),c)vr(p,n);else{var g=p,m=p,h=p;vr(p,function(e){e.x<g.x&&(g=e),e.x>m.x&&(m=e),e.depth>h.depth&&(h=e)});var y=s(g,m)/2-g.x,f=d[0]/(m.x+s(m,g)/2+y),x=d[1]/(h.depth||1);vr(p,function(e){e.x=(e.x+y)*f,e.y=e.depth*x})}return i}function t(e){for(var t={A:null,children:[e]},a=[t],o;null!=(o=a.pop());)for(var r=o.children,l=0,s=r.length,n;l<s;++l)a.push((r[l]=n={_:r[l],parent:o,children:(n=r[l].children)&&n.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:l}).a=n);return t.children[0]}function a(e){var t=e.children,a=e.parent.children,o=e.i?a[e.i-1]:null;if(t.length){$r(e);var i=(t[0].z+t[t.length-1].z)/2;o?(e.z=o.z+s(e._,o._),e.m=e.z-i):e.z=i}else o&&(e.z=o.z+s(e._,o._));e.parent.A=r(e,o,e.parent.A||a[0])}function o(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function r(e,t,a){if(t){for(var o=e,r=e,i=t,n=o.parent.children[0],l=o.m,d=r.m,c=i.m,p=n.m,u;i=Zr(i),o=Xr(o),i&&o;)n=Xr(n),r=Zr(r),r.a=e,u=i.z+c-o.z-l+s(i._,o._),0<u&&(Kr(Jr(i,e,a),e,u),l+=u,d+=u),c+=i.m,l+=o.m,p+=n.m,d+=r.m;i&&!Zr(r)&&(r.t=i,r.m+=c-d),o&&!Xr(n)&&(n.t=o,n.m+=l-p,a=e)}return a}function n(e){e.x*=d[0],e.y=e.depth*d[1]}var l=yn.layout.hierarchy().sort(null).value(null),s=Wr,d=[1,1],c=null;return e.separation=function(t){return arguments.length?(s=t,e):s},e.size=function(t){return arguments.length?(c=null==(d=t)?n:null,e):c?null:d},e.nodeSize=function(t){return arguments.length?(c=null==(d=t)?null:n,e):c?d:null},br(e,l)},yn.layout.cluster=function(){function e(e,n){var i=t.call(this,e,n),l=i[0],s=0,d;wr(l,function(e){var t=e.children;t&&t.length?(e.x=ei(t),e.y=Qr(t)):(e.x=d?s+=a(e,d):0,e.y=0,d=e)});var c=ti(l),p=ai(l),u=c.x-a(c,p)/2,g=p.x+a(p,c)/2;return wr(l,r?function(e){e.x=(e.x-l.x)*o[0],e.y=(l.y-e.y)*o[1]}:function(e){e.x=(e.x-u)/(g-u)*o[0],e.y=(1-(l.y?e.y/l.y:1))*o[1]}),i}var t=yn.layout.hierarchy().sort(null).value(null),a=Wr,o=[1,1],r=!1;return e.separation=function(t){return arguments.length?(a=t,e):a},e.size=function(t){return arguments.length?(r=null==(o=t),e):r?null:o},e.nodeSize=function(t){return arguments.length?(r=null!=(o=t),e):r?o:null},br(e,t)},yn.layout.treemap=function(){function e(e,t){for(var a=-1,o=e.length,r,n;++a<o;)n=(r=e[a]).value*(0>t?0:t),r.area=isNaN(n)||0>=n?0:n}function t(a){var i=a.children;if(i&&i.length){var l=c(a),s=[],d=i.slice(),p=1/0,m="slice"===g?l.dx:"dice"===g?l.dy:"slice-dice"===g?1&a.depth?l.dy:l.dx:A(l.dx,l.dy),h,y,f;for(e(d,l.dx*l.dy/a.value),s.area=0;0<(f=d.length);)s.push(h=d[f-1]),s.area+=h.area,"squarify"!==g||(y=o(s,m))<=p?(d.pop(),p=y):(s.area-=s.pop().area,r(s,m,l,!1),m=A(l.dx,l.dy),s.length=s.area=0,p=1/0);s.length&&(r(s,m,l,!0),s.length=s.area=0),i.forEach(t)}}function a(t){var o=t.children;if(o&&o.length){var i=c(t),n=o.slice(),l=[],s;for(e(n,i.dx*i.dy/t.value),l.area=0;s=n.pop();)l.push(s),l.area+=s.area,null!=s.z&&(r(l,s.z?i.dx:i.dy,i,!n.length),l.length=l.area=0);o.forEach(a)}}function o(e,t){for(var a=e.area,o=0,l=1/0,d=-1,c=e.length,n;++d<c;)(n=e[d].area)&&(n<l&&(l=n),n>o&&(o=n));return a*=a,t*=t,a?I(t*o*m/a,a/(t*l*m)):1/0}function r(e,t,a,r){var s=-1,d=e.length,n=a.x,c=a.y,p=t?l(e.area/t):0,u;if(t==a.dx){for((r||p>a.dy)&&(p=a.dy);++s<d;)u=e[s],u.x=n,u.y=c,u.dy=p,n+=u.dx=A(a.x+a.dx-n,p?l(u.area/p):0);u.z=!0,u.dx+=a.x+a.dx-n,a.y+=p,a.dy-=p}else{for((r||p>a.dx)&&(p=a.dx);++s<d;)u=e[s],u.x=n,u.y=c,u.dx=p,c+=u.dy=A(a.y+a.dy-c,p?l(u.area/p):0);u.z=!1,u.dy+=a.y+a.dy-c,a.x+=p,a.dx-=p}}function i(o){var r=h||n(o),i=r[0];return i.x=i.y=0,i.value?(i.dx=s[0],i.dy=s[1]):i.dx=i.dy=0,h&&n.revalue(i),e([i],i.dx*i.dy/i.value),(h?a:t)(i),p&&(h=r),r}var n=yn.layout.hierarchy(),l=_,s=[1,1],d=null,c=oi,p=!1,g="squarify",m=.5*(1+f(5)),h;return i.size=function(e){return arguments.length?(s=e,i):s},i.padding=function(e){function t(t){var a=e.call(i,t,t.depth);return null==a?oi(t):ri(t,"number"==typeof a?[a,a,a,a]:a)}function a(t){return ri(t,e)}if(!arguments.length)return d;var o;return c=null==(d=e)?oi:"function"==(o=typeof e)?t:"number"===o?(e=[e,e,e,e],a):a,i},i.round=function(e){return arguments.length?(l=e?_:Number,i):l!=Number},i.sticky=function(e){return arguments.length?(p=e,h=null,i):p},i.ratio=function(e){return arguments.length?(m=e,i):m},i.mode=function(e){return arguments.length?(g=e+"",i):g},br(i,n)},yn.random={normal:function(e,t){var a=arguments.length;return 2>a&&(t=1),1>a&&(e=0),function(){var a,o,i;do a=2*Math.random()-1,o=2*Math.random()-1,i=a*a+o*o;while(!i||1<i);return e+t*a*f(-2*u(i)/i)}},logNormal:function(){var e=yn.random.normal.apply(yn,arguments);return function(){return n(e())}},bates:function(e){var t=yn.random.irwinHall(e);return function(){return t()/e}},irwinHall:function(e){return function(){for(var t=0,a=0;a<e;a++)t+=Math.random();return t}}},yn.scale={};var ws={floor:H,ceil:H};yn.scale.linear=function(){return pi([0,1],[0,1],Vo,!1)};var ks={s:1,g:1,p:1,r:1,e:1};yn.scale.log=function(){return _i(yn.scale.linear().domain([0,1]),10,!0,[1,10])};var Ts=yn.format(".0e"),As={floor:function(e){return-h(-e)},ceil:function(e){return-P(-e)}};yn.scale.pow=function(){return bi(yn.scale.linear(),1,[0,1])},yn.scale.sqrt=function(){return yn.scale.pow().exponent(.5)},yn.scale.ordinal=function(){return wi([],{t:"range",a:[[]]})},yn.scale.category10=function(){return yn.scale.ordinal().range(Ss)},yn.scale.category20=function(){return yn.scale.ordinal().range(Cs)},yn.scale.category20b=function(){return yn.scale.ordinal().range(Ls)},yn.scale.category20c=function(){return yn.scale.ordinal().range(Es)};var Ss=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(qe),Cs=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(qe),Ls=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(qe),Es=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(qe);yn.scale.quantile=function(){return ki([],[])},yn.scale.quantize=function(){return Ti(0,1,[0,1])},yn.scale.threshold=function(){return Ai([.5],[0,1])},yn.scale.identity=function(){return Si([0,1])},yn.svg={},yn.svg.arc=function(){function e(){var e=I(0,+o.apply(this,arguments)),a=I(0,+i.apply(this,arguments)),p=s.apply(this,arguments)-m,u=d.apply(this,arguments)-m,h=E(u-p),y=p>u?0:1;if(a<e&&(v=a,a=e,e=v),h>=Vn-Bn)return t(a,y)+(e?t(e,1-y):"")+"Z";var x=0,_=0,b=[],v,w,k,S,C,L,P,z,D,O,R,M;if((S=(+c.apply(this,arguments)||0)/2)&&(k=l===Is?f(e*e+a*a):+l.apply(this,arguments),!y&&(_*=-1),a&&(_=Se(k/a*T(S))),e&&(x=Se(k/e*T(S)))),a){C=a*g(p+_),L=a*T(p+_),P=a*g(u-_),z=a*T(u-_);var j=E(u-p-2*_)<=Nn?0:1;if(_&&Di(C,L,P,z)===y^j){var B=(p+u)/2;C=a*g(B),L=a*T(B),P=z=null}}else C=L=0;if(e){D=e*g(u-x),O=e*T(u-x),R=e*g(p+x),M=e*T(p+x);var F=E(p-u+2*x)<=Nn?0:1;if(x&&Di(D,O,R,M)===1-y^F){var N=(p+u)/2;D=e*g(N),O=e*T(N),R=M=null}}else D=O=0;if(h>Bn&&.001<(v=A(E(a-e)/2,+n.apply(this,arguments)))){w=e<a^y?0:1;var V=v,U=v;if(h<Nn){var H=null==R?[D,O]:null==P?[C,L]:to([C,L],[R,M],[P,z],[D,O]),q=C-H[0],G=L-H[1],Y=P-H[0],W=z-H[1],X=1/T(r((q*Y+G*W)/(f(q*q+G*G)*f(Y*Y+W*W)))/2),Z=f(H[0]*H[0]+H[1]*H[1]);U=A(v,(e-Z)/(X-1)),V=A(v,(a-Z)/(X+1))}if(null!=P){var K=Oi(null==R?[D,O]:[R,M],[C,L],a,V,y),$=Oi([P,z],[D,O],a,V,y);v===V?b.push("M",K[0],"A",V,",",V," 0 0,",w," ",K[1],"A",a,",",a," 0 ",1-y^Di(K[1][0],K[1][1],$[1][0],$[1][1]),",",y," ",$[1],"A",V,",",V," 0 0,",w," ",$[0]):b.push("M",K[0],"A",V,",",V," 0 1,",w," ",$[0])}else b.push("M",C,",",L);if(null!=R){var J=Oi([C,L],[R,M],e,-U,y),Q=Oi([D,O],null==P?[C,L]:[P,z],e,-U,y);v===U?b.push("L",Q[0],"A",U,",",U," 0 0,",w," ",Q[1],"A",e,",",e," 0 ",y^Di(Q[1][0],Q[1][1],J[1][0],J[1][1]),",",1-y," ",J[1],"A",U,",",U," 0 0,",w," ",J[0]):b.push("L",Q[0],"A",U,",",U," 0 0,",w," ",J[0])}else b.push("L",D,",",O)}else b.push("M",C,",",L),null!=P&&b.push("A",a,",",a," 0 ",j,",",y," ",P,",",z),b.push("L",D,",",O),null!=R&&b.push("A",e,",",e," 0 ",F,",",1-y," ",R,",",M);return b.push("Z"),b.join("")}function t(e,t){return"M0,"+e+"A"+e+","+e+" 0 1,"+t+" 0,"+-e+"A"+e+","+e+" 0 1,"+t+" 0,"+e}var o=Li,i=Ei,n=Ci,l=Is,s=Ii,d=Pi,c=zi;return e.innerRadius=function(t){return arguments.length?(o=$e(t),e):o},e.outerRadius=function(t){return arguments.length?(i=$e(t),e):i},e.cornerRadius=function(t){return arguments.length?(n=$e(t),e):n},e.padRadius=function(t){return arguments.length?(l=t==Is?Is:$e(t),e):l},e.startAngle=function(t){return arguments.length?(s=$e(t),e):s},e.endAngle=function(t){return arguments.length?(d=$e(t),e):d},e.padAngle=function(t){return arguments.length?(c=$e(t),e):c},e.centroid=function(){var e=(+o.apply(this,arguments)+ +i.apply(this,arguments))/2,t=(+s.apply(this,arguments)+ +d.apply(this,arguments))/2-m;return[g(t)*e,T(t)*e]},e};var Is="auto";yn.svg.line=function(){return Ri(H)};var Ps=yn.map({linear:Mi,"linear-closed":ji,step:function(e){for(var t=0,a=e.length,o=e[0],r=[o[0],",",o[1]];++t<a;)r.push("H",(o[0]+(o=e[t])[0])/2,"V",o[1]);return 1<a&&r.push("H",o[0]),r.join("")},"step-before":Bi,"step-after":Fi,basis:Ui,"basis-open":function(e){if(4>e.length)return Mi(e);for(var t=[],a=-1,o=e.length,r=[0],n=[0],l;3>++a;)l=e[a],r.push(l[0]),n.push(l[1]);for(t.push(Hi(Os,r)+","+Hi(Os,n)),--a;++a<o;)l=e[a],r.shift(),r.push(l[0]),n.shift(),n.push(l[1]),qi(t,r,n);return t.join("")},"basis-closed":function(e){for(var t=-1,a=e.length,o=a+4,r=[],n=[],l,s;4>++t;)s=e[t%a],r.push(s[0]),n.push(s[1]);for(l=[Hi(Os,r),",",Hi(Os,n)],--t;++t<o;)s=e[t%a],r.shift(),r.push(s[0]),n.shift(),n.push(s[1]),qi(l,r,n);return l.join("")},bundle:function(e,a){var o=e.length-1;if(o)for(var r=e[0][0],n=e[0][1],l=e[o][0]-r,s=e[o][1]-n,d=-1,c,u;++d<=o;)c=e[d],u=d/o,c[0]=a*c[0]+(1-a)*(r+u*l),c[1]=a*c[1]+(1-a)*(n+u*s);return Ui(e)},cardinal:function(e,t){return 3>e.length?Mi(e):e[0]+Ni(e,Vi(e,t))},"cardinal-open":function(e,t){return 4>e.length?Mi(e):e[1]+Ni(e.slice(1,-1),Vi(e,t))},"cardinal-closed":function(e,t){return 3>e.length?ji(e):e[0]+Ni((e.push(e[0]),e),Vi([e[e.length-2]].concat(e,[e[1]]),t))},monotone:function(e){return 3>e.length?Mi(e):e[0]+Ni(e,Wi(e))}});Ps.forEach(function(e,t){t.key=e,t.closed=/-closed$/.test(e)});var zs=[0,2/3,1/3,0],Ds=[0,1/3,2/3,0],Os=[0,1/6,2/3,1/6];yn.svg.line.radial=function(){var e=Ri(Xi);return e.radius=e.x,delete e.x,e.angle=e.y,delete e.y,e},Bi.reverse=Fi,Fi.reverse=Bi,yn.svg.area=function(){return Zi(H)},yn.svg.area.radial=function(){var e=Zi(Xi);return e.radius=e.x,delete e.x,e.innerRadius=e.x0,delete e.x0,e.outerRadius=e.x1,delete e.x1,e.angle=e.y,delete e.y,e.startAngle=e.y0,delete e.y0,e.endAngle=e.y1,delete e.y1,e},yn.svg.chord=function(){function e(e,d){var i=a(this,l,e,d),s=a(this,c,e,d);return"M"+i.p0+r(i.r,i.p1,i.a1-i.a0)+(o(i,s)?n(i.r,i.p1,i.r,i.p0):n(i.r,i.p1,s.r,s.p0)+r(s.r,s.p1,s.a1-s.a0)+n(s.r,s.p1,i.r,i.p0))+"Z"}function a(e,t,a,o){var i=t.call(e,a,o),n=p.call(e,i,o),r=u.call(e,i,o)-m,l=h.call(e,i,o)-m;return{r:n,a0:r,a1:l,p0:[n*g(r),n*T(r)],p1:[n*g(l),n*T(l)]}}function o(e,t){return e.a0==t.a0&&e.a1==t.a1}function r(e,t,o){return"A"+e+","+e+" 0 "+ +(o>Nn)+",1 "+t}function n(e,t,a,o){return"Q 0,0 "+o}var l=Va,c=Ua,p=Ki,u=Ii,h=Pi;return e.radius=function(t){return arguments.length?(p=$e(t),e):p},e.source=function(t){return arguments.length?(l=$e(t),e):l},e.target=function(t){return arguments.length?(c=$e(t),e):c},e.startAngle=function(t){return arguments.length?(u=$e(t),e):u},e.endAngle=function(t){return arguments.length?(h=$e(t),e):h},e},yn.svg.diagonal=function(){function e(e,r){var i=t.call(this,e,r),n=a.call(this,e,r),l=(i.y+n.y)/2,s=[i,{x:i.x,y:l},{x:n.x,y:l},n];return s=s.map(o),"M"+s[0]+"C"+s[1]+" "+s[2]+" "+s[3]}var t=Va,a=Ua,o=$i;return e.source=function(a){return arguments.length?(t=$e(a),e):t},e.target=function(t){return arguments.length?(a=$e(t),e):a},e.projection=function(t){return arguments.length?(o=t,e):o},e},yn.svg.diagonal.radial=function(){var e=yn.svg.diagonal(),t=$i,a=e.projection;return e.projection=function(e){return arguments.length?a(Ji(t=e)):t},e},yn.svg.symbol=function(){function e(e,o){return(Rs.get(t.call(this,e,o))||tn)(a.call(this,e,o))}var t=en,a=Qi;return e.type=function(a){return arguments.length?(t=$e(a),e):t},e.size=function(t){return arguments.length?(a=$e(t),e):a},e};var Rs=yn.map({circle:tn,cross:function(e){var t=f(e/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(e){var t=f(e/(2*js)),a=t*js;return"M0,"+-t+"L"+a+",0 0,"+t+" "+-a+",0Z"},square:function(e){var t=f(e)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(e){var t=f(e/Ms),a=t*Ms/2;return"M0,"+a+"L"+t+","+-a+" "+-t+","+-a+"Z"},"triangle-up":function(e){var t=f(e/Ms),a=t*Ms/2;return"M0,"+-a+"L"+t+","+a+" "+-t+","+a+"Z"}});yn.svg.symbolTypes=Rs.keys();var Ms=f(3),js=C(30*Un);Pn.transition=function(e){for(var t=Vs||++Ns,a=ln(e),o=[],r=Us||{time:Date.now(),ease:Xo,delay:0,duration:250},l=-1,s=this.length,d,c;++l<s;){o.push(d=[]);for(var p=this[l],u=-1,g=p.length;++u<g;)(c=p[u])&&sn(c,u,a,t,r),d.push(c)}return on(o,a,t)},Pn.interrupt=function(e){return this.each(null==e?Bs:an(ln(e)))};var Bs=an(ln()),Fs=[],Ns=0,Vs,Us;Fs.call=Pn.call,Fs.empty=Pn.empty,Fs.node=Pn.node,Fs.size=Pn.size,yn.transition=function(e,t){return e&&e.transition?Vs?e.transition(t):e:yn.selection().transition(e)},yn.transition.prototype=Fs,Fs.select=function(e){var t=this.id,a=this.namespace,o=[],r,l,s;e=Q(e);for(var d=-1,c=this.length;++d<c;){o.push(r=[]);for(var p=this[d],u=-1,g=p.length;++u<g;)(s=p[u])&&(l=e.call(s,s.__data__,u,d))?("__data__"in s&&(l.__data__=s.__data__),sn(l,u,a,t,s[a][t]),r.push(l)):r.push(null)}return on(o,a,t)},Fs.selectAll=function(e){var t=this.id,a=this.namespace,r=[],l,s,d,c,p;e=ee(e);for(var u=-1,g=this.length;++u<g;)for(var m=this[u],h=-1,y=m.length;++h<y;)if(d=m[h]){p=d[a][t],s=e.call(d,d.__data__,h,u),r.push(l=[]);for(var n=-1,f=s.length;++n<f;)(c=s[n])&&sn(c,n,a,t,p),l.push(c)}return on(r,a,t)},Fs.filter=function(e){var t=[],a,o,r;"function"!=typeof e&&(e=ue(e));for(var l=0,s=this.length;l<s;l++){t.push(a=[]);for(var o=this[l],d=0,c=o.length;d<c;d++)(r=o[d])&&e.call(r,r.__data__,d,l)&&a.push(r)}return on(t,this.namespace,this.id)},Fs.tween=function(e,t){var a=this.id,o=this.namespace;return 2>arguments.length?this.node()[o][a].tween.get(e):me(this,null==t?function(t){t[o][a].tween.remove(e)}:function(r){r[o][a].tween.set(e,t)})},Fs.attr=function(e,t){function a(){this.removeAttribute(n)}function o(){this.removeAttributeNS(n.space,n.local)}if(2>arguments.length){for(t in e)this.attr(t,e[t]);return this}var r="transform"==e?dr:Vo,n=yn.ns.qualify(e);return rn(this,"attr."+e,t,n.local?function(e){return null==e?o:(e+="",function(){var t=this.getAttributeNS(n.space,n.local),a;return t!==e&&(a=r(t,e),function(e){this.setAttributeNS(n.space,n.local,a(e))})})}:function(e){return null==e?a:(e+="",function(){var t=this.getAttribute(n),a;return t!==e&&(a=r(t,e),function(e){this.setAttribute(n,a(e))})})})},Fs.attrTween=function(e,t){var a=yn.ns.qualify(e);return this.tween("attr."+e,a.local?function(e,o){var r=t.call(this,e,o,this.getAttributeNS(a.space,a.local));return r&&function(e){this.setAttributeNS(a.space,a.local,r(e))}}:function(e,o){var r=t.call(this,e,o,this.getAttribute(a));return r&&function(e){this.setAttribute(a,r(e))}})},Fs.style=function(e,t,a){function o(){this.style.removeProperty(e)}var r=arguments.length;if(3>r){if("string"!=typeof e){for(a in 2>r&&(t=""),e)this.style(a,e[a],t);return this}a=""}return rn(this,"style."+e,t,function(t){return null==t?o:(t+="",function(){var o=l(this).getComputedStyle(this,null).getPropertyValue(e),r;return o!==t&&(r=Vo(o,t),function(o){this.style.setProperty(e,r(o),a)})})})},Fs.styleTween=function(e,t,a){return 3>arguments.length&&(a=""),this.tween("style."+e,function(o,r){var i=t.call(this,o,r,l(this).getComputedStyle(this,null).getPropertyValue(e));return i&&function(o){this.style.setProperty(e,i(o),a)}})},Fs.text=function(e){return rn(this,"text",e,nn)},Fs.remove=function(){var e=this.namespace;return this.each("end.transition",function(){var t;2>this[e].count&&(t=this.parentNode)&&t.removeChild(this)})},Fs.ease=function(e){var t=this.id,a=this.namespace;return 1>arguments.length?this.node()[a][t].ease:("function"!=typeof e&&(e=yn.ease.apply(yn,arguments)),me(this,function(o){o[a][t].ease=e}))},Fs.delay=function(e){var t=this.id,a=this.namespace;return 1>arguments.length?this.node()[a][t].delay:me(this,"function"==typeof e?function(o,r,i){o[a][t].delay=+e.call(o,o.__data__,r,i)}:(e=+e,function(o){o[a][t].delay=e}))},Fs.duration=function(e){var t=this.id,a=this.namespace;return 1>arguments.length?this.node()[a][t].duration:me(this,"function"==typeof e?function(o,r,i){o[a][t].duration=I(1,e.call(o,o.__data__,r,i))}:(e=I(1,e),function(o){o[a][t].duration=e}))},Fs.each=function(e,t){var a=this.id,o=this.namespace;if(2>arguments.length){var r=Us,i=Vs;try{Vs=a,me(this,function(t,r,i){Us=t[o][a],e.call(t,t.__data__,r,i)})}finally{Us=r,Vs=i}}else me(this,function(r){var i=r[o][a];(i.event||(i.event=yn.dispatch("start","end","interrupt"))).on(e,t)});return this},Fs.transition=function(){for(var e=this.id,t=++Ns,a=this.namespace,o=[],r=0,l=this.length,s,d,c,p;r<l;r++){o.push(s=[]);for(var d=this[r],u=0,g=d.length;u<g;u++)(c=d[u])&&(p=c[a][e],sn(c,u,a,t,{time:p.time,ease:p.ease,delay:p.delay+p.duration,duration:p.duration})),s.push(c)}return on(o,a,t)},yn.svg.axis=function(){function e(e){e.each(function(){var e=yn.select(this),d=this.__chart__||t,c=this.__chart__=t.copy(),p=null==l?c.ticks?c.ticks.apply(c,n):c.domain():l,u=null==s?c.tickFormat?c.tickFormat.apply(c,n):H:s,g=e.selectAll(".tick").data(p,c),m=g.enter().insert("g",".domain").attr("class","tick").style("opacity",Bn),h=yn.transition(g.exit()).style("opacity",Bn).remove(),y=yn.transition(g.order()).style("opacity",1),f=I(o,0)+i,_=ni(c),b=e.selectAll(".domain").data([0]),v=(b.enter().append("path").attr("class","domain"),yn.transition(b)),w;m.append("line"),m.append("text");var k=m.select("line"),T=y.select("line"),A=g.select("text").text(u),S=m.select("text"),C=y.select("text"),L="top"===a||"left"===a?-1:1,E,P,z,D;if("bottom"===a||"top"===a?(w=dn,E="x",z="y",P="x2",D="y2",A.attr("dy",0>L?"0em":".71em").style("text-anchor","middle"),v.attr("d","M"+_[0]+","+L*r+"V0H"+_[1]+"V"+L*r)):(w=cn,E="y",z="x",P="y2",D="x2",A.attr("dy",".32em").style("text-anchor",0>L?"end":"start"),v.attr("d","M"+L*r+","+_[0]+"H0V"+_[1]+"H"+L*r)),k.attr(D,L*o),S.attr(z,L*f),T.attr(P,0).attr(D,L*o),C.attr(E,0).attr(z,L*f),c.rangeBand){var O=c,x=O.rangeBand()/2;d=c=function(e){return O(e)+x}}else d.rangeBand?d=c:h.call(w,c,d);m.call(w,d,c),y.call(w,c,c)})}var t=yn.scale.linear(),a=Hs,o=6,r=6,i=3,n=[10],l=null,s;return e.scale=function(a){return arguments.length?(t=a,e):t},e.orient=function(t){return arguments.length?(a=t in qs?t+"":Hs,e):a},e.ticks=function(){return arguments.length?(n=dt(arguments),e):n},e.tickValues=function(t){return arguments.length?(l=t,e):l},e.tickFormat=function(t){return arguments.length?(s=t,e):s},e.tickSize=function(t){var a=arguments.length;return a?(o=+t,r=+arguments[a-1],e):o},e.innerTickSize=function(t){return arguments.length?(o=+t,e):o},e.outerTickSize=function(t){return arguments.length?(r=+t,e):r},e.tickPadding=function(t){return arguments.length?(i=+t,e):i},e.tickSubdivide=function(){return arguments.length&&e},e};var Hs="bottom",qs={top:1,right:1,bottom:1,left:1};yn.svg.brush=function(){function e(i){i.each(function(){var i=yn.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",r).on("touchstart.brush",r),l=i.selectAll(".background").data([0]);l.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),i.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var d=i.selectAll(".resize").data(m,H);d.exit().remove(),d.enter().append("g").attr("class",function(e){return"resize "+e}).style("cursor",function(e){return Gs[e]}).append("rect").attr("x",function(e){return /[ew]$/.test(e)?-3:null}).attr("y",function(e){return /^[ns]/.test(e)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),d.style("display",e.empty()?"none":null);var c=yn.transition(i),p=yn.transition(l),u;n&&(u=ni(n),p.attr("x",u[0]).attr("width",u[1]-u[0]),a(c)),s&&(u=ni(s),p.attr("y",u[0]).attr("height",u[1]-u[0]),o(c)),t(c)})}function t(e){e.selectAll(".resize").attr("transform",function(e){return"translate("+c[+/e$/.test(e)]+","+p[+/^s/.test(e)]+")"})}function a(e){e.select(".extent").attr("x",c[0]),e.selectAll(".extent,.n>rect,.s>rect").attr("width",c[1]-c[0])}function o(e){e.select(".extent").attr("y",p[0]),e.selectAll(".extent,.e>rect,.w>rect").attr("height",p[1]-p[0])}function r(){function r(){32==yn.event.keyCode&&(!L&&(w=null,P[0]-=c[1],P[1]-=p[1],L=2),Z())}function d(){32==yn.event.keyCode&&2==L&&(P[0]+=c[1],P[1]+=p[1],L=0,Z())}function m(){var e=yn.mouse(_),r=!1;D&&(e[0]+=D[0],e[1]+=D[1]),L||(yn.event.altKey?(!w&&(w=[(c[0]+c[1])/2,(p[0]+p[1])/2]),P[0]=c[+(e[0]<w[0])],P[1]=p[+(e[1]<w[1])]):w=null),S&&y(e,n,0)&&(a(k),r=!0),C&&y(e,s,1)&&(o(k),r=!0),r&&(t(k),v({type:"brush",mode:L?"move":"resize"}))}function y(e,t,a){var o=ni(t),r=o[0],i=o[1],n=P[a],l=a?p:c,s=l[1]-l[0],d,m;if(L&&(r-=n,i-=s+n),d=(a?g:u)?I(r,A(i,e[a])):e[a],L?m=(d+=n)+s:(w&&(n=I(r,A(i,2*w[a]-d))),n<d?(m=d,d=n):m=n),l[0]!=d||l[1]!=m)return a?f=null:h=null,l[0]=d,l[1]=m,!0}function x(){m(),k.style("pointer-events","all").selectAll(".resize").style("display",e.empty()?"none":null),yn.select("body").style("cursor",null),z.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),E(),v({type:"brushend"})}var _=this,b=yn.select(yn.event.target),v=i.of(_,arguments),k=yn.select(_),T=b.datum(),S=!/^(n|s)$/.test(T)&&n,C=!/^(e|w)$/.test(T)&&s,L=b.classed("extent"),E=be(_),P=yn.mouse(_),z=yn.select(l(_)).on("keydown.brush",r).on("keyup.brush",d),w,D;if(yn.event.changedTouches?z.on("touchmove.brush",m).on("touchend.brush",x):z.on("mousemove.brush",m).on("mouseup.brush",x),k.interrupt().selectAll("*").interrupt(),L)P[0]=c[0]-P[0],P[1]=p[0]-P[1];else if(T){var O=+/w$/.test(T),R=+/^n/.test(T);D=[c[1-O]-P[0],p[1-R]-P[1]],P[0]=c[O],P[1]=p[R]}else yn.event.altKey&&(w=P.slice());k.style("pointer-events","none").selectAll(".resize").style("display",null),yn.select("body").style("cursor",b.style("cursor")),v({type:"brushstart"}),m()}var i=$(e,"brushstart","brush","brushend"),n=null,s=null,c=[0,0],p=[0,0],u=!0,g=!0,m=Ys[0],h,f;return e.event=function(e){e.each(function(){var e=i.of(this,arguments),a={x:c,y:p,i:h,j:f},o=this.__chart__||a;this.__chart__=a,Vs?yn.select(this).transition().each("start.brush",function(){h=o.i,f=o.j,c=o.x,p=o.y,e({type:"brushstart"})}).tween("brush:brush",function(){var o=Uo(c,a.x),r=Uo(p,a.y);return h=f=null,function(i){c=a.x=o(i),p=a.y=r(i),e({type:"brush",mode:"resize"})}}).each("end.brush",function(){h=a.i,f=a.j,e({type:"brush",mode:"resize"}),e({type:"brushend"})}):(e({type:"brushstart"}),e({type:"brush",mode:"resize"}),e({type:"brushend"}))})},e.x=function(t){return arguments.length?(n=t,m=Ys[!n<<1|!s],e):n},e.y=function(t){return arguments.length?(s=t,m=Ys[!n<<1|!s],e):s},e.clamp=function(t){return arguments.length?(n&&s?(u=!!t[0],g=!!t[1]):n?u=!!t:s&&(g=!!t),e):n&&s?[u,g]:n?u:s?g:null},e.extent=function(a){var o,r,i,l,d;return arguments.length?(n&&(o=a[0],r=a[1],s&&(o=o[0],r=r[0]),h=[o,r],n.invert&&(o=n(o),r=n(r)),r<o&&(d=o,o=r,r=d),(o!=c[0]||r!=c[1])&&(c=[o,r])),s&&(i=a[0],l=a[1],n&&(i=i[1],l=l[1]),f=[i,l],s.invert&&(i=s(i),l=s(l)),l<i&&(d=i,i=l,l=d),(i!=p[0]||l!=p[1])&&(p=[i,l])),e):(n&&(h?(o=h[0],r=h[1]):(o=c[0],r=c[1],n.invert&&(o=n.invert(o),r=n.invert(r)),r<o&&(d=o,o=r,r=d))),s&&(f?(i=f[0],l=f[1]):(i=p[0],l=p[1],s.invert&&(i=s.invert(i),l=s.invert(l)),l<i&&(d=i,i=l,l=d))),n&&s?[[o,i],[r,l]]:n?[o,r]:s&&[i,l])},e.clear=function(){return e.empty()||(c=[0,0],p=[0,0],h=f=null),e},e.empty=function(){return!!n&&c[0]==c[1]||!!s&&p[0]==p[1]},yn.rebind(e,i,"on")};var Gs={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Ys=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Ws=ul.format=_l.timeFormat,Xs=Ws.utc,Zs=Xs("%Y-%m-%dT%H:%M:%S.%LZ");Ws.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?pn:Zs,pn.parse=function(e){var t=new Date(e);return isNaN(t)?null:t},pn.toString=Zs.toString,ul.second=pt(function(e){return new ml(1e3*P(e/1e3))},function(e,t){e.setTime(e.getTime()+1e3*P(t))},function(e){return e.getSeconds()}),ul.seconds=ul.second.range,ul.seconds.utc=ul.second.utc.range,ul.minute=pt(function(e){return new ml(6e4*P(e/6e4))},function(e,t){e.setTime(e.getTime()+6e4*P(t))},function(e){return e.getMinutes()}),ul.minutes=ul.minute.range,ul.minutes.utc=ul.minute.utc.range,ul.hour=pt(function(e){var t=e.getTimezoneOffset()/60;return new ml(36e5*(P(e/36e5-t)+t))},function(e,t){e.setTime(e.getTime()+36e5*P(t))},function(e){return e.getHours()}),ul.hours=ul.hour.range,ul.hours.utc=ul.hour.utc.range,ul.month=pt(function(e){return e=ul.day(e),e.setDate(1),e},function(e,t){e.setMonth(e.getMonth()+t)},function(e){return e.getMonth()}),ul.months=ul.month.range,ul.months.utc=ul.month.utc.range;var Ks=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],$s=[[ul.second,1],[ul.second,5],[ul.second,15],[ul.second,30],[ul.minute,1],[ul.minute,5],[ul.minute,15],[ul.minute,30],[ul.hour,1],[ul.hour,3],[ul.hour,6],[ul.hour,12],[ul.day,1],[ul.day,2],[ul.week,1],[ul.month,1],[ul.month,3],[ul.year,1]],Js=Ws.multi([[".%L",function(e){return e.getMilliseconds()}],[":%S",function(e){return e.getSeconds()}],["%I:%M",function(e){return e.getMinutes()}],["%I %p",function(e){return e.getHours()}],["%a %d",function(e){return e.getDay()&&1!=e.getDate()}],["%b %d",function(e){return 1!=e.getDate()}],["%B",function(e){return e.getMonth()}],["%Y",ea]]),Qs={range:function(e,t,a){return yn.range(h(e/a)*a,+t,a).map(gn)},floor:H,ceil:H};$s.year=ul.year,ul.scale=function(){return un(yn.scale.linear(),$s,Js)};var ed=$s.map(function(e){return[e[0].utc,e[1]]}),td=Xs.multi([[".%L",function(e){return e.getUTCMilliseconds()}],[":%S",function(e){return e.getUTCSeconds()}],["%I:%M",function(e){return e.getUTCMinutes()}],["%I %p",function(e){return e.getUTCHours()}],["%a %d",function(e){return e.getUTCDay()&&1!=e.getUTCDate()}],["%b %d",function(e){return 1!=e.getUTCDate()}],["%B",function(e){return e.getUTCMonth()}],["%Y",ea]]);ed.year=ul.year.utc,ul.scale.utc=function(){return un(yn.scale.linear(),ed,td)},yn.text=Je(function(e){return e.responseText}),yn.json=function(e,t){return Qe(e,"application/json",mn,t)},yn.html=function(e,t){return Qe(e,"text/html",hn,t)},yn.xml=Je(function(e){return e.responseXML}),"function"==typeof define&&define.amd?(this.d3=yn,define(yn)):"object"==typeof t&&t.exports?t.exports=yn:this.d3=yn}()},{}],109:[function(e,t,a){var o=Math.LN10,r=Math.log,i=Math.round,n=Math.min,l=Math.pow,s=Math.abs,d=Math.max,u=Math.floor;(function(e,o){"object"==typeof a&&"undefined"!=typeof t?o(a):"function"==typeof define&&define.amd?define(["exports"],o):o(e.dat={})})(this,function(e){'use strict';function t(e,t){var o=e.__state.conversionName.toString(),n=i(e.r),r=i(e.g),l=i(e.b),d=e.a,a=i(e.h),c=e.s.toFixed(1),s=e.v.toFixed(1);if(t||"THREE_CHAR_HEX"===o||"SIX_CHAR_HEX"===o){for(var p=e.hex.toString(16);6>p.length;)p="0"+p;return"#"+p}return"CSS_RGB"===o?"rgb("+n+","+r+","+l+")":"CSS_RGBA"===o?"rgba("+n+","+r+","+l+","+d+")":"HEX"===o?"0x"+e.hex.toString(16):"RGB_ARRAY"===o?"["+n+","+r+","+l+"]":"RGBA_ARRAY"===o?"["+n+","+r+","+l+","+d+"]":"RGB_OBJ"===o?"{r:"+n+",g:"+r+",b:"+l+"}":"RGBA_OBJ"===o?"{r:"+n+",g:"+r+",b:"+l+",a:"+d+"}":"HSV_OBJ"===o?"{h:"+a+",s:"+c+",v:"+s+"}":"HSVA_OBJ"===o?"{h:"+a+",s:"+c+",v:"+s+",a:"+d+"}":"unknown format"}function a(e,t,a){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space?this.__state[t]:(X.recalculateRGB(this,t,a),this.__state[t])},set:function(e){"RGB"!==this.__state.space&&(X.recalculateRGB(this,t,a),this.__state.space="RGB"),this.__state[t]=e}})}function c(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space?this.__state[t]:(X.recalculateHSV(this),this.__state[t])},set:function(e){"HSV"!==this.__state.space&&(X.recalculateHSV(this),this.__state.space="HSV"),this.__state[t]=e}})}function p(e){if("0"===e||R.isUndefined(e))return 0;var t=e.match($);return R.isNull(t)?0:parseFloat(t[1])}function g(e){var t=e.toString();return-1<t.indexOf(".")?t.length-t.indexOf(".")-1:0}function m(e,t){var a=l(10,t);return i(e*a)/a}function h(e,t,a,o,r){return o+(r-o)*((e-t)/(a-t))}function y(e,t,o,a){e.style.background="",R.each(le,function(r){e.style.cssText+="background: "+r+"linear-gradient("+t+", "+o+" 0%, "+a+" 100%); "})}function f(e){e.style.background="",e.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",e.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}function x(e,t,a){var o=document.createElement("li");return t&&o.appendChild(t),a?e.__ul.insertBefore(o,a):e.__ul.appendChild(o),e.onResize(),o}function _(e){J.unbind(window,"resize",e.__resizeHandler),e.saveToLocalStorageIfPossible&&J.unbind(window,"unload",e.saveToLocalStorageIfPossible)}function b(e,t){var a=e.__preset_select[e.__preset_select.selectedIndex];a.innerHTML=t?a.value+"*":a.value}function v(e,t,a){if(a.__li=t,a.__gui=e,R.extend(a,{options:function(t){if(1<arguments.length){var o=a.__li.nextElementSibling;return a.remove(),k(e,a.object,a.property,{before:o,factoryArgs:[R.toArray(arguments)]})}if(R.isArray(t)||R.isObject(t)){var r=a.__li.nextElementSibling;return a.remove(),k(e,a.object,a.property,{before:r,factoryArgs:[t]})}},name:function(e){return a.__li.firstElementChild.firstElementChild.innerHTML=e,a},listen:function(){return a.__gui.listen(a),a},remove:function(){return a.__gui.remove(a),a}}),a instanceof re){var o=new oe(a.object,a.property,{min:a.__min,max:a.__max,step:a.__step});R.each(["updateDisplay","onChange","onFinishChange","step","min","max"],function(e){var t=a[e],r=o[e];a[e]=o[e]=function(){var e=Array.prototype.slice.call(arguments);return r.apply(o,e),t.apply(a,e)}}),J.addClass(t,"has-slider"),a.domElement.insertBefore(o.domElement,a.domElement.firstElementChild)}else if(a instanceof oe){var i=function(t){if(R.isNumber(a.__min)&&R.isNumber(a.__max)){var o=a.__li.firstElementChild.firstElementChild.innerHTML,r=-1<a.__gui.__listening.indexOf(a);a.remove();var i=k(e,a.object,a.property,{before:a.__li.nextElementSibling,factoryArgs:[a.__min,a.__max,a.__step]});return i.name(o),r&&i.listen(),i}return t};a.min=R.compose(i,a.min),a.max=R.compose(i,a.max)}else a instanceof Q?(J.bind(t,"click",function(){J.fakeEvent(a.__checkbox,"click")}),J.bind(a.__checkbox,"click",function(t){t.stopPropagation()})):a instanceof ie?(J.bind(t,"click",function(){J.fakeEvent(a.__button,"click")}),J.bind(t,"mouseover",function(){J.addClass(a.__button,"hover")}),J.bind(t,"mouseout",function(){J.removeClass(a.__button,"hover")})):a instanceof ne&&(J.addClass(t,"color"),a.updateDisplay=R.compose(function(e){return t.style.borderLeftColor=a.__color.toString(),e},a.updateDisplay),a.updateDisplay());a.setValue=R.compose(function(t){return e.getRoot().__preset_select&&a.isModified()&&b(e.getRoot(),!0),t},a.setValue)}function w(e,t){var a=e.getRoot(),o=a.__rememberedObjects.indexOf(t.object);if(-1!==o){var r=a.__rememberedObjectIndecesToControllers[o];if(void 0===r&&(r={},a.__rememberedObjectIndecesToControllers[o]=r),r[t.property]=t,a.load&&a.load.remembered){var i=a.load.remembered,n=void 0;if(i[e.preset])n=i[e.preset];else if(i.Default)n=i.Default;else return;if(n[o]&&void 0!==n[o][t.property]){var l=n[o][t.property];t.initialValue=l,t.setValue(l)}}}}function k(e,t,a,o){if(void 0===t[a])throw new Error("Object \""+t+"\" has no property \""+a+"\"");var r;if(o.color)r=new ne(t,a);else{var i=[t,a].concat(o.factoryArgs);r=se.apply(e,i)}o.before instanceof Z&&(o.before=o.before.__li),w(e,r),J.addClass(r.domElement,"c");var n=document.createElement("span");J.addClass(n,"property-name"),n.innerHTML=r.property;var l=document.createElement("div");l.appendChild(n),l.appendChild(r.domElement);var s=x(e,l,o.before);return J.addClass(s,ve.CLASS_CONTROLLER_ROW),r instanceof ne?J.addClass(s,"color"):J.addClass(s,U(r.getValue())),v(e,s,r),e.__controllers.push(r),r}function T(e,t){return document.location.href+"."+t}function A(e,t,a){var o=document.createElement("option");o.innerHTML=t,o.value=t,e.__preset_select.appendChild(o),a&&(e.__preset_select.selectedIndex=e.__preset_select.length-1)}function S(e,t){t.style.display=e.useLocalStorage?"block":"none"}function C(e){var t=e.__save_row=document.createElement("li");J.addClass(e.domElement,"has-save"),e.__ul.insertBefore(t,e.__ul.firstChild),J.addClass(t,"save-row");var a=document.createElement("span");a.innerHTML="&nbsp;",J.addClass(a,"button gears");var o=document.createElement("span");o.innerHTML="Save",J.addClass(o,"button"),J.addClass(o,"save");var r=document.createElement("span");r.innerHTML="New",J.addClass(r,"button"),J.addClass(r,"save-as");var i=document.createElement("span");i.innerHTML="Revert",J.addClass(i,"button"),J.addClass(i,"revert");var n=e.__preset_select=document.createElement("select");if(e.load&&e.load.remembered?R.each(e.load.remembered,function(t,a){A(e,a,a===e.preset)}):A(e,"Default",!1),J.bind(n,"change",function(){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].innerHTML=e.__preset_select[t].value;e.preset=this.value}),t.appendChild(n),t.appendChild(a),t.appendChild(o),t.appendChild(r),t.appendChild(i),he){var l=document.getElementById("dg-local-explain"),s=document.getElementById("dg-local-storage"),d=document.getElementById("dg-save-locally");d.style.display="block","true"===localStorage.getItem(T(e,"isLocal"))&&s.setAttribute("checked","checked"),S(e,l),J.bind(s,"change",function(){e.useLocalStorage=!e.useLocalStorage,S(e,l)})}var c=document.getElementById("dg-new-constructor");J.bind(c,"keydown",function(t){t.metaKey&&(67===t.which||67===t.keyCode)&&ye.hide()}),J.bind(a,"click",function(){c.innerHTML=JSON.stringify(e.getSaveObject(),void 0,2),ye.show(),c.focus(),c.select()}),J.bind(o,"click",function(){e.save()}),J.bind(r,"click",function(){var t=prompt("Enter a new preset name.");t&&e.saveAs(t)}),J.bind(i,"click",function(){e.revert()})}function L(t){function a(a){return a.preventDefault(),t.width+=i-a.clientX,t.onResize(),i=a.clientX,!1}function o(){J.removeClass(t.__closeButton,ve.CLASS_DRAG),J.unbind(window,"mousemove",a),J.unbind(window,"mouseup",o)}function r(r){return r.preventDefault(),i=r.clientX,J.addClass(t.__closeButton,ve.CLASS_DRAG),J.bind(window,"mousemove",a),J.bind(window,"mouseup",o),!1}var i;t.__resize_handle=document.createElement("div"),R.extend(t.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),J.bind(t.__resize_handle,"mousedown",r),J.bind(t.__closeButton,"mousedown",r),t.domElement.insertBefore(t.__resize_handle,t.domElement.firstElementChild)}function E(e,t){e.domElement.style.width=t+"px",e.__save_row&&e.autoPlace&&(e.__save_row.style.width=t+"px"),e.__closeButton&&(e.__closeButton.style.width=t+"px")}function I(e,t){var a={};return R.each(e.__rememberedObjects,function(o,r){var i={},n=e.__rememberedObjectIndecesToControllers[r];R.each(n,function(e,a){i[a]=t?e.initialValue:e.getValue()}),a[r]=i}),a}function P(e){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].value===e.preset&&(e.__preset_select.selectedIndex=t)}function z(e){0!==e.length&&de.call(window,function(){z(e)}),R.each(e,function(e){e.updateDisplay()})}var D=Array.prototype.forEach,O=Array.prototype.slice,R={BREAK:{},extend:function(e){return this.each(O.call(arguments,1),function(t){var a=this.isObject(t)?Object.keys(t):[];a.forEach(function(a){this.isUndefined(t[a])||(e[a]=t[a])}.bind(this))},this),e},defaults:function(e){return this.each(O.call(arguments,1),function(t){var a=this.isObject(t)?Object.keys(t):[];a.forEach(function(a){this.isUndefined(e[a])&&(e[a]=t[a])}.bind(this))},this),e},compose:function(){var e=O.call(arguments);return function(){for(var t=O.call(arguments),a=e.length-1;0<=a;a--)t=[e[a].apply(this,t)];return t[0]}},each:function(e,t,a){if(e)if(D&&e.forEach&&e.forEach===D)e.forEach(t,a);else if(e.length===e.length+0){var o=void 0,r=void 0;for(o=0,r=e.length;o<r;o++)if(o in e&&t.call(a,e[o],o)===this.BREAK)return}else for(var i in e)if(t.call(a,e[i],i)===this.BREAK)return},defer:function(e){setTimeout(e,0)},debounce:function(e,t,a){var o;return function(){var r=this,i=arguments,n=a||!o;clearTimeout(o),o=setTimeout(function(){o=null,a||e.apply(r,i)},t),n&&e.apply(r,i)}},toArray:function(e){return e.toArray?e.toArray():O.call(e)},isUndefined:function(e){return e===void 0},isNull:function(e){return null===e},isNaN:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return isNaN(e)}),isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return!1===e||!0===e},isFunction:function(e){return e instanceof Function}},M=[{litmus:R.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:t},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:t},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:t},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:t}}},{litmus:R.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:R.isArray,conversions:{RGB_ARRAY:{read:function(e){return!(3!==e.length)&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return!(4!==e.length)&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:R.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(R.isNumber(e.r)&&R.isNumber(e.g)&&R.isNumber(e.b)&&R.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(R.isNumber(e.r)&&R.isNumber(e.g)&&R.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(R.isNumber(e.h)&&R.isNumber(e.s)&&R.isNumber(e.v)&&R.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(R.isNumber(e.h)&&R.isNumber(e.s)&&R.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],j=void 0,B=void 0,F=function(){B=!1;var e=1<arguments.length?R.toArray(arguments):arguments[0];return R.each(M,function(t){if(t.litmus(e))return R.each(t.conversions,function(t,a){if(j=t.read(e),!1===B&&!1!==j)return B=j,j.conversionName=a,j.conversion=t,R.BREAK}),R.BREAK}),B},N=void 0,V={hsv_to_rgb:function(e,a,o){var r=u(e/60)%6,i=e/60-u(e/60),n=o*(1-a),l=o*(1-i*a),s=o*(1-(1-i)*a),t=[[o,s,n],[l,o,n],[n,o,s],[n,l,o],[s,n,o],[o,n,l]][r];return{r:255*t[0],g:255*t[1],b:255*t[2]}},rgb_to_hsv:function(e,t,a){var o=n(e,t,a),r=d(e,t,a),i=r-o,l=void 0,c=void 0;if(0!==r)c=i/r;else return{h:NaN,s:0,v:0};return l=e===r?(t-a)/i:t===r?2+(a-e)/i:4+(e-t)/i,l/=6,0>l&&(l+=1),{h:360*l,s:c,v:r/255}},rgb_to_hex:function(e,t,a){var o=this.hex_with_component(0,2,e);return o=this.hex_with_component(o,1,t),o=this.hex_with_component(o,0,a),o},component_from_hex:function(e,t){return 255&e>>8*t},hex_with_component:function(e,t,a){return a<<(N=8*t)|e&~(255<<N)}},U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},H=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},q=function(){function e(e,t){for(var a=0,o;a<t.length;a++)o=t[a],o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}return function(t,a,o){return a&&e(t.prototype,a),o&&e(t,o),t}}(),G=function e(t,a,o){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,a);if(r===void 0){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,a,o)}if("value"in r)return r.value;var n=r.get;return void 0===n?void 0:n.call(o)},Y=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},W=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&("object"==typeof t||"function"==typeof t)?t:e},X=function(){function e(){if(H(this,e),this.__state=F.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return q(e,[{key:"toString",value:function(){return t(this)}},{key:"toHexString",value:function(){return t(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),e}();X.recalculateRGB=function(e,t,a){if("HEX"===e.__state.space)e.__state[t]=V.component_from_hex(e.__state.hex,a);else if("HSV"===e.__state.space)R.extend(e.__state,V.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v));else throw new Error("Corrupted color state")},X.recalculateHSV=function(e){var t=V.rgb_to_hsv(e.r,e.g,e.b);R.extend(e.__state,{s:t.s,v:t.v}),R.isNaN(t.h)?R.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=t.h},X.COMPONENTS=["r","g","b","h","s","v","hex","a"],a(X.prototype,"r",2),a(X.prototype,"g",1),a(X.prototype,"b",0),c(X.prototype,"h"),c(X.prototype,"s"),c(X.prototype,"v"),Object.defineProperty(X.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(X.prototype,"hex",{get:function(){return"HEX"!==this.__state.space&&(this.__state.hex=V.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var Z=function(){function e(t,a){H(this,e),this.initialValue=t[a],this.domElement=document.createElement("div"),this.object=t,this.property=a,this.__onChange=void 0,this.__onFinishChange=void 0}return q(e,[{key:"onChange",value:function(e){return this.__onChange=e,this}},{key:"onFinishChange",value:function(e){return this.__onFinishChange=e,this}},{key:"setValue",value:function(e){return this.object[this.property]=e,this.__onChange&&this.__onChange.call(this,e),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),e}(),K={};R.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(e,t){R.each(e,function(a){K[a]=t})});var $=/(\d+(\.\d+)?)px/,J={makeSelectable:function(e,t){void 0===e||void 0===e.style||(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,a){var o=a,r=t;R.isUndefined(r)&&(r=!0),R.isUndefined(o)&&(o=!0),e.style.position="absolute",r&&(e.style.left=0,e.style.right=0),o&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,a,o){var r=a||{},i=K[t];if(!i)throw new Error("Event type "+t+" not supported.");var n=document.createEvent(i);switch(i){case"MouseEvents":{var l=r.x||r.clientX||0,s=r.y||r.clientY||0;n.initMouseEvent(t,r.bubbles||!1,r.cancelable||!0,window,r.clickCount||1,0,0,l,s,!1,!1,!1,!1,0,null);break}case"KeyboardEvents":{var d=n.initKeyboardEvent||n.initKeyEvent;R.defaults(r,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),d(t,r.bubbles||!1,r.cancelable,window,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.keyCode,r.charCode);break}default:{n.initEvent(t,r.bubbles||!1,r.cancelable||!0);break}}R.defaults(n,o),e.dispatchEvent(n)},bind:function(e,t,a,o){return e.addEventListener?e.addEventListener(t,a,o||!1):e.attachEvent&&e.attachEvent("on"+t,a),J},unbind:function(e,t,a,o){return e.removeEventListener?e.removeEventListener(t,a,o||!1):e.detachEvent&&e.detachEvent("on"+t,a),J},addClass:function(e,t){if(e.className===void 0)e.className=t;else if(e.className!==t){var a=e.className.split(/ +/);-1===a.indexOf(t)&&(a.push(t),e.className=a.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return J},removeClass:function(e,t){if(!t)e.className=void 0;else if(e.className===t)e.removeAttribute("class");else{var a=e.className.split(/ +/),o=a.indexOf(t);-1!==o&&(a.splice(o,1),e.className=a.join(" "))}return J},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var t=getComputedStyle(e);return p(t["border-left-width"])+p(t["border-right-width"])+p(t["padding-left"])+p(t["padding-right"])+p(t.width)},getHeight:function(e){var t=getComputedStyle(e);return p(t["border-top-width"])+p(t["border-bottom-width"])+p(t["padding-top"])+p(t["padding-bottom"])+p(t.height)},getOffset:function(e){var t=e,a={left:0,top:0};if(t.offsetParent)do a.left+=t.offsetLeft,a.top+=t.offsetTop,t=t.offsetParent;while(t);return a},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},Q=function(e){function t(e,a){H(this,t);var o=W(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a)),r=o;return o.__prev=o.getValue(),o.__checkbox=document.createElement("input"),o.__checkbox.setAttribute("type","checkbox"),J.bind(o.__checkbox,"change",function(){r.setValue(!r.__prev)},!1),o.domElement.appendChild(o.__checkbox),o.updateDisplay(),o}return Y(t,e),q(t,[{key:"setValue",value:function(e){var a=G(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),a}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),G(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(Z),ee=function(e){function t(e,a,o){H(this,t);var r=W(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a)),i=o,n=r;if(r.__select=document.createElement("select"),R.isArray(i)){var l={};R.each(i,function(e){l[e]=e}),i=l}return R.each(i,function(e,t){var a=document.createElement("option");a.innerHTML=t,a.setAttribute("value",e),n.__select.appendChild(a)}),r.updateDisplay(),J.bind(r.__select,"change",function(){var e=this.options[this.selectedIndex].value;n.setValue(e)}),r.domElement.appendChild(r.__select),r}return Y(t,e),q(t,[{key:"setValue",value:function(e){var a=G(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),a}},{key:"updateDisplay",value:function(){return J.isActive(this.__select)?this:(this.__select.value=this.getValue(),G(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this))}}]),t}(Z),te=function(e){function t(e,a){function o(){i.setValue(i.__input.value)}H(this,t);var r=W(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a)),i=r;return r.__input=document.createElement("input"),r.__input.setAttribute("type","text"),J.bind(r.__input,"keyup",o),J.bind(r.__input,"change",o),J.bind(r.__input,"blur",function(){i.__onFinishChange&&i.__onFinishChange.call(i,i.getValue())}),J.bind(r.__input,"keydown",function(t){13===t.keyCode&&this.blur()}),r.updateDisplay(),r.domElement.appendChild(r.__input),r}return Y(t,e),q(t,[{key:"updateDisplay",value:function(){return J.isActive(this.__input)||(this.__input.value=this.getValue()),G(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(Z),ae=function(e){function t(e,a,i){H(this,t);var n=W(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a)),d=i||{};return n.__min=d.min,n.__max=d.max,n.__step=d.step,n.__impliedStep=R.isUndefined(n.__step)?0===n.initialValue?1:l(10,u(r(s(n.initialValue))/o))/10:n.__step,n.__precision=g(n.__impliedStep),n}return Y(t,e),q(t,[{key:"setValue",value:function(e){var a=e;return void 0!==this.__min&&a<this.__min?a=this.__min:void 0!==this.__max&&a>this.__max&&(a=this.__max),void 0!==this.__step&&0!=a%this.__step&&(a=i(a/this.__step)*this.__step),G(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,a)}},{key:"min",value:function(e){return this.__min=e,this}},{key:"max",value:function(e){return this.__max=e,this}},{key:"step",value:function(e){return this.__step=e,this.__impliedStep=e,this.__precision=g(e),this}}]),t}(Z),oe=function(e){function t(e,a,o){function r(){s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}function i(t){var e=d-t.clientY;s.setValue(s.getValue()+e*s.__impliedStep),d=t.clientY}function n(){J.unbind(window,"mousemove",i),J.unbind(window,"mouseup",n),r()}H(this,t);var l=W(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,o));l.__truncationSuspended=!1;var s=l,d=void 0;return l.__input=document.createElement("input"),l.__input.setAttribute("type","text"),J.bind(l.__input,"change",function(){var e=parseFloat(s.__input.value);R.isNaN(e)||s.setValue(e)}),J.bind(l.__input,"blur",function(){r()}),J.bind(l.__input,"mousedown",function(t){J.bind(window,"mousemove",i),J.bind(window,"mouseup",n),d=t.clientY}),J.bind(l.__input,"keydown",function(t){13===t.keyCode&&(s.__truncationSuspended=!0,this.blur(),s.__truncationSuspended=!1,r())}),l.updateDisplay(),l.domElement.appendChild(l.__input),l}return Y(t,e),q(t,[{key:"updateDisplay",value:function(){return this.__input.value=this.__truncationSuspended?this.getValue():m(this.getValue(),this.__precision),G(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(ae),re=function(e){function t(e,a,o,r,i){function n(t){t.preventDefault();var e=p.__background.getBoundingClientRect();return p.setValue(h(t.clientX,e.left,e.right,p.__min,p.__max)),!1}function l(){J.unbind(window,"mousemove",n),J.unbind(window,"mouseup",l),p.__onFinishChange&&p.__onFinishChange.call(p,p.getValue())}function s(t){var e=t.touches[0].clientX,a=p.__background.getBoundingClientRect();p.setValue(h(e,a.left,a.right,p.__min,p.__max))}function d(){J.unbind(window,"touchmove",s),J.unbind(window,"touchend",d),p.__onFinishChange&&p.__onFinishChange.call(p,p.getValue())}H(this,t);var c=W(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,{min:o,max:r,step:i})),p=c;return c.__background=document.createElement("div"),c.__foreground=document.createElement("div"),J.bind(c.__background,"mousedown",function(t){document.activeElement.blur(),J.bind(window,"mousemove",n),J.bind(window,"mouseup",l),n(t)}),J.bind(c.__background,"touchstart",function(t){1!==t.touches.length||(J.bind(window,"touchmove",s),J.bind(window,"touchend",d),s(t))}),J.addClass(c.__background,"slider"),J.addClass(c.__foreground,"slider-fg"),c.updateDisplay(),c.__background.appendChild(c.__foreground),c.domElement.appendChild(c.__background),c}return Y(t,e),q(t,[{key:"updateDisplay",value:function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",G(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(ae),ie=function(e){function t(e,a,o){H(this,t);var r=W(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a));return r.__button=document.createElement("div"),r.__button.innerHTML=void 0===o?"Fire":o,J.bind(r.__button,"click",function(t){return t.preventDefault(),r.fire(),!1}),J.addClass(r.__button,"button"),r.domElement.appendChild(r.__button),r}return Y(t,e),q(t,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),t}(Z),ne=function(e){function t(e,a){function o(t){d(t),J.bind(window,"mousemove",d),J.bind(window,"touchmove",d),J.bind(window,"mouseup",i),J.bind(window,"touchend",i)}function r(t){c(t),J.bind(window,"mousemove",c),J.bind(window,"touchmove",c),J.bind(window,"mouseup",n),J.bind(window,"touchend",n)}function i(){J.unbind(window,"mousemove",d),J.unbind(window,"touchmove",d),J.unbind(window,"mouseup",i),J.unbind(window,"touchend",i),s()}function n(){J.unbind(window,"mousemove",c),J.unbind(window,"touchmove",c),J.unbind(window,"mouseup",n),J.unbind(window,"touchend",n),s()}function l(){var e=F(this.value);!1===e?this.value=u.__color.toString():(u.__color.__state=e,u.setValue(u.__color.toOriginal()))}function s(){u.__onFinishChange&&u.__onFinishChange.call(u,u.__color.toOriginal())}function d(t){-1===t.type.indexOf("touch")&&t.preventDefault();var e=u.__saturation_field.getBoundingClientRect(),a=t.touches&&t.touches[0]||t,o=a.clientX,r=a.clientY,i=(o-e.left)/(e.right-e.left),n=1-(r-e.top)/(e.bottom-e.top);return 1<n?n=1:0>n&&(n=0),1<i?i=1:0>i&&(i=0),u.__color.v=n,u.__color.s=i,u.setValue(u.__color.toOriginal()),!1}function c(t){-1===t.type.indexOf("touch")&&t.preventDefault();var e=u.__hue_field.getBoundingClientRect(),a=t.touches&&t.touches[0]||t,o=a.clientY,r=1-(o-e.top)/(e.bottom-e.top);return 1<r?r=1:0>r&&(r=0),u.__color.h=360*r,u.setValue(u.__color.toOriginal()),!1}H(this,t);var p=W(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a));p.__color=new X(p.getValue()),p.__temp=new X(0);var u=p;p.domElement=document.createElement("div"),J.makeSelectable(p.domElement,!1),p.__selector=document.createElement("div"),p.__selector.className="selector",p.__saturation_field=document.createElement("div"),p.__saturation_field.className="saturation-field",p.__field_knob=document.createElement("div"),p.__field_knob.className="field-knob",p.__field_knob_border="2px solid ",p.__hue_knob=document.createElement("div"),p.__hue_knob.className="hue-knob",p.__hue_field=document.createElement("div"),p.__hue_field.className="hue-field",p.__input=document.createElement("input"),p.__input.type="text",p.__input_textShadow="0 1px 1px ",J.bind(p.__input,"keydown",function(t){13===t.keyCode&&l.call(this)}),J.bind(p.__input,"blur",l),J.bind(p.__selector,"mousedown",function(){J.addClass(this,"drag").bind(window,"mouseup",function(){J.removeClass(u.__selector,"drag")})}),J.bind(p.__selector,"touchstart",function(){J.addClass(this,"drag").bind(window,"touchend",function(){J.removeClass(u.__selector,"drag")})});var g=document.createElement("div");return R.extend(p.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),R.extend(p.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:p.__field_knob_border+(.5>p.__color.v?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),R.extend(p.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),R.extend(p.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),R.extend(g.style,{width:"100%",height:"100%",background:"none"}),y(g,"top","rgba(0,0,0,0)","#000"),R.extend(p.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),f(p.__hue_field),R.extend(p.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:p.__input_textShadow+"rgba(0,0,0,0.7)"}),J.bind(p.__saturation_field,"mousedown",o),J.bind(p.__saturation_field,"touchstart",o),J.bind(p.__field_knob,"mousedown",o),J.bind(p.__field_knob,"touchstart",o),J.bind(p.__hue_field,"mousedown",r),J.bind(p.__hue_field,"touchstart",r),p.__saturation_field.appendChild(g),p.__selector.appendChild(p.__field_knob),p.__selector.appendChild(p.__saturation_field),p.__selector.appendChild(p.__hue_field),p.__hue_field.appendChild(p.__hue_knob),p.domElement.appendChild(p.__input),p.domElement.appendChild(p.__selector),p.updateDisplay(),p}return Y(t,e),q(t,[{key:"updateDisplay",value:function(){var e=F(this.getValue());if(!1!==e){var t=!1;R.each(X.COMPONENTS,function(a){if(!R.isUndefined(e[a])&&!R.isUndefined(this.__color.__state[a])&&e[a]!==this.__color.__state[a])return t=!0,{}},this),t&&R.extend(this.__color.__state,e)}R.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var a=.5>this.__color.v||.5<this.__color.s?255:0,o=255-a;R.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+a+","+a+","+a+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,y(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),R.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+a+","+a+","+a+")",textShadow:this.__input_textShadow+"rgba("+o+","+o+","+o+",.7)"})}}]),t}(Z),le=["-moz-","-o-","-webkit-","-ms-",""],se=function(e,t){var a=e[t];return R.isArray(arguments[2])||R.isObject(arguments[2])?new ee(e,t,arguments[2]):R.isNumber(a)?R.isNumber(arguments[2])&&R.isNumber(arguments[3])?R.isNumber(arguments[4])?new re(e,t,arguments[2],arguments[3],arguments[4]):new re(e,t,arguments[2],arguments[3]):R.isNumber(arguments[4])?new oe(e,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new oe(e,t,{min:arguments[2],max:arguments[3]}):R.isString(a)?new te(e,t):R.isFunction(a)?new ie(e,t,""):R.isBoolean(a)?new Q(e,t):null},de=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,1e3/60)},ce=function(){function e(){H(this,e),this.backgroundElement=document.createElement("div"),R.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),J.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),R.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var t=this;J.bind(this.backgroundElement,"click",function(){t.hide()})}return q(e,[{key:"show",value:function(){var e=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),R.defer(function(){e.backgroundElement.style.opacity=1,e.domElement.style.opacity=1,e.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function e(){var t=this,e=function e(){t.domElement.style.display="none",t.backgroundElement.style.display="none",J.unbind(t.domElement,"webkitTransitionEnd",e),J.unbind(t.domElement,"transitionend",e),J.unbind(t.domElement,"oTransitionEnd",e)};J.bind(this.domElement,"webkitTransitionEnd",e),J.bind(this.domElement,"transitionend",e),J.bind(this.domElement,"oTransitionEnd",e),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-J.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-J.getHeight(this.domElement)/2+"px"}}]),e}(),pe=function(e){if(e&&"undefined"!=typeof window){var t=document.createElement("style");return t.setAttribute("type","text/css"),t.innerHTML=e,document.head.appendChild(t),e}}(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n");({load:function(e,t){var a=t||document,o=a.createElement("link");o.type="text/css",o.rel="stylesheet",o.href=e,a.getElementsByTagName("head")[0].appendChild(o)},inject:function(e,t){var a=t||document,o=document.createElement("style");o.type="text/css",o.innerHTML=e;var r=a.getElementsByTagName("head")[0];try{r.appendChild(o)}catch(t){}}}).inject(pe);var ue=72,ge=20,me="Default",he=function(){try{return!!window.localStorage}catch(t){return!1}}(),ye=void 0,fe=!0,xe=void 0,_e=!1,be=[],ve=function e(t){var a=this,o=t||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),J.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],o=R.defaults(o,{closeOnTop:!1,autoPlace:!0,width:e.DEFAULT_WIDTH}),o=R.defaults(o,{resizable:o.autoPlace,hideable:o.autoPlace}),R.isUndefined(o.load)?o.load={preset:me}:o.preset&&(o.load.preset=o.preset),R.isUndefined(o.parent)&&o.hideable&&be.push(this),o.resizable=R.isUndefined(o.parent)&&o.resizable,o.autoPlace&&R.isUndefined(o.scrollable)&&(o.scrollable=!0);var r=he&&"true"===localStorage.getItem(T(this,"isLocal")),i=void 0,n=void 0;if(Object.defineProperties(this,{parent:{get:function(){return o.parent}},scrollable:{get:function(){return o.scrollable}},autoPlace:{get:function(){return o.autoPlace}},closeOnTop:{get:function(){return o.closeOnTop}},preset:{get:function(){return a.parent?a.getRoot().preset:o.load.preset},set:function(e){a.parent?a.getRoot().preset=e:o.load.preset=e,P(this),a.revert()}},width:{get:function(){return o.width},set:function(e){o.width=e,E(a,e)}},name:{get:function(){return o.name},set:function(e){o.name=e,n&&(n.innerHTML=o.name)}},closed:{get:function(){return o.closed},set:function(t){o.closed=t,o.closed?J.addClass(a.__ul,e.CLASS_CLOSED):J.removeClass(a.__ul,e.CLASS_CLOSED),this.onResize(),a.__closeButton&&(a.__closeButton.innerHTML=t?e.TEXT_OPEN:e.TEXT_CLOSED)}},load:{get:function(){return o.load}},useLocalStorage:{get:function(){return r},set:function(e){he&&(r=e,e?J.bind(window,"unload",i):J.unbind(window,"unload",i),localStorage.setItem(T(a,"isLocal"),e))}}}),R.isUndefined(o.parent)){if(this.closed=o.closed||!1,J.addClass(this.domElement,e.CLASS_MAIN),J.makeSelectable(this.domElement,!1),he&&r){a.useLocalStorage=!0;var l=localStorage.getItem(T(this,"gui"));l&&(o.load=JSON.parse(l))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=e.TEXT_CLOSED,J.addClass(this.__closeButton,e.CLASS_CLOSE_BUTTON),o.closeOnTop?(J.addClass(this.__closeButton,e.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(J.addClass(this.__closeButton,e.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),J.bind(this.__closeButton,"click",function(){a.closed=!a.closed})}else{void 0===o.closed&&(o.closed=!0);var s=document.createTextNode(o.name);J.addClass(s,"controller-name"),n=x(a,s);var d=function(t){return t.preventDefault(),a.closed=!a.closed,!1};J.addClass(this.__ul,e.CLASS_CLOSED),J.addClass(n,"title"),J.bind(n,"click",d),o.closed||(this.closed=!1)}o.autoPlace&&(R.isUndefined(o.parent)&&(fe&&(xe=document.createElement("div"),J.addClass(xe,"dg"),J.addClass(xe,e.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(xe),fe=!1),xe.appendChild(this.domElement),J.addClass(this.domElement,e.CLASS_AUTO_PLACE)),!this.parent&&E(a,o.width)),this.__resizeHandler=function(){a.onResizeDebounced()},J.bind(window,"resize",this.__resizeHandler),J.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),J.bind(this.__ul,"transitionend",this.__resizeHandler),J.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),o.resizable&&L(this),i=function(){he&&"true"===localStorage.getItem(T(a,"isLocal"))&&localStorage.setItem(T(a,"gui"),JSON.stringify(a.getSaveObject()))},this.saveToLocalStorageIfPossible=i,o.parent||function(){var e=a.getRoot();e.width+=1,R.defer(function(){e.width-=1})}()};ve.toggleHide=function(){_e=!_e,R.each(be,function(e){e.domElement.style.display=_e?"none":""})},ve.CLASS_AUTO_PLACE="a",ve.CLASS_AUTO_PLACE_CONTAINER="ac",ve.CLASS_MAIN="main",ve.CLASS_CONTROLLER_ROW="cr",ve.CLASS_TOO_TALL="taller-than-window",ve.CLASS_CLOSED="closed",ve.CLASS_CLOSE_BUTTON="close-button",ve.CLASS_CLOSE_TOP="close-top",ve.CLASS_CLOSE_BOTTOM="close-bottom",ve.CLASS_DRAG="drag",ve.DEFAULT_WIDTH=245,ve.TEXT_CLOSED="Close Controls",ve.TEXT_OPEN="Open Controls",ve._keydownHandler=function(t){"text"!==document.activeElement.type&&(t.which===ue||t.keyCode===ue)&&ve.toggleHide()},J.bind(window,"keydown",ve._keydownHandler,!1),R.extend(ve.prototype,{add:function(e,t){return k(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return k(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;R.defer(function(){t.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&xe.removeChild(this.domElement);var e=this;R.each(this.__folders,function(t){e.removeFolder(t)}),J.unbind(window,"keydown",ve._keydownHandler,!1),_(this)},addFolder:function(e){if(void 0!==this.__folders[e])throw new Error("You already have a folder in this GUI by the name \""+e+"\"");var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var a=new ve(t);this.__folders[e]=a;var o=x(this,a.domElement);return J.addClass(o,"folder"),a},removeFolder:function(e){this.__ul.removeChild(e.domElement.parentElement),delete this.__folders[e.name],this.load&&this.load.folders&&this.load.folders[e.name]&&delete this.load.folders[e.name],_(e);var t=this;R.each(e.__folders,function(t){e.removeFolder(t)}),R.defer(function(){t.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=J.getOffset(e.__ul).top,a=0;R.each(e.__ul.childNodes,function(t){e.autoPlace&&t===e.__save_row||(a+=J.getHeight(t))}),window.innerHeight-t-ge<a?(J.addClass(e.domElement,ve.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-ge+"px"):(J.removeClass(e.domElement,ve.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&R.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"}),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:R.debounce(function(){this.onResize()},50),remember:function(){if(R.isUndefined(ye)&&(ye=new ce,ye.domElement.innerHTML="<div id=\"dg-save\" class=\"dg dialogue\">\n\n  Here's the new load parameter for your <code>GUI</code>'s constructor:\n\n  <textarea id=\"dg-new-constructor\"></textarea>\n\n  <div id=\"dg-save-locally\">\n\n    <input id=\"dg-local-storage\" type=\"checkbox\"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id=\"dg-local-explain\">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>"),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;R.each(Array.prototype.slice.call(arguments),function(t){0===e.__rememberedObjects.length&&C(e),-1===e.__rememberedObjects.indexOf(t)&&e.__rememberedObjects.push(t)}),this.autoPlace&&E(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,0<this.__rememberedObjects.length&&(e.preset=this.preset,!e.remembered&&(e.remembered={}),e.remembered[this.preset]=I(this)),e.folders={},R.each(this.__folders,function(t,a){e.folders[a]=t.getSaveObject()}),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=I(this),b(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[me]=I(this,!0)),this.load.remembered[e]=I(this),this.preset=e,A(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){R.each(this.__controllers,function(t){this.getRoot().load.remembered?w(e||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())},this),R.each(this.__folders,function(e){e.revert(e)}),e||b(this.getRoot(),!1)},listen:function(e){var t=0===this.__listening.length;this.__listening.push(e),t&&z(this.__listening)},updateDisplay:function(){R.each(this.__controllers,function(e){e.updateDisplay()}),R.each(this.__folders,function(e){e.updateDisplay()})}});var we={Color:X,math:V,interpret:F},ke={Controller:Z,BooleanController:Q,OptionController:ee,StringController:te,NumberController:ae,NumberControllerBox:oe,NumberControllerSlider:re,FunctionController:ie,ColorController:ne},Te={dom:J},Ae={GUI:ve},Se=ve;e.color=we,e.controllers=ke,e.dom=Te,e.gui=Ae,e.GUI=Se,e["default"]={color:we,controllers:ke,dom:Te,gui:Ae,GUI:Se},Object.defineProperty(e,"__esModule",{value:!0})})},{}],110:[function(e,t){t.exports=function(){for(var e=0;e<arguments.length;e++)if(arguments[e]!==void 0)return arguments[e]}},{}],111:[function(e,t){"use strict";var n=Math.max;function a(e,t){this.point=e,this.index=t}function o(e,t){for(var a=e.point,o=t.point,r=a.length,n=0,l;n<r;++n)if(l=o[n]-a[n],l)return l;return 0}function r(e,t,o){if(1===e)return o?[[-1,0]]:[];var r=t.map(function(e,t){return[e[0],t]});r.sort(function(e,t){return e[0]-t[0]});for(var n=Array(e-1),l=1;l<e;++l){var s=r[l-1],a=r[l];n[l-1]=[s[1],a[1]]}return o&&n.push([-1,n[0][1]],[n[e-1][1],-1]),n}var s=e("incremental-convex-hull"),c=e("uniq");t.exports=function(e,t){var g=e.length;if(0===g)return[];var m=e[0].length;if(1>m)return[];if(1===m)return r(g,e,t);for(var d=Array(g),f=1,_=0;_<g;++_){for(var b=e[_],p=Array(m+1),w=0,k=0,T;k<m;++k)T=b[k],p[k]=T,w+=T*T;p[m]=w,d[_]=new a(p,_),f=n(w,f)}c(d,o),g=d.length;for(var A=Array(g+m+1),S=Array(g+m+1),C=(m+1)*(m+1)*f,u=Array(m+1),_=0;_<=m;++_)u[_]=0;u[m]=C,A[0]=u.slice(),S[0]=-1;for(var _=0,p;_<=m;++_)p=u.slice(),p[_]=1,A[_+1]=p,S[_+1]=-1;for(var _=0,y;_<g;++_)y=d[_],A[_+m+1]=y.point,S[_+m+1]=y.index;var L=s(A,!1);if(L=t?L.filter(function(e){for(var t=0,a=0,o;a<=m;++a){if(o=S[e[a]],0>o&&2<=++t)return!1;e[a]=o}return!0}):L.filter(function(e){for(var t=0,a;t<=m;++t){if(a=S[e[t]],0>a)return!1;e[t]=a}return!0}),1&m)for(var _=0;_<L.length;++_){var y=L[_],p=y[0];y[0]=y[1],y[1]=p}return L}},{"incremental-convex-hull":381,uniq:1331}],112:[function(e,t){'use strict';var n=String.fromCharCode;function a(e,t){Array.isArray(e)&&(e=e.join(", "));var a={},o=16,n=.05,l;t&&(2===t.length&&"number"==typeof t[0]?l=r(t):Array.isArray(t)?l=t:(t.o?l=r(t.o):t.pairs&&(l=t.pairs),t.fontSize&&(o=t.fontSize),null!=t.threshold&&(n=t.threshold))),l||(l=d),s.font=o+"px "+e;for(var c=0;c<l.length;c++){var p=l[c],u=s.measureText(p[0]).width+s.measureText(p[1]).width,g=s.measureText(p).width;if(Math.abs(u-g)>o*n){var m=(g-u)/o;a[p]=1e3*m}}return a}function r(e){for(var t=[],a=e[0],o;a<=e[1];a++){o=n(a);for(var r=e[0];r<e[1];r++){var l=n(r),s=o+l;t.push(s)}}return t}t.exports=a;var l=a.canvas=document.createElement("canvas"),s=l.getContext("2d"),d=r([32,126]);a.createPairs=r,a.ascii=d},{}],113:[function(e,t){(function(e){var a=!1;if("undefined"!=typeof Float64Array){var o=new Float64Array(1),r=new Uint32Array(o.buffer);if(o[0]=1,a=!0,1072693248===r[1]){t.exports=function(e){return o[0]=e,[r[0],r[1]]},t.exports.pack=function(e,t){return r[0]=e,r[1]=t,o[0]},t.exports.lo=function(e){return o[0]=e,r[0]},t.exports.hi=function(e){return o[0]=e,r[1]}}else if(1072693248===r[0]){t.exports=function(e){return o[0]=e,[r[1],r[0]]},t.exports.pack=function(e,t){return r[1]=e,r[0]=t,o[0]},t.exports.lo=function(e){return o[0]=e,r[1]},t.exports.hi=function(e){return o[0]=e,r[0]}}else a=!1}if(!a){var i=new e(8);t.exports=function(e){return i.writeDoubleLE(e,0,!0),[i.readUInt32LE(0,!0),i.readUInt32LE(4,!0)]},t.exports.pack=function(e,t){return i.writeUInt32LE(e,0,!0),i.writeUInt32LE(t,4,!0),i.readDoubleLE(0,!0)},t.exports.lo=function(e){return i.writeDoubleLE(e,0,!0),i.readUInt32LE(0,!0)},t.exports.hi=function(e){return i.writeDoubleLE(e,0,!0),i.readUInt32LE(4,!0)}}t.exports.sign=function(e){return t.exports.hi(e)>>>31},t.exports.exponent=function(e){var a=t.exports.hi(e);return(a<<1>>>21)-1023},t.exports.fraction=function(e){var a=t.exports.lo(e),o=t.exports.hi(e),r=1048575&o;return 2146435072&o&&(r+=1048576),[a,r]},t.exports.denormalized=function(e){var a=t.exports.hi(e);return!(2146435072&a)}}).call(this,e("buffer").Buffer)},{buffer:1420}],114:[function(e,t){var a=e("abs-svg-path"),o=e("normalize-svg-path"),r={M:"moveTo",C:"bezierCurveTo"};t.exports=function(e,t){e.beginPath(),o(a(t)).forEach(function(t){var a=t[0],o=t.slice(1);e[r[a]].apply(e,o)}),e.closePath()}},{"abs-svg-path":15,"normalize-svg-path":436}],115:[function(e,t){t.exports=function(e){return"int8"===e?Int8Array:"int16"===e?Int16Array:"int32"===e?Int32Array:"uint8"===e?Uint8Array:"uint16"===e?Uint16Array:"uint32"===e?Uint32Array:"float32"===e?Float32Array:"float64"===e?Float64Array:"array"===e?Array:"uint8_clamped"===e?Uint8ClampedArray:void 0}},{}],116:[function(e,t){"use strict";function a(e,t,o){var r=0|e[o];if(0>=r)return[];var i=Array(r),n;if(o===e.length-1)for(n=0;n<r;++n)i[n]=t;else for(n=0;n<r;++n)i[n]=a(e,t,o+1);return i}function o(e,t){var a,o;for(a=Array(e),o=0;o<e;++o)a[o]=t;return a}t.exports=function(e,t){switch("undefined"==typeof t&&(t=0),typeof e){case"number":if(0<e)return o(0|e,t);break;case"object":if("number"==typeof e.length)return a(e,t,0);}return[]}},{}],117:[function(e,t){'use strict';var M=Math.min,j=Math.abs,B=Math.max;function a(e,t,a){a=a||2;var r=t&&t.length,l=r?t[0]*a:e.length,s=o(e,0,l,a,!0),d=[];if(!s||s.next===s.prev)return d;var c,u,g,m,h,f,_;if(r&&(s=p(e,t,s,a)),e.length>80*a){c=g=e[0],u=m=e[1];for(var b=a;b<l;b+=a)h=e[b],f=e[b+1],h<c&&(c=h),f<u&&(u=f),h>g&&(g=h),f>m&&(m=f);_=B(g-c,m-u),_=0===_?0:1/_}return n(s,d,a,c,u,_),d}function o(e,t,a,o,r){var n,l;if(r===0<R(e,t,a,o))for(n=t;n<a;n+=o)l=z(n,e[n],e[n+1],l);else for(n=a-o;n>=t;n-=o)l=z(n,e[n],e[n+1],l);return l&&T(l,l.next)&&(D(l),l=l.next),l}function r(e,t){if(!e)return e;t||(t=e);var a=e,o;do if(o=!1,!a.steiner&&(T(a,a.next)||0===k(a.prev,a,a.next))){if(D(a),a=t=a.prev,a===a.next)break;o=!0}else a=a.next;while(o||a!==t);return t}function n(e,t,a,o,i,p,u){if(e){!u&&p&&y(e,o,i,p);for(var g=e,m,h;e.prev!==e.next;){if(m=e.prev,h=e.next,p?s(e,o,i,p):l(e)){t.push(m.i/a),t.push(e.i/a),t.push(h.i/a),D(e),e=h.next,g=h.next;continue}if(e=h,e===g){u?1===u?(e=d(r(e),t,a),n(e,t,a,o,i,p,2)):2==u&&c(e,t,a,o,i,p):n(r(e),t,a,o,i,p,1);break}}}}function l(e){var t=e.prev,a=e,o=e.next;if(0<=k(t,a,o))return!1;for(var r=e.next.next;r!==e.prev;){if(v(t.x,t.y,a.x,a.y,o.x,o.y,r.x,r.y)&&0<=k(r.prev,r,r.next))return!1;r=r.next}return!0}function s(e,t,o,r){var i=e.prev,a=e,l=e.next;if(0<=k(i,a,l))return!1;for(var s=i.x<a.x?i.x<l.x?i.x:l.x:a.x<l.x?a.x:l.x,d=i.y<a.y?i.y<l.y?i.y:l.y:a.y<l.y?a.y:l.y,c=i.x>a.x?i.x>l.x?i.x:l.x:a.x>l.x?a.x:l.x,u=i.y>a.y?i.y>l.y?i.y:l.y:a.y>l.y?a.y:l.y,g=x(s,d,t,o,r),m=x(c,u,t,o,r),h=e.prevZ,y=e.nextZ;h&&h.z>=g&&y&&y.z<=m;){if(h!==e.prev&&h!==e.next&&v(i.x,i.y,a.x,a.y,l.x,l.y,h.x,h.y)&&0<=k(h.prev,h,h.next))return!1;if(h=h.prevZ,y!==e.prev&&y!==e.next&&v(i.x,i.y,a.x,a.y,l.x,l.y,y.x,y.y)&&0<=k(y.prev,y,y.next))return!1;y=y.nextZ}for(;h&&h.z>=g;){if(h!==e.prev&&h!==e.next&&v(i.x,i.y,a.x,a.y,l.x,l.y,h.x,h.y)&&0<=k(h.prev,h,h.next))return!1;h=h.prevZ}for(;y&&y.z<=m;){if(y!==e.prev&&y!==e.next&&v(i.x,i.y,a.x,a.y,l.x,l.y,y.x,y.y)&&0<=k(y.prev,y,y.next))return!1;y=y.nextZ}return!0}function d(e,t,o){var i=e;do{var n=i.prev,a=i.next.next;!T(n,a)&&A(n,i,i.next,a)&&E(n,a)&&E(a,n)&&(t.push(n.i/o),t.push(i.i/o),t.push(a.i/o),D(i),D(i.next),i=e=a),i=i.next}while(i!==e);return r(i)}function c(e,t,o,i,l,s){var d=e;do{for(var p=d.next.next;p!==d.prev;){if(d.i!==p.i&&w(d,p)){var u=P(d,p);return d=r(d,d.next),u=r(u,u.next),n(d,t,o,i,l,s),void n(u,t,o,i,l,s)}p=p.next}d=d.next}while(d!==e)}function p(e,t,a,n){var l=[],s,d,c,p,m;for(s=0,d=t.length;s<d;s++)c=t[s]*n,p=s<d-1?t[s+1]*n:e.length,m=o(e,c,p,n,!1),m===m.next&&(m.steiner=!0),l.push(_(m));for(l.sort(u),s=0;s<l.length;s++)g(l[s],a),a=r(a,a.next);return a}function u(e,t){return e.x-t.x}function g(e,t){if(t=m(e,t),t){var a=P(t,e);r(t,t.next),r(a,a.next)}}function m(e,t){var a=t,o=e.x,r=e.y,i=-Infinity,n;do{if(r<=a.y&&r>=a.next.y&&a.next.y!==a.y){var l=a.x+(r-a.y)*(a.next.x-a.x)/(a.next.y-a.y);if(l<=o&&l>i){if(i=l,l===o){if(r===a.y)return a;if(r===a.next.y)return a.next}n=a.x<a.next.x?a:a.next}}a=a.next}while(a!==t);if(!n)return null;if(o===i)return n;var s=n,d=n.x,c=n.y,u=1/0,g;a=n;do o>=a.x&&a.x>=d&&o!==a.x&&v(r<c?o:i,r,d,c,r<c?i:o,r,a.x,a.y)&&(g=j(r-a.y)/(o-a.x),E(a,e)&&(g<u||g===u&&(a.x>n.x||a.x===n.x&&h(n,a)))&&(n=a,u=g)),a=a.next;while(a!==s);return n}function h(e,t){return 0>k(e.prev,e,t.prev)&&0>k(t.next,e,e.next)}function y(e,t,a,o){var r=e;do null===r.z&&(r.z=x(r.x,r.y,t,a,o)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,f(r)}function f(t){var a=1,o,r,n,l,s,d,c,u;do{for(r=t,t=null,s=null,d=0;r;){for(d++,n=r,c=0,o=0;o<a&&(c++,n=n.nextZ,!!n);o++);for(u=a;0<c||0<u&&n;)0!==c&&(0===u||!n||r.z<=n.z)?(l=r,r=r.nextZ,c--):(l=n,n=n.nextZ,u--),s?s.nextZ=l:t=l,l.prevZ=s,s=l;r=n}s.nextZ=null,a*=2}while(1<d);return t}function x(e,t,a,o,r){return e=32767*(e-a)*r,t=32767*(t-o)*r,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e|t<<1}function _(e){var t=e,a=e;do(t.x<a.x||t.x===a.x&&t.y<a.y)&&(a=t),t=t.next;while(t!==e);return a}function v(e,t,a,o,r,i,n,l){return 0<=(r-n)*(t-l)-(e-n)*(i-l)&&0<=(e-n)*(o-l)-(a-n)*(t-l)&&0<=(a-n)*(i-l)-(r-n)*(o-l)}function w(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!L(e,t)&&(E(e,t)&&E(t,e)&&I(e,t)&&(k(e.prev,e,t.prev)||k(e,t.prev,t))||T(e,t)&&0<k(e.prev,e,e.next)&&0<k(t.prev,t,t.next))}function k(e,t,a){return(t.y-e.y)*(a.x-t.x)-(t.x-e.x)*(a.y-t.y)}function T(e,t){return e.x===t.x&&e.y===t.y}function A(e,t,a,o){var r=C(k(e,t,a)),i=C(k(e,t,o)),n=C(k(a,o,e)),l=C(k(a,o,t));return!(r===i||n===l)||!!(0===r&&S(e,a,t))||!!(0===i&&S(e,o,t))||!!(0===n&&S(a,e,o))||!!(0===l&&S(a,t,o))}function S(e,t,a){return t.x<=B(e.x,a.x)&&t.x>=M(e.x,a.x)&&t.y<=B(e.y,a.y)&&t.y>=M(e.y,a.y)}function C(e){return 0<e?1:0>e?-1:0}function L(e,t){var a=e;do{if(a.i!==e.i&&a.next.i!==e.i&&a.i!==t.i&&a.next.i!==t.i&&A(a,a.next,e,t))return!0;a=a.next}while(a!==e);return!1}function E(e,t){return 0>k(e.prev,e,e.next)?0<=k(e,t,e.next)&&0<=k(e,e.prev,t):0>k(e,t,e.prev)||0>k(e,e.next,t)}function I(e,t){var a=e,o=!1,r=(e.x+t.x)/2,i=(e.y+t.y)/2;do a.y>i!=a.next.y>i&&a.next.y!==a.y&&r<(a.next.x-a.x)*(i-a.y)/(a.next.y-a.y)+a.x&&(o=!o),a=a.next;while(a!==e);return o}function P(e,t){var a=new O(e.i,e.x,e.y),o=new O(t.i,t.x,t.y),r=e.next,i=t.prev;return e.next=t,t.prev=e,a.next=r,r.prev=a,o.next=a,a.prev=o,i.next=o,o.prev=i,o}function z(e,t,a,o){var r=new O(e,t,a);return o?(r.next=o.next,r.prev=o,o.next.prev=r,o.next=r):(r.prev=r,r.next=r),r}function D(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function O(e,t,a){this.i=e,this.x=t,this.y=a,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function R(e,t,a,o){for(var r=0,n=t,l=a-o;n<a;n+=o)r+=(e[l]-e[n])*(e[n+1]+e[l+1]),l=n;return r}t.exports=a,t.exports.default=a,a.deviation=function(e,t,o,r){var n=t&&t.length,l=n?t[0]*o:e.length,s=j(R(e,0,l,o));if(n)for(var d=0,p=t.length;d<p;d++){var u=t[d]*o,g=d<p-1?t[d+1]*o:e.length;s-=j(R(e,u,g,o))}var m=0;for(d=0;d<r.length;d+=3){var h=r[d]*o,a=r[d+1]*o,y=r[d+2]*o;m+=j((e[h]-e[y])*(e[a+1]-e[h+1])-(e[h]-e[a])*(e[y+1]-e[h+1]))}return 0===s&&0===m?0:j((m-s)/s)},a.flatten=function(e){for(var t=e[0][0].length,a={vertices:[],holes:[],dimensions:t},o=0,r=0;r<e.length;r++){for(var n=0;n<e[r].length;n++)for(var l=0;l<t;l++)a.vertices.push(e[r][n][l]);0<r&&(o+=e[r-1].length,a.holes.push(o))}return a}},{}],118:[function(e,t){"use strict";var a=Math.max;t.exports=function(t,r){var n=t.length;if("number"!=typeof r){r=0;for(var l=0,s;l<n;++l)s=t[l],r=a(r,s[0],s[1]);r=(0|r)+1}r|=0;for(var d=Array(r),l=0;l<r;++l)d[l]=[];for(var l=0,s;l<n;++l)s=t[l],d[s[0]].push(s[1]),d[s[1]].push(s[0]);for(var c=0;c<r;++c)o(d[c],function(e,t){return e-t});return d};var o=e("uniq")},{uniq:1331}],119:[function(e,t){var a=e("strongly-connected-components");t.exports=function(e,t){function o(e){m[e]=!1,h.hasOwnProperty(e)&&Object.keys(h[e]).forEach(function(t){delete h[e][t],m[t]&&o(t)})}function r(e){var t=!1;g.push(e),m[e]=!0;var a,n;for(a=0;a<y[e].length;a++)n=y[e][a],n===f?(l(f,g),t=!0):!m[n]&&(t=r(n));if(t)o(e);else for(a=0;a<y[e].length;a++){n=y[e][a];var s=h[n];s||(s={},h[n]=s),s[n]=!0}return g.pop(),t}function l(e,a){var o=[].concat(a).concat(e);t?t(r):u.push(o)}function d(t){for(var a=0;a<e.length;a++)a<t&&(e[a]=[]),e[a]=e[a].filter(function(e){return e>=t})}function c(t){d(t);for(var o=a(e),r=o.components.filter(function(e){return 1<e.length}),n=1/0,l=0,s;l<r.length;l++)for(var c=0;c<r[l].length;c++)r[l][c]<n&&(n=r[l][c],s=l);var p=r[s];if(!p)return!1;var u=e.map(function(e,t){return-1===p.indexOf(t)?[]:e.filter(function(e){return-1!==p.indexOf(e)})});return{leastVertex:n,adjList:u}}var u=[],g=[],m=[],h={},y=[],f;f=0;for(var x=e.length,n;f<x;)if(n=c(f),f=n.leastVertex,y=n.adjList,y){for(var _=0;_<y.length;_++)for(var b=0,v;b<y[_].length;b++)v=y[_][b],m[+v]=!1,h[v]={};r(f),++f}else f=x;return t?void 0:u}},{"strongly-connected-components":1302}],120:[function(e,t){"use strict";var a=e("../../object/valid-value");t.exports=function(){return a(this).length=0,this}},{"../../object/valid-value":160}],121:[function(e,t){"use strict";t.exports=e("./is-implemented")()?Array.from:e("./shim")},{"./is-implemented":122,"./shim":123}],122:[function(e,t){"use strict";t.exports=function(){var e=Array.from,t,a;return!("function"!=typeof e)&&(t=["raz","dwa"],a=e(t),!!(a&&a!==t&&"dwa"===a[1]))}},{}],123:[function(e,t){"use strict";var a=e("es6-symbol").iterator,o=e("../../function/is-arguments"),r=e("../../function/is-function"),n=e("../../number/to-pos-integer"),l=e("../../object/valid-callable"),s=e("../../object/valid-value"),d=e("../../object/is-value"),c=e("../../string/is-string"),p=Array.isArray,u=Function.prototype.call,g={configurable:!0,enumerable:!0,writable:!0,value:null},m=Object.defineProperty;t.exports=function(e){var t=arguments[1],h=arguments[2],y,f,x,_,b,v,w,k,T,A;if(e=Object(s(e)),d(t)&&l(t),!this||this===Array||!r(this)){if(!t){if(o(e))return(b=e.length,1!==b)?Array.apply(null,e):(_=[,],_[0]=e[0],_);if(p(e)){for(_=Array(b=e.length),f=0;f<b;++f)_[f]=e[f];return _}}_=[]}else y=this;if(!p(e))if(void 0!==(T=e[a])){for(w=l(T).call(e),y&&(_=new y),k=w.next(),f=0;!k.done;)A=t?u.call(t,h,k.value,f):k.value,y?(g.value=A,m(_,f,g)):_[f]=A,k=w.next(),++f;b=f}else if(c(e)){for(b=e.length,y&&(_=new y),(f=0,x=0);f<b;++f)A=e[f],f+1<b&&(v=A.charCodeAt(0),55296<=v&&56319>=v&&(A+=e[++f])),A=t?u.call(t,h,A,x):A,y?(g.value=A,m(_,x,g)):_[x]=A,++x;b=x}if(void 0===b)for(b=n(e.length),y&&(_=new y(b)),f=0;f<b;++f)A=t?u.call(t,h,e[f],f):e[f],y?(g.value=A,m(_,f,g)):_[f]=A;return y&&(g.value=null,_.length=b),_}},{"../../function/is-arguments":124,"../../function/is-function":125,"../../number/to-pos-integer":140,"../../object/is-value":149,"../../object/valid-callable":158,"../../object/valid-value":160,"../../string/is-string":164,"es6-symbol":131}],124:[function(e,t){"use strict";var a=Object.prototype.toString,o=a.call(function(){return arguments}());t.exports=function(e){return a.call(e)===o}},{}],125:[function(e,t){"use strict";var a=Object.prototype.toString,o=RegExp.prototype.test.bind(/^[object [A-Za-z0-9]*Function]$/);t.exports=function(e){return"function"==typeof e&&o(a.call(e))}},{}],126:[function(e,t){"use strict";t.exports=function(){}},{}],127:[function(e,t){"use strict";t.exports=e("./is-implemented")()?Math.sign:e("./shim")},{"./is-implemented":128,"./shim":129}],128:[function(e,t){"use strict";t.exports=function(){var e=Math.sign;return!("function"!=typeof e)&&1===e(10)&&-1===e(-20)}},{}],129:[function(e,t){"use strict";t.exports=function(e){return e=+e,isNaN(e)||0===e?e:0<e?1:-1}},{}],130:[function(e,t){"use strict";var a=e("type/value/is"),o=e("type/plain-function/is"),r=e("es5-ext/object/assign"),i=e("es5-ext/object/normalize-options"),n=e("es5-ext/string/#/contains"),l=t.exports=function(t,o){var l,s,d,p,u;return 2>arguments.length||"string"!=typeof t?(p=o,o=t,t=null):p=arguments[2],a(t)?(l=n.call(t,"c"),s=n.call(t,"e"),d=n.call(t,"w")):(l=d=!0,s=!1),u={value:o,configurable:l,enumerable:s,writable:d},p?r(i(p),u):u};l.gs=function(t,l,s){var d,p,u,g;return"string"==typeof t?u=arguments[3]:(u=s,s=l,l=t,t=null),a(l)?o(l)?a(s)?!o(s)&&(u=s,s=void 0):s=void 0:(u=l,l=s=void 0):l=void 0,a(t)?(d=n.call(t,"c"),p=n.call(t,"e")):(d=!0,p=!1),g={get:l,set:s,configurable:d,enumerable:p},u?r(i(u),g):g}},{"es5-ext/object/assign":142,"es5-ext/object/normalize-options":154,"es5-ext/string/#/contains":161,"type/plain-function/is":1323,"type/value/is":1327}],131:[function(e,t){"use strict";t.exports=e("./is-implemented")()?e("ext/global-this").Symbol:e("./polyfill")},{"./is-implemented":132,"./polyfill":137,"ext/global-this":198}],132:[function(e,t){"use strict";var a=e("ext/global-this"),o={object:!0,symbol:!0};t.exports=function(){var e=a.Symbol,t;if("function"!=typeof e)return!1;t=e("test symbol");try{}catch(t){return!1}return!!o[typeof e.iterator]&&!!o[typeof e.toPrimitive]&&!!o[typeof e.toStringTag]}},{"ext/global-this":198}],133:[function(e,t){"use strict";t.exports=function(e){return!!e&&(!("symbol"!=typeof e)||!!e.constructor&&!("Symbol"!==e.constructor.name)&&"Symbol"===e[e.constructor.toStringTag])}},{}],134:[function(e,t){"use strict";var a=e("d"),o=Object.create,r=Object.defineProperty,i=Object.prototype,n=o(null);t.exports=function(e){for(var t=0,o,l;n[e+(t||"")];)++t;return e+=t||"",n[e]=!0,o="@@"+e,r(i,o,a.gs(null,function(e){l||(l=!0,r(this,o,a(e)),l=!1)})),o}},{d:130}],135:[function(e,t){"use strict";var a=e("d"),o=e("ext/global-this").Symbol;t.exports=function(e){return Object.defineProperties(e,{hasInstance:a("",o&&o.hasInstance||e("hasInstance")),isConcatSpreadable:a("",o&&o.isConcatSpreadable||e("isConcatSpreadable")),iterator:a("",o&&o.iterator||e("iterator")),match:a("",o&&o.match||e("match")),replace:a("",o&&o.replace||e("replace")),search:a("",o&&o.search||e("search")),species:a("",o&&o.species||e("species")),split:a("",o&&o.split||e("split")),toPrimitive:a("",o&&o.toPrimitive||e("toPrimitive")),toStringTag:a("",o&&o.toStringTag||e("toStringTag")),unscopables:a("",o&&o.unscopables||e("unscopables"))})}},{d:130,"ext/global-this":198}],136:[function(e,t){"use strict";var a=e("d"),o=e("../../../validate-symbol"),r=Object.create(null);t.exports=function(e){return Object.defineProperties(e,{for:a(function(t){return r[t]?r[t]:r[t]=e(t+"")}),keyFor:a(function(e){for(var t in o(e),r)if(r[t]===e)return t})})}},{"../../../validate-symbol":138,d:130}],137:[function(e,t){"use strict";var a=e("d"),o=e("./validate-symbol"),r=e("ext/global-this").Symbol,i=e("./lib/private/generate-name"),n=e("./lib/private/setup/standard-symbols"),l=e("./lib/private/setup/symbol-registry"),s=Object.create,d=Object.defineProperties,c=Object.defineProperty,p,u,g;if("function"==typeof r)try{r()+"",g=!0}catch(e){}else r=null;u=function(e){if(this instanceof u)throw new TypeError("Symbol is not a constructor");return p(e)},t.exports=p=function e(t){var o;if(this instanceof e)throw new TypeError("Symbol is not a constructor");return g?r(t):(o=s(u.prototype),t=void 0===t?"":t+"",d(o,{__description__:a("",t),__name__:a("",i(t))}))},n(p),l(p),d(u.prototype,{constructor:a(p),toString:a("",function(){return this.__name__})}),d(p.prototype,{toString:a(function(){return"Symbol ("+o(this).__description__+")"}),valueOf:a(function(){return o(this)})}),c(p.prototype,p.toPrimitive,a("",function(){var e=o(this);return"symbol"==typeof e?e:e.toString()})),c(p.prototype,p.toStringTag,a("c","Symbol")),c(u.prototype,p.toStringTag,a("c",p.prototype[p.toStringTag])),c(u.prototype,p.toPrimitive,a("c",p.prototype[p.toPrimitive]))},{"./lib/private/generate-name":134,"./lib/private/setup/standard-symbols":135,"./lib/private/setup/symbol-registry":136,"./validate-symbol":138,d:130,"ext/global-this":198}],138:[function(e,t){"use strict";var a=e("./is-symbol");t.exports=function(e){if(!a(e))throw new TypeError(e+" is not a symbol");return e}},{"./is-symbol":133}],139:[function(e,t){"use strict";var a=e("../math/sign"),o=Math.abs,r=Math.floor;t.exports=function(e){return isNaN(e)?0:(e=+e,0!==e&&isFinite(e)?a(e)*r(o(e)):e)}},{"../math/sign":127}],140:[function(e,t){"use strict";var a=e("./to-integer"),o=Math.max;t.exports=function(e){return o(0,a(e))}},{"./to-integer":139}],141:[function(e,t){"use strict";var a=e("./valid-callable"),o=e("./valid-value"),r=Function.prototype.bind,i=Function.prototype.call,n=Object.keys,l=Object.prototype.propertyIsEnumerable;t.exports=function(e,t){return function(s,d){var c=arguments[2],p=arguments[3],u;return s=Object(o(s)),a(d),u=n(s),p&&u.sort("function"==typeof p?r.call(p,s):void 0),"function"!=typeof e&&(e=u[e]),i.call(e,u,function(e,a){return l.call(s,e)?i.call(d,c,s[e],e,s,a):t})}}},{"./valid-callable":158,"./valid-value":160}],142:[function(e,t){"use strict";t.exports=e("./is-implemented")()?Object.assign:e("./shim")},{"./is-implemented":143,"./shim":144}],143:[function(e,t){"use strict";t.exports=function(){var e=Object.assign,t;return!("function"!=typeof e)&&(t={foo:"raz"},e(t,{bar:"dwa"},{trzy:"trzy"}),"razdwatrzy"===t.foo+t.bar+t.trzy)}},{}],144:[function(e,t){"use strict";var a=e("../keys"),o=e("../valid-value"),r=Math.max;t.exports=function(e,t){var n=r(arguments.length,2),l,s,d;for(e=Object(o(e)),d=function(a){try{e[a]=t[a]}catch(t){l||(l=t)}},s=1;s<n;++s)t=arguments[s],a(t).forEach(d);if(l!==void 0)throw l;return e}},{"../keys":150,"../valid-value":160}],145:[function(e,t){"use strict";var a=e("../array/from"),o=e("./assign"),r=e("./valid-value");t.exports=function(e){var t=Object(r(e)),i=arguments[1],n=Object(arguments[2]);if(t!==e&&!i)return t;var l={};return i?a(i,function(t){(n.ensure||t in e)&&(l[t]=e[t])}):o(l,e),l}},{"../array/from":121,"./assign":142,"./valid-value":160}],146:[function(e,t){"use strict";var a=Object.create,o;e("./set-prototype-of/is-implemented")()||(o=e("./set-prototype-of/shim")),t.exports=function(){var e,t,r;return o?1===o.level?(e={},t={},r={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(e){return"__proto__"===e?void(t[e]={configurable:!0,enumerable:!1,writable:!0,value:void 0}):void(t[e]=r)}),Object.defineProperties(e,t),Object.defineProperty(o,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:e}),function(t,o){return a(null===t?e:t,o)}):a:a}()},{"./set-prototype-of/is-implemented":156,"./set-prototype-of/shim":157}],147:[function(e,t){"use strict";t.exports=e("./_iterate")("forEach")},{"./_iterate":141}],148:[function(e,t){"use strict";var a=e("./is-value"),o={function:!0,object:!0};t.exports=function(e){return a(e)&&o[typeof e]||!1}},{"./is-value":149}],149:[function(e,t){"use strict";var a=e("../function/noop")();t.exports=function(e){return e!==a&&null!==e}},{"../function/noop":126}],150:[function(e,t){"use strict";t.exports=e("./is-implemented")()?Object.keys:e("./shim")},{"./is-implemented":151,"./shim":152}],151:[function(e,t){"use strict";t.exports=function(){try{return Object.keys("primitive"),!0}catch(t){return!1}}},{}],152:[function(e,t){"use strict";var a=e("../is-value"),o=Object.keys;t.exports=function(e){return o(a(e)?Object(e):e)}},{"../is-value":149}],153:[function(e,t){"use strict";var a=e("./valid-callable"),o=e("./for-each"),r=Function.prototype.call;t.exports=function(e,t){var i={},n=arguments[2];return a(t),o(e,function(e,a,o,l){i[a]=r.call(t,n,e,a,o,l)}),i}},{"./for-each":147,"./valid-callable":158}],154:[function(e,t){"use strict";var a=e("./is-value"),o=Array.prototype.forEach,r=Object.create,i=function(e,t){for(var a in e)t[a]=e[a]};t.exports=function(){var e=r(null);return o.call(arguments,function(t){a(t)&&i(Object(t),e)}),e}},{"./is-value":149}],155:[function(e,t){"use strict";t.exports=e("./is-implemented")()?Object.setPrototypeOf:e("./shim")},{"./is-implemented":156,"./shim":157}],156:[function(e,t){"use strict";var a=Object.create,o=Object.getPrototypeOf,r={};t.exports=function(){var e=Object.setPrototypeOf,t=arguments[0]||a;return!("function"!=typeof e)&&o(e(t(null),r))===r}},{}],157:[function(e,t){"use strict";var a=e("../is-object"),o=e("../valid-value"),r=Object.prototype.isPrototypeOf,i=Object.defineProperty,n={configurable:!0,enumerable:!1,writable:!0,value:void 0},l;l=function(e,t){if(o(e),null===t||a(t))return e;throw new TypeError("Prototype must be null or an object")},t.exports=function(e){var t,a;return e?(2===e.level?e.set?(a=e.set,t=function(e,t){return a.call(l(e,t),t),e}):t=function(e,t){return l(e,t).__proto__=t,e}:t=function e(t,a){var o;return l(t,a),o=r.call(e.nullPolyfill,t),o&&delete e.nullPolyfill.__proto__,null===a&&(a=e.nullPolyfill),t.__proto__=a,o&&i(e.nullPolyfill,"__proto__",n),t},Object.defineProperty(t,"level",{configurable:!1,enumerable:!1,writable:!1,value:e.level})):null}(function(){var e=Object.create(null),t={},a=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__"),o;if(a){try{o=a.set,o.call(e,t)}catch(e){}if(Object.getPrototypeOf(e)===t)return{set:o,level:2}}return(e.__proto__=t,Object.getPrototypeOf(e)===t)?{level:2}:(e={},e.__proto__=t,Object.getPrototypeOf(e)===t&&{level:1})}()),e("../create")},{"../create":146,"../is-object":148,"../valid-value":160}],158:[function(e,t){"use strict";t.exports=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e}},{}],159:[function(e,t){"use strict";var a=e("./is-object");t.exports=function(e){if(!a(e))throw new TypeError(e+" is not an Object");return e}},{"./is-object":148}],160:[function(e,t){"use strict";var a=e("./is-value");t.exports=function(e){if(!a(e))throw new TypeError("Cannot use null or undefined");return e}},{"./is-value":149}],161:[function(e,t){"use strict";t.exports=e("./is-implemented")()?String.prototype.contains:e("./shim")},{"./is-implemented":162,"./shim":163}],162:[function(e,t){"use strict";t.exports=function(){return!1}},{}],163:[function(e,t){"use strict";var a=String.prototype.indexOf;t.exports=function(e){return-1<a.call(this,e,arguments[1])}},{}],164:[function(e,t){"use strict";var a=Object.prototype.toString,o=a.call("");t.exports=function(e){return"string"==typeof e||e&&"object"==typeof e&&(e instanceof String||a.call(e)===o)||!1}},{}],165:[function(e,t){"use strict";var a=Object.create(null),o=Math.random;t.exports=function(){var e;do e=o().toString(36).slice(2);while(a[e]);return e}},{}],166:[function(e,t){"use strict";var a=e("es5-ext/object/set-prototype-of"),o=e("es5-ext/string/#/contains"),r=e("d"),i=e("es6-symbol"),n=e("./"),l=Object.defineProperty,s;s=t.exports=function(e,t){if(!(this instanceof s))throw new TypeError("Constructor requires 'new'");n.call(this,e),t=t?o.call(t,"key+value")?"key+value":o.call(t,"key")?"key":"value":"value",l(this,"__kind__",r("",t))},a&&a(s,n),delete s.prototype.constructor,s.prototype=Object.create(n.prototype,{_resolve:r(function(e){return"value"===this.__kind__?this.__list__[e]:"key+value"===this.__kind__?[e,this.__list__[e]]:e})}),l(s.prototype,i.toStringTag,r("c","Array Iterator"))},{"./":169,d:172,"es5-ext/object/set-prototype-of":155,"es5-ext/string/#/contains":161,"es6-symbol":173}],167:[function(e,t){"use strict";var a=e("es5-ext/function/is-arguments"),o=e("es5-ext/object/valid-callable"),r=e("es5-ext/string/is-string"),n=e("./get"),l=Array.isArray,s=Function.prototype.call,d=Array.prototype.some;t.exports=function(e,t){var c=arguments[2],p,u,g,m,h,y,f,x;if(l(e)||a(e)?p="array":r(e)?p="string":e=n(e),o(t),g=function(){m=!0},"array"===p)return void d.call(e,function(e){return s.call(t,c,e,g),m});if("string"===p){for(y=e.length,h=0;h<y&&(f=e[h],h+1<y&&(x=f.charCodeAt(0),55296<=x&&56319>=x&&(f+=e[++h])),s.call(t,c,f,g),!m);++h);return}for(u=e.next();!u.done;){if(s.call(t,c,u.value,g),m)return;u=e.next()}}},{"./get":168,"es5-ext/function/is-arguments":124,"es5-ext/object/valid-callable":158,"es5-ext/string/is-string":164}],168:[function(e,t){"use strict";var a=e("es5-ext/function/is-arguments"),o=e("es5-ext/string/is-string"),r=e("./array"),i=e("./string"),n=e("./valid-iterable"),l=e("es6-symbol").iterator;t.exports=function(e){return"function"==typeof n(e)[l]?e[l]():a(e)?new r(e):o(e)?new i(e):new r(e)}},{"./array":166,"./string":181,"./valid-iterable":182,"es5-ext/function/is-arguments":124,"es5-ext/string/is-string":164,"es6-symbol":173}],169:[function(e,t){"use strict";var a=e("es5-ext/array/#/clear"),o=e("es5-ext/object/assign"),r=e("es5-ext/object/valid-callable"),i=e("es5-ext/object/valid-value"),n=e("d"),l=e("d/auto-bind"),s=e("es6-symbol"),d=Object.defineProperty,c=Object.defineProperties,p;t.exports=p=function(e,t){if(!(this instanceof p))throw new TypeError("Constructor requires 'new'");c(this,{__list__:n("w",i(e)),__context__:n("w",t),__nextIndex__:n("w",0)});t&&(r(t.on),t.on("_add",this._onAdd),t.on("_delete",this._onDelete),t.on("_clear",this._onClear))},delete p.prototype.constructor,c(p.prototype,o({_next:n(function(){var e;if(this.__list__){if(this.__redo__&&(e=this.__redo__.shift(),void 0!==e))return e;if(this.__nextIndex__<this.__list__.length)return this.__nextIndex__++;this._unBind()}}),next:n(function(){return this._createResult(this._next())}),_createResult:n(function(e){return void 0===e?{done:!0,value:void 0}:{done:!1,value:this._resolve(e)}}),_resolve:n(function(e){return this.__list__[e]}),_unBind:n(function(){this.__list__=null,delete this.__redo__;this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:n(function(){return"[object "+(this[s.toStringTag]||"Object")+"]"})},l({_onAdd:n(function(e){if(!(e>=this.__nextIndex__))return++this.__nextIndex__,this.__redo__?void(this.__redo__.forEach(function(t,a){t>=e&&(this.__redo__[a]=++t)},this),this.__redo__.push(e)):void d(this,"__redo__",n("c",[e]))}),_onDelete:n(function(e){var t;e>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&(t=this.__redo__.indexOf(e),-1!==t&&this.__redo__.splice(t,1),this.__redo__.forEach(function(t,a){t>e&&(this.__redo__[a]=--t)},this)))}),_onClear:n(function(){this.__redo__&&a.call(this.__redo__),this.__nextIndex__=0})}))),d(p.prototype,s.iterator,n(function(){return this}))},{d:172,"d/auto-bind":171,"es5-ext/array/#/clear":120,"es5-ext/object/assign":142,"es5-ext/object/valid-callable":158,"es5-ext/object/valid-value":160,"es6-symbol":173}],170:[function(e,t){"use strict";var a=e("es5-ext/function/is-arguments"),o=e("es5-ext/object/is-value"),r=e("es5-ext/string/is-string"),i=e("es6-symbol").iterator,n=Array.isArray;t.exports=function(e){return!!o(e)&&(!!n(e)||!!r(e)||!!a(e)||"function"==typeof e[i])}},{"es5-ext/function/is-arguments":124,"es5-ext/object/is-value":149,"es5-ext/string/is-string":164,"es6-symbol":173}],171:[function(e,t){"use strict";var a=e("type/value/is"),o=e("type/value/ensure"),r=e("type/plain-function/ensure"),i=e("es5-ext/object/copy"),n=e("es5-ext/object/normalize-options"),l=e("es5-ext/object/map"),s=Function.prototype.bind,d=Object.defineProperty,c=Object.prototype.hasOwnProperty,p;p=function(e,t,a){var n=o(t)&&r(t.value),l;return l=i(t),delete l.writable,delete l.value,l.get=function(){return!a.overwriteDefinition&&c.call(this,e)?n:(t.value=s.call(n,a.resolveContext?a.resolveContext(this):this),d(this,e,t),this[e])},l},t.exports=function(e){var t=n(arguments[1]);return a(t.resolveContext)&&r(t.resolveContext),l(e,function(e,a){return p(a,e,t)})}},{"es5-ext/object/copy":145,"es5-ext/object/map":153,"es5-ext/object/normalize-options":154,"type/plain-function/ensure":1322,"type/value/ensure":1326,"type/value/is":1327}],172:[function(e,t,a){arguments[4][130][0].apply(a,arguments)},{dup:130,"es5-ext/object/assign":142,"es5-ext/object/normalize-options":154,"es5-ext/string/#/contains":161,"type/plain-function/is":1323,"type/value/is":1327}],173:[function(e,t,a){arguments[4][131][0].apply(a,arguments)},{"./is-implemented":174,"./polyfill":179,dup:131,"ext/global-this":198}],174:[function(e,t,a){arguments[4][132][0].apply(a,arguments)},{dup:132,"ext/global-this":198}],175:[function(e,t,a){arguments[4][133][0].apply(a,arguments)},{dup:133}],176:[function(e,t,a){arguments[4][134][0].apply(a,arguments)},{d:172,dup:134}],177:[function(e,t,a){arguments[4][135][0].apply(a,arguments)},{d:172,dup:135,"ext/global-this":198}],178:[function(e,t,a){arguments[4][136][0].apply(a,arguments)},{"../../../validate-symbol":180,d:172,dup:136}],179:[function(e,t,a){arguments[4][137][0].apply(a,arguments)},{"./lib/private/generate-name":176,"./lib/private/setup/standard-symbols":177,"./lib/private/setup/symbol-registry":178,"./validate-symbol":180,d:172,dup:137,"ext/global-this":198}],180:[function(e,t,a){arguments[4][138][0].apply(a,arguments)},{"./is-symbol":175,dup:138}],181:[function(e,t){"use strict";var a=e("es5-ext/object/set-prototype-of"),o=e("d"),r=e("es6-symbol"),i=e("./"),n=Object.defineProperty,l;l=t.exports=function(e){if(!(this instanceof l))throw new TypeError("Constructor requires 'new'");e=e+"",i.call(this,e),n(this,"__length__",o("",e.length))},a&&a(l,i),delete l.prototype.constructor,l.prototype=Object.create(i.prototype,{_next:o(function(){if(this.__list__){if(this.__nextIndex__<this.__length__)return this.__nextIndex__++;this._unBind()}}),_resolve:o(function(e){var t=this.__list__[e],a;return this.__nextIndex__===this.__length__?t:(a=t.charCodeAt(0),55296<=a&&56319>=a?t+this.__list__[this.__nextIndex__++]:t)})}),n(l.prototype,r.toStringTag,o("c","String Iterator"))},{"./":169,d:172,"es5-ext/object/set-prototype-of":155,"es6-symbol":173}],182:[function(e,t){"use strict";var a=e("./is-iterable");t.exports=function(e){if(!a(e))throw new TypeError(e+" is not iterable");return e}},{"./is-iterable":170}],183:[function(e,t,a){(function(o,r){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */(function(e,o){"object"==typeof a&&"undefined"!=typeof t?t.exports=o():"function"==typeof define&&define.amd?define(o):e.ES6Promise=o()})(this,function(){'use strict';function t(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}function a(e){return"function"==typeof e}function i(){return"undefined"==typeof O?n():function(){O(l)}}function n(){var e=setTimeout;return function(){return e(l,1)}}function l(){for(var e=0;e<D;e+=2){var t=U[e],a=U[e+1];t(a),U[e]=void 0,U[e+1]=void 0}D=0}function s(e,t){var a=this,o=new this.constructor(p);void 0===o[q]&&C(o);var r=a._state;if(r){var i=arguments[r-1];M(function(){return T(r,o,i,a._result)})}else w(a,o,e,t);return o}function d(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var a=new t(p);return x(a,e),a}function p(){}function u(){return new TypeError("You cannot resolve a promise with itself")}function g(){return new TypeError("A promises callback cannot return that same promise.")}function m(e,t,a,o){try{e.call(t,a,o)}catch(t){return t}}function h(e,t,a){M(function(e){var o=!1,r=m(a,t,function(a){o||(o=!0,t===a?b(e,a):x(e,a))},function(t){o||(o=!0,v(e,t))},"Settle: "+(e._label||" unknown promise"));!o&&r&&(o=!0,v(e,r))},e)}function y(e,t){1===t._state?b(e,t._result):2===t._state?v(e,t._result):w(t,void 0,function(t){return x(e,t)},function(t){return v(e,t)})}function f(e,t,o){t.constructor===e.constructor&&o===s&&t.constructor.resolve===d?y(e,t):void 0===o?b(e,t):a(o)?h(e,t,o):b(e,t)}function x(e,a){if(e===a)v(e,u());else if(t(a)){var o;try{o=a.then}catch(t){return void v(e,t)}f(e,a,o)}else b(e,a)}function _(e){e._onerror&&e._onerror(e._result),k(e)}function b(e,t){void 0!==e._state||(e._result=t,e._state=1,0!==e._subscribers.length&&M(k,e))}function v(e,t){void 0!==e._state||(e._state=2,e._result=t,M(_,e))}function w(e,t,a,o){var r=e._subscribers,i=r.length;e._onerror=null,r[i]=t,r[i+1]=a,r[i+2]=o,0===i&&e._state&&M(k,e)}function k(e){var t=e._subscribers,a=e._state;if(0!==t.length){for(var o=void 0,r=void 0,n=e._result,l=0;l<t.length;l+=3)o=t[l],r=t[l+a],o?T(a,o,r,n):r(n);e._subscribers.length=0}}function T(e,t,o,r){var i=a(o),n=!0,l,s;if(i){try{l=o(r)}catch(t){n=!1,s=t}if(t===l)return void v(t,g())}else l=r;void 0!==t._state||(i&&n?x(t,l):!1===n?v(t,s):1===e?b(t,l):2===e&&v(t,l))}function A(t,a){try{a(function(e){x(t,e)},function(e){v(t,e)})}catch(a){v(t,a)}}function S(){return W++}function C(e){e[q]=W++,e._state=void 0,e._result=void 0,e._subscribers=[]}function L(){return new Error("Array Methods must be provided an Array")}function E(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function I(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var P=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var z=P,D=0,O=void 0,R=void 0,M=function(e,t){U[D]=e,U[D+1]=t,D+=2,2===D&&(R?R(l):H())},j="undefined"==typeof window?void 0:window,B=j||{},F=B.MutationObserver||B.WebKitMutationObserver,N="undefined"==typeof self&&"undefined"!=typeof o&&"[object process]"==={}.toString.call(o),V="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,U=Array(1e3),H=void 0;H=N?function(){return function(){return o.nextTick(l)}}():F?function(){var e=0,t=new F(l),a=document.createTextNode("");return t.observe(a,{characterData:!0}),function(){a.data=e=++e%2}}():V?function(){var e=new MessageChannel;return e.port1.onmessage=l,function(){return e.port2.postMessage(0)}}():void 0===j&&"function"==typeof e?function(){try{var e=Function("return this")().require("vertx");return O=e.runOnLoop||e.runOnContext,i()}catch(t){return n()}}():n();var q=Math.random().toString(36).substring(2),G=void 0,Y=2,W=0,c=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(p),this.promise[q]||C(this.promise),z(t)?(this.length=t.length,this._remaining=t.length,this._result=Array(this.length),0===this.length?b(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&b(this.promise,this._result))):v(this.promise,L())}return e.prototype._enumerate=function(e){for(var t=0;this._state===G&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var a=this._instanceConstructor,o=a.resolve;if(o===d){var r=void 0,i=void 0,n=!1;try{r=e.then}catch(t){n=!0,i=t}if(r===s&&e._state!==G)this._settledAt(e._state,t,e._result);else if("function"!=typeof r)this._remaining--,this._result[t]=e;else if(a===X){var l=new a(p);n?v(l,i):f(l,e,r),this._willSettleAt(l,t)}else this._willSettleAt(new a(function(t){return t(e)}),t)}else this._willSettleAt(o(e),t)},e.prototype._settledAt=function(e,t,a){var o=this.promise;o._state===G&&(this._remaining--,e===Y?v(o,a):this._result[t]=a),0===this._remaining&&b(o,this._result)},e.prototype._willSettleAt=function(e,t){var a=this;w(e,void 0,function(e){return a._settledAt(1,t,e)},function(e){return a._settledAt(Y,t,e)})},e}(),X=function(){function e(t){this[q]=S(),this._result=this._state=void 0,this._subscribers=[],p!==t&&("function"!=typeof t&&E(),this instanceof e?A(this,t):I())}return e.prototype.catch=function(e){return this.then(null,e)},e.prototype.finally=function(e){var t=this,o=t.constructor;return a(e)?t.then(function(t){return o.resolve(e()).then(function(){return t})},function(t){return o.resolve(e()).then(function(){throw t})}):t.then(e,e)},e}();return X.prototype.then=s,X.all=function(e){return new c(this,e).promise},X.race=function(e){var t=this;return z(e)?new t(function(a,o){for(var r=e.length,n=0;n<r;n++)t.resolve(e[n]).then(a,o)}):new t(function(e,t){return t(new TypeError("You must pass an array to race."))})},X.resolve=d,X.reject=function(e){var t=this,a=new t(p);return v(a,e),a},X._setScheduler=function(e){R=e},X._setAsap=function(e){M=e},X._asap=M,X.polyfill=function(){var e;if("undefined"!=typeof r)e=r;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var a=null;try{a=Object.prototype.toString.call(t.resolve())}catch(t){}if("[object Promise]"===a&&!t.cast)return}e.Promise=X},X.Promise=X,X})}).call(this,e("_process"),"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{_process:1425}],184:[function(e,t){"use strict";t.exports=e("./is-implemented")()?WeakMap:e("./polyfill")},{"./is-implemented":185,"./polyfill":196}],185:[function(e,t){"use strict";t.exports=function(){var e,t;if("function"!=typeof WeakMap)return!1;try{e=new WeakMap([[t={},"one"],[{},"two"],[{},"three"]])}catch(t){return!1}return!("[object WeakMap]"!==e+"")&&!("function"!=typeof e.set)&&!(e.set({},1)!==e)&&!("function"!=typeof e.delete)&&!("function"!=typeof e.has)&&!("one"!==e.get(t))}},{}],186:[function(e,t){"use strict";t.exports=function(){return!("function"!=typeof WeakMap)&&"[object WeakMap]"===Object.prototype.toString.call(new WeakMap)}()},{}],187:[function(e,t,a){arguments[4][130][0].apply(a,arguments)},{dup:130,"es5-ext/object/assign":142,"es5-ext/object/normalize-options":154,"es5-ext/string/#/contains":161,"type/plain-function/is":1323,"type/value/is":1327}],188:[function(e,t,a){arguments[4][131][0].apply(a,arguments)},{"./is-implemented":189,"./polyfill":194,dup:131,"ext/global-this":198}],189:[function(e,t,a){arguments[4][132][0].apply(a,arguments)},{dup:132,"ext/global-this":198}],190:[function(e,t,a){arguments[4][133][0].apply(a,arguments)},{dup:133}],191:[function(e,t,a){arguments[4][134][0].apply(a,arguments)},{d:187,dup:134}],192:[function(e,t,a){arguments[4][135][0].apply(a,arguments)},{d:187,dup:135,"ext/global-this":198}],193:[function(e,t,a){arguments[4][136][0].apply(a,arguments)},{"../../../validate-symbol":195,d:187,dup:136}],194:[function(e,t,a){arguments[4][137][0].apply(a,arguments)},{"./lib/private/generate-name":191,"./lib/private/setup/standard-symbols":192,"./lib/private/setup/symbol-registry":193,"./validate-symbol":195,d:187,dup:137,"ext/global-this":198}],195:[function(e,t,a){arguments[4][138][0].apply(a,arguments)},{"./is-symbol":190,dup:138}],196:[function(e,t){"use strict";var a=e("es5-ext/object/is-value"),o=e("es5-ext/object/set-prototype-of"),r=e("es5-ext/object/valid-object"),i=e("es5-ext/object/valid-value"),n=e("es5-ext/string/random-uniq"),l=e("d"),s=e("es6-iterator/get"),d=e("es6-iterator/for-of"),c=e("es6-symbol").toStringTag,p=e("./is-native-implemented"),u=Array.isArray,g=Object.defineProperty,m=Object.prototype.hasOwnProperty,h=Object.getPrototypeOf,y;t.exports=y=function(){var e=arguments[0],t;if(!(this instanceof y))throw new TypeError("Constructor requires 'new'");return(t=p&&o&&WeakMap!==y?o(new WeakMap,h(this)):this,a(e)&&!u(e)&&(e=s(e)),g(t,"__weakMapData__",l("c","$weakMap$"+n())),!e)?t:(d(e,function(e){i(e),t.set(e[0],e[1])}),t)},p&&(o&&o(y,WeakMap),y.prototype=Object.create(WeakMap.prototype,{constructor:l(y)})),Object.defineProperties(y.prototype,{delete:l(function(e){return!!m.call(r(e),this.__weakMapData__)&&(delete e[this.__weakMapData__],!0)}),get:l(function(e){return m.call(r(e),this.__weakMapData__)?e[this.__weakMapData__]:void 0}),has:l(function(e){return m.call(r(e),this.__weakMapData__)}),set:l(function(e,t){return g(r(e),this.__weakMapData__,l("c",t)),this}),toString:l(function(){return"[object WeakMap]"})}),g(y.prototype,c,l("c","WeakMap"))},{"./is-native-implemented":186,d:187,"es5-ext/object/is-value":149,"es5-ext/object/set-prototype-of":155,"es5-ext/object/valid-object":159,"es5-ext/object/valid-value":160,"es5-ext/string/random-uniq":165,"es6-iterator/for-of":167,"es6-iterator/get":168,"es6-symbol":188}],197:[function(e,t){var a=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};t.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return a()}try{return __global__?__global__:a()}finally{delete Object.prototype.__global__}}()},{}],198:[function(e,t){"use strict";t.exports=e("./is-implemented")()?globalThis:e("./implementation")},{"./implementation":197,"./is-implemented":199}],199:[function(e,t){"use strict";t.exports=function(){return!("object"!=typeof globalThis)&&!!globalThis&&globalThis.Array===Array}},{}],200:[function(e,t){"use strict";t.exports=function(e,t,a){var o=t||0,r=a||1;return[[e[12]+e[0],e[13]+e[1],e[14]+e[2],e[15]+e[3]],[e[12]-e[0],e[13]-e[1],e[14]-e[2],e[15]-e[3]],[e[12]+e[4],e[13]+e[5],e[14]+e[6],e[15]+e[7]],[e[12]-e[4],e[13]-e[5],e[14]-e[6],e[15]-e[7]],[o*e[12]+e[8],o*e[13]+e[9],o*e[14]+e[10],o*e[15]+e[11]],[r*e[12]-e[8],r*e[13]-e[9],r*e[14]-e[10],r*e[15]-e[11]]]}},{}],201:[function(e,t){'use strict';var a=e("is-string-blank");t.exports=function(e){var t=typeof e;if("string"==t){var o=e;if(e=+e,0===e&&a(o))return!1}else if("number"!==t)return!1;return 1>e-e}},{"is-string-blank":392}],202:[function(e,t){'use strict';function a(e){return this instanceof a?void(this.array=[],this.size=0,this.compare=e||o):new a(e)}var o=function(e,t){return e<t};a.prototype.clone=function(){var e=new a(this.compare);e.size=this.size;for(var t=0;t<this.size;t++)e.array.push(this.array[t]);return e},a.prototype.add=function(e){var t=this.size;this.array[this.size]=e,this.size+=1;for(var a,o;0<t&&(a=t-1>>1,o=this.array[a],!!this.compare(e,o));)this.array[t]=o,t=a;this.array[t]=e},a.prototype.heapify=function(e){this.array=e,this.size=e.length;var t;for(t=this.size>>1;0<=t;t--)this._percolateDown(t)},a.prototype._percolateUp=function(e,t){for(var a=this.array[e],o,r;0<e&&(o=e-1>>1,r=this.array[o],t||this.compare(a,r));)this.array[e]=r,e=o;this.array[e]=a},a.prototype._percolateDown=function(e){for(var t=this.size,a=this.size>>>1,o=this.array[e],n,s,d;e<a&&(n=(e<<1)+1,s=n+1,d=this.array[n],s<t&&this.compare(this.array[s],d)&&(n=s,d=this.array[s]),!!this.compare(d,o));)this.array[e]=d,e=n;this.array[e]=o},a.prototype._removeAt=function(e){if(!(e>this.size-1||0>e))return this._percolateUp(e,!0),this.poll()},a.prototype.remove=function(e){for(var t=0;t<this.size;t++)if(!this.compare(this.array[t],e)&&!this.compare(e,this.array[t]))return this._removeAt(t),!0;return!1},a.prototype._batchRemove=function(e,t){var a=Array(t?t:this.size),o=0;if("function"==typeof e&&this.size)for(var r=0;r<this.size&&o<a.length;)e(this.array[r])?(a[o]=this._removeAt(r),o++,r>>=1):r++;return a.length=o,a},a.prototype.removeOne=function(e){var t=this._batchRemove(e,1);return 0<t.length?t[0]:void 0},a.prototype.removeMany=function(e,t){return this._batchRemove(e,t)},a.prototype.peek=function(){return 0==this.size?void 0:this.array[0]},a.prototype.poll=function(){if(0!=this.size){var e=this.array[0];return 1<this.size?(this.array[0]=this.array[--this.size],this._percolateDown(0)):this.size-=1,e}},a.prototype.replaceTop=function(e){if(0!=this.size){var t=this.array[0];return this.array[0]=e,this._percolateDown(0),t}},a.prototype.trim=function(){this.array=this.array.slice(0,this.size)},a.prototype.isEmpty=function(){return 0===this.size},a.prototype.forEach=function(e){if(!(this.isEmpty()||"function"!=typeof e))for(var t=0,a=this.clone();!a.isEmpty();)e(a.poll(),t++)},a.prototype.kSmallest=function(e){if(0==this.size)return[];var t=this.compare,o=this.array,i=new a(function(e,a){return t(o[e],o[a])});e=Math.min(this.size,e);var n=Array(e),s=0;for(i.add(0);s<e;){var d=i.poll();n[s++]=this.array[d];var c=(d<<1)+1,l=c+1;c<this.size&&i.add(c),l<this.size&&i.add(l)}return n};e.main===t&&function(){var e=new a(function(e,t){return e<t});for(e.add(1),e.add(0),e.add(5),e.add(4),e.add(3);!e.isEmpty();)console.log(e.poll())}(),t.exports=a},{}],203:[function(e,t){'use strict';function a(e,t,a){return Math.min(t,Math.max(e,a))}function o(e,t,a){this.dimension=e.length,this.bounds=[Array(this.dimension),Array(this.dimension)];for(var o=0;o<this.dimension;++o)this.bounds[0][o]=-Infinity,this.bounds[1][o]=1/0;this._state=e.slice().reverse(),this._velocity=t.slice().reverse(),this._time=[a],this._scratch=[e.slice(),e.slice(),e.slice(),e.slice(),e.slice()]}function r(e){for(var t=Array(e),a=0;a<e;++a)t[a]=0;return t}t.exports=function(e,t,a){switch(arguments.length){case 0:return new o([0],[0],0);case 1:if("number"==typeof e){var i=r(e);return new o(i,i,0)}return new o(e,r(e.length),0);case 2:if("number"==typeof t){var i=r(e.length);return new o(e,i,+t)}a=0;case 3:if(e.length!==t.length)throw new Error("state and velocity lengths must match");return new o(e,t,a);}};var n=e("cubic-hermite"),l=e("binary-search-bounds"),s=o.prototype;s.flush=function(e){var t=l.gt(this._time,e)-1;0>=t||(this._time.splice(0,t),this._state.splice(0,t*this.dimension),this._velocity.splice(0,t*this.dimension))},s.curve=function(e){var t=this._time,o=t.length,r=l.le(t,e),s=this._scratch[0],c=this._state,p=this._velocity,u=this.dimension,d=this.bounds;if(0>r)for(var g=u-1,m=0;m<u;++m,--g)s[m]=c[g];else if(r>=o-1)for(var g=c.length-1,h=e-t[o-1],m=0;m<u;++m,--g)s[m]=c[g]+h*p[g];else{for(var g=u*(r+1)-1,y=t[r],f=t[r+1],x=f-y||1,_=this._scratch[1],b=this._scratch[2],v=this._scratch[3],w=this._scratch[4],k=!0,m=0;m<u;++m,--g)_[m]=c[g],v[m]=p[g]*x,b[m]=c[g+u],w[m]=p[g+u]*x,k=k&&_[m]===b[m]&&v[m]===w[m]&&0===v[m];if(k)for(var m=0;m<u;++m)s[m]=_[m];else n(_,v,b,w,(e-y)/x,s)}for(var T=d[0],A=d[1],m=0;m<u;++m)s[m]=a(T[m],A[m],s[m]);return s},s.dcurve=function(e){var t=this._time,a=t.length,o=l.le(t,e),r=this._scratch[0],s=this._state,c=this._velocity,p=this.dimension;if(o>=a-1)for(var d=s.length-1,u=e-t[a-1],g=0;g<p;++g,--d)r[g]=c[d];else{for(var d=p*(o+1)-1,m=t[o],h=t[o+1],y=h-m||1,f=this._scratch[1],x=this._scratch[2],_=this._scratch[3],b=this._scratch[4],v=!0,g=0;g<p;++g,--d)f[g]=s[d],_[g]=c[d]*y,x[g]=s[d+p],b[g]=c[d+p]*y,v=v&&f[g]===x[g]&&_[g]===b[g]&&0===_[g];if(v)for(var g=0;g<p;++g)r[g]=0;else{n.derivative(f,_,x,b,(e-m)/y,r);for(var g=0;g<p;++g)r[g]/=y}}return r},s.lastT=function(){var e=this._time;return e[e.length-1]},s.stable=function(){for(var e=this._velocity,t=e.length,a=this.dimension-1;0<=a;--a)if(e[--t])return!1;return!0},s.jump=function(e){var t=this.lastT(),o=this.dimension;if(!(e<t||arguments.length!==o+1)){var r=this._state,n=this._velocity,l=r.length-this.dimension,s=this.bounds,d=s[0],c=s[1];this._time.push(t,e);for(var p=0;2>p;++p)for(var u=0;u<o;++u)r.push(r[l++]),n.push(0);this._time.push(e);for(var u=o;0<u;--u)r.push(a(d[u-1],c[u-1],arguments[u])),n.push(0)}},s.push=function(e){var t=this.lastT(),o=this.dimension;if(!(e<t||arguments.length!==o+1)){var r=this._state,n=this._velocity,l=r.length-this.dimension,s=e-t,d=this.bounds,c=d[0],p=d[1],u=1e-6<s?1/s:0;this._time.push(e);for(var g=o,m;0<g;--g)m=a(c[g-1],p[g-1],arguments[g]),r.push(m),n.push((m-r[l++])*u)}},s.set=function(e){var t=this.dimension;if(!(e<this.lastT()||arguments.length!==t+1)){var o=this._state,r=this._velocity,n=this.bounds,l=n[0],s=n[1];this._time.push(e);for(var d=t;0<d;--d)o.push(a(l[d-1],s[d-1],arguments[d])),r.push(0)}},s.move=function(e){var t=this.lastT(),o=this.dimension;if(!(e<=t||arguments.length!==o+1)){var r=this._state,n=this._velocity,l=r.length-this.dimension,s=this.bounds,d=s[0],c=s[1],p=e-t,u=1e-6<p?1/p:0;this._time.push(e);for(var g=o,m;0<g;--g)m=arguments[g],r.push(a(d[g-1],c[g-1],r[l++]+m)),n.push(m*u)}},s.idle=function(e){var t=this.lastT();if(!(e<t)){var o=this.dimension,r=this._state,n=this._velocity,l=r.length-o,s=this.bounds,d=s[0],c=s[1];this._time.push(e);for(var p=o-1;0<=p;--p)r.push(a(d[p],c[p],r[l]+(e-t)*n[l])),n.push(0),l+=1}}},{"binary-search-bounds":204,"cubic-hermite":92}],204:[function(e,t){"use strict";function a(e,t,a,o,r,i){var n=["function ",e,"(a,l,h,",o.join(","),"){",i?"":"var i=",a?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a",r?".get(m)":"[m]"];return i?0>t.indexOf("c")?n.push(";if(x===y){return m}else if(x<=y){"):n.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):n.push(";if(",t,"){i=m;"),a?n.push("l=m+1}else{h=m-1}"):n.push("h=m-1}else{l=m+1}"),n.push("}"),i?n.push("return -1};"):n.push("return i};"),n.join("")}function o(e,t,o,r){var i=new Function([a("A","x"+e+"y",t,["y"],!1,r),a("B","x"+e+"y",t,["y"],!0,r),a("P","c(x,y)"+e+"0",t,["y","c"],!1,r),a("Q","c(x,y)"+e+"0",t,["y","c"],!0,r),"function dispatchBsearch",o,"(a,y,c,l,h){if(a.shape){if(typeof(c)==='function'){return Q(a,(l===undefined)?0:l|0,(h===undefined)?a.shape[0]-1:h|0,y,c)}else{return B(a,(c===undefined)?0:c|0,(l===undefined)?a.shape[0]-1:l|0,y)}}else{if(typeof(c)==='function'){return P(a,(l===undefined)?0:l|0,(h===undefined)?a.length-1:h|0,y,c)}else{return A(a,(c===undefined)?0:c|0,(l===undefined)?a.length-1:l|0,y)}}}return dispatchBsearch",o].join(""));return i()}t.exports={ge:o(">=",!1,"GE"),gt:o(">",!1,"GT"),lt:o("<",!0,"LT"),le:o("<=",!0,"LE"),eq:o("-",!0,"EQ",!0)}},{}],205:[function(e,t){var a=e("dtype");t.exports=function(e,t,o){if(!e)throw new TypeError("must specify data as first parameter");if(o=0|+(o||0),Array.isArray(e)&&e[0]&&"number"==typeof e[0][0]){var r=e[0].length,n=e.length*r,s,d,c,p;t&&"string"!=typeof t||(t=new(a(t||"float32"))(n+o));var u=t.length-o;if(n!==u)throw new Error("source length "+n+" ("+r+"x"+e.length+") does not match destination length "+u);for(s=0,c=o;s<e.length;s++)for(d=0;d<r;d++)t[c++]=null===e[s][d]?NaN:e[s][d]}else if(!t||"string"==typeof t){var g=a(t||"float32");if(Array.isArray(e)||"array"===t)for(t=new g(e.length+o),s=0,c=o,p=t.length;c<p;c++,s++)t[c]=null===e[s]?NaN:e[s];else 0===o?t=new g(e):(t=new g(e.length+o),t.set(e,o))}else t.set(e,o);return t}},{dtype:115}],206:[function(e,t){'use strict';var a=String.fromCharCode,o=e("css-font/stringify"),r=[32,126];t.exports=function(e){e=e||{};var t=e.shape?e.shape:e.canvas?[e.canvas.width,e.canvas.height]:[512,512],n=e.canvas||document.createElement("canvas"),l=e.font,s="number"==typeof e.step?[e.step,e.step]:e.step||[32,32],d=e.chars||r;if(l&&"string"!=typeof l&&(l=o(l)),!Array.isArray(d))d=(d+"").split("");else if(2===d.length&&"number"==typeof d[0]&&"number"==typeof d[1]){for(var c=[],p=d[0],u=0;p<=d[1];p++)c[u++]=a(p);d=c}t=t.slice(),n.width=t[0],n.height=t[1];var g=n.getContext("2d");g.fillStyle="#000",g.fillRect(0,0,n.width,n.height),g.font=l,g.textAlign="center",g.textBaseline="middle",g.fillStyle="#fff";for(var m=s[0]/2,h=s[1]/2,p=0;p<d.length;p++)g.fillText(d[p],m,h),(m+=s[0])>t[0]-s[0]/2&&(m=s[0]/2,h+=s[1]);return n}},{"css-font/stringify":89}],207:[function(e,t){'use strict';var s=Math.ceil,d=Math.floor;function a(e,t){t||(t={}),("string"==typeof e||Array.isArray(e))&&(t.family=e);var d=Array.isArray(t.family)?t.family.join(", "):t.family;if(!d)throw Error("`family` must be defined");var c=t.size||t.fontSize||t.em||48,p=t.weight||t.fontWeight||"",u=t.style||t.fontStyle||"",e=[u,p,c].join(" ")+"px "+d,g=t.origin||"top";if(a.cache[d]&&c<=a.cache[d].em)return r(a.cache[d],g);var m=t.canvas||a.canvas,h=m.getContext("2d"),y={upper:void 0===t.upper?"H":t.upper,lower:void 0===t.lower?"x":t.lower,descent:void 0===t.descent?"p":t.descent,ascent:void 0===t.ascent?"h":t.ascent,tittle:void 0===t.tittle?"i":t.tittle,overshoot:void 0===t.overshoot?"O":t.overshoot},f=s(1.5*c);m.height=f,m.width=.5*f,h.font=e;var l={top:0};h.clearRect(0,0,f,f),h.textBaseline="top",h.fillStyle="black",h.fillText("H",0,0);var x=i(h.getImageData(0,0,f,f));h.clearRect(0,0,f,f),h.textBaseline="bottom",h.fillText("H",0,f);var _=i(h.getImageData(0,0,f,f));l.lineHeight=l.bottom=f-_+x,h.clearRect(0,0,f,f),h.textBaseline="alphabetic",h.fillText("H",0,f);var b=i(h.getImageData(0,0,f,f)),v=f-b-1+x;l.baseline=l.alphabetic=v,h.clearRect(0,0,f,f),h.textBaseline="middle",h.fillText("H",0,.5*f);var w=i(h.getImageData(0,0,f,f));l.median=l.middle=f-w-1+x-.5*f,h.clearRect(0,0,f,f),h.textBaseline="hanging",h.fillText("H",0,.5*f);var k=i(h.getImageData(0,0,f,f));l.hanging=f-k-1+x-.5*f,h.clearRect(0,0,f,f),h.textBaseline="ideographic",h.fillText("H",0,f);var T=i(h.getImageData(0,0,f,f));if(l.ideographic=f-T-1+x,y.upper&&(h.clearRect(0,0,f,f),h.textBaseline="top",h.fillText(y.upper,0,0),l.upper=i(h.getImageData(0,0,f,f)),l.capHeight=l.baseline-l.upper),y.lower&&(h.clearRect(0,0,f,f),h.textBaseline="top",h.fillText(y.lower,0,0),l.lower=i(h.getImageData(0,0,f,f)),l.xHeight=l.baseline-l.lower),y.tittle&&(h.clearRect(0,0,f,f),h.textBaseline="top",h.fillText(y.tittle,0,0),l.tittle=i(h.getImageData(0,0,f,f))),y.ascent&&(h.clearRect(0,0,f,f),h.textBaseline="top",h.fillText(y.ascent,0,0),l.ascent=i(h.getImageData(0,0,f,f))),y.descent&&(h.clearRect(0,0,f,f),h.textBaseline="top",h.fillText(y.descent,0,0),l.descent=n(h.getImageData(0,0,f,f))),y.overshoot){h.clearRect(0,0,f,f),h.textBaseline="top",h.fillText(y.overshoot,0,0);var A=n(h.getImageData(0,0,f,f));l.overshoot=A-v}for(var S in l)l[S]/=c;return l.em=c,a.cache[d]=l,r(l,g)}function r(e,t){var a={};for(var o in"string"==typeof t&&(t=e[t]),e)"em"!=o&&(a[o]=e[o]-t);return a}function i(e){for(var t=e.height,a=e.data,o=3;o<a.length;o+=4)if(0!==a[o])return d(.25*(o-3)/t)}function n(e){for(var t=e.height,a=e.data,o=a.length-1;0<o;o-=4)if(0!==a[o])return d(.25*(o-3)/t)}t.exports=a,a.canvas=document.createElement("canvas"),a.cache={}},{}],208:[function(e,t){"use strict";function a(e,t,a,o,r,i){this._color=e,this.key=t,this.value=a,this.left=o,this.right=r,this._count=i}function o(e){return new a(e._color,e.key,e.value,e.left,e.right,e._count)}function r(e,t){return new a(e,t.key,t.value,t.left,t.right,t._count)}function l(e){e._count=1+(e.left?e.left._count:0)+(e.right?e.right._count:0)}function c(e,t){this._compare=e,this.root=t}function p(e,t){if(t.left){var a=p(e,t.left);if(a)return a}var a=e(t.key,t.value);return a?a:t.right?p(e,t.right):void 0}function u(e,t,a,o){var r=t(e,o.key);if(0>=r){if(o.left){var i=u(e,t,a,o.left);if(i)return i}var i=a(o.key,o.value);if(i)return i}return o.right?u(e,t,a,o.right):void 0}function g(e,t,a,o,r){var i=a(e,r.key),n=a(t,r.key),l;if(0>=i){if(r.left&&(l=g(e,t,a,o,r.left),l))return l;if(0<n&&(l=o(r.key,r.value),l))return l}return 0<n&&r.right?g(e,t,a,o,r.right):void 0}function m(e,t){this.tree=e,this._stack=t}function h(e,t){e.key=t.key,e.value=t.value,e.left=t.left,e.right=t.right,e._color=t._color,e._count=t._count}function y(e){for(var t=e.length-1,a,d,c,u;0<=t;--t){if(a=e[t],0===t)return void(a._color=1);if(d=e[t-1],d.left===a){if(c=d.right,c.right&&0===c.right._color){if(c=d.right=o(c),u=c.right=o(c.right),d.right=c.left,c.left=d,c.right=u,c._color=d._color,a._color=1,d._color=1,u._color=1,l(d),l(c),1<t){var g=e[t-2];g.left===d?g.left=c:g.right=c}return void(e[t-1]=c)}if(c.left&&0===c.left._color){if(c=d.right=o(c),u=c.left=o(c.left),d.right=u.left,c.left=u.right,u.left=d,u.right=c,u._color=d._color,d._color=1,c._color=1,a._color=1,l(d),l(c),l(u),1<t){var g=e[t-2];g.left===d?g.left=u:g.right=u}return void(e[t-1]=u)}if(1===c._color){if(0===d._color)return d._color=1,void(d.right=r(0,c));d.right=r(0,c);continue}else{if(c=o(c),d.right=c.left,c.left=d,c._color=d._color,d._color=0,l(d),l(c),1<t){var g=e[t-2];g.left===d?g.left=c:g.right=c}e[t-1]=c,e[t]=d,t+1<e.length?e[t+1]=a:e.push(a),t+=2}}else{if(c=d.left,c.left&&0===c.left._color){if(c=d.left=o(c),u=c.left=o(c.left),d.left=c.right,c.right=d,c.left=u,c._color=d._color,a._color=1,d._color=1,u._color=1,l(d),l(c),1<t){var g=e[t-2];g.right===d?g.right=c:g.left=c}return void(e[t-1]=c)}if(c.right&&0===c.right._color){if(c=d.left=o(c),u=c.right=o(c.right),d.left=u.right,c.right=u.left,u.right=d,u.left=c,u._color=d._color,d._color=1,c._color=1,a._color=1,l(d),l(c),l(u),1<t){var g=e[t-2];g.right===d?g.right=u:g.left=u}return void(e[t-1]=u)}if(1===c._color){if(0===d._color)return d._color=1,void(d.left=r(0,c));d.left=r(0,c);continue}else{if(c=o(c),d.left=c.right,c.right=d,c._color=d._color,d._color=0,l(d),l(c),1<t){var g=e[t-2];g.right===d?g.right=c:g.left=c}e[t-1]=c,e[t]=d,t+1<e.length?e[t+1]=a:e.push(a),t+=2}}}}function f(e,t){return e<t?-1:e>t?1:0}t.exports=function(e){return new c(e||f,null)};var x=1,_=c.prototype;Object.defineProperty(_,"keys",{get:function(){var e=[];return this.forEach(function(t){e.push(t)}),e}}),Object.defineProperty(_,"values",{get:function(){var e=[];return this.forEach(function(t,a){e.push(a)}),e}}),Object.defineProperty(_,"length",{get:function(){return this.root?this.root._count:0}}),_.insert=function(e,t){for(var o=this._compare,i=this.root,u=[],g=[],m;i;)m=o(e,i.key),u.push(i),g.push(m),i=0>=m?i.left:i.right;u.push(new a(0,e,t,null,null,1));for(var h=u.length-2,i;0<=h;--h)i=u[h],u[h]=0>=g[h]?new a(i._color,i.key,i.value,u[h+1],i.right,i._count+1):new a(i._color,i.key,i.value,i.left,u[h+1],i._count+1);for(var h=u.length-1;1<h;--h){var f=u[h-1],i=u[h];if(f._color===x||i._color===x)break;var p=u[h-2];if(p.left===f){if(f.left===i){var _=p.right;if(_&&0===_._color)f._color=x,p.right=r(x,_),p._color=0,h-=1;else{if(p._color=0,p.left=f.right,f._color=x,f.right=p,u[h-2]=f,u[h-1]=i,l(p),l(f),3<=h){var b=u[h-3];b.left===p?b.left=f:b.right=f}break}}else{var _=p.right;if(_&&0===_._color)f._color=x,p.right=r(x,_),p._color=0,h-=1;else{if(f.right=i.left,p._color=0,p.left=i.right,i._color=x,i.left=f,i.right=p,u[h-2]=i,u[h-1]=f,l(p),l(f),l(i),3<=h){var b=u[h-3];b.left===p?b.left=i:b.right=i}break}}}else if(f.right===i){var _=p.left;if(_&&0===_._color)f._color=x,p.left=r(x,_),p._color=0,h-=1;else{if(p._color=0,p.right=f.left,f._color=x,f.left=p,u[h-2]=f,u[h-1]=i,l(p),l(f),3<=h){var b=u[h-3];b.right===p?b.right=f:b.left=f}break}}else{var _=p.left;if(_&&0===_._color)f._color=x,p.left=r(x,_),p._color=0,h-=1;else{if(f.left=i.right,p._color=0,p.right=i.left,i._color=x,i.right=f,i.left=p,u[h-2]=i,u[h-1]=f,l(p),l(f),l(i),3<=h){var b=u[h-3];b.right===p?b.right=i:b.left=i}break}}}return u[0]._color=x,new c(o,u[0])},_.forEach=function(e,t,a){if(this.root)switch(arguments.length){case 1:return p(e,this.root);break;case 2:return u(t,this._compare,e,this.root);break;case 3:return 0<=this._compare(t,a)?void 0:g(t,a,this._compare,e,this.root);}},Object.defineProperty(_,"begin",{get:function(){for(var e=[],t=this.root;t;)e.push(t),t=t.left;return new m(this,e)}}),Object.defineProperty(_,"end",{get:function(){for(var e=[],t=this.root;t;)e.push(t),t=t.right;return new m(this,e)}}),_.at=function(e){if(0>e)return new m(this,[]);for(var t=this.root,a=[];;){if(a.push(t),t.left){if(e<t.left._count){t=t.left;continue}e-=t.left._count}if(!e)return new m(this,a);if(e-=1,t.right){if(e>=t.right._count)break;t=t.right}else break}return new m(this,[])},_.ge=function(e){for(var t=this._compare,a=this.root,o=[],r=0,i;a;)i=t(e,a.key),o.push(a),0>=i&&(r=o.length),a=0>=i?a.left:a.right;return o.length=r,new m(this,o)},_.gt=function(e){for(var t=this._compare,a=this.root,o=[],r=0,i;a;)i=t(e,a.key),o.push(a),0>i&&(r=o.length),a=0>i?a.left:a.right;return o.length=r,new m(this,o)},_.lt=function(e){for(var t=this._compare,a=this.root,o=[],r=0,i;a;)i=t(e,a.key),o.push(a),0<i&&(r=o.length),a=0>=i?a.left:a.right;return o.length=r,new m(this,o)},_.le=function(e){for(var t=this._compare,a=this.root,o=[],r=0,i;a;)i=t(e,a.key),o.push(a),0<=i&&(r=o.length),a=0>i?a.left:a.right;return o.length=r,new m(this,o)},_.find=function(e){for(var t=this._compare,a=this.root,o=[],r;a;){if(r=t(e,a.key),o.push(a),0===r)return new m(this,o);a=0>=r?a.left:a.right}return new m(this,[])},_.remove=function(e){var t=this.find(e);return t?t.remove():this},_.get=function(e){for(var t=this._compare,a=this.root;a;){var o=t(e,a.key);if(0===o)return a.value;a=0>=o?a.left:a.right}};var b=m.prototype;Object.defineProperty(b,"valid",{get:function(){return 0<this._stack.length}}),Object.defineProperty(b,"node",{get:function(){return 0<this._stack.length?this._stack[this._stack.length-1]:null},enumerable:!0}),b.clone=function(){return new m(this.tree,this._stack.slice())},b.remove=function(){var e=this._stack;if(0===e.length)return this.tree;var t=Array(e.length),o=e[e.length-1];t[t.length-1]=new a(o._color,o.key,o.value,o.left,o.right,o._count);for(var r=e.length-2,o;0<=r;--r)o=e[r],t[r]=o.left===e[r+1]?new a(o._color,o.key,o.value,t[r+1],o.right,o._count):new a(o._color,o.key,o.value,o.left,t[r+1],o._count);if(o=t[t.length-1],o.left&&o.right){var l=t.length;for(o=o.left;o.right;)t.push(o),o=o.right;var s=t[l-1];t.push(new a(o._color,s.key,s.value,o.left,o.right,o._count)),t[l-1].key=o.key,t[l-1].value=o.value;for(var r=t.length-2;r>=l;--r)o=t[r],t[r]=new a(o._color,o.key,o.value,o.left,t[r+1],o._count);t[l-1].left=t[l]}if(o=t[t.length-1],0===o._color){var d=t[t.length-2];d.left===o?d.left=null:d.right===o&&(d.right=null),t.pop();for(var r=0;r<t.length;++r)t[r]._count--;return new c(this.tree._compare,t[0])}if(o.left||o.right){o.left?h(o,o.left):o.right&&h(o,o.right),o._color=x;for(var r=0;r<t.length-1;++r)t[r]._count--;return new c(this.tree._compare,t[0])}if(1===t.length)return new c(this.tree._compare,null);for(var r=0;r<t.length;++r)t[r]._count--;var p=t[t.length-2];return y(t),p.left===o?p.left=null:p.right=null,new c(this.tree._compare,t[0])},Object.defineProperty(b,"key",{get:function(){return 0<this._stack.length?this._stack[this._stack.length-1].key:void 0},enumerable:!0}),Object.defineProperty(b,"value",{get:function(){return 0<this._stack.length?this._stack[this._stack.length-1].value:void 0},enumerable:!0}),Object.defineProperty(b,"index",{get:function(){var e=0,t=this._stack;if(0===t.length){var a=this.tree.root;return a?a._count:0}t[t.length-1].left&&(e=t[t.length-1].left._count);for(var o=t.length-2;0<=o;--o)t[o+1]===t[o].right&&(++e,t[o].left&&(e+=t[o].left._count));return e},enumerable:!0}),b.next=function(){var e=this._stack;if(0!==e.length){var t=e[e.length-1];if(t.right)for(t=t.right;t;)e.push(t),t=t.left;else for(e.pop();0<e.length&&e[e.length-1].right===t;)t=e[e.length-1],e.pop()}},Object.defineProperty(b,"hasNext",{get:function(){var e=this._stack;if(0===e.length)return!1;if(e[e.length-1].right)return!0;for(var t=e.length-1;0<t;--t)if(e[t-1].left===e[t])return!0;return!1}}),b.update=function(e){var t=this._stack;if(0===t.length)throw new Error("Can't update empty node!");var o=Array(t.length),r=t[t.length-1];o[o.length-1]=new a(r._color,r.key,e,r.left,r.right,r._count);for(var l=t.length-2;0<=l;--l)r=t[l],o[l]=r.left===t[l+1]?new a(r._color,r.key,r.value,o[l+1],r.right,r._count):new a(r._color,r.key,r.value,r.left,o[l+1],r._count);return new c(this.tree._compare,o[0])},b.prev=function(){var e=this._stack;if(0!==e.length){var t=e[e.length-1];if(t.left)for(t=t.left;t;)e.push(t),t=t.right;else for(e.pop();0<e.length&&e[e.length-1].left===t;)t=e[e.length-1],e.pop()}},Object.defineProperty(b,"hasPrev",{get:function(){var e=this._stack;if(0===e.length)return!1;if(e[e.length-1].left)return!0;for(var t=e.length-1;0<t;--t)if(e[t-1].right===e[t])return!0;return!1}})},{}],209:[function(e,t){var o=Math.exp,r=Math.log,n=Math.sqrt,l=Math.PI,s=Math.sin,d=Math.pow;function a(e){if(0>e)return+"0/0";for(var a=u[0],o=u.length-1;0<o;--o)a+=u[o]/(e+o);var n=e+p+.5;return .5*r(2*l)+(e+.5)*r(n)-n+r(a)-r(e)}var c=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7],p=607/128,u=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];t.exports=function e(r){if(.5>r)return l/(s(l*r)*e(1-r));if(100<r)return o(a(r));r-=1;for(var p=c[0],u=1;9>u;u++)p+=c[u]/(r+u);var g=r+7+.5;return n(2*l)*d(g,r+.5)*o(-g)*p},t.exports.log=a},{}],210:[function(e,t){t.exports=function(e,t){if("string"!=typeof e)throw new TypeError("must specify type string");if(t=t||{},"undefined"==typeof document&&!t.canvas)return null;var a=t.canvas||document.createElement("canvas");"number"==typeof t.width&&(a.width=t.width),"number"==typeof t.height&&(a.height=t.height);var o=t,r;try{var n=[e];0===e.indexOf("webgl")&&n.push("experimental-"+e);for(var l=0;l<n.length;l++)if(r=a.getContext(n[l],o),r)return r}catch(t){r=null}return r||null}},{}],211:[function(e,t){t.exports=function(e,t,a,o,r,i,n,l){var s={x:0,y:0},d,c,p,u,g,m,h,y,f,x,_,b,v;return(d=o-t,p=e-a,g=a*t-e*o,f=d*r+p*i+g,x=d*n+p*l+g,0!==f&&0!==x&&0<=f==4<=x)?null:(c=l-i,u=r-n,m=n*i-r*l,h=c*e+u*t+m,y=c*a+u*o+m,0!==h&&0!==y&&0<=h==0<=y)?null:(_=d*u-c*p,0===_)?null:(b=0>_?-_/2:_/2,b=0,v=p*m-u*g,s.x=(0>v?v-b:v+b)/_,v=c*g-d*m,s.y=(0>v?v-b:v+b)/_,s)}},{}],212:[function(e,t){'use strict';var l=Math.max;function a(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function o(e){this.gl=e,this.pixelRatio=1,this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.autoTicks=!0,this.tickSpacing=[1,1,1],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickAlign=["auto","auto","auto"],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[10,10,10],this.lastCubeProps={cubeEdges:[0,0,0],axis:[0,0,0]},this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont="sans-serif",this.labelSize=[20,20,20],this.labelAngle=[0,0,0],this.labelAlign=["auto","auto","auto"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[10,10,10],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[0,0,0],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!1,!1,!1],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._firstInit=!0,this._text=null,this._lines=null,this._background=c(e)}function r(){this.primalOffset=[0,0,0],this.primalMinor=[0,0,0],this.mirrorOffset=[0,0,0],this.mirrorMinor=[0,0,0]}function n(t,o,r,i,n){for(var l=t.primalOffset,s=t.primalMinor,p=t.mirrorOffset,u=t.mirrorMinor,g=i[o],e=0;3>e;++e)if(o!==e){var m=l,h=p,y=s,f=u;g&1<<e&&(m=p,h=l,y=u,f=s),m[e]=r[0][e],h[e]=r[1][e],0<n[e]?(y[e]=-1,f[e]=0):(y[e]=0,f[e]=1)}}t.exports=function(e,t){var a=new o(e);return a.update(t),a};var s=e("./lib/text.js"),d=e("./lib/lines.js"),c=e("./lib/background.js"),p=e("./lib/cube.js"),u=e("./lib/ticks.js"),g=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),m=o.prototype;m.update=function(e){function t(t,a,o){if(o in e){var r=e[o],n=this[o],l;this[o]=(t?Array.isArray(r)&&Array.isArray(r[0]):Array.isArray(r))?l=[a(r[0]),a(r[1]),a(r[2])]:l=[a(r),a(r),a(r)];for(var s=0;3>s;++s)if(l[s]!==n[s])return!0}return!1}e=e||{};var a=t.bind(this,!1,Number),o=t.bind(this,!1,Boolean),r=t.bind(this,!1,String),n=t.bind(this,!0,function(e){if(Array.isArray(e)){if(3===e.length)return[+e[0],+e[1],+e[2],1];if(4===e.length)return[+e[0],+e[1],+e[2],+e[3]]}return[0,0,0,1]}),l=!1,c=!1,p;if("bounds"in e){var g=e.bounds;i_loop:for(var m=0;2>m;++m)for(var h=0;3>h;++h)g[m][h]!==this.bounds[m][h]&&(c=!0),this.bounds[m][h]=g[m][h]}if("ticks"in e){p=e.ticks,l=!0,this.autoTicks=!1;for(var m=0;3>m;++m)this.tickSpacing[m]=0}else a("tickSpacing")&&(this.autoTicks=!0,c=!0);if(this._firstInit&&(!("ticks"in e||"tickSpacing"in e)&&(this.autoTicks=!0),c=!0,l=!0,this._firstInit=!1),c&&this.autoTicks&&(p=u.create(this.bounds,this.tickSpacing),l=!0),l){for(var m=0;3>m;++m)p[m].sort(function(e,t){return e.x-t.x});u.equal(p,this.ticks)?l=!1:this.ticks=p}o("tickEnable"),r("tickFont")&&(l=!0),a("tickSize"),a("tickAngle"),a("tickPad"),n("tickColor");var y=r("labels");r("labelFont")&&(y=!0),o("labelEnable"),a("labelSize"),a("labelPad"),n("labelColor"),o("lineEnable"),o("lineMirror"),a("lineWidth"),n("lineColor"),o("lineTickEnable"),o("lineTickMirror"),a("lineTickLength"),a("lineTickWidth"),n("lineTickColor"),o("gridEnable"),a("gridWidth"),n("gridColor"),o("zeroEnable"),n("zeroLineColor"),a("zeroLineWidth"),o("backgroundEnable"),n("backgroundColor"),this._text?this._text&&(y||l)&&this._text.update(this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont):this._text=s(this.gl,this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont),this._lines&&l&&(this._lines.dispose(),this._lines=null),this._lines||(this._lines=d(this.gl,this.bounds,this.ticks))};var h=[new r,new r,new r],y=[0,0,0],f={model:g,view:g,projection:g,_ortho:!1};m.isOpaque=function(){return!0},m.isTransparent=function(){return!1},m.drawTransparent=function(){};var x=[0,0,0],_=[0,0,0],b=[0,0,0];m.draw=function(e){function t(e){W=[0,0,0],W[e]=1}function o(e,a,o){var r=(e+1)%3,i=(e+2)%3,n=a[r],l=a[i],s=o[r],d=o[i];return 0<n&&0<d?void t(r):0<n&&0>d?void t(r):0>n&&0<d?void t(r):0>n&&0>d?void t(r):0<l&&0<s?void t(i):0<l&&0>s?void t(i):0>l&&0<s?void t(i):0>l&&0>s?void t(i):void 0}e=e||f;for(var r=this.gl,s=e.model||g,d=e.view||g,c=e.projection||g,m=this.bounds,w=e._ortho||!1,k=p(s,d,c,m,w),T=k.cubeEdges,A=k.axis,S=d[12],C=d[13],L=d[14],E=d[15],I=w?2:1,P=I*this.pixelRatio*(c[3]*S+c[7]*C+c[11]*L+c[15]*E)/r.drawingBufferHeight,z=0;3>z;++z)this.lastCubeProps.cubeEdges[z]=T[z],this.lastCubeProps.axis[z]=A[z];for(var D=h,z=0;3>z;++z)n(h[z],z,this.bounds,T,A);for(var r=this.gl,O=y,z=0;3>z;++z)O[z]=this.backgroundEnable[z]?A[z]:0;this._background.draw(s,d,c,m,O,this.backgroundColor),this._lines.bind(s,d,c,this);for(var z=0,R;3>z;++z){R=[0,0,0],R[z]=0<A[z]?m[1][z]:m[0][z];for(var M=0;2>M;++M){var B=(z+1+M)%3,F=(z+1+(1^M))%3;this.gridEnable[B]&&this._lines.drawGrid(B,F,this.bounds,R,this.gridColor[B],this.gridWidth[B]*this.pixelRatio)}for(var M=0;2>M;++M){var B=(z+1+M)%3,F=(z+1+(1^M))%3;this.zeroEnable[F]&&0>=Math.min(m[0][F],m[1][F])&&0<=l(m[0][F],m[1][F])&&this._lines.drawZero(B,F,this.bounds,R,this.zeroLineColor[F],this.zeroLineWidth[F]*this.pixelRatio)}}for(var z=0;3>z;++z){this.lineEnable[z]&&this._lines.drawAxisLine(z,this.bounds,D[z].primalOffset,this.lineColor[z],this.lineWidth[z]*this.pixelRatio),this.lineMirror[z]&&this._lines.drawAxisLine(z,this.bounds,D[z].mirrorOffset,this.lineColor[z],this.lineWidth[z]*this.pixelRatio);for(var N=a(x,D[z].primalMinor),V=a(_,D[z].mirrorMinor),U=this.lineTickLength,M=0,H;3>M;++M)H=P/s[5*M],N[M]*=U[M]*H,V[M]*=U[M]*H;this.lineTickEnable[z]&&this._lines.drawAxisTicks(z,D[z].primalOffset,N,this.lineTickColor[z],this.lineTickWidth[z]*this.pixelRatio),this.lineTickMirror[z]&&this._lines.drawAxisTicks(z,D[z].mirrorOffset,V,this.lineTickColor[z],this.lineTickWidth[z]*this.pixelRatio)}this._lines.unbind(),this._text.bind(s,d,c,this.pixelRatio);for(var q=.5,z=0,G,Y,W;3>z;++z){for(var X=D[z].primalMinor,Z=D[z].mirrorMinor,K=a(b,D[z].primalOffset),M=0;3>M;++M)this.lineTickEnable[z]&&(K[M]+=P*X[M]*l(this.lineTickLength[M],0)/s[5*M]);var $=[0,0,0];if($[z]=1,this.tickEnable[z]){-3600===this.tickAngle[z]?(this.tickAngle[z]=0,this.tickAlign[z]="auto"):this.tickAlign[z]=-1,Y=1,G=[this.tickAlign[z],q,Y],G[0]="auto"===G[0]?0:parseInt(""+G[0]),W=[0,0,0],o(z,X,Z);for(var M=0;3>M;++M)K[M]+=P*X[M]*this.tickPad[M]/s[5*M];this._text.drawTicks(z,this.tickSize[z],this.tickAngle[z],K,this.tickColor[z],$,W,G)}if(this.labelEnable[z]){Y=0,W=[0,0,0],4<this.labels[z].length&&(t(z),Y=1),G=[this.labelAlign[z],q,Y],G[0]="auto"===G[0]?0:parseInt(""+G[0]);for(var M=0;3>M;++M)K[M]+=P*X[M]*this.labelPad[M]/s[5*M];K[z]+=.5*(m[0][z]+m[1][z]),this._text.drawLabel(z,this.labelSize[z],this.labelAngle[z],K,this.labelColor[z],[0,0,0],W,G)}}this._text.unbind()},m.dispose=function(){this._text.dispose(),this._lines.dispose(),this._background.dispose(),this._lines=null,this._text=null,this._background=null,this.gl=null}},{"./lib/background.js":213,"./lib/cube.js":214,"./lib/lines.js":215,"./lib/text.js":217,"./lib/ticks.js":218}],213:[function(e,t){'use strict';function a(e,t,a,o){this.gl=e,this.buffer=t,this.vao=a,this.shader=o}t.exports=function(e){for(var t=[],l=[],p=0,g=0;3>g;++g)for(var m=(g+1)%3,h=(g+2)%3,y=[0,0,0],f=[0,0,0],c=-1;1>=c;c+=2){l.push(p,p+2,p+1,p+1,p+2,p+3),y[g]=c,f[g]=c;for(var x=-1;1>=x;x+=2){y[m]=x;for(var _=-1;1>=_;_+=2)y[h]=_,t.push(y[0],y[1],y[2],f[0],f[1],f[2]),p+=1}var b=m;m=h,h=b}var w=o(e,new Float32Array(t)),k=o(e,new Uint16Array(l),e.ELEMENT_ARRAY_BUFFER),T=r(e,[{buffer:w,type:e.FLOAT,size:3,offset:0,stride:24},{buffer:w,type:e.FLOAT,size:3,offset:12,stride:24}],k),A=n(e);return A.attributes.position.location=0,A.attributes.normal.location=1,new a(e,w,T,A)};var o=e("gl-buffer"),r=e("gl-vao"),n=e("./shaders").bg,l=a.prototype;l.draw=function(e,t,a,o,r,n){for(var l=!1,s=0;3>s;++s)l=l||r[s];if(l){var d=this.gl;d.enable(d.POLYGON_OFFSET_FILL),d.polygonOffset(1,2),this.shader.bind(),this.shader.uniforms={model:e,view:t,projection:a,bounds:o,enable:r,colors:n},this.vao.bind(),this.vao.draw(this.gl.TRIANGLES,36),this.vao.unbind(),d.disable(d.POLYGON_OFFSET_FILL)}},l.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders":216,"gl-buffer":220,"gl-vao":297}],214:[function(e,t){"use strict";function a(e,t,a){for(var o=0;4>o;++o){e[o]=a[12+o];for(var r=0;3>r;++r)e[o]+=t[r]*a[4*r+o]}}function r(e){for(var t=0;t<l.length;++t)if(e=u.positive(e,l[t]),3>e.length)return 0;for(var a=e[0],o=a[0]/a[3],r=a[1]/a[3],n=0,t=1;t+1<e.length;++t){var s=e[t],d=e[t+1],c=s[0]/s[3],g=s[1]/s[3],m=d[0]/d[3],h=d[1]/d[3];n+=Math.abs((c-o)*(h-r)-(g-r)*(m-o))}return n}t.exports=function(e,t,b,T,A){c(m,t,e),c(m,b,m);for(var S=0,C=0;2>C;++C){f[2]=T[C][2];for(var L=0;2>L;++L){f[1]=T[L][1];for(var E=0;2>E;++E)f[0]=T[E][0],a(h[S],f,m),S+=1}}for(var I=-1,C=0,P;8>C;++C){P=h[C][3];for(var z=0;3>z;++z)y[C][z]=h[C][z]/P;A&&(y[C][2]*=-1),0>P&&(0>I?I=C:y[C][2]<y[I][2]&&(I=C))}if(0>I){I=0;for(var D=0;3>D;++D){for(var O=(D+2)%3,u=(D+1)%3,R=-1,M=-1,B=0;2>B;++B){var F=B<<D,N=F+(B<<O)+(1-B<<u),V=F+(1-B<<O)+(B<<u);0>g(y[F],y[N],y[V],o)||(B?R=1:M=1)}if(0>R||0>M){M>R&&(I|=1<<D);continue}for(var B=0;2>B;++B){var F=B<<D,N=F+(B<<O)+(1-B<<u),V=F+(1-B<<O)+(B<<u),U=r([h[F],h[N],h[V],h[F+(1<<O)+(1<<u)]]);B?R=U:M=U}if(M>R){I|=1<<D;continue}}}for(var H=7^I,q=-1,C=0;8>C;++C)C!==I&&C!==H&&(0>q?q=C:y[q][1]>y[C][1]&&(q=C));for(var G=-1,C=0,Y;3>C;++C)if(Y=q^1<<C,Y!==I&&Y!==H){0>G&&(G=Y);var u=y[Y];u[0]<y[G][0]&&(G=Y)}for(var W=-1,C=0,Y;3>C;++C)if(Y=q^1<<C,Y!==I&&Y!==H&&Y!==G){0>W&&(W=Y);var u=y[Y];u[0]>y[W][0]&&(W=Y)}var X=p;X[0]=X[1]=X[2]=0,X[n.log2(G^q)]=q&G,X[n.log2(q^W)]=q&W;var Z=7^W;Z===I||Z===H?(Z=7^G,X[n.log2(W^Z)]=Z&W):X[n.log2(G^Z)]=Z&G;for(var K=I,D=0;3>D;++D)x[D]=K&1<<D?-1:1;return _};var n=e("bit-twiddle"),c=e("gl-mat4/multiply"),u=e("split-polygon"),g=e("robust-orientation"),m=Array(16),h=Array(8),y=Array(8),f=[,,,],o=[0,0,0];(function(){for(var e=0;8>e;++e)h[e]=[1,1,1,1],y[e]=[1,1,1]})();var l=[[0,0,1,0,0],[0,0,-1,1,0],[0,-1,0,1,0],[0,1,0,1,0],[-1,0,0,1,0],[1,0,0,1,0]],p=[1,1,1],x=[0,0,0],_={cubeEdges:p,axis:x}},{"bit-twiddle":43,"gl-mat4/multiply":244,"robust-orientation":1277,"split-polygon":1299}],215:[function(e,t){'use strict';function a(e){return e[0]=e[1]=e[2]=0,e}function o(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function r(e,t,a,o,r,i,n,l){this.gl=e,this.vertBuffer=t,this.vao=a,this.shader=o,this.tickCount=r,this.tickOffset=i,this.gridCount=n,this.gridOffset=l}t.exports=function(e,t,a){var o=[],d=[0,0,0],c=[0,0,0],p=[0,0,0],u=[0,0,0];o.push(0,0,1,0,1,1,0,0,-1,0,0,-1,0,1,1,0,1,-1);for(var g=0,m;3>g;++g){m=0|o.length/3;for(var h=0,y;h<a[g].length;++h)y=+a[g][h].x,o.push(y,0,1,y,1,1,y,0,-1,y,0,-1,y,1,1,y,1,-1);var f=0|o.length/3;d[g]=m,c[g]=f-m;for(var m=0|o.length/3,_=0,y;_<a[g].length;++_)y=+a[g][_].x,o.push(y,0,1,y,1,1,y,0,-1,y,0,-1,y,1,1,y,1,-1);var f=0|o.length/3;p[g]=m,u[g]=f-m}var b=n(e,new Float32Array(o)),v=l(e,[{buffer:b,type:e.FLOAT,size:3,stride:0,offset:0}]),w=s(e);return w.attributes.position.location=0,new r(e,b,v,w,c,d,u,p)};var n=e("gl-buffer"),l=e("gl-vao"),s=e("./shaders").line,d=[0,0,0],c=[0,0,0],p=[0,0,0],u=[0,0,0],g=[1,1],m=r.prototype;m.bind=function(e,t,a){this.shader.bind(),this.shader.uniforms.model=e,this.shader.uniforms.view=t,this.shader.uniforms.projection=a,g[0]=this.gl.drawingBufferWidth,g[1]=this.gl.drawingBufferHeight,this.shader.uniforms.screenShape=g,this.vao.bind()},m.unbind=function(){this.vao.unbind()},m.drawAxisLine=function(e,t,r,i,n){var l=a(c);this.shader.uniforms.majorAxis=c,l[e]=t[1][e]-t[0][e],this.shader.uniforms.minorAxis=l;var s=o(u,r);s[e]+=t[0][e],this.shader.uniforms.offset=s,this.shader.uniforms.lineWidth=n,this.shader.uniforms.color=i;var d=a(p);d[(e+2)%3]=1,this.shader.uniforms.screenAxis=d,this.vao.draw(this.gl.TRIANGLES,6);var d=a(p);d[(e+1)%3]=1,this.shader.uniforms.screenAxis=d,this.vao.draw(this.gl.TRIANGLES,6)},m.drawAxisTicks=function(e,t,o,r,i){if(this.tickCount[e]){var n=a(d);n[e]=1,this.shader.uniforms.majorAxis=n,this.shader.uniforms.offset=t,this.shader.uniforms.minorAxis=o,this.shader.uniforms.color=r,this.shader.uniforms.lineWidth=i;var l=a(p);l[e]=1,this.shader.uniforms.screenAxis=l,this.vao.draw(this.gl.TRIANGLES,this.tickCount[e],this.tickOffset[e])}},m.drawGrid=function(e,t,r,i,n,l){if(this.gridCount[e]){var s=a(c);s[t]=r[1][t]-r[0][t],this.shader.uniforms.minorAxis=s;var g=o(u,i);g[t]+=r[0][t],this.shader.uniforms.offset=g;var m=a(d);m[e]=1,this.shader.uniforms.majorAxis=m;var h=a(p);h[e]=1,this.shader.uniforms.screenAxis=h,this.shader.uniforms.lineWidth=l,this.shader.uniforms.color=n,this.vao.draw(this.gl.TRIANGLES,this.gridCount[e],this.gridOffset[e])}},m.drawZero=function(e,t,r,i,n,l){var s=a(c);this.shader.uniforms.majorAxis=s,s[e]=r[1][e]-r[0][e],this.shader.uniforms.minorAxis=s;var d=o(u,i);d[e]+=r[0][e],this.shader.uniforms.offset=d;var g=a(p);g[t]=1,this.shader.uniforms.screenAxis=g,this.shader.uniforms.lineWidth=l,this.shader.uniforms.color=n,this.vao.draw(this.gl.TRIANGLES,6)},m.dispose=function(){this.vao.dispose(),this.vertBuffer.dispose(),this.shader.dispose()}},{"./shaders":216,"gl-buffer":220,"gl-vao":297}],216:[function(e,t,a){'use strict';var o=e("glslify"),r=e("gl-shader"),i=o(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\nuniform vec3 offset, majorAxis, minorAxis, screenAxis;\nuniform float lineWidth;\nuniform vec2 screenShape;\n\nvec3 project(vec3 p) {\n  vec4 pp = projection * view * model * vec4(p, 1.0);\n  return pp.xyz / max(pp.w, 0.0001);\n}\n\nvoid main() {\n  vec3 major = position.x * majorAxis;\n  vec3 minor = position.y * minorAxis;\n\n  vec3 vPosition = major + minor + offset;\n  vec3 pPosition = project(vPosition);\n  vec3 offset = project(vPosition + screenAxis * position.z);\n\n  vec2 screen = normalize((offset - pPosition).xy * screenShape) / screenShape;\n\n  gl_Position = vec4(pPosition + vec3(0.5 * screen * lineWidth, 0), 1.0);\n}\n"]),n=o(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}"]);a.line=function(e){return r(e,i,n,null,[{name:"position",type:"vec3"}])};var l=o(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\nuniform vec3 offset, axis, alignDir, alignOpt;\nuniform float scale, angle, pixelScale;\nuniform vec2 resolution;\n\nvec3 project(vec3 p) {\n  vec4 pp = projection * view * model * vec4(p, 1.0);\n  return pp.xyz / max(pp.w, 0.0001);\n}\n\nfloat computeViewAngle(vec3 a, vec3 b) {\n  vec3 A = project(a);\n  vec3 B = project(b);\n\n  return atan(\n    (B.y - A.y) * resolution.y,\n    (B.x - A.x) * resolution.x\n  );\n}\n\nconst float PI = 3.141592;\nconst float TWO_PI = 2.0 * PI;\nconst float HALF_PI = 0.5 * PI;\nconst float ONE_AND_HALF_PI = 1.5 * PI;\n\nint option = int(floor(alignOpt.x + 0.001));\nfloat hv_ratio =       alignOpt.y;\nbool enableAlign =    (alignOpt.z != 0.0);\n\nfloat mod_angle(float a) {\n  return mod(a, PI);\n}\n\nfloat positive_angle(float a) {\n  return mod_angle((a < 0.0) ?\n    a + TWO_PI :\n    a\n  );\n}\n\nfloat look_upwards(float a) {\n  float b = positive_angle(a);\n  return ((b > HALF_PI) && (b <= ONE_AND_HALF_PI)) ?\n    b - PI :\n    b;\n}\n\nfloat look_horizontal_or_vertical(float a, float ratio) {\n  // ratio controls the ratio between being horizontal to (vertical + horizontal)\n  // if ratio is set to 0.5 then it is 50%, 50%.\n  // when using a higher ratio e.g. 0.75 the result would\n  // likely be more horizontal than vertical.\n\n  float b = positive_angle(a);\n\n  return\n    (b < (      ratio) * HALF_PI) ? 0.0 :\n    (b < (2.0 - ratio) * HALF_PI) ? -HALF_PI :\n    (b < (2.0 + ratio) * HALF_PI) ? 0.0 :\n    (b < (4.0 - ratio) * HALF_PI) ? HALF_PI :\n                                    0.0;\n}\n\nfloat roundTo(float a, float b) {\n  return float(b * floor((a + 0.5 * b) / b));\n}\n\nfloat look_round_n_directions(float a, int n) {\n  float b = positive_angle(a);\n  float div = TWO_PI / float(n);\n  float c = roundTo(b, div);\n  return look_upwards(c);\n}\n\nfloat applyAlignOption(float rawAngle, float delta) {\n  return\n    (option >  2) ? look_round_n_directions(rawAngle + delta, option) :       // option 3-n: round to n directions\n    (option == 2) ? look_horizontal_or_vertical(rawAngle + delta, hv_ratio) : // horizontal or vertical\n    (option == 1) ? rawAngle + delta :       // use free angle, and flip to align with one direction of the axis\n    (option == 0) ? look_upwards(rawAngle) : // use free angle, and stay upwards\n    (option ==-1) ? 0.0 :                    // useful for backward compatibility, all texts remains horizontal\n                    rawAngle;                // otherwise return back raw input angle\n}\n\nbool isAxisTitle = (axis.x == 0.0) &&\n                   (axis.y == 0.0) &&\n                   (axis.z == 0.0);\n\nvoid main() {\n  //Compute world offset\n  float axisDistance = position.z;\n  vec3 dataPosition = axisDistance * axis + offset;\n\n  float beta = angle; // i.e. user defined attributes for each tick\n\n  float axisAngle;\n  float clipAngle;\n  float flip;\n\n  if (enableAlign) {\n    axisAngle = (isAxisTitle) ? HALF_PI :\n                      computeViewAngle(dataPosition, dataPosition + axis);\n    clipAngle = computeViewAngle(dataPosition, dataPosition + alignDir);\n\n    axisAngle += (sin(axisAngle) < 0.0) ? PI : 0.0;\n    clipAngle += (sin(clipAngle) < 0.0) ? PI : 0.0;\n\n    flip = (dot(vec2(cos(axisAngle), sin(axisAngle)),\n                vec2(sin(clipAngle),-cos(clipAngle))) > 0.0) ? 1.0 : 0.0;\n\n    beta += applyAlignOption(clipAngle, flip * PI);\n  }\n\n  //Compute plane offset\n  vec2 planeCoord = position.xy * pixelScale;\n\n  mat2 planeXform = scale * mat2(\n     cos(beta), sin(beta),\n    -sin(beta), cos(beta)\n  );\n\n  vec2 viewOffset = 2.0 * planeXform * planeCoord / resolution;\n\n  //Compute clip position\n  vec3 clipPosition = project(dataPosition);\n\n  //Apply text offset in clip coordinates\n  clipPosition += vec3(viewOffset, 0.0);\n\n  //Done\n  gl_Position = vec4(clipPosition, 1.0);\n}"]),s=o(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}"]);a.text=function(e){return r(e,l,s,null,[{name:"position",type:"vec3"}])};var d=o(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec3 normal;\n\nuniform mat4 model, view, projection;\nuniform vec3 enable;\nuniform vec3 bounds[2];\n\nvarying vec3 colorChannel;\n\nvoid main() {\n\n  vec3 signAxis = sign(bounds[1] - bounds[0]);\n\n  vec3 realNormal = signAxis * normal;\n\n  if(dot(realNormal, enable) > 0.0) {\n    vec3 minRange = min(bounds[0], bounds[1]);\n    vec3 maxRange = max(bounds[0], bounds[1]);\n    vec3 nPosition = mix(minRange, maxRange, 0.5 * (position + 1.0));\n    gl_Position = projection * view * model * vec4(nPosition, 1.0);\n  } else {\n    gl_Position = vec4(0,0,0,0);\n  }\n\n  colorChannel = abs(realNormal);\n}"]),c=o(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 colors[3];\n\nvarying vec3 colorChannel;\n\nvoid main() {\n  gl_FragColor = colorChannel.x * colors[0] +\n                 colorChannel.y * colors[1] +\n                 colorChannel.z * colors[2];\n}"]);a.bg=function(e){return r(e,d,c,null,[{name:"position",type:"vec3"},{name:"normal",type:"vec3"}])}},{"gl-shader":277,glslify:378}],217:[function(e,t){(function(a){"use strict";function o(e,t,a,o){this.gl=e,this.shader=t,this.buffer=a,this.vao=o,this.tickOffset=this.tickCount=this.labelOffset=this.labelCount=null}function r(t,a){try{return l(t,a)}catch(a){return console.warn("error vectorizing text:\""+t+"\" error:",a),{cells:[],positions:[]}}}t.exports=function(e,t,a,r,l,d){var c=i(e),p=n(e,[{buffer:c,size:3}]),u=s(e);u.attributes.position.location=0;var g=new o(e,u,c,p);return g.update(t,a,r,l,d),g};var i=e("gl-buffer"),n=e("gl-vao"),l=e("vectorize-text"),s=e("./shaders").text,d=window||a.global||{},u=d.__TEXT_CACHE||{};d.__TEXT_CACHE={};var g=o.prototype,m=[0,0];g.bind=function(e,t,a,o){this.vao.bind(),this.shader.bind();var r=this.shader.uniforms;r.model=e,r.view=t,r.projection=a,r.pixelScale=o,m[0]=this.gl.drawingBufferWidth,m[1]=this.gl.drawingBufferHeight,this.shader.uniforms.resolution=m},g.unbind=function(){this.vao.unbind()},g.update=function(e,t,a,o,n){function l(e,t,a,o,n,l){var d=u[a];d||(d=u[a]={});var g=d[t];g||(g=d[t]=r(t,{triangles:!0,font:a,textAlign:"center",textBaseline:"middle",lineSpacing:n,styletags:l}));for(var m=(o||12)/12,h=g.positions,y=g.cells,f=0,x=y.length,_;f<x;++f){_=y[f];for(var b=2,v;0<=b;--b)v=h[_[b]],s.push(m*v[0],-m*v[1],e)}}for(var s=[],c=[0,0,0],p=[0,0,0],g=[0,0,0],m=[0,0,0],h=1.25,y={breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},f=0;3>f;++f){g[f]=0|s.length/3,l(.5*(e[0][f]+e[1][f]),t[f],a[f],12,h,y),m[f]=(0|s.length/3)-g[f],c[f]=0|s.length/3;for(var x=0;x<o[f].length;++x)o[f][x].text&&l(o[f][x].x,o[f][x].text,o[f][x].font||n,o[f][x].fontSize||12,h,y);p[f]=(0|s.length/3)-c[f]}this.buffer.update(s),this.tickOffset=c,this.tickCount=p,this.labelOffset=g,this.labelCount=m},g.drawTicks=function(e,t,a,o,r,i,n,l){this.tickCount[e]&&(this.shader.uniforms.axis=i,this.shader.uniforms.color=r,this.shader.uniforms.angle=a,this.shader.uniforms.scale=t,this.shader.uniforms.offset=o,this.shader.uniforms.alignDir=n,this.shader.uniforms.alignOpt=l,this.vao.draw(this.gl.TRIANGLES,this.tickCount[e],this.tickOffset[e]))},g.drawLabel=function(e,t,a,o,r,i,n,l){this.labelCount[e]&&(this.shader.uniforms.axis=i,this.shader.uniforms.color=r,this.shader.uniforms.angle=a,this.shader.uniforms.scale=t,this.shader.uniforms.offset=o,this.shader.uniforms.alignDir=n,this.shader.uniforms.alignOpt=l,this.vao.draw(this.gl.TRIANGLES,this.labelCount[e],this.labelOffset[e]))},g.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()}}).call(this,e("_process"))},{"./shaders":216,_process:1425,"gl-buffer":220,"gl-vao":297,"vectorize-text":1335}],218:[function(e,t,a){'use strict';var r=Math.ceil,n=Math.round,l=Math.pow,s=Math.floor;function o(e,t){var a=e+"",o=a.indexOf("."),i=0;0<=o&&(i=a.length-o-1);var d=l(10,i),c=n(e*t*d),p=c+"";if(0<=p.indexOf("e"))return p;var u=c/d,g=c%d;0>c?(u=0|-r(u),g=0|-g):(u=0|s(u),g|=0);var m=""+u;if(0>c&&(m="-"+m),i){for(var h=""+g;h.length<i;)h="0"+h;return m+"."+h}return m}a.create=function(e,a){for(var r=[],i=0;3>i;++i){for(var n=[],l=.5*(e[0][i]+e[1][i]),s=0;s*a[i]<=e[1][i];++s)n.push({x:s*a[i],text:o(a[i],s)});for(var s=-1;s*a[i]>=e[0][i];--s)n.push({x:s*a[i],text:o(a[i],s)});r.push(n)}return r},a.equal=function(e,t){for(var o=0;3>o;++o){if(e[o].length!==t[o].length)return!1;for(var r=0;r<e[o].length;++r){var n=e[o][r],a=t[o][r];if(n.x!==a.x||n.text!==a.text||n.font!==a.font||n.fontColor!==a.fontColor||n.fontSize!==a.fontSize||n.dx!==a.dx||n.dy!==a.dy)return!1}}return!0}},{}],219:[function(e,t){"use strict";var r=Math.min,i=Math.abs,n=Math.max;function a(e,t,a){this.lo=e,this.hi=t,this.pixelsPerDataUnit=a}function o(e,t,a,o,r){for(var n=0;3>n;++n){for(var l=f,s=x,d=0;3>d;++d)s[d]=l[d]=a[d];s[3]=l[3]=1,s[n]+=1,m(s,s,t),0>s[3]&&(e[n]=1/0),l[n]-=1,m(l,l,t),0>l[3]&&(e[n]=1/0);var c=(l[0]/l[3]-s[0]/s[3])*o,p=(l[1]/l[3]-s[1]/s[3])*r;e[n]=.25*Math.sqrt(c*c+p*p)}return e}t.exports=function(e,t,a,m,f){var w=t.model||h,T=t.view||h,A=t.projection||h,S=t._ortho||!1,C=e.bounds,f=f||c(w,T,A,C,S),L=f.axis;p(y,T,w),p(y,A,y);for(var E=_,I=0;3>I;++I)E[I].lo=1/0,E[I].hi=-Infinity,E[I].pixelsPerDataUnit=1/0;var P=l(g(y,y));g(y,y);for(var z=0;3>z;++z){var D=(z+1)%3,u=(z+2)%3,O=b;i_loop:for(var I=0,x;2>I;++I)if(x=[],0>L[z]!=!!I){O[z]=C[I][z];for(var R=0;2>R;++R){O[D]=C[R^I][D];for(var M=0;2>M;++M)O[u]=C[M^R^I][u],x.push(O.slice())}for(var B=S?5:4,R=B;R===B;++R){if(0===x.length)continue i_loop;x=s.positive(x,P[R])}for(var R=0;R<x.length;++R)for(var u=x[R],F=o(b,y,u,a,m),M=0;3>M;++M)E[M].lo=r(E[M].lo,u[M]),E[M].hi=n(E[M].hi,u[M]),M!==z&&(E[M].pixelsPerDataUnit=r(E[M].pixelsPerDataUnit,i(F[M])))}}return E};var l=e("extract-frustum-planes"),s=e("split-polygon"),c=e("./lib/cube.js"),p=e("gl-mat4/multiply"),g=e("gl-mat4/transpose"),m=e("gl-vec4/transformMat4"),h=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),y=new Float32Array(16),f=[0,0,0,1],x=[0,0,0,1],_=[new a(1/0,-Infinity,1/0),new a(1/0,-Infinity,1/0),new a(1/0,-Infinity,1/0)],b=[0,0,0]},{"./lib/cube.js":214,"extract-frustum-planes":200,"gl-mat4/multiply":244,"gl-mat4/transpose":253,"gl-vec4/transformMat4":368,"split-polygon":1299}],220:[function(e,t){"use strict";function a(e,t,a,o,r){this.gl=e,this.type=t,this.handle=a,this.length=o,this.usage=r}function o(e,t,a,o,r,i){var n=r.length*r.BYTES_PER_ELEMENT;if(0>i)return e.bufferData(t,r,o),n;if(n+i>a)throw new Error("gl-buffer: If resizing buffer, must not specify offset");return e.bufferSubData(t,i,r),a}function r(e,t){for(var a=l.malloc(e.length,t),o=e.length,r=0;r<o;++r)a[r]=e[r];return a}function i(e,t){for(var a=1,o=t.length-1;0<=o;--o){if(t[o]!==a)return!1;a*=e[o]}return!0}var l=e("typedarray-pool"),s=e("ndarray-ops"),d=e("ndarray"),c=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"],p=a.prototype;p.bind=function(){this.gl.bindBuffer(this.type,this.handle)},p.unbind=function(){this.gl.bindBuffer(this.type,null)},p.dispose=function(){this.gl.deleteBuffer(this.handle)},p.update=function(e,a){if("number"!=typeof a&&(a=-1),this.bind(),"object"==typeof e&&"undefined"!=typeof e.shape){var n=e.dtype;if(0>c.indexOf(n)&&(n="float32"),this.type===this.gl.ELEMENT_ARRAY_BUFFER){var p=gl.getExtension("OES_element_index_uint");n=p&&"uint16"!==n?"uint32":"uint16"}if(n===e.dtype&&i(e.shape,e.stride))this.length=0===e.offset&&e.data.length===e.shape[0]?o(this.gl,this.type,this.length,this.usage,e.data,a):o(this.gl,this.type,this.length,this.usage,e.data.subarray(e.offset,e.shape[0]),a);else{var u=l.malloc(e.size,n),g=d(u,e.shape);s.assign(g,e),this.length=0>a?o(this.gl,this.type,this.length,this.usage,u,a):o(this.gl,this.type,this.length,this.usage,u.subarray(0,e.size),a),l.free(u)}}else if(Array.isArray(e)){var m;m=this.type===this.gl.ELEMENT_ARRAY_BUFFER?r(e,"uint16"):r(e,"float32"),this.length=0>a?o(this.gl,this.type,this.length,this.usage,m,a):o(this.gl,this.type,this.length,this.usage,m.subarray(0,e.length),a),l.free(m)}else if("object"==typeof e&&"number"==typeof e.length)this.length=o(this.gl,this.type,this.length,this.usage,e,a);else if("number"==typeof e||void 0===e){if(0<=a)throw new Error("gl-buffer: Cannot specify offset when resizing buffer");e|=0,0>=e&&(e=1),this.gl.bufferData(this.type,0|e,this.usage),this.length=e}else throw new Error("gl-buffer: Invalid data type")},t.exports=function(e,t,o,r){if(o=o||e.ARRAY_BUFFER,r=r||e.DYNAMIC_DRAW,o!==e.ARRAY_BUFFER&&o!==e.ELEMENT_ARRAY_BUFFER)throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER");if(r!==e.DYNAMIC_DRAW&&r!==e.STATIC_DRAW&&r!==e.STREAM_DRAW)throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW");var i=e.createBuffer(),n=new a(e,o,i,0,r);return n.update(t),n}},{ndarray:425,"ndarray-ops":419,"typedarray-pool":1328}],221:[function(e,t){"use strict";var a=Math.min,o=Math.max,r=e("gl-vec3");t.exports=function(e,t){var n=e.positions,l=e.vectors,s={positions:[],vertexIntensity:[],vertexIntensityBounds:e.vertexIntensityBounds,vectors:[],cells:[],coneOffset:e.coneOffset,colormap:e.colormap};if(0===e.positions.length)return t&&(t[0]=[0,0,0],t[1]=[0,0,0]),s;for(var c=0,g=1/0,h=-Infinity,f=1/0,_=-Infinity,b=1/0,v=-Infinity,w=null,T=null,A=[],S=1/0,C=!1,L=0,E;L<n.length;L++){E=n[L],g=a(E[0],g),h=o(E[0],h),f=a(E[1],f),_=o(E[1],_),b=a(E[2],b),v=o(E[2],v);var I=l[L];if(r.length(I)>c&&(c=r.length(I)),L){var u=2*r.distance(w,E)/(r.length(T)+r.length(I));u?(S=a(S,u),C=!1):C=!0}C||(w=E,T=I),A.push(I)}var P=[g,f,b],D=[h,_,v];t&&(t[0]=P,t[1]=D),0===c&&(c=1);var O=1/c;isFinite(S)||(S=1),s.vectorScale=S;var R=e.coneSize||.5;e.absoluteConeSize&&(R=e.absoluteConeSize*O),s.coneScale=R;for(var L=0,M=0;L<n.length;L++)for(var E=n[L],B=E[0],x=E[1],y=E[2],z=A[L],d=r.length(z)*O,F=0;F<8;F++){s.positions.push([B,x,y,M++]),s.positions.push([B,x,y,M++]),s.positions.push([B,x,y,M++]),s.positions.push([B,x,y,M++]),s.positions.push([B,x,y,M++]),s.positions.push([B,x,y,M++]),s.vectors.push(z),s.vectors.push(z),s.vectors.push(z),s.vectors.push(z),s.vectors.push(z),s.vectors.push(z),s.vertexIntensity.push(d,d,d),s.vertexIntensity.push(d,d,d);var N=s.positions.length;s.cells.push([N-6,N-5,N-4],[N-3,N-2,N-1])}return s};var i=e("./lib/shaders");t.exports.createMesh=e("./create_mesh"),t.exports.createConeMesh=function(e,a){return t.exports.createMesh(e,a,{shaders:i,traceType:"cone"})}},{"./create_mesh":222,"./lib/shaders":223,"gl-vec3":316}],222:[function(e,t){'use strict';var l=Math.min,s=Math.max,d=Math.floor;function a(e,t,a,o,r,i,n,l,s,d,c){this.gl=e,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=t,this.dirty=!0,this.triShader=a,this.pickShader=o,this.trianglePositions=r,this.triangleVectors=i,this.triangleColors=l,this.triangleUVs=s,this.triangleIds=n,this.triangleVAO=d,this.triangleCount=0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]],this.clipBounds=[[-Infinity,-Infinity,-Infinity],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.traceType=c,this.tubeScale=1,this.coneScale=2,this.vectorScale=1,this.coneOffset=.25,this._model=x,this._view=x,this._projection=x,this._resolution=[1,1]}function o(e){for(var t=f({colormap:e,nshades:256,format:"rgba"}),a=new Uint8Array(1024),o=0,r;256>o;++o){r=t[o];for(var n=0;3>n;++n)a[4*o+n]=r[n];a[4*o+3]=255*r[3]}return y(a,[256,256,4],[4,0,1])}function r(e){for(var t=e.length,a=Array(t),o=0;o<t;++o)a[o]=e[o][2];return a}function i(e,t){var a=c(e,t.meshShader.vertex,t.meshShader.fragment,null,t.meshShader.attributes);return a.attributes.position.location=0,a.attributes.color.location=2,a.attributes.uv.location=3,a.attributes.vector.location=4,a}function n(e,t){var a=c(e,t.pickShader.vertex,t.pickShader.fragment,null,t.pickShader.attributes);return a.attributes.position.location=0,a.attributes.id.location=1,a.attributes.vector.location=4,a}var c=e("gl-shader"),p=e("gl-buffer"),u=e("gl-vao"),g=e("gl-texture2d"),m=e("gl-mat4/multiply"),h=e("gl-mat4/invert"),y=e("ndarray"),f=e("colormap"),x=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],_=a.prototype;_.isOpaque=function(){return 1<=this.opacity},_.isTransparent=function(){return 1>this.opacity},_.pickSlots=1,_.setPickBase=function(e){this.pickId=e},_.update=function(e){e=e||{};var t=this.gl;this.dirty=!0,"lightPosition"in e&&(this.lightPosition=e.lightPosition),"opacity"in e&&(this.opacity=e.opacity),"ambient"in e&&(this.ambientLight=e.ambient),"diffuse"in e&&(this.diffuseLight=e.diffuse),"specular"in e&&(this.specularLight=e.specular),"roughness"in e&&(this.roughness=e.roughness),"fresnel"in e&&(this.fresnel=e.fresnel),e.tubeScale!==void 0&&(this.tubeScale=e.tubeScale),e.vectorScale!==void 0&&(this.vectorScale=e.vectorScale),e.coneScale!==void 0&&(this.coneScale=e.coneScale),e.coneOffset!==void 0&&(this.coneOffset=e.coneOffset),e.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=t.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=t.LINEAR,this.texture.setPixels(o(e.colormap)),this.texture.generateMipmap());var a=e.cells,n=e.positions,d=e.vectors;if(n&&a&&d){var u=[],g=[],m=[],h=[],y=[];this.cells=a,this.positions=n,this.vectors=d;var x=e.meshColor||[1,1,1,1],_=e.vertexIntensity,b=1/0,T=-Infinity;if(!_)for(var A=0,S;A<n.length;++A)S=n[A][2],b=l(b,S),T=s(T,S);else if(e.vertexIntensityBounds)b=+e.vertexIntensityBounds[0],T=+e.vertexIntensityBounds[1];else for(var A=0,S;A<_.length;++A)S=_[A],b=l(b,S),T=s(T,S);this.intensity=_?_:r(n),this.bounds=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]];for(var A=0,C;A<n.length;++A){C=n[A];for(var L=0;3>L;++L)!isNaN(C[L])&&isFinite(C[L])&&(this.bounds[0][L]=l(this.bounds[0][L],C[L]),this.bounds[1][L]=s(this.bounds[1][L],C[L]))}var E=0;fill_loop:for(var A=0,I;A<a.length;++A)switch(I=a[A],I.length){case 3:for(var L=0;3>L;++L)for(var P=I[L],C=n[P],z=0;3>z;++z)if(isNaN(C[z])||!isFinite(C[z]))continue fill_loop;for(var L=0;3>L;++L){var P=I[2-L],C=n[P];u.push(C[0],C[1],C[2],C[3]);var D=d[P];g.push(D[0],D[1],D[2],D[3]||0);var w=x;3===w.length?m.push(w[0],w[1],w[2],1):m.push(w[0],w[1],w[2],w[3]);var c;c=_?[(_[P]-b)/(T-b),0]:[(C[2]-b)/(T-b),0],h.push(c[0],c[1]),y.push(A)}E+=1;break;default:}this.triangleCount=E,this.trianglePositions.update(u),this.triangleVectors.update(g),this.triangleColors.update(m),this.triangleUVs.update(h),this.triangleIds.update(new Uint32Array(y))}},_.drawTransparent=_.draw=function(e){e=e||{};for(var t=this.gl,a=e.model||x,o=e.view||x,r=e.projection||x,n=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],d=0;3>d;++d)n[0][d]=s(n[0][d],this.clipBounds[0][d]),n[1][d]=l(n[1][d],this.clipBounds[1][d]);var c={model:a,view:o,projection:r,inverseModel:x.slice(),clipBounds:n,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,texture:0};c.inverseModel=h(c.inverseModel,c.model),t.disable(t.CULL_FACE),this.texture.bind(0);var p=Array(16);m(p,c.view,c.model),m(p,c.projection,p),h(p,p);for(var d=0;3>d;++d)c.eyePosition[d]=p[12+d]/p[15];for(var u=p[15],d=0;3>d;++d)u+=this.lightPosition[d]*p[4*d+3];for(var d=0,g;3>d;++d){g=p[12+d];for(var y=0;3>y;++y)g+=p[4*y+d]*this.lightPosition[y];c.lightPosition[d]=g/u}if(0<this.triangleCount){var f=this.triShader;f.bind(),f.uniforms=c,this.triangleVAO.bind(),t.drawArrays(t.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()}},_.drawPick=function(e){e=e||{};for(var t=this.gl,a=e.model||x,o=e.view||x,r=e.projection||x,n=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],d=0;3>d;++d)n[0][d]=s(n[0][d],this.clipBounds[0][d]),n[1][d]=l(n[1][d],this.clipBounds[1][d]);this._model=[].slice.call(a),this._view=[].slice.call(o),this._projection=[].slice.call(r),this._resolution=[t.drawingBufferWidth,t.drawingBufferHeight];var c={model:a,view:o,projection:r,clipBounds:n,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,pickId:this.pickId/255},p=this.pickShader;p.bind(),p.uniforms=c,0<this.triangleCount&&(this.triangleVAO.bind(),t.drawArrays(t.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind())},_.pick=function(e){if(!e)return null;if(e.id!==this.pickId)return null;var t=e.value[0]+256*e.value[1]+65536*e.value[2],a=this.cells[t],o=this.positions[a[1]].slice(0,3),r={position:o,dataCoordinate:o,index:d(a[1]/48)};return"cone"===this.traceType?r.index=d(a[1]/48):"streamtube"===this.traceType&&(r.intensity=this.intensity[a[1]],r.velocity=this.vectors[a[1]].slice(0,3),r.divergence=this.vectors[a[1]][3],r.index=t),r},_.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.pickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleVectors.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleIds.dispose()},t.exports=function(e,t,o){var r=o.shaders;1===arguments.length&&(t=e,e=t.gl);var l=i(e,r),s=n(e,r),d=g(e,y(new Uint8Array([255,255,255,255]),[1,1,4]));d.generateMipmap(),d.minFilter=e.LINEAR_MIPMAP_LINEAR,d.magFilter=e.LINEAR;var c=p(e),m=p(e),h=p(e),f=p(e),x=p(e),_=u(e,[{buffer:c,type:e.FLOAT,size:4},{buffer:x,type:e.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:h,type:e.FLOAT,size:4},{buffer:f,type:e.FLOAT,size:2},{buffer:m,type:e.FLOAT,size:4}]),b=new a(e,d,l,s,c,m,x,h,f,_,o.traceType||"cone");return b.update(t),b}},{colormap:73,"gl-buffer":220,"gl-mat4/invert":242,"gl-mat4/multiply":244,"gl-shader":277,"gl-texture2d":292,"gl-vao":297,ndarray:425}],223:[function(e,t,a){var o=e("glslify"),r=o(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the cone vertex and normal at the given index.\n//\n// The returned vertex is for a cone with its top at origin and height of 1.0,\n// pointing in the direction of the vector attribute.\n//\n// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.\n// These vertices are used to make up the triangles of the cone by the following:\n//   segment + 0 top vertex\n//   segment + 1 perimeter vertex a+1\n//   segment + 2 perimeter vertex a\n//   segment + 3 center base vertex\n//   segment + 4 perimeter vertex a\n//   segment + 5 perimeter vertex a+1\n// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.\n// To go from index to segment, floor(index / 6)\n// To go from segment to angle, 2*pi * (segment/segmentCount)\n// To go from index to segment index, index - (segment*6)\n//\nvec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {\n\n  const float segmentCount = 8.0;\n\n  float index = rawIndex - floor(rawIndex /\n    (segmentCount * 6.0)) *\n    (segmentCount * 6.0);\n\n  float segment = floor(0.001 + index/6.0);\n  float segmentIndex = index - (segment*6.0);\n\n  normal = -normalize(d);\n\n  if (segmentIndex > 2.99 && segmentIndex < 3.01) {\n    return mix(vec3(0.0), -d, coneOffset);\n  }\n\n  float nextAngle = (\n    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||\n    (segmentIndex > 4.99 &&  segmentIndex < 5.01)\n  ) ? 1.0 : 0.0;\n  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);\n\n  vec3 v1 = mix(d, vec3(0.0), coneOffset);\n  vec3 v2 = v1 - d;\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d)*0.25;\n  vec3 y = v * sin(angle) * length(d)*0.25;\n  vec3 v3 = v2 + x + y;\n  if (segmentIndex < 3.0) {\n    vec3 tx = u * sin(angle);\n    vec3 ty = v * -cos(angle);\n    vec3 tangent = tx + ty;\n    normal = normalize(cross(v3 - v1, tangent));\n  }\n\n  if (segmentIndex == 0.0) {\n    return mix(d, vec3(0.0), coneOffset);\n  }\n  return v3;\n}\n\nattribute vec3 vector;\nattribute vec4 color, position;\nattribute vec2 uv;\n\nuniform float vectorScale, coneScale, coneOffset;\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 eyePosition, lightPosition;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  // Scale the vector magnitude to stay constant with\n  // model & view changes.\n  vec3 normal;\n  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal);\n  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * conePosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);\n\n  // vec4 m_position  = model * vec4(conePosition, 1.0);\n  vec4 t_position  = view * conePosition;\n  gl_Position      = projection * t_position;\n\n  f_color          = color;\n  f_data           = conePosition.xyz;\n  f_position       = position.xyz;\n  f_uv             = uv;\n}\n"]),i=o(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = f_color * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}\n"]),n=o(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the cone vertex and normal at the given index.\n//\n// The returned vertex is for a cone with its top at origin and height of 1.0,\n// pointing in the direction of the vector attribute.\n//\n// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.\n// These vertices are used to make up the triangles of the cone by the following:\n//   segment + 0 top vertex\n//   segment + 1 perimeter vertex a+1\n//   segment + 2 perimeter vertex a\n//   segment + 3 center base vertex\n//   segment + 4 perimeter vertex a\n//   segment + 5 perimeter vertex a+1\n// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.\n// To go from index to segment, floor(index / 6)\n// To go from segment to angle, 2*pi * (segment/segmentCount)\n// To go from index to segment index, index - (segment*6)\n//\nvec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {\n\n  const float segmentCount = 8.0;\n\n  float index = rawIndex - floor(rawIndex /\n    (segmentCount * 6.0)) *\n    (segmentCount * 6.0);\n\n  float segment = floor(0.001 + index/6.0);\n  float segmentIndex = index - (segment*6.0);\n\n  normal = -normalize(d);\n\n  if (segmentIndex > 2.99 && segmentIndex < 3.01) {\n    return mix(vec3(0.0), -d, coneOffset);\n  }\n\n  float nextAngle = (\n    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||\n    (segmentIndex > 4.99 &&  segmentIndex < 5.01)\n  ) ? 1.0 : 0.0;\n  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);\n\n  vec3 v1 = mix(d, vec3(0.0), coneOffset);\n  vec3 v2 = v1 - d;\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d)*0.25;\n  vec3 y = v * sin(angle) * length(d)*0.25;\n  vec3 v3 = v2 + x + y;\n  if (segmentIndex < 3.0) {\n    vec3 tx = u * sin(angle);\n    vec3 ty = v * -cos(angle);\n    vec3 tangent = tx + ty;\n    normal = normalize(cross(v3 - v1, tangent));\n  }\n\n  if (segmentIndex == 0.0) {\n    return mix(d, vec3(0.0), coneOffset);\n  }\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform float vectorScale, coneScale, coneOffset;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  vec3 normal;\n  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector.xyz), position.w, coneOffset, normal);\n  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n  gl_Position = projection * view * conePosition;\n  f_id        = id;\n  f_position  = position.xyz;\n}\n"]),l=o(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]);a.meshShader={vertex:r,fragment:i,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec3"}]},a.pickShader={vertex:n,fragment:l,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec3"}]}},{glslify:378}],224:[function(e,t){t.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},{}],225:[function(e,t){var a=e("./1.0/numbers");t.exports=function(e){return a[e]}},{"./1.0/numbers":224}],226:[function(e,t){'use strict';var n=Math.min,l=Math.max;function a(e,t,a,o){this.gl=e,this.shader=o,this.buffer=t,this.vao=a,this.pixelRatio=1,this.bounds=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]],this.clipBounds=[[-Infinity,-Infinity,-Infinity],[1/0,1/0,1/0]],this.lineWidth=[1,1,1],this.capSize=[10,10,10],this.lineCount=[0,0,0],this.lineOffset=[0,0,0],this.opacity=1,this.hasAlpha=!1}function o(e,t){for(var a=0;3>a;++a)e[0][a]=n(e[0][a],t[a]),e[1][a]=l(e[1][a],t[a])}function r(e,t,a,r){for(var n=g[r],l=0,s;l<n.length;++l)s=n[l],e.push(t[0],t[1],t[2],a[0],a[1],a[2],a[3],s[0],s[1],s[2]);return n.length}t.exports=function(e){var t=e.gl,o=s(t),r=d(t,[{buffer:o,type:t.FLOAT,size:3,offset:0,stride:40},{buffer:o,type:t.FLOAT,size:4,offset:12,stride:40},{buffer:o,type:t.FLOAT,size:3,offset:28,stride:40}]),i=c(t);i.attributes.position.location=0,i.attributes.color.location=1,i.attributes.offset.location=2;var n=new a(t,o,r,i);return n.update(e),n};var s=e("gl-buffer"),d=e("gl-vao"),c=e("./shaders/index"),p=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],u=a.prototype;u.isOpaque=function(){return!this.hasAlpha},u.isTransparent=function(){return this.hasAlpha},u.drawTransparent=u.draw=function(e){var t=this.gl,a=this.shader.uniforms;this.shader.bind();var o=a.view=e.view||p,r=a.projection=e.projection||p;a.model=e.model||p,a.clipBounds=this.clipBounds,a.opacity=this.opacity;var n=o[12],l=o[13],s=o[14],d=o[15],c=e._ortho||!1,u=c?2:1,g=u*this.pixelRatio*(r[3]*n+r[7]*l+r[11]*s+r[15]*d)/t.drawingBufferHeight;this.vao.bind();for(var m=0;3>m;++m)t.lineWidth(this.lineWidth[m]*this.pixelRatio),a.capSize=this.capSize[m]*g,this.lineCount[m]&&t.drawArrays(t.LINES,this.lineOffset[m],this.lineCount[m]);this.vao.unbind()};var g=function(){for(var e=[,,,],t=0,a;3>t;++t){a=[];for(var o=1;2>=o;++o)for(var r=-1;1>=r;r+=2){var i=(o+t)%3,n=[0,0,0];n[i]=r,a.push(n)}e[t]=a}return e}();u.update=function(t){t=t||{},"lineWidth"in t&&(this.lineWidth=t.lineWidth,!Array.isArray(this.lineWidth)&&(this.lineWidth=[this.lineWidth,this.lineWidth,this.lineWidth])),"capSize"in t&&(this.capSize=t.capSize,!Array.isArray(this.capSize)&&(this.capSize=[this.capSize,this.capSize,this.capSize])),this.hasAlpha=!1,"opacity"in t&&(this.opacity=+t.opacity,1>this.opacity&&(this.hasAlpha=!0));var a=t.color||[[0,0,0],[0,0,0],[0,0,0]],l=t.position,s=t.error;if(Array.isArray(a[0])||(a=[a,a,a]),l&&s){var d=[],u=l.length,n=0;this.bounds=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]],this.lineCount=[0,0,0];for(var g=0;3>g;++g){this.lineOffset[g]=n;i_loop:for(var m=0,h;m<u;++m){h=l[m];for(var y=0;3>y;++y)if(isNaN(h[y])||!isFinite(h[y]))continue i_loop;var f=s[m],e=a[g];if(Array.isArray(e[0])&&(e=a[m]),3===e.length?e=[e[0],e[1],e[2],1]:4===e.length&&(e=[e[0],e[1],e[2],e[3]],!this.hasAlpha&&1>e[3]&&(this.hasAlpha=!0)),!(isNaN(f[0][g])||isNaN(f[1][g]))){if(0>f[0][g]){var _=h.slice();_[g]+=f[0][g],d.push(h[0],h[1],h[2],e[0],e[1],e[2],e[3],0,0,0,_[0],_[1],_[2],e[0],e[1],e[2],e[3],0,0,0),o(this.bounds,_),n+=2+r(d,_,e,g)}if(0<f[1][g]){var _=h.slice();_[g]+=f[1][g],d.push(h[0],h[1],h[2],e[0],e[1],e[2],e[3],0,0,0,_[0],_[1],_[2],e[0],e[1],e[2],e[3],0,0,0),o(this.bounds,_),n+=2+r(d,_,e,g)}}}this.lineCount[g]=n-this.lineOffset[g]}this.buffer.update(d)}},u.dispose=function(){this.shader.dispose(),this.buffer.dispose(),this.vao.dispose()}},{"./shaders/index":227,"gl-buffer":220,"gl-vao":297}],227:[function(e,t){'use strict';var a=e("glslify"),o=e("gl-shader"),r=a(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, offset;\nattribute vec4 color;\nuniform mat4 model, view, projection;\nuniform float capSize;\nvarying vec4 fragColor;\nvarying vec3 fragPosition;\n\nvoid main() {\n  vec4 worldPosition  = model * vec4(position, 1.0);\n  worldPosition       = (worldPosition / worldPosition.w) + vec4(capSize * offset, 0.0);\n  gl_Position         = projection * view * worldPosition;\n  fragColor           = color;\n  fragPosition        = position;\n}"]),i=a(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float opacity;\nvarying vec3 fragPosition;\nvarying vec4 fragColor;\n\nvoid main() {\n  if (\n    outOfRange(clipBounds[0], clipBounds[1], fragPosition) ||\n    fragColor.a * opacity == 0.\n  ) discard;\n\n  gl_FragColor = opacity * fragColor;\n}"]);t.exports=function(e){return o(e,r,i,null,[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"offset",type:"vec3"}])}},{"gl-shader":277,glslify:378}],228:[function(e,t){'use strict';var g=Math.max;function a(e){var t=e.getParameter(e.FRAMEBUFFER_BINDING),a=e.getParameter(e.RENDERBUFFER_BINDING),o=e.getParameter(e.TEXTURE_BINDING_2D);return[t,a,o]}function o(e,t){e.bindFramebuffer(e.FRAMEBUFFER,t[0]),e.bindRenderbuffer(e.RENDERBUFFER,t[1]),e.bindTexture(e.TEXTURE_2D,t[2])}function r(e,t){var a=e.getParameter(t.MAX_COLOR_ATTACHMENTS_WEBGL);h=Array(a+1);for(var o=0,r;o<=a;++o){r=Array(a);for(var n=0;n<o;++n)r[n]=e.COLOR_ATTACHMENT0+n;for(var n=o;n<a;++n)r[n]=e.NONE;h[o]=r}}function n(e){switch(e){case f:throw new Error("gl-fbo: Framebuffer unsupported");case x:throw new Error("gl-fbo: Framebuffer incomplete attachment");case _:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case b:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason");}}function l(e,t,a,o,r,i){if(!o)return null;var n=m(e,t,a,r,o);return n.magFilter=e.NEAREST,n.minFilter=e.NEAREST,n.mipSamples=1,n.bind(),e.framebufferTexture2D(e.FRAMEBUFFER,i,e.TEXTURE_2D,n.handle,0),n}function s(e,t,a,o,r){var i=e.createRenderbuffer();return e.bindRenderbuffer(e.RENDERBUFFER,i),e.renderbufferStorage(e.RENDERBUFFER,o,t,a),e.framebufferRenderbuffer(e.FRAMEBUFFER,r,e.RENDERBUFFER,i),i}function d(e){var t=a(e.gl),r=e.gl,d=e.handle=r.createFramebuffer(),c=e._shape[0],p=e._shape[1],u=e.color.length,g=e._ext,m=e._useStencil,y=e._useDepth,f=e._colorType;r.bindFramebuffer(r.FRAMEBUFFER,d);for(var x=0;x<u;++x)e.color[x]=l(r,c,p,f,r.RGBA,r.COLOR_ATTACHMENT0+x);0===u?(e._color_rb=s(r,c,p,r.RGBA4,r.COLOR_ATTACHMENT0),g&&g.drawBuffersWEBGL(h[0])):1<u&&g.drawBuffersWEBGL(h[u]);var _=r.getExtension("WEBGL_depth_texture");_?m?e.depth=l(r,c,p,_.UNSIGNED_INT_24_8_WEBGL,r.DEPTH_STENCIL,r.DEPTH_STENCIL_ATTACHMENT):y&&(e.depth=l(r,c,p,r.UNSIGNED_SHORT,r.DEPTH_COMPONENT,r.DEPTH_ATTACHMENT)):y&&m?e._depth_rb=s(r,c,p,r.DEPTH_STENCIL,r.DEPTH_STENCIL_ATTACHMENT):y?e._depth_rb=s(r,c,p,r.DEPTH_COMPONENT16,r.DEPTH_ATTACHMENT):m&&(e._depth_rb=s(r,c,p,r.STENCIL_INDEX,r.STENCIL_ATTACHMENT));var b=r.checkFramebufferStatus(r.FRAMEBUFFER);if(b!==r.FRAMEBUFFER_COMPLETE){e._destroyed=!0,r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteFramebuffer(e.handle),e.handle=null,e.depth&&(e.depth.dispose(),e.depth=null),e._depth_rb&&(r.deleteRenderbuffer(e._depth_rb),e._depth_rb=null);for(var x=0;x<e.color.length;++x)e.color[x].dispose(),e.color[x]=null;e._color_rb&&(r.deleteRenderbuffer(e._color_rb),e._color_rb=null),o(r,t),n(b)}o(r,t)}function c(e,t,a,o,r,n,l,s){this.gl=e,this._shape=[0|t,0|a],this._destroyed=!1,this._ext=s,this.color=Array(r);for(var c=0;c<r;++c)this.color[c]=null;this._color_rb=null,this.depth=null,this._depth_rb=null,this._colorType=o,this._useDepth=n,this._useStencil=l;var p=this,u=[0|t,0|a];Object.defineProperties(u,{0:{get:function(){return p._shape[0]},set:function(e){return p.width=e}},1:{get:function(){return p._shape[1]},set:function(e){return p.height=e}}}),this._shapeVector=u,d(this)}function p(e,t,r){if(e._destroyed)throw new Error("gl-fbo: Can't resize destroyed FBO");if(e._shape[0]!==t||e._shape[1]!==r){var l=e.gl,s=l.getParameter(l.MAX_RENDERBUFFER_SIZE);if(0>t||t>s||0>r||r>s)throw new Error("gl-fbo: Can't resize FBO, invalid dimensions");e._shape[0]=t,e._shape[1]=r;for(var d=a(l),c=0;c<e.color.length;++c)e.color[c].shape=e._shape;e._color_rb&&(l.bindRenderbuffer(l.RENDERBUFFER,e._color_rb),l.renderbufferStorage(l.RENDERBUFFER,l.RGBA4,e._shape[0],e._shape[1])),e.depth&&(e.depth.shape=e._shape),e._depth_rb&&(l.bindRenderbuffer(l.RENDERBUFFER,e._depth_rb),e._useDepth&&e._useStencil?l.renderbufferStorage(l.RENDERBUFFER,l.DEPTH_STENCIL,e._shape[0],e._shape[1]):e._useDepth?l.renderbufferStorage(l.RENDERBUFFER,l.DEPTH_COMPONENT16,e._shape[0],e._shape[1]):e._useStencil&&l.renderbufferStorage(l.RENDERBUFFER,l.STENCIL_INDEX,e._shape[0],e._shape[1])),l.bindFramebuffer(l.FRAMEBUFFER,e.handle);var p=l.checkFramebufferStatus(l.FRAMEBUFFER);p!==l.FRAMEBUFFER_COMPLETE&&(e.dispose(),o(l,d),n(p)),o(l,d)}}function u(e,t,a,o){f||(f=e.FRAMEBUFFER_UNSUPPORTED,x=e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT,_=e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS,b=e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT);var i=e.getExtension("WEBGL_draw_buffers");if(!h&&i&&r(e,i),Array.isArray(t)&&(o=a,a=0|t[1],t=0|t[0]),"number"!=typeof t)throw new Error("gl-fbo: Missing shape parameter");var n=e.getParameter(e.MAX_RENDERBUFFER_SIZE);if(0>t||t>n||0>a||a>n)throw new Error("gl-fbo: Parameters are too large for FBO");o=o||{};var l=1;if("color"in o){if(l=g(0|o.color,0),0>l)throw new Error("gl-fbo: Must specify a nonnegative number of colors");if(1<l)if(!i)throw new Error("gl-fbo: Multiple draw buffer extension not supported");else if(l>e.getParameter(i.MAX_COLOR_ATTACHMENTS_WEBGL))throw new Error("gl-fbo: Context does not support "+l+" draw buffers")}var s=e.UNSIGNED_BYTE,d=e.getExtension("OES_texture_float");if(o.float&&0<l){if(!d)throw new Error("gl-fbo: Context does not support floating point textures");s=e.FLOAT}else o.preferFloat&&0<l&&d&&(s=e.FLOAT);var p=!0;"depth"in o&&(p=!!o.depth);var u=!1;return"stencil"in o&&(u=!!o.stencil),new c(e,t,a,s,l,p,u,i)}var m=e("gl-texture2d");t.exports=u;var h=null,y=c.prototype,f,x,_,b;Object.defineProperties(y,{shape:{get:function(){return this._destroyed?[0,0]:this._shapeVector},set:function(e){if(Array.isArray(e)||(e=[0|e,0|e]),2!==e.length)throw new Error("gl-fbo: Shape vector must be length 2");var t=0|e[0],a=0|e[1];return p(this,t,a),[t,a]},enumerable:!1},width:{get:function(){return this._destroyed?0:this._shape[0]},set:function(e){return e|=0,p(this,e,this._shape[1]),e},enumerable:!1},height:{get:function(){return this._destroyed?0:this._shape[1]},set:function(e){return e|=0,p(this,this._shape[0],e),e},enumerable:!1}}),y.bind=function(){if(!this._destroyed){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,this.handle),e.viewport(0,0,this._shape[0],this._shape[1])}},y.dispose=function(){if(!this._destroyed){this._destroyed=!0;var e=this.gl;e.deleteFramebuffer(this.handle),this.handle=null,this.depth&&(this.depth.dispose(),this.depth=null),this._depth_rb&&(e.deleteRenderbuffer(this._depth_rb),this._depth_rb=null);for(var t=0;t<this.color.length;++t)this.color[t].dispose(),this.color[t]=null;this._color_rb&&(e.deleteRenderbuffer(this._color_rb),this._color_rb=null)}}},{"gl-texture2d":292}],229:[function(e,t){var a=e("sprintf-js").sprintf,o=e("gl-constants/lookup"),r=e("glsl-shader-name"),n=e("add-line-numbers");t.exports=function(t,l,s){"use strict";var d=r(l)||"of unknown name (see npm glsl-shader-name)",c="unknown type";s!==void 0&&(c=s===o.FRAGMENT_SHADER?"fragment":"vertex");for(var p=a("Error compiling %s shader %s:\n",c,d),u=a("%s%s",p,t),g=t.split("\n"),m={},h=0,y;h<g.length;h++)if(y=g[h],""!==y&&"\0"!==y){var f=parseInt(y.split(":")[2]);if(isNaN(f))throw new Error(a("Could not parse error: %s",y));m[f]=y}for(var x=n(l).split("\n"),h=0;h<x.length;h++)if(m[h+3]||m[h+2]||m[h+1]){var _=x[h];if(p+=_+"\n",m[h+1]){var b=m[h+1];b=b.substr(b.split(":",3).join(":").length+1).trim(),p+=a("^^^ %s\n\n",b)}}return{long:p.trim(),short:u.trim()}}},{"add-line-numbers":17,"gl-constants/lookup":225,"glsl-shader-name":370,"sprintf-js":1300}],230:[function(e,t){'use strict';function a(e,t,a,o,r,i,n){this.plot=e,this.shader=t,this.pickShader=a,this.positionBuffer=o,this.weightBuffer=r,this.colorBuffer=i,this.idBuffer=n,this.xData=[],this.yData=[],this.shape=[0,0],this.bounds=[1/0,1/0,-Infinity,-Infinity],this.pickOffset=0}t.exports=function(e,t){var o=e.gl,r=s(o,c.vertex,c.fragment),i=s(o,c.pickVertex,c.pickFragment),n=d(o),l=d(o),p=d(o),u=d(o),g=new a(e,r,i,n,l,p,u);return g.update(t),e.addObject(g),g};var o=e("binary-search-bounds"),n=e("iota-array"),l=e("typedarray-pool"),s=e("gl-shader"),d=e("gl-buffer"),c=e("./lib/shaders"),p=a.prototype,u=[0,0,1,0,0,1,1,0,1,1,0,1];p.draw=function(){var e=[1,0,0,0,1,0,0,0,1];return function(){var t=this.plot,a=this.shader,o=this.bounds,r=this.numVertices;if(!(0>=r)){var i=t.gl,n=t.dataBox,l=o[2]-o[0],s=o[3]-o[1],d=n[2]-n[0],c=n[3]-n[1];e[0]=2*l/d,e[4]=2*s/c,e[6]=2*(o[0]-n[0])/d-1,e[7]=2*(o[1]-n[1])/c-1,a.bind();var p=a.uniforms;p.viewTransform=e,p.shape=this.shape;var u=a.attributes;this.positionBuffer.bind(),u.position.pointer(),this.weightBuffer.bind(),u.weight.pointer(i.UNSIGNED_BYTE,!1),this.colorBuffer.bind(),u.color.pointer(i.UNSIGNED_BYTE,!0),i.drawArrays(i.TRIANGLES,0,r)}}}(),p.drawPick=function(){var e=[1,0,0,0,1,0,0,0,1],t=[0,0,0,0];return function(a){var o=this.plot,r=this.pickShader,n=this.bounds,l=this.numVertices;if(!(0>=l)){var s=o.gl,d=o.dataBox,c=n[2]-n[0],p=n[3]-n[1],u=d[2]-d[0],g=d[3]-d[1];e[0]=2*c/u,e[4]=2*p/g,e[6]=2*(n[0]-d[0])/u-1,e[7]=2*(n[1]-d[1])/g-1;for(var m=0;4>m;++m)t[m]=255&a>>8*m;this.pickOffset=a,r.bind();var h=r.uniforms;h.viewTransform=e,h.pickOffset=t,h.shape=this.shape;var y=r.attributes;return this.positionBuffer.bind(),y.position.pointer(),this.weightBuffer.bind(),y.weight.pointer(s.UNSIGNED_BYTE,!1),this.idBuffer.bind(),y.pickId.pointer(s.UNSIGNED_BYTE,!1),s.drawArrays(s.TRIANGLES,0,l),a+this.shape[0]*this.shape[1]}}}(),p.pick=function(e,t,a){var o=this.pickOffset,r=this.shape[0]*this.shape[1];if(a<o||a>=o+r)return null;var i=a-o,n=this.xData,l=this.yData;return{object:this,pointId:i,dataCoord:[n[i%this.shape[0]],l[0|i/this.shape[0]]]}},p.update=function(e){e=e||{};var s=e.shape||[0,0],d=e.x||n(s[0]),c=e.y||n(s[1]),p=e.z||new Float32Array(s[0]*s[1]);this.xData=d,this.yData=c;var m=e.colorLevels||[0],h=e.colorValues||[0,0,0,1],y=m.length,f=this.bounds,x=f[0]=d[0],_=f[1]=c[0],v=f[2]=d[d.length-1],w=f[3]=c[c.length-1],k=1/(v-x),T=1/(w-_),A=s[0],S=s[1];this.shape=[A,S];var C=(A-1)*(S-1)*(u.length>>>1);this.numVertices=C;for(var L=l.mallocUint8(4*C),E=l.mallocFloat32(2*C),I=l.mallocUint8(2*C),P=l.mallocUint32(C),z=0,D=0;D<S-1;++D)for(var O=T*(c[D]-_),R=T*(c[D+1]-_),M=0;M<A-1;++M)for(var B=k*(d[M]-x),F=k*(d[M+1]-x),N=0;N<u.length;N+=2){var V=u[N],U=u[N+1],H=(D+U)*A+(M+V),q=p[H],G=o.le(m,q),Y,W,X,Z;if(0>G)Y=h[0],W=h[1],X=h[2],Z=h[3];else if(G===y-1)Y=h[4*y-4],W=h[4*y-3],X=h[4*y-2],Z=h[4*y-1];else{var K=(q-m[G])/(m[G+1]-m[G]),t=1-K,$=4*G,J=4*(G+1);Y=t*h[$]+K*h[J],W=t*h[$+1]+K*h[J+1],X=t*h[$+2]+K*h[J+2],Z=t*h[$+3]+K*h[J+3]}L[4*z]=255*Y,L[4*z+1]=255*W,L[4*z+2]=255*X,L[4*z+3]=255*Z,E[2*z]=.5*B+.5*F,E[2*z+1]=.5*O+.5*R,I[2*z]=V,I[2*z+1]=U,P[z]=D*A+M,z+=1}this.positionBuffer.update(E),this.weightBuffer.update(I),this.colorBuffer.update(L),this.idBuffer.update(P),l.free(E),l.free(L),l.free(I),l.free(P)},p.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.positionBuffer.dispose(),this.weightBuffer.dispose(),this.colorBuffer.dispose(),this.idBuffer.dispose(),this.plot.removeObject(this)}},{"./lib/shaders":231,"binary-search-bounds":42,"gl-buffer":220,"gl-shader":277,"iota-array":385,"typedarray-pool":1328}],231:[function(e,t){'use strict';var a=e("glslify");t.exports={fragment:a(["precision lowp float;\n#define GLSLIFY 1\nvarying vec4 fragColor;\nvoid main() {\n  gl_FragColor = vec4(fragColor.rgb * fragColor.a, fragColor.a);\n}\n"]),vertex:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 color;\nattribute vec2 weight;\n\nuniform vec2 shape;\nuniform mat3 viewTransform;\n\nvarying vec4 fragColor;\n\nvoid main() {\n  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);\n  fragColor = color;\n  gl_Position = vec4(vPosition.xy, 0, vPosition.z);\n}\n"]),pickFragment:a(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragId;\nvarying vec2 vWeight;\n\nuniform vec2 shape;\nuniform vec4 pickOffset;\n\nvoid main() {\n  vec2 d = step(.5, vWeight);\n  vec4 id = fragId + pickOffset;\n  id.x += d.x + d.y*shape.x;\n\n  id.y += floor(id.x / 256.0);\n  id.x -= floor(id.x / 256.0) * 256.0;\n\n  id.z += floor(id.y / 256.0);\n  id.y -= floor(id.y / 256.0) * 256.0;\n\n  id.w += floor(id.z / 256.0);\n  id.z -= floor(id.z / 256.0) * 256.0;\n\n  gl_FragColor = id/255.;\n}\n"]),pickVertex:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 pickId;\nattribute vec2 weight;\n\nuniform vec2 shape;\nuniform mat3 viewTransform;\n\nvarying vec4 fragId;\nvarying vec2 vWeight;\n\nvoid main() {\n  vWeight = weight;\n\n  fragId = pickId;\n\n  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);\n  gl_Position = vec4(vPosition.xy, 0, vPosition.z);\n}\n"])}},{glslify:378}],232:[function(e,t,a){var o=e("glslify"),r=e("gl-shader"),i=o(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, nextPosition;\nattribute float arcLength, lineWidth;\nattribute vec4 color;\n\nuniform vec2 screenShape;\nuniform float pixelRatio;\nuniform mat4 model, view, projection;\n\nvarying vec4 fragColor;\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\n\nvec4 project(vec3 p) {\n  return projection * view * model * vec4(p, 1.0);\n}\n\nvoid main() {\n  vec4 startPoint = project(position);\n  vec4 endPoint   = project(nextPosition);\n\n  vec2 A = startPoint.xy / startPoint.w;\n  vec2 B =   endPoint.xy /   endPoint.w;\n\n  float clipAngle = atan(\n    (B.y - A.y) * screenShape.y,\n    (B.x - A.x) * screenShape.x\n  );\n\n  vec2 offset = 0.5 * pixelRatio * lineWidth * vec2(\n    sin(clipAngle),\n    -cos(clipAngle)\n  ) / screenShape;\n\n  gl_Position = vec4(startPoint.xy + startPoint.w * offset, startPoint.zw);\n\n  worldPosition = position;\n  pixelArcLength = arcLength;\n  fragColor = color;\n}\n"]),n=o(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3      clipBounds[2];\nuniform sampler2D dashTexture;\nuniform float     dashScale;\nuniform float     opacity;\n\nvarying vec3    worldPosition;\nvarying float   pixelArcLength;\nvarying vec4    fragColor;\n\nvoid main() {\n  if (\n    outOfRange(clipBounds[0], clipBounds[1], worldPosition) ||\n    fragColor.a * opacity == 0.\n  ) discard;\n\n  float dashWeight = texture2D(dashTexture, vec2(dashScale * pixelArcLength, 0)).r;\n  if(dashWeight < 0.5) {\n    discard;\n  }\n  gl_FragColor = fragColor * opacity;\n}\n"]),l=o(["precision highp float;\n#define GLSLIFY 1\n\n#define FLOAT_MAX  1.70141184e38\n#define FLOAT_MIN  1.17549435e-38\n\n// https://github.com/mikolalysenko/glsl-read-float/blob/master/index.glsl\nvec4 packFloat(float v) {\n  float av = abs(v);\n\n  //Handle special cases\n  if(av < FLOAT_MIN) {\n    return vec4(0.0, 0.0, 0.0, 0.0);\n  } else if(v > FLOAT_MAX) {\n    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;\n  } else if(v < -FLOAT_MAX) {\n    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;\n  }\n\n  vec4 c = vec4(0,0,0,0);\n\n  //Compute exponent and mantissa\n  float e = floor(log2(av));\n  float m = av * pow(2.0, -e) - 1.0;\n\n  //Unpack mantissa\n  c[1] = floor(128.0 * m);\n  m -= c[1] / 128.0;\n  c[2] = floor(32768.0 * m);\n  m -= c[2] / 32768.0;\n  c[3] = floor(8388608.0 * m);\n\n  //Unpack exponent\n  float ebias = e + 127.0;\n  c[0] = floor(ebias / 2.0);\n  ebias -= c[0] * 2.0;\n  c[1] += floor(ebias) * 128.0;\n\n  //Unpack sign bit\n  c[0] += 128.0 * step(0.0, -v);\n\n  //Scale back to range\n  return c / 255.0;\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform float pickId;\nuniform vec3 clipBounds[2];\n\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\nvarying vec4 fragColor;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], worldPosition)) discard;\n\n  gl_FragColor = vec4(pickId/255.0, packFloat(pixelArcLength).xyz);\n}"]),s=[{name:"position",type:"vec3"},{name:"nextPosition",type:"vec3"},{name:"arcLength",type:"float"},{name:"lineWidth",type:"float"},{name:"color",type:"vec4"}];a.createShader=function(e){return r(e,i,n,null,s)},a.createPickShader=function(e){return r(e,i,l,null,s)}},{"gl-shader":277,glslify:378}],233:[function(e,t){'use strict';var s=Math.min,d=Math.max;function o(e,t,a,o){return g[0]=o,g[1]=a,g[2]=t,g[3]=e,m[0]}function r(e,t){for(var a=0,o=0,r;3>o;++o)r=e[o]-t[o],a+=r*r;return Math.sqrt(a)}function i(e){for(var t=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],a=0;3>a;++a)t[0][a]=d(e[0][a],t[0][a]),t[1][a]=s(e[1][a],t[1][a]);return t}function n(e,t,a,o){this.arcLength=e,this.position=t,this.index=a,this.dataCoordinate=o}function l(e,t,a,o,r,i){this.gl=e,this.shader=t,this.pickShader=a,this.buffer=o,this.vao=r,this.clipBounds=[[-Infinity,-Infinity,-Infinity],[1/0,1/0,1/0]],this.points=[],this.arcLength=[],this.vertexCount=0,this.bounds=[[0,0,0],[0,0,0]],this.pickId=0,this.lineWidth=1,this.texture=i,this.dashScale=1,this.opacity=1,this.hasAlpha=!1,this.dirty=!0,this.pixelRatio=1}t.exports=function(e){var t=e.gl||e.scene&&e.scene.gl,a=x(t);a.attributes.position.location=0,a.attributes.nextPosition.location=1,a.attributes.arcLength.location=2,a.attributes.lineWidth.location=3,a.attributes.color.location=4;var o=_(t);o.attributes.position.location=0,o.attributes.nextPosition.location=1,o.attributes.arcLength.location=2,o.attributes.lineWidth.location=3,o.attributes.color.location=4;for(var r=c(t),n=p(t,[{buffer:r,size:3,offset:0,stride:48},{buffer:r,size:3,offset:12,stride:48},{buffer:r,size:1,offset:24,stride:48},{buffer:r,size:1,offset:28,stride:48},{buffer:r,size:4,offset:32,stride:48}]),s=y(Array(1024),[256,1,4]),d=0;1024>d;++d)s.data[d]=255;var g=u(t,s);g.wrap=t.REPEAT;var m=new l(t,a,o,r,n,g);return m.update(e),m};var c=e("gl-buffer"),p=e("gl-vao"),u=e("gl-texture2d"),g=new Uint8Array(4),m=new Float32Array(g.buffer),h=e("binary-search-bounds"),y=e("ndarray"),f=e("./lib/shaders"),x=f.createShader,_=f.createPickShader,b=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],v=l.prototype;v.isTransparent=function(){return this.hasAlpha},v.isOpaque=function(){return!this.hasAlpha},v.pickSlots=1,v.setPickBase=function(e){this.pickId=e},v.drawTransparent=v.draw=function(e){if(this.vertexCount){var t=this.gl,a=this.shader,o=this.vao;a.bind(),a.uniforms={model:e.model||b,view:e.view||b,projection:e.projection||b,clipBounds:i(this.clipBounds),dashTexture:this.texture.bind(),dashScale:this.dashScale/this.arcLength[this.arcLength.length-1],opacity:this.opacity,screenShape:[t.drawingBufferWidth,t.drawingBufferHeight],pixelRatio:this.pixelRatio},o.bind(),o.draw(t.TRIANGLE_STRIP,this.vertexCount),o.unbind()}},v.drawPick=function(e){if(this.vertexCount){var t=this.gl,a=this.pickShader,o=this.vao;a.bind(),a.uniforms={model:e.model||b,view:e.view||b,projection:e.projection||b,pickId:this.pickId,clipBounds:i(this.clipBounds),screenShape:[t.drawingBufferWidth,t.drawingBufferHeight],pixelRatio:this.pixelRatio},o.bind(),o.draw(t.TRIANGLE_STRIP,this.vertexCount),o.unbind()}},v.update=function(e){var t,o;this.dirty=!0;var n=!!e.connectGaps;"dashScale"in e&&(this.dashScale=e.dashScale),this.hasAlpha=!1,"opacity"in e&&(this.opacity=+e.opacity,1>this.opacity&&(this.hasAlpha=!0));var l=[],c=[],p=[],u=0,g=0,m=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]],f=e.position||e.positions;if(f){var x=e.color||e.colors||[0,0,0,1],_=e.lineWidth||1,v=!1;fill_loop:for(t=1;t<f.length;++t){var w=f[t-1],a=f[t];for(c.push(u),p.push(w.slice()),o=0;3>o;++o){if(isNaN(w[o])||isNaN(a[o])||!isFinite(w[o])||!isFinite(a[o])){if(!n&&0<l.length){for(var b=0;24>b;++b)l.push(l[l.length-12]);g+=2,v=!0}continue fill_loop}m[0][o]=s(m[0][o],w[o],a[o]),m[1][o]=d(m[1][o],w[o],a[o])}var T,A;Array.isArray(x[0])?(T=x.length>t-1?x[t-1]:0<x.length?x[x.length-1]:[0,0,0,1],A=x.length>t?x[t]:0<x.length?x[x.length-1]:[0,0,0,1]):T=A=x,3===T.length&&(T=[T[0],T[1],T[2],1]),3===A.length&&(A=[A[0],A[1],A[2],1]),!this.hasAlpha&&1>T[3]&&(this.hasAlpha=!0);var S=Array.isArray(_)?_.length>t-1?_[t-1]:0<_.length?_[_.length-1]:[0,0,0,1]:_;var C=u;if(u+=r(w,a),v){for(o=0;2>o;++o)l.push(w[0],w[1],w[2],a[0],a[1],a[2],C,S,T[0],T[1],T[2],T[3]);g+=2,v=!1}l.push(w[0],w[1],w[2],a[0],a[1],a[2],C,S,T[0],T[1],T[2],T[3],w[0],w[1],w[2],a[0],a[1],a[2],C,-S,T[0],T[1],T[2],T[3],a[0],a[1],a[2],w[0],w[1],w[2],u,-S,A[0],A[1],A[2],A[3],a[0],a[1],a[2],w[0],w[1],w[2],u,S,A[0],A[1],A[2],A[3]),g+=4}}if(this.buffer.update(l),c.push(u),p.push(f[f.length-1].slice()),this.bounds=m,this.vertexCount=g,this.points=p,this.arcLength=c,"dashes"in e){var L=e.dashes,E=L.slice();for(E.unshift(0),t=1;t<E.length;++t)E[t]=E[t-1]+E[t];var I=y(Array(1024),[256,1,4]);for(t=0;256>t;++t){for(o=0;4>o;++o)I.set(t,0,o,0);1&h.le(E,E[E.length-1]*t/255)?I.set(t,0,0,0):I.set(t,0,0,255)}this.texture.setPixels(I)}},v.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()},v.pick=function(e){if(!e)return null;if(e.id!==this.pickId)return null;var r=o(e.value[0],e.value[1],e.value[2],0),l=h.le(this.arcLength,r);if(0>l)return null;if(l===this.arcLength.length-1)return new n(this.arcLength[this.arcLength.length-1],this.points[this.points.length-1].slice(),l);for(var d=this.points[l],a=this.points[s(l+1,this.points.length-1)],c=(r-this.arcLength[l])/(this.arcLength[l+1]-this.arcLength[l]),t=[0,0,0],p=0;3>p;++p)t[p]=(1-c)*d[p]+c*a[p];var u=s(.5>c?l:l+1,this.points.length-1);return new n(r,t,u,this.points[u])}},{"./lib/shaders":232,"binary-search-bounds":42,"gl-buffer":220,"gl-texture2d":292,"gl-vao":297,ndarray:425}],234:[function(e,t){t.exports=function(e,t){var a=t[0],o=t[1],r=t[2],i=t[3],n=a*i-r*o;return n?(n=1/n,e[0]=i*n,e[1]=-o*n,e[2]=-r*n,e[3]=a*n,e):null}},{}],235:[function(e,t){t.exports=function(e,t){var a=t[0],o=t[1],r=t[2],i=t[3],n=t[4],l=t[5],s=t[6],d=t[7],c=t[8],p=c*n-l*d,u=-c*i+l*s,g=d*i-n*s,m=a*p+o*u+r*g;return m?(m=1/m,e[0]=p*m,e[1]=(-c*o+r*d)*m,e[2]=(l*o-r*n)*m,e[3]=u*m,e[4]=(c*a-r*s)*m,e[5]=(-l*a+r*i)*m,e[6]=g*m,e[7]=(-d*a+o*s)*m,e[8]=(n*a-o*i)*m,e):null}},{}],236:[function(e,t){t.exports=function(e){var t=new Float32Array(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}},{}],237:[function(e,t){t.exports=function(){var e=new Float32Array(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],238:[function(e,t){t.exports=function(e){var t=e[0],a=e[1],o=e[2],r=e[3],i=e[4],n=e[5],l=e[6],s=e[7],d=e[8],c=e[9],p=e[10],u=e[11],g=e[12],m=e[13],h=e[14],y=e[15];return(t*n-a*i)*(p*y-u*h)-(t*l-o*i)*(c*y-u*m)+(t*s-r*i)*(c*h-p*m)+(a*l-o*n)*(d*y-u*g)-(a*s-r*n)*(d*h-p*g)+(o*s-r*l)*(d*m-c*g)}},{}],239:[function(e,t){t.exports=function(e,t){var a=t[0],o=t[1],r=t[2],i=t[3],n=a+a,l=o+o,s=r+r,d=a*n,c=o*n,p=o*l,u=r*n,g=r*l,m=r*s,h=i*n,y=i*l,f=i*s;return e[0]=1-p-m,e[1]=c+f,e[2]=u-y,e[3]=0,e[4]=c-f,e[5]=1-d-m,e[6]=g+h,e[7]=0,e[8]=u+y,e[9]=g-h,e[10]=1-d-p,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],240:[function(e,t){t.exports=function(e,t,a){var o=t[0],r=t[1],i=t[2],n=t[3],l=o+o,s=r+r,d=i+i,c=o*l,p=o*s,u=o*d,g=r*s,m=r*d,h=i*d,y=n*l,f=n*s,x=n*d;return e[0]=1-(g+h),e[1]=p+x,e[2]=u-f,e[3]=0,e[4]=p-x,e[5]=1-(c+h),e[6]=m+y,e[7]=0,e[8]=u+f,e[9]=m-y,e[10]=1-(c+g),e[11]=0,e[12]=a[0],e[13]=a[1],e[14]=a[2],e[15]=1,e}},{}],241:[function(e,t){t.exports=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],242:[function(e,t){t.exports=function(e,t){var a=t[0],o=t[1],r=t[2],i=t[3],n=t[4],l=t[5],s=t[6],d=t[7],c=t[8],p=t[9],u=t[10],g=t[11],m=t[12],h=t[13],y=t[14],f=t[15],x=a*l-o*n,_=a*s-r*n,b=a*d-i*n,v=o*s-r*l,w=o*d-i*l,k=r*d-i*s,T=c*h-p*m,A=c*y-u*m,S=c*f-g*m,C=p*y-u*h,L=p*f-g*h,E=u*f-g*y,I=x*E-_*L+b*C+v*S-w*A+k*T;return I?(I=1/I,e[0]=(l*E-s*L+d*C)*I,e[1]=(r*L-o*E-i*C)*I,e[2]=(h*k-y*w+f*v)*I,e[3]=(u*w-p*k-g*v)*I,e[4]=(s*S-n*E-d*A)*I,e[5]=(a*E-r*S+i*A)*I,e[6]=(y*b-m*k-f*_)*I,e[7]=(c*k-u*b+g*_)*I,e[8]=(n*L-l*S+d*T)*I,e[9]=(o*S-a*L-i*T)*I,e[10]=(m*w-h*b+f*x)*I,e[11]=(p*b-c*w-g*x)*I,e[12]=(l*A-n*C-s*T)*I,e[13]=(a*C-o*A+r*T)*I,e[14]=(h*_-m*v-y*x)*I,e[15]=(c*v-p*_+u*x)*I,e):null}},{}],243:[function(e,t){var a=Math.sqrt,o=Math.abs,r=e("./identity");t.exports=function(e,t,i,n){var l=t[0],s=t[1],d=t[2],c=n[0],p=n[1],u=n[2],g=i[0],m=i[1],h=i[2],y,f,x,_,b,v,w,k,T,A;return 1e-6>o(l-g)&&1e-6>o(s-m)&&1e-6>o(d-h)?r(e):(w=l-g,k=s-m,T=d-h,A=1/a(w*w+k*k+T*T),w*=A,k*=A,T*=A,y=p*T-u*k,f=u*w-c*T,x=c*k-p*w,A=a(y*y+f*f+x*x),A?(A=1/A,y*=A,f*=A,x*=A):(y=0,f=0,x=0),_=k*x-T*f,b=T*y-w*x,v=w*f-k*y,A=a(_*_+b*b+v*v),A?(A=1/A,_*=A,b*=A,v*=A):(_=0,b=0,v=0),e[0]=y,e[1]=_,e[2]=w,e[3]=0,e[4]=f,e[5]=b,e[6]=k,e[7]=0,e[8]=x,e[9]=v,e[10]=T,e[11]=0,e[12]=-(y*l+f*s+x*d),e[13]=-(_*l+b*s+v*d),e[14]=-(w*l+k*s+T*d),e[15]=1,e)}},{"./identity":241}],244:[function(e,t){t.exports=function(e,t,a){var o=t[0],r=t[1],i=t[2],n=t[3],l=t[4],s=t[5],d=t[6],c=t[7],p=t[8],u=t[9],g=t[10],m=t[11],h=t[12],y=t[13],f=t[14],x=t[15],_=a[0],b=a[1],v=a[2],w=a[3];return e[0]=_*o+b*l+v*p+w*h,e[1]=_*r+b*s+v*u+w*y,e[2]=_*i+b*d+v*g+w*f,e[3]=_*n+b*c+v*m+w*x,_=a[4],b=a[5],v=a[6],w=a[7],e[4]=_*o+b*l+v*p+w*h,e[5]=_*r+b*s+v*u+w*y,e[6]=_*i+b*d+v*g+w*f,e[7]=_*n+b*c+v*m+w*x,_=a[8],b=a[9],v=a[10],w=a[11],e[8]=_*o+b*l+v*p+w*h,e[9]=_*r+b*s+v*u+w*y,e[10]=_*i+b*d+v*g+w*f,e[11]=_*n+b*c+v*m+w*x,_=a[12],b=a[13],v=a[14],w=a[15],e[12]=_*o+b*l+v*p+w*h,e[13]=_*r+b*s+v*u+w*y,e[14]=_*i+b*d+v*g+w*f,e[15]=_*n+b*c+v*m+w*x,e}},{}],245:[function(e,t){t.exports=function(e,t,a,o,r,i,n){var l=1/(t-a),s=1/(o-r),d=1/(i-n);return e[0]=-2*l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*d,e[11]=0,e[12]=(t+a)*l,e[13]=(r+o)*s,e[14]=(n+i)*d,e[15]=1,e}},{}],246:[function(e,t){var a=Math.tan;t.exports=function(e,t,o,r,i){var n=1/a(t/2),l=1/(r-i);return e[0]=n/o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(i+r)*l,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*i*r*l,e[15]=0,e}},{}],247:[function(e,t){var o=Math.cos,r=Math.sqrt,i=Math.sin,n=Math.abs;t.exports=function(e,l,a,d){var p=d[0],u=d[1],g=d[2],m=r(p*p+u*u+g*g),h,f,_,b,v,w,k,T,A,S,C,L,E,I,P,D,O,R,M,j,B,F,N,V;return 1e-6>n(m)?null:(m=1/m,p*=m,u*=m,g*=m,h=i(a),f=o(a),_=1-f,b=l[0],v=l[1],w=l[2],k=l[3],T=l[4],A=l[5],S=l[6],C=l[7],L=l[8],E=l[9],I=l[10],P=l[11],D=p*p*_+f,O=u*p*_+g*h,R=g*p*_-u*h,M=p*u*_-g*h,j=u*u*_+f,B=g*u*_+p*h,F=p*g*_+u*h,N=u*g*_-p*h,V=g*g*_+f,e[0]=b*D+T*O+L*R,e[1]=v*D+A*O+E*R,e[2]=w*D+S*O+I*R,e[3]=k*D+C*O+P*R,e[4]=b*M+T*j+L*B,e[5]=v*M+A*j+E*B,e[6]=w*M+S*j+I*B,e[7]=k*M+C*j+P*B,e[8]=b*F+T*N+L*V,e[9]=v*F+A*N+E*V,e[10]=w*F+S*N+I*V,e[11]=k*F+C*N+P*V,l!==e&&(e[12]=l[12],e[13]=l[13],e[14]=l[14],e[15]=l[15]),e)}},{}],248:[function(e,t){var o=Math.cos,r=Math.sin;t.exports=function(e,t,a){var i=r(a),n=o(a),l=t[4],s=t[5],d=t[6],c=t[7],p=t[8],u=t[9],g=t[10],m=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=l*n+p*i,e[5]=s*n+u*i,e[6]=d*n+g*i,e[7]=c*n+m*i,e[8]=p*n-l*i,e[9]=u*n-s*i,e[10]=g*n-d*i,e[11]=m*n-c*i,e}},{}],249:[function(e,t){var o=Math.cos,r=Math.sin;t.exports=function(e,t,a){var i=r(a),n=o(a),l=t[0],s=t[1],d=t[2],c=t[3],p=t[8],u=t[9],g=t[10],m=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=l*n-p*i,e[1]=s*n-u*i,e[2]=d*n-g*i,e[3]=c*n-m*i,e[8]=l*i+p*n,e[9]=s*i+u*n,e[10]=d*i+g*n,e[11]=c*i+m*n,e}},{}],250:[function(e,t){var o=Math.cos,r=Math.sin;t.exports=function(e,t,a){var i=r(a),n=o(a),l=t[0],s=t[1],d=t[2],c=t[3],p=t[4],u=t[5],g=t[6],m=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=l*n+p*i,e[1]=s*n+u*i,e[2]=d*n+g*i,e[3]=c*n+m*i,e[4]=p*n-l*i,e[5]=u*n-s*i,e[6]=g*n-d*i,e[7]=m*n-c*i,e}},{}],251:[function(e,t){t.exports=function(e,t,a){var o=a[0],r=a[1],i=a[2];return e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e[3]=t[3]*o,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}},{}],252:[function(e,t){t.exports=function(e,t,a){var o=a[0],r=a[1],i=a[2],n,l,s,d,c,p,u,g,m,h,y,f;return t===e?(e[12]=t[0]*o+t[4]*r+t[8]*i+t[12],e[13]=t[1]*o+t[5]*r+t[9]*i+t[13],e[14]=t[2]*o+t[6]*r+t[10]*i+t[14],e[15]=t[3]*o+t[7]*r+t[11]*i+t[15]):(n=t[0],l=t[1],s=t[2],d=t[3],c=t[4],p=t[5],u=t[6],g=t[7],m=t[8],h=t[9],y=t[10],f=t[11],e[0]=n,e[1]=l,e[2]=s,e[3]=d,e[4]=c,e[5]=p,e[6]=u,e[7]=g,e[8]=m,e[9]=h,e[10]=y,e[11]=f,e[12]=n*o+c*r+m*i+t[12],e[13]=l*o+p*r+h*i+t[13],e[14]=s*o+u*r+y*i+t[14],e[15]=d*o+g*r+f*i+t[15]),e}},{}],253:[function(e,t){t.exports=function(e,t){if(e===t){var a=t[1],o=t[2],r=t[3],i=t[6],n=t[7],l=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=a,e[6]=t[9],e[7]=t[13],e[8]=o,e[9]=i,e[11]=t[14],e[12]=r,e[13]=n,e[14]=l}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}},{}],254:[function(e,t){'use strict';t.exports=function(e,t){switch(t.length){case 0:break;case 1:e[0]=1/t[0];break;case 4:a(e,t);break;case 9:o(e,t);break;case 16:r(e,t);break;default:throw new Error("currently supports matrices up to 4x4");}return e};var a=e("gl-mat2/invert"),o=e("gl-mat3/invert"),r=e("gl-mat4/invert")},{"gl-mat2/invert":234,"gl-mat3/invert":235,"gl-mat4/invert":242}],255:[function(e,t){'use strict';var l=Math.sqrt,s=Math.pow,d=Math.abs;function a(e,t){for(var a=[0,0,0,0],o=0;4>o;++o)for(var r=0;4>r;++r)a[r]+=e[4*o+r]*t[o];return a}function o(e,t,o,r,n){for(var l=a(r,a(o,a(t,[e[0],e[1],e[2],1]))),s=0;3>s;++s)l[s]/=l[3];return[.5*n[0]*(1+l[0]),.5*n[1]*(1-l[1])]}function r(e,t){if(2===e.length){for(var a=0,o=0,r=0;2>r;++r)a+=s(t[r]-e[0][r],2),o+=s(t[r]-e[1][r],2);return a=l(a),o=l(o),1e-6>a+o?[1,0]:[o/(a+o),a/(o+a)]}if(3===e.length){var n=[0,0];return p(e[0],e[1],e[2],t,n),c(e,n)}return[]}function n(e,t){for(var a=[0,0,0],o=0;o<e.length;++o)for(var r=e[o],n=t[o],l=0;3>l;++l)a[l]+=n*r[l];return a}var c=e("barycentric"),p=e("polytope-closest-point/lib/closest_point_2d.js");t.exports=function(e,t,a,l,c,p){if(1===e.length)return[0,e[0].slice()];for(var u=Array(e.length),g=0;g<e.length;++g)u[g]=o(e[g],a,l,c,p);for(var m=0,h=1/0,g=0,y;g<u.length;++g){y=0;for(var f=0;2>f;++f)y+=s(u[g][f]-t[f],2);y<h&&(h=y,m=g)}for(var x=r(u,t),_=0,g=0;3>g;++g){if(-.001>x[g]||1.0001<x[g])return null;_+=x[g]}return .001<d(_-1)?null:[m,n(e,x),x]}},{barycentric:25,"polytope-closest-point/lib/closest_point_2d.js":1257}],256:[function(e,t,a){var o=e("glslify"),r=o(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, normal;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 model\n           , view\n           , projection\n           , inverseModel;\nuniform vec3 eyePosition\n           , lightPosition;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvec4 project(vec3 p) {\n  return projection * view * model * vec4(p, 1.0);\n}\n\nvoid main() {\n  gl_Position      = project(position);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * vec4(position , 1.0);\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal  = normalize((vec4(normal, 0.0) * inverseModel).xyz);\n\n  f_color          = color;\n  f_data           = position;\n  f_uv             = uv;\n}\n"]),i=o(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\n//#pragma glslify: beckmann = require(glsl-specular-beckmann) // used in gl-surface3d\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness\n            , fresnel\n            , kambient\n            , kdiffuse\n            , kspecular;\nuniform sampler2D texture;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (f_color.a == 0.0 ||\n    outOfRange(clipBounds[0], clipBounds[1], f_data)\n  ) discard;\n\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  //float specular = max(0.0, beckmann(L, V, N, roughness)); // used in gl-surface3d\n\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = vec4(f_color.rgb, 1.0) * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * f_color.a;\n}\n"]),n=o(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 model, view, projection;\n\nvarying vec4 f_color;\nvarying vec3 f_data;\nvarying vec2 f_uv;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_color = color;\n  f_data  = position;\n  f_uv    = uv;\n}"]),l=o(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec4 f_color;\nvarying vec3 f_data;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_data)) discard;\n\n  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;\n}"]),s=o(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 uv;\nattribute float pointSize;\n\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0.0, 0.0 ,0.0 ,0.0);\n  } else {\n    gl_Position = projection * view * model * vec4(position, 1.0);\n  }\n  gl_PointSize = pointSize;\n  f_color = color;\n  f_uv = uv;\n}"]),d=o(["precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  vec2 pointR = gl_PointCoord.xy - vec2(0.5, 0.5);\n  if(dot(pointR, pointR) > 0.25) {\n    discard;\n  }\n  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;\n}"]),c=o(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_id        = id;\n  f_position  = position;\n}"]),p=o(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]),u=o(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3  position;\nattribute float pointSize;\nattribute vec4  id;\n\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0.0, 0.0, 0.0, 0.0);\n  } else {\n    gl_Position  = projection * view * model * vec4(position, 1.0);\n    gl_PointSize = pointSize;\n  }\n  f_id         = id;\n  f_position   = position;\n}"]),g=o(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n}"]),m=o(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec3 contourColor;\n\nvoid main() {\n  gl_FragColor = vec4(contourColor, 1.0);\n}\n"]);a.meshShader={vertex:r,fragment:i,attributes:[{name:"position",type:"vec3"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},a.wireShader={vertex:n,fragment:l,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},a.pointShader={vertex:s,fragment:d,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"pointSize",type:"float"}]},a.pickShader={vertex:c,fragment:p,attributes:[{name:"position",type:"vec3"},{name:"id",type:"vec4"}]},a.pointPickShader={vertex:u,fragment:p,attributes:[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"id",type:"vec4"}]},a.contourShader={vertex:g,fragment:m,attributes:[{name:"position",type:"vec3"}]}},{glslify:378}],257:[function(e,t){'use strict';var g=Math.min,m=Math.max;function a(e,t,a,o,r,i,n,l,s,d,c,p,u,g,m,h,y,f,x,_,b,v,w,k,T,A,S){this.gl=e,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=t,this.dirty=!0,this.triShader=a,this.lineShader=o,this.pointShader=r,this.pickShader=i,this.pointPickShader=n,this.contourShader=l,this.trianglePositions=s,this.triangleColors=c,this.triangleNormals=u,this.triangleUVs=p,this.triangleIds=d,this.triangleVAO=g,this.triangleCount=0,this.lineWidth=1,this.edgePositions=m,this.edgeColors=y,this.edgeUVs=f,this.edgeIds=h,this.edgeVAO=x,this.edgeCount=0,this.pointPositions=_,this.pointColors=v,this.pointUVs=w,this.pointSizes=k,this.pointIds=b,this.pointVAO=T,this.pointCount=0,this.contourLineWidth=1,this.contourPositions=A,this.contourVAO=S,this.contourCount=0,this.contourColor=[0,0,0],this.contourEnable=!0,this.pickVertex=!0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]],this.clipBounds=[[-Infinity,-Infinity,-Infinity],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.hasAlpha=!1,this.opacityscale=!1,this._model=R,this._view=R,this._projection=R,this._resolution=[1,1]}function o(e,t){if(!t)return 1;if(!t.length)return 1;for(var a=0;a<t.length;++a){if(2>t.length)return 1;if(t[a][0]===e)return t[a][1];if(t[a][0]>e&&0<a){var o=(t[a][0]-e)/(t[a][0]-t[a-1][0]);return t[a][1]*(1-o)+o*t[a-1][1]}}return 1}function r(e,t){for(var a=k({colormap:e,nshades:256,format:"rgba"}),r=new Uint8Array(1024),n=0,l;256>n;++n){l=a[n];for(var s=0;3>s;++s)r[4*n+s]=l[s];r[4*n+3]=t?255*o(n/255,t):255*l[3]}return w(r,[256,256,4],[4,0,1])}function n(e){for(var t=e.length,a=Array(t),o=0;o<t;++o)a[o]=e[o][2];return a}function l(e){var t=h(e,E.vertex,E.fragment);return t.attributes.position.location=0,t.attributes.color.location=2,t.attributes.uv.location=3,t.attributes.normal.location=4,t}function s(e){var t=h(e,I.vertex,I.fragment);return t.attributes.position.location=0,t.attributes.color.location=2,t.attributes.uv.location=3,t}function d(e){var t=h(e,P.vertex,P.fragment);return t.attributes.position.location=0,t.attributes.color.location=2,t.attributes.uv.location=3,t.attributes.pointSize.location=4,t}function c(e){var t=h(e,z.vertex,z.fragment);return t.attributes.position.location=0,t.attributes.id.location=1,t}function p(e){var t=h(e,D.vertex,D.fragment);return t.attributes.position.location=0,t.attributes.id.location=1,t.attributes.pointSize.location=4,t}function u(e){var t=h(e,O.vertex,O.fragment);return t.attributes.position.location=0,t}var h=e("gl-shader"),y=e("gl-buffer"),f=e("gl-vao"),x=e("gl-texture2d"),_=e("normals"),b=e("gl-mat4/multiply"),v=e("gl-mat4/invert"),w=e("ndarray"),k=e("colormap"),T=e("simplicial-complex-contour"),A=e("typedarray-pool"),S=e("./lib/shaders"),L=e("./lib/closest-point"),E=S.meshShader,I=S.wireShader,P=S.pointShader,z=S.pickShader,D=S.pointPickShader,O=S.contourShader,R=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],M=a.prototype;M.isOpaque=function(){return!this.hasAlpha},M.isTransparent=function(){return this.hasAlpha},M.pickSlots=1,M.setPickBase=function(e){this.pickId=e},M.highlight=function(e){if(!e||!this.contourEnable)return void(this.contourCount=0);for(var t=T(this.cells,this.intensity,e.intensity),o=t.cells,r=t.vertexIds,n=t.vertexWeights,l=o.length,s=A.mallocFloat32(6*l),d=0,p=0,u;p<l;++p){u=o[p];for(var g=0,m;2>g;++g){m=u[0],2===u.length&&(m=u[g]);for(var h=r[m][0],a=r[m][1],y=n[m],f=this.positions[h],x=this.positions[a],_=0;3>_;++_)s[d++]=y*f[_]+(1-y)*x[_]}}this.contourCount=0|d/3,this.contourPositions.update(s.subarray(0,d)),A.free(s)},M.update=function(e){e=e||{};var t=this.gl;this.dirty=!0,"contourEnable"in e&&(this.contourEnable=e.contourEnable),"contourColor"in e&&(this.contourColor=e.contourColor),"lineWidth"in e&&(this.lineWidth=e.lineWidth),"lightPosition"in e&&(this.lightPosition=e.lightPosition),this.hasAlpha=!1,"opacity"in e&&(this.opacity=e.opacity,1>this.opacity&&(this.hasAlpha=!0)),"opacityscale"in e&&(this.opacityscale=e.opacityscale,this.hasAlpha=!0),"ambient"in e&&(this.ambientLight=e.ambient),"diffuse"in e&&(this.diffuseLight=e.diffuse),"specular"in e&&(this.specularLight=e.specular),"roughness"in e&&(this.roughness=e.roughness),"fresnel"in e&&(this.fresnel=e.fresnel),e.texture?(this.texture.dispose(),this.texture=x(t,e.texture)):e.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=t.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=t.LINEAR,this.texture.setPixels(r(e.colormap,this.opacityscale)),this.texture.generateMipmap());var a=e.cells,l=e.positions;if(l&&a){var s=[],d=[],u=[],h=[],y=[],b=[],w=[],T=[],A=[],S=[],C=[],L=[],E=[],I=[];this.cells=a,this.positions=l;var P=e.vertexNormals,z=e.cellNormals,D=void 0===e.vertexNormalsEpsilon?1e-6:e.vertexNormalsEpsilon,O=void 0===e.faceNormalsEpsilon?1e-6:e.faceNormalsEpsilon;e.useFacetNormals&&!z&&(z=_.faceNormals(a,l,O)),z||P||(P=_.vertexNormals(a,l,D));var R=e.vertexColors,M=e.cellColors,B=e.meshColor||[1,1,1,1],F=e.vertexUVs,N=e.vertexIntensity,V=e.cellUVs,U=e.cellIntensity,H=1/0,G=-Infinity;if(!F&&!V)if(N){if(e.vertexIntensityBounds)H=+e.vertexIntensityBounds[0],G=+e.vertexIntensityBounds[1];else for(var Y=0,W;Y<N.length;++Y)W=N[Y],H=g(H,W),G=m(G,W);}else if(!U)for(var Y=0,W;Y<l.length;++Y)W=l[Y][2],H=g(H,W),G=m(G,W);else if(e.cellIntensityBounds)H=+e.cellIntensityBounds[0],G=+e.cellIntensityBounds[1];else for(var Y=0,W;Y<U.length;++Y)W=U[Y],H=g(H,W),G=m(G,W);this.intensity=N?N:U?U:n(l),this.pickVertex=!(U||M);var X=e.pointSizes,Z=e.pointSize||1;this.bounds=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]];for(var Y=0,K;Y<l.length;++Y){K=l[Y];for(var $=0;3>$;++$)!isNaN(K[$])&&isFinite(K[$])&&(this.bounds[0][$]=g(this.bounds[0][$],K[$]),this.bounds[1][$]=m(this.bounds[1][$],K[$]))}var J=0,Q=0,ee=0;fill_loop:for(var Y=0,te;Y<a.length;++Y)switch(te=a[Y],te.length){case 1:for(var ae=te[0],K=l[ae],$=0;3>$;++$)if(isNaN(K[$])||!isFinite(K[$]))continue fill_loop;S.push(K[0],K[1],K[2]);var oe;oe=R?R[ae]:M?M[Y]:B,this.opacityscale&&N?d.push(oe[0],oe[1],oe[2],this.opacity*o((N[ae]-H)/(G-H),this.opacityscale)):3===oe.length?C.push(oe[0],oe[1],oe[2],this.opacity):(C.push(oe[0],oe[1],oe[2],oe[3]*this.opacity),1>oe[3]&&(this.hasAlpha=!0));var re;re=F?F[ae]:N?[(N[ae]-H)/(G-H),0]:V?V[Y]:U?[(U[Y]-H)/(G-H),0]:[(K[2]-H)/(G-H),0],L.push(re[0],re[1]),X?E.push(X[ae]):E.push(Z),I.push(Y),ee+=1;break;case 2:for(var $=0;2>$;++$)for(var ae=te[$],K=l[ae],ie=0;3>ie;++ie)if(isNaN(K[ie])||!isFinite(K[ie]))continue fill_loop;for(var $=0;2>$;++$){var ae=te[$],K=l[ae];b.push(K[0],K[1],K[2]);var oe;oe=R?R[ae]:M?M[Y]:B,this.opacityscale&&N?d.push(oe[0],oe[1],oe[2],this.opacity*o((N[ae]-H)/(G-H),this.opacityscale)):3===oe.length?w.push(oe[0],oe[1],oe[2],this.opacity):(w.push(oe[0],oe[1],oe[2],oe[3]*this.opacity),1>oe[3]&&(this.hasAlpha=!0));var re;re=F?F[ae]:N?[(N[ae]-H)/(G-H),0]:V?V[Y]:U?[(U[Y]-H)/(G-H),0]:[(K[2]-H)/(G-H),0],T.push(re[0],re[1]),A.push(Y)}Q+=1;break;case 3:for(var $=0;3>$;++$)for(var ae=te[$],K=l[ae],ie=0;3>ie;++ie)if(isNaN(K[ie])||!isFinite(K[ie]))continue fill_loop;for(var $=0;3>$;++$){var ae=te[2-$],K=l[ae];s.push(K[0],K[1],K[2]);var oe;oe=R?R[ae]:M?M[Y]:B,oe?this.opacityscale&&N?d.push(oe[0],oe[1],oe[2],this.opacity*o((N[ae]-H)/(G-H),this.opacityscale)):3===oe.length?d.push(oe[0],oe[1],oe[2],this.opacity):(d.push(oe[0],oe[1],oe[2],oe[3]*this.opacity),1>oe[3]&&(this.hasAlpha=!0)):d.push(.5,.5,.5,1);var re;re=F?F[ae]:N?[(N[ae]-H)/(G-H),0]:V?V[Y]:U?[(U[Y]-H)/(G-H),0]:[(K[2]-H)/(G-H),0],h.push(re[0],re[1]);var ne;ne=P?P[ae]:z[Y],u.push(ne[0],ne[1],ne[2]),y.push(Y)}J+=1;break;default:}this.pointCount=ee,this.edgeCount=Q,this.triangleCount=J,this.pointPositions.update(S),this.pointColors.update(C),this.pointUVs.update(L),this.pointSizes.update(E),this.pointIds.update(new Uint32Array(I)),this.edgePositions.update(b),this.edgeColors.update(w),this.edgeUVs.update(T),this.edgeIds.update(new Uint32Array(A)),this.trianglePositions.update(s),this.triangleColors.update(d),this.triangleUVs.update(h),this.triangleNormals.update(u),this.triangleIds.update(new Uint32Array(y))}},M.drawTransparent=M.draw=function(e){e=e||{};for(var t=this.gl,a=e.model||R,o=e.view||R,r=e.projection||R,n=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],l=0;3>l;++l)n[0][l]=m(n[0][l],this.clipBounds[0][l]),n[1][l]=g(n[1][l],this.clipBounds[1][l]);var d={model:a,view:o,projection:r,inverseModel:R.slice(),clipBounds:n,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],contourColor:this.contourColor,texture:0};d.inverseModel=v(d.inverseModel,d.model),t.disable(t.CULL_FACE),this.texture.bind(0);var c=Array(16);b(c,d.view,d.model),b(c,d.projection,c),v(c,c);for(var l=0;3>l;++l)d.eyePosition[l]=c[12+l]/c[15];for(var p=c[15],l=0;3>l;++l)p+=this.lightPosition[l]*c[4*l+3];for(var l=0,u;3>l;++l){u=c[12+l];for(var h=0;3>h;++h)u+=c[4*h+l]*this.lightPosition[h];d.lightPosition[l]=u/p}if(0<this.triangleCount){var y=this.triShader;y.bind(),y.uniforms=d,this.triangleVAO.bind(),t.drawArrays(t.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()}if(0<this.edgeCount&&0<this.lineWidth){var y=this.lineShader;y.bind(),y.uniforms=d,this.edgeVAO.bind(),t.lineWidth(this.lineWidth*this.pixelRatio),t.drawArrays(t.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()}if(0<this.pointCount){var y=this.pointShader;y.bind(),y.uniforms=d,this.pointVAO.bind(),t.drawArrays(t.POINTS,0,this.pointCount),this.pointVAO.unbind()}if(this.contourEnable&&0<this.contourCount&&0<this.contourLineWidth){var y=this.contourShader;y.bind(),y.uniforms=d,this.contourVAO.bind(),t.drawArrays(t.LINES,0,this.contourCount),this.contourVAO.unbind()}},M.drawPick=function(e){e=e||{};for(var t=this.gl,a=e.model||R,o=e.view||R,r=e.projection||R,n=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],l=0;3>l;++l)n[0][l]=m(n[0][l],this.clipBounds[0][l]),n[1][l]=g(n[1][l],this.clipBounds[1][l]);this._model=[].slice.call(a),this._view=[].slice.call(o),this._projection=[].slice.call(r),this._resolution=[t.drawingBufferWidth,t.drawingBufferHeight];var s={model:a,view:o,projection:r,clipBounds:n,pickId:this.pickId/255},d=this.pickShader;if(d.bind(),d.uniforms=s,0<this.triangleCount&&(this.triangleVAO.bind(),t.drawArrays(t.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),0<this.edgeCount&&(this.edgeVAO.bind(),t.lineWidth(this.lineWidth*this.pixelRatio),t.drawArrays(t.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),0<this.pointCount){var d=this.pointPickShader;d.bind(),d.uniforms=s,this.pointVAO.bind(),t.drawArrays(t.POINTS,0,this.pointCount),this.pointVAO.unbind()}},M.pick=function(e){if(!e)return null;if(e.id!==this.pickId)return null;for(var t=e.value[0]+256*e.value[1]+65536*e.value[2],a=this.cells[t],o=this.positions,r=Array(a.length),n=0;n<a.length;++n)r[n]=o[a[n]];var l=e.coord[0],s=e.coord[1];if(!this.pickVertex){var d=this.positions[a[0]],c=this.positions[a[1]],p=this.positions[a[2]],u=[(d[0]+c[0]+p[0])/3,(d[1]+c[1]+p[1])/3,(d[2]+c[2]+p[2])/3];return{_cellCenter:!0,position:[l,s],index:t,cell:a,cellId:t,intensity:this.intensity[t],dataCoordinate:u}}var g=L(r,[l*this.pixelRatio,this._resolution[1]-s*this.pixelRatio],this._model,this._view,this._projection,this._resolution);if(!g)return null;for(var m=g[2],h=0,n=0;n<a.length;++n)h+=m[n]*this.intensity[a[n]];return{position:g[1],index:a[g[0]],cell:a,cellId:t,intensity:h,dataCoordinate:this.positions[a[g[0]]]}},M.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.lineShader.dispose(),this.pointShader.dispose(),this.pickShader.dispose(),this.pointPickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleNormals.dispose(),this.triangleIds.dispose(),this.edgeVAO.dispose(),this.edgePositions.dispose(),this.edgeColors.dispose(),this.edgeUVs.dispose(),this.edgeIds.dispose(),this.pointVAO.dispose(),this.pointPositions.dispose(),this.pointColors.dispose(),this.pointUVs.dispose(),this.pointSizes.dispose(),this.pointIds.dispose(),this.contourVAO.dispose(),this.contourPositions.dispose(),this.contourShader.dispose()},t.exports=function(e,t){1===arguments.length&&(t=e,e=t.gl);var o=e.getExtension("OES_standard_derivatives")||e.getExtension("MOZ_OES_standard_derivatives")||e.getExtension("WEBKIT_OES_standard_derivatives");if(!o)throw new Error("derivatives not supported");var r=l(e),i=s(e),n=d(e),g=c(e),m=p(e),h=u(e),_=x(e,w(new Uint8Array([255,255,255,255]),[1,1,4]));_.generateMipmap(),_.minFilter=e.LINEAR_MIPMAP_LINEAR,_.magFilter=e.LINEAR;var b=y(e),v=y(e),k=y(e),T=y(e),A=y(e),S=f(e,[{buffer:b,type:e.FLOAT,size:3},{buffer:A,type:e.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:v,type:e.FLOAT,size:4},{buffer:k,type:e.FLOAT,size:2},{buffer:T,type:e.FLOAT,size:3}]),C=y(e),L=y(e),E=y(e),I=y(e),P=f(e,[{buffer:C,type:e.FLOAT,size:3},{buffer:I,type:e.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:L,type:e.FLOAT,size:4},{buffer:E,type:e.FLOAT,size:2}]),z=y(e),D=y(e),O=y(e),R=y(e),M=y(e),j=f(e,[{buffer:z,type:e.FLOAT,size:3},{buffer:M,type:e.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:D,type:e.FLOAT,size:4},{buffer:O,type:e.FLOAT,size:2},{buffer:R,type:e.FLOAT,size:1}]),B=y(e),F=f(e,[{buffer:B,type:e.FLOAT,size:3}]),N=new a(e,_,r,i,n,g,m,h,b,A,v,k,T,S,C,I,L,E,P,z,M,D,O,R,j,B,F);return N.update(t),N}},{"./lib/closest-point":255,"./lib/shaders":256,colormap:73,"gl-buffer":220,"gl-mat4/invert":242,"gl-mat4/multiply":244,"gl-shader":277,"gl-texture2d":292,"gl-vao":297,ndarray:425,normals:437,"simplicial-complex-contour":1289,"typedarray-pool":1328}],258:[function(e,t){'use strict';function a(e,t,a){this.plot=e,this.vbo=t,this.shader=a}t.exports=function(e){var t=e.gl,n=o(t,[0,0,0,1,1,0,1,1]),l=r(t,i.boxVert,i.lineFrag);return new a(e,n,l)};var o=e("gl-buffer"),r=e("gl-shader"),i=e("./shaders"),n=a.prototype;n.bind=function(){var e=this.shader;this.vbo.bind(),this.shader.bind(),e.attributes.coord.pointer(),e.uniforms.screenBox=this.plot.screenBox},n.drawBox=function(){var e=[0,0],t=[0,0];return function(a,o,r,i,n){var l=this.plot,s=this.shader,d=l.gl;e[0]=a,e[1]=o,t[0]=r,t[1]=i,s.uniforms.lo=e,s.uniforms.hi=t,s.uniforms.color=n,d.drawArrays(d.TRIANGLE_STRIP,0,4)}}(),n.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":261,"gl-buffer":220,"gl-shader":277}],259:[function(e,t){'use strict';var r=Math.min,n=Math.max;function a(e,t,a,o){this.plot=e,this.vbo=t,this.shader=a,this.tickShader=o,this.ticks=[[],[]]}function o(e,t){return e-t}t.exports=function(e){var t=e.gl,o=l(t),r=s(t,c.gridVert,c.gridFrag),i=s(t,c.tickVert,c.gridFrag),n=new a(e,o,r,i);return n};var l=e("gl-buffer"),s=e("gl-shader"),d=e("binary-search-bounds"),c=e("./shaders"),p=a.prototype;p.draw=function(){var e=[0,0],t=[0,0],a=[0,0];return function(){for(var o=this.plot,r=this.vbo,n=this.shader,l=this.ticks,s=o.gl,d=o._tickBounds,c=o.dataBox,p=o.viewBox,u=o.gridLineWidth,g=o.gridLineColor,m=o.gridLineEnable,h=o.pixelRatio,y=0;2>y;++y){var f=d[y],x=d[y+2],_=.5*(c[y+2]+c[y]),b=c[y+2]-c[y];t[y]=2*(x-f)/b,e[y]=2*(f-_)/b}n.bind(),r.bind(),n.attributes.dataCoord.pointer(),n.uniforms.dataShift=e,n.uniforms.dataScale=t;for(var v=0,y=0;2>y;++y){a[0]=a[1]=0,a[y]=1,n.uniforms.dataAxis=a,n.uniforms.lineWidth=u[y]/(p[y+2]-p[y])*h,n.uniforms.color=g[y];var w=6*l[y].length;m[y]&&w&&s.drawArrays(s.TRIANGLES,v,w),v+=w}}}(),p.drawTickMarks=function(){var e=[0,0],t=[0,0],a=[1,0],l=[0,1],s=[0,0],c=[0,0];return function(){for(var p=this.plot,u=this.vbo,g=this.tickShader,m=this.ticks,h=p.gl,y=p._tickBounds,f=p.dataBox,x=p.viewBox,_=p.pixelRatio,b=p.screenBox,v=b[2]-b[0],w=b[3]-b[1],k=x[2]-x[0],T=x[3]-x[1],A=0;2>A;++A){var S=y[A],C=y[A+2],L=.5*(f[A+2]+f[A]),E=f[A+2]-f[A];t[A]=2*(C-S)/E,e[A]=2*(S-L)/E}t[0]*=k/v,e[0]*=k/v,t[1]*=T/w,e[1]*=T/w,g.bind(),u.bind(),g.attributes.dataCoord.pointer();var I=g.uniforms;I.dataShift=e,I.dataScale=t;var P=p.tickMarkLength,z=p.tickMarkWidth,D=p.tickMarkColor,O=6*m[0].length,R=r(d.ge(m[0],(f[0]-y[0])/(y[2]-y[0]),o),m[0].length),M=r(d.gt(m[0],(f[2]-y[0])/(y[2]-y[0]),o),m[0].length),j=0+6*R,B=6*n(0,M-R),F=r(d.ge(m[1],(f[1]-y[1])/(y[3]-y[1]),o),m[1].length),N=r(d.gt(m[1],(f[3]-y[1])/(y[3]-y[1]),o),m[1].length),V=O+6*F,U=6*n(0,N-F);s[0]=2*(x[0]-P[1])/v-1,s[1]=(x[3]+x[1])/w-1,c[0]=P[1]*_/v,c[1]=z[1]*_/w,U&&(I.color=D[1],I.tickScale=c,I.dataAxis=l,I.screenOffset=s,h.drawArrays(h.TRIANGLES,V,U)),s[0]=(x[2]+x[0])/v-1,s[1]=2*(x[1]-P[0])/w-1,c[0]=z[0]*_/v,c[1]=P[0]*_/w,B&&(I.color=D[0],I.tickScale=c,I.dataAxis=a,I.screenOffset=s,h.drawArrays(h.TRIANGLES,j,B)),s[0]=2*(x[2]+P[3])/v-1,s[1]=(x[3]+x[1])/w-1,c[0]=P[3]*_/v,c[1]=z[3]*_/w,U&&(I.color=D[3],I.tickScale=c,I.dataAxis=l,I.screenOffset=s,h.drawArrays(h.TRIANGLES,V,U)),s[0]=(x[2]+x[0])/v-1,s[1]=2*(x[3]+P[2])/w-1,c[0]=z[2]*_/v,c[1]=P[2]*_/w,B&&(I.color=D[2],I.tickScale=c,I.dataAxis=a,I.screenOffset=s,h.drawArrays(h.TRIANGLES,j,B))}}(),p.update=function(){var e=[1,1,-1,-1,1,-1],t=[1,-1,1,1,-1,-1];return function(a){for(var o=a.ticks,r=a.bounds,n=new Float32Array(18*(o[0].length+o[1].length)),l=this.plot.zeroLineEnable,s=0,d=[[],[]],c=0;2>c;++c)for(var p=d[c],u=o[c],g=r[c],m=r[c+2],h=0,y;h<u.length;++h){y=(u[h].x-g)/(m-g),p.push(y);for(var f=0;6>f;++f)n[s++]=y,n[s++]=e[f],n[s++]=t[f]}this.ticks=d,this.vbo.update(n)}}(),p.dispose=function(){this.vbo.dispose(),this.shader.dispose(),this.tickShader.dispose()}},{"./shaders":261,"binary-search-bounds":42,"gl-buffer":220,"gl-shader":277}],260:[function(e,t){'use strict';function a(e,t,a){this.plot=e,this.vbo=t,this.shader=a}t.exports=function(e){var t=e.gl,n=o(t,[-1,-1,-1,1,1,-1,1,1]),l=r(t,i.lineVert,i.lineFrag),s=new a(e,n,l);return s};var o=e("gl-buffer"),r=e("gl-shader"),i=e("./shaders"),n=a.prototype;n.bind=function(){var e=this.shader;this.vbo.bind(),this.shader.bind(),e.attributes.coord.pointer(),e.uniforms.screenBox=this.plot.screenBox},n.drawLine=function(){var e=[0,0],t=[0,0];return function(a,o,r,i,n,l){var s=this.plot,d=this.shader,c=s.gl;e[0]=a,e[1]=o,t[0]=r,t[1]=i,d.uniforms.start=e,d.uniforms.end=t,d.uniforms.width=n*s.pixelRatio,d.uniforms.color=l,c.drawArrays(c.TRIANGLE_STRIP,0,4)}}(),n.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":261,"gl-buffer":220,"gl-shader":277}],261:[function(e,t){'use strict';var a=e("glslify"),o=a(["precision lowp float;\n#define GLSLIFY 1\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = vec4(color.xyz * color.w, color.w);\n}\n"]);t.exports={lineVert:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 coord;\n\nuniform vec4 screenBox;\nuniform vec2 start, end;\nuniform float width;\n\nvec2 perp(vec2 v) {\n  return vec2(v.y, -v.x);\n}\n\nvec2 screen(vec2 v) {\n  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;\n}\n\nvoid main() {\n  vec2 delta = normalize(perp(start - end));\n  vec2 offset = mix(start, end, 0.5 * (coord.y+1.0));\n  gl_Position = vec4(screen(offset + 0.5 * width * delta * coord.x), 0, 1);\n}\n"]),lineFrag:o,textVert:a(["#define GLSLIFY 1\nattribute vec3 textCoordinate;\n\nuniform vec2 dataScale, dataShift, dataAxis, screenOffset, textScale;\nuniform float angle;\n\nvoid main() {\n  float dataOffset  = textCoordinate.z;\n  vec2 glyphOffset  = textCoordinate.xy;\n  mat2 glyphMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n  vec2 screenCoordinate = dataAxis * (dataScale * dataOffset + dataShift) +\n    glyphMatrix * glyphOffset * textScale + screenOffset;\n  gl_Position = vec4(screenCoordinate, 0, 1);\n}\n"]),textFrag:o,gridVert:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 dataCoord;\n\nuniform vec2 dataAxis, dataShift, dataScale;\nuniform float lineWidth;\n\nvoid main() {\n  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);\n  pos += 10.0 * dataCoord.y * vec2(dataAxis.y, -dataAxis.x) + dataCoord.z * lineWidth;\n  gl_Position = vec4(pos, 0, 1);\n}\n"]),gridFrag:o,boxVert:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 coord;\n\nuniform vec4 screenBox;\nuniform vec2 lo, hi;\n\nvec2 screen(vec2 v) {\n  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;\n}\n\nvoid main() {\n  gl_Position = vec4(screen(mix(lo, hi, coord)), 0, 1);\n}\n"]),tickVert:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 dataCoord;\n\nuniform vec2 dataAxis, dataShift, dataScale, screenOffset, tickScale;\n\nvoid main() {\n  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);\n  gl_Position = vec4(pos + tickScale*dataCoord.yz + screenOffset, 0, 1);\n}\n"])}},{glslify:378}],262:[function(e,t){'use strict';var o=Math.floor;function a(e,t,a){this.plot=e,this.vbo=t,this.shader=a,this.tickOffset=[[],[]],this.tickX=[[],[]],this.labelOffset=[0,0],this.labelCount=[0,0]}t.exports=function(e){var t=e.gl,o=r(t),n=i(t,s.textVert,s.textFrag),l=new a(e,o,n);return l};var r=e("gl-buffer"),i=e("gl-shader"),n=e("text-cache"),l=e("binary-search-bounds"),s=e("./shaders"),d=a.prototype;d.drawTicks=function(){var e=[0,0],t=[0,0],a=[0,0];return function(o){var r=this.plot,i=this.shader,n=this.tickX[o],s=this.tickOffset[o],d=r.gl,c=r.viewBox,p=r.dataBox,u=r.screenBox,g=r.pixelRatio,m=r.tickEnable,h=r.tickPad,y=r.tickColor,f=r.tickAngle,x=r.labelEnable,_=r.labelPad,b=r.labelColor,v=r.labelAngle,w=this.labelOffset[o],k=this.labelCount[o],T=l.lt(n,p[o]),A=l.le(n,p[o+2]);e[0]=e[1]=0,e[o]=1,t[o]=(c[2+o]+c[o])/(u[2+o]-u[o])-1;var S=2/u[2+(1^o)]-u[1^o];t[1^o]=S*c[1^o]-1,m[o]&&(t[1^o]-=S*g*h[o],T<A&&s[A]>s[T]&&(i.uniforms.dataAxis=e,i.uniforms.screenOffset=t,i.uniforms.color=y[o],i.uniforms.angle=f[o],d.drawArrays(d.TRIANGLES,s[T],s[A]-s[T]))),x[o]&&k&&(t[1^o]-=S*g*_[o],i.uniforms.dataAxis=a,i.uniforms.screenOffset=t,i.uniforms.color=b[o],i.uniforms.angle=v[o],d.drawArrays(d.TRIANGLES,w,k)),t[1^o]=S*c[2+(1^o)]-1,m[o+2]&&(t[1^o]+=S*g*h[o+2],T<A&&s[A]>s[T]&&(i.uniforms.dataAxis=e,i.uniforms.screenOffset=t,i.uniforms.color=y[o+2],i.uniforms.angle=f[o+2],d.drawArrays(d.TRIANGLES,s[T],s[A]-s[T]))),x[o+2]&&k&&(t[1^o]+=S*g*_[o+2],i.uniforms.dataAxis=a,i.uniforms.screenOffset=t,i.uniforms.color=b[o+2],i.uniforms.angle=v[o+2],d.drawArrays(d.TRIANGLES,w,k))}}(),d.drawTitle=function(){var e=[0,0],t=[0,0];return function(){var a=this.plot,o=this.shader,r=a.gl,n=a.screenBox,l=a.titleCenter,s=a.titleAngle,d=a.titleColor,c=a.pixelRatio;if(this.titleCount){for(var p=0;2>p;++p)t[p]=2*(l[p]*c-n[p])/(n[2+p]-n[p])-1;o.bind(),o.uniforms.dataAxis=e,o.uniforms.screenOffset=t,o.uniforms.angle=s,o.uniforms.color=d,r.drawArrays(r.TRIANGLES,this.titleOffset,this.titleCount)}}}(),d.bind=function(){var e=[0,0],t=[0,0],a=[0,0];return function(){var o=this.plot,r=this.shader,n=o._tickBounds,l=o.dataBox,s=o.screenBox,d=o.viewBox;r.bind();for(var c=0;2>c;++c){var p=n[c],u=n[c+2],g=.5*(l[c+2]+l[c]),m=l[c+2]-l[c],h=d[c],y=d[c+2],f=y-h,x=s[c],_=s[c+2],b=_-x;t[c]=2*(u-p)/m*f/b,e[c]=2*(p-g)/m*f/b}a[1]=2*o.pixelRatio/(s[3]-s[1]),a[0]=a[1]*(s[3]-s[1])/(s[2]-s[0]),r.uniforms.dataScale=t,r.uniforms.dataShift=e,r.uniforms.textScale=a,this.vbo.bind(),r.attributes.textCoordinate.pointer()}}(),d.update=function(e){var t=[],a=e.ticks,l=e.bounds,s,d,c,p,u;for(u=0;2>u;++u){var g=[o(t.length/3)],m=[-Infinity],h=a[u];for(s=0;s<h.length;++s){var y=h[s],f=y.x,x=y.text,_=y.font||"sans-serif";p=y.fontSize||12;for(var b=1/(l[u+2]-l[u]),v=l[u],w=x.split("\n"),k=0;k<w.length;k++)for(c=n(_,w[k]).data,d=0;d<c.length;d+=2)t.push(c[d]*p,-c[d+1]*p-1.2*(k*p),(f-v)*b);g.push(o(t.length/3)),m.push(f)}this.tickOffset[u]=g,this.tickX[u]=m}for(u=0;2>u;++u){for(this.labelOffset[u]=o(t.length/3),c=n(e.labelFont[u],e.labels[u],{textAlign:"center"}).data,p=e.labelSize[u],s=0;s<c.length;s+=2)t.push(c[s]*p,-c[s+1]*p,0);this.labelCount[u]=o(t.length/3)-this.labelOffset[u]}for(this.titleOffset=o(t.length/3),c=n(e.titleFont,e.title).data,p=e.titleSize,s=0;s<c.length;s+=2)t.push(c[s]*p,-c[s+1]*p,0);this.titleCount=o(t.length/3)-this.titleOffset,this.vbo.update(t)},d.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":261,"binary-search-bounds":42,"gl-buffer":220,"gl-shader":277,"text-cache":1308}],263:[function(e,t){'use strict';var n=Math.round,l=Math.PI,s=Math.min,d=Math.max;function a(e,t){this.gl=e,this.pickBuffer=t,this.screenBox=[0,0,e.drawingBufferWidth,e.drawingBufferHeight],this.viewBox=[0,0,0,0],this.dataBox=[-10,-10,10,10],this.gridLineEnable=[!0,!0],this.gridLineWidth=[1,1],this.gridLineColor=[[0,0,0,1],[0,0,0,1]],this.pixelRatio=1,this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickEnable=[!0,!0,!0,!0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[15,15,15,15],this.labelAngle=[0,l/2,0,3*l/2],this.labelEnable=[!0,!0,!0,!0],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.titleCenter=[0,0],this.titleEnable=!0,this.titleAngle=0,this.titleColor=[0,0,0,1],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[4,4],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderLineEnable=[!0,!0,!0,!0],this.borderLineWidth=[2,2,2,2],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.grid=null,this.text=null,this.line=null,this.box=null,this.objects=[],this.overlays=[],this._tickBounds=[1/0,1/0,-Infinity,-Infinity],this.static=!1,this.dirty=!1,this.pickDirty=!1,this.pickDelay=120,this.pickRadius=10,this._pickTimeout=null,this._drawPick=this.drawPick.bind(this),this._depthCounter=0}function o(e){for(var t=e.slice(),a=0;a<t.length;++a)t[a]=t[a].slice();return t}function r(e,t){return e.x-t.x}t.exports=function(e){var t=e.gl,o=c(t,[t.drawingBufferWidth,t.drawingBufferHeight]),r=new a(t,o);return r.grid=p(r),r.text=u(r),r.line=g(r),r.box=m(r),r.update(e),r};var c=e("gl-select-static"),p=e("./lib/grid"),u=e("./lib/text"),g=e("./lib/line"),m=e("./lib/box"),h=a.prototype;h.setDirty=function(){this.dirty=this.pickDirty=!0},h.setOverlayDirty=function(){this.dirty=!0},h.nextDepthValue=function(){return this._depthCounter++/65536},h.draw=function(){return function(){var e=this.gl,t=this.screenBox,a=this.viewBox,o=this.dataBox,r=this.pixelRatio,n=this.grid,l=this.line,s=this.text,d=this.objects;if(this._depthCounter=0,this.pickDirty&&(this._pickTimeout&&clearTimeout(this._pickTimeout),this.pickDirty=!1,this._pickTimeout=setTimeout(this._drawPick,this.pickDelay)),!!this.dirty){if(this.dirty=!1,e.bindFramebuffer(e.FRAMEBUFFER,null),e.enable(e.SCISSOR_TEST),e.disable(e.DEPTH_TEST),e.depthFunc(e.LESS),e.depthMask(!1),e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD,e.FUNC_ADD),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),this.borderColor){e.scissor(t[0],t[1],t[2]-t[0],t[3]-t[1]);var c=this.borderColor;e.clearColor(c[0]*c[3],c[1]*c[3],c[2]*c[3],c[3]),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}e.scissor(a[0],a[1],a[2]-a[0],a[3]-a[1]),e.viewport(a[0],a[1],a[2]-a[0],a[3]-a[1]);var p=this.backgroundColor;e.clearColor(p[0]*p[3],p[1]*p[3],p[2]*p[3],p[3]),e.clear(e.COLOR_BUFFER_BIT),n.draw();var u=this.zeroLineEnable,g=this.zeroLineColor,m=this.zeroLineWidth;if(u[0]||u[1]){l.bind();for(var h=0;2>h;++h)if(u[h]&&0>=o[h]&&0<=o[h+2]){var y=t[h]-o[h]*(t[h+2]-t[h])/(o[h+2]-o[h]);0==h?l.drawLine(y,t[1],y,t[3],m[h],g[h]):l.drawLine(t[0],y,t[2],y,m[h],g[h])}}for(var h=0;h<d.length;++h)d[h].draw();e.viewport(t[0],t[1],t[2]-t[0],t[3]-t[1]),e.scissor(t[0],t[1],t[2]-t[0],t[3]-t[1]),this.grid.drawTickMarks(),l.bind();var f=this.borderLineEnable,x=this.borderLineWidth,_=this.borderLineColor;f[1]&&l.drawLine(a[0],a[1]-.5*x[1]*r,a[0],a[3]+.5*x[3]*r,x[1],_[1]),f[0]&&l.drawLine(a[0]-.5*x[0]*r,a[1],a[2]+.5*x[2]*r,a[1],x[0],_[0]),f[3]&&l.drawLine(a[2],a[1]-.5*x[1]*r,a[2],a[3]+.5*x[3]*r,x[3],_[3]),f[2]&&l.drawLine(a[0]-.5*x[0]*r,a[3],a[2]+.5*x[2]*r,a[3],x[2],_[2]),s.bind();for(var h=0;2>h;++h)s.drawTicks(h);this.titleEnable&&s.drawTitle();for(var b=this.overlays,h=0;h<b.length;++h)b[h].draw();e.disable(e.SCISSOR_TEST),e.disable(e.BLEND),e.depthMask(!0)}}}(),h.drawPick=function(){return function(){if(!this.static){var e=this.pickBuffer,t=this.gl;this._pickTimeout=null,e.begin();for(var a=1,o=this.objects,r=0;r<o.length;++r)a=o[r].drawPick(a);e.end()}}}(),h.pick=function(){return function(e,t){if(!this.static){var a=this.pixelRatio,o=this.pickPixelRatio,r=this.viewBox,l=0|n((e-r[0]/a)*o),s=0|n((t-r[1]/a)*o),d=this.pickBuffer.query(l,s,this.pickRadius);if(!d)return null;for(var c=d.id+(d.value[0]<<8)+(d.value[1]<<16)+(d.value[2]<<24),p=this.objects,u=0,g;u<p.length;++u)if(g=p[u].pick(l,s,c),g)return g;return null}}}(),h.setScreenBox=function(e){var t=this.screenBox,a=this.pixelRatio;t[0]=0|n(e[0]*a),t[1]=0|n(e[1]*a),t[2]=0|n(e[2]*a),t[3]=0|n(e[3]*a),this.setDirty()},h.setDataBox=function(e){var t=this.dataBox,a=t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3];a&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],this.setDirty())},h.setViewBox=function(e){var t=this.pixelRatio,a=this.viewBox;a[0]=0|n(e[0]*t),a[1]=0|n(e[1]*t),a[2]=0|n(e[2]*t),a[3]=0|n(e[3]*t);var o=this.pickPixelRatio;this.pickBuffer.shape=[0|n((e[2]-e[0])*o),0|n((e[3]-e[1])*o)],this.setDirty()},h.update=function(e){e=e||{};var t=this.gl;this.pixelRatio=e.pixelRatio||1;var a=this.pixelRatio;this.pickPixelRatio=d(a,1),this.setScreenBox(e.screenBox||[0,0,t.drawingBufferWidth/a,t.drawingBufferHeight/a]);this.screenBox;this.setViewBox(e.viewBox||[.125*(this.screenBox[2]-this.screenBox[0])/a,.125*(this.screenBox[3]-this.screenBox[1])/a,.875*(this.screenBox[2]-this.screenBox[0])/a,.875*(this.screenBox[3]-this.screenBox[1])/a]);var n=this.viewBox,c=(n[2]-n[0])/(n[3]-n[1]);this.setDataBox(e.dataBox||[-10,-10/c,10,10/c]),this.borderColor=!1!==e.borderColor&&(e.borderColor||[0,0,0,0]).slice(),this.backgroundColor=(e.backgroundColor||[0,0,0,0]).slice(),this.gridLineEnable=(e.gridLineEnable||[!0,!0]).slice(),this.gridLineWidth=(e.gridLineWidth||[1,1]).slice(),this.gridLineColor=o(e.gridLineColor||[[.5,.5,.5,1],[.5,.5,.5,1]]),this.zeroLineEnable=(e.zeroLineEnable||[!0,!0]).slice(),this.zeroLineWidth=(e.zeroLineWidth||[4,4]).slice(),this.zeroLineColor=o(e.zeroLineColor||[[0,0,0,1],[0,0,0,1]]),this.tickMarkLength=(e.tickMarkLength||[0,0,0,0]).slice(),this.tickMarkWidth=(e.tickMarkWidth||[0,0,0,0]).slice(),this.tickMarkColor=o(e.tickMarkColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.titleCenter=(e.titleCenter||[.5*(n[0]+n[2])/a,(n[3]+120)/a]).slice(),this.titleEnable=!("titleEnable"in e)||!!e.titleEnable,this.titleAngle=e.titleAngle||0,this.titleColor=(e.titleColor||[0,0,0,1]).slice(),this.labelPad=(e.labelPad||[15,15,15,15]).slice(),this.labelAngle=(e.labelAngle||[0,l/2,0,3*l/2]).slice(),this.labelEnable=(e.labelEnable||[!0,!0,!0,!0]).slice(),this.labelColor=o(e.labelColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.tickPad=(e.tickPad||[15,15,15,15]).slice(),this.tickAngle=(e.tickAngle||[0,0,0,0]).slice(),this.tickEnable=(e.tickEnable||[!0,!0,!0,!0]).slice(),this.tickColor=o(e.tickColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.borderLineEnable=(e.borderLineEnable||[!0,!0,!0,!0]).slice(),this.borderLineWidth=(e.borderLineWidth||[2,2,2,2]).slice(),this.borderLineColor=o(e.borderLineColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);var p=e.ticks||[[],[]],u=this._tickBounds;u[0]=u[1]=1/0,u[2]=u[3]=-Infinity;for(var g=0,m;2>g;++g)(m=p[g].slice(0),0!==m.length)&&(m.sort(r),u[g]=s(u[g],m[0].x),u[g+2]=d(u[g+2],m[m.length-1].x));this.grid.update({bounds:u,ticks:p}),this.text.update({bounds:u,ticks:p,labels:e.labels||["x","y"],labelSize:e.labelSize||[12,12],labelFont:e.labelFont||["sans-serif","sans-serif"],title:e.title||"",titleSize:e.titleSize||18,titleFont:e.titleFont||"sans-serif"}),this.static=!!e.static,this.setDirty()},h.dispose=function(){this.box.dispose(),this.grid.dispose(),this.text.dispose(),this.line.dispose();for(var e=this.objects.length-1;0<=e;--e)this.objects[e].dispose();this.objects.length=0;for(var e=this.overlays.length-1;0<=e;--e)this.overlays[e].dispose();this.overlays.length=0,this.gl=null},h.addObject=function(e){0>this.objects.indexOf(e)&&(this.objects.push(e),this.setDirty())},h.removeObject=function(e){for(var t=this.objects,a=0;a<t.length;++a)if(t[a]===e){t.splice(a,1),this.setDirty();break}},h.addOverlay=function(e){0>this.overlays.indexOf(e)&&(this.overlays.push(e),this.setOverlayDirty())},h.removeOverlay=function(e){for(var t=this.overlays,a=0;a<t.length;++a)if(t[a]===e){t.splice(a,1),this.setOverlayDirty();break}}},{"./lib/box":258,"./lib/grid":259,"./lib/line":260,"./lib/text":262,"gl-select-static":276}],264:[function(e,t){'use strict';var o=Math.exp,r=Math.PI,i=Math.abs;function a(e,t){e=e||document.body,t=t||{};var a=[.01,1/0];"distanceLimits"in t&&(a[0]=t.distanceLimits[0],a[1]=t.distanceLimits[1]),"zoomMin"in t&&(a[0]=t.zoomMin),"zoomMax"in t&&(a[1]=t.zoomMax);var u=l({center:t.center||[0,0,0],up:t.up||[0,1,0],eye:t.eye||[0,0,10],mode:t.mode||"orbit",distanceLimits:a}),g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],m=0,h=e.clientWidth,y=e.clientHeight,f={keyBindingMode:"rotate",enableWheel:!0,view:u,element:e,delay:t.delay||16,rotateSpeed:t.rotateSpeed||1,zoomSpeed:t.zoomSpeed||1,translateSpeed:t.translateSpeed||1,flipX:!!t.flipX,flipY:!!t.flipY,modes:u.modes,_ortho:t._ortho||t.projection&&"orthographic"===t.projection.type||!1,tick:function(){var a=n(),t=this.delay;u.idle(a-t),u.recalcMatrix(a-2*t),u.flush(a-(100+2*t));for(var r=!0,l=u.computedMatrix,s=0;16>s;++s)r=r&&g[s]===l[s],g[s]=l[s];var d=e.clientWidth===h&&e.clientHeight===y;return(h=e.clientWidth,y=e.clientHeight,r)?!d:(m=o(u.computedRadius[0]),!0)},lookAt:function(e,t,a){u.lookAt(u.lastT(),e,t,a)},rotate:function(e,t,a){u.rotate(u.lastT(),e,t,a)},pan:function(e,t,a){u.pan(u.lastT(),e,t,a)},translate:function(e,t,a){u.translate(u.lastT(),e,t,a)}};return Object.defineProperties(f,{matrix:{get:function(){return u.computedMatrix},set:function(e){return u.setMatrix(u.lastT(),e),u.computedMatrix},enumerable:!0},mode:{get:function(){return u.getMode()},set:function(e){var t=u.computedUp.slice(),a=u.computedEye.slice(),o=u.computedCenter.slice();if(u.setMode(e),"turntable"===e){var r=n();u._active.lookAt(r,a,o,t),u._active.lookAt(r+500,a,o,[0,0,1]),u._active.flush(r)}return u.getMode()},enumerable:!0},center:{get:function(){return u.computedCenter},set:function(e){return u.lookAt(u.lastT(),null,e),u.computedCenter},enumerable:!0},eye:{get:function(){return u.computedEye},set:function(e){return u.lookAt(u.lastT(),e),u.computedEye},enumerable:!0},up:{get:function(){return u.computedUp},set:function(e){return u.lookAt(u.lastT(),null,null,e),u.computedUp},enumerable:!0},distance:{get:function(){return m},set:function(e){return u.setDistance(u.lastT(),e),e},enumerable:!0},distanceLimits:{get:function(){return u.getDistanceLimits(a)},set:function(e){return u.setDistanceLimits(e),e},enumerable:!0}}),e.addEventListener("contextmenu",function(e){return e.preventDefault(),!1}),f._lastX=-1,f._lastY=-1,f._lastMods={shift:!1,control:!1,alt:!1,meta:!1},f.enableMouseListeners=function(){function t(a,i,l,s){var d=f.keyBindingMode;if(!1!==d){var c=!!s.control,p=!!s.alt,g=!!s.shift,h=!!(1&a),y=1/e.clientHeight,x=y*(i-f._lastX),_=y*(l-f._lastY),b=f.flipX?1:-1,v=f.flipY?1:-1,w=r*f.rotateSpeed,k=n();if(-1!==f._lastX&&-1!==f._lastY&&((!("rotate"===d)||!h||c||p||g)&&(!h||c||p||!g)||u.rotate(k,b*w*x,-v*w*_,0),("pan"===d&&h&&!c&&!p&&!g||!!(2&a)||h&&c&&!p&&!g)&&u.pan(k,-f.translateSpeed*x*m,f.translateSpeed*_*m,0),"zoom"===d&&h&&!c&&!p&&!g||!!(4&a)||h&&!c&&p&&!g)){var t=100*(-f.zoomSpeed*_/window.innerHeight*(k-u.lastT()));u.pan(k,0,0,m*(o(t)-1))}return f._lastX=i,f._lastY=l,f._lastMods=s,!0}}f.mouseListener=s(e,t),e.addEventListener("touchstart",function(a){var o=c(a.changedTouches[0],e);t(0,o[0],o[1],f._lastMods),t(1,o[0],o[1],f._lastMods),a.preventDefault()},!!p&&{passive:!1}),e.addEventListener("touchmove",function(a){var o=c(a.changedTouches[0],e);t(1,o[0],o[1],f._lastMods),a.preventDefault()},!!p&&{passive:!1}),e.addEventListener("touchend",function(e){t(0,f._lastX,f._lastY,f._lastMods),e.preventDefault()},!!p&&{passive:!1}),f.wheelListener=d(e,function(e,a){if(!1!==f.keyBindingMode&&f.enableWheel){var l=f.flipX?1:-1,s=f.flipY?1:-1,d=n();if(i(e)>i(a))u.rotate(d,0,0,-e*l*r*f.rotateSpeed/window.innerWidth);else if(!f._ortho){var t=-f.zoomSpeed*s*a/window.innerHeight*(d-u.lastT())/20;u.pan(d,0,0,m*(o(t)-1))}}},!0)},f.enableMouseListeners(),f}t.exports=a;var n=e("right-now"),l=e("3d-view"),s=e("mouse-change"),d=e("mouse-wheel"),c=e("mouse-event-offset"),p=e("has-passive-events")},{"3d-view":6,"has-passive-events":380,"mouse-change":410,"mouse-event-offset":411,"mouse-wheel":413,"right-now":1271}],265:[function(e,t){var a=e("glslify"),o=e("gl-shader"),r=a(["precision mediump float;\n#define GLSLIFY 1\nattribute vec2 position;\nvarying vec2 uv;\nvoid main() {\n  uv = position;\n  gl_Position = vec4(position, 0, 1);\n}"]),i=a(["precision mediump float;\n#define GLSLIFY 1\n\nuniform sampler2D accumBuffer;\nvarying vec2 uv;\n\nvoid main() {\n  vec4 accum = texture2D(accumBuffer, 0.5 * (uv + 1.0));\n  gl_FragColor = min(vec4(1,1,1,1), accum);\n}"]);t.exports=function(e){return o(e,r,i,null,[{name:"position",type:"vec2"}])}},{"gl-shader":277,glslify:378}],266:[function(e,t){'use strict';var s=Math.log,d=Math.ceil,c=Math.round,p=Math.PI,u=Math.min,g=Math.pow,m=Math.max;function a(){this.mouse=[-1,-1],this.screen=null,this.distance=1/0,this.index=null,this.dataCoordinate=null,this.dataPosition=null,this.object=null,this.data=null}function o(e,t){var a=null;try{a=e.getContext("webgl",t),a||(a=e.getContext("experimental-webgl",t))}catch(t){return null}return a}function r(e){var t=c(s(Math.abs(e))/s(10));if(0>t){var a=c(g(10,-t));return d(e*a)/a}if(0<t){var a=c(g(10,t));return d(e/a)*a}return d(e)}function i(e){return"boolean"!=typeof e||e}function n(e){function t(){if(!K._stopped&&K.autoResize){var e=T.parentNode,t=1,a=1;e&&e!==document.body?(t=e.clientWidth,a=e.clientHeight):(t=window.innerWidth,a=window.innerHeight);var o=0|d(t*K.pixelRatio),r=0|d(a*K.pixelRatio);if(o!==T.width||r!==T.height){T.width=o,T.height=r;var i=T.style;i.position=i.position||"absolute",i.left="0px",i.top="0px",i.width=t+"px",i.height=a+"px",H=!0}}}function n(){for(var e=F.length,t=U.length,a=0;a<t;++a)V[a]=0;obj_loop:for(var a=0;a<e;++a){var o=F[a],r=o.pickSlots;if(!r){N[a]=-1;continue}for(var n=0;n<t;++n)if(255>V[n]+r){N[a]=n,o.setPickBase(V[n]+1),V[n]+=r;continue obj_loop}var l=_(L,X);N[a]=t,U.push(l),V.push(r),o.setPickBase(1),t+=1}for(;0<t&&0===V[t-1];)V.pop(),U.pop().dispose()}function s(){return!!K.contextLost||void(L.isContextLost()&&(K.contextLost=!0,K.mouseListener.enabled=!1,K.selection.object=null,K.oncontextloss&&K.oncontextloss()))}function c(){if(!s()){L.colorMask(!0,!0,!0,!0),L.depthMask(!0),L.disable(L.BLEND),L.enable(L.DEPTH_TEST),L.depthFunc(L.LEQUAL);for(var e=F.length,t=U.length,a=0,o;a<t;++a){o=U[a],o.shape=$,o.begin();for(var r=0;r<e;++r)if(N[r]===a){var n=F[r];n.drawPick&&(n.pixelRatio=1,n.drawPick(W))}o.end()}}}function g(){if(!s()){t();var e=K.camera.tick();W.view=K.camera.matrix,H=H||e,q=q||e,M.pixelRatio=K.pixelRatio,B.pixelRatio=K.pixelRatio;var a=F.length,o=J[0],n=J[1];o[0]=o[1]=o[2]=1/0,n[0]=n[1]=n[2]=-Infinity;for(var d=0,p;d<a;++d){p=F[d],p.pixelRatio=K.pixelRatio,p.axes=K.axes,H=H||!!p.dirty,q=q||!!p.dirty;var g=p.bounds;if(g)for(var h=g[0],y=g[1],x=0;3>x;++x)o[x]=u(o[x],h[x]),n[x]=m(n[x],y[x])}var _=K.bounds;if(K.autoBounds)for(var x=0;3>x;++x){if(n[x]<o[x])o[x]=-1,n[x]=1;else{o[x]===n[x]&&(o[x]-=1,n[x]+=1);var b=.05*(n[x]-o[x]);o[x]-=b,n[x]+=b}_[0][x]=o[x],_[1][x]=n[x]}for(var w=!1,x=0;3>x;++x)w=w||Q[0][x]!==_[0][x]||Q[1][x]!==_[1][x],Q[0][x]=_[0][x],Q[1][x]=_[1][x];if(q=q||w,H=H||w,!!H){if(w){for(var k=[0,0,0],d=0;3>d;++d)k[d]=r((_[1][d]-_[0][d])/10);M.autoTicks?M.update({bounds:_,tickSpacing:k}):M.update({bounds:_})}var T=L.drawingBufferWidth,A=L.drawingBufferHeight;X[0]=T,X[1]=A,$[0]=0|m(T/K.pixelRatio,1),$[1]=0|m(A/K.pixelRatio,1),l(K,D);for(var d=0,p;d<a;++d)p=F[d],p.axesBounds=_,K.clipToBounds&&(p.clipBounds=_);I.object&&(B.position=K.snapToData?I.dataCoordinate:I.dataPosition,B.bounds=_),q&&(q=!1,c()),K.axesPixels=f(K.axes,W,T,A),K.onrender&&K.onrender(),L.bindFramebuffer(L.FRAMEBUFFER,null),L.viewport(0,0,T,A),K.clearRGBA(),L.depthMask(!0),L.colorMask(!0,!0,!0,!0),L.enable(L.DEPTH_TEST),L.depthFunc(L.LEQUAL),L.disable(L.BLEND),L.disable(L.CULL_FACE);var S=!1;M.enable&&(S=S||M.isTransparent(),M.draw(W)),B.axes=M,I.object&&B.draw(W),L.disable(L.CULL_FACE);for(var d=0,p;d<a;++d)p=F[d],p.axes=M,p.pixelRatio=K.pixelRatio,p.isOpaque&&p.isOpaque()&&p.draw(W),p.isTransparent&&p.isTransparent()&&(S=!0);if(S){P.shape=X,P.bind(),L.clear(L.DEPTH_BUFFER_BIT),L.colorMask(!1,!1,!1,!1),L.depthMask(!0),L.depthFunc(L.LESS),M.enable&&M.isTransparent()&&M.drawTransparent(W);for(var d=0,p;d<a;++d)p=F[d],p.isOpaque&&p.isOpaque()&&p.draw(W);L.enable(L.BLEND),L.blendEquation(L.FUNC_ADD),L.blendFunc(L.ONE,L.ONE_MINUS_SRC_ALPHA),L.colorMask(!0,!0,!0,!0),L.depthMask(!1),L.clearColor(0,0,0,0),L.clear(L.COLOR_BUFFER_BIT),M.isTransparent()&&M.drawTransparent(W);for(var d=0,p;d<a;++d)p=F[d],p.isTransparent&&p.isTransparent()&&p.drawTransparent(W);L.bindFramebuffer(L.FRAMEBUFFER,null),L.blendFunc(L.ONE,L.ONE_MINUS_SRC_ALPHA),L.disable(L.DEPTH_TEST),z.bind(),P.color[0].bind(0),z.uniforms.accumBuffer=0,v(L),L.disable(L.BLEND)}H=!1;for(var d=0;d<a;++d)F[d].dirty=!1}}}function k(){K._stopped||K.contextLost||(g(),requestAnimationFrame(k))}e=e||{},e.camera=e.camera||{};var T=e.canvas;if(!T)if(T=document.createElement("canvas"),e.container){var C=e.container;C.appendChild(T)}else document.body.appendChild(T);var L=e.gl;if(L||(e.glOptions&&(S=!!e.glOptions.preserveDrawingBuffer),L=o(T,e.glOptions||{premultipliedAlpha:!0,antialias:!0,preserveDrawingBuffer:S})),!L)throw new Error("webgl not supported");var E=e.bounds||[[-10,-10,-10],[10,10,10]],I=new a,P=b(L,L.drawingBufferWidth,L.drawingBufferHeight,{preferFloat:!S}),z=A(L),D=e.cameraObject&&!0===e.cameraObject._ortho||e.camera.projection&&"orthographic"===e.camera.projection.type||!1,O={eye:e.camera.eye||[2,0,0],center:e.camera.center||[0,0,0],up:e.camera.up||[0,1,0],zoomMin:e.camera.zoomMax||.1,zoomMax:e.camera.zoomMin||100,mode:e.camera.mode||"turntable",_ortho:D},R=e.axes||{},M=y(L,R);M.enable=!R.disable;var j=e.spikes||{},B=x(L,j),F=[],N=[],V=[],U=[],H=!0,q=!0,G=Array(16),Y=Array(16),W={view:null,projection:G,model:Y,_ortho:!1},q=!0,X=[L.drawingBufferWidth,L.drawingBufferHeight],Z=e.cameraObject||h(T,O),K={gl:L,contextLost:!1,pixelRatio:e.pixelRatio||1,canvas:T,selection:I,camera:Z,axes:M,axesPixels:null,spikes:B,bounds:E,objects:F,shape:X,aspect:e.aspectRatio||[1,1,1],pickRadius:e.pickRadius||10,zNear:e.zNear||.01,zFar:e.zFar||1e3,fovy:e.fovy||p/4,clearColor:e.clearColor||[0,0,0,0],autoResize:i(e.autoResize),autoBounds:i(e.autoBounds),autoScale:!!e.autoScale,autoCenter:i(e.autoCenter),clipToBounds:i(e.clipToBounds),snapToData:!!e.snapToData,onselect:e.onselect||null,onrender:e.onrender||null,onclick:e.onclick||null,cameraParams:W,oncontextloss:null,mouseListener:null,_stopped:!1,getAspectratio:function(){return{x:this.aspect[0],y:this.aspect[1],z:this.aspect[2]}},setAspectratio:function(e){this.aspect[0]=e.x,this.aspect[1]=e.y,this.aspect[2]=e.z,q=!0},setBounds:function(e,t){this.bounds[0][e]=t.min,this.bounds[1][e]=t.max},setClearColor:function(e){this.clearColor=e},clearRGBA:function(){this.gl.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},$=[0|L.drawingBufferWidth/K.pixelRatio,0|L.drawingBufferHeight/K.pixelRatio];K.autoResize&&t(),window.addEventListener("resize",t),K.update=function(e){K._stopped||(e=e||{},H=!0,q=!0)},K.add=function(e){K._stopped||(e.axes=M,F.push(e),N.push(-1),H=!0,q=!0,n())},K.remove=function(e){if(!K._stopped){var t=F.indexOf(e);0>t||(F.splice(t,1),N.pop(),H=!0,q=!0,n())}},K.dispose=function(){if(!K._stopped&&(K._stopped=!0,window.removeEventListener("resize",t),T.removeEventListener("webglcontextlost",s),K.mouseListener.enabled=!1,!K.contextLost)){M.dispose(),B.dispose();for(var e=0;e<F.length;++e)F[e].dispose();P.dispose();for(var e=0;e<U.length;++e)U[e].dispose();z.dispose(),L=null,M=null,B=null,F=[]}},K._mouseRotating=!1,K._prevButtons=0,K.enableMouseListeners=function(){K.mouseListener=w(T,function(e,t,a){if(!K._stopped){var o=U.length,r=F.length,n=I.object;I.distance=1/0,I.mouse[0]=t,I.mouse[1]=a,I.object=null,I.screen=null,I.dataCoordinate=I.dataPosition=null;var l=!1;if(e&&K._prevButtons)K._mouseRotating=!0;else{K._mouseRotating&&(q=!0),K._mouseRotating=!1;for(var s=0,d;s<o;++s)if(d=U[s].query(t,$[1]-a-1,K.pickRadius),d){if(d.distance>I.distance)continue;for(var c=0,p;c<r;++c)if(p=F[c],N[c]===s){var u=p.pick(d);u&&(I.buttons=e,I.screen=d.coord,I.distance=d.distance,I.object=p,I.index=u.distance,I.dataPosition=u.position,I.dataCoordinate=u.dataCoordinate,I.data=u,l=!0)}}}n&&n!==I.object&&(n.highlight&&n.highlight(null),H=!0),I.object&&(I.object.highlight&&I.object.highlight(I.data),H=!0),l=l||I.object!==n,l&&K.onselect&&K.onselect(I),1&e&&!(1&K._prevButtons)&&K.onclick&&K.onclick(I),K._prevButtons=e}})},T.addEventListener("webglcontextlost",s);var J=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]],Q=[J[0].slice(),J[1].slice()];return K.enableMouseListeners(),k(),K.redraw=function(){K._stopped||(H=!0,g())},K}function l(e,t){var a=e.bounds,o=e.cameraParams,n=o.projection,l=o.model,s=e.gl.drawingBufferWidth,d=e.gl.drawingBufferHeight,c=e.zNear,p=e.zFar,u=e.fovy,g=s/d;t?(T(n,-g,g,-1,1,c,p),o._ortho=!0):(k(n,u,g,c,p),o._ortho=!1);for(var r=0;16>r;++r)l[r]=0;l[15]=1;for(var h=0,r=0;3>r;++r)h=m(h,a[1][r]-a[0][r]);for(var r=0;3>r;++r)l[5*r]=e.autoScale?e.aspect[r]/(a[1][r]-a[0][r]):1/h,e.autoCenter&&(l[12+r]=.5*-l[5*r]*(a[0][r]+a[1][r]))}var h=e("./camera.js"),y=e("gl-axes3d"),f=e("gl-axes3d/properties"),x=e("gl-spikes3d"),_=e("gl-select-static"),b=e("gl-fbo"),v=e("a-big-triangle"),w=e("mouse-change"),k=e("gl-mat4/perspective"),T=e("gl-mat4/ortho"),A=e("./lib/shader"),S=e("is-mobile")({tablet:!0,featureDetect:!0});t.exports={createScene:n,createCamera:h}},{"./camera.js":264,"./lib/shader":265,"a-big-triangle":14,"gl-axes3d":212,"gl-axes3d/properties":219,"gl-fbo":228,"gl-mat4/ortho":245,"gl-mat4/perspective":246,"gl-select-static":276,"gl-spikes3d":286,"is-mobile":389,"mouse-change":410}],267:[function(e,t,a){var o=e("glslify");a.pointVertex=o(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\n\nuniform mat3 matrix;\nuniform float pointSize;\nuniform float pointCloud;\n\nhighp float rand(vec2 co) {\n  highp float a = 12.9898;\n  highp float b = 78.233;\n  highp float c = 43758.5453;\n  highp float d = dot(co.xy, vec2(a, b));\n  highp float e = mod(d, 3.14);\n  return fract(sin(e) * c);\n}\n\nvoid main() {\n  vec3 hgPosition = matrix * vec3(position, 1);\n  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);\n    // if we don't jitter the point size a bit, overall point cloud\n    // saturation 'jumps' on zooming, which is disturbing and confusing\n  gl_PointSize = pointSize * ((19.5 + rand(position)) / 20.0);\n  if(pointCloud != 0.0) { // pointCloud is truthy\n    // get the same square surface as circle would be\n    gl_PointSize *= 0.886;\n  }\n}"]),a.pointFragment=o(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color, borderColor;\nuniform float centerFraction;\nuniform float pointCloud;\n\nvoid main() {\n  float radius;\n  vec4 baseColor;\n  if(pointCloud != 0.0) { // pointCloud is truthy\n    if(centerFraction == 1.0) {\n      gl_FragColor = color;\n    } else {\n      gl_FragColor = mix(borderColor, color, centerFraction);\n    }\n  } else {\n    radius = length(2.0 * gl_PointCoord.xy - 1.0);\n    if(radius > 1.0) {\n      discard;\n    }\n    baseColor = mix(borderColor, color, step(radius, centerFraction));\n    gl_FragColor = vec4(baseColor.rgb * baseColor.a, baseColor.a);\n  }\n}\n"]),a.pickVertex=o(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 pickId;\n\nuniform mat3 matrix;\nuniform float pointSize;\nuniform vec4 pickOffset;\n\nvarying vec4 fragId;\n\nvoid main() {\n  vec3 hgPosition = matrix * vec3(position, 1);\n  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);\n  gl_PointSize = pointSize;\n\n  vec4 id = pickId + pickOffset;\n  id.y += floor(id.x / 256.0);\n  id.x -= floor(id.x / 256.0) * 256.0;\n\n  id.z += floor(id.y / 256.0);\n  id.y -= floor(id.y / 256.0) * 256.0;\n\n  id.w += floor(id.z / 256.0);\n  id.z -= floor(id.z / 256.0) * 256.0;\n\n  fragId = id;\n}\n"]),a.pickFragment=o(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragId;\n\nvoid main() {\n  float radius = length(2.0 * gl_PointCoord.xy - 1.0);\n  if(radius > 1.0) {\n    discard;\n  }\n  gl_FragColor = fragId / 255.0;\n}\n"])},{glslify:378}],268:[function(e,t){'use strict';var r=Math.sqrt,i=Math.min,n=Math.pow,l=Math.max;function a(e,t,a,o,r){this.plot=e,this.offsetBuffer=t,this.pickBuffer=a,this.shader=o,this.pickShader=r,this.sizeMin=.5,this.sizeMinCap=2,this.sizeMax=20,this.areaRatio=1,this.pointCount=0,this.color=[1,0,0,1],this.borderColor=[0,0,0,1],this.blend=!1,this.pickOffset=0,this.points=null}function o(e,t){var a=0,o=e.length>>>1,r;for(r=0;r<o;r++){var n=e[2*r],l=e[2*r+1];n>=t[0]&&n<=t[2]&&l>=t[1]&&l<=t[3]&&a++}return a}var s=e("gl-shader"),d=e("gl-buffer"),c=e("typedarray-pool"),p=e("./lib/shader");t.exports=function(e,t){var o=e.gl,r=d(o),i=d(o),n=s(o,p.pointVertex,p.pointFragment),l=s(o,p.pickVertex,p.pickFragment),c=new a(e,r,i,n,l);return c.update(t),e.addObject(c),c};var u=a.prototype;u.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.offsetBuffer.dispose(),this.pickBuffer.dispose(),this.plot.removeObject(this)},u.update=function(e){function t(t,a){return t in e?e[t]:a}var a;e=e||{},this.sizeMin=t("sizeMin",.5),this.sizeMax=t("sizeMax",20),this.color=t("color",[1,0,0,1]).slice(),this.areaRatio=t("areaRatio",1),this.borderColor=t("borderColor",[0,0,0,1]).slice(),this.blend=t("blend",!1);var o=e.positions.length>>>1,r=e.positions instanceof Float32Array,n=e.idToIndex instanceof Int32Array&&e.idToIndex.length>=o,l=e.positions,s=r?l:c.mallocFloat32(l.length),d=n?e.idToIndex:c.mallocInt32(o);if(r||s.set(l),!n)for(s.set(l),a=0;a<o;a++)d[a]=a;this.points=l,this.offsetBuffer.update(s),this.pickBuffer.update(d),r||c.free(s),n||c.free(d),this.pointCount=o,this.pickOffset=0},u.unifiedDraw=function(){var e=[1,0,0,0,1,0,0,0,1],t=[0,0,0,0];return function(a){var s=void 0!==a,d=s?this.pickShader:this.shader,c=this.plot.gl,p=this.plot.dataBox;if(0===this.pointCount)return a;var u=p[2]-p[0],g=p[3]-p[1],m=o(this.points,p),h=this.plot.pickPixelRatio*l(i(this.sizeMinCap,this.sizeMin),i(this.sizeMax,this.sizeMax/n(m,.33333)));e[0]=2/u,e[4]=2/g,e[6]=-2*p[0]/u-1,e[7]=-2*p[1]/g-1,this.offsetBuffer.bind(),d.bind(),d.attributes.position.pointer(),d.uniforms.matrix=e,d.uniforms.color=this.color,d.uniforms.borderColor=this.borderColor,d.uniforms.pointCloud=5>h,d.uniforms.pointSize=h,d.uniforms.centerFraction=i(1,l(0,r(1-this.areaRatio))),s&&(t[0]=255&a,t[1]=255&a>>8,t[2]=255&a>>16,t[3]=255&a>>24,this.pickBuffer.bind(),d.attributes.pickId.pointer(c.UNSIGNED_BYTE),d.uniforms.pickOffset=t,this.pickOffset=a);var y=c.getParameter(c.BLEND),f=c.getParameter(c.DITHER);return y&&!this.blend&&c.disable(c.BLEND),f&&c.disable(c.DITHER),c.drawArrays(c.POINTS,0,this.pointCount),y&&!this.blend&&c.enable(c.BLEND),f&&c.enable(c.DITHER),a+this.pointCount}}(),u.draw=u.unifiedDraw,u.drawPick=u.unifiedDraw,u.pick=function(e,t,a){var o=this.pickOffset,r=this.pointCount;if(a<o||a>=o+r)return null;var i=a-o,n=this.points;return{object:this,pointId:i,dataCoord:[n[2*i],n[2*i+1]]}}},{"./lib/shader":267,"gl-buffer":220,"gl-shader":277,"typedarray-pool":1328}],269:[function(e,t){var o=Math.acos,r=Math.sin;t.exports=function(e,i,a,n){var t=i[0],l=i[1],s=i[2],d=i[3],c=a[0],p=a[1],u=a[2],g=a[3],m,h,y,f,x;return h=t*c+l*p+s*u+d*g,0>h&&(h=-h,c=-c,p=-p,u=-u,g=-g),1e-6<1-h?(m=o(h),y=r(m),f=r((1-n)*m)/y,x=r(n*m)/y):(f=1-n,x=n),e[0]=f*t+x*c,e[1]=f*l+x*p,e[2]=f*s+x*u,e[3]=f*d+x*g,e}},{}],270:[function(e,t){'use strict';t.exports=function(e){return e||0===e?e.toString():""}},{}],271:[function(e,t){"use strict";var o=Math.min,r=Math.max;function a(e,t,a){var d=s[t];if(d||(d=s[t]={}),e in d)return d[e];var c={textAlign:"center",textBaseline:"middle",lineHeight:1,font:t,lineSpacing:1.25,styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},triangles:!0},u=l(e,c);c.triangles=!1;var g=l(e,c),m,h;if(a&&1!==a){for(m=0;m<u.positions.length;++m)for(h=0;h<u.positions[m].length;++h)u.positions[m][h]/=a;for(m=0;m<g.positions.length;++m)for(h=0;h<g.positions[m].length;++h)g.positions[m][h]/=a}var y=[[1/0,1/0],[-Infinity,-Infinity]],f=g.positions.length;for(m=0;m<f;++m){var n=g.positions[m];for(h=0;2>h;++h)y[0][h]=o(y[0][h],n[h]),y[1][h]=r(y[1][h],n[h])}return d[e]=[u,g,y]}var l=e("vectorize-text");t.exports=a;var s={}},{"vectorize-text":1335}],272:[function(e,t,a){function o(e,t){var a=r(e,t),o=a.attributes;return o.position.location=0,o.color.location=1,o.glyph.location=2,o.id.location=3,a}var r=e("gl-shader"),i=e("glslify"),n=i(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform vec4 highlightId;\nuniform float highlightScale;\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float scale = 1.0;\n    if(distance(highlightId, id) < 0.0001) {\n      scale = highlightScale;\n    }\n\n    vec4 worldPosition = model * vec4(position, 1);\n    vec4 viewPosition = view * worldPosition;\n    viewPosition = viewPosition / viewPosition.w;\n    vec4 clipPosition = projection * (viewPosition + scale * vec4(glyph.x, -glyph.y, 0, 0));\n\n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}"]),l=i(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float highlightScale, pixelRatio;\nuniform vec4 highlightId;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float scale = pixelRatio;\n    if(distance(highlightId.bgr, id.bgr) < 0.001) {\n      scale *= highlightScale;\n    }\n\n    vec4 worldPosition = model * vec4(position, 1.0);\n    vec4 viewPosition = view * worldPosition;\n    vec4 clipPosition = projection * viewPosition;\n    clipPosition /= clipPosition.w;\n\n    gl_Position = clipPosition + vec4(screenSize * scale * vec2(glyph.x, -glyph.y), 0.0, 0.0);\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}"]),s=i(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform float highlightScale;\nuniform vec4 highlightId;\nuniform vec3 axes[2];\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float scale, pixelRatio;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float lscale = pixelRatio * scale;\n    if(distance(highlightId, id) < 0.0001) {\n      lscale *= highlightScale;\n    }\n\n    vec4 clipCenter   = projection * view * model * vec4(position, 1);\n    vec3 dataPosition = position + 0.5*lscale*(axes[0] * glyph.x + axes[1] * glyph.y) * clipCenter.w * screenSize.y;\n    vec4 clipPosition = projection * view * model * vec4(dataPosition, 1);\n\n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = dataPosition;\n  }\n}\n"]),d=i(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 fragClipBounds[2];\nuniform float opacity;\n\nvarying vec4 interpColor;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (\n    outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate) ||\n    interpColor.a * opacity == 0.\n  ) discard;\n  gl_FragColor = interpColor * opacity;\n}\n"]),c=i(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 fragClipBounds[2];\nuniform float pickGroup;\n\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate)) discard;\n\n  gl_FragColor = vec4(pickGroup, pickId.bgr);\n}"]),p=[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}],u={vertex:n,fragment:d,attributes:p},g={vertex:l,fragment:d,attributes:p},m={vertex:s,fragment:d,attributes:p},h={vertex:n,fragment:c,attributes:p},y={vertex:l,fragment:c,attributes:p},f={vertex:s,fragment:c,attributes:p};a.createPerspective=function(e){return o(e,u)},a.createOrtho=function(e){return o(e,g)},a.createProject=function(e){return o(e,m)},a.createPickPerspective=function(e){return o(e,h)},a.createPickOrtho=function(e){return o(e,y)},a.createPickProject=function(e){return o(e,f)}},{"gl-shader":277,glslify:378}],273:[function(e,t){'use strict';var h=Math.cos,y=Math.sqrt,f=Math.sin,_=Math.min,b=Math.pow,w=Math.abs,k=Math.max;function a(e,t){var a=e[0],o=e[1],r=e[2],i=e[3];return e[0]=t[0]*a+t[4]*o+t[8]*r+t[12]*i,e[1]=t[1]*a+t[5]*o+t[9]*r+t[13]*i,e[2]=t[2]*a+t[6]*o+t[10]*r+t[14]*i,e[3]=t[3]*a+t[7]*o+t[11]*r+t[15]*i,e}function o(e,t,o,r){return a(r,r,o),a(r,r,t),a(r,r,e)}function r(e,t){this.index=e,this.dataCoordinate=this.position=t}function n(e){return!0===e?1:1<e?1:e}function l(e,t,a,o,i,n,l,s,d,c,p,u){this.gl=e,this.pixelRatio=1,this.shader=t,this.orthoShader=a,this.projectShader=o,this.pointBuffer=i,this.colorBuffer=n,this.glyphBuffer=l,this.idBuffer=s,this.vao=d,this.vertexCount=0,this.lineVertexCount=0,this.opacity=1,this.hasAlpha=!1,this.lineWidth=0,this.projectScale=[2/3,2/3,2/3],this.projectOpacity=[1,1,1],this.projectHasAlpha=!1,this.pickId=0,this.pickPerspectiveShader=c,this.pickOrthoShader=p,this.pickProjectShader=u,this.points=[],this._selectResult=new r(0,[0,0,0]),this.useOrtho=!0,this.bounds=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]],this.axesProject=[!0,!0,!0],this.axesBounds=[[-Infinity,-Infinity,-Infinity],[1/0,1/0,1/0]],this.highlightId=[1,1,1,1],this.highlightScale=2,this.clipBounds=[[-Infinity,-Infinity,-Infinity],[1/0,1/0,1/0]],this.dirty=!0}function s(e){return e[0]=e[1]=e[2]=0,e}function d(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=1,e}function c(e,t,a,o){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[a]=o,e}function p(e){for(var t=U,a=0;2>a;++a)for(var o=0;3>o;++o)t[a][o]=k(_(e[a][o],1e8),-1e8);return t}function u(e,a,r,n){var l=a.axesProject,g=a.gl,m=e.uniforms,h=r.model||z,f=r.view||z,x=r.projection||z,_=a.axesBounds,k=p(a.clipBounds),T;T=a.axes&&a.axes.lastCubeProps?a.axes.lastCubeProps.axis:[1,1,1],O[0]=2/g.drawingBufferWidth,O[1]=2/g.drawingBufferHeight,e.bind(),m.view=f,m.projection=x,m.screenSize=O,m.highlightId=a.highlightId,m.highlightScale=a.highlightScale,m.clipBounds=k,m.pickGroup=a.pickId/255,m.pixelRatio=n;for(var A=0;3>A;++A)if(l[A]){m.scale=a.projectScale[A],m.opacity=a.projectOpacity[A];for(var S=N,C=0;16>C;++C)S[C]=0;for(var C=0;4>C;++C)S[5*C]=1;S[5*A]=0,S[12+A]=0>T[A]?_[0][A]:_[1][A],L(S,h,S),m.model=S;var E=(A+1)%3,I=(A+2)%3,P=s(R),D=s(M);P[E]=1,D[I]=1;var U=o(x,f,h,d(B,P)),H=o(x,f,h,d(F,D));if(w(U[1])>w(H[1])){var q=U;U=H,H=q,q=P,P=D,D=q;var G=E;E=I,I=G}0>U[0]&&(P[E]=-1),0<H[1]&&(D[I]=-1);for(var t=0,Y=0,C=0;4>C;++C)t+=b(h[4*E+C],2),Y+=b(h[4*I+C],2);P[E]/=y(t),D[I]/=y(Y),m.axes[0]=P,m.axes[1]=D,m.fragClipBounds[0]=c(V,k[0],A,-1e8),m.fragClipBounds[1]=c(V,k[1],A,1e8),a.vao.bind(),a.vao.draw(g.TRIANGLES,a.vertexCount),0<a.lineWidth&&(g.lineWidth(a.lineWidth*n),a.vao.draw(g.LINES,a.lineVertexCount,a.vertexCount)),a.vao.unbind()}}function g(e,t,a,o,r,i,n){var l=a.gl;if((i===a.projectHasAlpha||n)&&u(t,a,o,r),i===a.hasAlpha||n){e.bind();var s=e.uniforms;s.model=o.model||z,s.view=o.view||z,s.projection=o.projection||z,O[0]=2/l.drawingBufferWidth,O[1]=2/l.drawingBufferHeight,s.screenSize=O,s.highlightId=a.highlightId,s.highlightScale=a.highlightScale,s.fragClipBounds=H,s.clipBounds=a.axes.bounds,s.opacity=a.opacity,s.pickGroup=a.pickId/255,s.pixelRatio=r,a.vao.bind(),a.vao.draw(l.TRIANGLES,a.vertexCount),0<a.lineWidth&&(l.lineWidth(a.lineWidth*r),a.vao.draw(l.LINES,a.lineVertexCount,a.vertexCount)),a.vao.unbind()}}function m(e,t,a,o){var r;r=Array.isArray(e)?t<e.length?e[t]:void 0:e,r=P(r);var i=!0;T(r)&&(r="\u25BC",i=!1);var n=I(r,a,o);return{mesh:n[0],lines:n[1],bounds:n[2],visible:i}}var T=e("is-string-blank"),A=e("gl-buffer"),S=e("gl-vao"),C=e("typedarray-pool"),L=e("gl-mat4/multiply"),E=e("./lib/shaders"),I=e("./lib/glyphs"),P=e("./lib/get-simple-string"),z=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];t.exports=function(e){var t=e.gl,a=E.createPerspective(t),o=E.createOrtho(t),r=E.createProject(t),i=E.createPickPerspective(t),n=E.createPickOrtho(t),s=E.createPickProject(t),d=A(t),c=A(t),p=A(t),u=A(t),g=S(t,[{buffer:d,size:3,type:t.FLOAT},{buffer:c,size:4,type:t.FLOAT},{buffer:p,size:2,type:t.FLOAT},{buffer:u,size:4,type:t.UNSIGNED_BYTE,normalized:!0}]),m=new l(t,a,o,r,d,c,p,u,g,i,n,s);return m.update(e),m};var D=l.prototype;D.pickSlots=1,D.setPickBase=function(e){this.pickId=e},D.isTransparent=function(){if(this.hasAlpha)return!0;for(var e=0;3>e;++e)if(this.axesProject[e]&&this.projectHasAlpha)return!0;return!1},D.isOpaque=function(){if(!this.hasAlpha)return!0;for(var e=0;3>e;++e)if(this.axesProject[e]&&!this.projectHasAlpha)return!0;return!1};var O=[0,0],R=[0,0,0],M=[0,0,0],B=[0,0,0,1],F=[0,0,0,1],N=z.slice(),V=[0,0,0],U=[[0,0,0],[0,0,0]],H=[[-1e8,-1e8,-1e8],[1e8,1e8,1e8]];D.draw=function(e){var t=this.useOrtho?this.orthoShader:this.shader;g(t,this.projectShader,this,e,this.pixelRatio,!1,!1)},D.drawTransparent=function(e){var t=this.useOrtho?this.orthoShader:this.shader;g(t,this.projectShader,this,e,this.pixelRatio,!0,!1)},D.drawPick=function(e){var t=this.useOrtho?this.pickOrthoShader:this.pickPerspectiveShader;g(t,this.pickProjectShader,this,e,1,!0,!0)},D.pick=function(e){if(!e)return null;if(e.id!==this.pickId)return null;var t=e.value[2]+(e.value[1]<<8)+(e.value[0]<<16);if(t>=this.pointCount||0>t)return null;var a=this.points[t],o=this._selectResult;o.index=t;for(var r=0;3>r;++r)o.position[r]=o.dataCoordinate[r]=a[r];return o},D.highlight=function(e){if(!e)this.highlightId=[1,1,1,1];else{var t=e.index;this.highlightId=[(255&t)/255,(255&t>>8)/255,(255&t>>16)/255,0]}},D.update=function(e){if(e=e||{},"perspective"in e&&(this.useOrtho=!e.perspective),"orthographic"in e&&(this.useOrtho=!!e.orthographic),"lineWidth"in e&&(this.lineWidth=e.lineWidth),"project"in e)if(Array.isArray(e.project))this.axesProject=e.project;else{var t=!!e.project;this.axesProject=[t,t,t]}if("projectScale"in e)if(Array.isArray(e.projectScale))this.projectScale=e.projectScale.slice();else{var a=+e.projectScale;this.projectScale=[a,a,a]}if(this.projectHasAlpha=!1,"projectOpacity"in e){if(Array.isArray(e.projectOpacity))this.projectOpacity=e.projectOpacity.slice();else{var a=+e.projectOpacity;this.projectOpacity=[a,a,a]}for(var o=0;3>o;++o)this.projectOpacity[o]=n(this.projectOpacity[o]),1>this.projectOpacity[o]&&(this.projectHasAlpha=!0)}this.hasAlpha=!1,"opacity"in e&&(this.opacity=n(e.opacity),1>this.opacity&&(this.hasAlpha=!0)),this.dirty=!0;var r=e.position,d=e.font||"normal",u=e.alignment||[0,0],g,y;if(2===u.length)g=u[0],y=u[1];else{g=[],y=[];for(var o=0;o<u.length;++o)g[o]=u[o][0],y[o]=u[o][1]}var b=[1/0,1/0,1/0],v=[-Infinity,-Infinity,-Infinity],w=e.glyph,T=e.color,A=e.size,S=e.angle,L=e.lineColor,E=-1,I=0,P=0,z=0;if(r.length){z=r.length;count_loop:for(var o=0,D;o<z;++o){D=r[o];for(var O=0;3>O;++O)if(isNaN(D[O])||!isFinite(D[O]))continue count_loop;var R=m(w,o,d,this.pixelRatio),M=R.mesh,B=R.lines,F=R.bounds;I+=3*M.cells.length,P+=2*B.edges.length}}var N=I+P,V=C.mallocFloat(3*N),U=C.mallocFloat(4*N),H=C.mallocFloat(2*N),q=C.mallocUint32(N);if(0<N){var G=0,Y=I,W=[0,0,0,1],X=[0,0,0,1],Z=Array.isArray(T)&&Array.isArray(T[0]),K=Array.isArray(L)&&Array.isArray(L[0]);fill_loop:for(var o=0;o<z;++o){E+=1;for(var D=r[o],O=0;3>O;++O){if(isNaN(D[O])||!isFinite(D[O]))continue fill_loop;v[O]=k(v[O],D[O]),b[O]=_(b[O],D[O])}var R=m(w,o,d,this.pixelRatio),M=R.mesh,B=R.lines,F=R.bounds,$=R.visible;if(!$)W=[1,1,1,0];else if(Array.isArray(T)){var J;if(J=Z?o<T.length?T[o]:[0,0,0,0]:T,3===J.length){for(var O=0;3>O;++O)W[O]=J[O];W[3]=1}else if(4===J.length){for(var O=0;4>O;++O)W[O]=J[O];!this.hasAlpha&&1>J[3]&&(this.hasAlpha=!0)}}else W[0]=W[1]=W[2]=0,W[3]=1;if(!$)X=[1,1,1,0];else if(Array.isArray(L)){var J;if(J=K?o<L.length?L[o]:[0,0,0,0]:L,3===J.length){for(var O=0;3>O;++O)X[O]=J[O];X[O]=1}else if(4===J.length){for(var O=0;4>O;++O)X[O]=J[O];!this.hasAlpha&&1>J[3]&&(this.hasAlpha=!0)}}else X[0]=X[1]=X[2]=0,X[3]=1;var Q=.5;$?Array.isArray(A)?o<A.length?Q=+A[o]:Q=12:A?Q=+A:this.useOrtho&&(Q=12):Q=0;var ee=0;Array.isArray(S)?o<S.length?ee=+S[o]:ee=0:S&&(ee=+S);for(var te=h(ee),ae=f(ee),D=r[o],O=0;3>O;++O)v[O]=k(v[O],D[O]),b[O]=_(b[O],D[O]);var oe=g,re=y,oe=0;Array.isArray(g)?o<g.length?oe=g[o]:oe=0:g&&(oe=g);var re=0;Array.isArray(y)?o<y.length?re=y[o]:re=0:y&&(re=y),oe*=0<oe?1-F[0][0]:0>oe?1+F[1][0]:1,re*=0<re?1-F[0][1]:0>re?1+F[1][1]:1;for(var ie=[oe,re],ne=M.cells||[],le=M.positions||[],O=0,se;O<ne.length;++O){se=ne[O];for(var de=0;3>de;++de){for(var ce=0;3>ce;++ce)V[3*G+ce]=D[ce];for(var ce=0;4>ce;++ce)U[4*G+ce]=W[ce];q[G]=E;var pe=le[se[de]];H[2*G]=Q*(te*pe[0]-ae*pe[1]+ie[0]),H[2*G+1]=Q*(ae*pe[0]+te*pe[1]+ie[1]),G+=1}}for(var ne=B.edges,le=B.positions,O=0,se;O<ne.length;++O){se=ne[O];for(var de=0;2>de;++de){for(var ce=0;3>ce;++ce)V[3*Y+ce]=D[ce];for(var ce=0;4>ce;++ce)U[4*Y+ce]=X[ce];q[Y]=E;var pe=le[se[de]];H[2*Y]=Q*(te*pe[0]-ae*pe[1]+ie[0]),H[2*Y+1]=Q*(ae*pe[0]+te*pe[1]+ie[1]),Y+=1}}}}this.bounds=[b,v],this.points=r,this.pointCount=r.length,this.vertexCount=I,this.lineVertexCount=P,this.pointBuffer.update(V),this.colorBuffer.update(U),this.glyphBuffer.update(H),this.idBuffer.update(q),C.free(V),C.free(U),C.free(H),C.free(q)},D.dispose=function(){this.shader.dispose(),this.orthoShader.dispose(),this.pickPerspectiveShader.dispose(),this.pickOrthoShader.dispose(),this.vao.dispose(),this.pointBuffer.dispose(),this.colorBuffer.dispose(),this.glyphBuffer.dispose(),this.idBuffer.dispose()}},{"./lib/get-simple-string":270,"./lib/glyphs":271,"./lib/shaders":272,"gl-buffer":220,"gl-mat4/multiply":244,"gl-vao":297,"is-string-blank":392,"typedarray-pool":1328}],274:[function(e,t,a){'use strict';var o=e("glslify");a.boxVertex=o(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 vertex;\n\nuniform vec2 cornerA, cornerB;\n\nvoid main() {\n  gl_Position = vec4(mix(cornerA, cornerB, vertex), 0, 1);\n}\n"]),a.boxFragment=o(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color;\n\nvoid main() {\n  gl_FragColor = color;\n}\n"])},{glslify:378}],275:[function(e,t){'use strict';var o=Math.min,r=Math.max;function a(e,t,a){this.plot=e,this.boxBuffer=t,this.boxShader=a,this.enabled=!0,this.selectBox=[1/0,1/0,-Infinity,-Infinity],this.borderColor=[0,0,0,1],this.innerFill=!1,this.innerColor=[0,0,0,.25],this.outerFill=!0,this.outerColor=[0,0,0,.5],this.borderWidth=10}var i=e("gl-shader"),n=e("gl-buffer"),l=e("./lib/shaders");t.exports=function(e,t){var o=e.gl,r=n(o,[0,0,0,1,1,0,1,1]),s=i(o,l.boxVertex,l.boxFragment),d=new a(e,r,s);return d.update(t),e.addOverlay(d),d};var s=a.prototype;s.draw=function(){if(this.enabled){var e=this.plot,t=this.selectBox,a=this.borderWidth,i=this.innerFill,n=this.innerColor,l=this.outerFill,s=this.outerColor,d=this.borderColor,c=e.box,p=e.screenBox,u=e.dataBox,g=e.viewBox,m=e.pixelRatio,h=(t[0]-u[0])*(g[2]-g[0])/(u[2]-u[0])+g[0],y=(t[1]-u[1])*(g[3]-g[1])/(u[3]-u[1])+g[1],f=(t[2]-u[0])*(g[2]-g[0])/(u[2]-u[0])+g[0],x=(t[3]-u[1])*(g[3]-g[1])/(u[3]-u[1])+g[1];if(h=r(h,g[0]),y=r(y,g[1]),f=o(f,g[2]),x=o(x,g[3]),!(f<h||x<y)){c.bind();var _=p[2]-p[0],b=p[3]-p[1];if(this.outerFill&&(c.drawBox(0,0,_,y,s),c.drawBox(0,y,h,x,s),c.drawBox(0,x,_,b,s),c.drawBox(f,y,_,x,s)),this.innerFill&&c.drawBox(h,y,f,x,n),0<a){var v=a*m;c.drawBox(h-v,y-v,f+v,y+v,d),c.drawBox(h-v,x-v,f+v,x+v,d),c.drawBox(h-v,y-v,h+v,x+v,d),c.drawBox(f-v,y-v,f+v,x+v,d)}}}},s.update=function(e){e=e||{},this.innerFill=!!e.innerFill,this.outerFill=!!e.outerFill,this.innerColor=(e.innerColor||[0,0,0,.5]).slice(),this.outerColor=(e.outerColor||[0,0,0,.5]).slice(),this.borderColor=(e.borderColor||[0,0,0,1]).slice(),this.borderWidth=e.borderWidth||0,this.selectBox=(e.selectBox||this.selectBox).slice()},s.dispose=function(){this.boxBuffer.dispose(),this.boxShader.dispose(),this.plot.removeOverlay(this)}},{"./lib/shaders":274,"gl-buffer":220,"gl-shader":277}],276:[function(e,t){'use strict';var r=Math.min,i=Math.max;function a(e,t,a,o,r){this.coord=[e,t],this.id=a,this.value=o,this.distance=r}function o(e,t,a){this.gl=e,this.fbo=t,this.buffer=a,this._readTimeout=null;var o=this;this._readCallback=function(){o.gl&&(t.bind(),e.readPixels(0,0,t.shape[0],t.shape[1],e.RGBA,e.UNSIGNED_BYTE,o.buffer),o._readTimeout=null)}}t.exports=function(e,t){var a=t[0],r=t[1],i=n(e,a,r,{}),s=l.mallocUint8(4*(a*r));return new o(e,i,s)};var n=e("gl-fbo"),l=e("typedarray-pool"),s=e("ndarray"),d=e("bit-twiddle").nextPow2,c=e("cwise/lib/wrapper")({args:["array",{offset:[0,0,1],array:0},{offset:[0,0,2],array:0},{offset:[0,0,3],array:0},"scalar","scalar","index"],pre:{body:"{this_closestD2=1e8,this_closestX=-1,this_closestY=-1}",args:[],thisVars:["this_closestD2","this_closestX","this_closestY"],localVars:[]},body:{body:"{if(_inline_16_arg0_<255||_inline_16_arg1_<255||_inline_16_arg2_<255||_inline_16_arg3_<255){var _inline_16_l=_inline_16_arg4_-_inline_16_arg6_[0],_inline_16_a=_inline_16_arg5_-_inline_16_arg6_[1],_inline_16_f=_inline_16_l*_inline_16_l+_inline_16_a*_inline_16_a;_inline_16_f<this_closestD2&&(this_closestD2=_inline_16_f,this_closestX=_inline_16_arg6_[0],this_closestY=_inline_16_arg6_[1])}}",args:[{name:"_inline_16_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg3_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg4_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg5_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg6_",lvalue:!1,rvalue:!0,count:4}],thisVars:["this_closestD2","this_closestX","this_closestY"],localVars:["_inline_16_a","_inline_16_f","_inline_16_l"]},post:{body:"{return[this_closestX,this_closestY,this_closestD2]}",args:[],thisVars:["this_closestD2","this_closestX","this_closestY"],localVars:[]},debug:!1,funcName:"cwise",blockSize:64}),p=o.prototype;Object.defineProperty(p,"shape",{get:function(){return this.gl?this.fbo.shape.slice():[0,0]},set:function(e){if(this.gl){this.fbo.shape=e;var t=this.fbo.shape[0],a=this.fbo.shape[1];if(4*(a*t)>this.buffer.length){l.free(this.buffer);for(var o=this.buffer=l.mallocUint8(d(4*(a*t))),r=0;r<4*(a*t);++r)o[r]=255}return e}}}),p.begin=function(){var e=this.gl,t=this.shape;e&&(this.fbo.bind(),e.clearColor(1,1,1,1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT))},p.end=function(){var e=this.gl;e&&(e.bindFramebuffer(e.FRAMEBUFFER,null),!this._readTimeout&&clearTimeout(this._readTimeout),this._readTimeout=setTimeout(this._readCallback,1))},p.query=function(e,t,o){if(!this.gl)return null;var n=this.fbo.shape.slice();e|=0,t|=0,"number"!=typeof o&&(o=1);var l=0|r(i(e-o,0),n[0]),d=0|r(i(e+o,0),n[0]),p=0|r(i(t-o,0),n[1]),u=0|r(i(t+o,0),n[1]);if(d<=l||u<=p)return null;var g=[d-l,u-p],m=s(this.buffer,[g[0],g[1],4],[4,4*n[0],1],4*(l+n[0]*p)),h=c(m.hi(g[0],g[1],1),o,o),f=h[0],_=h[1];if(0>f||Math.pow(this.radius,2)<h[2])return null;var b=m.get(f,_,0),v=m.get(f,_,1),w=m.get(f,_,2),k=m.get(f,_,3);return new a(0|f+l,0|_+p,b,[v,w,k],Math.sqrt(h[2]))},p.dispose=function(){this.gl&&(this.fbo.dispose(),l.free(this.buffer),this.gl=null,this._readTimeout&&clearTimeout(this._readTimeout))}},{"bit-twiddle":43,"cwise/lib/wrapper":96,"gl-fbo":228,ndarray:425,"typedarray-pool":1328}],277:[function(e,t){'use strict';function a(e){this.gl=e,this.gl.lastAttribCount=0,this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}function o(e,t){return e.name<t.name?-1:1}var r=e("./lib/create-uniforms"),n=e("./lib/create-attributes"),l=e("./lib/reflect"),s=e("./lib/shader-cache"),d=e("./lib/runtime-reflect"),c=e("./lib/GLError"),p=a.prototype;p.bind=function(){this.program||this._relink();var e=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES),t=this.gl.lastAttribCount,a;if(e>t)for(a=t;a<e;a++)this.gl.enableVertexAttribArray(a);else if(t>e)for(a=e;a<t;a++)this.gl.disableVertexAttribArray(a);this.gl.lastAttribCount=e,this.gl.useProgram(this.program)},p.dispose=function(){for(var e=this.gl.lastAttribCount,t=0;t<e;t++)this.gl.disableVertexAttribArray(t);this.gl.lastAttribCount=0,this._fref&&this._fref.dispose(),this._vref&&this._vref.dispose(),this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null},p.update=function(e,t,a,p){function u(){m.program=s.program(h,m._vref,m._fref,v,w);for(var e=0;e<a.length;++e)E[e]=h.getUniformLocation(m.program,a[e].name)}if(!t||1===arguments.length){var g=e;e=g.vertex,t=g.fragment,a=g.uniforms,p=g.attributes}var m=this,h=m.gl,y=m._vref;m._vref=s.shader(h,h.VERTEX_SHADER,e),y&&y.dispose(),m.vertShader=m._vref.shader;var f=this._fref;if(m._fref=s.shader(h,h.FRAGMENT_SHADER,t),f&&f.dispose(),m.fragShader=m._fref.shader,!a||!p){var x=h.createProgram();if(h.attachShader(x,m.fragShader),h.attachShader(x,m.vertShader),h.linkProgram(x),!h.getProgramParameter(x,h.LINK_STATUS)){var _=h.getProgramInfoLog(x);throw new c(_,"Error linking program:"+_)}a=a||d.uniforms(h,x),p=p||d.attributes(h,x),h.deleteProgram(x)}p=p.slice(),p.sort(o);var b=[],v=[],w=[],k;for(k=0;k<p.length;++k){var T=p[k];if(0<=T.type.indexOf("mat")){for(var A=0|T.type.charAt(T.type.length-1),S=Array(A),C=0;C<A;++C)S[C]=w.length,v.push(T.name+"["+C+"]"),"number"==typeof T.location?w.push(T.location+C):Array.isArray(T.location)&&T.location.length===A&&"number"==typeof T.location[C]?w.push(0|T.location[C]):w.push(-1);b.push({name:T.name,type:T.type,locations:S})}else b.push({name:T.name,type:T.type,locations:[w.length]}),v.push(T.name),"number"==typeof T.location?w.push(0|T.location):w.push(-1)}var L=0;for(k=0;k<w.length;++k)if(0>w[k]){for(;0<=w.indexOf(L);)L+=1;w[k]=L}var E=Array(a.length);u(),m._relink=u,m.types={uniforms:l(a),attributes:l(p)},m.attributes=n(h,m,b,w),Object.defineProperty(m,"uniforms",r(h,m,a,E))},t.exports=function(e,t,o,r,i){var n=new a(e);return n.update(t,o,r,i),n}},{"./lib/GLError":278,"./lib/create-attributes":279,"./lib/create-uniforms":280,"./lib/reflect":281,"./lib/runtime-reflect":282,"./lib/shader-cache":283}],278:[function(e,t){function a(e,t,a){this.shortMessage=t||"",this.longMessage=a||"",this.rawError=e||"",this.message="gl-shader: "+(t||e||"")+(a?"\n"+a:""),this.stack=new Error().stack}a.prototype=new Error,a.prototype.name="GLError",a.prototype.constructor=a,t.exports=a},{}],279:[function(e,t){'use strict';function a(e,t,a,o,r,i){this._gl=e,this._wrapper=t,this._index=a,this._locations=o,this._dimension=r,this._constFunc=i}function o(e,t,o,r,n,l,s){for(var d=["gl","v"],c=[],p=0;p<n;++p)d.push("x"+p),c.push("x"+p);d.push("if(x0.length===void 0){return gl.vertexAttrib"+n+"f(v,"+c.join()+")}else{return gl.vertexAttrib"+n+"fv(v,x0)}");var u=Function.apply(null,d),g=new a(e,t,o,r,n,u);Object.defineProperty(l,s,{set:function(t){return e.disableVertexAttribArray(r[o]),u(e,r[o],t),t},get:function(){return g},enumerable:!0})}function r(e,t,a,r,n,l,s){for(var d=Array(n),c=Array(n),p=0;p<n;++p)o(e,t,a[p],r,n,d,p),c[p]=d[p];Object.defineProperty(d,"location",{set:function(e){if(Array.isArray(e))for(var t=0;t<n;++t)c[t].location=e[t];else for(var t=0;t<n;++t)c[t].location=e+t;return e},get:function(){for(var e=Array(n),t=0;t<n;++t)e[t]=r[a[t]];return e},enumerable:!0}),d.pointer=function(t,o,l,s){t=t||e.FLOAT,o=!!o,l=l||n*n,s=s||0;for(var d=0,c;d<n;++d)c=r[a[d]],e.vertexAttribPointer(c,n,t,o,l,s+d*n),e.enableVertexAttribArray(c)};var u=Array(n),g=e["vertexAttrib"+n+"fv"];Object.defineProperty(l,s,{set:function(t){for(var o=0,l;o<n;++o)if(l=r[a[o]],e.disableVertexAttribArray(l),Array.isArray(t[0]))g.call(e,l,t[o]);else{for(var s=0;s<n;++s)u[s]=t[n*o+s];g.call(e,l,u)}return t},get:function(){return d},enumerable:!0})}t.exports=function(e,t,l,s){for(var c={},p=0,u=l.length;p<u;++p){var n=l[p],a=n.name,g=n.type,m=n.locations;switch(g){case"bool":case"int":case"float":o(e,t,m[0],s,1,c,a);break;default:if(0<=g.indexOf("vec")){var h=g.charCodeAt(g.length-1)-48;if(2>h||4<h)throw new i("","Invalid data type for attribute "+a+": "+g);o(e,t,m[0],s,h,c,a)}else if(0<=g.indexOf("mat")){var h=g.charCodeAt(g.length-1)-48;if(2>h||4<h)throw new i("","Invalid data type for attribute "+a+": "+g);r(e,t,m,s,h,c,a)}else throw new i("","Unknown data type for attribute "+a+": "+g);}}return c};var i=e("./GLError"),n=a.prototype;n.pointer=function(e,t,a,o){var r=this,i=r._gl,n=r._locations[r._index];i.vertexAttribPointer(n,r._dimension,e||i.FLOAT,!!t,a||0,o||0),i.enableVertexAttribArray(n)},n.set=function(e,t,a,o){return this._constFunc(this._locations[this._index],e,t,a,o)},Object.defineProperty(n,"location",{get:function(){return this._locations[this._index]},set:function(e){return e!==this._locations[this._index]&&(this._locations[this._index]=0|e,this._wrapper.program=null),0|e}})},{"./GLError":278}],280:[function(e,t){'use strict';function a(e){var t=new Function("y","return function(){return y}");return t(e)}function o(e,t){for(var a=Array(e),o=0;o<e;++o)a[o]=t;return a}var r=e("./reflect"),i=e("./GLError");t.exports=function(e,t,n,l){function s(a){var o=new Function("gl","wrapper","locations","return function(){return gl.getUniform(wrapper.program,locations["+a+"])}");return o(e,t,l)}function d(e,t,a){switch(a){case"bool":case"int":case"sampler2D":case"samplerCube":return"gl.uniform1i(locations["+t+"],obj"+e+")";case"float":return"gl.uniform1f(locations["+t+"],obj"+e+")";default:var o=a.indexOf("vec");if(0<=o&&1>=o&&a.length===4+o){var r=a.charCodeAt(a.length-1)-48;if(2>r||4<r)throw new i("","Invalid data type");switch(a.charAt(0)){case"b":case"i":return"gl.uniform"+r+"iv(locations["+t+"],obj"+e+")";case"v":return"gl.uniform"+r+"fv(locations["+t+"],obj"+e+")";default:throw new i("","Unrecognized data type for vector "+name+": "+a);}}else{if(0===a.indexOf("mat")&&4===a.length){var r=a.charCodeAt(a.length-1)-48;if(2>r||4<r)throw new i("","Invalid uniform dimension type for matrix "+name+": "+a);return"gl.uniformMatrix"+r+"fv(locations["+t+"],false,obj"+e+")"}throw new i("","Unknown uniform data type for "+name+": "+a)}}}function c(e,t){if("object"!=typeof t)return[[e,t]];var a=[];for(var o in t){var r=t[o],i=e;i+=parseInt(o)+""==o?"["+o+"]":"."+o,"object"==typeof r?a.push.apply(a,c(i,r)):a.push([i,r])}return a}function p(t){for(var a=["return function updateProperty(obj){"],o=c("",t),r=0;r<o.length;++r){var s=o[r],p=s[0],u=s[1];l[u]&&a.push(d(p,u,n[u].type))}a.push("return obj}");var g=new Function("gl","locations",a.join("\n"));return g(e,l)}function u(e){switch(e){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":return 0;case"float":return 0;default:var t=e.indexOf("vec");if(0<=t&&1>=t&&e.length===4+t){var a=e.charCodeAt(e.length-1)-48;if(2>a||4<a)throw new i("","Invalid data type");return"b"===e.charAt(0)?o(a,!1):o(a,0)}if(0===e.indexOf("mat")&&4===e.length){var a=e.charCodeAt(e.length-1)-48;if(2>a||4<a)throw new i("","Invalid uniform dimension type for matrix "+name+": "+e);return o(a*a,0)}throw new i("","Unknown uniform data type for "+name+": "+e);}}function g(e,t,o){if("object"==typeof o){var r=m(o);Object.defineProperty(e,t,{get:a(r),set:p(o),enumerable:!0,configurable:!1})}else l[o]?Object.defineProperty(e,t,{get:s(o),set:p(o),enumerable:!0,configurable:!1}):e[t]=u(n[o].type)}function m(e){var t;if(Array.isArray(e)){t=Array(e.length);for(var a=0;a<e.length;++a)g(t,a,e[a])}else for(var o in t={},e)g(t,o,e[o]);return t}var h=r(n,!0);return{get:a(m(h)),set:p(h),enumerable:!0,configurable:!0}}},{"./GLError":278,"./reflect":281}],281:[function(e,t){'use strict';function a(e,t){for(var a={},r=0;r<e.length;++r)for(var l=e[r].name,n=l.split("."),s=a,d=0,c;d<n.length;++d)if(c=n[d].split("["),1<c.length){c[0]in s||(s[c[0]]=[]),s=s[c[0]];for(var p=1,u;p<c.length;++p)u=parseInt(c[p]),p<c.length-1||d<n.length-1?(!(u in s)&&(p<c.length-1?s[u]=[]:s[u]={}),s=s[u]):t?s[u]=r:s[u]=e[r].type}else d<n.length-1?(c[0]in s||(s[c[0]]={}),s=s[c[0]]):s[c[0]]=t?r:e[r].type;return a}t.exports=a},{}],282:[function(e,t,a){'use strict';function o(e,t){if(!n){var a=Object.keys(r);n={};for(var o=0,l;o<a.length;++o)l=a[o],n[e[l]]=r[l]}return n[t]}a.uniforms=function(e,t){for(var a=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),r=[],n=0,l;n<a;++n)if(l=e.getActiveUniform(t,n),l){var s=o(e,l.type);if(1<l.size)for(var d=0;d<l.size;++d)r.push({name:l.name.replace("[0]","["+d+"]"),type:s});else r.push({name:l.name,type:s})}return r},a.attributes=function(e,t){for(var a=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),r=[],n=0,l;n<a;++n)l=e.getActiveAttrib(t,n),l&&r.push({name:l.name,type:o(e,l.type)});return r};var r={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},n=null},{}],283:[function(e,t,a){'use strict';function o(e,t,a,o,r,i,n){this.id=e,this.src=t,this.type=a,this.shader=o,this.count=i,this.programs=[],this.cache=n}function r(e){this.gl=e,this.shaders=[{},{}],this.programs={}}function i(e,t,a){var o=e.createShader(t);if(e.shaderSource(o,a),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS)){var r=e.getShaderInfoLog(o);try{var i=d(r,a,t)}catch(t){throw console.warn("Failed to format compiler error: "+t),new s(r,"Error compiling shader:\n"+r)}throw new s(r,i.short,i.long)}return o}function n(e,t,a,o,r){var n=e.createProgram();e.attachShader(n,t),e.attachShader(n,a);for(var l=0;l<o.length;++l)e.bindAttribLocation(n,r[l],o[l]);if(e.linkProgram(n),!e.getProgramParameter(n,e.LINK_STATUS)){var d=e.getProgramInfoLog(n);throw new s(d,"Error linking program: "+d)}return n}function l(e){var t=p.get(e);return t||(t=new r(e),p.set(e,t)),t}a.shader=function(e,t,a){return l(e).getShaderReference(t,a)},a.program=function(e,t,a,o,r){return l(e).getProgram(t,a,o,r)};var s=e("./GLError"),d=e("gl-format-compiler-error"),c="undefined"==typeof WeakMap?e("weakmap-shim"):WeakMap,p=new c,u=0;o.prototype.dispose=function(){if(0==--this.count){for(var e=this.cache,t=e.gl,a=this.programs,o=0,r=a.length,n;o<r;++o)n=e.programs[a[o]],n&&(delete e.programs[o],t.deleteProgram(n));t.deleteShader(this.shader),delete e.shaders[0|this.type===t.FRAGMENT_SHADER][this.src]}};var g=r.prototype;g.getShaderReference=function(e,t){var a=this.gl,r=this.shaders[0|e===a.FRAGMENT_SHADER],n=r[t];if(!n||!a.isShader(n.shader)){var l=i(a,e,t);n=r[t]=new o(u++,t,e,l,[],1,this)}else n.count+=1;return n},g.getProgram=function(e,t,a,o){var r=[e.id,t.id,a.join(":"),o.join(":")].join("@"),i=this.programs[r];return i&&this.gl.isProgram(i)||(this.programs[r]=i=n(this.gl,e.shader,t.shader,a,o),e.programs.push(r),t.programs.push(r)),i}},{"./GLError":278,"gl-format-compiler-error":229,"weakmap-shim":1393}],284:[function(e,t){'use strict';function a(e){this.plot=e,this.enable=[!0,!0,!1,!1],this.width=[1,1,1,1],this.color=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.center=[1/0,1/0]}t.exports=function(e,t){var o=new a(e);return o.update(t),e.addOverlay(o),o};var o=a.prototype;o.update=function(e){e=e||{},this.enable=(e.enable||[!0,!0,!1,!1]).slice(),this.width=(e.width||[1,1,1,1]).slice(),this.color=(e.color||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]).map(function(e){return e.slice()}),this.center=(e.center||[1/0,1/0]).slice(),this.plot.setOverlayDirty()},o.draw=function(){var e=this.enable,t=this.width,a=this.color,o=this.center,r=this.plot,i=r.line,n=r.dataBox,l=r.viewBox;if(i.bind(),n[0]<=o[0]&&o[0]<=n[2]&&n[1]<=o[1]&&o[1]<=n[3]){var s=l[0]+(o[0]-n[0])/(n[2]-n[0])*(l[2]-l[0]),d=l[1]+(o[1]-n[1])/(n[3]-n[1])*(l[3]-l[1]);e[0]&&i.drawLine(s,d,l[0],d,t[0],a[0]),e[1]&&i.drawLine(s,d,s,l[1],t[1],a[1]),e[2]&&i.drawLine(s,d,l[2],d,t[2],a[2]),e[3]&&i.drawLine(s,d,s,l[3],t[3],a[3])}},o.dispose=function(){this.plot.removeOverlay(this)}},{}],285:[function(e,t){'use strict';var a=e("glslify"),o=e("gl-shader"),r=a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position, color;\nattribute float weight;\n\nuniform mat4 model, view, projection;\nuniform vec3 coordinates[3];\nuniform vec4 colors[3];\nuniform vec2 screenShape;\nuniform float lineWidth;\n\nvarying vec4 fragColor;\n\nvoid main() {\n  vec3 vertexPosition = mix(coordinates[0],\n    mix(coordinates[2], coordinates[1], 0.5 * (position + 1.0)), abs(position));\n\n  vec4 clipPos = projection * view * model * vec4(vertexPosition, 1.0);\n  vec2 clipOffset = (projection * view * model * vec4(color, 0.0)).xy;\n  vec2 delta = weight * clipOffset * screenShape;\n  vec2 lineOffset = normalize(vec2(delta.y, -delta.x)) / screenShape;\n\n  gl_Position   = vec4(clipPos.xy + clipPos.w * 0.5 * lineWidth * lineOffset, clipPos.z, clipPos.w);\n  fragColor     = color.x * colors[0] + color.y * colors[1] + color.z * colors[2];\n}\n"]),i=a(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n  gl_FragColor = fragColor;\n}"]);t.exports=function(e){return o(e,r,i,null,[{name:"position",type:"vec3"},{name:"color",type:"vec3"},{name:"weight",type:"float"}])}},{"gl-shader":277,glslify:378}],286:[function(e,t){'use strict';function a(e,t,a,o){this.gl=e,this.buffer=t,this.vao=a,this.shader=o,this.pixelRatio=1,this.bounds=[[-1e3,-1e3,-1e3],[1e3,1e3,1e3]],this.position=[0,0,0],this.lineWidth=[2,2,2],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.enabled=[!0,!0,!0],this.drawSides=[!0,!0,!0],this.axes=null}var o=e("gl-buffer"),r=e("gl-vao"),i=e("./shaders/index");t.exports=function(e,t){function n(e,t,a,o,r,i){var n=[e,t,a,0,0,0,1];n[o+3]=1,n[o]=r,s.push.apply(s,n),n[6]=-1,s.push.apply(s,n),n[o]=i,s.push.apply(s,n),s.push.apply(s,n),n[6]=1,s.push.apply(s,n),n[o]=r,s.push.apply(s,n)}var s=[];n(0,0,0,0,0,1),n(0,0,0,1,0,1),n(0,0,0,2,0,1),n(1,0,0,1,-1,1),n(1,0,0,2,-1,1),n(0,1,0,0,-1,1),n(0,1,0,2,-1,1),n(0,0,1,0,-1,1),n(0,0,1,1,-1,1);var d=o(e,s),c=r(e,[{type:e.FLOAT,buffer:d,size:3,offset:0,stride:28},{type:e.FLOAT,buffer:d,size:3,offset:12,stride:28},{type:e.FLOAT,buffer:d,size:1,offset:24,stride:28}]),p=i(e);p.attributes.position.location=0,p.attributes.color.location=1,p.attributes.weight.location=2;var u=new a(e,d,c,p);return u.update(t),u};var n=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],l=a.prototype,s=[0,0,0],d=[0,0,0],c=[0,0];l.isTransparent=function(){return!1},l.drawTransparent=function(){},l.draw=function(e){var t=this.gl,a=this.vao,o=this.shader;a.bind(),o.bind();var r=e.model||n,l=e.view||n,p=e.projection||n,u;this.axes&&(u=this.axes.lastCubeProps.axis);for(var g=s,m=d,h=0;3>h;++h)u&&0>u[h]?(g[h]=this.bounds[0][h],m[h]=this.bounds[1][h]):(g[h]=this.bounds[1][h],m[h]=this.bounds[0][h]);c[0]=t.drawingBufferWidth,c[1]=t.drawingBufferHeight,o.uniforms.model=r,o.uniforms.view=l,o.uniforms.projection=p,o.uniforms.coordinates=[this.position,g,m],o.uniforms.colors=this.colors,o.uniforms.screenShape=c;for(var h=0;3>h;++h)o.uniforms.lineWidth=this.lineWidth[h]*this.pixelRatio,this.enabled[h]&&(a.draw(t.TRIANGLES,6,6*h),this.drawSides[h]&&a.draw(t.TRIANGLES,12,18+12*h));a.unbind()},l.update=function(e){e&&("bounds"in e&&(this.bounds=e.bounds),"position"in e&&(this.position=e.position),"lineWidth"in e&&(this.lineWidth=e.lineWidth),"colors"in e&&(this.colors=e.colors),"enabled"in e&&(this.enabled=e.enabled),"drawSides"in e&&(this.drawSides=e.drawSides))},l.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders/index":285,"gl-buffer":220,"gl-vao":297}],287:[function(e,t,a){var o=e("glslify"),r=o(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the tube vertex and normal at the given index.\n//\n// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.\n//\n// Each tube segment is made up of a ring of vertices.\n// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.\n// The indexes of tube segments run from 0 to 8.\n//\nvec3 getTubePosition(vec3 d, float index, out vec3 normal) {\n  float segmentCount = 8.0;\n\n  float angle = 2.0 * 3.14159 * (index / segmentCount);\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d);\n  vec3 y = v * sin(angle) * length(d);\n  vec3 v3 = x + y;\n\n  normal = normalize(v3);\n\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 color, position;\nattribute vec2 uv;\n\nuniform float vectorScale, tubeScale;\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 eyePosition, lightPosition;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  // Scale the vector magnitude to stay constant with\n  // model & view changes.\n  vec3 normal;\n  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);\n  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * tubePosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);\n\n  // vec4 m_position  = model * vec4(tubePosition, 1.0);\n  vec4 t_position  = view * tubePosition;\n  gl_Position      = projection * t_position;\n\n  f_color          = color;\n  f_data           = tubePosition.xyz;\n  f_position       = position.xyz;\n  f_uv             = uv;\n}\n"]),i=o(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = f_color * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}\n"]),n=o(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the tube vertex and normal at the given index.\n//\n// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.\n//\n// Each tube segment is made up of a ring of vertices.\n// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.\n// The indexes of tube segments run from 0 to 8.\n//\nvec3 getTubePosition(vec3 d, float index, out vec3 normal) {\n  float segmentCount = 8.0;\n\n  float angle = 2.0 * 3.14159 * (index / segmentCount);\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d);\n  vec3 y = v * sin(angle) * length(d);\n  vec3 v3 = x + y;\n\n  normal = normalize(v3);\n\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform float tubeScale;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  vec3 normal;\n  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);\n  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  gl_Position = projection * view * tubePosition;\n  f_id        = id;\n  f_position  = position.xyz;\n}\n"]),l=o(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]);a.meshShader={vertex:r,fragment:i,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec4"}]},a.pickShader={vertex:n,fragment:l,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec4"}]}},{glslify:378}],288:[function(e,t){"use strict";var a=Math.sqrt,o=Math.abs,n=e("gl-vec3"),l=e("gl-vec4"),s=["xyz","xzy","yxz","yzx","zxy","zyx"],d=function(e,t,o,s){for(var d=e.points,c=e.velocities,u=e.divergences,g=[],m=[],h=[],y=[],f=[],x=[],_=0,b=0,v=l.create(),w=l.create(),k=8,T=0;T<d.length;T++){var A=d[T],p=c[T],S=u[T];0===t&&(S=.05*o),b=n.length(p)/s,v=l.create(),n.copy(v,p),v[3]=S;for(var C=0;C<k;C++)f[C]=[A[0],A[1],A[2],C];if(0<y.length)for(var C=0,L;C<k;C++){L=(C+1)%k,g.push(y[C],f[C],f[L],f[L],y[L],y[C]),h.push(w,v,v,v,w,w),x.push(_,b,b,b,_,_);var E=g.length;m.push([E-6,E-5,E-4],[E-3,E-2,E-1])}var I=y;y=f,f=I;var P=w;w=v,v=P;var z=_;_=b,b=z}return{positions:g,cells:m,vectors:h,vertexIntensity:x}},c=function(e,t,a,o){for(var r=0,l=0,s;l<e.length;l++){s=e[l].velocities;for(var c=0;c<s.length;c++)r=Math.max(r,n.length(s[c]))}for(var p=e.map(function(e){return d(e,a,o,r)}),u=[],g=[],m=[],h=[],l=0;l<p.length;l++){var y=p[l],f=u.length;u=u.concat(y.positions),m=m.concat(y.vectors),h=h.concat(y.vertexIntensity);for(var c=0;c<y.cells.length;c++){var x=y.cells[c],_=[];g.push(_);for(var b=0;b<x.length;b++)_.push(x[b]+f)}}return{positions:u,cells:g,vectors:m,vertexIntensity:h,colormap:t}},p=function(e,t){var a=e.length,o;for(o=0;o<a;o++){var r=e[o];if(r===t)return o;if(r>t)return o-1}return o},u=function(e,t,a){return e<t?t:e>a?a:e},g=function(e,t,a){var o=t.vectors,r=t.meshgrid,i=e[0],l=e[1],s=e[2],g=r[0].length,m=r[1].length,h=r[2].length,d=p(r[0],i),y=p(r[1],l),f=p(r[2],s),x=d+1,_=y+1,b=f+1;if(d=u(d,0,g-1),x=u(x,0,g-1),y=u(y,0,m-1),_=u(_,0,m-1),f=u(f,0,h-1),b=u(b,0,h-1),0>d||0>y||0>f||x>g-1||_>m-1||b>h-1)return n.create();var v=r[0][d],w=r[0][x],k=r[1][y],T=r[1][_],A=r[2][f],S=r[2][b],C=(i-v)/(w-v),L=(l-k)/(T-k),E=(s-A)/(S-A);isFinite(C)||(C=.5),isFinite(L)||(L=.5),isFinite(E)||(E=.5);var I,P,z,D,O,R;switch(a.reversedX&&(d=g-1-d,x=g-1-x),a.reversedY&&(y=m-1-y,_=m-1-_),a.reversedZ&&(f=h-1-f,b=h-1-b),a.filled){case 5:O=f,R=b,z=y*h,D=_*h,I=d*h*m,P=x*h*m;break;case 4:O=f,R=b,I=d*h,P=x*h,z=y*h*g,D=_*h*g;break;case 3:z=y,D=_,O=f*m,R=b*m,I=d*m*h,P=x*m*h;break;case 2:z=y,D=_,I=d*m,P=x*m,O=f*m*g,R=b*m*g;break;case 1:I=d,P=x,O=f*g,R=b*g,z=y*g*h,D=_*g*h;break;default:I=d,P=x,z=y*g,D=_*g,O=f*g*m,R=b*g*m;}var M=o[I+z+O],j=o[I+z+R],B=o[I+D+O],F=o[I+D+R],N=o[P+z+O],V=o[P+z+R],U=o[P+D+O],H=o[P+D+R],q=n.create(),G=n.create(),Y=n.create(),W=n.create();n.lerp(q,M,N,C),n.lerp(G,j,V,C),n.lerp(Y,B,U,C),n.lerp(W,F,H,C);var X=n.create(),Z=n.create();n.lerp(X,q,Y,L),n.lerp(Z,G,W,L);var K=n.create();return n.lerp(K,X,Z,E),K},m=function(e){var t=1/0;e.sort(function(e,t){return e-t});for(var a=e.length,r=1,n;r<a;r++)n=o(e[r]-e[r-1]),n<t&&(t=n);return t},h=function(e){for(var t=[],a=[],o=[],r={},n={},l={},s=e.length,d=0;d<s;d++){var c=e[d],p=c[0],u=c[1],g=c[2];r[p]||(t.push(p),r[p]=!0),n[u]||(a.push(u),n[u]=!0),l[g]||(o.push(g),l[g]=!0)}var h=m(t),y=m(a),f=m(o),x=Math.min(h,y,f);return isFinite(x)?x:1};t.exports=function(e,t){var o=e.startingPositions,r=e.maxLength||1e3,l=e.tubeSize||1,d=e.absoluteTubeSize,u=e.gridFill||"+x+y+z",m={};-1!==u.indexOf("-x")&&(m.reversedX=!0),-1!==u.indexOf("-y")&&(m.reversedY=!0),-1!==u.indexOf("-z")&&(m.reversedZ=!0),m.filled=s.indexOf(u.replace(/-/g,"").replace(/\+/g,""));var y=e.getVelocity||function(t){return g(t,e,m)},f=e.getDivergence||function(t,a){var o=n.create(),r=1e-4;n.add(o,t,[r,0,0]);var e=y(o);n.subtract(e,e,a),n.scale(e,e,1/r),n.add(o,t,[0,r,0]);var i=y(o);n.subtract(i,i,a),n.scale(i,i,1/r),n.add(o,t,[0,0,r]);var l=y(o);return n.subtract(l,l,a),n.scale(l,l,1/r),n.add(o,e,i),n.add(o,o,l),o},x=[],_=t[0][0],b=t[0][1],w=t[0][2],k=t[1][0],T=t[1][1],A=t[1][2],S=function(e){var t=e[0],a=e[1],o=e[2];return!(t<_||t>k||a<b||a>T||o<w||o>A)},C=n.distance(t[0],t[1]),L=10*C/r,E=L*L,I=1,P=0,z=o.length;1<z&&(I=h(o));for(var D=0,O;D<z;D++){O=n.create(),n.copy(O,o[D]);var R=[O],M=[],B=y(O),F=O;M.push(B);var N=[],V=f(O,B),U=n.length(V);isFinite(U)&&U>P&&(P=U),N.push(U),x.push({points:R,velocities:M,divergences:N});for(var H=0;H<100*r&&R.length<r&&S(O);){H++;var q=n.clone(B),G=n.squaredLength(q);if(0===G)break;else G>E&&n.scale(q,q,L/a(G));if(n.add(q,q,O),B=y(q),n.squaredDistance(F,q)-E>-1e-4*E){R.push(q),F=q,M.push(B);var V=f(q,B),U=n.length(V);isFinite(U)&&U>P&&(P=U),N.push(U)}O=q}}var Y=c(x,e.colormap,P,I);return d?Y.tubeScale=d:(0===P&&(P=1),Y.tubeScale=.5*l*I/P),Y};var y=e("./lib/shaders"),f=e("gl-cone3d").createMesh;t.exports.createTubeMesh=function(e,t){return f(e,t,{shaders:y,traceType:"streamtube"})}},{"./lib/shaders":287,"gl-cone3d":221,"gl-vec3":316,"gl-vec4":352}],289:[function(e,t,a){var o=e("gl-shader"),r=e("glslify"),i=r(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec4 uv;\nattribute vec3 f;\nattribute vec3 normal;\n\nuniform vec3 objectOffset;\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 lightPosition, eyePosition;\nuniform sampler2D colormap;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  vec3 localCoordinate = vec3(uv.zw, f.x);\n  worldCoordinate = objectOffset + localCoordinate;\n  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);\n  vec4 clipPosition = projection * view * worldPosition;\n  gl_Position = clipPosition;\n  kill = f.y;\n  value = f.z;\n  planeCoordinate = uv.xy;\n\n  vColor = texture2D(colormap, vec2(value, value));\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * worldPosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  lightDirection = lightPosition - cameraCoordinate.xyz;\n  eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  surfaceNormal  = normalize((vec4(normal,0) * inverseModel).xyz);\n}\n"]),n=r(["precision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat beckmannSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness) {\n  return beckmannDistribution(dot(surfaceNormal, normalize(lightDirection + viewDirection)), roughness);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 lowerBound, upperBound;\nuniform float contourTint;\nuniform vec4 contourColor;\nuniform sampler2D colormap;\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform float vertexColor;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  if (\n    kill > 0.0 ||\n    vColor.a == 0.0 ||\n    outOfRange(clipBounds[0], clipBounds[1], worldCoordinate)\n  ) discard;\n\n  vec3 N = normalize(surfaceNormal);\n  vec3 V = normalize(eyeDirection);\n  vec3 L = normalize(lightDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = max(beckmannSpecular(L, V, N, roughness), 0.);\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  //decide how to interpolate color \u2014 in vertex or in fragment\n  vec4 surfaceColor =\n    step(vertexColor, .5) * texture2D(colormap, vec2(value, value)) +\n    step(.5, vertexColor) * vColor;\n\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = mix(litColor, contourColor, contourTint) * opacity;\n}\n"]),l=r(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec4 uv;\nattribute float f;\n\nuniform vec3 objectOffset;\nuniform mat3 permutation;\nuniform mat4 model, view, projection;\nuniform float height, zOffset;\nuniform sampler2D colormap;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  vec3 dataCoordinate = permutation * vec3(uv.xy, height);\n  worldCoordinate = objectOffset + dataCoordinate;\n  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);\n\n  vec4 clipPosition = projection * view * worldPosition;\n  clipPosition.z += zOffset;\n\n  gl_Position = clipPosition;\n  value = f + objectOffset.z;\n  kill = -1.0;\n  planeCoordinate = uv.zw;\n\n  vColor = texture2D(colormap, vec2(value, value));\n\n  //Don't do lighting for contours\n  surfaceNormal   = vec3(1,0,0);\n  eyeDirection    = vec3(0,1,0);\n  lightDirection  = vec3(0,0,1);\n}\n"]),s=r(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec2 shape;\nuniform vec3 clipBounds[2];\nuniform float pickId;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 surfaceNormal;\n\nvec2 splitFloat(float v) {\n  float vh = 255.0 * v;\n  float upper = floor(vh);\n  float lower = fract(vh);\n  return vec2(upper / 255.0, floor(lower * 16.0) / 16.0);\n}\n\nvoid main() {\n  if ((kill > 0.0) ||\n      (outOfRange(clipBounds[0], clipBounds[1], worldCoordinate))) discard;\n\n  vec2 ux = splitFloat(planeCoordinate.x / shape.x);\n  vec2 uy = splitFloat(planeCoordinate.y / shape.y);\n  gl_FragColor = vec4(pickId, ux.x, uy.x, ux.y + (uy.y/16.0));\n}\n"]);a.createShader=function(e){var t=o(e,i,n,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return t.attributes.uv.location=0,t.attributes.f.location=1,t.attributes.normal.location=2,t},a.createPickShader=function(e){var t=o(e,i,s,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return t.attributes.uv.location=0,t.attributes.f.location=1,t.attributes.normal.location=2,t},a.createContourShader=function(e){var t=o(e,l,n,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return t.attributes.uv.location=0,t.attributes.f.location=1,t},a.createPickContourShader=function(e){var t=o(e,l,s,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return t.attributes.uv.location=0,t.attributes.f.location=1,t}},{"gl-shader":277,glslify:378}],290:[function(e,t){'use strict';var g=Math.sqrt,m=Math.min,h=Math.abs,y=Math.max,_=Math.floor;function a(e,t,a,o,r){this.position=e,this.index=t,this.uv=a,this.level=o,this.dataCoordinate=r}function o(e,t){var a=C([A({colormap:e,nshades:256,format:"rgba"}).map(function(e,o){var r=t?n(o/255,t):1;return[e[0],e[1],e[2],255*r]})]);return S.divseq(a,255),a}function r(e,t,o,r,i,n,l,s,d,c,p,u,g,m,h){this.gl=e,this.shape=t,this.bounds=o,this.objectOffset=h,this.intensityBounds=[],this._shader=r,this._pickShader=i,this._coordinateBuffer=n,this._vao=l,this._colorMap=s,this._contourShader=d,this._contourPickShader=c,this._contourBuffer=p,this._contourVAO=u,this._contourOffsets=[[],[],[]],this._contourCounts=[[],[],[]],this._vertexCount=0,this._pickResult=new a([0,0,0],[0,0],[0,0],[0,0,0],[0,0,0]),this._dynamicBuffer=g,this._dynamicVAO=m,this._dynamicOffsets=[0,0,0],this._dynamicCounts=[0,0,0],this.contourWidth=[1,1,1],this.contourLevels=[[1],[1],[1]],this.contourTint=[0,0,0],this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]],this.showContour=!0,this.showSurface=!0,this.enableHighlight=[!0,!0,!0],this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.highlightTint=[1,1,1],this.highlightLevel=[-1,-1,-1],this.enableDynamic=[!0,!0,!0],this.dynamicLevel=[NaN,NaN,NaN],this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.dynamicTint=[1,1,1],this.dynamicWidth=[1,1,1],this.axesBounds=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]],this.surfaceProject=[!1,!1,!1],this.contourProject=[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],this.colorBounds=[!1,!1],this._field=[L(T.mallocFloat(1024),[0,0]),L(T.mallocFloat(1024),[0,0]),L(T.mallocFloat(1024),[0,0])],this.pickId=1,this.clipBounds=[[-Infinity,-Infinity,-Infinity],[1/0,1/0,1/0]],this.snapToData=!1,this.pixelRatio=1,this.opacity=1,this.opacityscale=!1,this.lightPosition=[10,1e4,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.vertexColor=0,this.dirty=!0}function n(e,t){if(!t)return 1;if(!t.length)return 1;for(var a=0;a<t.length;++a){if(2>t.length)return 1;if(t[a][0]===e)return t[a][1];if(t[a][0]>e&&0<a){var o=(t[a][0]-e)/(t[a][0]-t[a-1][0]);return t[a][1]*(1-o)+o*t[a-1][1]}}return 1}function l(e,t){var a=t.axes&&t.axes.lastCubeProps.axis||H,o=t.showSurface,r=t.showContour,n,l,s;for(n=0;3>n;++n)for(o=o||t.surfaceProject[n],l=0;3>l;++l)r=r||t.contourProject[n][l];for(n=0;3>n;++n){var d=q.projections[n];for(l=0;16>l;++l)d[l]=0;for(l=0;4>l;++l)d[5*l]=1;d[5*n]=0,d[12+n]=t.axesBounds[+(0<a[n])][n],I(d,e.model,d);var c=q.clipBounds[n];for(s=0;2>s;++s)for(l=0;3>l;++l)c[s][l]=e.clipBounds[s][l];c[0][n]=-1e8,c[1][n]=1e8}return q.showSurface=o,q.showContour=r,q}function s(e){e=e||{};var t=this.gl;t.disable(t.CULL_FACE),this._colorMap.bind(0);var a=G;a.model=e.model||F,a.view=e.view||F,a.projection=e.projection||F,a.lowerBound=[this.bounds[0][0],this.bounds[0][1],this.colorBounds[0]||this.bounds[0][2]],a.upperBound=[this.bounds[1][0],this.bounds[1][1],this.colorBounds[1]||this.bounds[1][2]],a.objectOffset=this.objectOffset,a.contourColor=this.contourColor[0],a.inverseModel=P(a.inverseModel,a.model);for(var o=0,r;2>o;++o){r=a.clipBounds[o];for(var n=0;3>n;++n)r[n]=m(y(this.clipBounds[o][n],-1e8),1e8)}a.kambient=this.ambientLight,a.kdiffuse=this.diffuseLight,a.kspecular=this.specularLight,a.roughness=this.roughness,a.fresnel=this.fresnel,a.opacity=this.opacity,a.height=0,a.permutation=W,a.vertexColor=this.vertexColor;var d=Y;for(I(d,a.view,a.model),I(d,a.projection,d),P(d,d),o=0;3>o;++o)a.eyePosition[o]=d[12+o]/d[15];var c=d[15];for(o=0;3>o;++o)c+=this.lightPosition[o]*d[4*o+3];for(o=0;3>o;++o){var p=d[12+o];for(n=0;3>n;++n)p+=d[4*n+o]*this.lightPosition[n];a.lightPosition[o]=p/c}var u=l(a,this);if(u.showSurface){for(this._shader.bind(),this._shader.uniforms=a,this._vao.bind(),this.showSurface&&this._vertexCount&&this._vao.draw(t.TRIANGLES,this._vertexCount),o=0;3>o;++o)this.surfaceProject[o]&&this.vertexCount&&(this._shader.uniforms.model=u.projections[o],this._shader.uniforms.clipBounds=u.clipBounds[o],this._vao.draw(t.TRIANGLES,this._vertexCount));this._vao.unbind()}if(u.showContour){var g=this._contourShader;a.kambient=1,a.kdiffuse=0,a.kspecular=0,a.opacity=1,g.bind(),g.uniforms=a;var h=this._contourVAO;for(h.bind(),o=0;3>o;++o)for(g.uniforms.permutation=V[o],t.lineWidth(this.contourWidth[o]*this.pixelRatio),n=0;n<this.contourLevels[o].length;++n)(n===this.highlightLevel[o]?(g.uniforms.contourColor=this.highlightColor[o],g.uniforms.contourTint=this.highlightTint[o]):(0===n||n-1===this.highlightLevel[o])&&(g.uniforms.contourColor=this.contourColor[o],g.uniforms.contourTint=this.contourTint[o]),!!this._contourCounts[o][n])&&(g.uniforms.height=this.contourLevels[o][n],h.draw(t.LINES,this._contourCounts[o][n],this._contourOffsets[o][n]));for(o=0;3>o;++o)for(g.uniforms.model=u.projections[o],g.uniforms.clipBounds=u.clipBounds[o],n=0;3>n;++n)if(this.contourProject[o][n]){g.uniforms.permutation=V[n],t.lineWidth(this.contourWidth[n]*this.pixelRatio);for(var f=0;f<this.contourLevels[n].length;++f)(f===this.highlightLevel[n]?(g.uniforms.contourColor=this.highlightColor[n],g.uniforms.contourTint=this.highlightTint[n]):(0===f||f-1===this.highlightLevel[n])&&(g.uniforms.contourColor=this.contourColor[n],g.uniforms.contourTint=this.contourTint[n]),!!this._contourCounts[n][f])&&(g.uniforms.height=this.contourLevels[n][f],h.draw(t.LINES,this._contourCounts[n][f],this._contourOffsets[n][f]))}for(h.unbind(),h=this._dynamicVAO,h.bind(),o=0;3>o;++o)if(0!==this._dynamicCounts[o])for(g.uniforms.model=a.model,g.uniforms.clipBounds=a.clipBounds,g.uniforms.permutation=V[o],t.lineWidth(this.dynamicWidth[o]*this.pixelRatio),g.uniforms.contourColor=this.dynamicColor[o],g.uniforms.contourTint=this.dynamicTint[o],g.uniforms.height=this.dynamicLevel[o],h.draw(t.LINES,this._dynamicCounts[o],this._dynamicOffsets[o]),n=0;3>n;++n)this.contourProject[n][o]&&(g.uniforms.model=u.projections[n],g.uniforms.clipBounds=u.clipBounds[n],h.draw(t.LINES,this._dynamicCounts[o],this._dynamicOffsets[o]));h.unbind()}}function d(e,t){return Array.isArray(e)?[t(e[0]),t(e[1]),t(e[2])]:[t(e),t(e),t(e)]}function p(e){return Array.isArray(e)?3===e.length?[e[0],e[1],e[2],1]:[e[0],e[1],e[2],e[3]]:[0,0,0,1]}function u(e){if(Array.isArray(e)){if(Array.isArray(e))return[p(e[0]),p(e[1]),p(e[2])];var t=p(e);return[t.slice(),t.slice(),t.slice()]}}t.exports=function(e){var t=e.gl,a=R(t),o=j(t),i=M(t),n=B(t),l=v(t),s=w(t,[{buffer:l,size:4,stride:40,offset:0},{buffer:l,size:3,stride:40,offset:16},{buffer:l,size:3,stride:40,offset:28}]),d=v(t),c=w(t,[{buffer:d,size:4,stride:20,offset:0},{buffer:d,size:1,stride:20,offset:16}]),p=v(t),u=w(t,[{buffer:p,size:2,type:t.FLOAT}]),g=k(t,1,256,t.RGBA,t.UNSIGNED_BYTE);g.minFilter=t.LINEAR,g.magFilter=t.LINEAR;var m=new r(t,[0,0],[[0,0,0],[0,0,0]],a,o,l,s,g,i,n,d,c,p,u,[0,0,0]),h={levels:[[],[],[]]};for(var y in e)h[y]=e[y];return h.colormap=h.colormap||"jet",m.update(h),m};var b=e("bit-twiddle"),v=e("gl-buffer"),w=e("gl-vao"),k=e("gl-texture2d"),T=e("typedarray-pool"),A=e("colormap"),S=e("ndarray-ops"),C=e("ndarray-pack"),L=e("ndarray"),E=e("surface-nets"),I=e("gl-mat4/multiply"),P=e("gl-mat4/invert"),z=e("binary-search-bounds"),D=e("ndarray-gradient"),O=e("./lib/shaders"),R=O.createShader,M=O.createContourShader,j=O.createPickShader,B=O.createPickContourShader,F=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],N=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]],V=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];(function(){for(var e=0;3>e;++e){var t=V[e],a=(e+1)%3,o=(e+2)%3;t[a+0]=1,t[o+3]=1,t[e+6]=1}})();var U=r.prototype;U.isTransparent=function(){return 1>this.opacity||this.opacityscale},U.isOpaque=function(){if(this.opacityscale)return!1;if(1>this.opacity)return!1;if(1<=this.opacity)return!0;for(var e=0;3>e;++e)if(0<this._contourCounts[e].length)return!0;return!1},U.pickSlots=1,U.setPickBase=function(e){this.pickId=e};var H=[0,0,0],q={showSurface:!1,showContour:!1,projections:[F.slice(),F.slice(),F.slice()],clipBounds:[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]},G={model:F,view:F,projection:F,inverseModel:F.slice(),lowerBound:[0,0,0],upperBound:[0,0,0],colorMap:0,clipBounds:[[0,0,0],[0,0,0]],height:0,contourTint:0,contourColor:[0,0,0,1],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-1e-4,objectOffset:[0,0,0],kambient:1,kdiffuse:1,kspecular:1,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:1,fresnel:1,opacity:1,vertexColor:0},Y=F.slice(),W=[1,0,0,0,1,0,0,0,1];U.draw=function(e){return s.call(this,e,!1)},U.drawTransparent=function(e){return s.call(this,e,!0)};var X={model:F,view:F,projection:F,inverseModel:F,clipBounds:[[0,0,0],[0,0,0]],height:0,shape:[0,0],pickId:0,lowerBound:[0,0,0],upperBound:[0,0,0],zOffset:0,objectOffset:[0,0,0],permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};U.drawPick=function(e){e=e||{};var t=this.gl;t.disable(t.CULL_FACE);var a=X;a.model=e.model||F,a.view=e.view||F,a.projection=e.projection||F,a.shape=this._field[2].shape,a.pickId=this.pickId/255,a.lowerBound=this.bounds[0],a.upperBound=this.bounds[1],a.objectOffset=this.objectOffset,a.permutation=W;for(var o=0,r;2>o;++o){r=a.clipBounds[o];for(var n=0;3>n;++n)r[n]=m(y(this.clipBounds[o][n],-1e8),1e8)}var s=l(a,this);if(s.showSurface){for(this._pickShader.bind(),this._pickShader.uniforms=a,this._vao.bind(),this._vao.draw(t.TRIANGLES,this._vertexCount),o=0;3>o;++o)this.surfaceProject[o]&&(this._pickShader.uniforms.model=s.projections[o],this._pickShader.uniforms.clipBounds=s.clipBounds[o],this._vao.draw(t.TRIANGLES,this._vertexCount));this._vao.unbind()}if(s.showContour){var d=this._contourPickShader;d.bind(),d.uniforms=a;var c=this._contourVAO;for(c.bind(),n=0;3>n;++n)for(t.lineWidth(this.contourWidth[n]*this.pixelRatio),d.uniforms.permutation=V[n],o=0;o<this.contourLevels[n].length;++o)this._contourCounts[n][o]&&(d.uniforms.height=this.contourLevels[n][o],c.draw(t.LINES,this._contourCounts[n][o],this._contourOffsets[n][o]));for(o=0;3>o;++o)for(d.uniforms.model=s.projections[o],d.uniforms.clipBounds=s.clipBounds[o],n=0;3>n;++n)if(this.contourProject[o][n]){d.uniforms.permutation=V[n],t.lineWidth(this.contourWidth[n]*this.pixelRatio);for(var p=0;p<this.contourLevels[n].length;++p)this._contourCounts[n][p]&&(d.uniforms.height=this.contourLevels[n][p],c.draw(t.LINES,this._contourCounts[n][p],this._contourOffsets[n][p]))}c.unbind()}},U.pick=function(e){if(!e)return null;if(e.id!==this.pickId)return null;var o=this._field[2].shape,n=this._pickResult,l=o[0]*(e.value[0]+(e.value[2]>>4)/16)/255,d=_(l),p=l-d,u=o[1]*(e.value[1]+(15&e.value[2])/16)/255,g=_(u),m=u-g;d+=1,g+=1;var y=n.position;y[0]=y[1]=y[2]=0;for(var f=0,x;2>f;++f){x=f?p:1-p;for(var v=0;2>v;++v)for(var k=v?m:1-m,t=d+f,r=g+v,c=x*k,w=0;3>w;++w)y[w]+=this._field[w].get(t,r)*c}for(var T=this._pickResult.level,A=0;3>A;++A)if(T[A]=z.le(this.contourLevels[A],y[A]),0>T[A])0<this.contourLevels[A].length&&(T[A]=0);else if(T[A]<this.contourLevels[A].length-1){var S=this.contourLevels[A][T[A]],a=this.contourLevels[A][T[A]+1];h(S-y[A])>h(a-y[A])&&(T[A]+=1)}for(n.index[0]=.5>p?d:d+1,n.index[1]=.5>m?g:g+1,n.uv[0]=l/o[0],n.uv[1]=u/o[1],w=0;3>w;++w)n.dataCoordinate[w]=this._field[w].get(n.index[0],n.index[1]);return n},U.padField=function(e,t){var a=t.shape.slice(),o=e.shape.slice();S.assign(e.lo(1,1).hi(a[0],a[1]),t),S.assign(e.lo(1).hi(a[0],1),t.hi(a[0],1)),S.assign(e.lo(1,o[1]-1).hi(a[0],1),t.lo(0,a[1]-1).hi(a[0],1)),S.assign(e.lo(0,1).hi(1,a[1]),t.hi(1)),S.assign(e.lo(o[0]-1,1).hi(1,a[1]),t.lo(a[0]-1)),e.set(0,0,t.get(0,0)),e.set(0,o[1]-1,t.get(0,a[1]-1)),e.set(o[0]-1,0,t.get(a[0]-1,0)),e.set(o[0]-1,o[1]-1,t.get(a[0]-1,a[1]-1))},U.update=function(a){a=a||{},this.objectOffset=a.objectOffset||this.objectOffset,this.dirty=!0,"contourWidth"in a&&(this.contourWidth=d(a.contourWidth,Number)),"showContour"in a&&(this.showContour=d(a.showContour,Boolean)),"showSurface"in a&&(this.showSurface=!!a.showSurface),"contourTint"in a&&(this.contourTint=d(a.contourTint,Boolean)),"contourColor"in a&&(this.contourColor=u(a.contourColor)),"contourProject"in a&&(this.contourProject=d(a.contourProject,function(e){return d(e,Boolean)})),"surfaceProject"in a&&(this.surfaceProject=a.surfaceProject),"dynamicColor"in a&&(this.dynamicColor=u(a.dynamicColor)),"dynamicTint"in a&&(this.dynamicTint=d(a.dynamicTint,Number)),"dynamicWidth"in a&&(this.dynamicWidth=d(a.dynamicWidth,Number)),"opacity"in a&&(this.opacity=a.opacity),"opacityscale"in a&&(this.opacityscale=a.opacityscale),"colorBounds"in a&&(this.colorBounds=a.colorBounds),"vertexColor"in a&&(this.vertexColor=a.vertexColor?1:0);var n=a.field||a.coords&&a.coords[2]||null,v=!1;if(n||(this._field[2].shape[0]||this._field[2].shape[2]?n=this._field[2].lo(1,1).hi(this._field[2].shape[0]-2,this._field[2].shape[1]-2):n=this._field[2].hi(0,0)),"field"in a||"coords"in a){var w=(n.shape[0]+2)*(n.shape[1]+2);w>this._field[2].data.length&&(T.freeFloat(this._field[2].data),this._field[2].data=T.mallocFloat(b.nextPow2(w))),this._field[2]=L(this._field[2].data,[n.shape[0]+2,n.shape[1]+2]),this.padField(this._field[2],n),this.shape=n.shape.slice();for(var A=this.shape,S=0;2>S;++S)this._field[2].size>this._field[S].data.length&&(T.freeFloat(this._field[S].data),this._field[S].data=T.mallocFloat(this._field[2].size)),this._field[S]=L(this._field[S].data,[A[0]+2,A[1]+2]);if(a.coords){var C=a.coords;if(!Array.isArray(C)||3!==C.length)throw new Error("gl-surface: invalid coordinates for x/y");for(S=0;2>S;++S){var I=C[S];for(M=0;2>M;++M)if(I.shape[M]!==A[M])throw new Error("gl-surface: coords have incorrect shape");this.padField(this._field[S],I)}}else if(a.ticks){var P=a.ticks;if(!Array.isArray(P)||2!==P.length)throw new Error("gl-surface: invalid ticks");for(S=0;2>S;++S){var z=P[S];if((Array.isArray(z)||z.length)&&(z=L(z)),z.shape[0]!==A[S])throw new Error("gl-surface: invalid tick length");var O=L(z.data,A);O.stride[S]=z.stride[0],O.stride[1^S]=0,this.padField(this._field[S],O)}}else{for(S=0;2>S;++S){var R=[0,0];R[S]=1,this._field[S]=L(this._field[S].data,[A[0]+2,A[1]+2],R,0)}this._field[0].set(0,0,0);for(var M=0;M<A[0];++M)this._field[0].set(M+1,0,M);for(this._field[0].set(A[0]+1,0,A[0]-1),this._field[1].set(0,0,0),M=0;M<A[1];++M)this._field[1].set(0,M+1,M);this._field[1].set(0,A[1]+1,A[1]-1)}var B=this._field,F=L(T.mallocFloat(2*(3*B[2].size)),[3,A[0]+2,A[1]+2,2]);for(S=0;3>S;++S)D(F.pick(S),B[S],"mirror");var V=L(T.mallocFloat(3*B[2].size),[A[0]+2,A[1]+2,3]);for(S=0;S<A[0]+2;++S)for(M=0;M<A[1]+2;++M){var U=F.get(0,S,M,0),H=F.get(0,S,M,1),q=F.get(1,S,M,0),G=F.get(1,S,M,1),Y=F.get(2,S,M,0),W=F.get(2,S,M,1),X=q*W-G*Y,Z=Y*H-W*U,K=U*G-H*q,$=g(X*X+Z*Z+K*K);1e-8>$?($=y(h(X),h(Z),h(K)),1e-8>$?(K=1,Z=X=0,$=1):$=1/$):$=1/g($),V.set(S,M,0,X*$),V.set(S,M,1,Z*$),V.set(S,M,2,K*$)}T.free(F.data);var J=[1/0,1/0,1/0],Q=[-Infinity,-Infinity,-Infinity],ee=1/0,te=-Infinity,ae=6*((A[0]-1)*(A[1]-1)),oe=T.mallocFloat(b.nextPow2(10*ae)),re=0,ie=0;for(S=0;S<A[0]-1;++S)j_loop:for(M=0;M<A[1]-1;++M){for(var ne=0;2>ne;++ne)for(var le=0;2>le;++le)for(var se=0,de;3>se;++se)if(de=this._field[se].get(1+S+ne,1+M+le),isNaN(de)||!isFinite(de))continue j_loop;for(se=0;6>se;++se){var ce=S+N[se][0],pe=M+N[se][1],ue=this._field[0].get(ce+1,pe+1),ge=this._field[1].get(ce+1,pe+1);de=this._field[2].get(ce+1,pe+1),X=V.get(ce+1,pe+1,0),Z=V.get(ce+1,pe+1,1),K=V.get(ce+1,pe+1,2),a.intensity&&(me=a.intensity.get(ce,pe));var me=a.intensity?a.intensity.get(ce,pe):de+this.objectOffset[2];oe[re++]=ce,oe[re++]=pe,oe[re++]=ue,oe[re++]=ge,oe[re++]=de,oe[re++]=0,oe[re++]=me,oe[re++]=X,oe[re++]=Z,oe[re++]=K,J[0]=m(J[0],ue+this.objectOffset[0]),J[1]=m(J[1],ge+this.objectOffset[1]),J[2]=m(J[2],de+this.objectOffset[2]),ee=m(ee,me),Q[0]=y(Q[0],ue+this.objectOffset[0]),Q[1]=y(Q[1],ge+this.objectOffset[1]),Q[2]=y(Q[2],de+this.objectOffset[2]),te=y(te,me),ie+=1}}for(a.intensityBounds&&(ee=+a.intensityBounds[0],te=+a.intensityBounds[1]),S=6;S<re;S+=10)oe[S]=(oe[S]-ee)/(te-ee);this._vertexCount=ie,this._coordinateBuffer.update(oe.subarray(0,re)),T.freeFloat(oe),T.free(V.data),this.bounds=[J,Q],this.intensity=a.intensity||this._field[2],(this.intensityBounds[0]!==ee||this.intensityBounds[1]!==te)&&(v=!0),this.intensityBounds=[ee,te]}if("levels"in a){var he=a.levels;for(he=Array.isArray(he[0])?he.slice():[[],[],he],S=0;3>S;++S)he[S]=he[S].slice(),he[S].sort(function(e,t){return e-t});for(S=0;3>S;++S)for(M=0;M<he[S].length;++M)he[S][M]-=this.objectOffset[S];change_test:for(S=0;3>S;++S){if(he[S].length!==this.contourLevels[S].length){v=!0;break}for(M=0;M<he[S].length;++M)if(he[S][M]!==this.contourLevels[S][M]){v=!0;break change_test}}this.contourLevels=he}if(v){B=this._field,A=this.shape;for(var ye=[],fe=0;3>fe;++fe){var xe=this.contourLevels[fe],_e=[],be=[],ve=[0,0,0];for(S=0;S<xe.length;++S){var we=E(this._field[fe],xe[S]);_e.push(0|ye.length/5),ie=0;edge_loop:for(M=0;M<we.cells.length;++M){var ke=we.cells[M];for(se=0;2>se;++se){var e=we.positions[ke[se]],p=e[0],x=0|_(p),Te=p-x,Ae=e[1],Se=0|_(Ae),Ce=Ae-Se,Le=!1;axis_loop:for(var Ee=0;3>Ee;++Ee){ve[Ee]=0;var Ie=(fe+Ee+1)%3;for(ne=0;2>ne;++ne){var Pe=ne?Te:1-Te;for(ce=0|m(y(x+ne,0),A[0]),le=0;2>le;++le){var s=le?Ce:1-Ce;if(pe=0|m(y(Se+le,0),A[1]),de=2>Ee?this._field[Ie].get(ce,pe):(this.intensity.get(ce,pe)-this.intensityBounds[0])/(this.intensityBounds[1]-this.intensityBounds[0]),!isFinite(de)||isNaN(de)){Le=!0;break axis_loop}ve[Ee]+=Pe*s*de}}}if(!Le)ye.push(ve[0],ve[1],e[0],e[1],ve[2]),ie+=1;else{if(0<se){for(var t=0;5>t;++t)ye.pop();ie-=1}continue edge_loop}}}be.push(ie)}this._contourOffsets[fe]=_e,this._contourCounts[fe]=be}var ze=T.mallocFloat(ye.length);for(S=0;S<ye.length;++S)ze[S]=ye[S];this._contourBuffer.update(ze),T.freeFloat(ze)}a.colormap&&this._colorMap.setPixels(o(a.colormap,this.opacityscale))},U.dispose=function(){this._shader.dispose(),this._vao.dispose(),this._coordinateBuffer.dispose(),this._colorMap.dispose(),this._contourBuffer.dispose(),this._contourVAO.dispose(),this._contourShader.dispose(),this._contourPickShader.dispose(),this._dynamicBuffer.dispose(),this._dynamicVAO.dispose();for(var e=0;3>e;++e)T.freeFloat(this._field[e].data)},U.highlight=function(t){var a;if(!t)return this._dynamicCounts=[0,0,0],this.dyanamicLevel=[NaN,NaN,NaN],void(this.highlightLevel=[-1,-1,-1]);for(a=0;3>a;++a)this.highlightLevel[a]=this.enableHighlight[a]?t.level[a]:-1;var o;for(o=this.snapToData?t.dataCoordinate:t.position,a=0;3>a;++a)o[a]-=this.objectOffset[a];if(this.enableDynamic[0]&&o[0]!==this.dynamicLevel[0]||this.enableDynamic[1]&&o[1]!==this.dynamicLevel[1]||this.enableDynamic[2]&&o[2]!==this.dynamicLevel[2]){for(var r=0,n=this.shape,l=T.mallocFloat(12*n[0]*n[1]),s=0;3>s;++s){if(!this.enableDynamic[s]){this.dynamicLevel[s]=NaN,this._dynamicCounts[s]=0;continue}this.dynamicLevel[s]=o[s];var c=(s+1)%3,u=(s+2)%3,_=this._field[s],f=this._field[c],g=this._field[u],h=E(_,o[s]),b=h.cells,v=h.positions;for(this._dynamicOffsets[s]=r,a=0;a<b.length;++a)for(var w=b[a],e=0;2>e;++e){var k=v[w[e]],p=+k[0],x=0|p,A=0|m(x+1,n[0]),S=p-x,C=1-S,L=+k[1],y=0|L,I=0|m(y+1,n[1]),P=L-y,z=1-P,D=C*z,O=C*P,R=S*z,M=S*P,B=D*f.get(x,y)+O*f.get(x,I)+R*f.get(A,y)+M*f.get(A,I),F=D*g.get(x,y)+O*g.get(x,I)+R*g.get(A,y)+M*g.get(A,I);if(isNaN(B)||isNaN(F)){e&&(r-=1);break}l[2*r+0]=B,l[2*r+1]=F,r+=1}this._dynamicCounts[s]=r-this._dynamicOffsets[s]}this._dynamicBuffer.update(l.subarray(0,2*r)),T.freeFloat(l)}}},{"./lib/shaders":289,"binary-search-bounds":42,"bit-twiddle":43,colormap:73,"gl-buffer":220,"gl-mat4/invert":242,"gl-mat4/multiply":244,"gl-texture2d":292,"gl-vao":297,ndarray:425,"ndarray-gradient":416,"ndarray-ops":419,"ndarray-pack":420,"surface-nets":1303,"typedarray-pool":1328}],291:[function(e,t){'use strict';var o=Math.ceil,r=Math.round,n=Math.min,l=Math.max,s=Math.floor;function a(e){return"function"==typeof e&&e._gl&&e.prop&&e.texture&&e.buffer}var d=e("css-font"),c=e("pick-by-alias"),p=e("regl"),u=e("gl-util/context"),g=e("es6-weak-map"),m=e("color-normalize"),h=e("font-atlas"),y=e("typedarray-pool"),f=e("parse-rect"),x=e("is-plain-obj"),_=e("parse-unit"),b=e("to-px"),i=e("detect-kerning"),v=e("object-assign"),w=e("font-measure"),k=e("flatten-vertex-data"),T=e("bit-twiddle"),A=T.nextPow2,S=new g,C=!1;if(document.body){var L=document.body.appendChild(document.createElement("div"));L.style.font="italic small-caps bold condensed 16px/2 cursive",getComputedStyle(L).fontStretch&&(C=!0),document.body.removeChild(L)}var E=function(e){a(e)?(e={regl:e},this.gl=e.regl._gl):this.gl=u(e),this.shader=S.get(this.gl),this.regl=this.shader?this.shader.regl:e.regl||p({gl:this.gl}),this.charBuffer=this.regl.buffer({type:"uint8",usage:"stream"}),this.sizeBuffer=this.regl.buffer({type:"float",usage:"stream"}),this.shader||(this.shader=this.createShader(),S.set(this.gl,this.shader)),this.batch=[],this.fontSize=[],this.font=[],this.fontAtlas=[],this.draw=this.shader.draw.bind(this),this.render=function(){this.regl._refresh(),this.draw(this.batch)},this.canvas=this.gl.canvas,this.update(x(e)?e:{})};E.prototype.createShader=function(){var e=this.regl,t=e({blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},stencil:{enable:!1},depth:{enable:!1},count:e.prop("count"),offset:e.prop("offset"),attributes:{charOffset:{offset:4,stride:8,buffer:e.this("sizeBuffer")},width:{offset:0,stride:8,buffer:e.this("sizeBuffer")},char:e.this("charBuffer"),position:e.this("position")},uniforms:{atlasSize:function(e,t){return[t.atlas.width,t.atlas.height]},atlasDim:function(e,t){return[t.atlas.cols,t.atlas.rows]},atlas:function(e,t){return t.atlas.texture},charStep:function(e,t){return t.atlas.step},em:function(e,t){return t.atlas.em},color:e.prop("color"),opacity:e.prop("opacity"),viewport:e.this("viewportArray"),scale:e.this("scale"),align:e.prop("align"),baseline:e.prop("baseline"),translate:e.this("translate"),positionOffset:e.prop("positionOffset")},primitive:"points",viewport:e.this("viewport"),vert:"\n\t\t\tprecision highp float;\n\t\t\tattribute float width, charOffset, char;\n\t\t\tattribute vec2 position;\n\t\t\tuniform float fontSize, charStep, em, align, baseline;\n\t\t\tuniform vec4 viewport;\n\t\t\tuniform vec4 color;\n\t\t\tuniform vec2 atlasSize, atlasDim, scale, translate, positionOffset;\n\t\t\tvarying vec2 charCoord, charId;\n\t\t\tvarying float charWidth;\n\t\t\tvarying vec4 fontColor;\n\t\t\tvoid main () {\n\t\t\t\t"+(E.normalViewport?"":"vec2 positionOffset = vec2(positionOffset.x,- positionOffset.y);")+"\n\n\t\t\t\tvec2 offset = floor(em * (vec2(align + charOffset, baseline)\n\t\t\t\t\t+ positionOffset))\n\t\t\t\t\t/ (viewport.zw * scale.xy);\n\n\t\t\t\tvec2 position = (position + translate) * scale;\n\t\t\t\tposition += offset * scale;\n\n\t\t\t\t"+(E.normalViewport?"position.y = 1. - position.y;":"")+"\n\n\t\t\t\tcharCoord = position * viewport.zw + viewport.xy;\n\n\t\t\t\tgl_Position = vec4(position * 2. - 1., 0, 1);\n\n\t\t\t\tgl_PointSize = charStep;\n\n\t\t\t\tcharId.x = mod(char, atlasDim.x);\n\t\t\t\tcharId.y = floor(char / atlasDim.x);\n\n\t\t\t\tcharWidth = width * em;\n\n\t\t\t\tfontColor = color / 255.;\n\t\t\t}",frag:"\n\t\t\tprecision highp float;\n\t\t\tuniform sampler2D atlas;\n\t\t\tuniform float fontSize, charStep, opacity;\n\t\t\tuniform vec2 atlasSize;\n\t\t\tuniform vec4 viewport;\n\t\t\tvarying vec4 fontColor;\n\t\t\tvarying vec2 charCoord, charId;\n\t\t\tvarying float charWidth;\n\n\t\t\tfloat lightness(vec4 color) {\n\t\t\t\treturn color.r * 0.299 + color.g * 0.587 + color.b * 0.114;\n\t\t\t}\n\n\t\t\tvoid main () {\n\t\t\t\tvec2 uv = gl_FragCoord.xy - charCoord + charStep * .5;\n\t\t\t\tfloat halfCharStep = floor(charStep * .5 + .5);\n\n\t\t\t\t// invert y and shift by 1px (FF expecially needs that)\n\t\t\t\tuv.y = charStep - uv.y;\n\n\t\t\t\t// ignore points outside of character bounding box\n\t\t\t\tfloat halfCharWidth = ceil(charWidth * .5);\n\t\t\t\tif (floor(uv.x) > halfCharStep + halfCharWidth ||\n\t\t\t\t\tfloor(uv.x) < halfCharStep - halfCharWidth) return;\n\n\t\t\t\tuv += charId * charStep;\n\t\t\t\tuv = uv / atlasSize;\n\n\t\t\t\tvec4 color = fontColor;\n\t\t\t\tvec4 mask = texture2D(atlas, uv);\n\n\t\t\t\tfloat maskY = lightness(mask);\n\t\t\t\t// float colorY = lightness(color);\n\t\t\t\tcolor.a *= maskY;\n\t\t\t\tcolor.a *= opacity;\n\n\t\t\t\t// color.a += .1;\n\n\t\t\t\t// antialiasing, see yiq color space y-channel formula\n\t\t\t\t// color.rgb += (1. - color.rgb) * (1. - mask.rgb);\n\n\t\t\t\tgl_FragColor = color;\n\t\t\t}"});return{regl:e,draw:t,atlas:{}}},E.prototype.update=function(e){var t=this;if("string"==typeof e)e={text:e};else if(!e)return;e=c(e,{position:"position positions coord coords coordinates",font:"font fontFace fontface typeface cssFont css-font family fontFamily",fontSize:"fontSize fontsize size font-size",text:"text texts chars characters value values symbols",align:"align alignment textAlign textbaseline",baseline:"baseline textBaseline textbaseline",direction:"dir direction textDirection",color:"color colour fill fill-color fillColor textColor textcolor",kerning:"kerning kern",range:"range dataBox",viewport:"vp viewport viewBox viewbox viewPort",opacity:"opacity alpha transparency visible visibility opaque",offset:"offset positionOffset padding shift indent indentation"},!0),null!=e.opacity&&(Array.isArray(e.opacity)?this.opacity=e.opacity.map(function(e){return parseFloat(e)}):this.opacity=parseFloat(e.opacity)),null!=e.viewport&&(this.viewport=f(e.viewport),E.normalViewport&&(this.viewport.y=this.canvas.height-this.viewport.y-this.viewport.height),this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),null==this.viewport&&(this.viewport={x:0,y:0,width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight},this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),null!=e.kerning&&(this.kerning=e.kerning),null!=e.offset&&("number"==typeof e.offset&&(e.offset=[e.offset,0]),this.positionOffset=k(e.offset)),e.direction&&(this.direction=e.direction),e.range&&(this.range=e.range,this.scale=[1/(e.range[2]-e.range[0]),1/(e.range[3]-e.range[1])],this.translate=[-e.range[0],-e.range[1]]),e.scale&&(this.scale=e.scale),e.translate&&(this.translate=e.translate),this.scale||(this.scale=[1/this.viewport.width,1/this.viewport.height]),this.translate||(this.translate=[0,0]),this.font.length||e.font||(e.font=E.baseFontSize+"px sans-serif");var a=!1,p=!1;if(e.font&&(Array.isArray(e.font)?e.font:[e.font]).forEach(function(o,n){if("string"==typeof o)try{o=d.parse(o)}catch(t){o=d.parse(E.baseFontSize+"px "+o)}else o=d.parse(d.stringify(o));var e=d.stringify({size:E.baseFontSize,family:o.family,stretch:C?o.stretch:void 0,variant:o.variant,weight:o.weight,style:o.style}),i=_(o.size),l=r(i[0]*b(i[1]));if(l!==t.fontSize[n]&&(p=!0,t.fontSize[n]=l),(!t.font[n]||e!=t.font[n].baseString)&&(a=!0,t.font[n]=E.fonts[e],!t.font[n])){var s=o.family.join(", "),c=[o.style];o.style!=o.variant&&c.push(o.variant),o.variant!=o.weight&&c.push(o.weight),C&&o.weight!=o.stretch&&c.push(o.stretch),t.font[n]={baseString:e,family:s,weight:o.weight,stretch:o.stretch,style:o.style,variant:o.variant,width:{},kerning:{},metrics:w(s,{origin:"top",fontSize:E.baseFontSize,fontStyle:c.join(" ")})},E.fonts[e]=t.font[n]}}),(a||p)&&this.font.forEach(function(a,r){var i=d.stringify({size:t.fontSize[r],family:a.family,stretch:C?a.stretch:void 0,variant:a.variant,weight:a.weight,style:a.style});if(t.fontAtlas[r]=t.shader.atlas[i],!t.fontAtlas[r]){var n=a.metrics;t.shader.atlas[i]=t.fontAtlas[r]={fontString:i,step:2*o(.5*(t.fontSize[r]*n.bottom)),em:t.fontSize[r],cols:0,rows:0,height:0,width:0,chars:[],ids:{},texture:t.regl.texture()}}null==e.text&&(e.text=t.text)}),"string"==typeof e.text&&e.position&&2<e.position.length){for(var u=Array(.5*e.position.length),g=0;g<u.length;g++)u[g]=e.text;e.text=u}var x;if(null!=e.text||a){if(this.textOffsets=[0],Array.isArray(e.text)){this.count=e.text[0].length,this.counts=[this.count];for(var T=1;T<e.text.length;T++)this.textOffsets[T]=this.textOffsets[T-1]+e.text[T-1].length,this.count+=e.text[T].length,this.counts.push(e.text[T].length);this.text=e.text.join("")}else this.text=e.text,this.count=this.text.length,this.counts=[this.count];x=[],this.font.forEach(function(e,a){E.atlasContext.font=e.baseString;for(var o=t.fontAtlas[a],r=0,n;r<t.text.length;r++)if(n=t.text.charAt(r),null==o.ids[n]&&(o.ids[n]=o.chars.length,o.chars.push(n),x.push(n)),null==e.width[n]&&(e.width[n]=E.atlasContext.measureText(n).width/E.baseFontSize,t.kerning)){var l=[];for(var s in e.width)l.push(s+n,n+s);v(e.kerning,i(e.family,{pairs:l}))}})}if(e.position)if(2<e.position.length){for(var S=!e.position[0].length,L=y.mallocFloat(2*this.count),I=0,P=0,z;I<this.counts.length;I++)if(z=this.counts[I],S)for(var D=0;D<z;D++)L[P++]=e.position[2*I],L[P++]=e.position[2*I+1];else for(var O=0;O<z;O++)L[P++]=e.position[I][0],L[P++]=e.position[I][1];this.position.call?this.position({type:"float",data:L}):this.position=this.regl.buffer({type:"float",data:L}),y.freeFloat(L)}else this.position.destroy&&this.position.destroy(),this.position={constant:e.position};if(e.text||a){var R=y.mallocUint8(this.count),M=y.mallocFloat(2*this.count);this.textWidth=[];for(var B=0,F=0;B<this.counts.length;B++){for(var N=this.counts[B],V=this.font[B]||this.font[0],U=this.fontAtlas[B]||this.fontAtlas[0],H=0;H<N;H++){var q=this.text.charAt(F),G=this.text.charAt(F-1);if(R[F]=U.ids[q],M[2*F]=V.width[q],H){var Y=M[2*F-2],W=M[2*F],X=M[2*F-1],Z=X+.5*Y+.5*W;if(this.kerning){var K=V.kerning[G+q];K&&(Z+=1e-3*K)}M[2*F+1]=Z}else M[2*F+1]=.5*M[2*F];F++}this.textWidth.push(M.length?.5*M[2*F-2]+M[2*F-1]:0)}e.align||(e.align=this.align),this.charBuffer({data:R,type:"uint8",usage:"stream"}),this.sizeBuffer({data:M,type:"float",usage:"stream"}),y.freeUint8(R),y.freeFloat(M),x.length&&this.font.forEach(function(e,a){var r=t.fontAtlas[a],i=r.step,l=s(E.maxAtlasSize/i),d=n(l,r.chars.length),c=o(r.chars.length/d),p=A(d*i),u=A(c*i);r.width=p,r.height=u,r.rows=c,r.cols=d,r.em&&r.texture({data:h({canvas:E.atlasCanvas,font:r.fontString,chars:r.chars,shape:[p,u],step:[i,i]})})})}if(e.align&&(this.align=e.align,this.alignOffset=this.textWidth.map(function(e,a){var o=Array.isArray(t.align)?1<t.align.length?t.align[a]:t.align[0]:t.align;return"number"==typeof o?o:"right"===o||"end"===o?-e:"center"===o||"centre"===o||"middle"===o?.5*-e:0})),null==this.baseline&&null==e.baseline&&(e.baseline=0),null!=e.baseline&&(this.baseline=e.baseline,!Array.isArray(this.baseline)&&(this.baseline=[this.baseline]),this.baselineOffset=this.baseline.map(function(e,a){var o=(t.font[a]||t.font[0]).metrics,r=0;return r+=.5*o.bottom,r+="number"==typeof e?e-o.baseline:-o[e],E.normalViewport||(r*=-1),r})),null!=e.color)if(e.color||(e.color="transparent"),"string"==typeof e.color||!isNaN(e.color))this.color=m(e.color,"uint8");else{var $;if("number"==typeof e.color[0]&&e.color.length>this.counts.length){var J=e.color.length;$=y.mallocUint8(J);for(var Q=(e.color.subarray||e.color.slice).bind(e.color),ee=0;ee<J;ee+=4)$.set(m(Q(ee,ee+4),"uint8"),ee)}else{var te=e.color.length;$=y.mallocUint8(4*te);for(var ae=0;ae<te;ae++)$.set(m(e.color[ae]||0,"uint8"),4*ae)}this.color=$}if(e.position||e.text||e.color||e.baseline||e.align||e.font||e.offset||e.opacity){var oe=4<this.color.length||1<this.baselineOffset.length||this.align&&1<this.align.length||1<this.fontAtlas.length||2<this.positionOffset.length;if(oe){var re=l(.5*this.position.length||0,.25*this.color.length||0,this.baselineOffset.length||0,this.alignOffset.length||0,this.font.length||0,this.opacity.length||0,.5*this.positionOffset.length||0);this.batch=Array(re);for(var ie=0;ie<this.batch.length;ie++)this.batch[ie]={count:1<this.counts.length?this.counts[ie]:this.counts[0],offset:1<this.textOffsets.length?this.textOffsets[ie]:this.textOffsets[0],color:this.color?4>=this.color.length?this.color:this.color.subarray(4*ie,4*ie+4):[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[ie]:this.opacity,baseline:null==this.baselineOffset[ie]?this.baselineOffset[0]:this.baselineOffset[ie],align:this.align?null==this.alignOffset[ie]?this.alignOffset[0]:this.alignOffset[ie]:0,atlas:this.fontAtlas[ie]||this.fontAtlas[0],positionOffset:2<this.positionOffset.length?this.positionOffset.subarray(2*ie,2*ie+2):this.positionOffset}}else this.batch=this.count?[{count:this.count,offset:0,color:this.color||[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[0]:this.opacity,baseline:this.baselineOffset[0],align:this.alignOffset?this.alignOffset[0]:0,atlas:this.fontAtlas[0],positionOffset:this.positionOffset}]:[]}},E.prototype.destroy=function(){},E.prototype.kerning=!0,E.prototype.position={constant:new Float32Array(2)},E.prototype.translate=null,E.prototype.scale=null,E.prototype.font=null,E.prototype.text="",E.prototype.positionOffset=[0,0],E.prototype.opacity=1,E.prototype.color=new Uint8Array([0,0,0,255]),E.prototype.alignOffset=[0,0],E.normalViewport=!1,E.maxAtlasSize=1024,E.atlasCanvas=document.createElement("canvas"),E.atlasContext=E.atlasCanvas.getContext("2d",{alpha:!1}),E.baseFontSize=64,E.fonts={},t.exports=E},{"bit-twiddle":43,"color-normalize":67,"css-font":86,"detect-kerning":112,"es6-weak-map":184,"flatten-vertex-data":205,"font-atlas":206,"font-measure":207,"gl-util/context":293,"is-plain-obj":391,"object-assign":438,"parse-rect":443,"parse-unit":445,"pick-by-alias":449,regl:1269,"to-px":1311,"typedarray-pool":1328}],292:[function(e,t){'use strict';var g=Math.max;function a(e){f=[e.LINEAR,e.NEAREST_MIPMAP_LINEAR,e.LINEAR_MIPMAP_NEAREST,e.LINEAR_MIPMAP_NEAREST],x=[e.NEAREST,e.LINEAR,e.NEAREST_MIPMAP_NEAREST,e.NEAREST_MIPMAP_LINEAR,e.LINEAR_MIPMAP_NEAREST,e.LINEAR_MIPMAP_LINEAR],_=[e.REPEAT,e.CLAMP_TO_EDGE,e.MIRRORED_REPEAT]}function o(e){return"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement||"undefined"!=typeof ImageData&&e instanceof ImageData}function r(e,t,a){var o=e.gl,r=o.getParameter(o.MAX_TEXTURE_SIZE);if(0>t||t>r||0>a||a>r)throw new Error("gl-texture2d: Invalid texture size");return e._shape=[t,a],e.bind(),o.texImage2D(o.TEXTURE_2D,0,e.format,t,a,0,e.format,e.type,null),e._mipLevels=[0],e}function i(e,t,a,o,r,i){this.gl=e,this.handle=t,this.format=r,this.type=i,this._shape=[a,o],this._mipLevels=[0],this._magFilter=e.NEAREST,this._minFilter=e.NEAREST,this._wrapS=e.CLAMP_TO_EDGE,this._wrapT=e.CLAMP_TO_EDGE,this._anisoSamples=1;var n=this,l=[this._wrapS,this._wrapT];Object.defineProperties(l,[{get:function(){return n._wrapS},set:function(e){return n.wrapS=e}},{get:function(){return n._wrapT},set:function(e){return n.wrapT=e}}]),this._wrapVector=l;var s=[this._shape[0],this._shape[1]];Object.defineProperties(s,[{get:function(){return n._shape[0]},set:function(e){return n.width=e}},{get:function(){return n._shape[1]},set:function(e){return n.height=e}}]),this._shapeVector=s}function n(e,t){return 3===e.length?1===t[2]&&t[1]===e[0]*e[2]&&t[0]===e[2]:1===t[0]&&t[1]===e[0]}function l(e,t,a,o,r,i,l,s){var d=s.dtype,c=s.shape.slice();if(2>c.length||3<c.length)throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d");var p=0,u=0,g=n(c,s.stride.slice());"float32"===d?p=e.FLOAT:"float64"===d?(p=e.FLOAT,g=!1,d="float32"):"uint8"===d?p=e.UNSIGNED_BYTE:(p=e.UNSIGNED_BYTE,g=!1,d="uint8");if(2===c.length)u=e.LUMINANCE,c=[c[0],c[1],1],s=m(s.data,c,[s.stride[0],s.stride[1],1],s.offset);else if(3===c.length){if(1===c[2])u=e.ALPHA;else if(2===c[2])u=e.LUMINANCE_ALPHA;else if(3===c[2])u=e.RGB;else if(4===c[2])u=e.RGBA;else throw new Error("gl-texture2d: Invalid shape for pixel coords");c[2]}else throw new Error("gl-texture2d: Invalid shape for texture");if((u===e.LUMINANCE||u===e.ALPHA)&&(r===e.LUMINANCE||r===e.ALPHA)&&(u=r),u!==r)throw new Error("gl-texture2d: Incompatible texture format for setPixels");var f=s.size,x=0>l.indexOf(o);if(x&&l.push(o),p===i&&g)0===s.offset&&s.data.length===f?x?e.texImage2D(e.TEXTURE_2D,o,r,c[0],c[1],0,r,i,s.data):e.texSubImage2D(e.TEXTURE_2D,o,t,a,c[0],c[1],r,i,s.data):x?e.texImage2D(e.TEXTURE_2D,o,r,c[0],c[1],0,r,i,s.data.subarray(s.offset,s.offset+f)):e.texSubImage2D(e.TEXTURE_2D,o,t,a,c[0],c[1],r,i,s.data.subarray(s.offset,s.offset+f));else{var _=i===e.FLOAT?y.mallocFloat32(f):y.mallocUint8(f);var v=m(_,c,[c[2],c[2]*c[0],1]);p===e.FLOAT&&i===e.UNSIGNED_BYTE?b(v,s):h.assign(v,s),x?e.texImage2D(e.TEXTURE_2D,o,r,c[0],c[1],0,r,i,_.subarray(0,f)):e.texSubImage2D(e.TEXTURE_2D,o,t,a,c[0],c[1],r,i,_.subarray(0,f)),i===e.FLOAT?y.freeFloat32(_):y.freeUint8(_)}}function s(e){var t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),t}function d(e,t,a,o,r){var n=e.getParameter(e.MAX_TEXTURE_SIZE);if(0>t||t>n||0>a||a>n)throw new Error("gl-texture2d: Invalid texture shape");if(r===e.FLOAT&&!e.getExtension("OES_texture_float"))throw new Error("gl-texture2d: Floating point textures not supported on this platform");var l=s(e);return e.texImage2D(e.TEXTURE_2D,0,o,t,a,0,o,r,null),new i(e,l,t,a,o,r)}function c(e,t,a,o,r,n){var l=s(e);return e.texImage2D(e.TEXTURE_2D,0,r,r,n,t),new i(e,l,a,o,r,n)}function p(e,t){var a=t.dtype,o=t.shape.slice(),r=e.getParameter(e.MAX_TEXTURE_SIZE);if(0>o[0]||o[0]>r||0>o[1]||o[1]>r)throw new Error("gl-texture2d: Invalid texture size");var l=n(o,t.stride.slice()),d=0;"float32"===a?d=e.FLOAT:"float64"===a?(d=e.FLOAT,l=!1,a="float32"):"uint8"===a?d=e.UNSIGNED_BYTE:(d=e.UNSIGNED_BYTE,l=!1,a="uint8");var c=0;if(2===o.length)c=e.LUMINANCE,o=[o[0],o[1],1],t=m(t.data,o,[t.stride[0],t.stride[1],1],t.offset);else if(3!==o.length)throw new Error("gl-texture2d: Invalid shape for texture");else if(1===o[2])c=e.ALPHA;else if(2===o[2])c=e.LUMINANCE_ALPHA;else if(3===o[2])c=e.RGB;else if(4===o[2])c=e.RGBA;else throw new Error("gl-texture2d: Invalid shape for pixel coords");d!==e.FLOAT||e.getExtension("OES_texture_float")||(d=e.UNSIGNED_BYTE,l=!1);var p=t.size,u,g;if(!l){var f=[o[2],o[2]*o[0],1];g=y.malloc(p,a);var x=m(g,o,f,0);("float32"===a||"float64"===a)&&d===e.UNSIGNED_BYTE?b(x,t):h.assign(x,t),u=g.subarray(0,p)}else u=0===t.offset&&t.data.length===p?t.data:t.data.subarray(t.offset,t.offset+p);var _=s(e);return e.texImage2D(e.TEXTURE_2D,0,c,o[0],o[1],0,c,d,u),l||y.free(g),new i(e,_,o[0],o[1],c,d)}function u(e){if(1>=arguments.length)throw new Error("gl-texture2d: Missing arguments for texture2d constructor");if(f||a(e),"number"==typeof arguments[1])return d(e,arguments[1],arguments[2],arguments[3]||e.RGBA,arguments[4]||e.UNSIGNED_BYTE);if(Array.isArray(arguments[1]))return d(e,0|arguments[1][0],0|arguments[1][1],arguments[2]||e.RGBA,arguments[3]||e.UNSIGNED_BYTE);if("object"==typeof arguments[1]){var t=arguments[1],r=o(t)?t:t.raw;if(r)return c(e,r,0|t.width,0|t.height,arguments[2]||e.RGBA,arguments[3]||e.UNSIGNED_BYTE);if(t.shape&&t.data&&t.stride)return p(e,t)}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")}var m=e("ndarray"),h=e("ndarray-ops"),y=e("typedarray-pool");t.exports=u;var f=null,x=null,_=null,b=function(e,t){h.muls(e,t,255)},v=i.prototype;Object.defineProperties(v,{minFilter:{get:function(){return this._minFilter},set:function(e){this.bind();var t=this.gl;if(this.type===t.FLOAT&&0<=f.indexOf(e)&&!t.getExtension("OES_texture_float_linear")&&(e=t.NEAREST),0>x.indexOf(e))throw new Error("gl-texture2d: Unknown filter mode "+e);return t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,e),this._minFilter=e}},magFilter:{get:function(){return this._magFilter},set:function(e){this.bind();var t=this.gl;if(this.type===t.FLOAT&&0<=f.indexOf(e)&&!t.getExtension("OES_texture_float_linear")&&(e=t.NEAREST),0>x.indexOf(e))throw new Error("gl-texture2d: Unknown filter mode "+e);return t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,e),this._magFilter=e}},mipSamples:{get:function(){return this._anisoSamples},set:function(e){var t=this._anisoSamples;if(this._anisoSamples=0|g(e,1),t!==this._anisoSamples){var a=this.gl.getExtension("EXT_texture_filter_anisotropic");a&&this.gl.texParameterf(this.gl.TEXTURE_2D,a.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(e){if(this.bind(),0>_.indexOf(e))throw new Error("gl-texture2d: Unknown wrap mode "+e);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,e),this._wrapS=e}},wrapT:{get:function(){return this._wrapT},set:function(e){if(this.bind(),0>_.indexOf(e))throw new Error("gl-texture2d: Unknown wrap mode "+e);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,e),this._wrapT=e}},wrap:{get:function(){return this._wrapVector},set:function(e){if(Array.isArray(e)||(e=[e,e]),2!==e.length)throw new Error("gl-texture2d: Must specify wrap mode for rows and columns");for(var t=0;2>t;++t)if(0>_.indexOf(e[t]))throw new Error("gl-texture2d: Unknown wrap mode "+e);this._wrapS=e[0],this._wrapT=e[1];var a=this.gl;return this.bind(),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,this._wrapS),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,this._wrapT),e}},shape:{get:function(){return this._shapeVector},set:function(e){if(!Array.isArray(e))e=[0|e,0|e];else if(2!==e.length)throw new Error("gl-texture2d: Invalid texture shape");return r(this,0|e[0],0|e[1]),[0|e[0],0|e[1]]}},width:{get:function(){return this._shape[0]},set:function(e){return e|=0,r(this,e,this._shape[1]),e}},height:{get:function(){return this._shape[1]},set:function(e){return e|=0,r(this,this._shape[0],e),e}}}),v.bind=function(e){var t=this.gl;return void 0!==e&&t.activeTexture(t.TEXTURE0+(0|e)),t.bindTexture(t.TEXTURE_2D,this.handle),void 0===e?t.getParameter(t.ACTIVE_TEXTURE)-t.TEXTURE0:0|e},v.dispose=function(){this.gl.deleteTexture(this.handle)},v.generateMipmap=function(){this.bind(),this.gl.generateMipmap(this.gl.TEXTURE_2D);for(var e=Math.min(this._shape[0],this._shape[1]),t=0;0<e;++t,e>>>=1)0>this._mipLevels.indexOf(t)&&this._mipLevels.push(t)},v.setPixels=function(e,t,a,r){var i=this.gl;this.bind(),Array.isArray(t)?(r=a,a=0|t[1],t=0|t[0]):(t=t||0,a=a||0),r=r||0;var n=o(e)?e:e.raw;if(n){var s=0>this._mipLevels.indexOf(r);s?(i.texImage2D(i.TEXTURE_2D,0,this.format,this.format,this.type,n),this._mipLevels.push(r)):i.texSubImage2D(i.TEXTURE_2D,r,t,a,this.format,this.type,n)}else if(e.shape&&e.stride&&e.data){if(2>e.shape.length||t+e.shape[1]>this._shape[1]>>>r||a+e.shape[0]>this._shape[0]>>>r||0>t||0>a)throw new Error("gl-texture2d: Texture dimensions are out of bounds");l(i,t,a,r,this.format,this.type,this._mipLevels,e)}else throw new Error("gl-texture2d: Unsupported data type")}},{ndarray:425,"ndarray-ops":419,"typedarray-pool":1328}],293:[function(e,t){(function(a){'use strict';function r(e){if(e.container)if(e.container==document.body)document.body.style.width||(e.canvas.width=e.width||e.pixelRatio*a.innerWidth),document.body.style.height||(e.canvas.height=e.height||e.pixelRatio*a.innerHeight);else{var t=e.container.getBoundingClientRect();e.canvas.width=e.width||t.right-t.left,e.canvas.height=e.height||t.bottom-t.top}}function i(t){return"function"==typeof t.getContext&&"width"in t&&"height"in t}function n(t){return"string"==typeof t.nodeName&&"function"==typeof t.appendChild&&"function"==typeof t.getBoundingClientRect}function l(t){return"function"==typeof t.drawArrays||"function"==typeof t.drawElements}function s(){var e=document.createElement("canvas");return e.style.position="absolute",e.style.top=0,e.style.left=0,e}var d=e("pick-by-alias");t.exports=function(t){if(t?"string"==typeof t&&(t={container:t}):t={},t=i(t)?{container:t}:n(t)?{container:t}:l(t)?{gl:t}:d(t,{container:"container target element el canvas holder parent parentNode wrapper use ref root node",gl:"gl context webgl glContext",attrs:"attributes attrs contextAttributes",pixelRatio:"pixelRatio pxRatio px ratio pxratio pixelratio",width:"w width",height:"h height"},!0),t.pixelRatio||(t.pixelRatio=a.pixelRatio||1),t.gl)return t.gl;if(t.canvas&&(t.container=t.canvas.parentNode),t.container){if("string"==typeof t.container){var e=document.querySelector(t.container);if(!e)throw Error("Element "+t.container+" is not found");t.container=e}i(t.container)?(t.canvas=t.container,t.container=t.canvas.parentNode):!t.canvas&&(t.canvas=s(),t.container.appendChild(t.canvas),r(t))}else if(!t.canvas)if("undefined"!=typeof document)t.container=document.body||document.documentElement,t.canvas=s(),t.container.appendChild(t.canvas),r(t);else throw Error("Not DOM environment. Use headless-gl.");if(!t.gl)try{t.gl=t.canvas.getContext("webgl",t.attrs)}catch(a){try{t.gl=t.canvas.getContext("experimental-webgl",t.attrs)}catch(a){t.gl=t.canvas.getContext("webgl-experimental",t.attrs)}}return t.gl}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"pick-by-alias":449}],294:[function(e,t){"use strict";t.exports=function(e,t,a){t?t.bind():e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null);var o=0|e.getParameter(e.MAX_VERTEX_ATTRIBS);if(a){if(a.length>o)throw new Error("gl-vao: Too many vertex attributes");for(var r=0,n;r<a.length;++r)if(n=a[r],n.buffer){var l=n.buffer,s=n.size||4,d=n.type||e.FLOAT,c=!!n.normalized,p=n.stride||0,u=n.offset||0;l.bind(),e.enableVertexAttribArray(r),e.vertexAttribPointer(r,s,d,c,p,u)}else{if("number"==typeof n)e.vertexAttrib1f(r,n);else if(1===n.length)e.vertexAttrib1f(r,n[0]);else if(2===n.length)e.vertexAttrib2f(r,n[0],n[1]);else if(3===n.length)e.vertexAttrib3f(r,n[0],n[1],n[2]);else if(4===n.length)e.vertexAttrib4f(r,n[0],n[1],n[2],n[3]);else throw new Error("gl-vao: Invalid vertex attribute");e.disableVertexAttribArray(r)}for(;r<o;++r)e.disableVertexAttribArray(r)}else{e.bindBuffer(e.ARRAY_BUFFER,null);for(var r=0;r<o;++r)e.disableVertexAttribArray(r)}}},{}],295:[function(e,t){"use strict";function a(e){this.gl=e,this._elements=null,this._attributes=null,this._elementsType=e.UNSIGNED_SHORT}var o=e("./do-bind.js");a.prototype.bind=function(){o(this.gl,this._elements,this._attributes)},a.prototype.update=function(e,t,a){this._elements=t,this._attributes=e,this._elementsType=a||this.gl.UNSIGNED_SHORT},a.prototype.dispose=function(){},a.prototype.unbind=function(){},a.prototype.draw=function(e,t,a){a=a||0;var o=this.gl;this._elements?o.drawElements(e,t,this._elementsType,a):o.drawArrays(e,a,t)},t.exports=function(e){return new a(e)}},{"./do-bind.js":294}],296:[function(e,t){"use strict";function o(e,t,o,a,r,i){this.location=e,this.dimension=t,this.a=o,this.b=a,this.c=r,this.d=i}function r(e,t,a){this.gl=e,this._ext=t,this.handle=a,this._attribs=[],this._useElements=!1,this._elementsType=e.UNSIGNED_SHORT}var n=e("./do-bind.js");o.prototype.bind=function(e){switch(this.dimension){case 1:e.vertexAttrib1f(this.location,this.a);break;case 2:e.vertexAttrib2f(this.location,this.a,this.b);break;case 3:e.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:e.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d);}},r.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var e=0;e<this._attribs.length;++e)this._attribs[e].bind(this.gl)},r.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)},r.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)},r.prototype.update=function(e,t,r){if(this.bind(),n(this.gl,t,e),this.unbind(),this._attribs.length=0,e)for(var l=0,s;l<e.length;++l)s=e[l],"number"==typeof s?this._attribs.push(new o(l,1,s)):Array.isArray(s)&&this._attribs.push(new o(l,s.length,s[0],s[1],s[2],s[3]));this._useElements=!!t,this._elementsType=r||this.gl.UNSIGNED_SHORT},r.prototype.draw=function(e,t,a){a=a||0;var o=this.gl;this._useElements?o.drawElements(e,t,this._elementsType,a):o.drawArrays(e,a,t)},t.exports=function(e,t){return new r(e,t,t.createVertexArrayOES())}},{"./do-bind.js":294}],297:[function(e,t){"use strict";function a(e){this.bindVertexArrayOES=e.bindVertexArray.bind(e),this.createVertexArrayOES=e.createVertexArray.bind(e),this.deleteVertexArrayOES=e.deleteVertexArray.bind(e)}var o=e("./lib/vao-native.js"),r=e("./lib/vao-emulated.js");t.exports=function(e,t,i,n){var l=e.createVertexArray?new a(e):e.getExtension("OES_vertex_array_object"),s;return s=l?o(e,l):r(e),s.update(t,i,n),s}},{"./lib/vao-emulated.js":295,"./lib/vao-native.js":296}],298:[function(e,t){t.exports=function(e,t,a){return e[0]=t[0]+a[0],e[1]=t[1]+a[1],e[2]=t[2]+a[2],e}},{}],299:[function(e,t){var o=Math.acos;t.exports=function(e,t){var a=r(e[0],e[1],e[2]),l=r(t[0],t[1],t[2]);i(a,a),i(l,l);var s=n(a,l);return 1<s?0:o(s)};var r=e("./fromValues"),i=e("./normalize"),n=e("./dot")},{"./dot":309,"./fromValues":315,"./normalize":326}],300:[function(e,t){var o=Math.ceil;t.exports=function(e,t){return e[0]=o(t[0]),e[1]=o(t[1]),e[2]=o(t[2]),e}},{}],301:[function(e,t){t.exports=function(e){var t=new Float32Array(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}},{}],302:[function(e,t){t.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}},{}],303:[function(e,t){t.exports=function(){var e=new Float32Array(3);return e[0]=0,e[1]=0,e[2]=0,e}},{}],304:[function(e,t){t.exports=function(e,t,a){var o=t[0],r=t[1],i=t[2],n=a[0],l=a[1],s=a[2];return e[0]=r*s-i*l,e[1]=i*n-o*s,e[2]=o*l-r*n,e}},{}],305:[function(e,t){t.exports=e("./distance")},{"./distance":306}],306:[function(e,t){t.exports=function(e,t){var a=t[0]-e[0],o=t[1]-e[1],r=t[2]-e[2];return Math.sqrt(a*a+o*o+r*r)}},{}],307:[function(e,t){t.exports=e("./divide")},{"./divide":308}],308:[function(e,t){t.exports=function(e,t,a){return e[0]=t[0]/a[0],e[1]=t[1]/a[1],e[2]=t[2]/a[2],e}},{}],309:[function(e,t){t.exports=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}},{}],310:[function(e,t){t.exports=1e-6},{}],311:[function(e,t){var o=Math.abs,r=Math.max;t.exports=function(e,t){var a=e[0],n=e[1],l=e[2],s=t[0],d=t[1],c=t[2];return o(a-s)<=i*r(1,o(a),o(s))&&o(n-d)<=i*r(1,o(n),o(d))&&o(l-c)<=i*r(1,o(l),o(c))};var i=e("./epsilon")},{"./epsilon":310}],312:[function(e,t){t.exports=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}},{}],313:[function(e,t){var o=Math.floor;t.exports=function(e,t){return e[0]=o(t[0]),e[1]=o(t[1]),e[2]=o(t[2]),e}},{}],314:[function(e,t){var o=Math.min;t.exports=function(e,t,a,n,s,d){var c,p;for(t||(t=3),a||(a=0),p=n?o(n*t+a,e.length):e.length,c=a;c<p;c+=t)r[0]=e[c],r[1]=e[c+1],r[2]=e[c+2],s(r,r,d),e[c]=r[0],e[c+1]=r[1],e[c+2]=r[2];return e};var r=e("./create")()},{"./create":303}],315:[function(e,t){t.exports=function(e,t,a){var o=new Float32Array(3);return o[0]=e,o[1]=t,o[2]=a,o}},{}],316:[function(e,t){t.exports={EPSILON:e("./epsilon"),create:e("./create"),clone:e("./clone"),angle:e("./angle"),fromValues:e("./fromValues"),copy:e("./copy"),set:e("./set"),equals:e("./equals"),exactEquals:e("./exactEquals"),add:e("./add"),subtract:e("./subtract"),sub:e("./sub"),multiply:e("./multiply"),mul:e("./mul"),divide:e("./divide"),div:e("./div"),min:e("./min"),max:e("./max"),floor:e("./floor"),ceil:e("./ceil"),round:e("./round"),scale:e("./scale"),scaleAndAdd:e("./scaleAndAdd"),distance:e("./distance"),dist:e("./dist"),squaredDistance:e("./squaredDistance"),sqrDist:e("./sqrDist"),length:e("./length"),len:e("./len"),squaredLength:e("./squaredLength"),sqrLen:e("./sqrLen"),negate:e("./negate"),inverse:e("./inverse"),normalize:e("./normalize"),dot:e("./dot"),cross:e("./cross"),lerp:e("./lerp"),random:e("./random"),transformMat4:e("./transformMat4"),transformMat3:e("./transformMat3"),transformQuat:e("./transformQuat"),rotateX:e("./rotateX"),rotateY:e("./rotateY"),rotateZ:e("./rotateZ"),forEach:e("./forEach")}},{"./add":298,"./angle":299,"./ceil":300,"./clone":301,"./copy":302,"./create":303,"./cross":304,"./dist":305,"./distance":306,"./div":307,"./divide":308,"./dot":309,"./epsilon":310,"./equals":311,"./exactEquals":312,"./floor":313,"./forEach":314,"./fromValues":315,"./inverse":317,"./len":318,"./length":319,"./lerp":320,"./max":321,"./min":322,"./mul":323,"./multiply":324,"./negate":325,"./normalize":326,"./random":327,"./rotateX":328,"./rotateY":329,"./rotateZ":330,"./round":331,"./scale":332,"./scaleAndAdd":333,"./set":334,"./sqrDist":335,"./sqrLen":336,"./squaredDistance":337,"./squaredLength":338,"./sub":339,"./subtract":340,"./transformMat3":341,"./transformMat4":342,"./transformQuat":343}],317:[function(e,t){t.exports=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}},{}],318:[function(e,t){t.exports=e("./length")},{"./length":319}],319:[function(e,t){t.exports=function(e){var t=e[0],a=e[1],o=e[2];return Math.sqrt(t*t+a*a+o*o)}},{}],320:[function(e,t){t.exports=function(e,o,a,r){var t=o[0],i=o[1],n=o[2];return e[0]=t+r*(a[0]-t),e[1]=i+r*(a[1]-i),e[2]=n+r*(a[2]-n),e}},{}],321:[function(e,t){var o=Math.max;t.exports=function(e,t,a){return e[0]=o(t[0],a[0]),e[1]=o(t[1],a[1]),e[2]=o(t[2],a[2]),e}},{}],322:[function(e,t){var o=Math.min;t.exports=function(e,t,a){return e[0]=o(t[0],a[0]),e[1]=o(t[1],a[1]),e[2]=o(t[2],a[2]),e}},{}],323:[function(e,t){t.exports=e("./multiply")},{"./multiply":324}],324:[function(e,t){t.exports=function(e,t,a){return e[0]=t[0]*a[0],e[1]=t[1]*a[1],e[2]=t[2]*a[2],e}},{}],325:[function(e,t){t.exports=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}},{}],326:[function(e,t){var o=Math.sqrt;t.exports=function(e,t){var a=t[0],r=t[1],i=t[2],n=a*a+r*r+i*i;return 0<n&&(n=1/o(n),e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n),e}},{}],327:[function(e,t){var a=Math.cos,o=Math.sqrt,i=Math.PI,n=Math.sin;t.exports=function(e,t){t=t||1;var l=2*Math.random()*i,r=2*Math.random()-1,s=o(1-r*r)*t;return e[0]=a(l)*s,e[1]=n(l)*s,e[2]=r*t,e}},{}],328:[function(e,t){var o=Math.cos,r=Math.sin;t.exports=function(e,t,a,i){var n=a[1],l=a[2],s=t[1]-n,d=t[2]-l,c=r(i),p=o(i);return e[0]=t[0],e[1]=n+s*p-d*c,e[2]=l+s*c+d*p,e}},{}],329:[function(e,t){var o=Math.cos,r=Math.sin;t.exports=function(e,t,a,i){var n=a[0],l=a[2],s=t[0]-n,d=t[2]-l,c=r(i),p=o(i);return e[0]=n+d*c+s*p,e[1]=t[1],e[2]=l+d*p-s*c,e}},{}],330:[function(e,t){var o=Math.cos,r=Math.sin;t.exports=function(e,t,a,i){var n=a[0],l=a[1],s=t[0]-n,d=t[1]-l,c=r(i),p=o(i);return e[0]=n+s*p-d*c,e[1]=l+s*c+d*p,e[2]=t[2],e}},{}],331:[function(e,t){var o=Math.round;t.exports=function(e,t){return e[0]=o(t[0]),e[1]=o(t[1]),e[2]=o(t[2]),e}},{}],332:[function(e,t){t.exports=function(e,t,a){return e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e}},{}],333:[function(e,t){t.exports=function(e,t,a,o){return e[0]=t[0]+a[0]*o,e[1]=t[1]+a[1]*o,e[2]=t[2]+a[2]*o,e}},{}],334:[function(e,t){t.exports=function(e,t,a,o){return e[0]=t,e[1]=a,e[2]=o,e}},{}],335:[function(e,t){t.exports=e("./squaredDistance")},{"./squaredDistance":337}],336:[function(e,t){t.exports=e("./squaredLength")},{"./squaredLength":338}],337:[function(e,t){t.exports=function(e,t){var a=t[0]-e[0],o=t[1]-e[1],r=t[2]-e[2];return a*a+o*o+r*r}},{}],338:[function(e,t){t.exports=function(e){var t=e[0],a=e[1],o=e[2];return t*t+a*a+o*o}},{}],339:[function(e,t){t.exports=e("./subtract")},{"./subtract":340}],340:[function(e,t){t.exports=function(e,t,a){return e[0]=t[0]-a[0],e[1]=t[1]-a[1],e[2]=t[2]-a[2],e}},{}],341:[function(e,t){t.exports=function(e,t,a){var o=t[0],r=t[1],i=t[2];return e[0]=o*a[0]+r*a[3]+i*a[6],e[1]=o*a[1]+r*a[4]+i*a[7],e[2]=o*a[2]+r*a[5]+i*a[8],e}},{}],342:[function(e,t){t.exports=function(e,t,a){var o=t[0],r=t[1],i=t[2],n=a[3]*o+a[7]*r+a[11]*i+a[15];return n=n||1,e[0]=(a[0]*o+a[4]*r+a[8]*i+a[12])/n,e[1]=(a[1]*o+a[5]*r+a[9]*i+a[13])/n,e[2]=(a[2]*o+a[6]*r+a[10]*i+a[14])/n,e}},{}],343:[function(e,t){t.exports=function(e,t,a){var o=t[0],r=t[1],i=t[2],n=a[0],l=a[1],s=a[2],d=a[3],c=d*o+l*i-s*r,p=d*r+s*o-n*i,u=d*i+n*r-l*o,g=-n*o-l*r-s*i;return e[0]=c*d+g*-n+p*-s-u*-l,e[1]=p*d+g*-l+u*-n-c*-s,e[2]=u*d+g*-s+c*-l-p*-n,e}},{}],344:[function(e,t){t.exports=function(e,t,a){return e[0]=t[0]+a[0],e[1]=t[1]+a[1],e[2]=t[2]+a[2],e[3]=t[3]+a[3],e}},{}],345:[function(e,t){t.exports=function(e){var t=new Float32Array(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}},{}],346:[function(e,t){t.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}},{}],347:[function(e,t){t.exports=function(){var e=new Float32Array(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}},{}],348:[function(e,t){t.exports=function(e,t){var a=t[0]-e[0],o=t[1]-e[1],r=t[2]-e[2],i=t[3]-e[3];return Math.sqrt(a*a+o*o+r*r+i*i)}},{}],349:[function(e,t){t.exports=function(e,t,a){return e[0]=t[0]/a[0],e[1]=t[1]/a[1],e[2]=t[2]/a[2],e[3]=t[3]/a[3],e}},{}],350:[function(e,t){t.exports=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}},{}],351:[function(e,t){t.exports=function(e,t,a,o){var r=new Float32Array(4);return r[0]=e,r[1]=t,r[2]=a,r[3]=o,r}},{}],352:[function(e,t){t.exports={create:e("./create"),clone:e("./clone"),fromValues:e("./fromValues"),copy:e("./copy"),set:e("./set"),add:e("./add"),subtract:e("./subtract"),multiply:e("./multiply"),divide:e("./divide"),min:e("./min"),max:e("./max"),scale:e("./scale"),scaleAndAdd:e("./scaleAndAdd"),distance:e("./distance"),squaredDistance:e("./squaredDistance"),length:e("./length"),squaredLength:e("./squaredLength"),negate:e("./negate"),inverse:e("./inverse"),normalize:e("./normalize"),dot:e("./dot"),lerp:e("./lerp"),random:e("./random"),transformMat4:e("./transformMat4"),transformQuat:e("./transformQuat")}},{"./add":344,"./clone":345,"./copy":346,"./create":347,"./distance":348,"./divide":349,"./dot":350,"./fromValues":351,"./inverse":353,"./length":354,"./lerp":355,"./max":356,"./min":357,"./multiply":358,"./negate":359,"./normalize":360,"./random":361,"./scale":362,"./scaleAndAdd":363,"./set":364,"./squaredDistance":365,"./squaredLength":366,"./subtract":367,"./transformMat4":368,"./transformQuat":369}],353:[function(e,t){t.exports=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}},{}],354:[function(e,t){t.exports=function(e){var t=e[0],a=e[1],o=e[2],r=e[3];return Math.sqrt(t*t+a*a+o*o+r*r)}},{}],355:[function(e,t){t.exports=function(e,o,a,r){var t=o[0],i=o[1],n=o[2],l=o[3];return e[0]=t+r*(a[0]-t),e[1]=i+r*(a[1]-i),e[2]=n+r*(a[2]-n),e[3]=l+r*(a[3]-l),e}},{}],356:[function(e,t){var o=Math.max;t.exports=function(e,t,a){return e[0]=o(t[0],a[0]),e[1]=o(t[1],a[1]),e[2]=o(t[2],a[2]),e[3]=o(t[3],a[3]),e}},{}],357:[function(e,t){var o=Math.min;t.exports=function(e,t,a){return e[0]=o(t[0],a[0]),e[1]=o(t[1],a[1]),e[2]=o(t[2],a[2]),e[3]=o(t[3],a[3]),e}},{}],358:[function(e,t){t.exports=function(e,t,a){return e[0]=t[0]*a[0],e[1]=t[1]*a[1],e[2]=t[2]*a[2],e[3]=t[3]*a[3],e}},{}],359:[function(e,t){t.exports=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}},{}],360:[function(e,t){var o=Math.sqrt;t.exports=function(e,t){var a=t[0],r=t[1],i=t[2],n=t[3],l=a*a+r*r+i*i+n*n;return 0<l&&(l=1/o(l),e[0]=a*l,e[1]=r*l,e[2]=i*l,e[3]=n*l),e}},{}],361:[function(e,t){var a=e("./normalize"),o=e("./scale");t.exports=function(e,t){return t=t||1,e[0]=Math.random(),e[1]=Math.random(),e[2]=Math.random(),e[3]=Math.random(),a(e,e),o(e,e,t),e}},{"./normalize":360,"./scale":362}],362:[function(e,t){t.exports=function(e,t,a){return e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e[3]=t[3]*a,e}},{}],363:[function(e,t){t.exports=function(e,t,a,o){return e[0]=t[0]+a[0]*o,e[1]=t[1]+a[1]*o,e[2]=t[2]+a[2]*o,e[3]=t[3]+a[3]*o,e}},{}],364:[function(e,t){t.exports=function(e,t,a,o,r){return e[0]=t,e[1]=a,e[2]=o,e[3]=r,e}},{}],365:[function(e,t){t.exports=function(e,t){var a=t[0]-e[0],o=t[1]-e[1],r=t[2]-e[2],i=t[3]-e[3];return a*a+o*o+r*r+i*i}},{}],366:[function(e,t){t.exports=function(e){var t=e[0],a=e[1],o=e[2],r=e[3];return t*t+a*a+o*o+r*r}},{}],367:[function(e,t){t.exports=function(e,t,a){return e[0]=t[0]-a[0],e[1]=t[1]-a[1],e[2]=t[2]-a[2],e[3]=t[3]-a[3],e}},{}],368:[function(e,t){t.exports=function(e,t,a){var o=t[0],r=t[1],i=t[2],n=t[3];return e[0]=a[0]*o+a[4]*r+a[8]*i+a[12]*n,e[1]=a[1]*o+a[5]*r+a[9]*i+a[13]*n,e[2]=a[2]*o+a[6]*r+a[10]*i+a[14]*n,e[3]=a[3]*o+a[7]*r+a[11]*i+a[15]*n,e}},{}],369:[function(e,t){t.exports=function(e,t,a){var o=t[0],r=t[1],i=t[2],n=a[0],l=a[1],s=a[2],d=a[3],c=d*o+l*i-s*r,p=d*r+s*o-n*i,u=d*i+n*r-l*o,g=-n*o-l*r-s*i;return e[0]=c*d+g*-n+p*-s-u*-l,e[1]=p*d+g*-l+u*-n-c*-s,e[2]=u*d+g*-s+c*-l-p*-n,e[3]=t[3],e}},{}],370:[function(e,t){var a=e("glsl-tokenizer"),o=e("atob-lite");t.exports=function(e){for(var t=Array.isArray(e)?e:a(e),r=0,n;r<t.length;r++)if(n=t[r],"preprocessor"===n.type){var l=n.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(l&&l[2]){var s=l[1],d=l[2];return(s?o(d):d).trim()}}}},{"atob-lite":24,"glsl-tokenizer":377}],371:[function(e,t){t.exports=function(e){function t(e){e.length&&C.push({type:s[A],data:e,position:I,line:L,column:E})}function d(e){k=0,e.toString&&(e=e.toString()),D+=e.replace(/\r\n/g,"\n"),M=D.length;for(var t;O=D[k],k<M;)if(t=k,0===A?k=y():1===A?k=h():2===A?k=m():3===A?k=f():4===A?k=b():11===A?k=_():5===A?k=v():9999===A?k=w():9===A?k=g():999===A?k=u():void 0,t!==k)switch(D[t]){case"\n":E=0,++L;break;default:++E;}return T+=k,D=D.slice(k),C}function p(){return S.length&&t(S.join("")),A=10,t("(eof)"),C}function u(){return(S=S.length?[]:S,"/"===R&&"*"===O)?(I=T+k-1,A=0,R=O,k+1):"/"===R&&"/"===O?(I=T+k-1,A=1,R=O,k+1):"#"===O?(A=2,I=T+k,k):/\s/.test(O)?(A=9,I=T+k,k):(P=/\d/.test(O),z=/[^\w_]/.test(O),I=T+k,A=P?4:z?3:9999,k)}function g(){return /[^\s]/g.test(O)?(t(S.join("")),A=999,k):(S.push(O),R=O,k+1)}function m(){return("\r"===O||"\n"===O)&&"\\"!==R?(t(S.join("")),A=999,k):(S.push(O),R=O,k+1)}function h(){return m()}function y(){return"/"===O&&"*"===R?(S.push(O),t(S.join("")),A=999,k+1):(S.push(O),R=O,k+1)}function f(){if("."===R&&/\d/.test(O))return A=5,k;if("/"===R&&"*"===O)return A=0,k;if("/"===R&&"/"===O)return A=1,k;if("."===O&&S.length){for(;x(S););return A=5,k}if(";"===O||")"===O||"("===O){if(S.length)for(;x(S););return t(O),A=999,k+1}var e=2===S.length&&"="!==O;if(/[\w_\d\s]/.test(O)||e){for(;x(S););return A=999,k}return S.push(O),R=O,k+1}function x(e){var a=0,r,i;do{if(r=o.indexOf(e.slice(0,e.length+a).join("")),i=o[r],-1===r){if(0<a--+e.length)continue;i=e.slice(0,1).join("")}return t(i),I+=i.length,S=S.slice(i.length),S.length}while(1)}function _(){return /[^a-fA-F0-9]/.test(O)?(t(S.join("")),A=999,k):(S.push(O),R=O,k+1)}function b(){return"."===O?(S.push(O),A=5,R=O,k+1):/[eE]/.test(O)?(S.push(O),A=5,R=O,k+1):"x"===O&&1===S.length&&"0"===S[0]?(A=11,S.push(O),R=O,k+1):/[^\d]/.test(O)?(t(S.join("")),A=999,k):(S.push(O),R=O,k+1)}function v(){return("f"===O&&(S.push(O),R=O,k+=1),/[eE]/.test(O))?(S.push(O),R=O,k+1):("-"===O||"+"===O)&&/[eE]/.test(R)?(S.push(O),R=O,k+1):/[^\d]/.test(O)?(t(S.join("")),A=999,k):(S.push(O),R=O,k+1)}function w(){if(/[^\d\w_]/.test(O)){var e=S.join("");return A=N[e]?8:F[e]?7:6,t(S.join("")),A=999,k}return S.push(O),R=O,k+1}var k=0,T=0,A=999,S=[],C=[],L=1,E=0,I=0,P=!1,z=!1,D="",O,R,M;e=e||{};var j=r,B=a;"300 es"===e.version&&(j=l,B=n);for(var F={},N={},k=0;k<j.length;k++)F[j[k]]=!0;for(var k=0;k<B.length;k++)N[B[k]]=!0;return function(e){return C=[],null===e?p():d(e)}};var a=e("./lib/literals"),o=e("./lib/operators"),r=e("./lib/builtins"),n=e("./lib/literals-300es"),l=e("./lib/builtins-300es"),s=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},{"./lib/builtins":373,"./lib/builtins-300es":372,"./lib/literals":375,"./lib/literals-300es":374,"./lib/operators":376}],372:[function(e,t){var a=e("./builtins");a=a.slice().filter(function(e){return!/^(gl\_|texture)/.test(e)}),t.exports=a.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},{"./builtins":373}],373:[function(e,t){t.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},{}],374:[function(e,t){var a=e("./literals");t.exports=a.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},{"./literals":375}],375:[function(e,t){t.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],376:[function(e,t){t.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],377:[function(e,t){var a=e("./index");t.exports=function(e,t){var o=a(t),r=[];return r=r.concat(o(e)),r=r.concat(o(null)),r}},{"./index":371}],378:[function(e,t){t.exports=function(e){"string"==typeof e&&(e=[e]);for(var t=[].slice.call(arguments,1),a=[],o=0;o<e.length-1;o++)a.push(e[o],t[o]||"");return a.push(e[o]),a.join("")}},{}],379:[function(e,t){(function(a){'use strict';var o=e("is-browser"),r;r="function"==typeof a.matchMedia?!a.matchMedia("(hover: none)").matches:o,t.exports=r}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"is-browser":386}],380:[function(e,t){'use strict';var a=e("is-browser");t.exports=a&&function(){var t=!1;try{var a=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("test",null,a),window.removeEventListener("test",null,a)}catch(a){t=!1}return t}()},{"is-browser":386}],381:[function(e,t){"use strict";function a(e,t,a){this.vertices=e,this.adjacent=t,this.boundary=a,this.lastVisited=-1}function o(e,t,a){this.vertices=e,this.cell=t,this.index=a}function r(e,t){return d(e.vertices,t.vertices)}function n(e){for(var t=["function orient(){var tuple=this.tuple;return test("],a=0;a<=e;++a)0<a&&t.push(","),t.push("tuple[",a,"]");t.push(")}return orient");var o=new Function("test",t.join("")),r=s[e+1];return r||(r=s),o(r)}function l(e,t,a){this.dimension=e,this.vertices=t,this.simplices=a,this.interior=a.filter(function(e){return!e.boundary}),this.tuple=Array(e+1);for(var r=0;r<=e;++r)this.tuple[r]=this.vertices[r];var l=c[e];l||(l=c[e]=n(e)),this.orient=l}t.exports=function(e,r){var c=e.length;if(0===c)throw new Error("Must have at least d+1 points");var n=e[0].length;if(c<=n)throw new Error("Must input at least d+1 points");var d=e.slice(0,n+1),p=s.apply(void 0,d);if(0===p)throw new Error("Input not in general position");for(var o=Array(n+1),u=0;u<=n;++u)o[u]=u;0>p&&(o[0]=1,o[1]=0);for(var g=new a(o,Array(n+1),!1),m=g.adjacent,h=Array(n+2),u=0,y;u<=n;++u){y=o.slice();for(var f=0;f<=n;++f)f===u&&(y[f]=-1);var x=y[0];y[0]=y[1],y[1]=x;var t=new a(y,Array(n+1),!0);m[u]=t,h[u]=t}h[n+1]=g;for(var u=0;u<=n;++u)for(var y=m[u].vertices,_=m[u].adjacent,f=0,b;f<=n;++f){if(b=y[f],0>b){_[f]=g;continue}for(var w=0;w<=n;++w)0>m[w].vertices.indexOf(b)&&(_[f]=m[w])}for(var T=new l(n,d,h),u=n+1;u<c;++u)T.insert(e[u],!!r);return T.boundary()};var s=e("robust-orientation"),d=e("simplicial-complex").compareCells;a.prototype.flip=function(){var e=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=e;var t=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=t};var c=[],p=l.prototype;p.handleBoundaryDegeneracy=function(e,t){var a=this.dimension,r=this.vertices.length-1,n=this.tuple,l=this.vertices,s=[e];for(e.lastVisited=-r;0<s.length;){e=s.pop();for(var d=e.vertices,c=e.adjacent,p=0,u;p<=a;++p)if(u=c[p],u.boundary&&!(u.lastVisited<=-r)){for(var g=u.vertices,m=0,h;m<=a;++m)h=g[m],n[m]=0>h?t:l[h];var y=this.orient();if(0<y)return u;u.lastVisited=-r,0===y&&s.push(u)}}return null},p.walk=function(e,t){var a=this.vertices.length-1,r=this.dimension,n=this.vertices,l=this.tuple,s=t?0|this.interior.length*Math.random():this.interior.length-1,d=this.interior[s];outerLoop:for(;!d.boundary;){for(var c=d.vertices,p=d.adjacent,u=0;u<=r;++u)l[u]=n[c[u]];d.lastVisited=a;for(var u=0,g;u<=r;++u)if(g=p[u],!(g.lastVisited>=a)){var m=l[u];l[u]=e;var h=this.orient();if(l[u]=m,0>h){d=g;continue outerLoop}else g.lastVisited=g.boundary?-a:a}return}return d},p.addPeaks=function(e,t){var l=this.vertices.length-1,n=this.dimension,s=this.vertices,d=this.tuple,c=this.interior,p=this.simplices,u=[t];t.lastVisited=l,t.vertices[t.vertices.indexOf(-1)]=l,t.boundary=!1,c.push(t);for(var g=[];0<u.length;){var t=u.pop(),m=t.vertices,h=t.adjacent,y=m.indexOf(l);if(!(0>y))for(var f=0;f<=n;++f)if(f!==y){var x=h[f];if(x.boundary&&!(x.lastVisited>=l)){var _=x.vertices;if(x.lastVisited!==-l){for(var v=0,w=0;w<=n;++w)0>_[w]?(v=w,d[w]=e):d[w]=s[_[w]];var T=this.orient();if(0<T){_[v]=l,x.boundary=!1,c.push(x),u.push(x),x.lastVisited=l;continue}else x.lastVisited=-l}var A=x.adjacent,S=m.slice(),C=h.slice(),L=new a(S,C,!0);p.push(L);var E=A.indexOf(t);if(!(0>E)){A[E]=L,C[y]=x,S[f]=-1,C[f]=t,h[f]=L,L.flip();for(var w=0,I;w<=n;++w)if(I=S[w],!(0>I||I===l)){for(var P=Array(n-1),z=0,D=0,O;D<=n;++D)(O=S[D],!(0>O||D===w))&&(P[z++]=O);g.push(new o(P,L,w))}}}}}g.sort(r);for(var f=0;f+1<g.length;f+=2){var R=g[f],M=g[f+1],b=R.index,B=M.index;0>b||0>B||(R.cell.adjacent[R.index]=M.cell,M.cell.adjacent[M.index]=R.cell)}},p.insert=function(e,t){var a=this.vertices;a.push(e);var r=this.walk(e,t);if(r){for(var n=this.dimension,l=this.tuple,s=0,d;s<=n;++s)d=r.vertices[s],l[s]=0>d?e:a[d];var c=this.orient(l);0>c||0===c&&(r=this.handleBoundaryDegeneracy(r,e),!r)||this.addPeaks(e,r)}},p.boundary=function(){for(var e=this.dimension,a=[],o=this.simplices,r=o.length,n=0,l;n<r;++n)if(l=o[n],l.boundary){for(var s=Array(e),d=l.vertices,p=0,u=0,g=0;g<=e;++g)0<=d[g]?s[p++]=d[g]:u=1&g;if(u===(1&e)){var m=s[0];s[0]=s[1],s[1]=m}a.push(s)}return a}},{"robust-orientation":1277,"simplicial-complex":1291}],382:[function(e,t){"use strict";function a(e,t,a,o,r){this.mid=e,this.left=t,this.right=a,this.leftPoints=o,this.rightPoints=r,this.count=(t?t.count:0)+(a?a.count:0)+o.length}function o(e,t){e.mid=t.mid,e.left=t.left,e.right=t.right,e.leftPoints=t.leftPoints,e.rightPoints=t.rightPoints,e.count=t.count}function r(e,t){var a=g(t);e.mid=a.mid,e.left=a.left,e.right=a.right,e.leftPoints=a.leftPoints,e.rightPoints=a.rightPoints,e.count=a.count}function i(e,t){var a=e.intervals([]);a.push(t),r(e,a)}function n(e,t){var a=e.intervals([]),o=a.indexOf(t);return 0>o?0:(a.splice(o,1),r(e,a),1)}function l(e,t,a){for(var o=0,n;o<e.length&&e[o][0]<=t;++o)if(n=a(e[o]),n)return n}function s(e,t,a){for(var o=e.length-1,n;0<=o&&e[o][1]>=t;--o)if(n=a(e[o]),n)return n}function d(e,t){for(var a=0,o;a<e.length;++a)if(o=t(e[a]),o)return o}function c(e,t){return e-t}function p(e,t){var a=e[0]-t[0];return a?a:e[1]-t[1]}function u(e,t){var a=e[1]-t[1];return a?a:e[0]-t[0]}function g(e){if(0===e.length)return null;for(var t=[],o=0;o<e.length;++o)t.push(e[o][0],e[o][1]);t.sort(c);for(var r=t[t.length>>1],n=[],l=[],d=[],o=0,m;o<e.length;++o)m=e[o],m[1]<r?n.push(m):r<m[0]?l.push(m):d.push(m);var h=d,y=d.slice();return h.sort(p),y.sort(u),new a(r,g(n),g(l),h,y)}function m(e){this.root=e}var h=e("binary-search-bounds"),y=0,f=1,x=2;t.exports=function(e){return e&&0!==e.length?new m(g(e)):new m(null)};var _=a.prototype;_.intervals=function(e){return e.push.apply(e,this.leftPoints),this.left&&this.left.intervals(e),this.right&&this.right.intervals(e),e},_.insert=function(e){var t=this.count-this.leftPoints.length;if(this.count+=1,e[1]<this.mid)this.left?4*(this.left.count+1)>3*(t+1)?i(this,e):this.left.insert(e):this.left=g([e]);else if(e[0]>this.mid)this.right?4*(this.right.count+1)>3*(t+1)?i(this,e):this.right.insert(e):this.right=g([e]);else{var a=h.ge(this.leftPoints,e,p),o=h.ge(this.rightPoints,e,u);this.leftPoints.splice(a,0,e),this.rightPoints.splice(o,0,e)}},_.remove=function(e){var t=this.count-this.leftPoints;if(e[1]<this.mid){if(!this.left)return y;var a=this.right?this.right.count:0;if(4*a>3*(t-1))return n(this,e);var i=this.left.remove(e);return i===x?(this.left=null,this.count-=1,f):(i===f&&(this.count-=1),i)}if(e[0]>this.mid){if(!this.right)return y;var s=this.left?this.left.count:0;if(4*s>3*(t-1))return n(this,e);var i=this.right.remove(e);return i===x?(this.right=null,this.count-=1,f):(i===f&&(this.count-=1),i)}if(1===this.count)return this.leftPoints[0]===e?x:y;if(1===this.leftPoints.length&&this.leftPoints[0]===e){if(this.left&&this.right){for(var d=this,c=this.left;c.right;)d=c,c=c.right;if(d===this)c.right=this.right;else{var g=this.left,i=this.right;d.count-=c.count,d.right=c.left,c.left=g,c.right=i}o(this,c),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?o(this,this.left):o(this,this.right);return f}for(var g=h.ge(this.leftPoints,e,p);g<this.leftPoints.length&&this.leftPoints[g][0]===e[0];++g)if(this.leftPoints[g]===e){this.count-=1,this.leftPoints.splice(g,1);for(var i=h.ge(this.rightPoints,e,u);i<this.rightPoints.length&&this.rightPoints[i][1]===e[1];++i)if(this.rightPoints[i]===e)return this.rightPoints.splice(i,1),f}return y},_.queryPoint=function(e,t){if(e<this.mid){if(this.left){var a=this.left.queryPoint(e,t);if(a)return a}return l(this.leftPoints,e,t)}if(e>this.mid){if(this.right){var a=this.right.queryPoint(e,t);if(a)return a}return s(this.rightPoints,e,t)}return d(this.leftPoints,t)},_.queryInterval=function(e,t,a){if(e<this.mid&&this.left){var o=this.left.queryInterval(e,t,a);if(o)return o}if(t>this.mid&&this.right){var o=this.right.queryInterval(e,t,a);if(o)return o}return t<this.mid?l(this.leftPoints,t,a):e>this.mid?s(this.rightPoints,e,a):d(this.leftPoints,a)};var b=m.prototype;b.insert=function(e){this.root?this.root.insert(e):this.root=new a(e[0],null,null,[e],[e])},b.remove=function(e){if(this.root){var t=this.root.remove(e);return t===x&&(this.root=null),t!==y}return!1},b.queryPoint=function(e,t){if(this.root)return this.root.queryPoint(e,t)},b.queryInterval=function(e,t,a){if(e<=t&&this.root)return this.root.queryInterval(e,t,a)},Object.defineProperty(b,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(b,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}})},{"binary-search-bounds":383}],383:[function(e,t,a){arguments[4][204][0].apply(a,arguments)},{dup:204}],384:[function(e,t){"use strict";t.exports=function(e,t){t=t||Array(e.length);for(var a=0;a<e.length;++a)t[e[a]]=a;return t}},{}],385:[function(e,t){"use strict";t.exports=function(e){for(var t=Array(e),a=0;a<e;++a)t[a]=a;return t}},{}],386:[function(e,t){t.exports=!0},{}],387:[function(e,t){function a(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function o(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&a(e.slice(0,0))}/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */t.exports=function(e){return null!=e&&(a(e)||o(e)||!!e._isBuffer)}},{}],388:[function(e,t){'use strict';t.exports="undefined"!=typeof navigator&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion))},{}],389:[function(e,t){'use strict';function a(e){e||(e={});var t=e.ua;if(t||"undefined"==typeof navigator||(t=navigator.userAgent),t&&t.headers&&"string"==typeof t.headers["user-agent"]&&(t=t.headers["user-agent"]),"string"!=typeof t)return!1;var a=e.tablet?r.test(t):o.test(t);return!a&&e.tablet&&e.featureDetect&&navigator&&1<navigator.maxTouchPoints&&-1!==t.indexOf("Macintosh")&&-1!==t.indexOf("Safari")&&(a=!0),a}t.exports=a,t.exports.isMobile=a,t.exports.default=a;var o=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,r=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i},{}],390:[function(e,t){'use strict';t.exports=function(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}},{}],391:[function(e,t){'use strict';var a=Object.prototype.toString;t.exports=function(e){var t;return"[object Object]"===a.call(e)&&(t=Object.getPrototypeOf(e),null===t||t===Object.getPrototypeOf({}))}},{}],392:[function(e,t){'use strict';t.exports=function(e){for(var t=e.length,o=0,r;o<t;o++)if(r=e.charCodeAt(o),(9>r||13<r)&&32!==r&&133!==r&&160!==r&&5760!==r&&6158!==r&&(8192>r||8205<r)&&8232!==r&&8233!==r&&8239!==r&&8287!==r&&8288!==r&&12288!==r&&65279!==r)return!1;return!0}},{}],393:[function(e,t){'use strict';t.exports=function(e){return!("string"!=typeof e)&&(e=e.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(e)&&/[\dz]$/i.test(e)&&4<e.length))}},{}],394:[function(e,t,a){var o=Math.asin,r=Math.acos,i=Math.SQRT2,g=Math.exp,f=Math.log,x=Math.cos,_=Math.sqrt,v=Math.round,T=Math.PI,A=Math.sin,S=Math.min,C=Math.pow,L=Math.tan,E=Math.atan,I=Math.abs,P=Math.max,D=Math.floor;(function(e,o){"object"==typeof a?t.exports=o():"function"==typeof define&&define.amd?define(o):e.jStat=o()})(this,function(){var e=function(e){function t(e,t){var a=(0,eval)("this").Math.LOG10E,o=e>t?e:t;return C(10,17-~~(f(0<o?o:-o)*a))}function a(e){return"[object Function]"===c.call(e)}function o(e){return"number"==typeof e&&0==e-e}function r(){return new r._init(arguments)}function i(){return 0}function n(){return 1}function l(e,t){return e===t?1:0}var s=Array.prototype.concat,d=Array.prototype.slice,c=Object.prototype.toString,p=Array.isArray||function(e){return"[object Array]"===c.call(e)};r.fn=r.prototype,r._init=function(e){if(p(e[0])){if(p(e[0][0])){a(e[1])&&(e[0]=r.map(e[0],e[1]));for(var t=0;t<e[0].length;t++)this[t]=e[0][t];this.length=e[0].length}else this[0]=a(e[1])?r.map(e[0],e[1]):e[0],this.length=1;}else if(o(e[0]))this[0]=r.seq.apply(null,e),this.length=1;else{if(e[0]instanceof r)return r(e[0].toArray());this[0]=[],this.length=1}return this},r._init.prototype=r.prototype,r._init.constructor=r,r.utils={calcRdx:t,isArray:p,isFunction:a,isNumber:o,toVector:function(e){return s.apply([],e)}},r._random_fn=e.random,r.setRandom=function(e){if("function"!=typeof e)throw new TypeError("fn is not a function");r._random_fn=e},r.extend=function(e){var t,a;if(1===arguments.length){for(a in e)r[a]=e[a];return this}for(t=1;t<arguments.length;t++)for(a in arguments[t])e[a]=arguments[t][a];return e},r.rows=function(e){return e.length||1},r.cols=function(e){return e[0].length||1},r.dimensions=function(e){return{rows:r.rows(e),cols:r.cols(e)}},r.row=function(e,t){return p(t)?t.map(function(t){return r.row(e,t)}):e[t]},r.rowa=function(e,t){return r.row(e,t)},r.col=function(e,t){if(p(t)){var a=r.arange(e.length).map(function(){return Array(t.length)});return t.forEach(function(t,o){r.arange(e.length).forEach(function(r){a[r][o]=e[r][t]})}),a}for(var o=Array(e.length),n=0;n<e.length;n++)o[n]=[e[n][t]];return o},r.cola=function(e,t){return r.col(e,t).map(function(e){return e[0]})},r.diag=function(e){for(var t=r.rows(e),a=Array(t),o=0;o<t;o++)a[o]=[e[o][o]];return a},r.antidiag=function(e){for(var t=r.rows(e)-1,a=Array(t),o=0;0<=t;t--,o++)a[o]=[e[o][t]];return a},r.transpose=function(e){var t=[],a,o,r,n,l;for(p(e[0])||(e=[e]),o=e.length,r=e[0].length,l=0;l<r;l++){for(a=Array(o),n=0;n<o;n++)a[n]=e[n][l];t.push(a)}return 1===t.length?t[0]:t},r.map=function(e,t,a){var o,r,i,n,l;for(p(e[0])||(e=[e]),r=e.length,i=e[0].length,n=a?e:Array(r),o=0;o<r;o++)for(n[o]||(n[o]=Array(i)),l=0;l<i;l++)n[o][l]=t(e[o][l],o,l);return 1===n.length?n[0]:n},r.cumreduce=function(e,t,a){var o,r,i,n,l;for(p(e[0])||(e=[e]),r=e.length,i=e[0].length,n=a?e:Array(r),o=0;o<r;o++)for(n[o]||(n[o]=Array(i)),0<i&&(n[o][0]=e[o][0]),l=1;l<i;l++)n[o][l]=t(n[o][l-1],e[o][l]);return 1===n.length?n[0]:n},r.alter=function(e,t){return r.map(e,t,!0)},r.create=function(e,t,o){var r=Array(e),n,l;for(a(t)&&(o=t,t=e),n=0;n<e;n++)for(r[n]=Array(t),l=0;l<t;l++)r[n][l]=o(n,l);return r},r.zeros=function(e,t){return o(t)||(t=e),r.create(e,t,i)},r.ones=function(e,t){return o(t)||(t=e),r.create(e,t,n)},r.rand=function(e,t){return o(t)||(t=e),r.create(e,t,r._random_fn)},r.identity=function(e,t){return o(t)||(t=e),r.create(e,t,l)},r.symmetric=function(e){var t=e.length,a,o;if(e.length!==e[0].length)return!1;for(a=0;a<t;a++)for(o=0;o<t;o++)if(e[o][a]!==e[a][o])return!1;return!0},r.clear=function(e){return r.alter(e,i)},r.seq=function(e,o,r,i){a(i)||(i=!1);var n=[],l=t(e,o),s=e,d;for(d=0;s<=o&&d<r;d++,s=(e*l+(o*l-e*l)/((r-1)*l)*l*d)/l)n.push(i?i(s,d):s);return n},r.arange=function(e,t,a){var o=[],r;if(a=a||1,void 0===t&&(t=e,e=0),e===t||0===a)return[];if(e<t&&0>a)return[];if(e>t&&0<a)return[];if(0<a)for(r=e;r<t;r+=a)o.push(r);else for(r=e;r>t;r+=a)o.push(r);return o},r.slice=function(){function e(e,t,a,o){var n=[],l=e.length,s;if(void 0===t&&void 0===a&&void 0===o)return r.copy(e);if(t=t||0,a=a||e.length,t=0<=t?t:l+t,a=0<=a?a:l+a,o=o||1,t===a||0===o)return[];if(t<a&&0>o)return[];if(t>a&&0<o)return[];if(0<o)for(s=t;s<a;s+=o)n.push(e[s]);else for(s=t;s>a;s+=o)n.push(e[s]);return n}return function(t,a){var i,n;if(a=a||{},o(a.row)){if(o(a.col))return t[a.row][a.col];var l=r.rowa(t,a.row);return i=a.col||{},e(l,i.start,i.end,i.step)}if(o(a.col)){var s=r.cola(t,a.col);return n=a.row||{},e(s,n.start,n.end,n.step)}n=a.row||{},i=a.col||{};var d=e(t,n.start,n.end,n.step);return d.map(function(t){return e(t,i.start,i.end,i.step)})}}(),r.sliceAssign=function(e,t,a){var l,i;if(o(t.row)){if(o(t.col))return e[t.row][t.col]=a;t.col=t.col||{},t.col.start=t.col.start||0,t.col.end=t.col.end||e[0].length,t.col.step=t.col.step||1,l=r.arange(t.col.start,S(e.length,t.col.end),t.col.step);var s=t.row;return l.forEach(function(t,o){e[s][t]=a[o]}),e}if(o(t.col)){t.row=t.row||{},t.row.start=t.row.start||0,t.row.end=t.row.end||e.length,t.row.step=t.row.step||1,i=r.arange(t.row.start,S(e[0].length,t.row.end),t.row.step);var d=t.col;return i.forEach(function(t,o){e[t][d]=a[o]}),e}return void 0===a[0].length&&(a=[a]),t.row.start=t.row.start||0,t.row.end=t.row.end||e.length,t.row.step=t.row.step||1,t.col.start=t.col.start||0,t.col.end=t.col.end||e[0].length,t.col.step=t.col.step||1,i=r.arange(t.row.start,S(e.length,t.row.end),t.row.step),l=r.arange(t.col.start,S(e[0].length,t.col.end),t.col.step),i.forEach(function(t,o){l.forEach(function(r,i){e[t][r]=a[o][i]})}),e},r.diagonal=function(e){var a=r.zeros(e.length,e.length);return e.forEach(function(e,t){a[t][t]=e}),a},r.copy=function(e){return e.map(function(e){return o(e)?e:e.map(function(e){return e})})};var u=r.prototype;return u.length=0,u.push=Array.prototype.push,u.sort=Array.prototype.sort,u.splice=Array.prototype.splice,u.slice=Array.prototype.slice,u.toArray=function(){return 1<this.length?d.call(this):d.call(this)[0]},u.map=function(e,t){return r(r.map(this,e,t))},u.cumreduce=function(e,t){return r(r.cumreduce(this,e,t))},u.alter=function(e){return r.alter(this,e),this},function(e){for(var t=0;t<e.length;t++)(function(e){u[e]=function(t){var a=this,o;return t?(setTimeout(function(){t.call(a,u[e].call(a))}),this):(o=r[e](this),p(o)?r(o):o)}})(e[t])}(["transpose","clear","symmetric","rows","cols","dimensions","diag","antidiag"]),function(e){for(var t=0;t<e.length;t++)(function(e){u[e]=function(t,a){var o=this;return a?(setTimeout(function(){a.call(o,u[e].call(o,t))}),this):r(r[e](this,t))}})(e[t])}(["row","col"]),function(e){for(var t=0;t<e.length;t++)(function(e){u[e]=function(){return r(r[e].apply(null,arguments))}})(e[t])}(["create","zeros","ones","rand","identity"]),r}(Math);return function(e){function t(e,t){return e-t}function a(e,t,a){return P(t,S(e,a))}var o=e.utils.isFunction;e.sum=function e(t){for(var e=0,a=t.length;0<=--a;)e+=t[a];return e},e.sumsqrd=function(e){for(var t=0,a=e.length;0<=--a;)t+=e[a]*e[a];return t},e.sumsqerr=function(t){for(var a=e.mean(t),o=0,r=t.length,n;0<=--r;)n=t[r]-a,o+=n*n;return o},e.sumrow=function(e){for(var t=0,a=e.length;0<=--a;)t+=e[a];return t},e.product=function(e){for(var t=1,a=e.length;0<=--a;)t*=e[a];return t},e.min=function(e){for(var t=e[0],a=0;++a<e.length;)e[a]<t&&(t=e[a]);return t},e.max=function(e){for(var t=e[0],a=0;++a<e.length;)e[a]>t&&(t=e[a]);return t},e.unique=function(e){for(var t={},a=[],o=0;o<e.length;o++)t[e[o]]||(t[e[o]]=!0,a.push(e[o]));return a},e.mean=function(t){return e.sum(t)/t.length},e.meansqerr=function(t){return e.sumsqerr(t)/t.length},e.geomean=function(t){return C(e.product(t),1/t.length)},e.median=function(e){var a=e.length,o=e.slice().sort(t);return 1&a?o[0|a/2]:(o[a/2-1]+o[a/2])/2},e.cumsum=function(t){return e.cumreduce(t,function(e,t){return e+t})},e.cumprod=function(t){return e.cumreduce(t,function(e,t){return e*t})},e.diff=function(e){var t=[],a=e.length,o;for(o=1;o<a;o++)t.push(e[o]-e[o-1]);return t},e.rank=function(e){for(var a=e.length,o=e.slice().sort(t),r=Array(a),n=0,l;n<a;n++){var s=o.indexOf(e[n]),d=o.lastIndexOf(e[n]);l=s===d?s:(s+d)/2,r[n]=l+1}return r},e.mode=function(e){var a=e.length,o=e.slice().sort(t),r=1,n=0,l=0,s=[],d;for(d=0;d<a;d++)o[d]===o[d+1]?r++:(r>n?(s=[o[d]],n=r,l=0):r===n&&(s.push(o[d]),l++),r=1);return 0===l?s[0]:s},e.range=function(t){return e.max(t)-e.min(t)},e.variance=function(t,a){return e.sumsqerr(t)/(t.length-(a?1:0))},e.pooledvariance=function(t){var a=t.reduce(function(t,a){return t+e.sumsqerr(a)},0),o=t.reduce(function(e,t){return e+t.length},0);return a/(o-t.length)},e.deviation=function(t){for(var a=e.mean(t),o=t.length,r=Array(o),n=0;n<o;n++)r[n]=t[n]-a;return r},e.stdev=function(t,a){return _(e.variance(t,a))},e.pooledstdev=function(t){return _(e.pooledvariance(t))},e.meandev=function(t){for(var o=e.mean(t),r=[],a=t.length-1;0<=a;a--)r.push(I(t[a]-o));return e.mean(r)},e.meddev=function(t){for(var o=e.median(t),r=[],a=t.length-1;0<=a;a--)r.push(I(t[a]-o));return e.median(r)},e.coeffvar=function(t){return e.stdev(t)/e.mean(t)},e.quartiles=function(e){var a=e.length,o=e.slice().sort(t);return[o[v(a/4)-1],o[v(a/2)-1],o[v(3*a/4)-1]]},e.quantiles=function(e,o,r,l){var s=e.slice().sort(t),d=[o.length],c=e.length,n,u,g,h,y,f;for("undefined"==typeof r&&(r=3/8),"undefined"==typeof l&&(l=3/8),n=0;n<o.length;n++)u=o[n],g=r+u*(1-r-l),h=c*u+g,y=D(a(h,1,c-1)),f=a(h-y,0,1),d[n]=(1-f)*s[y-1]+f*s[y];return d},e.percentile=function(e,a,o){var r=e.slice().sort(t),i=a*(r.length+(o?1:-1))+(o?0:1),n=parseInt(i);return n+1<r.length?r[n-1]+(i-n)*(r[n]-r[n-1]):r[n-1]},e.percentileOfScore=function(e,t,a){var o=0,r=e.length,n=!1,l,s;for("strict"===a&&(n=!0),s=0;s<r;s++)l=e[s],(n&&l<t||!n&&l<=t)&&o++;return o/r},e.histogram=function(t,a){a=a||4;var o=e.min(t),r=(e.max(t)-o)/a,n=t.length,l=[],s;for(s=0;s<a;s++)l[s]=0;for(s=0;s<n;s++)l[S(D((t[s]-o)/r),a-1)]+=1;return l},e.covariance=function(t,a){var o=e.mean(t),r=e.mean(a),n=t.length,l=Array(n),s;for(s=0;s<n;s++)l[s]=(t[s]-o)*(a[s]-r);return e.sum(l)/(n-1)},e.corrcoeff=function(t,a){return e.covariance(t,a)/e.stdev(t,1)/e.stdev(a,1)},e.spearmancoeff=function(t,a){return t=e.rank(t),a=e.rank(a),e.corrcoeff(t,a)},e.stanMoment=function(t,a){for(var o=e.mean(t),r=e.stdev(t),n=t.length,l=0,s=0;s<n;s++)l+=C((t[s]-o)/r,a);return l/t.length},e.skewness=function(t){return e.stanMoment(t,3)},e.kurtosis=function(t){return e.stanMoment(t,4)-3};var r=e.prototype;(function(t){for(var a=0;a<t.length;a++)(function(t){r[t]=function(a,n){var l=[],s=0,d=this;if(o(a)&&(n=a,a=!1),n)return setTimeout(function(){n.call(d,r[t].call(d,a))}),this;if(1<this.length){for(d=!0===a?this:this.transpose();s<d.length;s++)l[s]=e[t](d[s]);return l}return e[t](this[0],a)}})(t[a])})(["cumsum","cumprod"]),function(t){for(var a=0;a<t.length;a++)(function(t){r[t]=function(a,n){var l=[],s=0,d=this;if(o(a)&&(n=a,a=!1),n)return setTimeout(function(){n.call(d,r[t].call(d,a))}),this;if(1<this.length){for("sumrow"!==t&&(d=!0===a?this:this.transpose());s<d.length;s++)l[s]=e[t](d[s]);return!0===a?e[t](e.utils.toVector(l)):l}return e[t](this[0],a)}})(t[a])}(["sum","sumsqrd","sumsqerr","sumrow","product","min","max","unique","mean","meansqerr","geomean","median","diff","rank","mode","range","variance","deviation","stdev","meandev","meddev","coeffvar","quartiles","histogram","skewness","kurtosis"]),function(t){for(var a=0;a<t.length;a++)(function(t){r[t]=function(){var a=[],n=0,l=this,s=Array.prototype.slice.call(arguments),d;if(o(s[s.length-1])){d=s[s.length-1];var c=s.slice(0,s.length-1);return setTimeout(function(){d.call(l,r[t].apply(l,c))}),this}d=void 0;var p=function(a){return e[t].apply(l,[a].concat(s))};if(1<this.length){for(l=l.transpose();n<l.length;n++)a[n]=p(l[n]);return a}return p(this[0])}})(t[a])}(["quantiles","percentileOfScore"])}(e,Math),function(e){e.gammaln=function(e){var t=0,a=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],o=1.000000000190015,r,i,n;for(n=(i=r=e)+5.5,n-=(r+.5)*f(n);6>t;t++)o+=a[t]/++i;return f(2.5066282746310007*o/r)-n},e.loggam=function(e){var t=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059],a,o,r,i,l,s,d;if(a=e,d=0,1==e||2==e)return 0;for(7>=e&&(d=D(7-e),a=e+d),o=1/(a*a),r=2*T,l=t[9],s=8;0<=s;s--)l*=o,l+=t[s];if(i=l/a+.5*f(r)+(a-.5)*f(a)-a,7>=e)for(s=1;s<=d;s++)i-=f(a-1),a-=1;return i},e.gammafn=function(e){var t=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],a=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],o=!1,r=0,l=0,s=0,d=e,c,p,u,g;if(0>=d)if(g=d%1+36e-17,g)o=(1&d?-1:1)*T/A(T*g),d=1-d;else return 1/0;for(u=d,p=1>d?d++:(d-=r=(0|d)-1)-1,c=0;8>c;++c)s=(s+t[c])*p,l=l*p+a[c];if(g=s/l+1,u<d)g/=u;else if(u>d)for(c=0;c<r;++c)g*=d,d++;return o&&(g=o/g),g},e.gammap=function(t,a){return e.lowRegGamma(t,a)*e.gammafn(t)},e.lowRegGamma=function(t,a){var o=e.gammaln(t),r=t,n=1/t,l=n,s=a+1-t,p=9.999999999999999e+29,u=1/s,m=u,y=1,x=-~(8.5*f(1<=t?t:1/t)+.4*t+17),_;if(0>a||0>=t)return NaN;if(a<t+1){for(;y<=x;y++)n+=l*=a/++r;return n*g(-a+t*f(a)-o)}for(;y<=x;y++)_=-y*(y-t),s+=2,u=_*u+s,p=s+_/p,u=1/u,m*=u*p;return 1-m*g(-a+t*f(a)-o)},e.factorialln=function(t){return 0>t?NaN:e.gammaln(t+1)},e.factorial=function(t){return 0>t?NaN:e.gammafn(t+1)},e.combination=function(t,a){return 170<t||170<a?g(e.combinationln(t,a)):e.factorial(t)/e.factorial(a)/e.factorial(t-a)},e.combinationln=function(t,a){return e.factorialln(t)-e.factorialln(a)-e.factorialln(t-a)},e.permutation=function(t,a){return e.factorial(t)/e.factorial(t-a)},e.betafn=function(t,a){return 0>=t||0>=a?void 0:170<t+a?g(e.betaln(t,a)):e.gammafn(t)*e.gammafn(a)/e.gammafn(t+a)},e.betaln=function(t,a){return e.gammaln(t)+e.gammaln(a)-e.gammaln(t+a)},e.betacf=function(e,t,a){var o=1e-30,r=1,i=t+a,n=t+1,l=1,s=1-i*e/n,p,u,g,y;for(I(s)<o&&(s=o),s=1/s,y=s;100>=r&&(p=2*r,u=r*(a-r)*e/((t-1+p)*(t+p)),s=1+u*s,I(s)<o&&(s=o),l=1+u/l,I(l)<o&&(l=o),s=1/s,y*=s*l,u=-(t+r)*(i+r)*e/((t+p)*(n+p)),s=1+u*s,I(s)<o&&(s=o),l=1+u/l,I(l)<o&&(l=o),s=1/s,g=s*l,y*=g,!(3e-7>I(g-1)));r++);return y},e.gammapinv=function(o,r){var a=0,i=r-1,n=e.gammaln(r),l,s,d,c,p,m,h;if(1<=o)return P(100,r+100*_(r));if(0>=o)return 0;for(1<r?(m=f(i),h=g(i*(m-1)-n),p=.5>o?o:1-o,d=_(-2*f(p)),l=(2.30753+.27061*d)/(1+d*(.99229+.04481*d))-d,.5>o&&(l=-l),l=P(1e-3,r*C(1-1/(9*r)-l/(3*_(r)),3))):(d=1-r*(.253+.12*r),l=o<d?C(o/d,1/r):1-f(1-(o-d)/(1-d)));12>a;a++){if(0>=l)return 0;if(s=e.lowRegGamma(r,l)-o,d=1<r?h*g(-(l-i)+i*(f(l)-m)):g(-l+i*f(l)-n),c=s/d,l-=d=c/(1-.5*S(1,c*((r-1)/l-1))),0>=l&&(l=.5*(l+d)),I(d)<1e-8*l)break}return l},e.erf=function(e){var a=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-9.46595344482036e-4,3.66839497852761e-4,4.2523324806907e-5,-2.0278578112534e-5,-1.624290004647e-6,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],o=a.length-1,r=!1,i=0,n=0,l,s,c,p;for(0>e&&(e=-e,r=!0),l=2/(2+e),s=4*l-2;0<o;o--)c=i,i=s*i-n+a[o],n=c;return p=l*g(-e*e+.5*(a[0]+s*i)-n),r?p-1:1-p},e.erfc=function(t){return 1-e.erf(t)},e.erfcinv=function(a){var o=0,r,i,n,l;if(2<=a)return-100;if(0>=a)return 100;for(l=1>a?a:2-a,n=_(-2*f(l/2)),r=-.70711*((2.30753+.27061*n)/(1+n*(.99229+.04481*n))-n);2>o;o++)i=e.erfc(r)-l,r+=i/(1.1283791670955126*g(-r*r)-r*i);return 1>a?r:-r},e.ibetainv=function(o,r,a){var i=r-1,n=a-1,l=0,s,d,c,p,m,y,b,v,k,T,A;if(0>=o)return 0;if(1<=o)return 1;for(1<=r&&1<=a?(c=.5>o?o:1-o,p=_(-2*f(c)),b=(2.30753+.27061*p)/(1+p*(.99229+.04481*p))-p,.5>o&&(b=-b),v=(b*b-3)/6,k=2/(1/(2*r-1)+1/(2*a-1)),T=b*_(v+k)/k-(1/(2*a-1)-1/(2*r-1))*(v+5/6-2/(3*k)),b=r/(r+a*g(2*T))):(s=f(r/(r+a)),d=f(a/(r+a)),p=g(r*s)/r,m=g(a*d)/a,T=p+m,b=o<p/T?C(r*T*o,1/r):1-C(a*T*(1-o),1/a)),A=-e.gammaln(r)-e.gammaln(a)+e.gammaln(r+a);10>l;l++){if(0===b||1===b)return b;if(y=e.ibeta(b,r,a)-o,p=g(i*f(b)+n*f(1-b)+A),m=y/p,b-=p=m/(1-.5*S(1,m*(i/b-n/(1-b)))),0>=b&&(b=.5*(b+p)),1<=b&&(b=.5*(b+p+1)),I(p)<1e-8*b&&0<l)break}return b},e.ibeta=function(t,o,a){var r=0===t||1===t?0:g(e.gammaln(o+a)-e.gammaln(o)-e.gammaln(a)+o*f(t)+a*f(1-t));return!(0>t||1<t)&&(t<(o+1)/(o+a+2)?r*e.betacf(t,o,a)/o:1-r*e.betacf(1-t,a,o)/a)},e.randn=function(t,a){var o,r,i,n,l;if(a||(a=t),t)return e.create(t,a,function(){return e.randn()});do o=e._random_fn(),r=1.7156*(e._random_fn()-.5),i=o-.449871,n=I(r)+.386595,l=i*i+n*(.196*n-.25472*i);while(.27597<l&&(.27846<l||r*r>-4*f(o)*o*o));return r/o},e.randg=function(t,a,o){var r=t,i,n,l,s,d,c;if(o||(o=a),t||(t=1),a)return c=e.zeros(a,o),c.alter(function(){return e.randg(t)}),c;1>t&&(t+=1),i=t-1/3,n=1/_(9*i);do{do d=e.randn(),s=1+n*d;while(0>=s);s=s*s*s,l=e._random_fn()}while(l>1-.331*C(d,4)&&f(l)>.5*d*d+i*(1-s+f(s)));if(t==r)return i*s;do l=e._random_fn();while(0===l);return C(l,1/r)*i*s},function(t){for(var a=0;a<t.length;a++)(function(t){e.fn[t]=function(){return e(e.map(this,function(a){return e[t](a)}))}})(t[a])}(["gammaln","gammafn","factorial","factorialln"]),function(t){for(var a=0;a<t.length;a++)(function(t){e.fn[t]=function(){return e(e[t].apply(null,arguments))}})(t[a])}(["randn"])}(e,Math),function(e,t){function r(e,t,a,o){for(var r=0,i=1,n=1,l=1,s=0,d=0,c;I((n-d)/n)>o;)d=n,c=-(t+s)*(t+a+s)*e/(t+2*s)/(t+2*s+1),r=n+c*r,i=l+c*i,++s,c=s*(a-s)*e/(t+2*s-1)/(t+2*s),n=r+c*n,l=i+c*l,r/=l,i/=l,n/=l,l=1;return n/t}function n(e){return e/I(e)}function l(t,o,r){var i=-30,n=8,l=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],s=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],d=.5*t;if(d>=n)return 1;var p=2*e.normal.cdf(d,0,1,1,0)-1;p=p>=g(-50/r)?C(p,r):0;var u=t>3?2:3;for(var m=d,h=(n-d)/u,y=m+h,f=0,x=r-1,v=1;v<=u;v++){for(var w=0,k=.5*(y+m),a=.5*(y-m),b=1;12>=b;b++){var A,S;6<b?(A=12-b+1,S=l[A-1]):(A=b,S=-l[A-1]);var L=a*S,c=k+L,E=c*c;if(E>60)break;var I=2*e.normal.cdf(c,0,1,1,0),P=2*e.normal.cdf(c,t,1,1,0),z=.5*I-.5*P;z>=g(i/x)&&(z=s[A-1]*g(-(.5*E))*C(z,x),w+=z)}w*=2*a*r/_(2*T),f+=w,m=y,y+=h}return(p+=f,p<=g(i/o))?0:(p=C(p,o),1<=p?1:p)}function s(e,a,o){var r=120,i=.5-.5*e,n=_(f(1/(i*i))),l=n+((((n*-453642210148e-16+-.204231210125)*n+-.342242088547)*n+-1)*n+.322232421088)/((((n*.0038560700634+.10353775285)*n+.531103462366)*n+.588581570495)*n+.099348462606);o<r&&(l+=(l*l*l+l)/o/4);var s=.8832-.2368*l;return o<r&&(s+=-1.214/o+1.208*l/o),l*(s*f(a-1)+1.4142)}(function(t){for(var a=0;a<t.length;a++)(function(t){e[t]=function(e,t,a){return this instanceof arguments.callee?(this._a=e,this._b=t,this._c=a,this):new arguments.callee(e,t,a)},e.fn[t]=function(o,a,r){var i=e[t](o,a,r);return i.data=this,i},e[t].prototype.sample=function(o){var r=this._a,a=this._b,i=this._c;return o?e.alter(o,function(){return e[t].sample(r,a,i)}):e[t].sample(r,a,i)},function(a){for(var o=0;o<a.length;o++)(function(o){e[t].prototype[o]=function(r){var i=this._a,a=this._b,n=this._c;return r||0===r||(r=this.data),"number"==typeof r?e[t][o](r,i,a,n):e.fn.map.call(r,function(r){return e[t][o](r,i,a,n)})}})(a[o])}(["pdf","cdf","inv"]),function(a){for(var o=0;o<a.length;o++)(function(a){e[t].prototype[a]=function(){return e[t][a](this._a,this._b,this._c)}})(a[o])}(["mean","median","mode","variance"])})(t[a])})(["beta","centralF","cauchy","chisquare","exponential","gamma","invgamma","kumaraswamy","laplace","lognormal","noncentralt","normal","pareto","studentt","weibull","uniform","binomial","negbin","hypgeom","poisson","triangular","tukey","arcsine"]),e.extend(e.beta,{pdf:function(t,a,o){return 1<t||0>t?0:1==a&&1==o?1:512>a&&512>o?C(t,a-1)*C(1-t,o-1)/e.betafn(a,o):g((a-1)*f(t)+(o-1)*f(1-t)-e.betaln(a,o))},cdf:function(t,a,o){return 1<t||0>t?1*(1<t):e.ibeta(t,a,o)},inv:function(t,a,o){return e.ibetainv(t,a,o)},mean:function(e,t){return e/(e+t)},median:function(t,a){return e.ibetainv(.5,t,a)},mode:function(e,t){return(e-1)/(e+t-2)},sample:function(t,a){var o=e.randg(t);return o/(o+e.randg(a))},variance:function(e,t){return e*t/(C(e+t,2)*(e+t+1))}}),e.extend(e.centralF,{pdf:function(t,a,o){var r,i,n;return 0>t?0:2>=a?0===t&&2>a?1/0:0===t&&2===a?1:1/e.betafn(a/2,o/2)*C(a/o,a/2)*C(t,a/2-1)*C(1+a/o*t,-(a+o)/2):(r=a*t/(o+t*a),i=o/(o+t*a),n=a*i/2,n*e.binomial.pdf((a-2)/2,(a+o-2)/2,r))},cdf:function(t,a,o){return 0>t?0:e.ibeta(a*t/(a*t+o),a/2,o/2)},inv:function(t,a,o){return o/(a*(1/e.ibetainv(t,a/2,o/2)-1))},mean:function(e,t){return 2<t?t/(t-2):void 0},mode:function(e,t){return 2<e?t*(e-2)/(e*(t+2)):void 0},sample:function(t,a){var o=2*e.randg(t/2),r=2*e.randg(a/2);return o/t/(r/a)},variance:function(e,t){return 4>=t?void 0:2*t*t*(e+t-2)/(e*(t-2)*(t-2)*(t-4))}}),e.extend(e.cauchy,{pdf:function(e,t,a){return 0>a?0:a/(C(e-t,2)+C(a,2))/T},cdf:function(e,t,a){return E((e-t)/a)/T+.5},inv:function(e,t,a){return t+a*L(T*(e-.5))},median:function(e){return e},mode:function(e){return e},sample:function(t,a){return e.randn()*_(1/(2*e.randg(.5)))*a+t}}),e.extend(e.chisquare,{pdf:function(t,a){return 0>t?0:0===t&&2===a?.5:g((a/2-1)*f(t)-t/2-a/2*f(2)-e.gammaln(a/2))},cdf:function(t,a){return 0>t?0:e.lowRegGamma(a/2,t/2)},inv:function(t,a){return 2*e.gammapinv(t,.5*a)},mean:function(e){return e},median:function(e){return e*C(1-2/(9*e),3)},mode:function(e){return 0<e-2?e-2:0},sample:function(t){return 2*e.randg(t/2)},variance:function(e){return 2*e}}),e.extend(e.exponential,{pdf:function(e,t){return 0>e?0:t*g(-t*e)},cdf:function(e,t){return 0>e?0:1-g(-t*e)},inv:function(e,t){return-f(1-e)/t},mean:function(e){return 1/e},median:function(e){return 1/e*f(2)},mode:function(){return 0},sample:function(t){return-1/t*f(e._random_fn())},variance:function(e){return C(e,-2)}}),e.extend(e.gamma,{pdf:function(t,a,o){return 0>t?0:0===t&&1===a?1/o:g((a-1)*f(t)-t/o-e.gammaln(a)-a*f(o))},cdf:function(t,a,o){return 0>t?0:e.lowRegGamma(a,t/o)},inv:function(t,a,o){return e.gammapinv(t,a)*o},mean:function(e,t){return e*t},mode:function(e,t){return 1<e?(e-1)*t:void 0},sample:function(t,a){return e.randg(t)*a},variance:function(e,t){return e*t*t}}),e.extend(e.invgamma,{pdf:function(t,a,o){return 0>=t?0:g(-(a+1)*f(t)-o/t-e.gammaln(a)+a*f(o))},cdf:function(t,a,o){return 0>=t?0:1-e.lowRegGamma(a,o/t)},inv:function(t,a,o){return o/e.gammapinv(1-t,a)},mean:function(e,t){return 1<e?t/(e-1):void 0},mode:function(e,t){return t/(e+1)},sample:function(t,a){return a/e.randg(t)},variance:function(e,t){return 2>=e?void 0:t*t/((e-1)*(e-1)*(e-2))}}),e.extend(e.kumaraswamy,{pdf:function(e,t,a){return 0===e&&1===t?a:1===e&&1===a?t:g(f(t)+f(a)+(t-1)*f(e)+(a-1)*f(1-C(e,t)))},cdf:function(e,t,a){return 0>e?0:1<e?1:1-C(1-C(e,t),a)},inv:function(e,t,a){return C(1-C(1-e,1/a),1/t)},mean:function(t,a){return a*e.gammafn(1+1/t)*e.gammafn(a)/e.gammafn(1+1/t+a)},median:function(e,t){return C(1-C(2,-1/t),1/e)},mode:function(e,t){return 1<=e&&1<=t&&1!==e&&1!==t?C((e-1)/(e*t-1),1/e):void 0},variance:function(){throw new Error("variance not yet implemented")}}),e.extend(e.lognormal,{pdf:function(e,t,a){return 0>=e?0:g(-f(e)-.5*f(2*T)-f(a)-C(f(e)-t,2)/(2*a*a))},cdf:function(t,a,o){return 0>t?0:.5+.5*e.erf((f(t)-a)/_(2*o*o))},inv:function(t,a,o){return g(-1.4142135623730951*o*e.erfcinv(2*t)+a)},mean:function(e,t){return g(e+t*t/2)},median:function(e){return g(e)},mode:function(e,t){return g(e-t*t)},sample:function(t,a){return g(e.randn()*a+t)},variance:function(e,t){return(g(t*t)-1)*g(2*e+t*t)}}),e.extend(e.noncentralt,{pdf:function(t,a,o){var r=1e-14;return I(o)<r?e.studentt.pdf(t,a):I(t)<r?g(e.gammaln((a+1)/2)-o*o/2-.5*f(T*a)-e.gammaln(a/2)):a/t*(e.noncentralt.cdf(t*_(1+2/a),a+2,o)-e.noncentralt.cdf(t,a,o))},cdf:function(t,a,o){var r=1e-14;if(I(o)<r)return e.studentt.cdf(t,a);var i=!1;0>t&&(i=!0,o=-o);for(var n=e.normal.cdf(-o,0,1),l=r+1,s=l,d=t*t/(t*t+a),c=0,u=g(-o*o/2),m=g(-o*o/2-.5*f(2)-e.gammaln(3/2))*o;c<200||s>r||l>r;)s=l,0<c&&(u*=o*o/(2*c),m*=o*o/(2*(c+1/2))),l=u*e.beta.cdf(d,c+.5,a/2)+m*e.beta.cdf(d,c+1,a/2),n+=.5*l,c++;return i?1-n:n}}),e.extend(e.normal,{pdf:function(e,t,a){return g(-.5*f(2*T)-f(a)-C(e-t,2)/(2*a*a))},cdf:function(t,a,o){return .5*(1+e.erf((t-a)/_(2*o*o)))},inv:function(t,a,o){return-1.4142135623730951*o*e.erfcinv(2*t)+a},mean:function(e){return e},median:function(e){return e},mode:function(e){return e},sample:function(t,a){return e.randn()*a+t},variance:function(e,t){return t*t}}),e.extend(e.pareto,{pdf:function(e,t,a){return e<t?0:a*C(t,a)/C(e,a+1)},cdf:function(e,t,a){return e<t?0:1-C(t/e,a)},inv:function(e,t,a){return t/C(1-e,1/a)},mean:function(e,t){return 1>=t?void 0:t*C(e,t)/(t-1)},median:function(e,t){return e*(t*i)},mode:function(e){return e},variance:function(e,t){return 2>=t?void 0:e*e*t/(C(t-1,2)*(t-2))}}),e.extend(e.studentt,{pdf:function(t,a){return a=1e100<a?1e100:a,1/(_(a)*e.betafn(.5,a/2))*C(1+t*t/a,-((a+1)/2))},cdf:function(t,a){var o=a/2;return e.ibeta((t+_(t*t+a))/(2*_(t*t+a)),o,o)},inv:function(t,a){var o=e.ibetainv(2*S(t,1-t),.5*a,.5);return o=_(a*(1-o)/o),.5<t?o:-o},mean:function(e){return 1<e?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(t){return e.randn()*_(t/(2*e.randg(t/2)))},variance:function(e){return 2<e?e/(e-2):1<e?1/0:void 0}}),e.extend(e.weibull,{pdf:function(e,t,a){return 0>e||0>t||0>a?0:a/t*C(e/t,a-1)*g(-C(e/t,a))},cdf:function(e,t,a){return 0>e?0:1-g(-C(e/t,a))},inv:function(e,t,a){return t*C(-f(1-e),1/a)},mean:function(t,a){return t*e.gammafn(1+1/a)},median:function(e,t){return e*C(f(2),1/t)},mode:function(e,t){return 1>=t?0:e*C((t-1)/t,1/t)},sample:function(t,a){return t*C(-f(e._random_fn()),1/a)},variance:function(t,a){return t*t*e.gammafn(1+2/a)-C(e.weibull.mean(t,a),2)}}),e.extend(e.uniform,{pdf:function(e,t,a){return e<t||e>a?0:1/(a-t)},cdf:function(e,t,a){return e<t?0:e<a?(e-t)/(a-t):1},inv:function(e,t,a){return t+e*(a-t)},mean:function(e,t){return .5*(e+t)},median:function(t,a){return e.mean(t,a)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(t,a){return t/2+a/2+(a/2-t/2)*(2*e._random_fn()-1)},variance:function(e,t){return C(t-e,2)/12}}),e.extend(e.binomial,{pdf:function(t,a,o){return 0===o||1===o?a*o===t?1:0:e.combination(a,t)*C(o,t)*C(1-o,a-t)},cdf:function(t,o,i){var n=1e-10,l;if(0>t)return 0;if(t>=o)return 1;if(0>i||1<i||0>=o)return NaN;t=D(t);var d=i,c=t+1,a=o-t,p=c+a,s=g(e.gammaln(p)-e.gammaln(a)-e.gammaln(c)+c*f(d)+a*f(1-d));return l=d<(c+1)/(p+2)?s*r(d,c,a,n):1-s*r(1-d,a,c,n),v((1-l)*(1/n))/(1/n)}}),e.extend(e.negbin,{pdf:function(t,a,o){return t===t>>>0&&(0>t?0:e.combination(t+a-1,a-1)*C(1-o,t)*C(o,a))},cdf:function(t,a,o){var r=0,i=0;if(0>t)return 0;for(;i<=t;i++)r+=e.negbin.pdf(i,a,o);return r}}),e.extend(e.hypgeom,{pdf:function(t,a,o,r){if(0|t!==t)return!1;if(0>t||t<o-(a-r))return 0;if(t>r||t>o)return 0;if(2*o>a)return 2*r>a?e.hypgeom.pdf(a-o-r+t,a,a-o,a-r):e.hypgeom.pdf(r-t,a,a-o,r);if(2*r>a)return e.hypgeom.pdf(o-t,a,o,a-r);if(o<r)return e.hypgeom.pdf(t,a,r,o);for(var n=1,l=0,s=0;s<t;s++){for(;1<n&&l<r;)n*=1-o/(a-l),l++;n*=(r-s)*(o-s)/((s+1)*(a-o-r+s+1))}for(;l<r;l++)n*=1-o/(a-l);return S(1,P(0,n))},cdf:function(t,a,o,r){if(0>t||t<o-(a-r))return 0;if(t>=r||t>=o)return 1;if(2*o>a)return 2*r>a?e.hypgeom.cdf(a-o-r+t,a,a-o,a-r):1-e.hypgeom.cdf(r-t-1,a,a-o,r);if(2*r>a)return 1-e.hypgeom.cdf(o-t-1,a,o,a-r);if(o<r)return e.hypgeom.cdf(t,a,r,o);for(var n=1,l=1,s=0,d=0;d<t;d++){for(;1<n&&s<r;){var c=1-o/(a-s);l*=c,n*=c,s++}l*=(r-d)*(o-d)/((d+1)*(a-o-r+d+1)),n+=l}for(;s<r;s++)n*=1-o/(a-s);return S(1,P(0,n))}}),e.extend(e.poisson,{pdf:function(t,a){return 0>a||0!=t%1||0>t?0:C(a,t)*g(-a)/e.factorial(t)},cdf:function(t,a){var o=[],r=0;if(0>t)return 0;for(;r<=t;r++)o.push(e.poisson.pdf(r,a));return e.sum(o)},mean:function(e){return e},variance:function(e){return e},sampleSmall:function(t){var a=1,o=0,r=g(-t);do o++,a*=e._random_fn();while(a>r);return o-1},sampleLarge:function(o){var r=o,i,n,l,s,d,c,p,u,g,m;for(s=_(r),d=f(r),p=.931+2.53*s,c=-.059+.02483*p,u=1.1239+1.1328/(p-3.4),g=.9277-3.6224/(p-2);;){if(n=t.random()-.5,l=t.random(),m=.5-I(n),i=D((2*c/m+p)*n+r+.43),.07<=m&&l<=g)return i;if(!(0>i||.013>m&&l>m)&&f(l)+f(u)-f(c/(m*m)+p)<=-r+i*d-e.loggam(i+1))return i}},sample:function(e){return 10>e?this.sampleSmall(e):this.sampleLarge(e)}}),e.extend(e.triangular,{pdf:function(e,t,a,o){return a<=t||o<t||o>a?NaN:e<t||e>a?0:e<o?2*(e-t)/((a-t)*(o-t)):e===o?2/(a-t):2*(a-e)/((a-t)*(a-o))},cdf:function(e,t,a,o){return a<=t||o<t||o>a?NaN:e<=t?0:e>=a?1:e<=o?C(e-t,2)/((a-t)*(o-t)):1-C(a-e,2)/((a-t)*(a-o))},inv:function(e,t,a,o){return a<=t||o<t||o>a?NaN:e<=(o-t)/(a-t)?t+(a-t)*_(e*((o-t)/(a-t))):t+(a-t)*(1-_((1-e)*(1-(o-t)/(a-t))))},mean:function(e,t,a){return(e+t+a)/3},median:function(e,t,a){return a<=(e+t)/2?t-_((t-e)*(t-a))/_(2):a>(e+t)/2?e+_((t-e)*(a-e))/_(2):void 0},mode:function(e,t,a){return a},sample:function(t,a,o){var r=e._random_fn();return r<(o-t)/(a-t)?t+_(r*(a-t)*(o-t)):a-_((1-r)*(a-t)*(a-o))},variance:function(e,t,a){return(e*e+t*t+a*a-e*t-e*a-t*a)/18}}),e.extend(e.arcsine,{pdf:function(e,t,a){return a<=t?NaN:e<=t||e>=a?0:2/T*C(C(a-t,2)-C(2*e-t-a,2),-.5)},cdf:function(e,t,a){return e<t?0:e<a?2/T*o(_((e-t)/(a-t))):1},inv:function(e,t,a){return t+(.5-.5*x(T*e))*(a-t)},mean:function(e,t){return t<=e?NaN:(e+t)/2},median:function(e,t){return t<=e?NaN:(e+t)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(t,a){return(t+a)/2+(a-t)/2*A(2*T*e.uniform.sample(0,1))},variance:function(e,t){return t<=e?NaN:C(t-e,2)/8}}),e.extend(e.laplace,{pdf:function(e,t,a){return 0>=a?0:g(-I(e-t)/a)/(2*a)},cdf:function(e,t,a){return 0>=a?0:e<t?.5*g((e-t)/a):1-.5*g(-(e-t)/a)},mean:function(e){return e},median:function(e){return e},mode:function(e){return e},variance:function(e,t){return 2*t*t},sample:function(t,a){var o=e._random_fn()-.5;return t-a*n(o)*f(1-2*I(o))}}),e.extend(e.tukey,{cdf:function(t,a,o){var r=(0,eval)("this").Number.isFinite,n=a,s=8,d=1e-14,c=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],p=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(0>=t)return 0;if(2>o||!1||2>n)return NaN;if(!r(t))return 1;if(o>25e3)return l(t,1,n);var u=.5*o,m=u*f(o)-o*f(2)-e.gammaln(u),h=u-1,y=.25*o,x;x=o<=100?1:o<=800?.5:o<=5e3?.25:.125,m+=f(x);for(var b=0,v=1;50>=v;v++){for(var w=0,k=(2*v-1)*x,T=1;T<=16;T++){var A,S;s<T?(A=T-s-1,S=m+h*f(k+c[A]*x)-(c[A]*x+k)*y):(A=T-1,S=m+h*f(k-c[A]*x)+(c[A]*x-k)*y);var C;if(S>=-30){C=s<T?t*_(.5*(c[A]*x+k)):t*_(.5*(-(c[A]*x)+k));var L=l(C,1,n),E=L*p[A]*g(S);w+=E}}if(1<=v*x&&w<=d)break;b+=w}if(w>d)throw new Error("tukey.cdf failed to converge");return 1<b&&(b=1),b},inv:function(t,a,o){var r=a;if(2>o||!1||2>r)return NaN;if(0>t||1<t)return NaN;if(0===t)return 0;if(1===t)return 1/0;var i=s(t,r,o),n=e.tukey.cdf(i,a,o)-t,l;l=0<n?P(0,i-1):i+1;for(var d=e.tukey.cdf(l,a,o)-t,c=1,p;c<50;c++){p=l-d*(l-i)/(d-n),n=d,i=l,0>p&&(p=0,d=-t),d=e.tukey.cdf(p,a,o)-t,l=p;var u=I(l-i);if(u<1e-4)return p}throw new Error("tukey.inv failed to converge")}})}(e,Math),function(t){function a(e){return i(e)||e instanceof t}var o=Array.prototype.push,i=t.utils.isArray;t.extend({add:function(e,o){return a(o)?(a(o[0])||(o=[o]),t.map(e,function(e,t,a){return e+o[t][a]})):t.map(e,function(e){return e+o})},subtract:function(e,o){return a(o)?(a(o[0])||(o=[o]),t.map(e,function(e,t,a){return e-o[t][a]||0})):t.map(e,function(e){return e-o})},divide:function(e,o){return a(o)?(a(o[0])||(o=[o]),t.multiply(e,t.inv(o))):t.map(e,function(e){return e/o})},multiply:function(e,o){var r,i,n,l,s,d,c,p;if(void 0===e.length&&void 0===o.length)return e*o;if(s=e.length,d=e[0].length,c=t.zeros(s,n=a(o)?o[0].length:d),p=0,a(o)){for(;p<n;p++)for(r=0;r<s;r++){for(l=0,i=0;i<d;i++)l+=e[r][i]*o[i][p];c[r][p]=l}return 1===s&&1===p?c[0][0]:c}return t.map(e,function(e){return e*o})},outer:function(e,a){return t.multiply(e.map(function(e){return[e]}),[a])},dot:function(e,o){a(e[0])||(e=[e]),a(o[0])||(o=[o]);for(var r=1===e[0].length&&1!==e.length?t.transpose(e):e,i=1===o[0].length&&1!==o.length?t.transpose(o):o,n=[],l=0,s=r.length,d=r[0].length,c,p;l<s;l++){for(n[l]=[],c=0,p=0;p<d;p++)c+=r[l][p]*i[l][p];n[l]=c}return 1===n.length?n[0]:n},pow:function(e,a){return t.map(e,function(e){return C(e,a)})},exp:function(e){return t.map(e,function(e){return g(e)})},log:function(e){return t.map(e,function(e){return f(e)})},abs:function(e){return t.map(e,function(e){return I(e)})},norm:function(e,t){var o=0,r=0;for(isNaN(t)&&(t=2),a(e[0])&&(e=e[0]);r<e.length;r++)o+=C(I(e[r]),t);return C(o,1/t)},angle:function(e,a){return r(t.dot(e,a)/(t.norm(e)*t.norm(a)))},aug:function(e,t){var a=[],r;for(r=0;r<e.length;r++)a.push(e[r].slice());for(r=0;r<a.length;r++)o.apply(a[r],t[r]);return a},inv:function(e){for(var a=e.length,o=e[0].length,r=t.identity(a,o),n=t.gauss_jordan(e,r),l=[],s=0,d;s<a;s++)for(l[s]=[],d=o;d<n[0].length;d++)l[s][d-o]=n[s][d];return l},det:function(e){var t=e.length,a=2*t,o=Array(a),r=t-1,n=a-1,l=r-t+1,s=n,d=0,c=0,p;if(2===t)return e[0][0]*e[1][1]-e[0][1]*e[1][0];for(;d<a;d++)o[d]=1;for(d=0;d<t;d++){for(p=0;p<t;p++)o[0>l?l+t:l]*=e[d][p],o[s<t?s+t:s]*=e[d][p],l++,s--;l=--r-t+1,s=--n}for(d=0;d<t;d++)c+=o[d];for(;d<a;d++)c-=o[d];return c},gauss_elimination:function(e,o){var r=0,l=0,s=e.length,n=e[0].length,d=1,c=0,p=[],u,g,m,h;for(e=t.aug(e,o),u=e[0].length,r=0;r<s;r++){for(g=e[r][r],l=r,h=r+1;h<n;h++)g<I(e[h][r])&&(g=e[h][r],l=h);if(l!=r)for(h=0;h<u;h++)m=e[r][h],e[r][h]=e[l][h],e[l][h]=m;for(l=r+1;l<s;l++)for(d=e[l][r]/e[r][r],h=r;h<u;h++)e[l][h]-=d*e[r][h]}for(r=s-1;0<=r;r--){for(c=0,l=r+1;l<=s-1;l++)c+=p[l]*e[r][l];p[r]=(e[r][u-1]-c)/e[r][r]}return p},gauss_jordan:function(e,a){var o=t.aug(e,a),r=o.length,i=o[0].length,n=0,l,s,d;for(s=0;s<r;s++){var p=s;for(d=s+1;d<r;d++)I(o[d][s])>I(o[p][s])&&(p=d);var u=o[s];for(o[s]=o[p],o[p]=u,d=s+1;d<r;d++)for(n=o[d][s]/o[s][s],l=s;l<i;l++)o[d][l]-=o[s][l]*n}for(s=r-1;0<=s;s--){for(n=o[s][s],d=0;d<s;d++)for(l=i-1;l>s-1;l--)o[d][l]-=o[s][l]*o[d][s]/n;for(o[s][s]/=n,l=r;l<i;l++)o[s][l]/=n}return o},triaUpSolve:function(e,a){var o=e[0].length,r=t.zeros(1,o)[0],i=!1,n;return null!=a[0].length&&(a=a.map(function(e){return e[0]}),i=!0),t.arange(o-1,-1,-1).forEach(function(l){n=t.arange(l+1,o).map(function(t){return r[t]*e[l][t]}),r[l]=(a[l]-t.sum(n))/e[l][l]}),i?r.map(function(e){return[e]}):r},triaLowSolve:function(e,a){var o=e[0].length,r=t.zeros(1,o)[0],i=!1,n;return null!=a[0].length&&(a=a.map(function(e){return e[0]}),i=!0),t.arange(o).forEach(function(o){n=t.arange(o).map(function(t){return e[o][t]*r[t]}),r[o]=(a[o]-t.sum(n))/e[o][o]}),i?r.map(function(e){return[e]}):r},lu:function(e){var a=e.length,o=t.identity(a),r=t.zeros(e.length,e[0].length),n;return t.arange(a).forEach(function(a){r[0][a]=e[0][a]}),t.arange(1,a).forEach(function(s){t.arange(s).forEach(function(a){n=t.arange(a).map(function(e){return o[s][e]*r[e][a]}),o[s][a]=(e[s][a]-t.sum(n))/r[a][a]}),t.arange(s,a).forEach(function(a){n=t.arange(s).map(function(e){return o[s][e]*r[e][a]}),r[s][a]=e[n.length][a]-t.sum(n)})}),[o,r]},cholesky:function(e){var a=e.length,o=t.zeros(e.length,e[0].length),r;return t.arange(a).forEach(function(n){r=t.arange(n).map(function(e){return C(o[n][e],2)}),o[n][n]=_(e[n][n]-t.sum(r)),t.arange(n+1,a).forEach(function(a){r=t.arange(n).map(function(e){return o[n][e]*o[a][e]}),o[a][n]=(e[n][a]-t.sum(r))/o[n][n]})}),o},gauss_jacobi:function(e,a,o,s){for(var r=0,p=0,g=e.length,n=[],l=[],u=[],d,m,y,f;r<g;r++)for(n[r]=[],l[r]=[],u[r]=[],p=0;p<g;p++)r>p?(n[r][p]=e[r][p],l[r][p]=u[r][p]=0):r<p?(l[r][p]=e[r][p],n[r][p]=u[r][p]=0):(u[r][p]=e[r][p],n[r][p]=l[r][p]=0);for(y=t.multiply(t.multiply(t.inv(u),t.add(n,l)),-1),m=t.multiply(t.inv(u),a),d=o,f=t.add(t.multiply(y,o),m),r=2;I(t.norm(t.subtract(f,d)))>s;)d=f,f=t.add(t.multiply(y,d),m),r++;return f},gauss_seidel:function(e,a,o,s){for(var r=0,p=e.length,n=[],l=[],u=[],d,g,m,y,f;r<p;r++)for(n[r]=[],l[r]=[],u[r]=[],d=0;d<p;d++)r>d?(n[r][d]=e[r][d],l[r][d]=u[r][d]=0):r<d?(l[r][d]=e[r][d],n[r][d]=u[r][d]=0):(u[r][d]=e[r][d],n[r][d]=l[r][d]=0);for(y=t.multiply(t.multiply(t.inv(t.add(u,n)),l),-1),m=t.multiply(t.inv(t.add(u,n)),a),g=o,f=t.add(t.multiply(y,o),m),r=2;I(t.norm(t.subtract(f,g)))>s;)g=f,f=t.add(t.multiply(y,g),m),++r;return f},SOR:function(e,a,o,s,r){for(var p=0,g=e.length,n=[],l=[],u=[],d,m,y,f,x;p<g;p++)for(n[p]=[],l[p]=[],u[p]=[],d=0;d<g;d++)p>d?(n[p][d]=e[p][d],l[p][d]=u[p][d]=0):p<d?(l[p][d]=e[p][d],n[p][d]=u[p][d]=0):(u[p][d]=e[p][d],n[p][d]=l[p][d]=0);for(f=t.multiply(t.inv(t.add(u,t.multiply(n,r))),t.subtract(t.multiply(u,1-r),t.multiply(l,r))),y=t.multiply(t.multiply(t.inv(t.add(u,t.multiply(n,r))),a),r),m=o,x=t.add(t.multiply(f,o),y),p=2;I(t.norm(t.subtract(x,m)))>s;)m=x,x=t.add(t.multiply(f,m),y),p++;return x},householder:function(e){for(var o=e.length,l=e[0].length,n=0,s=[],d=[],c,u,g,m,h;n<o-1;n++){for(c=0,m=n+1;m<l;m++)c+=e[m][n]*e[m][n];for(h=0<e[n+1][n]?-1:1,c=h*_(c),u=_((c*c-e[n+1][n]*c)/2),s=t.zeros(o,1),s[n+1][0]=(e[n+1][n]-c)/(2*u),g=n+2;g<o;g++)s[g][0]=e[g][n]/(2*u);d=t.subtract(t.identity(o,l),t.multiply(t.multiply(s,t.transpose(s)),2)),e=t.multiply(d,t.multiply(e,d))}return e},QR:function(){var e=t.sum,a=t.arange;return function(o){var l=o.length,n=o[0].length,s=t.zeros(n,n);o=t.copy(o);var r,d,c;for(d=0;d<n;d++){for(s[d][d]=_(e(a(l).map(function(e){return o[e][d]*o[e][d]}))),r=0;r<l;r++)o[r][d]/=s[d][d];for(c=d+1;c<n;c++)for(s[d][c]=e(a(l).map(function(e){return o[e][d]*o[e][c]})),r=0;r<l;r++)o[r][c]-=o[r][d]*s[d][c]}return[o,s]}}(),lstsq:function(){function e(e){e=t.copy(e);var a=e.length,o=t.identity(a);return t.arange(a-1,-1,-1).forEach(function(a){t.sliceAssign(o,{row:a},t.divide(t.slice(o,{row:a}),e[a][a])),t.sliceAssign(e,{row:a},t.divide(t.slice(e,{row:a}),e[a][a])),t.arange(a).forEach(function(r){var i=t.multiply(e[r][a],-1),n=t.slice(e,{row:r}),l=t.multiply(t.slice(e,{row:a}),i);t.sliceAssign(e,{row:r},t.add(n,l));var s=t.slice(o,{row:r}),d=t.multiply(t.slice(o,{row:a}),i);t.sliceAssign(o,{row:r},t.add(s,d))})}),o}return function(a,o){var r=!1;void 0===o[0].length&&(o=o.map(function(e){return[e]}),r=!0);var i=t.QR(a),n=i[0],l=i[1],s=a[0].length,d=t.slice(n,{col:{end:s}}),c=t.slice(l,{row:{end:s}}),p=e(c),u=t.transpose(d);void 0===u[0].length&&(u=[u]);var g=t.multiply(t.multiply(p,u),o);return void 0===g.length&&(g=[[g]]),r?g.map(function(e){return e[0]}):g}}(),jacobi:function(o){for(var r=1,l=o.length,n=t.identity(l,l),d=[],c,u,g,m,h,y,f,_;1===r;){for(y=o[0][1],m=0,h=1,u=0;u<l;u++)for(g=0;g<l;g++)u!=g&&y<I(o[u][g])&&(y=I(o[u][g]),m=u,h=g);for(f=o[m][m]===o[h][h]?0<o[m][h]?T/4:-T/4:E(2*o[m][h]/(o[m][m]-o[h][h]))/2,_=t.identity(l,l),_[m][m]=x(f),_[m][h]=-A(f),_[h][m]=A(f),_[h][h]=x(f),n=t.multiply(n,_),c=t.multiply(t.multiply(t.inv(_),o),_),o=c,r=0,u=1;u<l;u++)for(g=1;g<l;g++)u!=g&&.001<I(o[u][g])&&(r=1)}for(u=0;u<l;u++)d.push(o[u][u]);return[n,d]},rungekutta:function(e,t,a,o,r,i){var n,l,s,d,c;if(2===i)for(;o<=a;)n=t*e(o,r),l=t*e(o+t,r+n),s=r+(n+l)/2,r=s,o+=t;if(4===i)for(;o<=a;)n=t*e(o,r),l=t*e(o+t/2,r+n/2),d=t*e(o+t/2,r+l/2),c=t*e(o+t,r+d),s=r+(n+2*l+2*d+c)/6,r=s,o+=t;return r},romberg:function(e,t,a,o){for(var r=0,n=(a-t)/2,l=[],s=[],d=[],c,p,u,y,f;r<o/2;){for(f=e(t),u=t,y=0;u<=a;u+=n,y++)l[y]=u;for(c=l.length,u=1;u<c-1;u++)f+=(0==u%2?2:4)*e(l[u]);f=n/3*(f+e(a)),d[r]=f,n/=2,r++}for(p=d.length,c=1;1!==p;){for(u=0;u<p-1;u++)s[u]=(C(4,c)*d[u+1]-d[u])/(C(4,c)-1);p=s.length,d=s,s=[],c++}return d},richardson:function(e,t,o,r){function n(e,t){for(var a=0,o=e.length,r;a<o;a++)e[a]===t&&(r=a);return r}for(var l=I(o-e[n(e,o)+1]),s=0,d=[],c=[],p,u,y,f,x;r>=l;)p=n(e,o+r),u=n(e,o),d[s]=(t[p]-2*t[u]+t[2*u-p])/(r*r),r/=2,s++;for(f=d.length,y=1;1!=f;){for(x=0;x<f-1;x++)c[x]=(C(4,y)*d[x+1]-d[x])/(C(4,y)-1);f=c.length,d=c,c=[],y++}return d},simpson:function(e,t,a,o){for(var r=(a-t)/o,n=e(t),l=[],s=t,d=0,c=1,p;s<=a;s+=r,d++)l[d]=s;for(p=l.length;c<p-1;c++)n+=(0==c%2?2:4)*e(l[c]);return r/3*(n+e(a))},hermite:function(e,t,a,o){for(var r=e.length,n=0,s=0,d=[],l=[],c=[],u=[],g;s<r;s++){for(d[s]=1,g=0;g<r;g++)s!=g&&(d[s]*=(o-e[g])/(e[s]-e[g]));for(l[s]=0,g=0;g<r;g++)s!=g&&(l[s]+=1/(e[s]-e[g]));c[s]=(1-2*(o-e[s])*l[s])*(d[s]*d[s]),u[s]=(o-e[s])*(d[s]*d[s]),n+=c[s]*t[s]+u[s]*a[s]}return n},lagrange:function(e,t,a){for(var o=0,r=0,s=e.length,n,d;r<s;r++){for(d=t[r],n=0;n<s;n++)r!=n&&(d*=(a-e[n])/(e[r]-e[n]));o+=d}return o},cubic_spline:function(e,a,o){for(var r=e.length,n=0,l=[],s=[],p=[],u=[],g=[],m=[],h=[],d;n<r-1;n++)g[n]=e[n+1]-e[n];for(p[0]=0,n=1;n<r-1;n++)p[n]=3/g[n]*(a[n+1]-a[n])-3/g[n-1]*(a[n]-a[n-1]);for(n=1;n<r-1;n++)l[n]=[],s[n]=[],l[n][n-1]=g[n-1],l[n][n]=2*(g[n-1]+g[n]),l[n][n+1]=g[n],s[n][0]=p[n];for(u=t.multiply(t.inv(l),s),d=0;d<r-1;d++)m[d]=(a[d+1]-a[d])/g[d]-g[d]*(u[d+1][0]+2*u[d][0])/3,h[d]=(u[d+1][0]-u[d][0])/(3*g[d]);for(d=0;d<r&&!(e[d]>o);d++);return d-=1,a[d]+(o-e[d])*m[d]+t.sq(o-e[d])*u[d]+(o-e[d])*t.sq(o-e[d])*h[d]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(e){var a=e.length,o=e[0].length,r=0,n=[],l=[],s=[],d=[],c=[],p=[],u=[],g=[],m=[],h=[],y,f;for(r=0;r<a;r++)n[r]=t.sum(e[r])/o;for(r=0;r<o;r++)for(u[r]=[],y=0;y<a;y++)u[r][y]=e[y][r]-n[y];for(u=t.transpose(u),r=0;r<a;r++)for(g[r]=[],y=0;y<a;y++)g[r][y]=t.dot([u[r]],[u[y]])/(o-1);for(s=t.jacobi(g),m=s[0],l=s[1],h=t.transpose(m),r=0;r<l.length;r++)for(y=r;y<l.length;y++)l[r]<l[y]&&(f=l[r],l[r]=l[y],l[y]=f,d=h[r],h[r]=h[y],h[y]=d);for(p=t.transpose(u),r=0;r<a;r++)for(c[r]=[],y=0;y<p.length;y++)c[r][y]=t.dot([h[r]],[p[y]]);return[e,l,h,c]}}),function(e){for(var a=0;a<e.length;a++)(function(e){t.fn[e]=function(a,o){var r=this;return o?(setTimeout(function(){o.call(r,t.fn[e].call(r,a))},15),this):"number"==typeof t[e](this,a)?t[e](this,a):t(t[e](this,a))}})(e[a])}(["add","divide","multiply","subtract","dot","pow","exp","log","abs","norm","angle"])}(e,Math),function(e){function t(e,t,a,o){if(1<e||1<a||0>=e||0>=a)throw new Error("Proportions should be greater than 0 and less than 1");var r=(e*t+a*o)/(t+o),i=_(r*(1-r)*(1/t+1/o));return(e-a)/i}var a=[].slice,o=e.utils.isNumber,r=e.utils.isArray;e.extend({zscore:function(){var t=a.call(arguments);return o(t[1])?(t[0]-t[1])/t[2]:(t[0]-e.mean(t[1]))/e.stdev(t[1],t[2])},ztest:function(){var t=a.call(arguments),o;return r(t[1])?(o=e.zscore(t[0],t[1],t[3]),1===t[2]?e.normal.cdf(-I(o),0,1):2*e.normal.cdf(-I(o),0,1)):2<t.length?(o=e.zscore(t[0],t[1],t[2]),1===t[3]?e.normal.cdf(-I(o),0,1):2*e.normal.cdf(-I(o),0,1)):(o=t[0],1===t[1]?e.normal.cdf(-I(o),0,1):2*e.normal.cdf(-I(o),0,1))}}),e.extend(e.fn,{zscore:function(e,t){return(e-this.mean())/this.stdev(t)},ztest:function(t,a,o){var r=I(this.zscore(t,o));return 1===a?e.normal.cdf(-r,0,1):2*e.normal.cdf(-r,0,1)}}),e.extend({tscore:function(){var t=a.call(arguments);return 4===t.length?(t[0]-t[1])/(t[2]/_(t[3])):(t[0]-e.mean(t[1]))/(e.stdev(t[1],!0)/_(t[1].length))},ttest:function(){var t=a.call(arguments),r;return 5===t.length?(r=I(e.tscore(t[0],t[1],t[2],t[3])),1===t[4]?e.studentt.cdf(-r,t[3]-1):2*e.studentt.cdf(-r,t[3]-1)):o(t[1])?(r=I(t[0]),1==t[2]?e.studentt.cdf(-r,t[1]-1):2*e.studentt.cdf(-r,t[1]-1)):(r=I(e.tscore(t[0],t[1])),1==t[2]?e.studentt.cdf(-r,t[1].length-1):2*e.studentt.cdf(-r,t[1].length-1))}}),e.extend(e.fn,{tscore:function(e){return(e-this.mean())/(this.stdev(!0)/_(this.cols()))},ttest:function(t,a){return 1===a?1-e.studentt.cdf(I(this.tscore(t)),this.cols()-1):2*e.studentt.cdf(-I(this.tscore(t)),this.cols()-1)}}),e.extend({anovafscore:function(){var t=a.call(arguments),o,r,n,l,s,d,c,p;if(1===t.length){for(s=Array(t[0].length),c=0;c<t[0].length;c++)s[c]=t[0][c];t=s}for(r=[],c=0;c<t.length;c++)r=r.concat(t[c]);for(n=e.mean(r),o=0,c=0;c<t.length;c++)o+=t[c].length*C(e.mean(t[c])-n,2);for(o/=t.length-1,d=0,c=0;c<t.length;c++)for(l=e.mean(t[c]),p=0;p<t[c].length;p++)d+=C(t[c][p]-l,2);return d/=r.length-t.length,o/d},anovaftest:function(){var t=a.call(arguments),r,l,s,d;if(o(t[0]))return 1-e.centralF.cdf(t[0],t[1],t[2]);var c=e.anovafscore(t);for(r=t.length-1,s=0,d=0;d<t.length;d++)s+=t[d].length;return l=s-r-1,1-e.centralF.cdf(c,r,l)},ftest:function(t,a,o){return 1-e.centralF.cdf(t,a,o)}}),e.extend(e.fn,{anovafscore:function(){return e.anovafscore(this.toArray())},anovaftes:function(){var t=0,a;for(a=0;a<this.length;a++)t+=this[a].length;return e.ftest(this.anovafscore(),this.length-1,t-this.length)}}),e.extend({qscore:function(){var t=a.call(arguments),r,i,n,l,s;return o(t[0])?(r=t[0],i=t[1],n=t[2],l=t[3],s=t[4]):(r=e.mean(t[0]),i=e.mean(t[1]),n=t[0].length,l=t[1].length,s=t[2]),I(r-i)/(s*_((1/n+1/l)/2))},qtest:function(){var t=a.call(arguments),o;3===t.length?(o=t[0],t=t.slice(1)):7===t.length?(o=e.qscore(t[0],t[1],t[2],t[3],t[4]),t=t.slice(5)):(o=e.qscore(t[0],t[1],t[2]),t=t.slice(3));var r=t[0],i=t[1];return 1-e.tukey.cdf(o,i,r-i)},tukeyhsd:function(t){for(var a=e.pooledstdev(t),o=t.map(function(t){return e.mean(t)}),r=t.reduce(function(e,t){return e+t.length},0),n=[],l=0;l<t.length;++l)for(var s=l+1,d;s<t.length;++s)d=e.qtest(o[l],o[s],t[l].length,t[s].length,a,r,t.length),n.push([[l,s],d]);return n}}),e.extend({normalci:function(){var t=a.call(arguments),o=[,,],r;return r=4===t.length?I(e.normal.inv(t[1]/2,0,1)*t[2]/_(t[3])):I(e.normal.inv(t[1]/2,0,1)*e.stdev(t[2])/_(t[2].length)),o[0]=t[0]-r,o[1]=t[0]+r,o},tci:function(){var t=a.call(arguments),o=[,,],r;return r=4===t.length?I(e.studentt.inv(t[1]/2,t[3]-1)*t[2]/_(t[3])):I(e.studentt.inv(t[1]/2,t[2].length-1)*e.stdev(t[2],!0)/_(t[2].length)),o[0]=t[0]-r,o[1]=t[0]+r,o},significant:function(e,t){return e<t}}),e.extend(e.fn,{normalci:function(t,a){return e.normalci(t,a,this.toArray())},tci:function(t,a){return e.tci(t,a,this.toArray())}}),e.extend(e.fn,{oneSidedDifferenceOfProportions:function(a,o,r,i){var n=t(a,o,r,i);return e.ztest(n,1)},twoSidedDifferenceOfProportions:function(a,o,r,i){var n=t(a,o,r,i);return e.ztest(n,2)}})}(e,Math),e.models=function(){function t(t){var o=t[0].length,r=e.arange(o).map(function(r){var i=e.arange(o).filter(function(e){return e!==r});return a(e.col(t,r).map(function(e){return e[0]}),e.col(t,i))});return r}function a(t,a){var o=t.length,r=a[0].length-1,i=e.lstsq(a,t),n=e.multiply(a,i.map(function(e){return[e]})).map(function(e){return e[0]}),l=e.subtract(t,n),s=e.mean(t),d=e.sum(n.map(function(e){return C(e-s,2)})),c=e.sum(t.map(function(e,t){return C(e-n[t],2)})),p=d+c;return{exog:a,endog:t,nobs:o,df_model:r,df_resid:o-r-1,coef:i,predict:n,resid:l,ybar:s,SST:p,SSE:d,SSR:c,R2:d/p}}function o(a){var o=t(a.exog),r=_(a.SSR/a.df_resid),n=o.map(function(e){var t=e.SST,a=e.R2;return r/_(t*(1-a))}),l=a.coef.map(function(e,t){return(e-0)/n[t]}),s=l.map(function(o){var t=e.studentt.cdf(o,a.df_resid);return 2*(.5<t?1-t:t)}),p=e.studentt.inv(.975,a.df_resid),i=a.coef.map(function(e,t){var a=p*n[t];return[e-a,e+a]});return{se:n,t:l,p:s,sigmaHat:r,interval95:i}}function r(t){var a=t.R2/t.df_model/((1-t.R2)/t.df_resid),o=1-function(t,a,o){return e.beta.cdf(t/(o/a+t),a/2,o/2)}(a,t.df_model,t.df_resid);return{F_statistic:a,pvalue:o}}return{ols:function(e,t){var i=a(e,t),n=o(i),l=r(i),s=1-(1-i.R2)*((i.nobs-1)/i.df_resid);return i.t=n,i.f=l,i.adjust_R2=s,i}}}(),e.extend({buildxmatrix:function(){for(var t=Array(arguments.length),a=0,o;a<arguments.length;a++)o=[1],t[a]=o.concat(arguments[a]);return e(t)},builddxmatrix:function(){for(var t=Array(arguments[0].length),a=0,o;a<arguments[0].length;a++)o=[1],t[a]=o.concat(arguments[0][a]);return e(t)},buildjxmatrix:function(t){for(var a=Array(t.length),o=0;o<t.length;o++)a[o]=t[o];return e.builddxmatrix(a)},buildymatrix:function(t){return e(t).transpose()},buildjymatrix:function(e){return e.transpose()},matrixmult:function(t,a){var o,r,n,l,s;if(t.cols()==a.rows()){if(1<a.rows()){for(l=[],o=0;o<t.rows();o++)for(l[o]=[],r=0;r<a.cols();r++){for(s=0,n=0;n<t.cols();n++)s+=t.toArray()[o][n]*a.toArray()[n][r];l[o][r]=s}return e(l)}for(l=[],o=0;o<t.rows();o++)for(l[o]=[],r=0;r<a.cols();r++){for(s=0,n=0;n<t.cols();n++)s+=t.toArray()[o][n]*a.toArray()[r];l[o][r]=s}return e(l)}},regress:function(t,a){var o=e.xtranspxinv(t),r=t.transpose(),i=e.matrixmult(e(o),r);return e.matrixmult(i,a)},regresst:function(t,a,o){var r=e.regress(t,a),n={};n.anova={};var l=e.jMatYBar(t,r);n.yBar=l;var s=a.mean();n.anova.residuals=e.residuals(a,l),n.anova.ssr=e.ssr(l,s),n.anova.msr=n.anova.ssr/(t[0].length-1),n.anova.sse=e.sse(a,l),n.anova.mse=n.anova.sse/(a.length-(t[0].length-1)-1),n.anova.sst=e.sst(a,s),n.anova.mst=n.anova.sst/(a.length-1),n.anova.r2=1-n.anova.sse/n.anova.sst,0>n.anova.r2&&(n.anova.r2=0),n.anova.fratio=n.anova.msr/n.anova.mse,n.anova.pvalue=e.anovaftest(n.anova.fratio,t[0].length-1,a.length-(t[0].length-1)-1),n.anova.rmse=_(n.anova.mse),n.anova.r2adj=1-n.anova.mse/n.anova.mst,0>n.anova.r2adj&&(n.anova.r2adj=0),n.stats=Array(t[0].length);for(var d=e.xtranspxinv(t),c=0,p,u,g;c<r.length;c++)p=_(n.anova.mse*I(d[c][c])),u=I(r[c]/p),g=e.ttest(u,a.length-t[0].length-1,o),n.stats[c]=[r[c],p,u,g];return n.regress=r,n},xtranspx:function(t){return e.matrixmult(t.transpose(),t)},xtranspxinv:function(t){var a=e.matrixmult(t.transpose(),t),o=e.inv(a);return o},jMatYBar:function(t,a){var o=e.matrixmult(t,a);return new e(o)},residuals:function(t,a){return e.matrixsubtract(t,a)},ssr:function e(t,a){for(var e=0,o=0;o<t.length;o++)e+=C(t[o]-a,2);return e},sse:function e(t,a){for(var e=0,o=0;o<t.length;o++)e+=C(t[o]-a[o],2);return e},sst:function e(t,a){for(var e=0,o=0;o<t.length;o++)e+=C(t[o]-a,2);return e},matrixsubtract:function(t,a){for(var o=Array(t.length),r=0;r<t.length;r++){o[r]=Array(t[r].length);for(var n=0;n<t[r].length;n++)o[r][n]=t[r][n]-a[r][n]}return e(o)}}),e.jStat=e,e})},{}],395:[function(e,t){t.exports=function(e,a,o){return e*(1-o)+a*o}},{}],396:[function(e,t,a){var o=Number.MAX_VALUE,d=String.fromCharCode,c=Math.asin,p=Math.acos,u=Math.SQRT2,g=Math.exp,k=Math.atan2,T=Math.LN2,A=Math.LN10,C=Math.log,Ge=Math.cos,Ye=Math.ceil,We=Math.sqrt,Xe=Math.round,Ke=Math.PI,Je=Math.sin,Rt=Math.min,pa=Math.pow,ua=Math.tan,ga=Math.atan,ma=Math.abs,ha=Math.max,ya=Math.floor;(function(e,o){"object"==typeof a&&"undefined"!=typeof t?t.exports=o():"function"==typeof define&&define.amd?define(o):(e=e||self,e.mapboxgl=o())})(this,function(){'use strict';function e(e,o){if(!t)t=o;else if(!a)a=o;else{var i="var sharedChunk = {}; ("+t+")(sharedChunk); ("+a+")(sharedChunk);",n={};t(n),r=o(n),r.workerUrl=window.URL.createObjectURL(new Blob([i],{type:"text/javascript"}))}}var t,a,r;return e(["exports"],function(q){var Wl=Number.POSITIVE_INFINITY,$d=Math.hypot;function t(a,t){return a(t={exports:{}},t.exports),t.exports}function e(a,t,e,o){this.cx=3*a,this.bx=3*(e-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(o-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=o,this.p2x=e,this.p2y=o}function n(a,t){this.x=a,this.y=t}function a(o,t,e,r){var i=new Jd(o,t,e,r);return function(e){return i.solve(e)}}function io(a,t,e){return Rt(e,ha(t,a))}function o(a,t,e){var o=e-t,r=((a-t)%o+o)%o+t;return r===t?e:r}function _o(l){for(var t=[],e=arguments.length-1;0<e--;)t[e]=arguments[e+1];for(var s=0,d=t,i;s<d.length;s+=1)for(var c in i=d[s],i)l[c]=i[c];return l}function l(){return i++}function h(){return function a(t){return t?(t^16*Math.random()>>t/4).toString(16):"10000000-1000-4000-8000-100000000000".replace(/[018]/g,a)}()}function f(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function y(a,o){a.forEach(function(e){o[e]&&(o[e]=o[e].bind(o))})}function ed(a,t){return-1!==a.indexOf(t,a.length-t.length)}function m(a,t,e){var o={};for(var r in a)o[r]=t.call(e||this,a[r],r,a);return o}function v(a,t,e){var o={};for(var r in a)t.call(e||this,a[r],r,a)&&(o[r]=a[r]);return o}function td(e){return Array.isArray(e)?e.map(td):"object"==typeof e&&e?m(e,td):e}function ad(e){s[e]||("undefined"!=typeof console&&console.warn(e),s[e]=!0)}function x(a,t,e){return(e.y-a.y)*(t.x-a.x)>(t.y-a.y)*(e.x-a.x)}function _(l){for(var t=0,s=0,d=l.length,n=d-1,c=void 0,p=void 0;s<d;n=s++)t+=((p=l[n]).x-(c=l[s]).x)*(c.y+p.y);return t}function w(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function S(a){var o={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(e,t,r,n){var i=r||n;return o[t]=!i||i.toLowerCase(),""}),o["max-age"]){var e=parseInt(o["max-age"],10);isNaN(e)?delete o["max-age"]:o["max-age"]=e}return o}function od(a){if(null==b){var t=a.navigator?a.navigator.userAgent:null;b=!!a.safari||t&&(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome"))}return b}function z(a){try{var t=self[a];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch(e){return!1}}function rd(a){var t=a.createTexture();a.bindTexture(a.TEXTURE_2D,t);try{if(a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,ic),a.isContextLost())return;L.supported=!0}catch(e){}a.deleteTexture(t),R=!0}function j(e){return 0===e.indexOf("mapbox:")}function K(e){return N.test(e)}function Z(a){var t=a.match(G);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function J(a){var t=a.params.length?"?"+a.params.join("&"):"";return a.protocol+"://"+a.authority+a.path+t}function H(a){if(!a)return null;var t=a.split(".");if(!t||3!==t.length)return null;try{return JSON.parse(decodeURIComponent(self.atob(t[1]).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(e){return null}}function Y(){self.caches&&!ht&&(ht=self.caches.open("mapbox-tiles"))}function st(a){var t=a.indexOf("?");return 0>t?a:a.slice(0,t)}function ut(){return null==pc&&(pc=self.OffscreenCanvas&&new self.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof self.createImageBitmap),pc}function ct(a,t,e){e[a]&&-1!==e[a].indexOf(t)||(e[a]=e[a]||[],e[a].push(t))}function wt(a,t,e){if(e&&e[a]){var o=e[a].indexOf(t);-1!==o&&e[a].splice(o,1)}}function _t(a){var t=a.value;return t?[new It(a.key,t,"constants have been deprecated as of v8")]:[]}function Ct(l){for(var t=[],e=arguments.length-1;0<e--;)t[e]=arguments[e+1];for(var s=0,d=t,i;s<d.length;s+=1)for(var c in i=d[s],i)l[c]=i[c];return l}function Mt(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function Et(a){if(Array.isArray(a))return a.map(Et);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){var t={};for(var e in a)t[e]=Et(a[e]);return t}return Mt(a)}function Tt(a,t){return{kind:"array",itemType:a,N:t}}function Kt(a){if("array"===a.kind){var t=Kt(a.itemType);return"number"==typeof a.N?"array<"+t+", "+a.N+">":"value"===a.itemType.kind?"array":"array<"+t+">"}return a.kind}function Gt(a,t){if("error"===t.kind)return null;if("array"!==a.kind){if(a.kind===t.kind)return null;if("value"===a.kind)for(var e=0,o=Nt;e<o.length;e+=1)if(!Gt(o[e],t))return null}else if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!Gt(a.itemType,t.itemType))&&("number"!=typeof a.N||a.N===t.N))return null;return"Expected "+Kt(a)+" but found "+Kt(t)+" instead."}function Xt(a,t){return t.some(function(t){return t.kind===a.kind})}function Jt(a,t){return t.some(function(t){return"null"===t?null===a:"array"===t?Array.isArray(a):"object"===t?a&&!Array.isArray(a)&&"object"==typeof a:t==typeof a})}function Ht(a,t,e,o){return"number"==typeof a&&0<=a&&255>=a&&"number"==typeof t&&0<=t&&255>=t&&"number"==typeof e&&0<=e&&255>=e?void 0===o||"number"==typeof o&&0<=o&&1>=o?null:"Invalid rgba value ["+[a,t,e,o].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof o?[a,t,e,o]:[a,t,e]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function re(a){if(null===a)return!0;if("string"==typeof a)return!0;if("boolean"==typeof a)return!0;if("number"==typeof a)return!0;if(a instanceof Yt)return!0;if(a instanceof $t)return!0;if(a instanceof Qt)return!0;if(a instanceof te)return!0;if(Array.isArray(a)){for(var t=0,o=a;t<o.length;t+=1)if(!re(o[t]))return!1;return!0}if("object"==typeof a){for(var r in a)if(!re(a[r]))return!1;return!0}return!1}function ne(o){if(null===o)return Bt;if("string"==typeof o)return Ft;if("boolean"==typeof o)return Dt;if("number"==typeof o)return Vt;if(o instanceof Yt)return Lt;if(o instanceof $t)return Ut;if(o instanceof Qt)return jt;if(o instanceof te)return qt;if(Array.isArray(o)){for(var t=o.length,r=0,l=o,i,s;r<l.length;r+=1){if(s=ne(l[r]),i){if(i===s)continue;i=Ot;break}i=s}return Tt(i||Ot,t)}return hc}function ie(a){var t=typeof a;return null===a?"":"string"===t||"number"===t||"boolean"===t?a+"":a instanceof Yt||a instanceof Qt||a instanceof te?a.toString():JSON.stringify(a)}function ae(a,t){a[0]=Rt(a[0],t[0]),a[1]=Rt(a[1],t[1]),a[2]=ha(a[2],t[0]),a[3]=ha(a[3],t[1])}function ge(a,t){return!(a[0]<=t[0]||a[2]>=t[2]||a[1]<=t[1]||a[3]>=t[3])}function xe(a,t){var e=(180+a[0])/360,o=(180-180/Ke*C(ua(Ke/4+a[1]*Ke/360)))/360,r=pa(2,t.z);return[Xe(8192*(e*r)),Xe(8192*(o*r))]}function be(a,t,e){return t[1]>a[1]!=e[1]>a[1]&&a[0]<(e[0]-t[0])*(a[1]-t[1])/(e[1]-t[1])+t[0]}function we(d,t){for(var e=!1,g=0,m=t.length,c,x,_,b,v,w,k;g<m;g++)for(var T=t[g],h=0,A=T.length;h<A-1;h++){if(0==(b=(c=d)[0]-(x=T[h])[0])*(k=c[1]-(_=T[h+1])[1])-(w=c[0]-_[0])*(v=c[1]-x[1])&&0>=b*w&&0>=v*k)return!1;be(d,T[h],T[h+1])&&(e=!e)}return e}function _e(a,t){for(var e=0;e<t.length;e++)if(we(a,t[e]))return!0;return!1}function Ae(l,t,e,r){var n=r[0]-e[0],i=r[1]-e[1],a=(l[0]-e[0])*i-n*(l[1]-e[1]),o=(t[0]-e[0])*i-n*(t[1]-e[1]);return 0<a&&0>o||0>a&&0<o}function Se(d,t,e){for(var r=0,g=e;r<g.length;r+=1)for(var i=g[r],a=0;a<i.length-1;++a)if(0!=(_=[(x=i[a+1])[0]-(f=i[a])[0],x[1]-f[1]])[0]*(b=[(y=t)[0]-(m=d)[0],y[1]-m[1]])[1]-_[1]*b[0]&&Ae(m,y,f,x)&&Ae(f,x,m,y))return!0;var m,y,f,x,_,b;return!1}function ke(a,t){for(var e=0;e<a.length;++e)if(!we(a[e],t))return!1;for(var o=0;o<a.length-1;++o)if(Se(a[o],a[o+1],t))return!1;return!0}function Ie(a,t){for(var e=0;e<t.length;e++)if(ke(a,t[e]))return!0;return!1}function ze(l,t,e){for(var r=[],n=0;n<l.length;n++){for(var d=[],a=0,c;a<l[n].length;a++)c=xe(l[n][a],e),ae(t,c),d.push(c);r.push(d)}return r}function Ce(o,t,e){for(var r=[],n=0,l;n<o.length;n++)l=ze(o[n],t,e),r.push(l);return r}function Me(o,t,e,r){if(o[0]<e[0]||o[0]>e[2]){var n=.5*r,i=o[0]-e[0]>n?-r:e[0]-o[0]>n?r:0;0===i&&(i=o[0]-e[2]>n?-r:e[2]-o[0]>n?r:0),o[0]+=i}ae(t,o)}function Ee(d,t,e,r){for(var n=8192*pa(2,r.z),i=[8192*r.x,8192*r.y],a=[],o=0,g=d;o<g.length;o+=1)for(var u=0,m=g[o];u<m.length;u+=1){var p=m[u],c=[p.x+i[0],p.y+i[1]];Me(c,t,e,n),a.push(c)}return a}function Te(x,t,e,r){for(var n=8192*pa(2,r.z),a=[8192*r.x,8192*r.y],o=[],s=0,_=x,l;s<_.length;s+=1){for(var b=[],p=0,w=_[s];p<w.length;p+=1){var h=w[p],f=[h.x+a[0],h.y+a[1]];ae(t,f),b.push(f)}o.push(b)}if(t[2]-t[0]<=n/2){(l=t)[0]=l[1]=1/0,l[2]=l[3]=-1/0;for(var y=0,k=o;y<k.length;y+=1)for(var m=0,T=k[y];m<T.length;m+=1)Me(T[m],t,e,n)}return o}function Pe(a){if(a instanceof de){if("get"===a.name&&1===a.args.length)return!1;if("feature-state"===a.name)return!1;if("has"===a.name&&1===a.args.length)return!1;if("properties"===a.name||"geometry-type"===a.name||"id"===a.name)return!1;if(/^filter-/.test(a.name))return!1}if(a instanceof ve)return!1;var o=!0;return a.eachChild(function(e){o&&!Pe(e)&&(o=!1)}),o}function Ve(a){if(a instanceof de&&"feature-state"===a.name)return!1;var o=!0;return a.eachChild(function(e){o&&!Ve(e)&&(o=!1)}),o}function Fe(a,o){if(a instanceof de&&0<=o.indexOf(a.name))return!1;var e=!0;return a.eachChild(function(a){e&&!Fe(a,o)&&(e=!1)}),e}function De(l,t){for(var e=l.length-1,n=0,s=e,d=0,c;n<=s;)if((c=l[d=ya((n+s)/2)])<=t){if(d===e||t<l[d+1])return d;n=d+1}else{if(!(c>t))throw new oe("Input is not a number.");s=d-1}return 0}function Oe(a,t,e){return a*(1-e)+t*e}function je(e){return .008856451679035631<e?pa(e,1/3):e/qe+4/29}function Ze(e){return e>6/29?e*e*e:qe*(e-4/29)}function id(e){return 255*(.0031308>=e?12.92*e:1.055*pa(e,1/2.4)-.055)}function nd(e){return .04045>=(e/=255)?e/12.92:pa((e+.055)/1.055,2.4)}function He(o){var t=nd(o.r),e=nd(o.g),r=nd(o.b),n=je((.4124564*t+.3575761*e+.1804375*r)/.95047),i=je((.2126729*t+.7151522*e+.072175*r)/1);return{l:116*i-16,a:500*(n-i),b:200*(i-je((.0193339*t+.119192*e+.9503041*r)/1.08883)),alpha:o.a}}function ld(a){var t=(a.l+16)/116,o=isNaN(a.a)?t:t+a.a/500,i=isNaN(a.b)?t:t-a.b/200;return t=1*Ze(t),o=.95047*Ze(o),i=1.08883*Ze(i),new Yt(id(3.2404542*o-1.5371385*t-.4985314*i),id(-.969266*o+1.8760108*t+.041556*i),id(.0556434*o-.2040259*t+1.0572252*i),a.alpha)}function $e(a,t,e){var o=t-a;return a+e*(180<o||-180>o?o-360*Xe(o/360):o)}function sd(o,t,e,r){var n=r-e,i=o-e;return 0==n?0:1===t?i/n:(pa(t,i)-1)/(pa(t,n)-1)}function nr(a,t){return"=="===a||"!="===a?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function hr(a,t,e,o){return 0===o.compare(t,e)}function fr(i,t,e){var d="=="!==i&&"!="!==i;return function(){function n(a,t,e){this.type=Dt,this.lhs=a,this.rhs=t,this.collator=e,this.hasUntypedArgument="value"===a.type.kind||"value"===t.type.kind}return n.parse=function(i,t){if(3!==i.length&&4!==i.length)return t.error("Expected two or three arguments.");var e=i[0],r=t.parse(i[1],1,Ot);if(!r)return null;if(!nr(e,r.type))return t.concat(1).error("\""+e+"\" comparisons are not supported for type '"+Kt(r.type)+"'.");var l=t.parse(i[2],2,Ot);if(!l)return null;if(!nr(e,l.type))return t.concat(2).error("\""+e+"\" comparisons are not supported for type '"+Kt(l.type)+"'.");if(r.type.kind!==l.type.kind&&"value"!==r.type.kind&&"value"!==l.type.kind)return t.error("Cannot compare types '"+Kt(r.type)+"' and '"+Kt(l.type)+"'.");d&&("value"===r.type.kind&&"value"!==l.type.kind?r=new ue(l.type,[r]):"value"!==r.type.kind&&"value"===l.type.kind&&(l=new ue(r.type,[l])));var c=null;if(4===i.length){if("string"!==r.type.kind&&"string"!==l.type.kind&&"value"!==r.type.kind&&"value"!==l.type.kind)return t.error("Cannot use collator to compare non-string types.");if(!(c=t.parse(i[3],3,Ut)))return null}return new n(r,l,c)},n.prototype.evaluate=function(r){var n=this.lhs.evaluate(r),a=this.rhs.evaluate(r);if(d&&this.hasUntypedArgument){var o=ne(n),s=ne(a);if(o.kind!==s.kind||"string"!==o.kind&&"number"!==o.kind)throw new oe("Expected arguments for \""+i+"\" to be (string, string) or (number, number), but found ("+o.kind+", "+s.kind+") instead.")}if(this.collator&&!d&&this.hasUntypedArgument){var c=ne(n),l=ne(a);if("string"!==c.kind||"string"!==l.kind)return t(r,n,a)}return this.collator?e(r,n,a,this.collator.evaluate(r)):t(r,n,a)},n.prototype.eachChild=function(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)},n.prototype.outputDefined=function(){return!0},n.prototype.serialize=function(){var a=[i];return this.eachChild(function(e){a.push(e.serialize())}),a},n}()}function yr(l,t){var e=t[0],d=t[1],c=t[2],p=t[3];e=e.evaluate(l),d=d.evaluate(l),c=c.evaluate(l);var a=p?p.evaluate(l):1,o=Ht(e,d,c,a);if(o)throw new oe(o);return new Yt(e/255*a,d/255*a,c/255*a,a)}function Sr(a,t){return a in t}function kr(a,t){var e=t[a];return void 0===e?null:e}function Ir(e){return{type:e}}function zr(e){return{result:"success",value:e}}function Cr(e){return{result:"error",value:e}}function Mr(e){return"data-driven"===e["property-type"]||"cross-faded-data-driven"===e["property-type"]}function Er(e){return!!e.expression&&-1<e.expression.parameters.indexOf("zoom")}function Tr(e){return!!e.expression&&e.expression.interpolated}function Pr(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}function Br(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function Vr(e){return e}function Fr(a,t,e){return void 0===a?void 0===t?void 0===e?void 0:e:t:a}function Dr(a,t,e,o,r){return Fr(typeof e===r?o[e]:void 0,a.default,t.default)}function Lr(a,t,e){if("number"!==Pr(e))return Fr(a.default,t.default);var o=a.stops.length;if(1===o)return a.stops[0][1];if(e<=a.stops[0][0])return a.stops[0][1];if(e>=a.stops[o-1][0])return a.stops[o-1][1];var r=De(a.stops.map(function(e){return e[0]}),e);return a.stops[r][1]}function Rr(d,t,e){var r=void 0===d.base?1:d.base;if("number"!==Pr(e))return Fr(d.default,t.default);var n=d.stops.length;if(1===n)return d.stops[0][1];if(e<=d.stops[0][0])return d.stops[0][1];if(e>=d.stops[n-1][0])return d.stops[n-1][1];var i=De(d.stops.map(function(e){return e[0]}),e),a=function(o,t,e,r){var n=r-e,i=o-e;return 0==n?0:1===t?i/n:(pa(t,i)-1)/(pa(t,n)-1)}(e,r,d.stops[i][0],d.stops[i+1][0]),o=d.stops[i][1],s=d.stops[i+1][1],c=Ue[t.type]||Vr;if(d.colorSpace&&"rgb"!==d.colorSpace){var u=tr[d.colorSpace];c=function(o,t){return u.reverse(u.interpolate(u.forward(o),u.forward(t),a))}}return"function"==typeof o.evaluate?{evaluate:function(){for(var i=[],t=arguments.length;t--;)i[t]=arguments[t];var l=o.evaluate.apply(void 0,i),r=s.evaluate.apply(void 0,i);if(void 0!==l&&void 0!==r)return c(l,r,a)}}:c(o,s,a)}function Or(a,t,e){return"color"===t.type?e=Yt.parse(e):"formatted"===t.type?e=Qt.fromString(e.toString()):"resolvedImage"===t.type?e=te.fromString(e.toString()):Pr(e)===t.type||"enum"===t.type&&t.values[e]||(e=void 0),Fr(e,a.default,t.default)}function Ur(e){return Array.isArray(e)&&0<e.length&&"string"==typeof e[0]&&e[0]in _r}function qr(a,t){var e=new Le(_r,[],t?function(a){var t={color:Lt,string:Ft,number:Vt,enum:Ft,boolean:Dt,formatted:jt,resolvedImage:qt};return"array"===a.type?Tt(t[a.value]||Ot,a.length):t[a.type]}(t):void 0),o=e.parse(a,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return o?zr(new Ar(o,t)):Cr(e.errors)}function Nr(o,l){if("error"===(o=qr(o,l)).result)return o;var e=o.value.expression,r=Pe(e);if(!r&&!Mr(l))return Cr([new zt("","data expressions not supported")]);var n=Fe(e,["zoom"]);if(!n&&!Er(l))return Cr([new zt("","zoom expressions not supported")]);var i=function a(t){var o=null;if(t instanceof ir)o=a(t.result);else if(t instanceof rr)for(var e=0,l=t.args;e<l.length&&!(o=a(l[e]));e+=1);else(t instanceof Re||t instanceof er)&&t.input instanceof de&&"zoom"===t.input.name&&(o=t);return o instanceof zt||t.eachChild(function(t){var e=a(t);e instanceof zt?o=e:!o&&e?o=new zt("","\"zoom\" expression may only be used as input to a top-level \"step\" or \"interpolate\" expression."):o&&e&&o!==e&&(o=new zt("","Only one zoom-based \"step\" or \"interpolate\" subexpression may be used in an expression."))}),o}(e);return i||n?i instanceof zt?Cr([i]):i instanceof er&&!Tr(l)?Cr([new zt("","\"interpolate\" expressions cannot be used with this property")]):zr(i?new Kr(r?"camera":"composite",o.value,i.labels,i instanceof er?i.interpolation:void 0):new jr(r?"constant":"source",o.value)):Cr([new zt("","\"zoom\" expression may only be used as input to a top-level \"step\" or \"interpolate\" expression.")])}function Zr(d){var t=d.key,e=d.value,r=d.valueSpec||{},n=d.objectElementValidators||{},i=d.style,a=d.styleSpec,o=[],g=Pr(e);if("object"!==g)return[new It(t,e,"object expected, "+g+" found")];for(var u in e){var l=u.split(".")[0],p=r[l]||r["*"],c=void 0;if(n[l])c=n[l];else if(r[l])c=gn;else if(n["*"])c=n["*"];else{if(!r["*"]){o.push(new It(t,e[u],"unknown property \""+u+"\""));continue}c=gn}o=o.concat(c({key:(t?t+".":t)+u,value:e[u],valueSpec:p,style:i,styleSpec:a,object:e,objectKey:u},e))}for(var m in r)n[m]||r[m].required&&void 0===r[m].default&&void 0===e[m]&&o.push(new It(t,e,"missing required property \""+m+"\""));return o}function Jr(d){var t=d.value,e=d.valueSpec,r=d.style,n=d.styleSpec,i=d.key,a=d.arrayElementValidator||gn;if("array"!==Pr(t))return[new It(i,t,"array expected, "+Pr(t)+" found")];if(e.length&&t.length!==e.length)return[new It(i,t,"array length "+e.length+" expected, length "+t.length+" found")];if(e["min-length"]&&t.length<e["min-length"])return[new It(i,t,"array length at least "+e["min-length"]+" expected, length "+t.length+" found")];var o={type:e.value,values:e.values};7>n.$version&&(o.function=e.function),"object"===Pr(e.value)&&(o=e.value);for(var c=[],p=0;p<t.length;p++)c=c.concat(a({array:t,arrayIndex:p,value:t[p],valueSpec:o,style:r,styleSpec:n,key:i+"["+p+"]"}));return c}function Hr(a){var t=a.key,e=a.value,o=a.valueSpec,r=Pr(e);return"number"===r&&e!=e&&(r="NaN"),"number"===r?"minimum"in o&&e<o.minimum?[new It(t,e,e+" is less than the minimum value "+o.minimum)]:"maximum"in o&&e>o.maximum?[new It(t,e,e+" is greater than the maximum value "+o.maximum)]:[]:[new It(t,e,"number expected, "+r+" found")]}function Yr(d){function u(o){var t=[],r=o.value,a=o.key;if("array"!==Pr(r))return[new It(a,r,"array expected, "+Pr(r)+" found")];if(2!==r.length)return[new It(a,r,"array length 2 expected, length "+r.length+" found")];if(h){if("object"!==Pr(r[0]))return[new It(a,r,"object expected, "+Pr(r[0])+" found")];if(void 0===r[0].zoom)return[new It(a,r,"object stop key must have zoom")];if(void 0===r[0].value)return[new It(a,r,"object stop key must have value")];if(l&&l>Mt(r[0].zoom))return[new It(a,r[0].zoom,"stop zoom values must appear in ascending order")];Mt(r[0].zoom)!==l&&(l=Mt(r[0].zoom),f=void 0,m={}),t=t.concat(Zr({key:a+"[0]",value:r[0],valueSpec:{zoom:{}},style:o.style,styleSpec:o.styleSpec,objectElementValidators:{zoom:Hr,value:c}}))}else t=t.concat(c({key:a+"[0]",value:r[0],valueSpec:{},style:o.style,styleSpec:o.styleSpec},r));return Ur(Et(r[1]))?t.concat([new It(a+"[1]",r[1],"expressions are not allowed in function stops.")]):t.concat(gn({key:a+"[1]",value:r[1],valueSpec:g,style:o.style,styleSpec:o.styleSpec}))}function c(e,t){var a=Pr(e.value),o=Mt(e.value),r=null===e.value?t:e.value;if(!y)y=a;else if(a!==y)return[new It(e.key,r,a+" stop domain type must match previous stop domain type "+y)];if("number"!==a&&"string"!==a&&"boolean"!==a)return[new It(e.key,r,"stop domain value must be a number, string, or boolean")];if("number"!==a&&"categorical"!==i){var n="number expected, "+a+" found";return Mr(g)&&void 0===i&&(n+="\nIf you intended to use a categorical function, specify `\"type\": \"categorical\"`."),[new It(e.key,r,n)]}return"categorical"!==i||"number"!==a||isFinite(o)&&ya(o)===o?"categorical"!==i&&"number"===a&&void 0!==f&&o<f?[new It(e.key,r,"stop domain values must appear in ascending order")]:(f=o,"categorical"===i&&o in m?[new It(e.key,r,"stop domain values must be unique")]:(m[o]=!0,[])):[new It(e.key,r,"integer expected, found "+o)]}var g=d.valueSpec,i=Mt(d.value.type),m={},t="categorical"!==i&&void 0===d.value.property,h="array"===Pr(d.value.stops)&&"array"===Pr(d.value.stops[0])&&"object"===Pr(d.value.stops[0][0]),a=Zr({key:d.key,value:d.value,valueSpec:d.styleSpec.function,style:d.style,styleSpec:d.styleSpec,objectElementValidators:{stops:function(a){if("identity"===i)return[new It(a.key,a.value,"identity function may not have a \"stops\" property")];var t=[],o=a.value;return t=t.concat(Jr({key:a.key,value:o,valueSpec:a.valueSpec,style:a.style,styleSpec:a.styleSpec,arrayElementValidator:u})),"array"===Pr(o)&&0===o.length&&t.push(new It(a.key,o,"array must have at least one stop")),t},default:function(e){return gn({key:e.key,value:e.value,valueSpec:g,style:e.style,styleSpec:e.styleSpec})}}}),y,f,l;return"identity"===i&&t&&a.push(new It(d.key,d.value,"missing required property \"property\"")),"identity"===i||d.value.stops||a.push(new It(d.key,d.value,"missing required property \"stops\"")),"exponential"===i&&d.valueSpec.expression&&!Tr(d.valueSpec)&&a.push(new It(d.key,d.value,"exponential functions not supported")),8<=d.styleSpec.$version&&(!t&&!Mr(d.valueSpec)?a.push(new It(d.key,d.value,"property functions not supported")):t&&!Er(d.valueSpec)&&a.push(new It(d.key,d.value,"zoom functions not supported"))),"categorical"!==i&&!h||void 0!==d.value.property||a.push(new It(d.key,d.value,"\"property\" property is required")),a}function $r(a){var t=("property"===a.expressionContext?Nr:qr)(Et(a.value),a.valueSpec);if("error"===t.result)return t.value.map(function(t){return new It(""+a.key+t.key,a.value,t.message)});var e=t.value.expression||t.value._styleExpression.expression;if("property"===a.expressionContext&&"text-font"===a.propertyKey&&!e.outputDefined())return[new It(a.key,a.value,"Invalid data expression for \""+a.propertyKey+"\". Output values must be contained as literals within the expression.")];if("property"===a.expressionContext&&"layout"===a.propertyType&&!Ve(e))return[new It(a.key,a.value,"\"feature-state\" data expressions are not supported with layout properties.")];if("filter"===a.expressionContext&&!Ve(e))return[new It(a.key,a.value,"\"feature-state\" data expressions are not supported with filters.")];if(a.expressionContext&&0===a.expressionContext.indexOf("cluster")){if(!Fe(e,["zoom","feature-state"]))return[new It(a.key,a.value,"\"zoom\" and \"feature-state\" expressions are not supported with cluster properties.")];if("cluster-initial"===a.expressionContext&&!Pe(e))return[new It(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Wr(a){var t=a.key,e=a.value,o=a.valueSpec,r=[];return Array.isArray(o.values)?-1===o.values.indexOf(Mt(e))&&r.push(new It(t,e,"expected one of ["+o.values.join(", ")+"], "+JSON.stringify(e)+" found")):-1===Object.keys(o.values).indexOf(Mt(e))&&r.push(new It(t,e,"expected one of ["+Object.keys(o.values).join(", ")+"], "+JSON.stringify(e)+" found")),r}function Qr(a){if(!0===a||!1===a)return!0;if(!Array.isArray(a)||0===a.length)return!1;switch(a[0]){case"has":return 2<=a.length&&"$id"!==a[1]&&"$type"!==a[1];case"in":return 3<=a.length&&("string"!=typeof a[1]||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==a.length||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(var t=0,o=a.slice(1),r;t<o.length;t+=1)if(r=o[t],!Qr(r)&&"boolean"!=typeof r)return!1;return!0;default:return!0;}}function tn(a){if(null==a)return{filter:function(){return!0},needGeometry:!1};Qr(a)||(a=nn(a));var o=qr(a,Xr);if("error"===o.result)throw new Error(o.value.map(function(e){return e.key+": "+e.message}).join(", "));return{filter:function(e,t,a){return o.value.evaluate(e,t,{},a)},needGeometry:Array.isArray(a)&&0!==a.length&&"within"===a[0]}}function rn(a,t){return a<t?-1:a>t?1:0}function nn(a){if(!a)return!0;var t=a[0],o;return 1>=a.length?"any"!==t:"=="===t?an(a[1],a[2],"=="):"!="===t?un(an(a[1],a[2],"==")):"<"===t||">"===t||"<="===t||">="===t?an(a[1],a[2],t):"any"===t?(o=a.slice(1),["any"].concat(o.map(nn))):"all"===t?["all"].concat(a.slice(1).map(nn)):"none"===t?["all"].concat(a.slice(1).map(nn).map(un)):"in"===t?on(a[1],a.slice(2)):"!in"===t?un(on(a[1],a.slice(2))):"has"===t?sn(a[1]):"!has"!==t||un(sn(a[1]))}function an(a,t,e){return"$type"===a?["filter-type-"+e,t]:"$id"===a?["filter-id-"+e,t]:["filter-"+e,a,t]}function on(a,o){return 0!==o.length&&("$type"===a?["filter-type-in",["literal",o]]:"$id"===a?["filter-id-in",["literal",o]]:200<o.length&&!o.some(function(e){return typeof e!=typeof o[0]})?["filter-in-large",a,["literal",o.sort(rn)]]:["filter-in-small",a,["literal",o]])}function sn(e){return"$type"===e||("$id"===e?["filter-has-id"]:["filter-has",e])}function un(e){return["!",e]}function ln(e){return Qr(Et(e.value))?$r(Ct({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function l(t){var e=t.value,r=t.key;if("array"!==Pr(e))return[new It(r,e,"array expected, "+Pr(e)+" found")];var n=t.styleSpec,a=[],d;if(1>e.length)return[new It(r,e,"filter array must have at least 1 element")];switch(a=a.concat(Wr({key:r+"[0]",value:e[0],valueSpec:n.filter_operator,style:t.style,styleSpec:t.styleSpec})),Mt(e[0])){case"<":case"<=":case">":case">=":2<=e.length&&"$type"===Mt(e[1])&&a.push(new It(r,e,"\"$type\" cannot be use with operator \""+e[0]+"\""));case"==":case"!=":3!==e.length&&a.push(new It(r,e,"filter array for operator \""+e[0]+"\" must have 3 elements"));case"in":case"!in":2<=e.length&&"string"!==(d=Pr(e[1]))&&a.push(new It(r+"[1]",e[1],"string expected, "+d+" found"));for(var c=2;c<e.length;c++)d=Pr(e[c]),"$type"===Mt(e[1])?a=a.concat(Wr({key:r+"["+c+"]",value:e[c],valueSpec:n.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==d&&"number"!==d&&"boolean"!==d&&a.push(new It(r+"["+c+"]",e[c],"string, number, or boolean expected, "+d+" found"));break;case"any":case"all":case"none":for(var p=1;p<e.length;p++)a=a.concat(l({key:r+"["+p+"]",value:e[p],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":d=Pr(e[1]),2===e.length?"string"!==d&&a.push(new It(r+"[1]",e[1],"string expected, "+d+" found")):a.push(new It(r,e,"filter array for \""+e[0]+"\" operator must have 2 elements"));}return a}(e)}function pn(d,t){var e=d.key,r=d.style,n=d.styleSpec,i=d.value,a=d.objectKey,o=n[t+"_"+d.layerType];if(!o)return[];var s=a.match(/^(.*)-transition$/);if("paint"===t&&s&&o[s[1]]&&o[s[1]].transition)return gn({key:e,value:i,valueSpec:n.transition,style:r,styleSpec:n});var u=d.valueSpec||o[a],p;if(!u)return[new It(e,i,"unknown property \""+a+"\"")];if("string"===Pr(i)&&Mr(u)&&!u.tokens&&(p=/^{([^}]+)}$/.exec(i)))return[new It(e,i,"\""+a+"\" does not support interpolation syntax\nUse an identity property function instead: `{ \"type\": \"identity\", \"property\": "+JSON.stringify(p[1])+" }`.")];var g=[];return"symbol"===d.layerType&&("text-field"===a&&r&&!r.glyphs&&g.push(new It(e,i,"use of \"text-field\" requires a style \"glyphs\" property")),"text-font"===a&&Br(Et(i))&&"identity"===Mt(i.type)&&g.push(new It(e,i,"\"text-font\" does not support identity functions"))),g.concat(gn({key:d.key,value:i,valueSpec:u,style:r,styleSpec:n,expressionContext:"property",propertyType:t,propertyKey:a}))}function cn(e){return pn(e,"paint")}function hn(e){return pn(e,"layout")}function fn(d){var g=[],m=d.value,r=d.key,t=d.style,i=d.styleSpec;m.type||m.ref||g.push(new It(r,m,"either \"type\" or \"ref\" is required"));var a=Mt(m.type),n=Mt(m.ref),u;if(m.id)for(var y=Mt(m.id),l=0,x;l<d.arrayIndex;l++)x=t.layers[l],Mt(x.id)===y&&g.push(new It(r,m.id,"duplicate layer id \""+m.id+"\", previously used at line "+x.id.__line__));if("ref"in m)["type","source","source-layer","filter","layout"].forEach(function(e){e in m&&g.push(new It(r,m[e],"\""+e+"\" is prohibited for ref layers"))}),t.layers.forEach(function(e){Mt(e.id)===n&&(u=e)}),u?u.ref?g.push(new It(r,m.ref,"ref cannot reference another ref layer")):a=Mt(u.type):g.push(new It(r,m.ref,"ref layer \""+n+"\" not found"));else if("background"!==a)if(m.source){var _=t.sources&&t.sources[m.source],h=_&&Mt(_.type);_?"vector"===h&&"raster"===a?g.push(new It(r,m.source,"layer \""+m.id+"\" requires a raster source")):"raster"===h&&"raster"!==a?g.push(new It(r,m.source,"layer \""+m.id+"\" requires a vector source")):"vector"!==h||m["source-layer"]?"raster-dem"===h&&"hillshade"!==a?g.push(new It(r,m.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==a||!m.paint||!m.paint["line-gradient"]||"geojson"===h&&_.lineMetrics||g.push(new It(r,m,"layer \""+m.id+"\" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.")):g.push(new It(r,m,"layer \""+m.id+"\" must specify a \"source-layer\"")):g.push(new It(r,m.source,"source \""+m.source+"\" not found"))}else g.push(new It(r,m,"missing required property \"source\""));return g=g.concat(Zr({key:r,value:m,valueSpec:i.layer,style:d.style,styleSpec:d.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return gn({key:r+".type",value:m.type,valueSpec:i.layer.type,style:d.style,styleSpec:d.styleSpec,object:m,objectKey:"type"})},filter:ln,layout:function(e){return Zr({layer:m,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(e){return hn(Ct({layerType:a},e))}}})},paint:function(e){return Zr({layer:m,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(e){return cn(Ct({layerType:a},e))}}})}}}))}function yn(a){var t=a.value,e=a.key,o=Pr(t);return"string"===o?[]:[new It(e,t,"string expected, "+o+" found")]}function dn(d){var t=d.value,e=d.key,r=d.styleSpec,n=d.style;if(!t.type)return[new It(e,t,"\"type\" is required")];var i=Mt(t.type),o;switch(i){case"vector":case"raster":case"raster-dem":return Zr({key:e,value:t,valueSpec:r["source_"+i.replace("-","_")],style:d.style,styleSpec:r,objectElementValidators:en});case"geojson":if(o=Zr({key:e,value:t,valueSpec:r.source_geojson,style:n,styleSpec:r,objectElementValidators:en}),t.cluster)for(var c in t.clusterProperties){var s=t.clusterProperties[c],u=s[0],l="string"==typeof u?[u,["accumulated"],["get",c]]:u;o.push.apply(o,$r({key:e+"."+c+".map",value:s[1],expressionContext:"cluster-map"})),o.push.apply(o,$r({key:e+"."+c+".reduce",value:l,expressionContext:"cluster-reduce"}))}return o;case"video":return Zr({key:e,value:t,valueSpec:r.source_video,style:n,styleSpec:r});case"image":return Zr({key:e,value:t,valueSpec:r.source_image,style:n,styleSpec:r});case"canvas":return[new It(e,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Wr({key:e+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:n,styleSpec:r});}}function vn(l){var t=l.value,e=l.styleSpec,r=e.light,n=l.style,i=[],d=Pr(t);if(void 0===t)return i;if("object"!==d)return i.concat([new It("light",t,"object expected, "+d+" found")]);for(var o in t){var s=o.match(/^(.*)-transition$/);i=i.concat(s&&r[s[1]]&&r[s[1]].transition?gn({key:o,value:t[o],valueSpec:e.transition,style:n,styleSpec:e}):r[o]?gn({key:o,value:t[o],valueSpec:r[o],style:n,styleSpec:e}):[new It(o,t[o],"unknown property \""+o+"\"")])}return i}function gn(a){var t=a.value,e=a.valueSpec,o=a.styleSpec;return e.expression&&Br(Mt(t))?Yr(a):e.expression&&Ur(Et(t))?$r(a):e.type&&mn[e.type]?mn[e.type](a):Zr(Ct({},a,{valueSpec:e.type?o[e.type]:e}))}function bn(a){var t=a.value,e=a.key,o=yn(a);return o.length||(-1===t.indexOf("{fontstack}")&&o.push(new It(e,t,"\"glyphs\" url must include a \"{fontstack}\" token")),-1===t.indexOf("{range}")&&o.push(new It(e,t,"\"glyphs\" url must include a \"{range}\" token"))),o}function wn(a,t){void 0===t&&(t=kt);var o=[];return o=o.concat(gn({key:"",value:a,valueSpec:t.$root,styleSpec:t,style:a,objectElementValidators:{glyphs:bn,"*":function(){return[]}}})),a.constants&&(o=o.concat(_t({key:"constants",value:a.constants,style:a,styleSpec:t}))),_n(o)}function _n(e){return[].concat(e).sort(function(a,t){return a.line-t.line})}function An(a){return function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return _n(a.apply(this,t))}}function Sn(a,t){var e=!1;if(t&&t.length)for(var o=0,l=t;o<l.length;o+=1)a.fire(new At(new Error(l[o].message))),e=!0;return e}function Mn(d,c,g){var m=this.cells=[];if(d instanceof ArrayBuffer){this.arrayBuffer=d;var n=new Int32Array(this.arrayBuffer);d=n[0],this.d=(c=n[1])+2*(g=n[2]);for(var i=0;i<this.d*this.d;i++){var h=n[3+i],o=n[3+i+1];m.push(h===o?null:n.subarray(h,o))}var s=n[3+m.length+1];this.keys=n.subarray(n[3+m.length],s),this.bboxes=n.subarray(s),this.insert=this._insertReadonly}else{this.d=c+2*g;for(var u=0;u<this.d*this.d;u++)m.push([]);this.keys=[],this.bboxes=[]}this.n=c,this.extent=d,this.padding=g,this.scale=c/d,this.uid=0;var y=g/c*d;this.min=-y,this.max=d+y}function Tn(a,t,e){void 0===e&&(e={}),Object.defineProperty(t,"_classRegistryKey",{value:a,writeable:!1}),Bn[a]={klass:t,omit:e.omit||[],shallow:e.shallow||[]}}function Fn(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function Ln(e){return Pn&&e instanceof Pn}function Rn(d,t){if(null==d||"boolean"==typeof d||"number"==typeof d||"string"==typeof d||d instanceof Boolean||d instanceof Number||d instanceof String||d instanceof Date||d instanceof RegExp)return d;if(Fn(d)||Ln(d))return t&&t.push(d),d;if(ArrayBuffer.isView(d)){var e=d;return t&&t.push(e.buffer),e}if(d instanceof En)return t&&t.push(d.data.buffer),d;if(Array.isArray(d)){for(var r=[],n=0,c=d;n<c.length;n+=1)r.push(Rn(c[n],t));return r}if("object"==typeof d){var a=d.constructor,o=a._classRegistryKey;if(!o)throw new Error("can't serialize object of unregistered class");var s=a.serialize?a.serialize(d,t):{};if(!a.serialize){for(var u in d)if(d.hasOwnProperty(u)&&!(0<=Bn[o].omit.indexOf(u))){var l=d[u];s[u]=0<=Bn[o].shallow.indexOf(u)?l:Rn(l,t)}d instanceof Error&&(s.message=d.message)}if(s.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==o&&(s.$name=o),s}throw new Error("can't serialize object of type "+typeof d)}function On(l){if(null==l||"boolean"==typeof l||"number"==typeof l||"string"==typeof l||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp||Fn(l)||Ln(l)||ArrayBuffer.isView(l)||l instanceof En)return l;if(Array.isArray(l))return l.map(On);if("object"==typeof l){var t=l.$name||"Object",e=Bn[t].klass;if(!e)throw new Error("can't deserialize unregistered class "+t);if(e.deserialize)return e.deserialize(l);for(var r=Object.create(e.prototype),n=0,d=Object.keys(l),a;n<d.length;n+=1)if(a=d[n],"$name"!==a){var c=l[a];r[a]=0<=Bn[t].shallow.indexOf(a)?c:On(c)}return r}throw new Error("can't deserialize object of type "+typeof l)}function Un(a){for(var t=0,o=a;t<o.length;t+=1)if(Nn(o[t].charCodeAt(0)))return!0;return!1}function Nn(e){return 746===e||747===e||!(4352>e)&&(jn["Bopomofo Extended"](e)||jn.Bopomofo(e)||jn["CJK Compatibility Forms"](e)&&!(65097<=e&&65103>=e)||jn["CJK Compatibility Ideographs"](e)||jn["CJK Compatibility"](e)||jn["CJK Radicals Supplement"](e)||jn["CJK Strokes"](e)||!(!jn["CJK Symbols and Punctuation"](e)||12296<=e&&12305>=e||12308<=e&&12319>=e||12336===e)||jn["CJK Unified Ideographs Extension A"](e)||jn["CJK Unified Ideographs"](e)||jn["Enclosed CJK Letters and Months"](e)||jn["Hangul Compatibility Jamo"](e)||jn["Hangul Jamo Extended-A"](e)||jn["Hangul Jamo Extended-B"](e)||jn["Hangul Jamo"](e)||jn["Hangul Syllables"](e)||jn.Hiragana(e)||jn["Ideographic Description Characters"](e)||jn.Kanbun(e)||jn["Kangxi Radicals"](e)||jn["Katakana Phonetic Extensions"](e)||jn.Katakana(e)&&12540!==e||!(!jn["Halfwidth and Fullwidth Forms"](e)||65288===e||65289===e||65293===e||65306<=e&&65310>=e||65339===e||65341===e||65343===e||65371<=e&&65503>=e||65507===e||65512<=e&&65519>=e)||!(!jn["Small Form Variants"](e)||65112<=e&&65118>=e||65123<=e&&65126>=e)||jn["Unified Canadian Aboriginal Syllabics"](e)||jn["Unified Canadian Aboriginal Syllabics Extended"](e)||jn["Vertical Forms"](e)||jn["Yijing Hexagram Symbols"](e)||jn["Yi Syllables"](e)||jn["Yi Radicals"](e))}function Kn(e){return!(Nn(e)||function(e){return!!(jn["Latin-1 Supplement"](e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||jn["General Punctuation"](e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||jn["Letterlike Symbols"](e)||jn["Number Forms"](e)||jn["Miscellaneous Technical"](e)&&(8960<=e&&8967>=e||8972<=e&&8991>=e||8996<=e&&9e3>=e||9003===e||9085<=e&&9114>=e||9150<=e&&9165>=e||9167===e||9169<=e&&9179>=e||9186<=e&&9215>=e)||jn["Control Pictures"](e)&&9251!==e||jn["Optical Character Recognition"](e)||jn["Enclosed Alphanumerics"](e)||jn["Geometric Shapes"](e)||jn["Miscellaneous Symbols"](e)&&!(9754<=e&&9759>=e)||jn["Miscellaneous Symbols and Arrows"](e)&&(11026<=e&&11055>=e||11088<=e&&11097>=e||11192<=e&&11243>=e)||jn["CJK Symbols and Punctuation"](e)||jn.Katakana(e)||jn["Private Use Area"](e)||jn["CJK Compatibility Forms"](e)||jn["Small Form Variants"](e)||jn["Halfwidth and Fullwidth Forms"](e)||8734===e||8756===e||8757===e||9984<=e&&10087>=e||10102<=e&&10131>=e||65532===e||65533===e)}(e))}function Gn(e){return 1424<=e&&2303>=e||jn["Arabic Presentation Forms-A"](e)||jn["Arabic Presentation Forms-B"](e)}function Zn(a,t){return!(!t&&Gn(a)||2304<=a&&3583>=a||3840<=a&&4255>=a||jn.Khmer(a))}function Xn(a){for(var t=0,o=a;t<o.length;t+=1)if(Gn(o[t].charCodeAt(0)))return!0;return!1}function Jn(){Wn.fire(new bt("pluginStateChange",{pluginStatus:yc,pluginURL:fc}))}function Qn(a,l){void 0===l&&(l=1);var s=0,d=0;return{members:a.map(function(e){var t=xi[e.type].BYTES_PER_ELEMENT,r=s=Ai(s,ha(l,t)),a=e.components||1;return d=ha(d,t),s+=t*a,{name:e.name,type:e.type,components:a,offset:r}}),size:Ai(s,ha(d,l)),alignment:l}}function Ai(a,t){return Ye(a/t)*t}function Si(a,o){return 256*(a=io(ya(a),0,255))+io(ya(o),0,255)}function aa(a){var t=+a;return!isNaN(t)&&9007199254740991>=t?t:_c(a+"")}function fa(a,t,e){var o=a[t];a[t]=a[e],a[e]=o}function dd(e){return[Si(255*e.r,255*e.g),Si(255*e.b,255*e.a)]}function Sa(a,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[a]||[a.replace(t+"-","").replace(/-/g,"_")]}function Pa(a,t,e){var o=function(e){return{"line-pattern":{source:Ci,composite:Ci},"fill-pattern":{source:Ci,composite:Ci},"fill-extrusion-pattern":{source:Ci,composite:Ci}}[e]}(a);return o&&o[e]||{color:{source:Ki,composite:Gi},number:{source:Oi,composite:Ki}}[t][e]}function Ba(l){for(var t=8192/l.extent,e=l.loadGeometry(),r=0;r<e.length;r++)for(var s=e[r],i=0,d;i<s.length;i++)d=s[i],d.x=Xe(d.x*t),d.y=Xe(d.y*t),(d.x<Ta.min||d.x>Ta.max||d.y<Ta.min||d.y>Ta.max)&&(ad("Geometry exceeds allowed extent, reduce your vector tile buffer size"),d.x=io(d.x,Ta.min,Ta.max),d.y=io(d.y,Ta.min,Ta.max));return e}function Fa(a,t,e,o,r){a.emplaceBack(2*t+(o+1)/2,2*e+(r+1)/2)}function Da(a,t){for(var e=0;e<a.length;e++)if(Za(t,a[e]))return!0;for(var o=0;o<t.length;o++)if(Za(a,t[o]))return!0;return!!ja(a,t)}function Ra(a,t,e){return!!Za(a,t)||!!Na(t,a,e)}function Oa(l,t){if(1===l.length)return Ga(t,l[0]);for(var e=0;e<t.length;e++)for(var s=t[e],n=0;n<s.length;n++)if(Za(l,s[n]))return!0;for(var d=0;d<l.length;d++)if(Ga(t,l[d]))return!0;for(var c=0;c<t.length;c++)if(ja(l,t[c]))return!0;return!1}function Ua(a,t,e){if(1<a.length){if(ja(a,t))return!0;for(var o=0;o<t.length;o++)if(Na(t[o],a,e))return!0}for(var r=0;r<a.length;r++)if(Na(a[r],t,e))return!0;return!1}function ja(o,t){if(0===o.length||0===t.length)return!1;for(var e=0;e<o.length-1;e++)for(var l=o[e],n=o[e+1],i=0;i<t.length-1;i++)if(qa(l,n,t[i],t[i+1]))return!0;return!1}function qa(a,t,e,o){return x(a,e,o)!==x(t,e,o)&&x(a,t,e)!==x(a,t,o)}function Na(a,t,e){var o=e*e;if(1===t.length)return a.distSqr(t[0])<o;for(var r=1;r<t.length;r++)if(Ka(a,t[r-1],t[r])<o)return!0;return!1}function Ka(a,t,e){var o=t.distSqr(e);if(0===o)return a.distSqr(t);var r=((a.x-t.x)*(e.x-t.x)+(a.y-t.y)*(e.y-t.y))/o;return a.distSqr(0>r?t:1<r?e:e.sub(t)._mult(r)._add(t))}function Ga(l,t){for(var e=!1,d=0,c,p,g;d<l.length;d++)for(var m=0,h=(c=l[d]).length-1;m<c.length;h=m++)(p=c[m]).y>t.y!=(g=c[h]).y>t.y&&t.x<(g.x-p.x)*(t.y-p.y)/(g.y-p.y)+p.x&&(e=!e);return e}function Za(l,t){for(var e=!1,s=0,d=l.length-1;s<l.length;d=s++){var c=l[s],a=l[d];c.y>t.y!=a.y>t.y&&t.x<(a.x-c.x)*(t.y-c.y)/(a.y-c.y)+c.x&&(e=!e)}return e}function Xa(o,t,e){var r=e[0],n=e[2];if(o.x<r.x&&t.x<r.x||o.x>n.x&&t.x>n.x||o.y<r.y&&t.y<r.y||o.y>n.y&&t.y>n.y)return!1;var i=x(o,t,e[0]);return i!==x(o,t,e[1])||i!==x(o,t,e[2])||i!==x(o,t,e[3])}function Ja(a,t,e){var o=t.paint.get(a).value;return"constant"===o.kind?o.value:e.programConfigurations.get(t.id).getMaxValue(a)}function Ha(e){return We(e[0]*e[0]+e[1]*e[1])}function Ya(i,t,e,r,n){if(!t[0]&&!t[1])return i;var a=Qd.convert(t)._mult(n);"viewport"===e&&a._rotate(-r);for(var o=[],l=0;l<i.length;l++)o.push(i[l].sub(a));return o}function $a(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function eo(k,t,e){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],p=t[8],c=t[9],h=t[10],f=t[11],y=t[12],d=t[13],m=t[14],v=t[15],g=e[0],T=e[1],A=e[2],S=e[3];return k[0]=g*r+T*o+A*p+S*y,k[1]=g*n+T*s+A*c+S*d,k[2]=g*i+T*u+A*h+S*m,k[3]=g*a+T*l+A*f+S*v,k[4]=(g=e[4])*r+(T=e[5])*o+(A=e[6])*p+(S=e[7])*y,k[5]=g*n+T*s+A*c+S*d,k[6]=g*i+T*u+A*h+S*m,k[7]=g*a+T*l+A*f+S*v,k[8]=(g=e[8])*r+(T=e[9])*o+(A=e[10])*p+(S=e[11])*y,k[9]=g*n+T*s+A*c+S*d,k[10]=g*i+T*u+A*h+S*m,k[11]=g*a+T*l+A*f+S*v,k[12]=(g=e[12])*r+(T=e[13])*o+(A=e[14])*p+(S=e[15])*y,k[13]=g*n+T*s+A*c+S*d,k[14]=g*i+T*u+A*h+S*m,k[15]=g*a+T*l+A*f+S*v,k}function ro(l,t,e){var r=t[0],n=t[1],i=t[2],a=t[3];return l[0]=e[0]*r+e[4]*n+e[8]*i+e[12]*a,l[1]=e[1]*r+e[5]*n+e[9]*i+e[13]*a,l[2]=e[2]*r+e[6]*n+e[10]*i+e[14]*a,l[3]=e[3]*r+e[7]*n+e[11]*i+e[15]*a,l}function ao(a,t){var e=ro([],[a.x,a.y,0,1],t);return new Qd(e[0]/e[3],e[1]/e[3])}function so(o,t,e,r){var l=t.width,i=t.height;if(!r)r=new Uint8Array(l*i*e);else if(r instanceof Uint8ClampedArray)r=new Uint8Array(r.buffer);else if(r.length!==l*i*e)throw new RangeError("mismatched image size");return o.width=l,o.height=i,o.data=r,o}function lo(o,t,e){var r=t.width,n=t.height;if(r!==o.width||n!==o.height){var i=so({},{width:r,height:n},e);po(o,i,{x:0,y:0},{x:0,y:0},{width:Rt(o.width,r),height:Rt(o.height,n)},e),o.width=r,o.height=n,o.data=i.data}}function po(d,t,e,r,n,i){if(0===n.width||0===n.height)return t;if(n.width>d.width||n.height>d.height||e.x>d.width-n.width||e.y>d.height-n.height)throw new RangeError("out of range source coordinates for image copy");if(n.width>t.width||n.height>t.height||r.x>t.width-n.width||r.y>t.height-n.height)throw new RangeError("out of range destination coordinates for image copy");for(var a=d.data,o=t.data,s=0;s<n.height;s++)for(var g=((e.y+s)*d.width+e.x)*i,l=((r.y+s)*t.width+r.x)*i,p=0;p<n.width*i;p++)o[l+p]=a[g+p];return t}function co(l,t){for(var e=new Uint8Array(1024),r={},n=0,s=0;256>n;n++,s+=4){r[t]=n/255;var d=l.evaluate(r);e[s+0]=ya(255*d.r/d.a),e[s+1]=ya(255*d.g/d.a),e[s+2]=ya(255*d.b/d.a),e[s+3]=ya(255*d.a)}return new ho({width:256,height:1},e)}function mo(d,t,e){e=e||2;var g=t&&t.length,p=g?t[0]*e:d.length,c=Ao(d,0,p,e,!0),m=[],f,x,_,b,v,w,k;if(!c||c.next===c.prev)return m;if(g&&(c=function(l,t,e,d){var n=[],s,c,p;for(s=0,c=t.length;s<c;s++)(p=Ao(l,t[s]*d,s<c-1?t[s+1]*d:l.length,d,!1))===p.next&&(p.steiner=!0),n.push(Vo(p));for(n.sort(Eo),s=0;s<n.length;s++)To(n[s],e),e=So(e,e.next);return e}(d,t,c,e)),d.length>80*e){f=_=d[0],x=b=d[1];for(var T=e;T<p;T+=e)(v=d[T])<f&&(f=v),(w=d[T+1])<x&&(x=w),v>_&&(_=v),w>b&&(b=w);k=0===(k=ha(_-f,b-x))?0:1/k}return ko(c,m,e,f,x,k),m}function Ao(l,t,e,r,n){var i,s;if(n===0<Xo(l,t,e,r))for(i=t;i<e;i+=r)s=Ko(i,l[i],l[i+1],s);else for(i=e-r;i>=t;i-=r)s=Ko(i,l[i],l[i+1],s);return s&&Ro(s,s.next)&&(Go(s),s=s.next),s}function So(a,t){if(!a)return a;t||(t=a);var o=a,i;do if(i=!1,o.steiner||!Ro(o,o.next)&&0!==Lo(o.prev,o,o.next))o=o.next;else{if(Go(o),(o=t=o.prev)===o.next)break;i=!0}while(i||o!==t);return t}function ko(d,c,e,r,n,i,a){if(d){!a&&i&&function(a,t,e,o){var r=a;do null===r.z&&(r.z=Bo(r.x,r.y,t,e,o)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==a);r.prevZ.nextZ=null,r.prevZ=null,function(d){var c=1,p,g,m,h,y,f,x,_;do{for(g=d,d=null,y=null,f=0;g;){for(f++,m=g,x=0,p=0;p<c&&(x++,m=m.nextZ);p++);for(_=c;0<x||0<_&&m;)0!==x&&(0===_||!m||g.z<=m.z)?(h=g,g=g.nextZ,x--):(h=m,m=m.nextZ,_--),y?y.nextZ=h:d=h,h.prevZ=y,y=h;g=m}y.nextZ=null,c*=2}while(1<f)}(r)}(d,r,n,i);for(var o=d,p,g;d.prev!==d.next;)if(p=d.prev,g=d.next,i?zo(d,r,n,i):Io(d))c.push(p.i/e),c.push(d.i/e),c.push(g.i/e),Go(d),d=g.next,o=g.next;else if((d=g)===o){a?1===a?ko(d=Co(So(d),c,e),c,e,r,n,i,2):2==a&&Mo(d,c,e,r,n,i):ko(So(d),c,e,r,n,i,1);break}}}function Io(a){var t=a.prev,e=a,o=a.next;if(0<=Lo(t,e,o))return!1;for(var r=a.next.next;r!==a.prev;){if(Fo(t.x,t.y,e.x,e.y,o.x,o.y,r.x,r.y)&&0<=Lo(r.prev,r,r.next))return!1;r=r.next}return!0}function zo(d,t,e,r){var n=d.prev,i=d,a=d.next;if(0<=Lo(n,i,a))return!1;for(var o=n.x>i.x?n.x>a.x?n.x:a.x:i.x>a.x?i.x:a.x,s=n.y>i.y?n.y>a.y?n.y:a.y:i.y>a.y?i.y:a.y,u=Bo(n.x<i.x?n.x<a.x?n.x:a.x:i.x<a.x?i.x:a.x,n.y<i.y?n.y<a.y?n.y:a.y:i.y<a.y?i.y:a.y,t,e,r),l=Bo(o,s,t,e,r),p=d.prevZ,g=d.nextZ;p&&p.z>=u&&g&&g.z<=l;){if(p!==d.prev&&p!==d.next&&Fo(n.x,n.y,i.x,i.y,a.x,a.y,p.x,p.y)&&0<=Lo(p.prev,p,p.next))return!1;if(p=p.prevZ,g!==d.prev&&g!==d.next&&Fo(n.x,n.y,i.x,i.y,a.x,a.y,g.x,g.y)&&0<=Lo(g.prev,g,g.next))return!1;g=g.nextZ}for(;p&&p.z>=u;){if(p!==d.prev&&p!==d.next&&Fo(n.x,n.y,i.x,i.y,a.x,a.y,p.x,p.y)&&0<=Lo(p.prev,p,p.next))return!1;p=p.prevZ}for(;g&&g.z<=l;){if(g!==d.prev&&g!==d.next&&Fo(n.x,n.y,i.x,i.y,a.x,a.y,g.x,g.y)&&0<=Lo(g.prev,g,g.next))return!1;g=g.nextZ}return!0}function Co(o,l,e){var r=o;do{var s=r.prev,i=r.next.next;!Ro(s,i)&&Oo(s,r,r.next,i)&&qo(s,i)&&qo(i,s)&&(l.push(s.i/e),l.push(r.i/e),l.push(i.i/e),Go(r),Go(r.next),r=o=i),r=r.next}while(r!==o);return So(r)}function Mo(l,t,e,r,n,i){var a=l;do{for(var d=a.next.next;d!==a.prev;){if(a.i!==d.i&&Do(a,d)){var c=No(a,d);return a=So(a,a.next),c=So(c,c.next),ko(a,t,e,r,n,i),void ko(c,t,e,r,n,i)}d=d.next}a=a.next}while(a!==l)}function Eo(a,t){return a.x-t.x}function To(a,t){if(t=function(d,t){var e=t,g=d.x,i=d.y,a=-1/0,m;do{if(i<=e.y&&i>=e.next.y&&e.next.y!==e.y){var y=e.x+(i-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(y<=g&&y>a){if(a=y,y===g){if(i===e.y)return e;if(i===e.next.y)return e.next}m=e.x<e.next.x?e:e.next}}e=e.next}while(e!==t);if(!m)return null;if(g===a)return m;var s=m,l=m.x,p=m.y,c=1/0,f;e=m;do g>=e.x&&e.x>=l&&g!==e.x&&Fo(i<p?g:a,i,l,p,i<p?a:g,i,e.x,e.y)&&(f=ma(i-e.y)/(g-e.x),qo(e,d)&&(f<c||f===c&&(e.x>m.x||e.x===m.x&&Po(m,e)))&&(m=e,c=f)),e=e.next;while(e!==s);return m}(a,t)){var o=No(t,a);So(t,t.next),So(o,o.next)}}function Po(a,t){return 0>Lo(a.prev,a,t.prev)&&0>Lo(t.next,a,a.next)}function Bo(a,o,l,r,n){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=32767*(a-l)*n)|a<<8))|a<<4))|a<<2))|a<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=32767*(o-r)*n)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function Vo(a){var t=a,o=a;do(t.x<o.x||t.x===o.x&&t.y<o.y)&&(o=t),t=t.next;while(t!==a);return o}function Fo(l,t,e,r,n,i,a,o){return 0<=(n-a)*(t-o)-(l-a)*(i-o)&&0<=(l-a)*(r-o)-(e-a)*(t-o)&&0<=(e-a)*(i-o)-(n-a)*(r-o)}function Do(a,t){return a.next.i!==t.i&&a.prev.i!==t.i&&!function(a,t){var e=a;do{if(e.i!==a.i&&e.next.i!==a.i&&e.i!==t.i&&e.next.i!==t.i&&Oo(e,e.next,a,t))return!0;e=e.next}while(e!==a);return!1}(a,t)&&(qo(a,t)&&qo(t,a)&&function(o,t){var e=o,l=!1,s=(o.x+t.x)/2,i=(o.y+t.y)/2;do e.y>i!=e.next.y>i&&e.next.y!==e.y&&s<(e.next.x-e.x)*(i-e.y)/(e.next.y-e.y)+e.x&&(l=!l),e=e.next;while(e!==o);return l}(a,t)&&(Lo(a.prev,a,t.prev)||Lo(a,t.prev,t))||Ro(a,t)&&0<Lo(a.prev,a,a.next)&&0<Lo(t.prev,t,t.next))}function Lo(a,t,e){return(t.y-a.y)*(e.x-t.x)-(t.x-a.x)*(e.y-t.y)}function Ro(a,t){return a.x===t.x&&a.y===t.y}function Oo(l,t,e,r){var n=jo(Lo(l,t,e)),i=jo(Lo(l,t,r)),a=jo(Lo(e,r,l)),o=jo(Lo(e,r,t));return n!==i&&a!==o||0===n&&Uo(l,e,t)||0===i&&Uo(l,r,t)||0===a&&Uo(e,l,r)||0===o&&Uo(e,t,r)}function Uo(a,t,e){return t.x<=ha(a.x,e.x)&&t.x>=Rt(a.x,e.x)&&t.y<=ha(a.y,e.y)&&t.y>=Rt(a.y,e.y)}function jo(e){return 0<e?1:0>e?-1:0}function qo(a,t){return 0>Lo(a.prev,a,a.next)?0<=Lo(a,t,a.next)&&0<=Lo(a,a.prev,t):0>Lo(a,t,a.prev)||0>Lo(a,a.next,t)}function No(o,t){var e=new Zo(o.i,o.x,o.y),r=new Zo(t.i,t.x,t.y),n=o.next,i=t.prev;return o.next=t,t.prev=o,e.next=n,n.prev=e,r.next=e,e.prev=r,i.next=r,r.prev=i,r}function Ko(a,t,e,o){var r=new Zo(a,t,e);return o?(r.next=o.next,r.prev=o,o.next.prev=r,o.next=r):(r.prev=r,r.next=r),r}function Go(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Zo(a,t,e){this.i=a,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Xo(l,t,e,r){for(var n=0,s=t,d=e-r;s<e;s+=r)n+=(l[d]-l[s])*(l[s+1]+l[d+1]),d=s;return n}function Jo(a,t,e,o,r){!function d(t,e,r,m,y){for(;m>r;){if(600<m-r){var a=m-r+1,o=e-r+1,s=C(a),u=.5*g(2*s/3),l=.5*We(s*u*(a-u)/a)*(0>o-a/2?-1:1);d(t,e,ha(r,ya(e-o*u/a+l)),Rt(m,ya(e+(a-o)*u/a+l)),y)}var p=t[e],c=r,x=m;for(Ho(t,r,e),0<y(t[m],p)&&Ho(t,r,m);c<x;){for(Ho(t,c,x),c++,x--;0>y(t[c],p);)c++;for(;0<y(t[x],p);)x--}0===y(t[r],p)?Ho(t,r,x):Ho(t,++x,m),x<=e&&(r=x+1),e<=x&&(m=x-1)}}(a,t,e||0,o||a.length-1,r||Yo)}function Ho(a,t,e){var o=a[t];a[t]=a[e],a[e]=o}function Yo(a,t){return a<t?-1:a>t?1:0}function $o(l,t){var e=l.length;if(1>=e)return[l];for(var r=[],a=0,d,c,p;a<e;a++)p=_(l[a]),0!==p&&(l[a].area=ma(p),void 0===c&&(c=0>p),c===0>p?(d&&r.push(d),d=[l[a]]):d.push(l[a]));if(d&&r.push(d),1<t)for(var g=0;g<r.length;g++)r[g].length<=t||(Jo(r[g],t,1,r[g].length-1,Wo),r[g]=r[g].slice(0,t));return r}function Wo(a,t){return t.area-a.area}function Qo(l,t,e){for(var r=e.patternDependencies,n=!1,d=0,c=t,o;d<c.length;d+=1){o=c[d].paint.get(l+"-pattern"),o.isConstant()||(n=!0);var p=o.constantOr(null);p&&(n=!0,r[p.to]=!0,r[p.from]=!0)}return n}function ts(d,t,e,r,n){for(var i=n.patternDependencies,a=0,g=t;a<g.length;a+=1){var s=g[a],u=s.paint.get(d+"-pattern").value;if("constant"!==u.kind){var l=u.evaluate({zoom:r-1},e,{},n.availableImages),m=u.evaluate({zoom:r},e,{},n.availableImages),y=u.evaluate({zoom:r+1},e,{},n.availableImages);m=m&&m.name?m.name:m,y=y&&y.name?y.name:y,i[l=l&&l.name?l.name:l]=!0,i[m]=!0,i[y]=!0,e.patterns[s.id]={min:l,mid:m,max:y}}}return e}function es(a,t,e,o,r){this.properties={},this.extent=e,this.type=0,this._pbf=a,this._geometry=-1,this._keys=o,this._values=r,a.readFields(us,this,t)}function us(a,t,e){1==a?t.id=e.readVarint():2==a?function(a,t){for(var e=a.readVarint()+a.pos;a.pos<e;){var o=t._keys[a.readVarint()],r=t._values[a.readVarint()];t.properties[o]=r}}(e,t):3==a?t.type=e.readVarint():4==a&&(t._geometry=e.pos)}function ls(l){for(var t=0,s=0,d=l.length,a=d-1,c,p;s<d;a=s++)t+=((p=l[a]).x-(c=l[s]).x)*(c.y+p.y);return t}function ps(a,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(hs,this,t),this.length=this._features.length}function hs(a,t,e){15===a?t.version=e.readVarint():1===a?t.name=e.readString():5===a?t.extent=e.readVarint():2===a?t._features.push(e.pos):3===a?t._keys.push(e.readString()):4==a&&t._values.push(function(a){for(var t=null,o=a.readVarint()+a.pos,r;a.pos<o;)r=a.readVarint()>>3,t=1===r?a.readString():2===r?a.readFloat():3===r?a.readDouble():4===r?a.readVarint64():5===r?a.readVarint():6===r?a.readSVarint():7===r?a.readBoolean():null;return t}(e))}function fs(a,t,e){if(3===a){var o=new ss(e,e.readVarint()+e.pos);o.length&&(t[o.name]=o)}}function ys(l,t,e,r,n,i,a,o){l.emplaceBack(t,e,2*ya(8192*r)+a,2*(8192*n),2*(8192*i),Xe(o))}function gs(a,t){return a.x===t.x&&(0>a.x||8192<a.x)||a.y===t.y&&(0>a.y||8192<a.y)}function bs(a,t){return a.x*t.x+a.y*t.y}function As(_,t){if(1===_.length){for(var e=0,k=t[e++],i;!i||k.equals(i);)if(!(i=t[e++]))return 1/0;for(;e<t.length;e++){var T=t[e],a=_[0],o=i.sub(k),s=T.sub(k),u=a.sub(k),l=bs(o,o),p=bs(o,s),c=bs(s,s),h=bs(u,o),f=bs(u,s),y=l*c-p*p,d=(c*h-p*f)/y,m=(l*f-p*h)/y,v=k.z*(1-d-m)+i.z*d+T.z*m;if(isFinite(v))return v}return 1/0}for(var g=1/0,A=0,S=t;A<S.length;A+=1)g=Rt(g,S[A].z);return g}function Ss(a,t){return 0<t?t+2*a:a}function Vs(a,o,e){return a.sections.forEach(function(a){a.text=function(a,o,e){var r=o.layout.get("text-transform").evaluate(e,{});return"uppercase"===r?a=a.toLocaleUpperCase():"lowercase"===r&&(a=a.toLocaleLowerCase()),ri.applyArabicShaping&&(a=ri.applyArabicShaping(a)),a}(a.text,o,e)}),a}function Us(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}function Gs(e){return e.type===Us.Bytes?e.readVarint()+e.pos:e.pos+1}function Xs(a,t,e){return e?4294967296*t+(a>>>0):4294967296*(t>>>0)+(a>>>0)}function Js(a,t,e){var o=16383>=t?1:2097151>=t?2:268435455>=t?3:ya(C(t)/(7*T));e.realloc(o);for(var r=e.pos-1;r>=a;r--)e.buf[r+o]=e.buf[r]}function Hs(a,t){for(var e=0;e<a.length;e++)t.writeVarint(a[e])}function Ys(a,t){for(var e=0;e<a.length;e++)t.writeSVarint(a[e])}function $s(a,t){for(var e=0;e<a.length;e++)t.writeFloat(a[e])}function Ws(a,t){for(var e=0;e<a.length;e++)t.writeDouble(a[e])}function Qs(a,t){for(var e=0;e<a.length;e++)t.writeBoolean(a[e])}function cd(a,t){for(var e=0;e<a.length;e++)t.writeFixed32(a[e])}function pd(a,t){for(var e=0;e<a.length;e++)t.writeSFixed32(a[e])}function ud(a,t){for(var e=0;e<a.length;e++)t.writeFixed64(a[e])}function gd(a,t){for(var e=0;e<a.length;e++)t.writeSFixed64(a[e])}function md(a,t){return(a[t]|a[t+1]<<8|a[t+2]<<16)+16777216*a[t+3]}function hd(a,t,e){a[e]=t,a[e+1]=t>>>8,a[e+2]=t>>>16,a[e+3]=t>>>24}function yd(a,t){return(a[t]|a[t+1]<<8|a[t+2]<<16)+(a[t+3]<<24)}function fd(a,t,e){1===a&&e.readMessage(xd,t)}function xd(l,t,e){if(3===l){var r=e.readMessage(_d,{}),n=r.width,i=r.height,a=r.left,o=r.top,s=r.advance;t.push({id:r.id,bitmap:new uo({width:n+6,height:i+6},r.bitmap),metrics:{width:n,height:i,left:a,top:o,advance:s}})}}function _d(a,t,e){1===a?t.id=e.readVarint():2===a?t.bitmap=e.readBytes():3===a?t.width=e.readVarint():4===a?t.height=e.readVarint():5===a?t.left=e.readSVarint():6===a?t.top=e.readSVarint():7==a&&(t.advance=e.readVarint())}function bd(d){for(var t=0,g=0,m=0,x=d,i;m<x.length;m+=1)i=x[m],t+=i.w*i.h,g=ha(g,i.w);d.sort(function(a,t){return t.h-a.h});for(var _=[{x:0,y:0,w:ha(Ye(We(t/.95)),g),h:1/0}],o=0,b=0,v=0,w=d;v<w.length;v+=1)for(var p=w[v],c=_.length-1,k;0<=c;c--)if(k=_[c],!(p.w>k.w||p.h>k.h)){if(p.x=k.x,p.y=k.y,b=ha(b,p.y+p.h),o=ha(o,p.x+p.w),p.w===k.w&&p.h===k.h){var T=_.pop();c<_.length&&(_[c]=T)}else p.h===k.h?(k.x+=p.w,k.w-=p.w):p.w===k.w?(k.y+=p.h,k.h-=p.h):(_.push({x:k.x+p.w,y:k.y,w:k.w-p.w,h:p.h}),k.y+=p.h,k.h-=p.h);break}return{w:o,h:b,fill:t/(o*b)||0}}function vd(T,t,e,r,n,i,a,o,s,u,l,p,c,h,f,y){var d=Cc.fromFeature(T,n),v;p===Ac.vertical&&d.verticalizePunctuation();var L=ri.processBidirectionalText,g=ri.processStyledBidirectionalText;if(L&&1===d.sections.length){v=[];for(var x=0,P=L(d.toString(),Sd(d,u,i,t,r,h,f));x<P.length;x+=1){var w=P[x],_=new Cc;_.text=w,_.sections=d.sections;for(var A=0;A<w.length;A++)_.sectionIndex.push(0);v.push(_)}}else if(g){v=[];for(var D=0,O=g(d.text,d.sectionIndex,Sd(d,u,i,t,r,h,f));D<O.length;D+=1){var I=O[D],z=new Cc;z.text=I[0],z.sectionIndex=I[1],z.sections=d.sections,v.push(z)}}else v=function(l,t){for(var e=[],r=l.text,n=0,d=0,c=t,o;d<c.length;d+=1)o=c[d],e.push(l.substring(n,o)),n=o;return n<r.length&&e.push(l.substring(n,r.length)),e}(d,Sd(d,u,i,t,r,h,f));var C=[],R={positionedLines:C,text:d.toString(),top:l[1],bottom:l[1],left:l[0],right:l[0],writingMode:p,iconsInText:!1,verticalizable:!1};return function(H,t,e,r,n,i,a,o,s,u,l,p){for(var c=0,Y=-17,W=0,$=0,Q="right"===o?1:"left"===o?0:.5,m=0,ee=0,te=n,x;ee<te.length;ee+=1){x=te[ee],x.trim();var ae=x.getMaxScale(),w=24*(ae-1),_={positionedGlyphs:[],lineOffset:0};H.positionedLines[m]=_;var A=_.positionedGlyphs,S=0;if(x.length()){for(var oe=0;oe<x.length();oe++){var re=x.getSection(oe),z=x.getSectionIndex(oe),C=x.getCharCode(oe),M=0,ie=null,ne=null,le=null,se=24,de=!(s===Ac.horizontal||!l&&!Nn(C)||l&&(Lc[C]||(J=C,jn.Arabic(J)||jn["Arabic Supplement"](J)||jn["Arabic Extended-A"](J)||jn["Arabic Presentation Forms-A"](J)||jn["Arabic Presentation Forms-B"](J))));if(re.imageName){var F=r[re.imageName];if(!F)continue;le=re.imageName,H.iconsInText=H.iconsInText||!0,ne=F.paddedRect;var D=F.displaySize;re.scale=24*re.scale/p,M=w+(24-D[1]*re.scale),se=(ie={width:D[0],height:D[1],left:1,top:-3,advance:de?D[1]:D[0]}).advance;var L=de?D[0]*re.scale-24*ae:D[1]*re.scale-24*ae;0<L&&L>S&&(S=L)}else{var R=e[re.fontStack],O=R&&R[C];if(O&&O.rect)ne=O.rect,ie=O.metrics;else{var U=t[re.fontStack],j=U&&U[C];if(!j)continue;ie=j.metrics}M=24*(ae-re.scale)}de?(H.verticalizable=!0,A.push({glyph:C,imageName:le,x:c,y:Y+M,vertical:de,scale:re.scale,fontStack:re.fontStack,sectionIndex:z,metrics:ie,rect:ne}),c+=se*re.scale+u):(A.push({glyph:C,imageName:le,x:c,y:Y+M,vertical:de,scale:re.scale,fontStack:re.fontStack,sectionIndex:z,metrics:ie,rect:ne}),c+=ie.advance*re.scale+u)}0!==A.length&&(W=ha(c-u,W),Ld(A,0,A.length-1,Q,S)),c=0;var q=i*ae+S;_.lineOffset=ha(S,w),Y+=q,$=ha(q,$),++m}else Y+=i,++m}var N=Y- -17,G=Cd(a),Z=G.horizontalAlign,X=G.verticalAlign,J;(function(p,t,e,r,n,i,a,o,s){var u=i===a?(-r*s+.5)*a:-o*r- -17;for(var l=0,g=p;l<g.length;l+=1)for(var m=0,h=g[l].positionedGlyphs,y;m<h.length;m+=1)y=h[m],y.x+=(t-e)*n,y.y+=u})(H.positionedLines,Q,Z,X,W,$,i,N,n.length),H.top+=-X*N,H.bottom=H.top+N,H.left+=-Z*W,H.right=H.left+W}(R,t,e,r,v,a,o,s,p,u,c,y),!function(a){for(var t=0,o=a;t<o.length;t+=1)if(0!==o[t].positionedGlyphs.length)return!1;return!0}(C)&&R}function wd(l,t,e,r,n,i){if(t.imageName){var a=r[t.imageName];return a?24*(a.displaySize[0]*t.scale)/i+n:0}var o=e[t.fontStack],s=o&&o[l];return s?s.metrics.advance*t.scale+n:0}function kd(a,t,e,o){var r=pa(a-t,2);return o?a<t?r/2:2*r:r+ma(e)*e}function Td(a,t,e){var o=0;return 10===a&&(o-=1e4),e&&(o+=150),40!==a&&65288!==a||(o+=50),41!==t&&65289!==t||(o+=50),o}function Ad(d,t,e,r,n,i){for(var a=null,g=kd(t,e,n,i),m=0,h=r;m<h.length;m+=1){var l=h[m],p=kd(t-l.x,e,n,i)+l.badness;p<=g&&(a=l,g=p)}return{index:d,x:t,priorBreak:a,badness:g}}function Sd(g,t,e,r,n,i,a){if("point"!==i)return[];if(!g)return[];for(var o=[],u=function(l,t,e,r,n,i){for(var a=0,d=0,c;d<l.length();d++)c=l.getSection(d),a+=wd(l.getCharCode(d),c,r,n,t,i);return a/ha(1,Ye(a/e))}(g,t,e,r,n,a),l=0<=g.text.indexOf("\u200B"),p=0,m=0,x;m<g.length();m++){var _=g.getSection(m),f=g.getCharCode(m);if(Lc[f]||(p+=wd(f,_,r,n,t,a)),m<g.length()-1){var y=!(11904>(x=f))&&(jn["Bopomofo Extended"](x)||jn.Bopomofo(x)||jn["CJK Compatibility Forms"](x)||jn["CJK Compatibility Ideographs"](x)||jn["CJK Compatibility"](x)||jn["CJK Radicals Supplement"](x)||jn["CJK Strokes"](x)||jn["CJK Symbols and Punctuation"](x)||jn["CJK Unified Ideographs Extension A"](x)||jn["CJK Unified Ideographs"](x)||jn["Enclosed CJK Letters and Months"](x)||jn["Halfwidth and Fullwidth Forms"](x)||jn.Hiragana(x)||jn["Ideographic Description Characters"](x)||jn["Kangxi Radicals"](x)||jn["Katakana Phonetic Extensions"](x)||jn.Katakana(x)||jn["Vertical Forms"](x)||jn["Yi Radicals"](x)||jn["Yi Syllables"](x));(Ec[f]||y||_.imageName)&&o.push(Ad(m+1,p,u,o,Td(f,g.getCharCode(m+1),y&&l),!1))}}return function a(t){return t?a(t.priorBreak).concat(t.index):[]}(Ad(g.length(),p,u,o,0,!0))}function Cd(a){var t=.5,o=.5;return"right"===a||"top-right"===a||"bottom-right"===a?t=1:"left"===a||"top-left"===a||"bottom-left"===a?t=0:void 0,"bottom"===a||"bottom-right"===a||"bottom-left"===a?o=1:"top"===a||"top-right"===a||"top-left"===a?o=0:void 0,{horizontalAlign:t,verticalAlign:o}}function Ld(l,t,e,r,n){if(r||n)for(var i=l[e],a=(l[e].x+i.metrics.advance*i.scale)*r,o=t;o<=e;o++)l[o].x-=a,l[o].y+=n}function Ed(g,t,e,r,n,i){var a=g.image,s;if(a.content){var x=a.content,u=a.pixelRatio||1;s=[x[0]/u,x[1]/u,a.displaySize[0]-x[2]/u,a.displaySize[1]-x[3]/u]}var l=t.left*i,y=t.right*i,d,_,b,w;"width"===e||"both"===e?(w=n[0]+l-r[3],_=n[0]+y+r[1]):_=(w=n[0]+(l+y-a.displaySize[0])/2)+a.displaySize[0];var k=t.top*i,m=t.bottom*i;return"height"===e||"both"===e?(d=n[1]+k-r[0],b=n[1]+m+r[2]):b=(d=n[1]+(k+m-a.displaySize[1])/2)+a.displaySize[1],{image:a,top:d,right:_,bottom:b,left:w,collisionPadding:s}}function Id(l,t){var e=t.expression;if("constant"===e.kind)return{kind:"constant",layoutSize:e.evaluate(new ni(l+1))};if("source"===e.kind)return{kind:"source"};for(var r=e.zoomStops,n=e.interpolationType,i=0;i<r.length&&r[i]<=l;)i++;for(var d=i=ha(0,i-1);d<r.length&&r[d]<l+1;)d++;d=Rt(r.length-1,d);var c=r[i],s=r[d];return"composite"===e.kind?{kind:"composite",minZoom:c,maxZoom:s,interpolationType:n}:{kind:"camera",minZoom:c,maxZoom:s,minSize:e.evaluate(new ni(c)),maxSize:e.evaluate(new ni(s)),interpolationType:n}}function Pd(a,t,e){var o=t.uSize,r=e.lowerSize;return"source"===a.kind?r/128:"composite"===a.kind?Oe(r/128,e.upperSize/128,t.uSizeT):o}function zd(o,t){var e=0,l=0;if("constant"===o.kind)l=o.layoutSize;else if("source"!==o.kind){var s=o.interpolationType,i=s?io(er.interpolationFactor(s,t,o.minZoom,o.maxZoom),0,1):0;"camera"===o.kind?l=Oe(o.minSize,o.maxSize,i):e=i}return{uSizeT:e,uSize:l}}function Dd(d,t,e,r,n){if(void 0===t.segment)return!0;for(var i=t,g=t.segment+1,m=0;m>-e/2;){if(0>--g)return!1;m-=d[g].dist(i),i=d[g]}m+=d[g].dist(d[g+1]),g++;for(var y=[],u=0;m<e/2;){var f=d[g],p=d[g+1];if(!p)return!1;var c=d[g-1].angleTo(f)-f.angleTo(p);for(c=ma((c+3*Ke)%(2*Ke)-Ke),y.push({distance:m,angleDelta:c}),u+=c;m-y[0].distance>r;)u-=y.shift().angleDelta;if(u>n)return!1;g++,m+=f.dist(p)}return!0}function Od(a){for(var t=0,o=0;o<a.length-1;o++)t+=a[o].dist(a[o+1]);return t}function Rd(a,t,e){return a?.6*t*e:0}function Md(a,t){return ha(a?a.right-a.left:0,t?t.right-t.left:0)}function jd(g,t,e,r,n,i){for(var a=Rd(e,n,i),o=Md(e,r)*i,s=0,x=Od(g)/2,l=0;l<g.length-1;l++){var _=g[l],c=g[l+1],h=_.dist(c);if(s+h>x){var f=(x-s)/h,y=Oe(_.x,c.x,f),d=Oe(_.y,c.y,f),m=new Ic(y,d,c.angleTo(_),l);return m._round(),!a||Dd(g,m,o,a,t)?m:void 0}s+=h}}function Bd(d,t,g,r,n,i,a,o,s){var u=Rd(r,i,a),l=Md(r,n),p=l*a,c=0===d[0].x||d[0].x===s||0===d[0].y||d[0].y===s;return t-p<t/4&&(t=p+t/4),function k(t,e,r,n,i,a,o,s,u){for(var l=a/2,p=Od(t),c=0,T=e-r,S=[],C=0;C<t.length-1;C++){for(var L=t[C],m=t[C+1],v=L.dist(m),g=m.angleTo(L);T+r<c+v;){var x=((T+=r)-c)/v,b=Oe(L.x,m.x,x),w=Oe(L.y,m.y,x);if(0<=b&&b<u&&0<=w&&w<u&&0<=T-l&&T+l<=p){var _=new Ic(b,w,g,C);_._round(),n&&!Dd(t,_,a,n,i)||S.push(_)}}c+=v}return s||S.length||o||(S=k(t,c/2,r,n,i,a,o,!0,u)),S}(d,c?t/2*o%t:(l/2+2*i)*a*o%t,t,u,g,p,c,!1,s)}function Fd(i,t,e,r,n){for(var a=[],o=0;o<i.length;o++)for(var d=i[o],u=void 0,g=0;g<d.length-1;g++){var m=d[g],y=d[g+1];m.x<t&&y.x<t||(m.x<t?m=new Qd(t,m.y+(t-m.x)/(y.x-m.x)*(y.y-m.y))._round():y.x<t&&(y=new Qd(t,m.y+(t-m.x)/(y.x-m.x)*(y.y-m.y))._round()),m.y<e&&y.y<e||(m.y<e?m=new Qd(m.x+(e-m.y)/(y.y-m.y)*(y.x-m.x),e)._round():y.y<e&&(y=new Qd(m.x+(e-m.y)/(y.y-m.y)*(y.x-m.x),e)._round()),m.x>=r&&y.x>=r||(m.x>=r?m=new Qd(r,m.y+(r-m.x)/(y.x-m.x)*(y.y-m.y))._round():y.x>=r&&(y=new Qd(r,m.y+(r-m.x)/(y.x-m.x)*(y.y-m.y))._round()),m.y>=n&&y.y>=n||(m.y>=n?m=new Qd(m.x+(n-m.y)/(y.y-m.y)*(y.x-m.x),n)._round():y.y>=n&&(y=new Qd(m.x+(n-m.y)/(y.y-m.y)*(y.x-m.x),n)._round()),u&&m.equals(u[u.length-1])||a.push(u=[m]),u.push(y)))))}return a}function Nd(i,t,e,r){var n=[],N=i.image,o=N.pixelRatio,a=N.paddedRect.w-2,s=N.paddedRect.h-2,H=i.right-i.left,p=i.bottom-i.top,l=N.stretchX||[[0,a]],c=N.stretchY||[[0,s]],u=function(a,t){return a+t[1]-t[0]},q=l.reduce(u,0),d=c.reduce(u,0),m=a-q,h=s-d,G=0,Y=q,W=0,X=d,Z=0,K=m,$=0,J=h;if(N.content&&r){var g=N.content;G=Vd(l,0,g[0]),W=Vd(c,0,g[1]),Y=Vd(l,g[0],g[2]),X=Vd(c,g[1],g[3]),Z=g[0]-G,$=g[1]-W,K=g[2]-g[0]-Y,J=g[3]-g[1]-X}var y=function(r,n,a,s){var l=Hd(r.stretch-G,Y,H,i.left),c=qd(r.fixed-Z,K,r.stretch,q),u=Hd(n.stretch-W,X,p,i.top),m=qd(n.fixed-$,J,n.stretch,d),h=Hd(a.stretch-G,Y,H,i.left),g=qd(a.fixed-Z,K,a.stretch,q),y=Hd(s.stretch-W,X,p,i.top),f=qd(s.fixed-$,J,s.stretch,d),x=new Qd(l,u),_=new Qd(h,u),b=new Qd(h,y),v=new Qd(l,y),w=new Qd(c/o,m/o),k=new Qd(g/o,f/o),T=t*Ke/180;if(T){var A=Je(T),S=Ge(T),C=[S,-A,A,S];x._matMult(C),_._matMult(C),v._matMult(C),b._matMult(C)}var L=r.stretch+r.fixed,E=n.stretch+n.fixed;return{tl:x,tr:_,bl:v,br:b,tex:{x:N.paddedRect.x+1+L,y:N.paddedRect.y+1+E,w:a.stretch+a.fixed-L,h:s.stretch+s.fixed-E},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:w,pixelOffsetBR:k,minFontScaleX:K/o/H,minFontScaleY:J/o/p,isSDF:e}};if(r&&(N.stretchX||N.stretchY))for(var f=Ud(l,m,q),v=Ud(c,h,d),C=0;C<f.length-1;C++)for(var L=f[C],E=f[C+1],P=0;P<v.length-1;P++)n.push(y(L,v[P],E,v[P+1]));else n.push(y({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:a+1},{fixed:0,stretch:s+1}));return n}function Vd(l,t,e){for(var r=0,s=0,d=l,a;s<d.length;s+=1)a=d[s],r+=ha(t,Rt(e,a[1]))-ha(t,Rt(e,a[0]));return r}function Ud(d,t,e){for(var r=[{fixed:-1,stretch:0}],n=0,c=d;n<c.length;n+=1){var a=c[n],o=a[0],s=a[1],p=r[r.length-1];r.push({fixed:o-p.stretch,stretch:p.stretch}),r.push({fixed:o-p.stretch,stretch:p.stretch+(s-o)})}return r.push({fixed:t+1,stretch:e}),r}function Hd(a,t,e,o){return a/t*e+o}function qd(a,t,e,o){return a-t*e/o}function Gd(a,t){return a<t?-1:a>t?1:0}function Yd(i,t,x){void 0===t&&(t=1),void 0===x&&(x=!1);for(var _=1/0,b=1/0,w=-1/0,k=-1/0,T=i[0],u=0,A;u<T.length;u++)A=T[u],(!u||A.x<_)&&(_=A.x),(!u||A.y<b)&&(b=A.y),(!u||A.x>w)&&(w=A.x),(!u||A.y>k)&&(k=A.y);var S=Rt(w-_,k-b),c=S/2,C=new Dc([],Wd);if(0===S)return new Qd(_,b);for(var f=_;f<w;f+=S)for(var L=b;L<k;L+=S)C.push(new Xd(f+c,L+c,c,i));for(var E=function(d){for(var t=0,c=0,g=0,m=d[0],i=0,h=m.length,o=h-1;i<h;o=i++){var y=m[i],u=m[o],l=y.x*u.y-u.x*y.y;c+=(y.x+u.x)*l,g+=(y.y+u.y)*l,t+=3*l}return new Xd(c/t,g/t,0,d)}(i),I=C.length,P;C.length;)P=C.pop(),(P.d>E.d||!E.d)&&(E=P,x&&console.log("found best %d after %d probes",Xe(1e4*P.d)/1e4,I)),P.max-E.d<=t||(C.push(new Xd(P.p.x-(c=P.h/2),P.p.y-c,c,i)),C.push(new Xd(P.p.x+c,P.p.y-c,c,i)),C.push(new Xd(P.p.x-c,P.p.y+c,c,i)),C.push(new Xd(P.p.x+c,P.p.y+c,c,i)),I+=4);return x&&(console.log("num probes: "+I),console.log("best distance: "+E.d)),E.p}function Wd(a,t){return t.max-a.max}function Xd(a,t,e,o){this.p=new Qd(a,t),this.h=e,this.d=function(d,t){for(var e=!1,c=1/0,g=0;g<t.length;g++)for(var m=t[g],a=0,h=m.length,s=h-1;a<h;s=a++){var y=m[a],l=m[s];y.y>d.y!=l.y>d.y&&d.x<(l.x-y.x)*(d.y-y.y)/(l.y-y.y)+y.x&&(e=!e),c=Rt(c,Ka(d,y,l))}return(e?1:-1)*We(c)}(this.p,o),this.max=this.d+this.h*u}function Zd(a,t){return t[1]===Oc?function(a,t){var o=0,l=0;0>t&&(t=0);var s=t/We(2);return"top-right"===a||"top-left"===a?l=s-7:"bottom-right"===a||"bottom-left"===a?l=7-s:"bottom"===a?l=7-t:"top"===a?l=t-7:void 0,"top-right"===a||"bottom-right"===a?o=-s:"top-left"===a||"bottom-left"===a?o=s:"left"===a?o=t:"right"===a?o=-t:void 0,[o,l]}(a,t[0]):function(a,t,o){var l=0,s=0;switch(t=ma(t),o=ma(o),a){case"top-right":case"top-left":case"top":s=o-7;break;case"bottom-right":case"bottom-left":case"bottom":s=7-o;}return"top-right"===a||"bottom-right"===a||"right"===a?l=-t:"top-left"===a||"bottom-left"===a||"left"===a?l=t:void 0,[l,s]}(a,t[0],t[1])}function Kd(e){return"right"===e||"top-right"===e||"bottom-right"===e?"right":"left"===e||"top-left"===e||"bottom-left"===e?"left":"center"}function tl(i,t,e,r,n,a,o,s,u,l,p,c,h,f,y){var d=function(i,t,e,r,n,a,o,s){for(var u=r.layout.get("text-rotate").evaluate(a,{})*Ke/180,l=[],p=0,H=t.positionedLines;p<H.length;p+=1)for(var h=H[p],f=0,Y=h.positionedGlyphs,d;f<Y.length;f+=1)if(d=Y[f],d.rect){var W=d.rect||{},v=4,X=!0,Z=1,$=0,J=(n||s)&&d.vertical,_=d.metrics.advance*d.scale/2;if(s&&t.verticalizable&&($=h.lineOffset/2-(d.imageName?-(24-d.metrics.width*d.scale)/2:24*(d.scale-1))),d.imageName){var A=o[d.imageName];X=A.sdf,v=1/(Z=A.pixelRatio)}var S=n?[d.x+_,d.y]:[0,0],k=n?[0,0]:[d.x+_+e[0],d.y+e[1]-$],Q=[0,0];J&&(Q=k,k=[0,0]);var ee=(d.metrics.left-v)*d.scale-_+k[0],C=(-d.metrics.top-v)*d.scale+k[1],M=ee+W.w*d.scale/Z,E=C+W.h*d.scale/Z,T=new Qd(ee,C),P=new Qd(M,C),B=new Qd(ee,E),V=new Qd(M,E);if(J){var F=new Qd(-_,_- -17),D=-Ke/2,L=12-_,R=new Qd(22-L,-(d.imageName?L:0)),O=new(Function.prototype.bind.apply(Qd,[null].concat(Q)));T._rotateAround(D,F)._add(R)._add(O),P._rotateAround(D,F)._add(R)._add(O),B._rotateAround(D,F)._add(R)._add(O),V._rotateAround(D,F)._add(R)._add(O)}if(u){var U=Je(u),j=Ge(u),q=[j,-U,U,j];T._matMult(q),P._matMult(q),B._matMult(q),V._matMult(q)}var N=new Qd(0,0),K=new Qd(0,0);l.push({tl:T,tr:P,bl:B,br:V,tex:W,writingMode:t.writingMode,glyphOffset:S,sectionIndex:d.sectionIndex,isSDF:X,pixelOffsetTL:N,pixelOffsetBR:K,minFontScaleX:0,minFontScaleY:0})}return l}(0,e,s,n,a,o,r,i.allowVerticalPlacement),m=i.textSizeData,_=null;"source"===m.kind?32640<(_=[128*n.layout.get("text-size").evaluate(o,{})])[0]&&ad(i.layerIds[0]+": Value for \"text-size\" is >= 255. Reduce your \"text-size\"."):"composite"===m.kind&&(32640<(_=[128*f.compositeTextSizes[0].evaluate(o,{},y),128*f.compositeTextSizes[1].evaluate(o,{},y)])[0]||32640<_[1])&&ad(i.layerIds[0]+": Value for \"text-size\" is >= 255. Reduce your \"text-size\"."),i.addSymbols(i.text,d,_,s,a,o,l,t,u.lineStartIndex,u.lineLength,h,y);for(var v=0,w=p;v<w.length;v+=1)c[w[v]]=i.text.placedSymbolArray.length-1;return 4*d.length}function el(a){for(var t in a)return a[t];return null}function rl(l,t,e,r){var n=l.compareText;if(t in n){for(var i=n[t],a=i.length-1;0<=a;a--)if(r.dist(i[a])<e)return!0;}else n[t]=[];return n[t].push(r),!1}function nl(d,t,e,r,n,i,a,o,s,u,l,p,c){var g=o?Rt(32640,Xe(o[0])):0,m=o?Rt(32640,Xe(o[1])):0;d.emplaceBack(t,e,Xe(32*r),Xe(32*n),i,a,(g<<1)+(s?1:0),m,16*u,16*l,256*p,256*c)}function ol(a,t,e){a.emplaceBack(t.x,t.y,e),a.emplaceBack(t.x,t.y,e),a.emplaceBack(t.x,t.y,e),a.emplaceBack(t.x,t.y,e)}function sl(a){for(var t=0,o=a.sections;t<o.length;t+=1)if(Xn(o[t].text))return!0;return!1}function ul(a,t,e){var o=6378137*(2*Ke)/256/pa(2,e);return[a*o-6378137*(2*Ke)/2,t*o-6378137*(2*Ke)/2]}function El(e){return Pl*Ge(e*Ke/180)}function Vl(e){return(180+e)/360}function Fl(e){return(180-180/Ke*C(ua(Ke/4+e*Ke/360)))/360}function Dl(a,t){return a/El(t)}function Ll(e){return 360/Ke*ga(g((180-360*e)*Ke/180))-90}function Rl(o,l,e,r,n){0>(o*=2)&&(o=-1*o-1);var i=1<<e;return(i*i*o+i*n+r).toString(36)+e.toString(36)+l.toString(36)}function Nl(a,l,e,r,n){return m(a,function(i,t){var a=l instanceof ci?l.get(t):null;return a&&a.evaluate?a.evaluate(e,r,n):a})}function Yl(l){for(var t=1/0,d=1/0,c=-1/0,p=-1/0,u=0,g=l,o;u<g.length;u+=1)o=g[u],t=Rt(t,o.x),d=Rt(d,o.y),c=ha(c,o.x),p=ha(p,o.y);return{minX:t,minY:d,maxX:c,maxY:p}}function $l(a,t){return t-a}var Jd=e;e.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},e.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},e.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},e.prototype.solveCurveX=function(l,t){var d,c,p,u,g;for(void 0===t&&(t=1e-6),p=l,g=0;8>g;g++){if(u=this.sampleCurveX(p)-l,ma(u)<t)return p;var m=this.sampleCurveDerivativeX(p);if(1e-6>ma(m))break;p-=u/m}if((p=l)<(d=0))return d;if(p>(c=1))return c;for(;d<c;){if(u=this.sampleCurveX(p),ma(u-l)<t)return p;l>u?d=p:c=p,p=.5*(c-d)+d}return p},e.prototype.solve=function(a,t){return this.sampleCurveY(this.solveCurveX(a,t))};var Qd=n;n.prototype={clone:function(){return new n(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(a,t){return this.clone()._rotateAround(a,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return We(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return We(this.distSqr(e))},distSqr:function(a){var t=a.x-this.x,e=a.y-this.y;return t*t+e*e},angle:function(){return k(this.y,this.x)},angleTo:function(e){return k(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(a,t){return k(this.x*t-this.y*a,this.x*a+this.y*t)},_matMult:function(a){var t=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(a){var t=Ge(a),e=Je(a),o=e*this.x+t*this.y;return this.x=t*this.x-e*this.y,this.y=o,this},_rotateAround:function(a,t){var e=Ge(a),o=Je(a),r=t.y+o*(this.x-t.x)+e*(this.y-t.y);return this.x=t.x+e*(this.x-t.x)-o*(this.y-t.y),this.y=r,this},_round:function(){return this.x=Xe(this.x),this.y=Xe(this.y),this}},n.convert=function(e){return e instanceof n?e:Array.isArray(e)?new n(e[0],e[1]):e};var r=a(.25,.1,.25,1),i=1,s={},b=null,ec=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),B=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,V=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,F={now:ec,frame:function(a){var t=B(a);return{cancel:function(){return V(t)}}},getImageData:function(a,t){void 0===t&&(t=0);var o=self.document.createElement("canvas"),r=o.getContext("2d");if(!r)throw new Error("failed to create canvas 2d context");return o.width=a.width,o.height=a.height,r.drawImage(a,0,0,a.width,a.height),r.getImageData(-t,-t,a.width+2*t,a.height+2*t)},resolveURL:function(e){return ac||(ac=self.document.createElement("a")),ac.href=e,ac.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},get prefersReducedMotion(){return!!self.matchMedia&&(null==oc&&(oc=self.matchMedia("(prefers-reduced-motion: reduce)")),oc.matches)}},D={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},L={supported:!1,testSupport:function(e){!R&&ic&&(tc?rd(e):rc=e)}},R=!1,tc=!1,ac,oc,rc,ic;self.document&&((ic=self.document.createElement("img")).onload=function(){rc&&rd(rc),rc=null,tc=!0},ic.onerror=function(){R=!0,rc=null},ic.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var nc=function(a,t){this._transformRequestFn=a,this._customAccessToken=t,this._createSkuToken()};nc.prototype._createSkuToken=function(){var e=function(){for(var a="",o=0;10>o;o++)a+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[ya(62*Math.random())];return{token:["1","01",a].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},nc.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},nc.prototype.transformRequest=function(a,t){return this._transformRequestFn&&this._transformRequestFn(a,t)||{url:a}},nc.prototype.normalizeStyleURL=function(a,t){if(!j(a))return a;var e=Z(a);return e.path="/styles/v1"+e.path,this._makeAPIURL(e,this._customAccessToken||t)},nc.prototype.normalizeGlyphsURL=function(a,t){if(!j(a))return a;var e=Z(a);return e.path="/fonts/v1"+e.path,this._makeAPIURL(e,this._customAccessToken||t)},nc.prototype.normalizeSourceURL=function(a,t){if(!j(a))return a;var e=Z(a);return e.path="/v4/"+e.authority+".json",e.params.push("secure"),this._makeAPIURL(e,this._customAccessToken||t)},nc.prototype.normalizeSpriteURL=function(a,t,e,o){var r=Z(a);return j(a)?(r.path="/styles/v1"+r.path+"/sprite"+t+e,this._makeAPIURL(r,this._customAccessToken||o)):(r.path+=""+t+e,J(r))},nc.prototype.normalizeTileURL=function(a,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),a&&!j(a))return a;var e=Z(a);e.path=e.path.replace(/(\.(png|jpg)\d*)(?=$)/,(2<=F.devicePixelRatio||512===t?"@2x":"")+(L.supported?".webp":"$1")),e.path=e.path.replace(/^.+\/v4\//,"/"),e.path="/v4"+e.path;var o=this._customAccessToken||function(a){for(var t=0,o=a,r;t<o.length;t+=1)if(r=o[t].match(/^access_token=(.*)$/),r)return r[1];return null}(e.params)||D.ACCESS_TOKEN;return D.REQUIRE_ACCESS_TOKEN&&o&&this._skuToken&&e.params.push("sku="+this._skuToken),this._makeAPIURL(e,o)},nc.prototype.canonicalizeTileURL=function(a,t){var e=Z(a);if(!e.path.match(/(^\/v4\/)/)||!e.path.match(/\.[\w]+$/))return a;var o="mapbox://tiles/";o+=e.path.replace("/v4/","");var r=e.params;return t&&(r=r.filter(function(e){return!e.match(/^access_token=/)})),r.length&&(o+="?"+r.join("&")),o},nc.prototype.canonicalizeTileset=function(l,t){for(var e=!!t&&j(t),r=[],n=0,s=l.tiles||[],a;n<s.length;n+=1)a=s[n],K(a)?r.push(this.canonicalizeTileURL(a,e)):r.push(a);return r},nc.prototype._makeAPIURL=function(a,t){var o=Z(D.API_URL);if(a.protocol=o.protocol,a.authority=o.authority,"/"!==o.path&&(a.path=""+o.path+a.path),!D.REQUIRE_ACCESS_TOKEN)return J(a);if(!(t=t||D.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes");if("s"===t[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes");return a.params=a.params.filter(function(e){return-1===e.indexOf("access_token")}),a.params.push("access_token="+t),J(a)};var N=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i,G=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/,X=function(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};X.prototype.getStorageKey=function(a){var t=H(D.ACCESS_TOKEN),o;return o=t&&t.u?self.btoa(encodeURIComponent(t.u).replace(/%([0-9A-F]{2})/g,function(a,t){return d(+("0x"+t))})):D.ACCESS_TOKEN||"",a?"mapbox.eventData."+a+":"+o:"mapbox.eventData:"+o},X.prototype.fetchEventData=function(){var a=z("localStorage"),t=this.getStorageKey(),e=this.getStorageKey("uuid");if(a)try{var o=self.localStorage.getItem(t);o&&(this.eventData=JSON.parse(o));var r=self.localStorage.getItem(e);r&&(this.anonId=r)}catch(e){ad("Unable to read from LocalStorage")}},X.prototype.saveEventData=function(){var a=z("localStorage"),t=this.getStorageKey(),e=this.getStorageKey("uuid");if(a)try{self.localStorage.setItem(e,this.anonId),1<=Object.keys(this.eventData).length&&self.localStorage.setItem(t,JSON.stringify(this.eventData))}catch(e){ad("Unable to write to LocalStorage")}},X.prototype.processRequests=function(){},X.prototype.postEvent=function(l,t,e,r){var n=this;if(D.EVENTS_URL){var i=Z(D.EVENTS_URL);i.params.push("access_token="+(r||D.ACCESS_TOKEN||""));var a={event:this.type,created:new Date(l).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.10.0",skuId:"01",userId:this.anonId},o=t?_o(a,t):a,s={url:J(i),headers:{"Content-Type":"text/plain"},body:JSON.stringify([o])};this.pendingRequest=gt(s,function(a){n.pendingRequest=null,e(a),n.saveEventData(),n.processRequests(r)})}},X.prototype.queueRequest=function(a,t){this.queue.push(a),this.processRequests(t)};var $=function(a){function t(){a.call(this,"map.load"),this.success={},this.skuToken=""}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(a,t,e,o){this.skuToken=e,(D.EVENTS_URL&&o||D.ACCESS_TOKEN&&Array.isArray(a)&&a.some(function(e){return j(e)||K(e)}))&&this.queueRequest({id:t,timestamp:Date.now()},o)},t.prototype.processRequests=function(a){var o=this;if(!this.pendingRequest&&0!==this.queue.length){var e=this.queue.shift(),r=e.id,t=e.timestamp;r&&this.success[r]||(this.anonId||this.fetchEventData(),f(this.anonId)||(this.anonId=h()),this.postEvent(t,{skuToken:this.skuToken},function(e){e||r&&(o.success[r]=!0)},a))}},t}(X),tt=new(function(a){function t(t){a.call(this,"appUserTurnstile"),this._customAccessToken=t}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(a,t){D.EVENTS_URL&&D.ACCESS_TOKEN&&Array.isArray(a)&&a.some(function(e){return j(e)||K(e)})&&this.queueRequest(Date.now(),t)},t.prototype.processRequests=function(l){var d=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var e=H(D.ACCESS_TOKEN),r=e?e.u:D.ACCESS_TOKEN,t=r!==this.eventData.tokenU;f(this.anonId)||(this.anonId=h(),t=!0);var n=this.queue.shift();if(this.eventData.lastSuccess){var a=new Date(this.eventData.lastSuccess),o=new Date(n),s=(n-this.eventData.lastSuccess)/864e5;t=t||1<=s||-1>s||a.getDate()!==o.getDate()}else t=!0;if(!t)return this.processRequests();this.postEvent(n,{"enabled.telemetry":!1},function(e){e||(d.eventData.lastSuccess=n,d.eventData.tokenU=r)},l)}},t}(X)),et=tt.postTurnstileEvent.bind(tt),rt=new $,nt=rt.postMapLoadEvent.bind(rt),it=500,lc=50,sc=1/0,dc={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"},ht,cc,pc;"function"==typeof Object.freeze&&Object.freeze(dc);var uc=function(a){function t(t,o,r){401===o&&K(r)&&(t+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),a.call(this,t),this.status=o,this.url=r,this.name=this.constructor.name,this.message=t}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),ft=w()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===self.location.protocol?self.parent:self).location.href},yt=function(a,t){if(!(/^file:/.test(e=a.url)||/^file:/.test(ft())&&!/^\w+:/.test(e))){if(self.fetch&&self.Request&&self.AbortController&&self.Request.prototype.hasOwnProperty("signal"))return function(d,c){var e=new self.AbortController,p=new self.Request(d.url,{method:d.method||"GET",body:d.body,credentials:d.credentials,headers:d.headers,referrer:ft(),signal:e.signal}),i=!1,g=!1,t=0<(n=p.url).indexOf("sku=")&&K(n),n;"json"===d.type&&p.headers.set("Accept","application/json");var s=function(e,o,r){if(!g){if(e&&"SecurityError"!==e.message&&ad(e),o&&r)return m(o);var a=Date.now();self.fetch(p).then(function(e){if(e.ok){var o=t?e.clone():null;return m(e,o,a)}return c(new uc(e.statusText,e.status,d.url))}).catch(function(e){20!==e.code&&c(new Error(e.message))})}},m=function(e,a,o){("arrayBuffer"===d.type?e.arrayBuffer():"json"===d.type?e.json():e.text()).then(function(r){g||(a&&o&&function(a,t,e){if(Y(),ht){var o={status:t.status,statusText:t.statusText,headers:new self.Headers};t.headers.forEach(function(a,t){return o.headers.set(t,a)});var r=S(t.headers.get("Cache-Control")||"");r["no-store"]||(r["max-age"]&&o.headers.set("Expires",new Date(e+1e3*r["max-age"]).toUTCString()),42e4>new Date(o.headers.get("Expires")).getTime()-e||function(a,t){if(void 0===cc)try{new Response(new ReadableStream()),cc=!0}catch(e){cc=!1}cc?t(a.body):a.blob().then(t)}(t,function(t){var i=new self.Response(t,o);Y(),ht&&ht.then(function(t){return t.put(st(a.url),i)}).catch(function(e){return ad(e.message)})}))}}(p,a,o),i=!0,c(null,r,e.headers.get("Cache-Control"),e.headers.get("Expires")))}).catch(function(e){g||c(new Error(e.message))})};return t?function(a,o){if(Y(),!ht)return o(null);var e=st(a.url);ht.then(function(a){a.match(e).then(function(t){var r=function(a){if(!a)return!1;var t=new Date(a.headers.get("Expires")||0),e=S(a.headers.get("Cache-Control")||"");return t>Date.now()&&!e["no-cache"]}(t);a.delete(e),r&&a.put(e,t.clone()),o(null,t,r)}).catch(o)}).catch(o)}(p,s):s(null,null),{cancel:function(){g=!0,i||e.abort()}}}(a,t);if(w()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,t,void 0,!0)}var e;return function(a,o){var e=new self.XMLHttpRequest;for(var t in e.open(a.method||"GET",a.url,!0),"arrayBuffer"===a.type&&(e.responseType="arraybuffer"),a.headers)e.setRequestHeader(t,a.headers[t]);return"json"===a.type&&(e.responseType="text",e.setRequestHeader("Accept","application/json")),e.withCredentials="include"===a.credentials,e.onerror=function(){o(new Error(e.statusText))},e.onload=function(){if((200<=e.status&&300>e.status||0===e.status)&&null!==e.response){var t=e.response;if("json"===a.type)try{t=JSON.parse(e.response)}catch(e){return o(e)}o(null,t,e.getResponseHeader("Cache-Control"),e.getResponseHeader("Expires"))}else o(new uc(e.statusText,e.status,a.url))},e.send(a.body),{cancel:function(){return e.abort()}}}(a,t)},vt=function(a,t){return yt(_o(a,{type:"arrayBuffer"}),t)},gt=function(a,t){return yt(_o(a,{method:"POST"}),t)},xt,gc;xt=[],gc=0;var mc=function(o,l){if(L.supported&&(o.headers||(o.headers={}),o.headers.accept="image/webp,*/*"),gc>=D.MAX_PARALLEL_IMAGE_REQUESTS){var e={requestParameters:o,callback:l,cancelled:!1,cancel:function(){this.cancelled=!0}};return xt.push(e),e}gc++;var r=!1,s=function(){if(!r)for(r=!0,gc--;xt.length&&gc<D.MAX_PARALLEL_IMAGE_REQUESTS;){var e=xt.shift();e.cancelled||(e.cancel=mc(e.requestParameters,e.callback).cancel)}},t=vt(o,function(e,t,o,r){s(),e?l(e):t&&(ut()?function(a,o){var e=new self.Blob([new Uint8Array(a)],{type:"image/png"});self.createImageBitmap(e).then(function(e){o(null,e)}).catch(function(e){o(new Error("Could not load image because of "+e.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(t,l):function(l,t,e,r){var n=new self.Image,i=self.URL;n.onload=function(){t(null,n),i.revokeObjectURL(n.src)},n.onerror=function(){return t(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var a=new self.Blob([new Uint8Array(l)],{type:"image/png"});n.cacheControl=e,n.expires=r,n.src=l.byteLength?i.createObjectURL(a):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}(t,l,o,r))});return{cancel:function(){t.cancel(),s()}}},bt=function(a,t){void 0===t&&(t={}),_o(this,t),this.type=a},At=function(a){function t(t,e){void 0===e&&(e={}),a.call(this,"error",_o({error:t},e))}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t}(bt),St=function(){};St.prototype.on=function(a,t){return this._listeners=this._listeners||{},ct(a,t,this._listeners),this},St.prototype.off=function(a,t){return wt(a,t,this._listeners),wt(a,t,this._oneTimeListeners),this},St.prototype.once=function(a,t){return this._oneTimeListeners=this._oneTimeListeners||{},ct(a,t,this._oneTimeListeners),this},St.prototype.fire=function(l,d){"string"==typeof l&&(l=new bt(l,d||{}));var e=l.type;if(this.listens(e)){l.target=this;for(var r=0,c=this._listeners&&this._listeners[e]?this._listeners[e].slice():[];r<c.length;r+=1)c[r].call(this,l);for(var i=0,p=this._oneTimeListeners&&this._oneTimeListeners[e]?this._oneTimeListeners[e].slice():[],o;i<p.length;i+=1)o=p[i],wt(e,o,this._oneTimeListeners),o.call(this,l);var g=this._eventedParent;g&&(_o(l,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),g.fire(l))}else l instanceof At&&console.error(l.error);return this},St.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&0<this._listeners[e].length||this._oneTimeListeners&&this._oneTimeListeners[e]&&0<this._oneTimeListeners[e].length||this._eventedParent&&this._eventedParent.listens(e)},St.prototype.setEventedParent=function(a,t){return this._eventedParent=a,this._eventedParentData=t,this};var kt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"},slice:{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},It=function(a,t,e,o){this.message=(a?a+": ":"")+e,o&&(this.identifier=o),null!=t&&t.__line__&&(this.line=t.__line__)},zt=function(a){function t(t,e){a.call(this,e),this.message=e,this.key=t}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t}(Error),Pt=function(a,t){void 0===t&&(t=[]),this.parent=a,this.bindings={};for(var o=0,l=t,n;o<l.length;o+=1)n=l[o],this.bindings[n[0]]=n[1]};Pt.prototype.concat=function(e){return new Pt(this,e)},Pt.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},Pt.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var Bt={kind:"null"},Vt={kind:"number"},Ft={kind:"string"},Dt={kind:"boolean"},Lt={kind:"color"},hc={kind:"object"},Ot={kind:"value"},Ut={kind:"collator"},jt={kind:"formatted"},qt={kind:"resolvedImage"},Nt=[Bt,Vt,Ft,Dt,Lt,jt,hc,Tt(Ot),qt],Zt=t(function(l,t){function e(e){return 0>(e=Xe(e))?0:255<e?255:e}function n(a){return e("%"===a[a.length-1]?255*(parseFloat(a)/100):parseInt(a))}function i(a){return 0>(t="%"===a[a.length-1]?parseFloat(a)/100:parseFloat(a))?0:1<t?1:t;var t}function a(a,t,e){return 0>e?e+=1:1<e&&(e-=1),1>6*e?a+6*((t-a)*e):1>2*e?t:2>3*e?a+6*((t-a)*(2/3-e)):a}var o={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};try{t.parseCSSColor=function(r){var t=r.replace(/ /g,"").toLowerCase(),s;if(t in o)return o[t].slice();if("#"===t[0])return 4===t.length?0<=(s=parseInt(t.substr(1),16))&&4095>=s?[(3840&s)>>4|(3840&s)>>8,240&s|(240&s)>>4,15&s|(15&s)<<4,1]:null:7===t.length&&0<=(s=parseInt(t.substr(1),16))&&16777215>=s?[(16711680&s)>>16,(65280&s)>>8,255&s,1]:null;var g=t.indexOf("("),u=t.indexOf(")");if(-1!==g&&u+1===t.length){var l=t.substr(0,g),p=t.substr(g+1,u-(g+1)).split(","),c=1;switch(l){case"rgba":if(4!==p.length)return null;c=i(p.pop());case"rgb":return 3===p.length?[n(p[0]),n(p[1]),n(p[2]),c]:null;case"hsla":if(4!==p.length)return null;c=i(p.pop());case"hsl":if(3!==p.length)return null;var x=(parseFloat(p[0])%360+360)%360/360,f=i(p[1]),y=i(p[2]),d=.5>=y?y*(f+1):y+f-y*f,m=2*y-d;return[e(255*a(m,d,x+1/3)),e(255*a(m,d,x)),e(255*a(m,d,x-1/3)),c];default:return null;}}return null}}catch(e){}}).parseCSSColor,Yt=function(a,t,e,o){void 0===o&&(o=1),this.r=a,this.g=t,this.b=e,this.a=o};Yt.parse=function(a){if(a){if(a instanceof Yt)return a;if("string"==typeof a){var t=Zt(a);if(t)return new Yt(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},Yt.prototype.toString=function(){var a=this.toArray(),t=a[1],e=a[2],o=a[3];return"rgba("+Xe(a[0])+","+Xe(t)+","+Xe(e)+","+o+")"},Yt.prototype.toArray=function(){var e=this.a;return 0===e?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},Yt.black=new Yt(0,0,0,1),Yt.white=new Yt(1,1,1,1),Yt.transparent=new Yt(0,0,0,0),Yt.red=new Yt(1,0,0,1);var $t=function(a,t,e){this.sensitivity=a?t?"variant":"case":t?"accent":"base",this.locale=e,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};$t.prototype.compare=function(a,t){return this.collator.compare(a,t)},$t.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Wt=function(a,t,e,o,r){this.text=a,this.image=t,this.scale=e,this.fontStack=o,this.textColor=r},Qt=function(e){this.sections=e};Qt.fromString=function(e){return new Qt([new Wt(e,null,null,null,null)])},Qt.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some(function(e){return 0!==e.text.length||e.image&&0!==e.image.name.length})},Qt.factory=function(e){return e instanceof Qt?e:Qt.fromString(e)},Qt.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map(function(e){return e.text}).join("")},Qt.prototype.serialize=function(){for(var a=["format"],t=0,o=this.sections,r;t<o.length;t+=1)if(r=o[t],r.image)a.push(["image",r.image.name]);else{a.push(r.text);var l={};r.fontStack&&(l["text-font"]=["literal",r.fontStack.split(",")]),r.scale&&(l["font-scale"]=r.scale),r.textColor&&(l["text-color"]=["rgba"].concat(r.textColor.toArray())),a.push(l)}return a};var te=function(e){this.name=e.name,this.available=e.available};te.prototype.toString=function(){return this.name},te.fromString=function(e){return e?new te({name:e,available:!1}):null},te.prototype.serialize=function(){return["image",this.name]};var ee=function(a,t){this.type=a,this.value=t};ee.parse=function(a,t){if(2!==a.length)return t.error("'literal' expression requires exactly one argument, but found "+(a.length-1)+" instead.");if(!re(a[1]))return t.error("invalid value");var e=a[1],o=ne(e),r=t.expectedType;return"array"!==o.kind||0!==o.N||!r||"array"!==r.kind||"number"==typeof r.N&&0!==r.N||(o=r),new ee(o,e)},ee.prototype.evaluate=function(){return this.value},ee.prototype.eachChild=function(){},ee.prototype.outputDefined=function(){return!0},ee.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Yt?["rgba"].concat(this.value.toArray()):this.value instanceof Qt?this.value.serialize():this.value};var oe=function(e){this.name="ExpressionEvaluationError",this.message=e};oe.prototype.toJSON=function(){return this.message};var se={string:Ft,number:Vt,boolean:Dt,object:hc},ue=function(a,t){this.type=a,this.args=t};ue.parse=function(d,t){if(2>d.length)return t.error("Expected at least one argument.");var e=1,c=d[0],i;if("array"===c){var p,g;if(2<d.length){var m=d[1];if("string"!=typeof m||!(m in se)||"object"===m)return t.error("The item type argument of \"array\" must be one of string, number, boolean",1);p=se[m],e++}else p=Ot;if(3<d.length){if(null!==d[2]&&("number"!=typeof d[2]||0>d[2]||d[2]!==ya(d[2])))return t.error("The length argument to \"array\" must be a positive integer literal",2);g=d[2],e++}i=Tt(p,g)}else i=se[c];for(var s=[],u;e<d.length;e++){if(u=t.parse(d[e],e,Ot),!u)return null;s.push(u)}return new ue(i,s)},ue.prototype.evaluate=function(a){for(var t=0,o;t<this.args.length;t++){if(o=this.args[t].evaluate(a),!Gt(this.type,ne(o)))return o;if(t==this.args.length-1)throw new oe("Expected value to be of type "+Kt(this.type)+", but found "+Kt(ne(o))+" instead.")}return null},ue.prototype.eachChild=function(e){this.args.forEach(e)},ue.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},ue.prototype.serialize=function(){var a=this.type,t=[a.kind];if("array"===a.kind){var e=a.itemType;if("string"===e.kind||"number"===e.kind||"boolean"===e.kind){t.push(e.kind);var o=a.N;("number"==typeof o||1<this.args.length)&&t.push(o)}}return t.concat(this.args.map(function(e){return e.serialize()}))};var le=function(e){this.type=jt,this.sections=e};le.parse=function(d,t){if(2>d.length)return t.error("Expected at least one argument.");var e=d[1];if(!Array.isArray(e)&&"object"==typeof e)return t.error("First argument must be an image or text section.");for(var r=[],n=!1,g=1,m;g<=d.length-1;++g)if(m=d[g],n&&"object"==typeof m&&!Array.isArray(m)){n=!1;var y=null;if(m["font-scale"]&&!(y=t.parse(m["font-scale"],1,Vt)))return null;var f=null;if(m["text-font"]&&!(f=t.parse(m["text-font"],1,Tt(Ft))))return null;var x=null;if(m["text-color"]&&!(x=t.parse(m["text-color"],1,Lt)))return null;var _=r[r.length-1];_.scale=y,_.font=f,_.textColor=x}else{var p=t.parse(d[g],1,Ot);if(!p)return null;var c=p.type.kind;if("string"!==c&&"value"!==c&&"null"!==c&&"resolvedImage"!==c)return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");n=!0,r.push({content:p,scale:null,font:null,textColor:null})}return new le(r)},le.prototype.evaluate=function(a){return new Qt(this.sections.map(function(t){var e=t.content.evaluate(a);return ne(e)===qt?new Wt("",e,null,null,null):new Wt(ie(e),null,t.scale?t.scale.evaluate(a):null,t.font?t.font.evaluate(a).join(","):null,t.textColor?t.textColor.evaluate(a):null)}))},le.prototype.eachChild=function(a){for(var t=0,o=this.sections,r;t<o.length;t+=1)r=o[t],a(r.content),r.scale&&a(r.scale),r.font&&a(r.font),r.textColor&&a(r.textColor)},le.prototype.outputDefined=function(){return!1},le.prototype.serialize=function(){for(var a=["format"],t=0,o=this.sections,r;t<o.length;t+=1){r=o[t],a.push(r.content.serialize());var l={};r.scale&&(l["font-scale"]=r.scale.serialize()),r.font&&(l["text-font"]=r.font.serialize()),r.textColor&&(l["text-color"]=r.textColor.serialize()),a.push(l)}return a};var pe=function(e){this.type=qt,this.input=e};pe.parse=function(a,t){if(2!==a.length)return t.error("Expected two arguments.");var e=t.parse(a[1],1,Ft);return e?new pe(e):t.error("No image name provided.")},pe.prototype.evaluate=function(a){var t=this.input.evaluate(a),e=te.fromString(t);return e&&a.availableImages&&(e.available=-1<a.availableImages.indexOf(t)),e},pe.prototype.eachChild=function(e){e(this.input)},pe.prototype.outputDefined=function(){return!1},pe.prototype.serialize=function(){return["image",this.input.serialize()]};var ce={"to-boolean":Dt,"to-color":Lt,"to-number":Vt,"to-string":Ft},he=function(a,t){this.type=a,this.args=t};he.parse=function(l,t){if(2>l.length)return t.error("Expected at least one argument.");var e=l[0];if(("to-boolean"===e||"to-string"===e)&&2!==l.length)return t.error("Expected one argument.");for(var r=ce[e],n=[],i=1,s;i<l.length;i++){if(s=t.parse(l[i],i,Ot),!s)return null;n.push(s)}return new he(r,n)},he.prototype.evaluate=function(d){if("boolean"===this.type.kind)return!!this.args[0].evaluate(d);if("color"===this.type.kind){for(var t=0,c=this.args,i,p;t<c.length;t+=1){if(p=null,(i=c[t].evaluate(d))instanceof Yt)return i;if("string"==typeof i){var g=d.parseColor(i);if(g)return g}else if(Array.isArray(i)&&!(p=3>i.length||4<i.length?"Invalid rbga value "+JSON.stringify(i)+": expected an array containing either three or four numeric values.":Ht(i[0],i[1],i[2],i[3])))return new Yt(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new oe(p||"Could not parse color from value '"+("string"==typeof i?i:JSON.stringify(i)+"")+"'")}if("number"===this.type.kind){for(var a=null,m=0,h=this.args;m<h.length;m+=1){if(null===(a=h[m].evaluate(d)))return 0;var u=+a;if(!isNaN(u))return u}throw new oe("Could not convert "+JSON.stringify(a)+" to number.")}return"formatted"===this.type.kind?Qt.fromString(ie(this.args[0].evaluate(d))):"resolvedImage"===this.type.kind?te.fromString(ie(this.args[0].evaluate(d))):ie(this.args[0].evaluate(d))},he.prototype.eachChild=function(e){this.args.forEach(e)},he.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},he.prototype.serialize=function(){if("formatted"===this.type.kind)return new le([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new pe(this.args[0]).serialize();var a=["to-"+this.type.kind];return this.eachChild(function(t){a.push(t.serialize())}),a};var fe=["Unknown","Point","LineString","Polygon"],ye=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};ye.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},ye.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?fe[this.feature.type]:this.feature.type:null},ye.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},ye.prototype.canonicalID=function(){return this.canonical},ye.prototype.properties=function(){return this.feature&&this.feature.properties||{}},ye.prototype.parseColor=function(a){var t=this._parseColorCache[a];return t||(t=this._parseColorCache[a]=Yt.parse(a)),t};var de=function(a,t,e,o){this.name=a,this.type=t,this._evaluate=e,this.args=o};de.prototype.evaluate=function(e){return this._evaluate(e,this.args)},de.prototype.eachChild=function(e){this.args.forEach(e)},de.prototype.outputDefined=function(){return!1},de.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},de.parse=function(T,t){var e=T[0],n=de.definitions[e],i;if(!n)return t.error("Unknown expression \""+e+"\". If you wanted a literal array, use [\"literal\", [...]].",0);for(var C=Array.isArray(n)?n[0]:n.type,a=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,o=a.filter(function(t){var e=t[0];return!Array.isArray(e)||e.length===T.length-1}),s=null,L=0,E=o;L<E.length;L+=1){var p=E[L],c=p[0],h=p[1];s=new Le(t.registry,t.path,null,t.scope);for(var f=[],y=!1,P=1;P<T.length;P++){var z=T[P],v=Array.isArray(c)?c[P-1]:c.type,g=s.parse(z,1+f.length,v);if(!g){y=!0;break}f.push(g)}if(!y)if(Array.isArray(c)&&c.length!==f.length)s.error("Expected "+c.length+" arguments, but found "+f.length+" instead.");else{for(var x=0;x<f.length;x++){var D=Array.isArray(c)?c[x]:c.type,w=f[x];s.concat(x+1).checkSubtype(D,w.type)}if(0===s.errors.length)return new de(e,C,h,f)}}if(1===o.length)(i=t.errors).push.apply(i,s.errors);else{for(var _=(o.length?o:a).map(function(a){var t;return t=a[0],Array.isArray(t)?"("+t.map(Kt).join(", ")+")":"("+Kt(t.type)+"...)"}).join(" | "),A=[],S=1,O;S<T.length;S++){if(O=t.parse(T[S],1+A.length),!O)return null;A.push(Kt(O.type))}t.error("Expected arguments of type "+_+", but found ("+A.join(", ")+") instead.")}return null},de.register=function(a,t){for(var e in de.definitions=t,t)a[e]=de};var me=function(a,t,e){this.type=Ut,this.locale=e,this.caseSensitive=a,this.diacriticSensitive=t};me.parse=function(o,t){if(2!==o.length)return t.error("Expected one argument.");var e=o[1];if("object"!=typeof e||Array.isArray(e))return t.error("Collator options argument must be an object.");var r=t.parse(void 0!==e["case-sensitive"]&&e["case-sensitive"],1,Dt);if(!r)return null;var n=t.parse(void 0!==e["diacritic-sensitive"]&&e["diacritic-sensitive"],1,Dt);if(!n)return null;var i=null;return e.locale&&!(i=t.parse(e.locale,1,Ft))?null:new me(r,n,i)},me.prototype.evaluate=function(e){return new $t(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},me.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},me.prototype.outputDefined=function(){return!1},me.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var ve=function(a,t){this.type=Dt,this.geojson=a,this.geometries=t};ve.parse=function(o,t){if(2!==o.length)return t.error("'within' expression requires exactly one argument, but found "+(o.length-1)+" instead.");if(re(o[1])){var e=o[1];if("FeatureCollection"===e.type){for(var r=0,l;r<e.features.length;++r)if(l=e.features[r].geometry.type,"Polygon"===l||"MultiPolygon"===l)return new ve(e,e.features[r].geometry);}else if("Feature"===e.type){var s=e.geometry.type;if("Polygon"===s||"MultiPolygon"===s)return new ve(e,e.geometry)}else if("Polygon"===e.type||"MultiPolygon"===e.type)return new ve(e,e)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},ve.prototype.evaluate=function(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(d,t){var e=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],n=d.canonicalID();if("Polygon"===t.type){var i=ze(t.coordinates,r,n),a=Ee(d.geometry(),e,r,n);if(!ge(e,r))return!1;for(var o=0,g=a;o<g.length;o+=1)if(!we(g[o],i))return!1}if("MultiPolygon"===t.type){var u=Ce(t.coordinates,r,n),l=Ee(d.geometry(),e,r,n);if(!ge(e,r))return!1;for(var p=0,m=l;p<m.length;p+=1)if(!_e(m[p],u))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(d,t){var e=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],n=d.canonicalID();if("Polygon"===t.type){var i=ze(t.coordinates,r,n),a=Te(d.geometry(),e,r,n);if(!ge(e,r))return!1;for(var o=0,g=a;o<g.length;o+=1)if(!ke(g[o],i))return!1}if("MultiPolygon"===t.type){var u=Ce(t.coordinates,r,n),l=Te(d.geometry(),e,r,n);if(!ge(e,r))return!1;for(var p=0,m=l;p<m.length;p+=1)if(!Ie(m[p],u))return!1}return!0}(e,this.geometries)}return!1},ve.prototype.eachChild=function(){},ve.prototype.outputDefined=function(){return!0},ve.prototype.serialize=function(){return["within",this.geojson]};var Be=function(a,t){this.type=t.type,this.name=a,this.boundExpression=t};Be.parse=function(a,t){if(2!==a.length||"string"!=typeof a[1])return t.error("'var' expression requires exactly one string literal argument.");var e=a[1];return t.scope.has(e)?new Be(e,t.scope.get(e)):t.error("Unknown variable \""+e+"\". Make sure \""+e+"\" has been bound in an enclosing \"let\" expression before using it.",1)},Be.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},Be.prototype.eachChild=function(){},Be.prototype.outputDefined=function(){return!1},Be.prototype.serialize=function(){return["var",this.name]};var Le=function(a,t,o,r,l){void 0===t&&(t=[]),void 0===r&&(r=new Pt),void 0===l&&(l=[]),this.registry=a,this.path=t,this.key=t.map(function(e){return"["+e+"]"}).join(""),this.scope=r,this.errors=l,this.expectedType=o};Le.prototype.parse=function(a,t,e,o,r){return void 0===r&&(r={}),t?this.concat(t,e,o)._parse(a,r):this._parse(a,r)},Le.prototype._parse=function(l,d){function e(a,t,e){return"assert"===e?new ue(t,[a]):"coerce"===e?new he(t,[a]):a}if(null!==l&&"string"!=typeof l&&"boolean"!=typeof l&&"number"!=typeof l||(l=["literal",l]),Array.isArray(l)){if(0===l.length)return this.error("Expected an array with at least one element. If you wanted a literal array, use [\"literal\", []].");var r=l[0];if("string"!=typeof r)return this.error("Expression name must be a string, but found "+typeof r+" instead. If you wanted a literal array, use [\"literal\", [...]].",0),null;var n=this.registry[r];if(n){var i=n.parse(l,this);if(!i)return null;if(this.expectedType){var c=this.expectedType,o=i.type;if(("string"===c.kind||"number"===c.kind||"boolean"===c.kind||"object"===c.kind||"array"===c.kind)&&"value"===o.kind)i=e(i,c,d.typeAnnotation||"assert");else if(("color"===c.kind||"formatted"===c.kind||"resolvedImage"===c.kind)&&("value"===o.kind||"string"===o.kind))i=e(i,c,d.typeAnnotation||"coerce");else if(this.checkSubtype(c,o))return null}if(!(i instanceof ee)&&"resolvedImage"!==i.type.kind&&function a(t){if(t instanceof Be)return a(t.boundExpression);if(t instanceof de&&"error"===t.name)return!1;if(t instanceof me)return!1;if(t instanceof ve)return!1;var o=!0;return t.eachChild(function(t){o=t instanceof he||t instanceof ue?o&&a(t):o&&t instanceof ee}),!!o&&Pe(t)&&Fe(t,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(i)){var s=new ye;try{i=new ee(i.type,i.evaluate(s))}catch(e){return this.error(e.message),null}}return i}return this.error("Unknown expression \""+r+"\". If you wanted a literal array, use [\"literal\", [...]].",0)}return this.error(void 0===l?"'undefined' value invalid. Use null instead.":"object"==typeof l?"Bare objects invalid. Use [\"literal\", {...}] instead.":"Expected an array, but found "+typeof l+" instead.")},Le.prototype.concat=function(a,t,e){var o="number"==typeof a?this.path.concat(a):this.path,r=e?this.scope.concat(e):this.scope;return new Le(this.registry,o,t||null,r,this.errors)},Le.prototype.error=function(a){for(var t=[],e=arguments.length-1;0<e--;)t[e]=arguments[e+1];var o=""+this.key+t.map(function(e){return"["+e+"]"}).join("");this.errors.push(new zt(o,a))},Le.prototype.checkSubtype=function(a,t){var e=Gt(a,t);return e&&this.error(e),e};var Re=function(l,t,e){this.type=l,this.input=t,this.labels=[],this.outputs=[];for(var r=0,s=e;r<s.length;r+=1){var i=s[r],a=i[1];this.labels.push(i[0]),this.outputs.push(a)}};Re.parse=function(d,t){if(4>d.length-1)return t.error("Expected at least 4 arguments, but found only "+(d.length-1)+".");if(0!=(d.length-1)%2)return t.error("Expected an even number of arguments.");var e=t.parse(d[1],1,Vt);if(!e)return null;var r=[],n=null;t.expectedType&&"value"!==t.expectedType.kind&&(n=t.expectedType);for(var c=1;c<d.length;c+=2){var g=1==c?-1/0:d[c],o=d[c+1],s=c,u=c+1;if("number"!=typeof g)return t.error("Input/output pairs for \"step\" expressions must be defined using literal numeric values (not computed expressions) for the input values.",s);if(r.length&&r[r.length-1][0]>=g)return t.error("Input/output pairs for \"step\" expressions must be arranged with input values in strictly ascending order.",s);var l=t.parse(o,u,n);if(!l)return null;n=n||l.type,r.push([g,l])}return new Re(n,e,r)},Re.prototype.evaluate=function(a){var t=this.labels,e=this.outputs;if(1===t.length)return e[0].evaluate(a);var o=this.input.evaluate(a);if(o<=t[0])return e[0].evaluate(a);var r=t.length;return o>=t[r-1]?e[r-1].evaluate(a):e[De(t,o)].evaluate(a)},Re.prototype.eachChild=function(a){a(this.input);for(var t=0,o=this.outputs;t<o.length;t+=1)a(o[t])},Re.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},Re.prototype.serialize=function(){for(var a=["step",this.input.serialize()],t=0;t<this.labels.length;t++)0<t&&a.push(this.labels[t]),a.push(this.outputs[t].serialize());return a};var Ue=Object.freeze({__proto__:null,number:Oe,color:function(a,t,e){return new Yt(Oe(a.r,t.r,e),Oe(a.g,t.g,e),Oe(a.b,t.b,e),Oe(a.a,t.a,e))},array:function(a,o,e){return a.map(function(a,t){return Oe(a,o[t],e)})}}),qe=3*(6/29)*(6/29),Ne={forward:He,reverse:ld,interpolate:function(a,t,e){return{l:Oe(a.l,t.l,e),a:Oe(a.a,t.a,e),b:Oe(a.b,t.b,e),alpha:Oe(a.alpha,t.alpha,e)}}},Qe={forward:function(o){var t=He(o),e=t.l,r=t.a,n=t.b,i=k(n,r)*(180/Ke);return{h:0>i?i+360:i,c:We(r*r+n*n),l:e,alpha:o.a}},reverse:function(a){var t=a.h*(Ke/180),e=a.c;return ld({l:a.l,a:Ge(t)*e,b:Je(t)*e,alpha:a.alpha})},interpolate:function(a,t,e){return{h:$e(a.h,t.h,e),c:Oe(a.c,t.c,e),l:Oe(a.l,t.l,e),alpha:Oe(a.alpha,t.alpha,e)}}},tr=Object.freeze({__proto__:null,lab:Ne,hcl:Qe}),er=function(l,t,e,r,n){this.type=l,this.operator=t,this.interpolation=e,this.input=r,this.labels=[],this.outputs=[];for(var i=0,d=n;i<d.length;i+=1){var o=d[i],s=o[1];this.labels.push(o[0]),this.outputs.push(s)}};er.interpolationFactor=function(r,t,e,n){var i=0;if("exponential"===r.name)i=sd(t,r.base,e,n);else if("linear"===r.name)i=sd(t,1,e,n);else if("cubic-bezier"===r.name){var l=r.controlPoints;i=new Jd(l[0],l[1],l[2],l[3]).solve(sd(t,1,e,n))}return i},er.parse=function(g,t){var e=g[0],r=g[1],m=g[2],x=g.slice(3);if(!Array.isArray(r)||0===r.length)return t.error("Expected an interpolation type expression.",1);if("linear"===r[0])r={name:"linear"};else if("exponential"===r[0]){var a=r[1];if("number"!=typeof a)return t.error("Exponential interpolation requires a numeric base.",1,1);r={name:"exponential",base:a}}else{if("cubic-bezier"!==r[0])return t.error("Unknown interpolation type "+(r[0]+""),1,0);var o=r.slice(1);if(4!==o.length||o.some(function(e){return"number"!=typeof e||0>e||1<e}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);r={name:"cubic-bezier",controlPoints:o}}if(4>g.length-1)return t.error("Expected at least 4 arguments, but found only "+(g.length-1)+".");if(0!=(g.length-1)%2)return t.error("Expected an even number of arguments.");if(!(m=t.parse(m,2,Vt)))return null;var s=[],u=null;"interpolate-hcl"===e||"interpolate-lab"===e?u=Lt:t.expectedType&&"value"!==t.expectedType.kind&&(u=t.expectedType);for(var _=0;_<x.length;_+=2){var b=x[_],c=x[_+1],h=_+3,f=_+4;if("number"!=typeof b)return t.error("Input/output pairs for \"interpolate\" expressions must be defined using literal numeric values (not computed expressions) for the input values.",h);if(s.length&&s[s.length-1][0]>=b)return t.error("Input/output pairs for \"interpolate\" expressions must be arranged with input values in strictly ascending order.",h);var y=t.parse(c,f,u);if(!y)return null;u=u||y.type,s.push([b,y])}return"number"===u.kind||"color"===u.kind||"array"===u.kind&&"number"===u.itemType.kind&&"number"==typeof u.N?new er(u,e,r,m,s):t.error("Type "+Kt(u)+" is not interpolatable.")},er.prototype.evaluate=function(l){var t=this.labels,e=this.outputs;if(1===t.length)return e[0].evaluate(l);var r=this.input.evaluate(l);if(r<=t[0])return e[0].evaluate(l);var n=t.length;if(r>=t[n-1])return e[n-1].evaluate(l);var i=De(t,r),a=er.interpolationFactor(this.interpolation,r,t[i],t[i+1]),o=e[i].evaluate(l),s=e[i+1].evaluate(l);return"interpolate"===this.operator?Ue[this.type.kind.toLowerCase()](o,s,a):"interpolate-hcl"===this.operator?Qe.reverse(Qe.interpolate(Qe.forward(o),Qe.forward(s),a)):Ne.reverse(Ne.interpolate(Ne.forward(o),Ne.forward(s),a))},er.prototype.eachChild=function(a){a(this.input);for(var t=0,o=this.outputs;t<o.length;t+=1)a(o[t])},er.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},er.prototype.serialize=function(){var a="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,a,this.input.serialize()],e=0;e<this.labels.length;e++)t.push(this.labels[e],this.outputs[e].serialize());return t};var rr=function(a,t){this.type=a,this.args=t};rr.parse=function(l,t){if(2>l.length)return t.error("Expectected at least one argument.");var e=null,d=t.expectedType;d&&"value"!==d.kind&&(e=d);for(var n=[],i=0,c=l.slice(1),o;i<c.length;i+=1){if(o=t.parse(c[i],1+n.length,e,void 0,{typeAnnotation:"omit"}),!o)return null;e=e||o.type,n.push(o)}var p=d&&n.some(function(e){return Gt(d,e.type)});return new rr(p?Ot:e,n)},rr.prototype.evaluate=function(o){for(var t=null,l=0,s=0,d=this.args,a;s<d.length&&(l++,(t=d[s].evaluate(o))&&t instanceof te&&!t.available&&(a||(a=t.name),t=null,l===this.args.length&&(t=a)),null===t);s+=1);return t},rr.prototype.eachChild=function(e){this.args.forEach(e)},rr.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},rr.prototype.serialize=function(){var a=["coalesce"];return this.eachChild(function(t){a.push(t.serialize())}),a};var ir=function(a,t){this.type=t.type,this.bindings=[].concat(a),this.result=t};ir.prototype.evaluate=function(e){return this.result.evaluate(e)},ir.prototype.eachChild=function(a){for(var t=0,o=this.bindings;t<o.length;t+=1)a(o[t][1]);a(this.result)},ir.parse=function(l,t){if(4>l.length)return t.error("Expected at least 3 arguments, but found "+(l.length-1)+" instead.");for(var e=[],r=1,s;r<l.length-1;r+=2){if(s=l[r],"string"!=typeof s)return t.error("Expected string, but found "+typeof s+" instead.",r);if(/[^a-zA-Z0-9_]/.test(s))return t.error("Variable names must contain only alphanumeric characters or '_'.",r);var d=t.parse(l[r+1],r+1);if(!d)return null;e.push([s,d])}var a=t.parse(l[l.length-1],l.length-1,t.expectedType,e);return a?new ir(e,a):null},ir.prototype.outputDefined=function(){return this.result.outputDefined()},ir.prototype.serialize=function(){for(var a=["let"],t=0,o=this.bindings,r;t<o.length;t+=1)r=o[t],a.push(r[0],r[1].serialize());return a.push(this.result.serialize()),a};var ar=function(a,t,e){this.type=a,this.index=t,this.input=e};ar.parse=function(a,t){if(3!==a.length)return t.error("Expected 2 arguments, but found "+(a.length-1)+" instead.");var e=t.parse(a[1],1,Vt),o=t.parse(a[2],2,Tt(t.expectedType||Ot));return e&&o?new ar(o.type.itemType,e,o):null},ar.prototype.evaluate=function(a){var t=this.index.evaluate(a),e=this.input.evaluate(a);if(0>t)throw new oe("Array index out of bounds: "+t+" < 0.");if(t>=e.length)throw new oe("Array index out of bounds: "+t+" > "+(e.length-1)+".");if(t!==ya(t))throw new oe("Array index must be an integer, but found "+t+" instead.");return e[t]},ar.prototype.eachChild=function(e){e(this.index),e(this.input)},ar.prototype.outputDefined=function(){return!1},ar.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var or=function(a,t){this.type=Dt,this.needle=a,this.haystack=t};or.parse=function(a,t){if(3!==a.length)return t.error("Expected 2 arguments, but found "+(a.length-1)+" instead.");var e=t.parse(a[1],1,Ot),o=t.parse(a[2],2,Ot);return e&&o?Xt(e.type,[Dt,Ft,Vt,Bt,Ot])?new or(e,o):t.error("Expected first argument to be of type boolean, string, number or null, but found "+Kt(e.type)+" instead"):null},or.prototype.evaluate=function(a){var t=this.needle.evaluate(a),e=this.haystack.evaluate(a);if(!e)return!1;if(!Jt(t,["boolean","string","number","null"]))throw new oe("Expected first argument to be of type boolean, string, number or null, but found "+Kt(ne(t))+" instead.");if(!Jt(e,["string","array"]))throw new oe("Expected second argument to be of type array or string, but found "+Kt(ne(e))+" instead.");return 0<=e.indexOf(t)},or.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},or.prototype.outputDefined=function(){return!0},or.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var sr=function(a,t,e){this.type=Vt,this.needle=a,this.haystack=t,this.fromIndex=e};sr.parse=function(a,t){if(2>=a.length||5<=a.length)return t.error("Expected 3 or 4 arguments, but found "+(a.length-1)+" instead.");var e=t.parse(a[1],1,Ot),o=t.parse(a[2],2,Ot);if(!e||!o)return null;if(!Xt(e.type,[Dt,Ft,Vt,Bt,Ot]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+Kt(e.type)+" instead");if(4===a.length){var r=t.parse(a[3],3,Vt);return r?new sr(e,o,r):null}return new sr(e,o)},sr.prototype.evaluate=function(a){var t=this.needle.evaluate(a),e=this.haystack.evaluate(a);if(!Jt(t,["boolean","string","number","null"]))throw new oe("Expected first argument to be of type boolean, string, number or null, but found "+Kt(ne(t))+" instead.");if(!Jt(e,["string","array"]))throw new oe("Expected second argument to be of type array or string, but found "+Kt(ne(e))+" instead.");if(this.fromIndex){var o=this.fromIndex.evaluate(a);return e.indexOf(t,o)}return e.indexOf(t)},sr.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},sr.prototype.outputDefined=function(){return!1},sr.prototype.serialize=function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var ur=function(o,t,e,r,n,i){this.inputType=o,this.type=t,this.input=e,this.cases=r,this.outputs=n,this.otherwise=i};ur.parse=function(g,t){var e=Number.MAX_SAFE_INTEGER;if(5>g.length)return t.error("Expected at least 4 arguments, but found only "+(g.length-1)+".");if(1!=g.length%2)return t.error("Expected an even number of arguments.");var m,x;t.expectedType&&"value"!==t.expectedType.kind&&(x=t.expectedType);for(var _={},i=[],a=2;a<g.length-1;a+=2){var b=g[a],v=g[a+1];Array.isArray(b)||(b=[b]);var u=t.concat(a);if(0===b.length)return u.error("Expected at least one branch label.");for(var l=0,w=b,c;l<w.length;l+=1){if(c=w[l],"number"!=typeof c&&"string"!=typeof c)return u.error("Branch labels must be numbers or strings.");if("number"==typeof c&&ma(c)>e)return u.error("Branch labels must be integers no larger than "+e+".");if("number"==typeof c&&ya(c)!==c)return u.error("Numeric branch labels must be integer values.");if(!m)m=ne(c);else if(u.checkSubtype(m,ne(c)))return null;if(void 0!==_[c+""])return u.error("Branch labels must be unique.");_[c+""]=i.length}var k=t.parse(v,a,x);if(!k)return null;x=x||k.type,i.push(k)}var f=t.parse(g[1],1,Ot);if(!f)return null;var y=t.parse(g[g.length-1],g.length-1,x);return y?"value"!==f.type.kind&&t.concat(1).checkSubtype(m,f.type)?null:new ur(m,x,f,_,i,y):null},ur.prototype.evaluate=function(a){var t=this.input.evaluate(a);return(ne(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(a)},ur.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},ur.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},ur.prototype.serialize=function(){for(var d=this,t=["match",this.input.serialize()],e=[],r={},n=0,g=Object.keys(this.cases).sort(),a;n<g.length;n+=1)a=g[n],void 0===(p=r[this.cases[a]])?(r[this.cases[a]]=e.length,e.push([this.cases[a],[a]])):e[p][1].push(a);for(var m=function(t){return"number"===d.inputType.kind?+t:t},s=0,y=e;s<y.length;s+=1){var l=y[s],p=l[0],f=l[1];t.push(1===f.length?m(f[0]):f.map(m)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var lr=function(a,t,e){this.type=a,this.branches=t,this.otherwise=e};lr.parse=function(l,t){if(4>l.length)return t.error("Expected at least 3 arguments, but found only "+(l.length-1)+".");if(0!=l.length%2)return t.error("Expected an odd number of arguments.");var e;t.expectedType&&"value"!==t.expectedType.kind&&(e=t.expectedType);for(var d=[],n=1,c;n<l.length-1;n+=2){if(c=t.parse(l[n],n,Dt),!c)return null;var p=t.parse(l[n+1],n+1,e);if(!p)return null;d.push([c,p]),e=e||p.type}var o=t.parse(l[l.length-1],l.length-1,e);return o?new lr(e,d,o):null},lr.prototype.evaluate=function(a){for(var t=0,o=this.branches;t<o.length;t+=1){var r=o[t],n=r[1];if(r[0].evaluate(a))return n.evaluate(a)}return this.otherwise.evaluate(a)},lr.prototype.eachChild=function(a){for(var t=0,o=this.branches;t<o.length;t+=1){var r=o[t],n=r[1];a(r[0]),a(n)}a(this.otherwise)},lr.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},lr.prototype.serialize=function(){var a=["case"];return this.eachChild(function(t){a.push(t.serialize())}),a};var pr=function(a,t,e,o){this.type=a,this.input=t,this.beginIndex=e,this.endIndex=o};pr.parse=function(a,t){if(2>=a.length||5<=a.length)return t.error("Expected 3 or 4 arguments, but found "+(a.length-1)+" instead.");var e=t.parse(a[1],1,Ot),o=t.parse(a[2],2,Vt);if(!e||!o)return null;if(!Xt(e.type,[Tt(Ot),Ft,Ot]))return t.error("Expected first argument to be of type array or string, but found "+Kt(e.type)+" instead");if(4===a.length){var r=t.parse(a[3],3,Vt);return r?new pr(e.type,e,o,r):null}return new pr(e.type,e,o)},pr.prototype.evaluate=function(a){var t=this.input.evaluate(a),e=this.beginIndex.evaluate(a);if(!Jt(t,["string","array"]))throw new oe("Expected first argument to be of type array or string, but found "+Kt(ne(t))+" instead.");if(this.endIndex){var o=this.endIndex.evaluate(a);return t.slice(e,o)}return t.slice(e)},pr.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},pr.prototype.outputDefined=function(){return!1},pr.prototype.serialize=function(){if(null!=this.endIndex&&void 0!==this.endIndex){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var cr=fr("==",function(a,t,e){return t===e},hr),dr=fr("!=",function(a,t,e){return t!==e},function(a,t,e,o){return!hr(0,t,e,o)}),mr=fr("<",function(a,t,e){return t<e},function(a,t,e,o){return 0>o.compare(t,e)}),vr=fr(">",function(a,t,e){return t>e},function(a,t,e,o){return 0<o.compare(t,e)}),gr=fr("<=",function(a,t,e){return t<=e},function(a,t,e,o){return 0>=o.compare(t,e)}),xr=fr(">=",function(a,t,e){return t>=e},function(a,t,e,o){return 0<=o.compare(t,e)}),br=function(a,t,e,o,r){this.type=Ft,this.number=a,this.locale=t,this.currency=e,this.minFractionDigits=o,this.maxFractionDigits=r};br.parse=function(l,t){if(3!==l.length)return t.error("Expected two arguments.");var e=t.parse(l[1],1,Vt);if(!e)return null;var r=l[2];if("object"!=typeof r||Array.isArray(r))return t.error("NumberFormat options argument must be an object.");var n=null;if(r.locale&&!(n=t.parse(r.locale,1,Ft)))return null;var d=null;if(r.currency&&!(d=t.parse(r.currency,1,Ft)))return null;var c=null;if(r["min-fraction-digits"]&&!(c=t.parse(r["min-fraction-digits"],1,Vt)))return null;var p=null;return r["max-fraction-digits"]&&!(p=t.parse(r["max-fraction-digits"],1,Vt))?null:new br(e,n,d,c,p)},br.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},br.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},br.prototype.outputDefined=function(){return!1},br.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var wr=function(e){this.type=Vt,this.input=e};wr.parse=function(a,t){if(2!==a.length)return t.error("Expected 1 argument, but found "+(a.length-1)+" instead.");var e=t.parse(a[1],1);return e?"array"!==e.type.kind&&"string"!==e.type.kind&&"value"!==e.type.kind?t.error("Expected argument of type string or array, but found "+Kt(e.type)+" instead."):new wr(e):null},wr.prototype.evaluate=function(a){var t=this.input.evaluate(a);if("string"==typeof t)return t.length;if(Array.isArray(t))return t.length;throw new oe("Expected value to be of type string or array, but found "+Kt(ne(t))+" instead.")},wr.prototype.eachChild=function(e){e(this.input)},wr.prototype.outputDefined=function(){return!1},wr.prototype.serialize=function(){var a=["length"];return this.eachChild(function(t){a.push(t.serialize())}),a};var _r={"==":cr,"!=":dr,">":vr,"<":mr,">=":xr,"<=":gr,array:ue,at:ar,boolean:ue,case:lr,coalesce:rr,collator:me,format:le,image:pe,in:or,"index-of":sr,interpolate:er,"interpolate-hcl":er,"interpolate-lab":er,length:wr,let:ir,literal:ee,match:ur,number:ue,"number-format":br,object:ue,slice:pr,step:Re,string:ue,"to-boolean":he,"to-color":he,"to-number":he,"to-string":he,var:Be,within:ve};de.register(_r,{error:[{kind:"error"},[Ft],function(a,t){throw new oe(t[0].evaluate(a))}],typeof:[Ft,[Ot],function(a,t){return Kt(ne(t[0].evaluate(a)))}],"to-rgba":[Tt(Vt,4),[Lt],function(a,t){return t[0].evaluate(a).toArray()}],rgb:[Lt,[Vt,Vt,Vt],yr],rgba:[Lt,[Vt,Vt,Vt,Vt],yr],has:{type:Dt,overloads:[[[Ft],function(a,t){return Sr(t[0].evaluate(a),a.properties())}],[[Ft,hc],function(a,t){var e=t[1];return Sr(t[0].evaluate(a),e.evaluate(a))}]]},get:{type:Ot,overloads:[[[Ft],function(a,t){return kr(t[0].evaluate(a),a.properties())}],[[Ft,hc],function(a,t){var e=t[1];return kr(t[0].evaluate(a),e.evaluate(a))}]]},"feature-state":[Ot,[Ft],function(a,t){return kr(t[0].evaluate(a),a.featureState||{})}],properties:[hc,[],function(e){return e.properties()}],"geometry-type":[Ft,[],function(e){return e.geometryType()}],id:[Ot,[],function(e){return e.id()}],zoom:[Vt,[],function(e){return e.globals.zoom}],"heatmap-density":[Vt,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[Vt,[],function(e){return e.globals.lineProgress||0}],accumulated:[Ot,[],function(e){return void 0===e.globals.accumulated?null:e.globals.accumulated}],"+":[Vt,Ir(Vt),function(a,t){for(var e=0,o=0,l=t;o<l.length;o+=1)e+=l[o].evaluate(a);return e}],"*":[Vt,Ir(Vt),function(a,t){for(var e=1,o=0,l=t;o<l.length;o+=1)e*=l[o].evaluate(a);return e}],"-":{type:Vt,overloads:[[[Vt,Vt],function(a,t){var e=t[1];return t[0].evaluate(a)-e.evaluate(a)}],[[Vt],function(a,t){return-t[0].evaluate(a)}]]},"/":[Vt,[Vt,Vt],function(a,t){var e=t[1];return t[0].evaluate(a)/e.evaluate(a)}],"%":[Vt,[Vt,Vt],function(a,t){var e=t[1];return t[0].evaluate(a)%e.evaluate(a)}],ln2:[Vt,[],function(){return T}],pi:[Vt,[],function(){return Ke}],e:[Vt,[],function(){var e=Math.E;return e}],"^":[Vt,[Vt,Vt],function(a,t){var e=t[1];return pa(t[0].evaluate(a),e.evaluate(a))}],sqrt:[Vt,[Vt],function(a,t){return We(t[0].evaluate(a))}],log10:[Vt,[Vt],function(a,t){return C(t[0].evaluate(a))/A}],ln:[Vt,[Vt],function(a,t){return C(t[0].evaluate(a))}],log2:[Vt,[Vt],function(a,t){return C(t[0].evaluate(a))/T}],sin:[Vt,[Vt],function(a,t){return Je(t[0].evaluate(a))}],cos:[Vt,[Vt],function(a,t){return Ge(t[0].evaluate(a))}],tan:[Vt,[Vt],function(a,t){return ua(t[0].evaluate(a))}],asin:[Vt,[Vt],function(a,t){return c(t[0].evaluate(a))}],acos:[Vt,[Vt],function(a,t){return p(t[0].evaluate(a))}],atan:[Vt,[Vt],function(a,t){return ga(t[0].evaluate(a))}],min:[Vt,Ir(Vt),function(a,t){return Rt.apply(Math,t.map(function(t){return t.evaluate(a)}))}],max:[Vt,Ir(Vt),function(a,t){return ha.apply(Math,t.map(function(t){return t.evaluate(a)}))}],abs:[Vt,[Vt],function(a,t){return ma(t[0].evaluate(a))}],round:[Vt,[Vt],function(a,t){var e=t[0].evaluate(a);return 0>e?-Xe(-e):Xe(e)}],floor:[Vt,[Vt],function(a,t){return ya(t[0].evaluate(a))}],ceil:[Vt,[Vt],function(a,t){return Ye(t[0].evaluate(a))}],"filter-==":[Dt,[Ft,Ot],function(a,t){var e=t[0],o=t[1];return a.properties()[e.value]===o.value}],"filter-id-==":[Dt,[Ot],function(a,t){var e=t[0];return a.id()===e.value}],"filter-type-==":[Dt,[Ft],function(a,t){var e=t[0];return a.geometryType()===e.value}],"filter-<":[Dt,[Ft,Ot],function(o,t){var e=t[0],r=t[1],n=o.properties()[e.value],i=r.value;return typeof n==typeof i&&n<i}],"filter-id-<":[Dt,[Ot],function(a,t){var e=t[0],o=a.id(),r=e.value;return typeof o==typeof r&&o<r}],"filter->":[Dt,[Ft,Ot],function(o,t){var e=t[0],r=t[1],n=o.properties()[e.value],i=r.value;return typeof n==typeof i&&n>i}],"filter-id->":[Dt,[Ot],function(a,t){var e=t[0],o=a.id(),r=e.value;return typeof o==typeof r&&o>r}],"filter-<=":[Dt,[Ft,Ot],function(o,t){var e=t[0],r=t[1],n=o.properties()[e.value],i=r.value;return typeof n==typeof i&&n<=i}],"filter-id-<=":[Dt,[Ot],function(a,t){var e=t[0],o=a.id(),r=e.value;return typeof o==typeof r&&o<=r}],"filter->=":[Dt,[Ft,Ot],function(o,t){var e=t[0],r=t[1],n=o.properties()[e.value],i=r.value;return typeof n==typeof i&&n>=i}],"filter-id->=":[Dt,[Ot],function(a,t){var e=t[0],o=a.id(),r=e.value;return typeof o==typeof r&&o>=r}],"filter-has":[Dt,[Ot],function(a,t){return t[0].value in a.properties()}],"filter-has-id":[Dt,[],function(e){return null!==e.id()&&void 0!==e.id()}],"filter-type-in":[Dt,[Tt(Ft)],function(a,t){return 0<=t[0].value.indexOf(a.geometryType())}],"filter-id-in":[Dt,[Tt(Ot)],function(a,t){return 0<=t[0].value.indexOf(a.id())}],"filter-in-small":[Dt,[Ft,Tt(Ot)],function(a,t){var e=t[0];return 0<=t[1].value.indexOf(a.properties()[e.value])}],"filter-in-large":[Dt,[Ft,Tt(Ot)],function(a,t){var e=t[0],o=t[1];return function(a,t,e,o){for(;e<=o;){var l=e+o>>1;if(t[l]===a)return!0;t[l]>a?o=l-1:e=l+1}return!1}(a.properties()[e.value],o.value,0,o.value.length-1)}],all:{type:Dt,overloads:[[[Dt,Dt],function(a,t){var e=t[1];return t[0].evaluate(a)&&e.evaluate(a)}],[Ir(Dt),function(a,t){for(var e=0,o=t;e<o.length;e+=1)if(!o[e].evaluate(a))return!1;return!0}]]},any:{type:Dt,overloads:[[[Dt,Dt],function(a,t){var e=t[1];return t[0].evaluate(a)||e.evaluate(a)}],[Ir(Dt),function(a,t){for(var e=0,o=t;e<o.length;e+=1)if(o[e].evaluate(a))return!0;return!1}]]},"!":[Dt,[Dt],function(a,t){return!t[0].evaluate(a)}],"is-supported-script":[Dt,[Ft],function(a,t){var e=a.globals&&a.globals.isSupportedScript;return!e||e(t[0].evaluate(a))}],upcase:[Ft,[Ft],function(a,t){return t[0].evaluate(a).toUpperCase()}],downcase:[Ft,[Ft],function(a,t){return t[0].evaluate(a).toLowerCase()}],concat:[Ft,Ir(Ot),function(a,t){return t.map(function(t){return ie(t.evaluate(a))}).join("")}],"resolved-locale":[Ft,[Ut],function(a,t){return t[0].evaluate(a).resolvedLocale()}]});var Ar=function(a,t){this.expression=a,this._warningHistory={},this._evaluator=new ye,this._defaultValue=t?function(e){return"color"===e.type&&Br(e.default)?new Yt(0,0,0,0):"color"===e.type?Yt.parse(e.default)||null:void 0===e.default?null:e.default}(t):null,this._enumValues=t&&"enum"===t.type?t.values:null};Ar.prototype.evaluateWithoutErrorHandling=function(o,t,e,r,n,i){return this._evaluator.globals=o,this._evaluator.feature=t,this._evaluator.featureState=e,this._evaluator.canonical=r,this._evaluator.availableImages=n||null,this._evaluator.formattedSection=i,this.expression.evaluate(this._evaluator)},Ar.prototype.evaluate=function(l,t,e,r,n,i){this._evaluator.globals=l,this._evaluator.feature=t||null,this._evaluator.featureState=e||null,this._evaluator.canonical=r,this._evaluator.availableImages=n||null,this._evaluator.formattedSection=i||null;try{var a=this.expression.evaluate(this._evaluator);if(null==a||"number"==typeof a&&a!=a)return this._defaultValue;if(this._enumValues&&!(a in this._enumValues))throw new oe("Expected value to be one of "+Object.keys(this._enumValues).map(function(e){return JSON.stringify(e)}).join(", ")+", but found "+JSON.stringify(a)+" instead.");return a}catch(e){return this._warningHistory[e.message]||(this._warningHistory[e.message]=!0,"undefined"!=typeof console&&console.warn(e.message)),this._defaultValue}};var jr=function(a,t){this.kind=a,this._styleExpression=t,this.isStateDependent="constant"!==a&&!Ve(t.expression)};jr.prototype.evaluateWithoutErrorHandling=function(o,t,e,r,n,i){return this._styleExpression.evaluateWithoutErrorHandling(o,t,e,r,n,i)},jr.prototype.evaluate=function(o,t,e,r,n,i){return this._styleExpression.evaluate(o,t,e,r,n,i)};var Kr=function(a,t,e,o){this.kind=a,this.zoomStops=e,this._styleExpression=t,this.isStateDependent="camera"!==a&&!Ve(t.expression),this.interpolationType=o};Kr.prototype.evaluateWithoutErrorHandling=function(o,t,e,r,n,i){return this._styleExpression.evaluateWithoutErrorHandling(o,t,e,r,n,i)},Kr.prototype.evaluate=function(o,t,e,r,n,i){return this._styleExpression.evaluate(o,t,e,r,n,i)},Kr.prototype.interpolationFactor=function(a,t,e){return this.interpolationType?er.interpolationFactor(this.interpolationType,a,t,e):0};var Gr=function(a,t){this._parameters=a,this._specification=t,Ct(this,function k(T,S){var t="color"===S.type,o=T.stops&&"object"==typeof T.stops[0][0],r=o||!(o||void 0!==T.property),s=T.type||(Tr(S)?"exponential":"interval"),l,u,C;if(t&&((T=Ct({},T)).stops&&(T.stops=T.stops.map(function(e){return[e[0],Yt.parse(e[1])]})),T.default=Yt.parse(T.default?T.default:S.default)),T.colorSpace&&"rgb"!==T.colorSpace&&!tr[T.colorSpace])throw new Error("Unknown color space: "+T.colorSpace);if("exponential"===s)l=Rr;else if("interval"===s)l=Lr;else if("categorical"===s){l=Dr,u=Object.create(null);for(var L=0,E=T.stops,c;L<E.length;L+=1)c=E[L],u[c[0]]=c[1];C=typeof T.stops[0][0]}else{if("identity"!==s)throw new Error("Unknown function type \""+s+"\"");l=Or}if(o){for(var I={},f=[],y=0;y<T.stops.length;y++){var P=T.stops[y],m=P[0].zoom;void 0===I[m]&&(I[m]={zoom:m,type:T.type,property:T.property,default:T.default,stops:[]},f.push(m)),I[m].stops.push([P[0].value,P[1]])}for(var v=[],g=0,z=f,b;g<z.length;g+=1)b=z[g],v.push([I[b].zoom,k(I[b],S)]);var D={name:"linear"};return{kind:"composite",interpolationType:D,interpolationFactor:er.interpolationFactor.bind(void 0,D),zoomStops:v.map(function(e){return e[0]}),evaluate:function(e,t){var a=e.zoom;return Rr({stops:v,base:T.base},S,a).evaluate(a,t)}}}if(r){var _="exponential"===s?{name:"exponential",base:void 0===T.base?1:T.base}:null;return{kind:"camera",interpolationType:_,interpolationFactor:er.interpolationFactor.bind(void 0,_),zoomStops:T.stops.map(function(e){return e[0]}),evaluate:function(e){return l(T,S,e.zoom,u,C)}}}return{kind:"source",evaluate:function(e,t){var a=t&&t.properties?t.properties[T.property]:void 0;return void 0===a?Fr(T.default,S.default):l(T,S,a,u,C)}}}(this._parameters,this._specification))};Gr.deserialize=function(e){return new Gr(e._parameters,e._specification)},Gr.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var Xr={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},en={promoteId:function(a){var t=a.key,e=a.value;if("string"===Pr(e))return yn({key:t,value:e});var o=[];for(var r in e)o.push.apply(o,yn({key:t+"."+r,value:e[r]}));return o}},mn={"*":function(){return[]},array:Jr,boolean:function(a){var t=a.value,e=a.key,o=Pr(t);return"boolean"===o?[]:[new It(e,t,"boolean expected, "+o+" found")]},number:Hr,color:function(a){var t=a.key,e=a.value,o=Pr(e);return"string"===o?null===Zt(e)?[new It(t,e,"color expected, \""+e+"\" found")]:[]:[new It(t,e,"color expected, "+o+" found")]},constants:_t,enum:Wr,filter:ln,function:Yr,layer:fn,object:Zr,source:dn,light:vn,string:yn,formatted:function(e){return 0===yn(e).length?[]:$r(e)},resolvedImage:function(e){return 0===yn(e).length?[]:$r(e)}};wn.source=An(dn),wn.light=An(vn),wn.layer=An(fn),wn.filter=An(ln),wn.paintProperty=An(cn),wn.layoutProperty=An(hn);var xn=wn,kn=xn.light,In=xn.paintProperty,zn=xn.layoutProperty,Cn=Mn;Mn.prototype.insert=function(a,t,e,o,r){this._forEachCell(t,e,o,r,this._insertCell,this.uid++),this.keys.push(a),this.bboxes.push(t),this.bboxes.push(e),this.bboxes.push(o),this.bboxes.push(r)},Mn.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Mn.prototype._insertCell=function(o,t,e,r,n,i){this.cells[n].push(i)},Mn.prototype.query=function(l,t,e,r,n){var i=this.min,a=this.max;if(l<=i&&t<=i&&a<=e&&a<=r&&!n)return Array.prototype.slice.call(this.keys);var o=[];return this._forEachCell(l,t,e,r,this._queryCell,o,{},n),o},Mn.prototype._queryCell=function(d,t,e,r,n,i,a,o){var s=this.cells[n];if(null!==s)for(var u=this.keys,l=this.bboxes,p=0,g;p<s.length;p++)if(g=s[p],void 0===a[g]){var m=4*g;(o?o(l[m+0],l[m+1],l[m+2],l[m+3]):d<=l[m+2]&&t<=l[m+3]&&e>=l[m+0]&&r>=l[m+1])?(a[g]=!0,i.push(u[g])):a[g]=!1}},Mn.prototype._forEachCell=function(d,t,e,r,n,i,a,o){for(var s=this._convertToCellCoord(d),u=this._convertToCellCoord(t),l=this._convertToCellCoord(e),p=this._convertToCellCoord(r),c=s;c<=l;c++)for(var g=u,m;g<=p;g++)if(m=this.d*g+c,(!o||o(this._convertFromCellCoord(c),this._convertFromCellCoord(g),this._convertFromCellCoord(c+1),this._convertFromCellCoord(g+1)))&&n.call(this,d,t,e,r,m,i,a,o))return},Mn.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},Mn.prototype._convertToCellCoord=function(e){return ha(0,Rt(this.d-1,ya(e*this.scale)+this.padding))},Mn.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var l=this.cells,t=3+this.cells.length+1+1,e=0,d=0;d<this.cells.length;d++)e+=this.cells[d].length;var c=new Int32Array(t+e+this.keys.length+this.bboxes.length);c[0]=this.extent,c[1]=this.n,c[2]=this.padding;for(var i=t,p=0,u;p<l.length;p++)u=l[p],c[3+p]=i,c.set(u,i),i+=u.length;return c[3+l.length]=i,c.set(this.keys,i),c[3+l.length+1]=i+=this.keys.length,c.set(this.bboxes,i),i+=this.bboxes.length,c.buffer};var En=self.ImageData,Pn=self.ImageBitmap,Bn={};for(var Vn in Tn("Object",Object),Cn.serialize=function(a,t){var e=a.toArrayBuffer();return t&&t.push(e),{buffer:e}},Cn.deserialize=function(e){return new Cn(e.buffer)},Tn("Grid",Cn),Tn("Color",Yt),Tn("Error",Error),Tn("ResolvedImage",te),Tn("StylePropertyFunction",Gr),Tn("StyleExpression",Ar,{omit:["_evaluator"]}),Tn("ZoomDependentExpression",Kr),Tn("ZoomConstantExpression",jr),Tn("CompoundExpression",de,{omit:["_evaluate"]}),_r)_r[Vn]._classRegistryKey||Tn("Expression_"+Vn,_r[Vn]);var Dn=function(){this.first=!0};Dn.prototype.update=function(a,t){var e=ya(a);return this.first?(this.first=!1,this.lastIntegerZoom=e,this.lastIntegerZoomTime=0,this.lastZoom=a,this.lastFloorZoom=e,!0):(this.lastFloorZoom>e?(this.lastIntegerZoom=e+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<e&&(this.lastIntegerZoom=e,this.lastIntegerZoomTime=t),a!==this.lastZoom&&(this.lastZoom=a,this.lastFloorZoom=e,!0))};var jn={"Latin-1 Supplement":function(e){return 128<=e&&255>=e},Arabic:function(e){return 1536<=e&&1791>=e},"Arabic Supplement":function(e){return 1872<=e&&1919>=e},"Arabic Extended-A":function(e){return 2208<=e&&2303>=e},"Hangul Jamo":function(e){return 4352<=e&&4607>=e},"Unified Canadian Aboriginal Syllabics":function(e){return 5120<=e&&5759>=e},Khmer:function(e){return 6016<=e&&6143>=e},"Unified Canadian Aboriginal Syllabics Extended":function(e){return 6320<=e&&6399>=e},"General Punctuation":function(e){return 8192<=e&&8303>=e},"Letterlike Symbols":function(e){return 8448<=e&&8527>=e},"Number Forms":function(e){return 8528<=e&&8591>=e},"Miscellaneous Technical":function(e){return 8960<=e&&9215>=e},"Control Pictures":function(e){return 9216<=e&&9279>=e},"Optical Character Recognition":function(e){return 9280<=e&&9311>=e},"Enclosed Alphanumerics":function(e){return 9312<=e&&9471>=e},"Geometric Shapes":function(e){return 9632<=e&&9727>=e},"Miscellaneous Symbols":function(e){return 9728<=e&&9983>=e},"Miscellaneous Symbols and Arrows":function(e){return 11008<=e&&11263>=e},"CJK Radicals Supplement":function(e){return 11904<=e&&12031>=e},"Kangxi Radicals":function(e){return 12032<=e&&12255>=e},"Ideographic Description Characters":function(e){return 12272<=e&&12287>=e},"CJK Symbols and Punctuation":function(e){return 12288<=e&&12351>=e},Hiragana:function(e){return 12352<=e&&12447>=e},Katakana:function(e){return 12448<=e&&12543>=e},Bopomofo:function(e){return 12544<=e&&12591>=e},"Hangul Compatibility Jamo":function(e){return 12592<=e&&12687>=e},Kanbun:function(e){return 12688<=e&&12703>=e},"Bopomofo Extended":function(e){return 12704<=e&&12735>=e},"CJK Strokes":function(e){return 12736<=e&&12783>=e},"Katakana Phonetic Extensions":function(e){return 12784<=e&&12799>=e},"Enclosed CJK Letters and Months":function(e){return 12800<=e&&13055>=e},"CJK Compatibility":function(e){return 13056<=e&&13311>=e},"CJK Unified Ideographs Extension A":function(e){return 13312<=e&&19903>=e},"Yijing Hexagram Symbols":function(e){return 19904<=e&&19967>=e},"CJK Unified Ideographs":function(e){return 19968<=e&&40959>=e},"Yi Syllables":function(e){return 40960<=e&&42127>=e},"Yi Radicals":function(e){return 42128<=e&&42191>=e},"Hangul Jamo Extended-A":function(e){return 43360<=e&&43391>=e},"Hangul Syllables":function(e){return 44032<=e&&55215>=e},"Hangul Jamo Extended-B":function(e){return 55216<=e&&55295>=e},"Private Use Area":function(e){return 57344<=e&&63743>=e},"CJK Compatibility Ideographs":function(e){return 63744<=e&&64255>=e},"Arabic Presentation Forms-A":function(e){return 64336<=e&&65023>=e},"Vertical Forms":function(e){return 65040<=e&&65055>=e},"CJK Compatibility Forms":function(e){return 65072<=e&&65103>=e},"Small Form Variants":function(e){return 65104<=e&&65135>=e},"Arabic Presentation Forms-B":function(e){return 65136<=e&&65279>=e},"Halfwidth and Fullwidth Forms":function(e){return 65280<=e&&65519>=e}},qn=null,yc="unavailable",fc=null,xc=function(e){e&&"string"==typeof e&&-1<e.indexOf("NetworkError")&&(yc="error"),qn&&qn(e)},Wn=new St,ti=function(){return yc},ei=function(){if("deferred"!==yc||!fc)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");yc="loading",Jn(),fc&&vt({url:fc},function(e){e?xc(e):(yc="loaded",Jn())})},ri={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return"loaded"===yc||null!=ri.applyArabicShaping},isLoading:function(){return"loading"===yc},setState:function(e){yc=e.pluginStatus,fc=e.pluginURL},isParsed:function(){return null!=ri.applyArabicShaping&&null!=ri.processBidirectionalText&&null!=ri.processStyledBidirectionalText},getPluginURL:function(){return fc}},ni=function(a,t){this.zoom=a,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Dn,this.transition={})};ni.prototype.isSupportedScript=function(e){return function(a,t){for(var e=0,o=a;e<o.length;e+=1)if(!Zn(o[e].charCodeAt(0),t))return!1;return!0}(e,ri.isLoaded())},ni.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Rt((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},ni.prototype.getCrossfadeParameters=function(){var a=this.zoom,t=a-ya(a),e=this.crossFadingFactor();return a>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*e}:{fromScale:.5,toScale:1,t:1-(1-e)*t}};var ii=function(a,t){this.property=a,this.value=t,this.expression=function(a,t){if(Br(a))return new Gr(a,t);if(Ur(a)){var e=Nr(a,t);if("error"===e.result)throw new Error(e.value.map(function(e){return e.key+": "+e.message}).join(", "));return e.value}var o=a;return"string"==typeof a&&"color"===t.type&&(o=Yt.parse(a)),{kind:"constant",evaluate:function(){return o}}}(void 0===t?a.specification.default:t,a.specification)};ii.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},ii.prototype.possiblyEvaluate=function(a,t,e){return this.property.possiblyEvaluate(this,a,t,e)};var ai=function(e){this.property=e,this.value=new ii(e,void 0)};ai.prototype.transitioned=function(a,t){return new si(this.property,this.value,t,_o({},a.transition,this.transition),a.now)},ai.prototype.untransitioned=function(){return new si(this.property,this.value,null,{},0)};var oi=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};oi.prototype.getValue=function(e){return td(this._values[e].value.value)},oi.prototype.setValue=function(a,t){this._values.hasOwnProperty(a)||(this._values[a]=new ai(this._values[a].property)),this._values[a].value=new ii(this._values[a].property,null===t?void 0:td(t))},oi.prototype.getTransition=function(e){return td(this._values[e].transition)},oi.prototype.setTransition=function(a,t){this._values.hasOwnProperty(a)||(this._values[a]=new ai(this._values[a].property)),this._values[a].transition=td(t)||void 0},oi.prototype.serialize=function(){for(var o={},t=0,l=Object.keys(this._values);t<l.length;t+=1){var r=l[t],n=this.getValue(r);void 0!==n&&(o[r]=n);var i=this.getTransition(r);void 0!==i&&(o[r+"-transition"]=i)}return o},oi.prototype.transitioned=function(o,t){for(var e=new ui(this._properties),r=0,l=Object.keys(this._values),i;r<l.length;r+=1)i=l[r],e._values[i]=this._values[i].transitioned(o,t._values[i]);return e},oi.prototype.untransitioned=function(){for(var a=new ui(this._properties),t=0,o=Object.keys(this._values),r;t<o.length;t+=1)r=o[t],a._values[r]=this._values[r].untransitioned();return a};var si=function(a,t,e,o,r){this.property=a,this.value=t,this.begin=r+o.delay||0,this.end=this.begin+o.duration||0,a.specification.transition&&(o.delay||o.duration)&&(this.prior=e)};si.prototype.possiblyEvaluate=function(l,t,e){var r=l.now||0,n=this.value.possiblyEvaluate(l,t,e),i=this.prior;if(i){if(r>this.end)return this.prior=null,n;if(this.value.isDataDriven())return this.prior=null,n;if(r<this.begin)return i.possiblyEvaluate(l,t,e);var a=(r-this.begin)/(this.end-this.begin);return this.property.interpolate(i.possiblyEvaluate(l,t,e),n,function(a){if(0>=a)return 0;if(1<=a)return 1;var t=a*a,e=t*a;return 4*(.5>a?e:3*(a-t)+e-.75)}(a))}return n};var ui=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};ui.prototype.possiblyEvaluate=function(o,t){for(var e=new ci(this._properties),r=0,l=Object.keys(this._values),i;r<l.length;r+=1)i=l[r],e._values[i]=this._values[i].possiblyEvaluate(o,t);return e},ui.prototype.hasTransition=function(){for(var a=0,o=Object.keys(this._values);a<o.length;a+=1)if(this._values[o[a]].prior)return!0;return!1};var li=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};li.prototype.getValue=function(e){return td(this._values[e].value)},li.prototype.setValue=function(a,t){this._values[a]=new ii(this._values[a].property,null===t?void 0:td(t))},li.prototype.serialize=function(){for(var a={},t=0,o=Object.keys(this._values);t<o.length;t+=1){var r=o[t],n=this.getValue(r);void 0!==n&&(a[r]=n)}return a},li.prototype.possiblyEvaluate=function(o,t){for(var e=new ci(this._properties),r=0,l=Object.keys(this._values),i;r<l.length;r+=1)i=l[r],e._values[i]=this._values[i].possiblyEvaluate(o,t);return e};var pi=function(a,t,e){this.property=a,this.value=t,this.parameters=e};pi.prototype.isConstant=function(){return"constant"===this.value.kind},pi.prototype.constantOr=function(e){return"constant"===this.value.kind?this.value.value:e},pi.prototype.evaluate=function(a,t,e,o){return this.property.evaluate(this.value,this.parameters,a,t,e,o)};var ci=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};ci.prototype.get=function(e){return this._values[e]};var hi=function(e){this.specification=e};hi.prototype.possiblyEvaluate=function(a,t){return a.expression.evaluate(t)},hi.prototype.interpolate=function(a,t,e){var o=Ue[this.specification.type];return o?o(a,t,e):a};var fi=function(a,t){this.specification=a,this.overrides=t};fi.prototype.possiblyEvaluate=function(a,t,e,o){return new pi(this,"constant"===a.expression.kind||"camera"===a.expression.kind?{kind:"constant",value:a.expression.evaluate(t,null,{},e,o)}:a.expression,t)},fi.prototype.interpolate=function(a,t,e){if("constant"!==a.value.kind||"constant"!==t.value.kind)return a;if(void 0===a.value.value||void 0===t.value.value)return new pi(this,{kind:"constant",value:void 0},a.parameters);var o=Ue[this.specification.type];return o?new pi(this,{kind:"constant",value:o(a.value.value,t.value.value,e)},a.parameters):a},fi.prototype.evaluate=function(o,t,e,r,n,i){return"constant"===o.kind?o.value:o.evaluate(t,e,r,n,i)};var yi=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(l,t,e,r){if(void 0===l.value)return new pi(this,{kind:"constant",value:void 0},t);if("constant"===l.expression.kind){var n=l.expression.evaluate(t,null,{},e,r),i="resolvedImage"===l.property.specification.type&&"string"!=typeof n?n.name:n,a=this._calculate(i,i,i,t);return new pi(this,{kind:"constant",value:a},t)}if("camera"===l.expression.kind){var o=this._calculate(l.expression.evaluate({zoom:t.zoom-1}),l.expression.evaluate({zoom:t.zoom}),l.expression.evaluate({zoom:t.zoom+1}),t);return new pi(this,{kind:"constant",value:o},t)}return new pi(this,l.expression,t)},t.prototype.evaluate=function(l,t,e,r,n,i){if("source"===l.kind){var a=l.evaluate(t,e,r,n,i);return this._calculate(a,a,a,t)}return"composite"===l.kind?this._calculate(l.evaluate({zoom:ya(t.zoom)-1},e,r),l.evaluate({zoom:ya(t.zoom)},e,r),l.evaluate({zoom:ya(t.zoom)+1},e,r),t):l.value},t.prototype._calculate=function(a,t,e,o){return o.zoom>o.zoomHistory.lastIntegerZoom?{from:a,to:t}:{from:e,to:t}},t.prototype.interpolate=function(e){return e},t}(fi),di=function(e){this.specification=e};di.prototype.possiblyEvaluate=function(a,t,e,o){if(void 0!==a.value){if("constant"===a.expression.kind){var r=a.expression.evaluate(t,null,{},e,o);return this._calculate(r,r,r,t)}return this._calculate(a.expression.evaluate(new ni(ya(t.zoom-1),t)),a.expression.evaluate(new ni(ya(t.zoom),t)),a.expression.evaluate(new ni(ya(t.zoom+1),t)),t)}},di.prototype._calculate=function(a,t,e,o){return o.zoom>o.zoomHistory.lastIntegerZoom?{from:a,to:t}:{from:e,to:t}},di.prototype.interpolate=function(e){return e};var mi=function(e){this.specification=e};mi.prototype.possiblyEvaluate=function(a,t,e,o){return!!a.expression.evaluate(t,null,{},e,o)},mi.prototype.interpolate=function(){return!1};var vi=function(a){for(var t in this.properties=a,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],a){var e=a[t];e.specification.overridable&&this.overridableProperties.push(t);var o=this.defaultPropertyValues[t]=new ii(e,void 0),r=this.defaultTransitionablePropertyValues[t]=new ai(e);this.defaultTransitioningPropertyValues[t]=r.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=o.possiblyEvaluate({})}};Tn("DataDrivenProperty",fi),Tn("DataConstantProperty",hi),Tn("CrossFadedDataDrivenProperty",yi),Tn("CrossFadedProperty",di),Tn("ColorRampProperty",mi);var gi=function(a){function t(t,o){if(a.call(this),this.id=t.id,this.type=t.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==t.type&&(this.metadata=(t=t).metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,"background"!==t.type&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),o.layout&&(this._unevaluatedLayout=new li(o.layout)),o.paint)){for(var r in this._transitionablePaint=new oi(o.paint),t.paint)this.setPaintProperty(r,t.paint[r],{validate:!1});for(var n in t.layout)this.setLayoutProperty(n,t.layout[n],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned()}}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)},t.prototype.setLayoutProperty=function(a,t,e){void 0===e&&(e={}),null!=t&&this._validate(zn,"layers."+this.id+".layout."+a,a,t,e)||("visibility"===a?this.visibility=t:this._unevaluatedLayout.setValue(a,t))},t.prototype.getPaintProperty=function(e){return ed(e,"-transition")?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)},t.prototype.setPaintProperty=function(l,t,e){if(void 0===e&&(e={}),null!=t&&this._validate(In,"layers."+this.id+".paint."+l,l,t,e))return!1;if(ed(l,"-transition"))return this._transitionablePaint.setTransition(l.slice(0,-11),t||void 0),!1;var d=this._transitionablePaint._values[l],n="cross-faded-data-driven"===d.property.specification["property-type"],i=d.value.isDataDriven(),a=d.value;this._transitionablePaint.setValue(l,t),this._handleSpecialPaintPropertyUpdate(l);var o=this._transitionablePaint._values[l].value;return o.isDataDriven()||i||n||this._handleOverridablePaintPropertyUpdate(l,a,o)},t.prototype._handleSpecialPaintPropertyUpdate=function(){},t.prototype._handleOverridablePaintPropertyUpdate=function(){return!1},t.prototype.isHidden=function(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility},t.prototype.updateTransitions=function(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(a,t){a.getCrossfadeParameters&&(this._crossfadeParameters=a.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(a,t)),this.paint=this._transitioningPaint.possiblyEvaluate(a,t)},t.prototype.serialize=function(){var e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),v(e,function(a,t){return void 0!==a&&("layout"!==t||Object.keys(a).length)&&("paint"!==t||Object.keys(a).length)})},t.prototype._validate=function(a,t,e,o,r){return void 0===r&&(r={}),(!r||!1!==r.validate)&&Sn(this,a.call(xn,{key:t,layerType:this.type,objectKey:e,value:o,styleSpec:kt,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var a in this.paint._values){var t=this.paint.get(a);if(t instanceof pi&&Mr(t.property.specification)&&("source"===t.value.kind||"composite"===t.value.kind)&&t.value.isStateDependent)return!0}return!1},t}(St),xi={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},bi=function(a,t){this._structArray=a,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},wi=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};wi.serialize=function(a,t){return a._trim(),t&&(a.isTransferred=!0,t.push(a.arrayBuffer)),{length:a.length,arrayBuffer:a.arrayBuffer}},wi.deserialize=function(a){var t=Object.create(this.prototype);return t.arrayBuffer=a.arrayBuffer,t.length=a.length,t.capacity=a.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},wi.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},wi.prototype.clear=function(){this.length=0},wi.prototype.resize=function(e){this.reserve(e),this.length=e},wi.prototype.reserve=function(a){if(a>this.capacity){this.capacity=ha(a,ya(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},wi.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var _i=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a,t){var e=this.length;return this.resize(e+1),this.emplace(e,a,t)},t.prototype.emplace=function(a,t,e){var o=2*a;return this.int16[o+0]=t,this.int16[o+1]=e,a},t}(wi);_i.prototype.bytesPerElement=4,Tn("StructArrayLayout2i4",_i);var ki=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a,t,e,o){var r=this.length;return this.resize(r+1),this.emplace(r,a,t,e,o)},t.prototype.emplace=function(o,t,e,r,n){var i=4*o;return this.int16[i+0]=t,this.int16[i+1]=e,this.int16[i+2]=r,this.int16[i+3]=n,o},t}(wi);ki.prototype.bytesPerElement=8,Tn("StructArrayLayout4i8",ki);var Ii=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(l,t,e,r,n,i){var a=this.length;return this.resize(a+1),this.emplace(a,l,t,e,r,n,i)},t.prototype.emplace=function(l,t,e,r,n,i,a){var o=6*l;return this.int16[o+0]=t,this.int16[o+1]=e,this.int16[o+2]=r,this.int16[o+3]=n,this.int16[o+4]=i,this.int16[o+5]=a,l},t}(wi);Ii.prototype.bytesPerElement=12,Tn("StructArrayLayout2i4i12",Ii);var zi=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(l,t,e,r,n,i){var a=this.length;return this.resize(a+1),this.emplace(a,l,t,e,r,n,i)},t.prototype.emplace=function(l,t,e,r,n,i,a){var o=4*l,s=8*l;return this.int16[o+0]=t,this.int16[o+1]=e,this.uint8[s+4]=r,this.uint8[s+5]=n,this.uint8[s+6]=i,this.uint8[s+7]=a,l},t}(wi);zi.prototype.bytesPerElement=8,Tn("StructArrayLayout2i4ub8",zi);var Ci=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(d,t,e,r,n,i,a,o,s,c){var l=this.length;return this.resize(l+1),this.emplace(l,d,t,e,r,n,i,a,o,s,c)},t.prototype.emplace=function(d,t,e,r,n,i,a,o,s,u,l){var p=9*d,c=18*d;return this.uint16[p+0]=t,this.uint16[p+1]=e,this.uint16[p+2]=r,this.uint16[p+3]=n,this.uint16[p+4]=i,this.uint16[p+5]=a,this.uint16[p+6]=o,this.uint16[p+7]=s,this.uint8[c+16]=u,this.uint8[c+17]=l,d},t}(wi);Ci.prototype.bytesPerElement=18,Tn("StructArrayLayout8ui2ub18",Ci);var Mi=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(d,t,e,r,n,i,a,o,s,u,l,p){var c=this.length;return this.resize(c+1),this.emplace(c,d,t,e,r,n,i,a,o,s,u,l,p)},t.prototype.emplace=function(d,t,e,r,n,i,a,o,s,u,l,p,c){var g=12*d;return this.int16[g+0]=t,this.int16[g+1]=e,this.int16[g+2]=r,this.int16[g+3]=n,this.uint16[g+4]=i,this.uint16[g+5]=a,this.uint16[g+6]=o,this.uint16[g+7]=s,this.int16[g+8]=u,this.int16[g+9]=l,this.int16[g+10]=p,this.int16[g+11]=c,d},t}(wi);Mi.prototype.bytesPerElement=24,Tn("StructArrayLayout4i4ui4i24",Mi);var Ei=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a,t,e){var o=this.length;return this.resize(o+1),this.emplace(o,a,t,e)},t.prototype.emplace=function(a,t,e,o){var r=3*a;return this.float32[r+0]=t,this.float32[r+1]=e,this.float32[r+2]=o,a},t}(wi);Ei.prototype.bytesPerElement=12,Tn("StructArrayLayout3f12",Ei);var Ti=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a){var t=this.length;return this.resize(t+1),this.emplace(t,a)},t.prototype.emplace=function(a,t){return this.uint32[1*a+0]=t,a},t}(wi);Ti.prototype.bytesPerElement=4,Tn("StructArrayLayout1ul4",Ti);var Pi=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(d,t,e,r,n,i,a,o,s){var c=this.length;return this.resize(c+1),this.emplace(c,d,t,e,r,n,i,a,o,s)},t.prototype.emplace=function(d,t,e,r,n,i,a,o,s,c){var l=10*d;return this.int16[l+0]=t,this.int16[l+1]=e,this.int16[l+2]=r,this.int16[l+3]=n,this.int16[l+4]=i,this.int16[l+5]=a,this.uint32[5*d+3]=o,this.uint16[l+8]=s,this.uint16[l+9]=c,d},t}(wi);Pi.prototype.bytesPerElement=20,Tn("StructArrayLayout6i1ul2ui20",Pi);var Bi=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(l,t,e,r,n,i){var a=this.length;return this.resize(a+1),this.emplace(a,l,t,e,r,n,i)},t.prototype.emplace=function(l,t,e,r,n,i,a){var o=6*l;return this.int16[o+0]=t,this.int16[o+1]=e,this.int16[o+2]=r,this.int16[o+3]=n,this.int16[o+4]=i,this.int16[o+5]=a,l},t}(wi);Bi.prototype.bytesPerElement=12,Tn("StructArrayLayout2i2i2i12",Bi);var Vi=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(o,t,e,r,n){var i=this.length;return this.resize(i+1),this.emplace(i,o,t,e,r,n)},t.prototype.emplace=function(l,t,e,r,n,i){var a=4*l,o=8*l;return this.float32[a+0]=t,this.float32[a+1]=e,this.float32[a+2]=r,this.int16[o+6]=n,this.int16[o+7]=i,l},t}(wi);Vi.prototype.bytesPerElement=16,Tn("StructArrayLayout2f1f2i16",Vi);var Fi=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a,t,e,o){var r=this.length;return this.resize(r+1),this.emplace(r,a,t,e,o)},t.prototype.emplace=function(l,t,e,r,n){var i=12*l,a=3*l;return this.uint8[i+0]=t,this.uint8[i+1]=e,this.float32[a+1]=r,this.float32[a+2]=n,l},t}(wi);Fi.prototype.bytesPerElement=12,Tn("StructArrayLayout2ub2f12",Fi);var Di=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a,t,e){var o=this.length;return this.resize(o+1),this.emplace(o,a,t,e)},t.prototype.emplace=function(a,t,e,o){var r=3*a;return this.uint16[r+0]=t,this.uint16[r+1]=e,this.uint16[r+2]=o,a},t}(wi);Di.prototype.bytesPerElement=6,Tn("StructArrayLayout3ui6",Di);var Li=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(g,t,e,r,n,i,a,o,s,u,l,p,c,h,f,y,d){var m=this.length;return this.resize(m+1),this.emplace(m,g,t,e,r,n,i,a,o,s,u,l,p,c,h,f,y,d)},t.prototype.emplace=function(_,t,e,r,n,i,a,o,s,u,l,p,c,h,f,y,d,m){var v=24*_,g=12*_,x=48*_;return this.int16[v+0]=t,this.int16[v+1]=e,this.uint16[v+2]=r,this.uint16[v+3]=n,this.uint32[g+2]=i,this.uint32[g+3]=a,this.uint32[g+4]=o,this.uint16[v+10]=s,this.uint16[v+11]=u,this.uint16[v+12]=l,this.float32[g+7]=p,this.float32[g+8]=c,this.uint8[x+36]=h,this.uint8[x+37]=f,this.uint8[x+38]=y,this.uint32[g+10]=d,this.int16[v+22]=m,_},t}(wi);Li.prototype.bytesPerElement=48,Tn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Li);var Ri=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(T,t,e,r,n,i,a,o,s,u,l,p,c,h,f,y,d,m,v,g,x,b,w,_,A,S,k,L){var E=this.length;return this.resize(E+1),this.emplace(E,T,t,e,r,n,i,a,o,s,u,l,p,c,h,f,y,d,m,v,g,x,b,w,_,A,S,k,L)},t.prototype.emplace=function(T,t,e,r,n,i,a,o,s,u,l,p,c,h,f,y,d,m,v,g,x,b,w,_,A,S,k,L,I){var C=34*T,P=17*T;return this.int16[C+0]=t,this.int16[C+1]=e,this.int16[C+2]=r,this.int16[C+3]=n,this.int16[C+4]=i,this.int16[C+5]=a,this.int16[C+6]=o,this.int16[C+7]=s,this.uint16[C+8]=u,this.uint16[C+9]=l,this.uint16[C+10]=p,this.uint16[C+11]=c,this.uint16[C+12]=h,this.uint16[C+13]=f,this.uint16[C+14]=y,this.uint16[C+15]=d,this.uint16[C+16]=m,this.uint16[C+17]=v,this.uint16[C+18]=g,this.uint16[C+19]=x,this.uint16[C+20]=b,this.uint16[C+21]=w,this.uint16[C+22]=_,this.uint32[P+12]=A,this.float32[P+13]=S,this.float32[P+14]=k,this.float32[P+15]=L,this.float32[P+16]=I,T},t}(wi);Ri.prototype.bytesPerElement=68,Tn("StructArrayLayout8i15ui1ul4f68",Ri);var Oi=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a){var t=this.length;return this.resize(t+1),this.emplace(t,a)},t.prototype.emplace=function(a,t){return this.float32[1*a+0]=t,a},t}(wi);Oi.prototype.bytesPerElement=4,Tn("StructArrayLayout1f4",Oi);var Ui=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a,t,e){var o=this.length;return this.resize(o+1),this.emplace(o,a,t,e)},t.prototype.emplace=function(a,t,e,o){var r=3*a;return this.int16[r+0]=t,this.int16[r+1]=e,this.int16[r+2]=o,a},t}(wi);Ui.prototype.bytesPerElement=6,Tn("StructArrayLayout3i6",Ui);var ji=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a,t,e){var o=this.length;return this.resize(o+1),this.emplace(o,a,t,e)},t.prototype.emplace=function(a,t,e,o){var r=4*a;return this.uint32[2*a+0]=t,this.uint16[r+2]=e,this.uint16[r+3]=o,a},t}(wi);ji.prototype.bytesPerElement=8,Tn("StructArrayLayout1ul2ui8",ji);var qi=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a,t){var e=this.length;return this.resize(e+1),this.emplace(e,a,t)},t.prototype.emplace=function(a,t,e){var o=2*a;return this.uint16[o+0]=t,this.uint16[o+1]=e,a},t}(wi);qi.prototype.bytesPerElement=4,Tn("StructArrayLayout2ui4",qi);var Ni=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a){var t=this.length;return this.resize(t+1),this.emplace(t,a)},t.prototype.emplace=function(a,t){return this.uint16[1*a+0]=t,a},t}(wi);Ni.prototype.bytesPerElement=2,Tn("StructArrayLayout1ui2",Ni);var Ki=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a,t){var e=this.length;return this.resize(e+1),this.emplace(e,a,t)},t.prototype.emplace=function(a,t,e){var o=2*a;return this.float32[o+0]=t,this.float32[o+1]=e,a},t}(wi);Ki.prototype.bytesPerElement=8,Tn("StructArrayLayout2f8",Ki);var Gi=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a,t,e,o){var r=this.length;return this.resize(r+1),this.emplace(r,a,t,e,o)},t.prototype.emplace=function(o,t,e,r,n){var i=4*o;return this.float32[i+0]=t,this.float32[i+1]=e,this.float32[i+2]=r,this.float32[i+3]=n,o},t}(wi);Gi.prototype.bytesPerElement=16,Tn("StructArrayLayout4f16",Gi);var Zi=function(a){function t(){a.apply(this,arguments)}a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t;var e={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return e.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},e.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},e.x1.get=function(){return this._structArray.int16[this._pos2+2]},e.y1.get=function(){return this._structArray.int16[this._pos2+3]},e.x2.get=function(){return this._structArray.int16[this._pos2+4]},e.y2.get=function(){return this._structArray.int16[this._pos2+5]},e.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},e.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},e.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},e.anchorPoint.get=function(){return new Qd(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,e),t}(bi);Zi.prototype.size=20;var Xi=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.get=function(e){return new Zi(this,e)},t}(Pi);Tn("CollisionBoxArray",Xi);var Ji=function(a){function t(){a.apply(this,arguments)}a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t;var e={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return e.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},e.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},e.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},e.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},e.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},e.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},e.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},e.segment.get=function(){return this._structArray.uint16[this._pos2+10]},e.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},e.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},e.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},e.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},e.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},e.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},e.placedOrientation.set=function(e){this._structArray.uint8[this._pos1+37]=e},e.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},e.hidden.set=function(e){this._structArray.uint8[this._pos1+38]=e},e.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},e.crossTileID.set=function(e){this._structArray.uint32[this._pos4+10]=e},e.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,e),t}(bi);Ji.prototype.size=48;var Hi=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.get=function(e){return new Ji(this,e)},t}(Li);Tn("PlacedSymbolArray",Hi);var Yi=function(a){function t(){a.apply(this,arguments)}a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t;var e={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return e.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},e.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},e.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},e.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},e.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},e.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},e.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},e.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},e.key.get=function(){return this._structArray.uint16[this._pos2+8]},e.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},e.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},e.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},e.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},e.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},e.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},e.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},e.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},e.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},e.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},e.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},e.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},e.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},e.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},e.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},e.crossTileID.set=function(e){this._structArray.uint32[this._pos4+12]=e},e.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},e.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},e.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},e.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,e),t}(bi);Yi.prototype.size=68;var $i=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.get=function(e){return new Yi(this,e)},t}(Ri);Tn("SymbolInstanceArray",$i);var Wi=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getoffsetX=function(e){return this.float32[1*e+0]},t}(Oi);Tn("GlyphOffsetArray",Wi);var Qi=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getx=function(e){return this.int16[3*e+0]},t.prototype.gety=function(e){return this.int16[3*e+1]},t.prototype.gettileUnitDistanceFromAnchor=function(e){return this.int16[3*e+2]},t}(Ui);Tn("SymbolLineVertexArray",Qi);var ta=function(a){function t(){a.apply(this,arguments)}a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t;var e={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return e.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},e.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},e.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,e),t}(bi);ta.prototype.size=8;var ea=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.get=function(e){return new ta(this,e)},t}(ji);Tn("FeatureIndexArray",ea);var ra=Qn([{name:"a_pos",components:2,type:"Int16"}],4).members,na=function(e){void 0===e&&(e=[]),this.segments=e};na.prototype.prepareSegment=function(a,t,e,o){var r=this.segments[this.segments.length-1];return a>na.MAX_VERTEX_ARRAY_LENGTH&&ad("Max vertices per segment is "+na.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+a),(!r||r.vertexLength+a>na.MAX_VERTEX_ARRAY_LENGTH||r.sortKey!==o)&&(r={vertexOffset:t.length,primitiveOffset:e.length,vertexLength:0,primitiveLength:0},void 0!==o&&(r.sortKey=o),this.segments.push(r)),r},na.prototype.get=function(){return this.segments},na.prototype.destroy=function(){for(var a=0,o=this.segments,e;a<o.length;a+=1)for(var i in e=o[a],e.vaos)e.vaos[i].destroy()},na.simpleSegment=function(a,t,e,o){return new na([{vertexOffset:a,primitiveOffset:t,vertexLength:e,primitiveLength:o,vaos:{},sortKey:0}])},na.MAX_VERTEX_ARRAY_LENGTH=pa(2,16)-1,Tn("SegmentVector",na);var ia=Qn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint8"},{name:"a_pixel_ratio_to",components:1,type:"Uint8"}]),oa=t(function(e){e.exports=function(d,t){var e,c,p,g,m,h,y,f;for(c=d.length-(e=3&d.length),p=t,m=3432918353,h=461845907,f=0;f<c;)y=255&d.charCodeAt(f)|(255&d.charCodeAt(++f))<<8|(255&d.charCodeAt(++f))<<16|(255&d.charCodeAt(++f))<<24,++f,p=27492+(65535&(g=4294967295&5*(65535&(p=(p^=y=4294967295&(65535&(y=(y=4294967295&(65535&y)*m+((65535&(y>>>16)*m)<<16))<<15|y>>>17))*h+((65535&(y>>>16)*h)<<16))<<13|p>>>19))+((65535&5*(p>>>16))<<16)))+((65535&58964+(g>>>16))<<16);switch(y=0,e){case 3:y^=(255&d.charCodeAt(f+2))<<16;case 2:y^=(255&d.charCodeAt(f+1))<<8;case 1:p^=y=4294967295&(65535&(y=(y=4294967295&(65535&(y^=255&d.charCodeAt(f)))*m+((65535&(y>>>16)*m)<<16))<<15|y>>>17))*h+((65535&(y>>>16)*h)<<16);}return p^=d.length,p=4294967295&2246822507*(65535&(p^=p>>>16))+((65535&2246822507*(p>>>16))<<16),p=4294967295&3266489909*(65535&(p^=p>>>13))+((65535&3266489909*(p>>>16))<<16),(p^=p>>>16)>>>0}}),sa=t(function(e){e.exports=function(o,t){for(var e=o.length,l=t^e,s=0,d;4<=e;)d=1540483477*(65535&(d=255&o.charCodeAt(s)|(255&o.charCodeAt(++s))<<8|(255&o.charCodeAt(++s))<<16|(255&o.charCodeAt(++s))<<24))+((65535&1540483477*(d>>>16))<<16),l=1540483477*(65535&l)+((65535&1540483477*(l>>>16))<<16)^(d=1540483477*(65535&(d^=d>>>24))+((65535&1540483477*(d>>>16))<<16)),e-=4,++s;switch(e){case 3:l^=(255&o.charCodeAt(s+2))<<16;case 2:l^=(255&o.charCodeAt(s+1))<<8;case 1:l=1540483477*(65535&(l^=255&o.charCodeAt(s)))+((65535&1540483477*(l>>>16))<<16);}return l=1540483477*(65535&(l^=l>>>13))+((65535&1540483477*(l>>>16))<<16),(l^=l>>>15)>>>0}}),_c=oa;_c.murmur3=oa,_c.murmur2=sa;var la=function(){this.ids=[],this.positions=[],this.indexed=!1};la.prototype.add=function(a,t,e,o){this.ids.push(aa(a)),this.positions.push(t,e,o)},la.prototype.getPositions=function(o){for(var t=aa(o),e=0,l=this.ids.length-1,s;e<l;)s=e+l>>1,this.ids[s]>=t?l=s:e=s+1;for(var d=[];this.ids[e]===t;)d.push({index:this.positions[3*e],start:this.positions[3*e+1],end:this.positions[3*e+2]}),e++;return d},la.serialize=function(a,t){var e=new Float64Array(a.ids),o=new Uint32Array(a.positions);return function l(t,e,r,d){for(;r<d;){for(var c=t[r+d>>1],a=r-1,p=d+1;;){do a++;while(t[a]<c);do p--;while(t[p]>c);if(a>=p)break;fa(t,a,p),fa(e,3*a,3*p),fa(e,3*a+1,3*p+1),fa(e,3*a+2,3*p+2)}p-r<d-p?(l(t,e,r,p),r=p+1):(l(t,e,p+1,d),d=p)}}(e,o,0,e.length-1),t&&t.push(e.buffer,o.buffer),{ids:e,positions:o}},la.deserialize=function(a){var t=new la;return t.ids=a.ids,t.positions=a.positions,t.indexed=!0,t};pa(2,53)-1;Tn("FeaturePositionMap",la);var ca=function(a,t){this.gl=a.gl,this.location=t},da=function(a){function t(t,e){a.call(this,t,e),this.current=0}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.set=function(e){this.current!==e&&(this.current=e,this.gl.uniform1i(this.location,e))},t}(ca),bc=function(a){function t(t,e){a.call(this,t,e),this.current=0}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.set=function(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))},t}(ca),va=function(a){function t(t,e){a.call(this,t,e),this.current=[0,0]}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.set=function(e){e[0]===this.current[0]&&e[1]===this.current[1]||(this.current=e,this.gl.uniform2f(this.location,e[0],e[1]))},t}(ca),vc=function(a){function t(t,e){a.call(this,t,e),this.current=[0,0,0]}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.set=function(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]||(this.current=e,this.gl.uniform3f(this.location,e[0],e[1],e[2]))},t}(ca),xa=function(a){function t(t,e){a.call(this,t,e),this.current=[0,0,0,0]}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.set=function(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))},t}(ca),ba=function(a){function t(t,e){a.call(this,t,e),this.current=Yt.transparent}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.set=function(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))},t}(ca),wa=new Float32Array(16),_a=function(a){function t(t,e){a.call(this,t,e),this.current=wa}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.set=function(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(var t=1;16>t;t++)if(a[t]!==this.current[t]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}},t}(ca),Aa=function(a,t,e){this.value=a,this.uniformNames=t.map(function(e){return"u_"+e}),this.type=e};Aa.prototype.setUniform=function(a,t,e){a.set(e.constantOr(this.value))},Aa.prototype.getBinding=function(a,t){return"color"===this.type?new ba(a,t):new bc(a,t)};var ka=function(a,t){this.uniformNames=t.map(function(e){return"u_"+e}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};ka.prototype.setConstantPatternPositions=function(a,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=a.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=a.tlbr},ka.prototype.setUniform=function(a,t,e,o){var r="u_pattern_to"===o?this.patternTo:"u_pattern_from"===o?this.patternFrom:"u_pixel_ratio_to"===o?this.pixelRatioTo:"u_pixel_ratio_from"===o?this.pixelRatioFrom:null;r&&a.set(r)},ka.prototype.getBinding=function(a,t,e){return"u_pattern"===e.substr(0,9)?new xa(a,t):new bc(a,t)};var Ia=function(a,t,e,o){this.expression=a,this.type=e,this.maxValue=0,this.paintVertexAttributes=t.map(function(a){return{name:"a_"+a,type:"Float32",components:"color"===e?2:1,offset:0}}),this.paintVertexArray=new o};Ia.prototype.populatePaintArray=function(l,t,e,r,n){var i=this.paintVertexArray.length,a=this.expression.evaluate(new ni(0),t,{},r,[],n);this.paintVertexArray.resize(l),this._setPaintValue(i,l,a)},Ia.prototype.updatePaintArray=function(a,t,e,o){var r=this.expression.evaluate({zoom:0},e,o);this._setPaintValue(a,t,r)},Ia.prototype._setPaintValue=function(o,t,e){if("color"===this.type)for(var r=dd(e),n=o;n<t;n++)this.paintVertexArray.emplace(n,r[0],r[1]);else{for(var l=o;l<t;l++)this.paintVertexArray.emplace(l,e);this.maxValue=ha(this.maxValue,ma(e))}},Ia.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ia.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var za=function(o,t,e,r,n,i){this.expression=o,this.uniformNames=t.map(function(e){return"u_"+e+"_t"}),this.type=e,this.useIntegerZoom=r,this.zoom=n,this.maxValue=0,this.paintVertexAttributes=t.map(function(a){return{name:"a_"+a,type:"Float32",components:"color"===e?4:2,offset:0}}),this.paintVertexArray=new i};za.prototype.populatePaintArray=function(l,t,e,r,n){var i=this.expression.evaluate(new ni(this.zoom),t,{},r,[],n),a=this.expression.evaluate(new ni(this.zoom+1),t,{},r,[],n),o=this.paintVertexArray.length;this.paintVertexArray.resize(l),this._setPaintValue(o,l,i,a)},za.prototype.updatePaintArray=function(o,t,e,r){var n=this.expression.evaluate({zoom:this.zoom},e,r),i=this.expression.evaluate({zoom:this.zoom+1},e,r);this._setPaintValue(o,t,n,i)},za.prototype._setPaintValue=function(l,t,e,r){if("color"===this.type)for(var n=dd(e),i=dd(r),a=l;a<t;a++)this.paintVertexArray.emplace(a,n[0],n[1],i[0],i[1]);else{for(var d=l;d<t;d++)this.paintVertexArray.emplace(d,e,r);this.maxValue=ha(this.maxValue,ma(e),ma(r))}},za.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},za.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},za.prototype.setUniform=function(a,t){var e=this.useIntegerZoom?ya(t.zoom):t.zoom,o=io(this.expression.interpolationFactor(e,this.zoom,this.zoom+1),0,1);a.set(o)},za.prototype.getBinding=function(a,t){return new bc(a,t)};var Ca=function(o,t,e,r,n,i){this.expression=o,this.type=t,this.useIntegerZoom=e,this.zoom=r,this.layerId=i,this.zoomInPaintVertexArray=new n,this.zoomOutPaintVertexArray=new n};Ca.prototype.populatePaintArray=function(a,t,e){var o=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(a),this.zoomOutPaintVertexArray.resize(a),this._setPaintValues(o,a,t.patterns&&t.patterns[this.layerId],e)},Ca.prototype.updatePaintArray=function(a,t,e,o,r){this._setPaintValues(a,t,e.patterns&&e.patterns[this.layerId],r)},Ca.prototype._setPaintValues=function(l,t,e,r){if(r&&e){var n=r[e.min],i=r[e.mid],a=r[e.max];if(n&&i&&a)for(var o=l;o<t;o++)this.zoomInPaintVertexArray.emplace(o,i.tl[0],i.tl[1],i.br[0],i.br[1],n.tl[0],n.tl[1],n.br[0],n.br[1],i.pixelRatio,n.pixelRatio),this.zoomOutPaintVertexArray.emplace(o,i.tl[0],i.tl[1],i.br[0],i.br[1],a.tl[0],a.tl[1],a.br[0],a.br[1],i.pixelRatio,a.pixelRatio)}},Ca.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,ia.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,ia.members,this.expression.isStateDependent))},Ca.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Ma=function(d,t,e,r){this.binders={},this.layoutAttributes=r,this._buffers=[];var n=[];for(var i in d.paint._values)if(e(i)){var a=d.paint.get(i);if(a instanceof pi&&Mr(a.property.specification)){var o=Sa(i,d.type),s=a.value,u=a.property.specification.type,l=a.property.useIntegerZoom,p=a.property.specification["property-type"],c="cross-faded"===p||"cross-faded-data-driven"===p;if("constant"===s.kind)this.binders[i]=c?new ka(s.value,o):new Aa(s.value,o,u),n.push("/u_"+i);else if("source"===s.kind||c){var g=Pa(i,u,"source");this.binders[i]=c?new Ca(s,u,l,t,g,d.id):new Ia(s,o,u,g),n.push("/a_"+i)}else{var m=Pa(i,u,"composite");this.binders[i]=new za(s,o,u,l,t,m),n.push("/z_"+i)}}}this.cacheKey=n.sort().join("")};Ma.prototype.getMaxValue=function(a){var t=this.binders[a];return t instanceof Ia||t instanceof za?t.maxValue:0},Ma.prototype.populatePaintArrays=function(l,t,e,r,n){for(var i in this.binders){var a=this.binders[i];(a instanceof Ia||a instanceof za||a instanceof Ca)&&a.populatePaintArray(l,t,e,r,n)}},Ma.prototype.setConstantPatternPositions=function(a,t){for(var e in this.binders){var o=this.binders[e];o instanceof ka&&o.setConstantPatternPositions(a,t)}},Ma.prototype.updatePaintArrays=function(d,t,e,r,n){var i=!1;for(var g in d)for(var o=0,m=t.getPositions(g);o<m.length;o+=1){var u=m[o],l=e.feature(u.index);for(var p in this.binders){var c=this.binders[p];if((c instanceof Ia||c instanceof za||c instanceof Ca)&&!0===c.expression.isStateDependent){var h=r.paint.get(p);c.expression=h.value,c.updatePaintArray(u.start,u.end,l,d[g],n),i=!0}}}return i},Ma.prototype.defines=function(){var a=[];for(var t in this.binders){var e=this.binders[t];(e instanceof Aa||e instanceof ka)&&a.push.apply(a,e.uniformNames.map(function(e){return"#define HAS_UNIFORM_"+e}))}return a},Ma.prototype.getPaintVertexBuffers=function(){return this._buffers},Ma.prototype.getUniforms=function(l,t){var e=[];for(var r in this.binders){var n=this.binders[r];if(n instanceof Aa||n instanceof ka||n instanceof za)for(var i=0,d=n.uniformNames,o;i<d.length;i+=1)if(o=d[i],t[o]){var c=n.getBinding(l,t[o],o);e.push({name:o,property:r,binding:c})}}return e},Ma.prototype.setUniforms=function(l,t,e,r){for(var n=0,d=t;n<d.length;n+=1){var a=d[n],o=a.name,s=a.property;this.binders[s].setUniform(a.binding,r,e.get(s),o)}},Ma.prototype.updatePaintBuffers=function(a){for(var t in this._buffers=[],this.binders){var e=this.binders[t];if(a&&e instanceof Ca){var o=2===a.fromScale?e.zoomInPaintVertexBuffer:e.zoomOutPaintVertexBuffer;o&&this._buffers.push(o)}else(e instanceof Ia||e instanceof za)&&e.paintVertexBuffer&&this._buffers.push(e.paintVertexBuffer)}},Ma.prototype.upload=function(a){for(var t in this.binders){var e=this.binders[t];(e instanceof Ia||e instanceof za||e instanceof Ca)&&e.upload(a)}this.updatePaintBuffers()},Ma.prototype.destroy=function(){for(var a in this.binders){var t=this.binders[a];(t instanceof Ia||t instanceof za||t instanceof Ca)&&t.destroy()}};var Ea=function(l,t,e,r){void 0===r&&(r=function(){return!0}),this.programConfigurations={};for(var s=0,d=t,a;s<d.length;s+=1)a=d[s],this.programConfigurations[a.id]=new Ma(a,e,r,l);this.needsUpload=!1,this._featureMap=new la,this._bufferOffset=0};Ea.prototype.populatePaintArrays=function(l,t,e,r,n,i){for(var a in this.programConfigurations)this.programConfigurations[a].populatePaintArrays(l,t,r,n,i);void 0!==t.id&&this._featureMap.add(t.id,e,this._bufferOffset,l),this._bufferOffset=l,this.needsUpload=!0},Ea.prototype.updatePaintArrays=function(l,t,e,r){for(var n=0,s=e,a;n<s.length;n+=1)a=s[n],this.needsUpload=this.programConfigurations[a.id].updatePaintArrays(l,this._featureMap,t,a,r)||this.needsUpload},Ea.prototype.get=function(e){return this.programConfigurations[e]},Ea.prototype.upload=function(a){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(a);this.needsUpload=!1}},Ea.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},Tn("ConstantBinder",Aa),Tn("CrossFadedConstantBinder",ka),Tn("SourceExpressionBinder",Ia),Tn("CrossFadedCompositeBinder",Ca),Tn("CompositeExpressionBinder",za),Tn("ProgramConfiguration",Ma,{omit:["_buffers"]}),Tn("ProgramConfigurationSet",Ea);var Ta={min:-1*pa(2,14),max:pa(2,14)-1},Va=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new _i,this.indexArray=new Di,this.segments=new na,this.programConfigurations=new Ea(ra,e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id})};Va.prototype.populate=function(k,t,e){var r=this.layers[0],n=[],i=null;"circle"===r.type&&(i=r.layout.get("circle-sort-key"));for(var T=0,A=k;T<A.length;T+=1){var s=A[T],u=s.feature,l=s.id,p=s.index,c=s.sourceLayerIndex,h=this.layers[0]._featureFilter.needGeometry,f={type:u.type,id:l,properties:u.properties,geometry:h?Ba(u):[]};if(this.layers[0]._featureFilter.filter(new ni(this.zoom),f,e)){h||(f.geometry=Ba(u));var y=i?i.evaluate(f,{},e):void 0;n.push({id:l,properties:u.properties,type:u.type,sourceLayerIndex:c,index:p,geometry:f.geometry,patterns:{},sortKey:y})}}i&&n.sort(function(a,t){return a.sortKey-t.sortKey});for(var d=0,S=n;d<S.length;d+=1){var v=S[d],g=v.geometry,x=v.index,b=v.sourceLayerIndex,w=k[x].feature;this.addFeature(v,g,x,e),t.featureIndex.insert(w,g,x,b,this.index)}},Va.prototype.update=function(a,t,e){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,t,this.stateDependentLayers,e)},Va.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Va.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Va.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ra),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Va.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Va.prototype.addFeature=function(d,t,e,r){for(var n=0,g=t;n<g.length;n+=1)for(var a=0,m=g[n];a<m.length;a+=1){var s=m[a],u=s.x,l=s.y;if(!(0>u||8192<=u||0>l||8192<=l)){var p=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,d.sortKey),c=p.vertexLength;Fa(this.layoutVertexArray,u,l,-1,-1),Fa(this.layoutVertexArray,u,l,1,-1),Fa(this.layoutVertexArray,u,l,1,1),Fa(this.layoutVertexArray,u,l,-1,1),this.indexArray.emplaceBack(c,c+1,c+2),this.indexArray.emplaceBack(c,c+3,c+2),p.vertexLength+=4,p.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,d,e,{},r)},Tn("CircleBucket",Va,{omit:["layers"]});var La=new vi({"circle-sort-key":new fi(kt.layout_circle["circle-sort-key"])}),Wa={paint:new vi({"circle-radius":new fi(kt.paint_circle["circle-radius"]),"circle-color":new fi(kt.paint_circle["circle-color"]),"circle-blur":new fi(kt.paint_circle["circle-blur"]),"circle-opacity":new fi(kt.paint_circle["circle-opacity"]),"circle-translate":new hi(kt.paint_circle["circle-translate"]),"circle-translate-anchor":new hi(kt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new hi(kt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new hi(kt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new fi(kt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new fi(kt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new fi(kt.paint_circle["circle-stroke-opacity"])}),layout:La},Qa="undefined"==typeof Float32Array?Array:Float32Array;$d||($d=function(){for(var a=arguments,t=0,o=arguments.length;o--;)t+=a[o]*a[o];return We(t)});var to;to=new Qa(3),Qa!=Float32Array&&(to[0]=0,to[1]=0,to[2]=0),function(){var e=new Qa(4);Qa!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var wc=(function(){var e=new Qa(2);Qa!=Float32Array&&(e[0]=0,e[1]=0)}(),function(a){function t(t){a.call(this,t,Wa)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.createBucket=function(e){return new Va(e)},t.prototype.queryRadius=function(a){var t=a;return Ja("circle-radius",this,t)+Ja("circle-stroke-width",this,t)+Ha(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(_,t,e,r,n,i,a,o){for(var s=Ya(_,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),i.angle,a),u=this.paint.get("circle-radius").evaluate(t,e)+this.paint.get("circle-stroke-width").evaluate(t,e),l="map"===this.paint.get("circle-pitch-alignment"),p=l?s:function(a,o){return a.map(function(e){return ao(e,o)})}(s,o),c=l?u*a:u,h=0,w=r;h<w.length;h+=1)for(var y=0,k=w[h];y<k.length;y+=1){var m=k[y],v=l?m:ao(m,o),g=c,T=ro([],[m.x,m.y,0,1],o);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?g*=T[3]/i.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(g*=i.cameraToCenterDistance/T[3]),Ra(p,v,g))return!0}return!1},t}(gi)),oo=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t}(Va);Tn("HeatmapBucket",oo,{omit:["layers"]});var uo=function(a,t){so(this,a,1,t)};uo.prototype.resize=function(e){lo(this,e,1)},uo.prototype.clone=function(){return new uo({width:this.width,height:this.height},new Uint8Array(this.data))},uo.copy=function(a,t,e,o,r){po(a,t,e,o,r,1)};var ho=function(a,t){so(this,a,4,t)};ho.prototype.resize=function(e){lo(this,e,4)},ho.prototype.replace=function(a,t){t?this.data.set(a):this.data=a instanceof Uint8ClampedArray?new Uint8Array(a.buffer):a},ho.prototype.clone=function(){return new ho({width:this.width,height:this.height},new Uint8Array(this.data))},ho.copy=function(a,t,e,o,r){po(a,t,e,o,r,4)},Tn("AlphaImage",uo),Tn("RGBAImage",ho);var fo={paint:new vi({"heatmap-radius":new fi(kt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new fi(kt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new hi(kt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new mi(kt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new hi(kt.paint_heatmap["heatmap-opacity"])})},yo=function(a){function t(t){a.call(this,t,fo),this._updateColorRamp()}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.createBucket=function(e){return new oo(e)},t.prototype._handleSpecialPaintPropertyUpdate=function(e){"heatmap-color"===e&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=co(this._transitionablePaint._values["heatmap-color"].value.expression,"heatmapDensity"),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},t}(gi),vo={paint:new vi({"hillshade-illumination-direction":new hi(kt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new hi(kt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new hi(kt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new hi(kt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new hi(kt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new hi(kt.paint_hillshade["hillshade-accent-color"])})},go=function(a){function t(t){a.call(this,t,vo)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},t}(gi),xo=Qn([{name:"a_pos",components:2,type:"Int16"}],4).members,bo=mo;mo.deviation=function(d,t,e,r){var n=t&&t.length,i=ma(Xo(d,0,n?t[0]*e:d.length,e));if(n)for(var g=0,m=t.length;g<m;g++)i-=ma(Xo(d,t[g]*e,g<m-1?t[g+1]*e:d.length,e));var s=0;for(g=0;g<r.length;g+=3){var h=r[g]*e,l=r[g+1]*e,p=r[g+2]*e;s+=ma((d[h]-d[p])*(d[l+1]-d[h+1])-(d[h]-d[l])*(d[p+1]-d[h+1]))}return 0===i&&0===s?0:ma((s-i)/i)},mo.flatten=function(l){for(var t=l[0][0].length,e={vertices:[],holes:[],dimensions:t},r=0,s=0;s<l.length;s++){for(var d=0;d<l[s].length;d++)for(var c=0;c<t;c++)e.vertices.push(l[s][d][c]);0<s&&e.holes.push(r+=l[s-1].length)}return e},bo.default=mo;var wo=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new _i,this.indexArray=new Di,this.indexArray2=new qi,this.programConfigurations=new Ea(xo,e.layers,e.zoom),this.segments=new na,this.segments2=new na,this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id})};wo.prototype.populate=function(_,t,e){this.hasPattern=Qo("fill",this.layers,t);for(var r=this.layers[0].layout.get("fill-sort-key"),n=[],i=0,k=_;i<k.length;i+=1){var o=k[i],s=o.feature,u=o.id,l=o.index,p=o.sourceLayerIndex,c=this.layers[0]._featureFilter.needGeometry,h={type:s.type,id:u,properties:s.properties,geometry:c?Ba(s):[]};if(this.layers[0]._featureFilter.filter(new ni(this.zoom),h,e)){c||(h.geometry=Ba(s));var f=r?r.evaluate(h,{},e,t.availableImages):void 0;n.push({id:u,properties:s.properties,type:s.type,sourceLayerIndex:p,index:l,geometry:h.geometry,patterns:{},sortKey:f})}}r&&n.sort(function(a,t){return a.sortKey-t.sortKey});for(var y=0,T=n;y<T.length;y+=1){var m=T[y],v=m.geometry,g=m.index,x=m.sourceLayerIndex;if(this.hasPattern){var b=ts("fill",this.layers,m,this.zoom,t);this.patternFeatures.push(b)}else this.addFeature(m,v,g,e,{});t.featureIndex.insert(_[g].feature,v,g,x,this.index)}},wo.prototype.update=function(a,t,e){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,t,this.stateDependentLayers,e)},wo.prototype.addFeatures=function(o,t,e){for(var r=0,l=this.patternFeatures,i;r<l.length;r+=1)i=l[r],this.addFeature(i,i.geometry,i.index,t,e)},wo.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},wo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},wo.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,xo),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},wo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},wo.prototype.addFeature=function(k,t,e,r,n){for(var i=0,T=$o(t,500);i<T.length;i+=1){for(var o=T[i],s=0,A=0,S=o;A<S.length;A+=1)s+=S[A].length;for(var p=this.segments.prepareSegment(s,this.layoutVertexArray,this.indexArray),c=p.vertexLength,h=[],f=[],y=0,C=o,m;y<C.length;y+=1)if(m=C[y],0!==m.length){m!==o[0]&&f.push(h.length/2);var L=this.segments2.prepareSegment(m.length,this.layoutVertexArray,this.indexArray2),g=L.vertexLength;this.layoutVertexArray.emplaceBack(m[0].x,m[0].y),this.indexArray2.emplaceBack(g+m.length-1,g),h.push(m[0].x),h.push(m[0].y);for(var x=1;x<m.length;x++)this.layoutVertexArray.emplaceBack(m[x].x,m[x].y),this.indexArray2.emplaceBack(g+x-1,g+x),h.push(m[x].x),h.push(m[x].y);L.vertexLength+=m.length,L.primitiveLength+=m.length}for(var E=bo(h,f),w=0;w<E.length;w+=3)this.indexArray.emplaceBack(c+E[w],c+E[w+1],c+E[w+2]);p.vertexLength+=s,p.primitiveLength+=E.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,k,e,n,r)},Tn("FillBucket",wo,{omit:["layers","patternFeatures"]});var rs=new vi({"fill-sort-key":new fi(kt.layout_fill["fill-sort-key"])}),ns={paint:new vi({"fill-antialias":new hi(kt.paint_fill["fill-antialias"]),"fill-opacity":new fi(kt.paint_fill["fill-opacity"]),"fill-color":new fi(kt.paint_fill["fill-color"]),"fill-outline-color":new fi(kt.paint_fill["fill-outline-color"]),"fill-translate":new hi(kt.paint_fill["fill-translate"]),"fill-translate-anchor":new hi(kt.paint_fill["fill-translate-anchor"]),"fill-pattern":new yi(kt.paint_fill["fill-pattern"])}),layout:rs},is=function(a){function t(t){a.call(this,t,ns)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.recalculate=function(t,e){a.prototype.recalculate.call(this,t,e);var o=this.paint._values["fill-outline-color"];"constant"===o.value.kind&&void 0===o.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(e){return new wo(e)},t.prototype.queryRadius=function(){return Ha(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(l,t,e,r,n,i,a){return Oa(Ya(l,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),i.angle,a),r)},t.prototype.isTileClipped=function(){return!0},t}(gi),as=Qn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,os=es;es.types=["Unknown","Point","LineString","Polygon"],es.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var t=i.readVarint()+i.pos,r=1,d=0,c=0,p=0,g=[],u;i.pos<t;){if(0>=d){var m=i.readVarint();r=7&m,d=m>>3}if(d--,1==r||2===r)c+=i.readSVarint(),p+=i.readSVarint(),1===r&&(u&&g.push(u),u=[]),u.push(new Qd(c,p));else{if(7!==r)throw new Error("unknown command "+r);u&&u.push(u[0].clone())}}return u&&g.push(u),g},es.prototype.bbox=function(){var d=this._pbf;d.pos=this._geometry;for(var t=d.readVarint()+d.pos,e=1,c=0,g=0,m=0,h=1/0,y=-1/0,f=1/0,x=-1/0;d.pos<t;){if(0>=c){var _=d.readVarint();e=7&_,c=_>>3}if(c--,1==e||2===e)(g+=d.readSVarint())<h&&(h=g),g>y&&(y=g),(m+=d.readSVarint())<f&&(f=m),m>x&&(x=m);else if(7!==e)throw new Error("unknown command "+e)}return[h,f,y,x]},es.prototype.toGeoJSON=function(d,t,e){function r(i){for(var t=0,n;t<i.length;t++)n=i[t],i[t]=[360*(n.x+a)/p-180,360/Ke*ga(g((180-360*(n.y+o)/p)*Ke/180))-90]}var p=this.extent*pa(2,e),a=this.extent*d,o=this.extent*t,s=this.loadGeometry(),m=es.types[this.type],y,f;switch(this.type){case 1:var x=[];for(y=0;y<s.length;y++)x[y]=s[y][0];r(s=x);break;case 2:for(y=0;y<s.length;y++)r(s[y]);break;case 3:for(s=function(l){var t=l.length;if(1>=t)return[l];for(var e=[],i=0,s,d,c;i<t;i++)c=ls(l[i]),0!==c&&(void 0===d&&(d=0>c),d===0>c?(s&&e.push(s),s=[l[i]]):s.push(l[i]));return s&&e.push(s),e}(s),y=0;y<s.length;y++)for(f=0;f<s[y].length;f++)r(s[y][f]);}1===s.length?s=s[0]:m="Multi"+m;var c={type:"Feature",geometry:{type:m,coordinates:s},properties:this.properties};return"id"in this&&(c.id=this.id),c};var ss=ps;ps.prototype.feature=function(a){if(0>a||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var t=this._pbf.readVarint()+this._pbf.pos;return new os(this._pbf,t,this.extent,this._keys,this._values)};var cs={VectorTile:function(a,t){this.layers=a.readFields(fs,{},t)},VectorTileFeature:os,VectorTileLayer:ss},ds=cs.VectorTileFeature.types,ms=pa(2,13),vs=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Ii,this.indexArray=new Di,this.programConfigurations=new Ea(as,e.layers,e.zoom),this.segments=new na,this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id})};vs.prototype.populate=function(d,t,e){this.features=[],this.hasPattern=Qo("fill-extrusion",this.layers,t);for(var r=0,g=d;r<g.length;r+=1){var i=g[r],a=i.feature,o=i.id,s=i.index,u=i.sourceLayerIndex,l=this.layers[0]._featureFilter.needGeometry,p={type:a.type,id:o,properties:a.properties,geometry:l?Ba(a):[]};if(this.layers[0]._featureFilter.filter(new ni(this.zoom),p,e)){var c={id:o,sourceLayerIndex:u,index:s,geometry:l?p.geometry:Ba(a),properties:a.properties,type:a.type,patterns:{}};void 0!==a.id&&(c.id=a.id),this.hasPattern?this.features.push(ts("fill-extrusion",this.layers,c,this.zoom,t)):this.addFeature(c,c.geometry,s,e,{}),t.featureIndex.insert(a,c.geometry,s,u,this.index,!0)}}},vs.prototype.addFeatures=function(o,t,e){for(var r=0,l=this.features,i;r<l.length;r+=1)i=l[r],this.addFeature(i,i.geometry,i.index,t,e)},vs.prototype.update=function(a,t,e){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,t,this.stateDependentLayers,e)},vs.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},vs.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},vs.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,as),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},vs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},vs.prototype.addFeature=function(L,t,e,r,n){for(var i=0,D=$o(t,500);i<D.length;i+=1){for(var o=D[i],s=0,O=0,R=o;O<R.length;O+=1)s+=R[O].length;for(var p=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),j=0,B=o,f;j<B.length;j+=1)if(f=B[j],0!==f.length&&!((W=f).every(function(e){return 0>e.x})||W.every(function(e){return 8192<e.x})||W.every(function(e){return 0>e.y})||W.every(function(e){return 8192<e.y})))for(var F=0,N=0,V;N<f.length;N++)if(V=f[N],1<=N){var U=f[N-1];if(!gs(V,U)){p.vertexLength+4>na.MAX_VERTEX_ARRAY_LENGTH&&(p=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var g=V.sub(U)._perp()._unit(),x=U.dist(V);32768<F+x&&(F=0),ys(this.layoutVertexArray,V.x,V.y,g.x,g.y,0,0,F),ys(this.layoutVertexArray,V.x,V.y,g.x,g.y,0,1,F),ys(this.layoutVertexArray,U.x,U.y,g.x,g.y,0,0,F+=x),ys(this.layoutVertexArray,U.x,U.y,g.x,g.y,0,1,F);var b=p.vertexLength;this.indexArray.emplaceBack(b,b+2,b+1),this.indexArray.emplaceBack(b+1,b+2,b+3),p.vertexLength+=4,p.primitiveLength+=2}}if(p.vertexLength+s>na.MAX_VERTEX_ARRAY_LENGTH&&(p=this.segments.prepareSegment(s,this.layoutVertexArray,this.indexArray)),"Polygon"===ds[L.type]){for(var w=[],_=[],A=p.vertexLength,S=0,H=o,I;S<H.length;S+=1)if(I=H[S],0!==I.length){I!==o[0]&&_.push(w.length/2);for(var q=0,G;q<I.length;q++)G=I[q],ys(this.layoutVertexArray,G.x,G.y,0,0,1,1,0),w.push(G.x),w.push(G.y)}for(var Y=bo(w,_),E=0;E<Y.length;E+=3)this.indexArray.emplaceBack(A+Y[E],A+Y[E+2],A+Y[E+1]);p.primitiveLength+=Y.length/3,p.vertexLength+=s}}var W;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,L,e,n,r)},Tn("FillExtrusionBucket",vs,{omit:["layers","features"]});var xs={paint:new vi({"fill-extrusion-opacity":new hi(kt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new fi(kt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new hi(kt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new hi(kt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new yi(kt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new fi(kt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new fi(kt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new hi(kt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},ws=function(a){function t(t){a.call(this,t,xs)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.createBucket=function(e){return new vs(e)},t.prototype.queryRadius=function(){return Ha(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(i,t,e,r,n,a,o,s){var d=Ya(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),a.angle,o),l=this.paint.get("fill-extrusion-height").evaluate(t,e),p=this.paint.get("fill-extrusion-base").evaluate(t,e),c=function(r,t){for(var e=[],a=0,i=r;a<i.length;a+=1){var n=i[a],s=[n.x,n.y,0,1];ro(s,s,t),e.push(new Qd(s[0]/s[3],s[1]/s[3]))}return e}(d,s),u=function(i,t,e,r){for(var n=[],a=[],o=r[8]*t,s=r[9]*t,u=r[10]*t,l=r[11]*t,p=r[8]*e,c=r[9]*e,h=r[10]*e,f=r[11]*e,y=0,T=i;y<T.length;y+=1){for(var m=[],v=[],g=0,C=T[y];g<C.length;g+=1){var b=C[g],w=b.x,_=b.y,A=r[0]*w+r[4]*_+r[12],S=r[1]*w+r[5]*_+r[13],k=r[2]*w+r[6]*_+r[14],L=r[3]*w+r[7]*_+r[15],E=L+l,I=L+f,P=new Qd((A+o)/E,(S+s)/E);P.z=(k+u)/E,m.push(P);var z=new Qd((A+p)/I,(S+c)/I);z.z=(k+h)/I,v.push(z)}n.push(m),a.push(v)}return[n,a]}(r,p,l,s);return function(d,t,e){var r=1/0;Oa(e,t)&&(r=As(e,t[0]));for(var c=0;c<t.length;c++)for(var p=t[c],a=d[c],o=0;o<p.length-1;o++){var g=p[o],u=[g,p[o+1],a[o+1],a[o],g];Da(e,u)&&(r=Rt(r,As(e,u)))}return r!==1/0&&r}(u[0],u[1],c)},t}(gi),_s=Qn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,ks=cs.VectorTileFeature.types,Is=Ge(37.5*(Ke/180)),zs=pa(2,14)/.5,Cs=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new zi,this.indexArray=new Di,this.programConfigurations=new Ea(_s,e.layers,e.zoom),this.segments=new na,this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id})};Cs.prototype.populate=function(_,t,e){this.hasPattern=Qo("line",this.layers,t);for(var r=this.layers[0].layout.get("line-sort-key"),n=[],i=0,k=_;i<k.length;i+=1){var o=k[i],s=o.feature,u=o.id,l=o.index,p=o.sourceLayerIndex,c=this.layers[0]._featureFilter.needGeometry,h={type:s.type,id:u,properties:s.properties,geometry:c?Ba(s):[]};if(this.layers[0]._featureFilter.filter(new ni(this.zoom),h,e)){c||(h.geometry=Ba(s));var f=r?r.evaluate(h,{},e):void 0;n.push({id:u,properties:s.properties,type:s.type,sourceLayerIndex:p,index:l,geometry:h.geometry,patterns:{},sortKey:f})}}r&&n.sort(function(a,t){return a.sortKey-t.sortKey});for(var y=0,T=n;y<T.length;y+=1){var m=T[y],v=m.geometry,g=m.index,x=m.sourceLayerIndex;if(this.hasPattern){var b=ts("line",this.layers,m,this.zoom,t);this.patternFeatures.push(b)}else this.addFeature(m,v,g,e,{});t.featureIndex.insert(_[g].feature,v,g,x,this.index)}},Cs.prototype.update=function(a,t,e){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,t,this.stateDependentLayers,e)},Cs.prototype.addFeatures=function(o,t,e){for(var r=0,l=this.patternFeatures,i;r<l.length;r+=1)i=l[r],this.addFeature(i,i.geometry,i.index,t,e)},Cs.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Cs.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Cs.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,_s),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Cs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Cs.prototype.addFeature=function(d,t,e,r,n){for(var i=this.layers[0].layout,a=i.get("line-join").evaluate(d,{}),o=i.get("line-cap"),s=i.get("line-miter-limit"),u=i.get("line-round-limit"),l=0,g=t;l<g.length;l+=1)this.addLine(g[l],d,a,o,s,u);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,d,e,n,r)},Cs.prototype.addLine=function(j,t,e,r,n,N){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+t.properties.mapbox_clip_start,this.clipEnd=+t.properties.mapbox_clip_end;for(var a=0;a<j.length-1;a++)this.totalDistance+=j[a].dist(j[a+1]);this.updateScaledDistance()}for(var H="Polygon"===ks[t.type],s=j.length;2<=s&&j[s-1].equals(j[s-2]);)s--;for(var q=0;q<s-1&&j[q].equals(j[q+1]);)q++;if(!(s<(H?3:2))){"bevel"===e&&(n=1.05);var G=16>=this.overscaling?122880/(512*this.overscaling):0,c=this.segments.prepareSegment(10*s,this.layoutVertexArray,this.indexArray),h,Y,W,X,Z;this.e1=this.e2=-1,H&&(Z=j[q].sub(h=j[s-2])._unit()._perp());for(var K=q;K<s;K++)if(!(W=K===s-1?H?j[q+1]:void 0:j[K+1])||!j[K].equals(W)){Z&&(X=Z),h&&(Y=h),h=j[K],Z=W?W.sub(h)._unit()._perp():X;var $=(X=X||Z).add(Z);0===$.x&&0===$.y||$._unit();var J=X.x*Z.x+X.y*Z.y,x=$.x*Z.x+$.y*Z.y,b=0==x?1/0:1/x,w=2*We(2-2*x),_=x<Is&&Y&&W,A=0<X.x*Z.y-X.y*Z.x;if(_&&K>q){var S=h.dist(Y);if(S>2*G){var k=h.sub(h.sub(Y)._mult(G/S)._round());this.updateDistance(Y,k),this.addCurrentVertex(k,X,0,0,c),Y=k}}var I=Y&&W,z=I?e:H?"butt":r;if(I&&"round"===z&&(b<N?z="miter":2>=b&&(z="fakeround")),"miter"===z&&b>n&&(z="bevel"),"bevel"===z&&(2<b&&(z="flipbevel"),b<n&&(z="miter")),Y&&this.updateDistance(Y,h),"miter"===z)$._mult(b),this.addCurrentVertex(h,$,0,0,c);else if("flipbevel"===z){if(100<b)$=Z.mult(-1);else{var Q=b*X.add(Z).mag()/X.sub(Z).mag();$._perp()._mult(Q*(A?-1:1))}this.addCurrentVertex(h,$,0,0,c),this.addCurrentVertex(h,$.mult(-1),0,0,c)}else if("bevel"===z||"fakeround"===z){var M=-We(b*b-1),E=A?M:0,T=A?0:M;if(Y&&this.addCurrentVertex(h,X,E,T,c),"fakeround"===z)for(var P=Xe(180*w/Ke/20),B=1,ee;B<P;B++){if(ee=B/P,.5!==ee){var te=ee-.5;ee+=ee*te*(ee-1)*((1.0904+J*(J*(3.55645-1.43519*J)-3.2452))*te*te+(.848013+J*(.215638*J-1.06021)))}var D=Z.sub(X)._mult(ee)._add(X)._unit()._mult(A?-1:1);this.addHalfVertex(h,D.x,D.y,!1,A,0,c)}W&&this.addCurrentVertex(h,Z,-E,-T,c)}else if("butt"===z)this.addCurrentVertex(h,$,0,0,c);else if("square"===z){var L=Y?1:-1;this.addCurrentVertex(h,$,L,L,c)}else"round"==z&&(Y&&(this.addCurrentVertex(h,X,0,0,c),this.addCurrentVertex(h,X,1,1,c,!0)),W&&(this.addCurrentVertex(h,Z,-1,-1,c,!0),this.addCurrentVertex(h,Z,0,0,c)));if(_&&K<s-1){var R=h.dist(W);if(R>2*G){var O=h.add(W.sub(h)._mult(G/R)._round());this.updateDistance(h,O),this.addCurrentVertex(O,Z,0,0,c),h=O}}}}},Cs.prototype.addCurrentVertex=function(l,t,e,r,n,i){void 0===i&&(i=!1);var d=t.y*r-t.x,o=-t.y-t.x*r;this.addHalfVertex(l,t.x+t.y*e,t.y-t.x*e,i,!1,e,n),this.addHalfVertex(l,d,o,i,!0,-r,n),this.distance>zs/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(l,t,e,r,n,i))},Cs.prototype.addHalfVertex=function(l,t,e,r,n,i,a){var o=.5*this.scaledDistance;this.layoutVertexArray.emplaceBack((l.x<<1)+(r?1:0),(l.y<<1)+(n?1:0),Xe(63*t)+128,Xe(63*e)+128,1+(0===i?0:0>i?-1:1)|(63&o)<<2,o>>6);var s=a.vertexLength++;0<=this.e1&&0<=this.e2&&(this.indexArray.emplaceBack(this.e1,this.e2,s),a.primitiveLength++),n?this.e2=s:this.e1=s},Cs.prototype.updateScaledDistance=function(){this.scaledDistance=0<this.totalDistance?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(zs-1):this.distance},Cs.prototype.updateDistance=function(a,t){this.distance+=a.dist(t),this.updateScaledDistance()},Tn("LineBucket",Cs,{omit:["layers","patternFeatures"]});var Ms=new vi({"line-cap":new hi(kt.layout_line["line-cap"]),"line-join":new fi(kt.layout_line["line-join"]),"line-miter-limit":new hi(kt.layout_line["line-miter-limit"]),"line-round-limit":new hi(kt.layout_line["line-round-limit"]),"line-sort-key":new fi(kt.layout_line["line-sort-key"])}),Es={paint:new vi({"line-opacity":new fi(kt.paint_line["line-opacity"]),"line-color":new fi(kt.paint_line["line-color"]),"line-translate":new hi(kt.paint_line["line-translate"]),"line-translate-anchor":new hi(kt.paint_line["line-translate-anchor"]),"line-width":new fi(kt.paint_line["line-width"]),"line-gap-width":new fi(kt.paint_line["line-gap-width"]),"line-offset":new fi(kt.paint_line["line-offset"]),"line-blur":new fi(kt.paint_line["line-blur"]),"line-dasharray":new di(kt.paint_line["line-dasharray"]),"line-pattern":new yi(kt.paint_line["line-pattern"]),"line-gradient":new mi(kt.paint_line["line-gradient"])}),layout:Ms},Ts=new(function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(t,e){return e=new ni(ya(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),a.prototype.possiblyEvaluate.call(this,t,e)},t.prototype.evaluate=function(t,e,o,n){return e=_o({},e,{zoom:ya(e.zoom)}),a.prototype.evaluate.call(this,t,e,o,n)},t}(fi))(Es.paint.properties["line-width"].specification);Ts.useIntegerZoom=!0;var Ps=function(a){function t(t){a.call(this,t,Es)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(e){"line-gradient"===e&&this._updateGradient()},t.prototype._updateGradient=function(){this.gradient=co(this._transitionablePaint._values["line-gradient"].value.expression,"lineProgress"),this.gradientTexture=null},t.prototype.recalculate=function(t,e){a.prototype.recalculate.call(this,t,e),this.paint._values["line-floorwidth"]=Ts.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)},t.prototype.createBucket=function(e){return new Cs(e)},t.prototype.queryRadius=function(a){var t=a,e=Ss(Ja("line-width",this,t),Ja("line-gap-width",this,t)),o=Ja("line-offset",this,t);return e/2+ma(o)+Ha(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(i,t,e,r,d,a,o){var s=Ya(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),a.angle,o),c=o/2*Ss(this.paint.get("line-width").evaluate(t,e),this.paint.get("line-gap-width").evaluate(t,e)),l=this.paint.get("line-offset").evaluate(t,e);return l&&(r=function(i,t){for(var e=[],r=new Qd(0,0),n=0;n<i.length;n++){for(var d=i[n],o=[],s=0;s<d.length;s++){var g=d[s],l=d[s+1],p=0==s?r:g.sub(d[s-1])._unit()._perp(),c=s==d.length-1?r:l.sub(g)._unit()._perp(),m=p._add(c)._unit();m._mult(1/(m.x*c.x+m.y*c.y)),o.push(m._mult(t)._add(g))}e.push(o)}return e}(r,l*o)),function(o,t,e){for(var r=0,l;r<t.length;r++){if(l=t[r],3<=o.length)for(var s=0;s<l.length;s++)if(Za(o,l[s]))return!0;if(Ua(o,l,e))return!0}return!1}(s,r,c)},t.prototype.isTileClipped=function(){return!0},t}(gi),Bs=Qn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Fs=Qn([{name:"a_projected_pos",components:3,type:"Float32"}],4),Ds=(Qn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Qn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Ls=(Qn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Qn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Rs=Qn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Qn([{name:"triangle",components:3,type:"Uint16"}]),Qn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Qn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Qn([{type:"Float32",name:"offsetX"}]),Qn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Os={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","¢":"\uFFE0","£":"\uFFE1","¥":"\uFFE5","¦":"\uFFE4","¬":"\uFFE2","¯":"\uFFE3","–":"\uFE32","—":"\uFE31","‘":"\uFE43","’":"\uFE44","“":"\uFE41","”":"\uFE42","…":"\uFE19","‧":"\u30FB","₩":"\uFFE6","、":"\uFE11","。":"\uFE12","〈":"\uFE3F","〉":"\uFE40","《":"\uFE3D","》":"\uFE3E","「":"\uFE41","」":"\uFE42","『":"\uFE43","』":"\uFE44","【":"\uFE3B","】":"\uFE3C","〔":"\uFE39","〕":"\uFE3A","〖":"\uFE17","〗":"\uFE18","！":"\uFE15","（":"\uFE35","）":"\uFE36","，":"\uFE10","－":"\uFE32","．":"\u30FB","：":"\uFE13","；":"\uFE14","＜":"\uFE3F","＞":"\uFE40","？":"\uFE16","［":"\uFE47","］":"\uFE48","＿":"\uFE33","｛":"\uFE37","｜":"\u2015","｝":"\uFE38","｟":"\uFE35","｠":"\uFE36","｡":"\uFE12","｢":"\uFE41","｣":"\uFE42"},js=function(d,t,e,r,n){var i=8*n-r-1,s=(1<<i)-1,u=s>>1,l=-7,g=e?n-1:0,m=e?-1:1,h=d[t+g],y,x;for(g+=m,y=h&(1<<-l)-1,h>>=-l,l+=i;0<l;y=256*y+d[t+g],g+=m,l-=8);for(x=y&(1<<-l)-1,y>>=-l,l+=r;0<l;x=256*x+d[t+g],g+=m,l-=8);if(0===y)y=1-u;else{if(y===s)return x?NaN:1/0*(h?-1:1);x+=pa(2,r),y-=u}return(h?-1:1)*x*pa(2,y-r)},qs=function(g,t,m,r,n,x){var a=8*x-n-1,_=(1<<a)-1,p=_>>1,c=23===n?pa(2,-24)-pa(2,-77):0,h=r?0:x-1,b=r?1:-1,y=0>t||0===t&&0>1/t?1:0,d,v,w;for(t=ma(t),isNaN(t)||t===1/0?(v=isNaN(t)?1:0,d=_):(d=ya(C(t)/T),1>t*(w=pa(2,-d))&&(d--,w*=2),2<=(t+=1<=d+p?c/w:c*pa(2,1-p))*w&&(d++,w/=2),d+p>=_?(v=0,d=_):1<=d+p?(v=(t*w-1)*pa(2,n),d+=p):(v=t*pa(2,p-1)*pa(2,n),d=0));8<=n;g[m+h]=255&v,h+=b,v/=256,n-=8);for(d=d<<n|v,a+=n;0<a;g[m+h]=255&d,h+=b,d/=256,a-=8);g[m+h-b]|=128*y},Ns=Us;Us.Varint=0,Us.Fixed64=1,Us.Bytes=2,Us.Fixed32=5;var Ks="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");Us.prototype={destroy:function(){this.buf=null},readFields:function(o,t,e){for(e=e||this.length;this.pos<e;){var i=this.readVarint(),n=this.pos;this.type=7&i,o(i>>3,t,this),this.pos===n&&this.skip(i)}return t},readMessage:function(a,t){return this.readFields(a,t,this.readVarint()+this.pos)},readFixed32:function(){var e=md(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=yd(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=md(this.buf,this.pos)+4294967296*md(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=md(this.buf,this.pos)+4294967296*yd(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=js(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=js(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(a){var t=this.buf,o,i;return o=127&(i=t[this.pos++]),128>i?o:(o|=(127&(i=t[this.pos++]))<<7,128>i?o:(o|=(127&(i=t[this.pos++]))<<14,128>i?o:(o|=(127&(i=t[this.pos++]))<<21,128>i?o:function(o,t,e){var r=e.buf,a,l;if(a=(112&(l=r[e.pos++]))>>4,128>l)return Xs(o,a,t);if(a|=(127&(l=r[e.pos++]))<<3,128>l)return Xs(o,a,t);if(a|=(127&(l=r[e.pos++]))<<10,128>l)return Xs(o,a,t);if(a|=(127&(l=r[e.pos++]))<<17,128>l)return Xs(o,a,t);if(a|=(127&(l=r[e.pos++]))<<24,128>l)return Xs(o,a,t);if(a|=(1&(l=r[e.pos++]))<<31,128>l)return Xs(o,a,t);throw new Error("Expected varint not more than 10 bytes")}(o|=(15&(i=t[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return 1==e%2?(e+1)/-2:e/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var a=this.readVarint()+this.pos,t=this.pos;return this.pos=a,12<=a-t&&Ks?function(a,t,e){return Ks.decode(a.subarray(t,e))}(this.buf,t,a):function(c,t,e){for(var r="",g=t;g<e;){var m=c[g],u=null,h=239<m?4:223<m?3:191<m?2:1,y,f,x;if(g+h>e)break;1==h?128>m&&(u=m):2===h?128==(192&(y=c[g+1]))&&127>=(u=(31&m)<<6|63&y)&&(u=null):3===h?(f=c[g+2],128==(192&(y=c[g+1]))&&128==(192&f)&&(2047>=(u=(15&m)<<12|(63&y)<<6|63&f)||55296<=u&&57343>=u)&&(u=null)):4==h&&(f=c[g+2],x=c[g+3],128==(192&(y=c[g+1]))&&128==(192&f)&&128==(192&x)&&(65535>=(u=(15&m)<<18|(63&y)<<12|(63&f)<<6|63&x)||1114112<=u)&&(u=null)),null===u?(u=65533,h=1):65535<u&&(u-=65536,r+=d(55296|1023&u>>>10),u=56320|1023&u),r+=d(u),g+=h}return r}(this.buf,t,a)},readBytes:function(){var a=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,a);return this.pos=a,t},readPackedVarint:function(a,o){if(this.type!==Us.Bytes)return a.push(this.readVarint(o));var e=Gs(this);for(a=a||[];this.pos<e;)a.push(this.readVarint(o));return a},readPackedSVarint:function(a){if(this.type!==Us.Bytes)return a.push(this.readSVarint());var o=Gs(this);for(a=a||[];this.pos<o;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==Us.Bytes)return a.push(this.readBoolean());var o=Gs(this);for(a=a||[];this.pos<o;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==Us.Bytes)return a.push(this.readFloat());var o=Gs(this);for(a=a||[];this.pos<o;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==Us.Bytes)return a.push(this.readDouble());var o=Gs(this);for(a=a||[];this.pos<o;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==Us.Bytes)return a.push(this.readFixed32());var o=Gs(this);for(a=a||[];this.pos<o;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==Us.Bytes)return a.push(this.readSFixed32());var o=Gs(this);for(a=a||[];this.pos<o;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==Us.Bytes)return a.push(this.readFixed64());var o=Gs(this);for(a=a||[];this.pos<o;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==Us.Bytes)return a.push(this.readSFixed64());var o=Gs(this);for(a=a||[];this.pos<o;)a.push(this.readSFixed64());return a},skip:function(a){var t=7&a;if(t===Us.Varint)for(;127<this.buf[this.pos++];);else if(t===Us.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Us.Fixed32)this.pos+=4;else{if(t!==Us.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(a,t){this.writeVarint(a<<3|t)},realloc:function(a){for(var t=this.length||16;t<this.pos+a;)t*=2;if(t!==this.length){var o=new Uint8Array(t);o.set(this.buf),this.buf=o,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),hd(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),hd(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),hd(this.buf,-1&e,this.pos),hd(this.buf,ya(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),hd(this.buf,-1&e,this.pos),hd(this.buf,ya(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){268435455<(e=+e||0)||0>e?function(a,t){var e,o;if(0<=a?(e=0|a%4294967296,o=0|a/4294967296):(o=~(-a/4294967296),4294967295^(e=~(-a%4294967296))?e=0|e+1:(e=0,o=0|o+1)),0x10000000000000000<=a||-0x10000000000000000>a)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function(a,o,e){e.buf[e.pos++]=128|127&a,a>>>=7,e.buf[e.pos++]=128|127&a,a>>>=7,e.buf[e.pos++]=128|127&a,a>>>=7,e.buf[e.pos++]=128|127&a,e.buf[e.pos]=127&(a>>>=7)}(e,0,t),function(a,o){var e=(7&a)<<4;o.buf[o.pos++]|=e|((a>>>=3)?128:0),a&&(o.buf[o.pos++]=127&a|((a>>>=7)?128:0),a&&(o.buf[o.pos++]=127&a|((a>>>=7)?128:0),a&&(o.buf[o.pos++]=127&a|((a>>>=7)?128:0),a&&(o.buf[o.pos++]=127&a|((a>>>=7)?128:0),a&&(o.buf[o.pos++]=127&a)))))}(o,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(127<e?128:0),127>=e||(this.buf[this.pos++]=127&(e>>>=7)|(127<e?128:0),127>=e||(this.buf[this.pos++]=127&(e>>>=7)|(127<e?128:0),127>=e||(this.buf[this.pos++]=127&e>>>7))))},writeSVarint:function(e){this.writeVarint(0>e?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(!!e)},writeString:function(a){a+="",this.realloc(4*a.length),this.pos++;var o=this.pos;this.pos=function(o,t,e){for(var l=0,s,d;l<t.length;l++){if(55295<(s=t.charCodeAt(l))&&57344>s){if(!d){56319<s||l+1===t.length?(o[e++]=239,o[e++]=191,o[e++]=189):d=s;continue}if(56320>s){o[e++]=239,o[e++]=191,o[e++]=189,d=s;continue}s=65536|(d-55296<<10|s-56320),d=null}else d&&(o[e++]=239,o[e++]=191,o[e++]=189,d=null);128>s?o[e++]=s:(2048>s?o[e++]=192|s>>6:(65536>s?o[e++]=224|s>>12:(o[e++]=240|s>>18,o[e++]=128|63&s>>12),o[e++]=128|63&s>>6),o[e++]=128|63&s)}return e}(this.buf,a,this.pos);var e=this.pos-o;128<=e&&Js(o,e,this),this.pos=o-1,this.writeVarint(e),this.pos+=e},writeFloat:function(e){this.realloc(4),qs(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),qs(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var t=a.length;this.writeVarint(t),this.realloc(t);for(var e=0;e<t;e++)this.buf[this.pos++]=a[e]},writeRawMessage:function(a,t){this.pos++;var e=this.pos;a(t,this);var o=this.pos-e;128<=o&&Js(e,o,this),this.pos=e-1,this.writeVarint(o),this.pos+=o},writeMessage:function(a,t,e){this.writeTag(a,Us.Bytes),this.writeRawMessage(t,e)},writePackedVarint:function(a,t){t.length&&this.writeMessage(a,Hs,t)},writePackedSVarint:function(a,t){t.length&&this.writeMessage(a,Ys,t)},writePackedBoolean:function(a,t){t.length&&this.writeMessage(a,Qs,t)},writePackedFloat:function(a,t){t.length&&this.writeMessage(a,$s,t)},writePackedDouble:function(a,t){t.length&&this.writeMessage(a,Ws,t)},writePackedFixed32:function(a,t){t.length&&this.writeMessage(a,cd,t)},writePackedSFixed32:function(a,t){t.length&&this.writeMessage(a,pd,t)},writePackedFixed64:function(a,t){t.length&&this.writeMessage(a,ud,t)},writePackedSFixed64:function(a,t){t.length&&this.writeMessage(a,gd,t)},writeBytesField:function(a,t){this.writeTag(a,Us.Bytes),this.writeBytes(t)},writeFixed32Field:function(a,t){this.writeTag(a,Us.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(a,t){this.writeTag(a,Us.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(a,t){this.writeTag(a,Us.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(a,t){this.writeTag(a,Us.Fixed64),this.writeSFixed64(t)},writeVarintField:function(a,t){this.writeTag(a,Us.Varint),this.writeVarint(t)},writeSVarintField:function(a,t){this.writeTag(a,Us.Varint),this.writeSVarint(t)},writeStringField:function(a,t){this.writeTag(a,Us.Bytes),this.writeString(t)},writeFloatField:function(a,t){this.writeTag(a,Us.Fixed32),this.writeFloat(t)},writeDoubleField:function(a,t){this.writeTag(a,Us.Fixed64),this.writeDouble(t)},writeBooleanField:function(a,t){this.writeVarintField(a,!!t)}};var Zs=function(l,t){var e=t.pixelRatio,r=t.version,n=t.stretchX,i=t.stretchY,a=t.content;this.paddedRect=l,this.pixelRatio=e,this.stretchX=n,this.stretchY=i,this.content=a,this.version=r},kc={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};kc.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},kc.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},kc.tlbr.get=function(){return this.tl.concat(this.br)},kc.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Zs.prototype,kc);var Tc=function(g,t){var e={},r={};this.haveRenderCallbacks=[];var n=[];this.addImages(g,e,n),this.addImages(t,r,n);var i=bd(n),a=new ho({width:i.w||1,height:i.h||1});for(var o in g){var s=g[o],u=e[o].paddedRect;ho.copy(s.data,a,{x:0,y:0},{x:u.x+1,y:u.y+1},s.data)}for(var l in t){var p=t[l],c=r[l].paddedRect,h=c.x+1,f=c.y+1,y=p.data.width,d=p.data.height;ho.copy(p.data,a,{x:0,y:0},{x:h,y:f},p.data),ho.copy(p.data,a,{x:0,y:d-1},{x:h,y:f-1},{width:y,height:1}),ho.copy(p.data,a,{x:0,y:0},{x:h,y:f+d},{width:y,height:1}),ho.copy(p.data,a,{x:y-1,y:0},{x:h-1,y:f},{width:1,height:d}),ho.copy(p.data,a,{x:0,y:0},{x:h+y,y:f},{width:1,height:d})}this.image=a,this.iconPositions=e,this.patternPositions=r};Tc.prototype.addImages=function(o,t,e){for(var r in o){var n=o[r],i={x:0,y:0,w:n.data.width+2,h:n.data.height+2};e.push(i),t[r]=new Zs(i,n),n.hasRenderCallback&&this.haveRenderCallbacks.push(r)}},Tc.prototype.patchUpdatedImages=function(a,t){for(var e in a.dispatchRenderCallbacks(this.haveRenderCallbacks),a.updatedImages)this.patchUpdatedImage(this.iconPositions[e],a.getImage(e),t),this.patchUpdatedImage(this.patternPositions[e],a.getImage(e),t)},Tc.prototype.patchUpdatedImage=function(a,t,e){if(a&&t&&a.version!==t.version){a.version=t.version;var o=a.tl;e.update(t.data,void 0,{x:o[0],y:o[1]})}},Tn("ImagePosition",Zs),Tn("ImageAtlas",Tc);var Ac={horizontal:1,vertical:2,horizontalOnly:3},Sc=function(){this.scale=1,this.fontStack="",this.imageName=null};Sc.forText=function(a,t){var e=new Sc;return e.scale=a||1,e.fontStack=t,e},Sc.forImage=function(a){var t=new Sc;return t.imageName=a,t};var Cc=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};Cc.fromFeature=function(a,t){for(var e=new Cc,o=0,r;o<a.sections.length;o++)r=a.sections[o],r.image?e.addImageSection(r):e.addTextSection(r,t);return e},Cc.prototype.length=function(){return this.text.length},Cc.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},Cc.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},Cc.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},Cc.prototype.verticalizePunctuation=function(){this.text=function(a){for(var t="",o=0;o<a.length;o++){var l=a.charCodeAt(o+1)||null,n=a.charCodeAt(o-1)||null;t+=l&&Kn(l)&&!Os[a[o+1]]||n&&Kn(n)&&!Os[a[o-1]]||!Os[a[o]]?a[o]:Os[a[o]]}return t}(this.text)},Cc.prototype.trim=function(){for(var a=0,o=0;o<this.text.length&&Lc[this.text.charCodeAt(o)];o++)a++;for(var i=this.text.length,l=this.text.length-1;0<=l&&l>=a&&Lc[this.text.charCodeAt(l)];l--)i--;this.text=this.text.substring(a,i),this.sectionIndex=this.sectionIndex.slice(a,i)},Cc.prototype.substring=function(a,t){var e=new Cc;return e.text=this.text.substring(a,t),e.sectionIndex=this.sectionIndex.slice(a,t),e.sections=this.sections,e},Cc.prototype.toString=function(){return this.text},Cc.prototype.getMaxScale=function(){var a=this;return this.sectionIndex.reduce(function(t,e){return ha(t,a.sections[e].scale)},0)},Cc.prototype.addTextSection=function(a,t){this.text+=a.text,this.sections.push(Sc.forText(a.scale,a.fontStack||t));for(var e=this.sections.length-1,o=0;o<a.text.length;++o)this.sectionIndex.push(e)},Cc.prototype.addImageSection=function(a){var t=a.image?a.image.name:"";if(0!==t.length){var e=this.getNextImageSectionCharCode();e?(this.text+=d(e),this.sections.push(Sc.forImage(t)),this.sectionIndex.push(this.sections.length-1)):ad("Reached maximum number of images 6401")}else ad("Can't add FormattedSection with an empty image.")},Cc.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?63743<=this.imageSectionID?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Lc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Ec={};Ec[10]=!0,Ec[32]=!0,Ec[38]=!0,Ec[40]=!0,Ec[41]=!0,Ec[43]=!0,Ec[45]=!0,Ec[47]=!0,Ec[173]=!0,Ec[183]=!0,Ec[8203]=!0,Ec[8208]=!0,Ec[8211]=!0,Ec[8231]=!0;var Ic=function(a){function t(t,e,o,r){a.call(this,t,e),this.angle=o,void 0!==r&&(this.segment=r)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(Qd);Tn("Anchor",Ic);var Pc=Object.freeze({__proto__:null,getSizeData:Id,evaluateSizeForFeature:Pd,evaluateSizeForZoom:zd,SIZE_PACK_FACTOR:128}),zc=function(i,t,e,r,n,a,o,s,u,l){if(this.boxStartIndex=i.length,u){var p=a.top,k=a.bottom,T=a.collisionPadding;T&&(p-=T[1],k+=T[3]);var f=k-p;0<f&&(f=ha(10,f),this.circleDiameter=f)}else{var C=a.top*o-s,L=a.bottom*o+s,E=a.left*o-s,I=a.right*o+s,P=a.collisionPadding;if(P&&(E-=P[0]*o,C-=P[1]*o,I+=P[2]*o,L+=P[3]*o),l){var x=new Qd(E,C),b=new Qd(I,C),w=new Qd(E,L),_=new Qd(I,L),A=l*Ke/180;x._rotate(A),b._rotate(A),w._rotate(A),_._rotate(A),E=Rt(x.x,b.x,w.x,_.x),I=ha(x.x,b.x,w.x,_.x),C=Rt(x.y,b.y,w.y,_.y),L=ha(x.y,b.y,w.y,_.y)}i.emplaceBack(t.x,t.y,E,C,I,L,e,r,n)}this.boxEndIndex=i.length},Dc=function(a,o){if(void 0===a&&(a=[]),void 0===o&&(o=Gd),this.data=a,this.length=this.data.length,this.compare=o,0<this.length)for(var i=(this.length>>1)-1;0<=i;i--)this._down(i)};Dc.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},Dc.prototype.pop=function(){if(0!==this.length){var a=this.data[0],t=this.data.pop();return this.length--,0<this.length&&(this.data[0]=t,this._down(0)),a}},Dc.prototype.peek=function(){return this.data[0]},Dc.prototype._up=function(o){for(var l=this.data,e=this.compare,r=l[o];0<o;){var n=o-1>>1,i=l[n];if(0<=e(r,i))break;l[o]=i,o=n}l[o]=r},Dc.prototype._down=function(l){for(var d=this.data,e=this.compare,r=this.length>>1,n=d[l];l<r;){var i=1+(l<<1),c=d[i],p=i+1;if(p<this.length&&0>e(d[p],c)&&(i=p,c=d[p]),0<=e(c,n))break;d[l]=c,l=i}d[l]=n};var Oc=Wl,Rc=cs.VectorTileFeature.types,il=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}],al=function(e){this.layoutVertexArray=new Mi,this.indexArray=new Di,this.programConfigurations=e,this.segments=new na,this.dynamicLayoutVertexArray=new Ei,this.opacityVertexArray=new Ti,this.placedSymbolArray=new Hi};al.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length},al.prototype.upload=function(a,t,e,o){this.isEmpty()||(e&&(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Bs.members),this.indexBuffer=a.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=a.createVertexBuffer(this.dynamicLayoutVertexArray,Fs.members,!0),this.opacityVertexBuffer=a.createVertexBuffer(this.opacityVertexArray,il,!0),this.opacityVertexBuffer.itemSize=1),(e||o)&&this.programConfigurations.upload(a))},al.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Tn("SymbolBuffers",al);var ll=function(a,t,e){this.layoutVertexArray=new a,this.layoutAttributes=t,this.indexArray=new e,this.segments=new na,this.collisionVertexArray=new Fi};ll.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Ds.members,!0)},ll.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Tn("CollisionBuffers",ll);var pl=function(a){this.collisionBoxArray=a.collisionBoxArray,this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=a.index,this.pixelRatio=a.pixelRatio,this.sourceLayerIndex=a.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=$a([]),this.placementViewportMatrix=$a([]);var t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Id(this.zoom,t["text-size"]),this.iconSizeData=Id(this.zoom,t["icon-size"]);var e=this.layers[0].layout,o=e.get("symbol-sort-key"),r=e.get("symbol-z-order");this.sortFeaturesByKey="viewport-y"!==r&&void 0!==o.constantOr(1),this.sortFeaturesByY=("viewport-y"===r||"auto"===r&&!this.sortFeaturesByKey)&&(e.get("text-allow-overlap")||e.get("icon-allow-overlap")||e.get("text-ignore-placement")||e.get("icon-ignore-placement")),"point"===e.get("symbol-placement")&&(this.writingModes=e.get("text-writing-mode").map(function(e){return Ac[e]})),this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id}),this.sourceID=a.sourceID};pl.prototype.createArrays=function(){this.text=new al(new Ea(Bs.members,this.layers,this.zoom,function(e){return /^text/.test(e)})),this.icon=new al(new Ea(Bs.members,this.layers,this.zoom,function(e){return /^icon/.test(e)})),this.glyphOffsetArray=new Wi,this.lineVertexArray=new Qi,this.symbolInstances=new $i},pl.prototype.calculateGlyphDependencies=function(l,t,e,r,n){for(var i=0;i<l.length;i++)if(t[l.charCodeAt(i)]=!0,(e||r)&&n){var s=Os[l.charAt(i)];s&&(t[s.charCodeAt(0)]=!0)}},pl.prototype.populate=function(O,t,e){var r=this.layers[0],n=r.layout,i=n.get("text-font"),a=n.get("text-field"),o=n.get("icon-image"),s=("constant"!==a.value.kind||a.value.value instanceof Qt&&!a.value.value.isEmpty()||0<a.value.value.toString().length)&&("constant"!==i.value.kind||0<i.value.value.length),u="constant"!==o.value.kind||!!o.value.value||0<Object.keys(o.parameters).length,l=n.get("symbol-sort-key");if(this.features=[],s||u){for(var p=t.iconDependencies,c=t.glyphDependencies,h=t.availableImages,f=new ni(this.zoom),y=0,j=O;y<j.length;y+=1){var m=j[y],v=m.feature,g=m.id,x=m.index,b=m.sourceLayerIndex,w=r._featureFilter.needGeometry,_={type:v.type,id:g,properties:v.properties,geometry:w?Ba(v):[]};if(r._featureFilter.filter(f,_,e)){w||(_.geometry=Ba(v));var A=void 0;if(s){var N=r.getValueAndResolveTokens("text-field",_,e,h),k=Qt.factory(N);sl(k)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===ti()||this.hasRTLText&&ri.isParsed())&&(A=Vs(k,r,_))}var I=void 0;if(u){var U=r.getValueAndResolveTokens("icon-image",_,e,h);I=U instanceof te?U:te.fromString(U)}if(A||I){var C=this.sortFeaturesByKey?l.evaluate(_,{},e):void 0,M={id:g,text:A,icon:I,index:x,sourceLayerIndex:b,geometry:Ba(v),properties:v.properties,type:Rc[v.type],sortKey:C};if(this.features.push(M),I&&(p[I.name]=!0),A){var E=i.evaluate(_,{},e).join(","),T="map"===n.get("text-rotation-alignment")&&"point"!==n.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&0<=this.writingModes.indexOf(Ac.vertical);for(var P=0,H=A.sections,V;P<H.length;P+=1)if(V=H[P],V.image)p[V.image.name]=!0;else{var q=Un(A.toString()),D=V.fontStack||E,L=c[D]=c[D]||{};this.calculateGlyphDependencies(V.text,L,T,this.allowVerticalPlacement,q)}}}}}"line"===n.get("symbol-placement")&&(this.features=function(g){function t(t){_.push(g[t]),r++}function a(o,t,e){var r=x[o];return delete x[o],x[t]=r,_[r].geometry[0].pop(),_[r].geometry[0]=_[r].geometry[0].concat(e[0]),r}function o(e,t,o){var r=u[t];return delete u[t],u[e]=r,_[r].geometry[0].shift(),_[r].geometry[0]=o[0].concat(_[r].geometry[0]),r}function s(a,t,e){var o=e?t[0][t[0].length-1]:t[0][0];return a+":"+o.x+":"+o.y}for(var u={},x={},_=[],r=0,e=0;e<g.length;e++){var n=g[e],p=n.geometry,c=n.text?n.text.toString():null;if(c){var h=s(c,p),f=s(c,p,!0);if(h in x&&f in u&&x[h]!==u[f]){var y=o(h,f,p),d=a(h,f,_[y].geometry);delete u[h],delete x[f],x[s(c,_[d].geometry,!0)]=d,_[y].geometry=null}else h in x?a(h,f,p):f in u?o(h,f,p):(t(e),u[h]=r-1,x[f]=r-1)}else t(e)}return _.filter(function(e){return e.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(a,t){return a.sortKey-t.sortKey})}},pl.prototype.update=function(a,t,e){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(a,t,this.layers,e),this.icon.programConfigurations.updatePaintArrays(a,t,this.layers,e))},pl.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},pl.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},pl.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},pl.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},pl.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},pl.prototype.addToLineVertexArray=function(d,t){var e=this.lineVertexArray.length;if(void 0!==d.segment){for(var r=d.dist(t[d.segment+1]),c=d.dist(t[d.segment]),p={},a=d.segment+1;a<t.length;a++)p[a]={x:t[a].x,y:t[a].y,tileUnitDistanceFromAnchor:r},a<t.length-1&&(r+=t[a+1].dist(t[a]));for(var g=d.segment||0;0<=g;g--)p[g]={x:t[g].x,y:t[g].y,tileUnitDistanceFromAnchor:c},0<g&&(c+=t[g-1].dist(t[g]));for(var m=0,h;m<t.length;m++)h=p[m],this.lineVertexArray.emplaceBack(h.x,h.y,h.tileUnitDistanceFromAnchor)}return{lineStartIndex:e,lineLength:this.lineVertexArray.length-e}},pl.prototype.addSymbols=function(L,t,e,r,n,i,a,o,s,u,l,p){for(var c=L.indexArray,h=L.layoutVertexArray,f=L.segments.prepareSegment(4*t.length,h,c,i.sortKey),y=this.glyphOffsetArray.length,d=f.vertexLength,m=this.allowVerticalPlacement&&a===Ac.vertical?Ke/2:0,v=i.text&&i.text.sections,g=0;g<t.length;g++){var D=t[g],b=D.tl,w=D.tr,_=D.bl,A=D.br,S=D.tex,k=D.pixelOffsetTL,I=D.pixelOffsetBR,z=D.minFontScaleX,C=D.minFontScaleY,O=D.glyphOffset,E=D.isSDF,T=D.sectionIndex,P=f.vertexLength,R=O[1];nl(h,o.x,o.y,b.x,R+b.y,S.x,S.y,e,E,k.x,k.y,z,C),nl(h,o.x,o.y,w.x,R+w.y,S.x+S.w,S.y,e,E,I.x,k.y,z,C),nl(h,o.x,o.y,_.x,R+_.y,S.x,S.y+S.h,e,E,k.x,I.y,z,C),nl(h,o.x,o.y,A.x,R+A.y,S.x+S.w,S.y+S.h,e,E,I.x,I.y,z,C),ol(L.dynamicLayoutVertexArray,o,m),c.emplaceBack(P,P+1,P+2),c.emplaceBack(P+1,P+2,P+3),f.vertexLength+=4,f.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(O[0]),g!=t.length-1&&T===t[g+1].sectionIndex||L.programConfigurations.populatePaintArrays(h.length,i,i.index,{},p,v&&v[T])}L.placedSymbolArray.emplaceBack(o.x,o.y,y,this.glyphOffsetArray.length-y,d,s,u,o.segment,e?e[0]:0,e?e[1]:0,r[0],r[1],a,0,!1,0,l)},pl.prototype._addCollisionDebugVertex=function(o,t,e,r,n,i){return t.emplaceBack(0,0),o.emplaceBack(e.x,e.y,r,n,Xe(i.x),Xe(i.y))},pl.prototype.addCollisionDebugVertices=function(i,t,e,r,n,a,o){var s=n.segments.prepareSegment(4,n.layoutVertexArray,n.indexArray),d=s.vertexLength,l=n.layoutVertexArray,p=n.collisionVertexArray,c=o.anchorX,u=o.anchorY;this._addCollisionDebugVertex(l,p,a,c,u,new Qd(i,t)),this._addCollisionDebugVertex(l,p,a,c,u,new Qd(e,t)),this._addCollisionDebugVertex(l,p,a,c,u,new Qd(e,r)),this._addCollisionDebugVertex(l,p,a,c,u,new Qd(i,r)),s.vertexLength+=4;var g=n.indexArray;g.emplaceBack(d,d+1),g.emplaceBack(d+1,d+2),g.emplaceBack(d+2,d+3),g.emplaceBack(d+3,d),s.primitiveLength+=4},pl.prototype.addDebugCollisionBoxes=function(o,t,e,r){for(var n=o,l;n<t;n++)l=this.collisionBoxArray.get(n),this.addCollisionDebugVertices(l.x1,l.y1,l.x2,l.y2,r?this.textCollisionBox:this.iconCollisionBox,l.anchorPoint,e)},pl.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ll(Bi,Ls.members,qi),this.iconCollisionBox=new ll(Bi,Ls.members,qi);for(var a=0,o;a<this.symbolInstances.length;a++)o=this.symbolInstances.get(a),this.addDebugCollisionBoxes(o.textBoxStartIndex,o.textBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.iconBoxStartIndex,o.iconBoxEndIndex,o,!1),this.addDebugCollisionBoxes(o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o,!1)},pl.prototype._deserializeCollisionBoxesForSymbol=function(g,t,e,r,n,i,a,o,s){for(var u={},l=t,x;l<e;l++){x=g.get(l),u.textBox={x1:x.x1,y1:x.y1,x2:x.x2,y2:x.y2,anchorPointX:x.anchorPointX,anchorPointY:x.anchorPointY},u.textFeatureIndex=x.featureIndex;break}for(var _=r,b;_<n;_++){b=g.get(_),u.verticalTextBox={x1:b.x1,y1:b.y1,x2:b.x2,y2:b.y2,anchorPointX:b.anchorPointX,anchorPointY:b.anchorPointY},u.verticalTextFeatureIndex=b.featureIndex;break}for(var w=i,k;w<a;w++){k=g.get(w),u.iconBox={x1:k.x1,y1:k.y1,x2:k.x2,y2:k.y2,anchorPointX:k.anchorPointX,anchorPointY:k.anchorPointY},u.iconFeatureIndex=k.featureIndex;break}for(var T=o,A;T<s;T++){A=g.get(T),u.verticalIconBox={x1:A.x1,y1:A.y1,x2:A.x2,y2:A.y2,anchorPointX:A.anchorPointX,anchorPointY:A.anchorPointY},u.verticalIconFeatureIndex=A.featureIndex;break}return u},pl.prototype.deserializeCollisionBoxes=function(a){this.collisionArrays=[];for(var t=0,o;t<this.symbolInstances.length;t++)o=this.symbolInstances.get(t),this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(a,o.textBoxStartIndex,o.textBoxEndIndex,o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o.iconBoxStartIndex,o.iconBoxEndIndex,o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex))},pl.prototype.hasTextData=function(){return 0<this.text.segments.get().length},pl.prototype.hasIconData=function(){return 0<this.icon.segments.get().length},pl.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},pl.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&0<this.textCollisionBox.segments.get().length},pl.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&0<this.iconCollisionBox.segments.get().length},pl.prototype.addIndicesForPlacedSymbol=function(a,t){for(var e=a.placedSymbolArray.get(t),o=e.vertexStartIndex+4*e.numGlyphs,r=e.vertexStartIndex;r<o;r+=4)a.indexArray.emplaceBack(r,r+1,r+2),a.indexArray.emplaceBack(r+1,r+2,r+3)},pl.prototype.getSortedSymbolIndexes=function(l){if(this.sortedAngle===l&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var t=Je(l),e=Ge(l),r=[],n=[],i=[],a=0;a<this.symbolInstances.length;++a){i.push(a);var d=this.symbolInstances.get(a);r.push(0|Xe(t*d.anchorX+e*d.anchorY)),n.push(d.featureIndex)}return i.sort(function(a,t){return r[a]-r[t]||n[t]-n[a]}),i},pl.prototype.addToSortKeyRanges=function(a,t){var e=this.sortKeyRanges[this.sortKeyRanges.length-1];e&&e.sortKey===t?e.symbolInstanceEnd=a+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:a,symbolInstanceEnd:a+1})},pl.prototype.sortFeatures=function(a){var o=this;if(this.sortFeaturesByY&&this.sortedAngle!==a&&!(1<this.text.segments.get().length||1<this.icon.segments.get().length)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(a),this.sortedAngle=a,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var e=0,t=this.symbolInstanceIndexes,n;e<t.length;e+=1)n=this.symbolInstances.get(t[e]),this.featureSortOrder.push(n.featureIndex),[n.rightJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.leftJustifiedTextSymbolIndex].forEach(function(e,t,a){0<=e&&a.indexOf(e)===t&&o.addIndicesForPlacedSymbol(o.text,e)}),0<=n.verticalPlacedTextSymbolIndex&&this.addIndicesForPlacedSymbol(this.text,n.verticalPlacedTextSymbolIndex),0<=n.placedIconSymbolIndex&&this.addIndicesForPlacedSymbol(this.icon,n.placedIconSymbolIndex),0<=n.verticalPlacedIconSymbolIndex&&this.addIndicesForPlacedSymbol(this.icon,n.verticalPlacedIconSymbolIndex);this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Tn("SymbolBucket",pl,{omit:["layers","collisionBoxArray","features","compareText"]}),pl.MAX_GLYPHS=65535,pl.addDynamicAttributes=ol;var cl=new vi({"symbol-placement":new hi(kt.layout_symbol["symbol-placement"]),"symbol-spacing":new hi(kt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new hi(kt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new fi(kt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new hi(kt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new hi(kt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new hi(kt.layout_symbol["icon-ignore-placement"]),"icon-optional":new hi(kt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new hi(kt.layout_symbol["icon-rotation-alignment"]),"icon-size":new fi(kt.layout_symbol["icon-size"]),"icon-text-fit":new hi(kt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new hi(kt.layout_symbol["icon-text-fit-padding"]),"icon-image":new fi(kt.layout_symbol["icon-image"]),"icon-rotate":new fi(kt.layout_symbol["icon-rotate"]),"icon-padding":new hi(kt.layout_symbol["icon-padding"]),"icon-keep-upright":new hi(kt.layout_symbol["icon-keep-upright"]),"icon-offset":new fi(kt.layout_symbol["icon-offset"]),"icon-anchor":new fi(kt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new hi(kt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new hi(kt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new hi(kt.layout_symbol["text-rotation-alignment"]),"text-field":new fi(kt.layout_symbol["text-field"]),"text-font":new fi(kt.layout_symbol["text-font"]),"text-size":new fi(kt.layout_symbol["text-size"]),"text-max-width":new fi(kt.layout_symbol["text-max-width"]),"text-line-height":new hi(kt.layout_symbol["text-line-height"]),"text-letter-spacing":new fi(kt.layout_symbol["text-letter-spacing"]),"text-justify":new fi(kt.layout_symbol["text-justify"]),"text-radial-offset":new fi(kt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new hi(kt.layout_symbol["text-variable-anchor"]),"text-anchor":new fi(kt.layout_symbol["text-anchor"]),"text-max-angle":new hi(kt.layout_symbol["text-max-angle"]),"text-writing-mode":new hi(kt.layout_symbol["text-writing-mode"]),"text-rotate":new fi(kt.layout_symbol["text-rotate"]),"text-padding":new hi(kt.layout_symbol["text-padding"]),"text-keep-upright":new hi(kt.layout_symbol["text-keep-upright"]),"text-transform":new fi(kt.layout_symbol["text-transform"]),"text-offset":new fi(kt.layout_symbol["text-offset"]),"text-allow-overlap":new hi(kt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new hi(kt.layout_symbol["text-ignore-placement"]),"text-optional":new hi(kt.layout_symbol["text-optional"])}),hl={paint:new vi({"icon-opacity":new fi(kt.paint_symbol["icon-opacity"]),"icon-color":new fi(kt.paint_symbol["icon-color"]),"icon-halo-color":new fi(kt.paint_symbol["icon-halo-color"]),"icon-halo-width":new fi(kt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new fi(kt.paint_symbol["icon-halo-blur"]),"icon-translate":new hi(kt.paint_symbol["icon-translate"]),"icon-translate-anchor":new hi(kt.paint_symbol["icon-translate-anchor"]),"text-opacity":new fi(kt.paint_symbol["text-opacity"]),"text-color":new fi(kt.paint_symbol["text-color"],{runtimeType:Lt,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new fi(kt.paint_symbol["text-halo-color"]),"text-halo-width":new fi(kt.paint_symbol["text-halo-width"]),"text-halo-blur":new fi(kt.paint_symbol["text-halo-blur"]),"text-translate":new hi(kt.paint_symbol["text-translate"]),"text-translate-anchor":new hi(kt.paint_symbol["text-translate-anchor"])}),layout:cl},fl=function(e){this.type=e.property.overrides?e.property.overrides.runtimeType:Bt,this.defaultValue=e};fl.prototype.evaluate=function(a){if(a.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(a.formattedSection))return t.getOverride(a.formattedSection)}return a.feature&&a.featureState?this.defaultValue.evaluate(a.feature,a.featureState):this.defaultValue.property.specification.default},fl.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},fl.prototype.outputDefined=function(){return!1},fl.prototype.serialize=function(){return null},Tn("FormatSectionOverride",fl,{omit:["defaultValue"]});var yl=function(l){function d(t){l.call(this,t,hl)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.recalculate=function(t,e){if(l.prototype.recalculate.call(this,t,e),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"===this.layout.get("symbol-placement")?"viewport":"map"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"===this.layout.get("symbol-placement")?"viewport":"map"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var r=this.layout.get("text-writing-mode");if(r){for(var n=[],i=0,d=r,o;i<d.length;i+=1)o=d[i],0>n.indexOf(o)&&n.push(o);this.layout._values["text-writing-mode"]=n}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},d.prototype.getValueAndResolveTokens=function(o,t,e,r){var n=this.layout.get(o).evaluate(t,{},e,r),i=this._unevaluatedLayout._values[o];return i.isDataDriven()||Ur(i.value)||!n?n:function(a,t){return t.replace(/{([^{}]+)}/g,function(t,e){return e in a?a[e]+"":""})}(t.properties,n)},d.prototype.createBucket=function(e){return new pl(e)},d.prototype.queryRadius=function(){return 0},d.prototype.queryIntersectsFeature=function(){return!1},d.prototype._setPaintOverrides=function(){for(var e=0,l=hl.paint.overridableProperties,r;e<l.length;e+=1)if(r=l[e],d.hasPaintOverride(this.layout,r)){var c=this.paint.get(r),a=new fl(c),o=new Ar(a,c.property.specification),s;s="constant"===c.value.kind||"source"===c.value.kind?new jr("source",o):new Kr("composite",o,c.value.zoomStops,c.value._interpolationType),this.paint._values[r]=new pi(c.property,s,c.parameters)}},d.prototype._handleOverridablePaintPropertyUpdate=function(e,t,a){return!(!this.layout||t.isDataDriven()||a.isDataDriven())&&d.hasPaintOverride(this.layout,e)},d.hasPaintOverride=function(l,t){var e=l.get("text-field"),d=hl.paint.properties[t],n=!1,r=function(a){for(var t=0,o=a;t<o.length;t+=1)if(d.overrides&&d.overrides.hasOverride(o[t]))return void(n=!0)};if("constant"===e.value.kind&&e.value.value instanceof Qt)r(e.value.value.sections);else if("source"===e.value.kind){var a=function(e){n||(e instanceof ee&&ne(e.value)===jt?r(e.value.sections):e instanceof le?r(e.sections):e.eachChild(a))},o=e.value;o._styleExpression&&a(o._styleExpression.expression)}return n},d}(gi),dl={paint:new vi({"background-color":new hi(kt.paint_background["background-color"]),"background-pattern":new di(kt.paint_background["background-pattern"]),"background-opacity":new hi(kt.paint_background["background-opacity"])})},ml=function(a){function t(t){a.call(this,t,dl)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t}(gi),vl={paint:new vi({"raster-opacity":new hi(kt.paint_raster["raster-opacity"]),"raster-hue-rotate":new hi(kt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new hi(kt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new hi(kt.paint_raster["raster-brightness-max"]),"raster-saturation":new hi(kt.paint_raster["raster-saturation"]),"raster-contrast":new hi(kt.paint_raster["raster-contrast"]),"raster-resampling":new hi(kt.paint_raster["raster-resampling"]),"raster-fade-duration":new hi(kt.paint_raster["raster-fade-duration"])})},Mc=function(a){function t(t){a.call(this,t,vl)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t}(gi),xl=function(a){function t(t){a.call(this,t,{}),this.implementation=t}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},t.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)},t.prototype.onRemove=function(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)},t}(gi),bl={circle:wc,heatmap:yo,hillshade:go,fill:is,"fill-extrusion":ws,line:Ps,symbol:yl,background:ml,raster:Mc},wl=self.HTMLImageElement,_l=self.HTMLCanvasElement,Al=self.HTMLVideoElement,Sl=self.ImageData,kl=self.ImageBitmap,Il=function(a,t,e,o){this.context=a,this.format=e,this.texture=a.gl.createTexture(),this.update(t,o)};Il.prototype.update=function(d,t,e){var r=d.width,n=d.height,i=!(this.size&&this.size[0]===r&&this.size[1]===n||e),a=this.context,o=a.gl;if(this.useMipmap=!!(t&&t.useMipmap),o.bindTexture(o.TEXTURE_2D,this.texture),a.pixelStoreUnpackFlipY.set(!1),a.pixelStoreUnpack.set(1),a.pixelStoreUnpackPremultiplyAlpha.set(this.format===o.RGBA&&(!t||!1!==t.premultiply)),i)this.size=[r,n],d instanceof wl||d instanceof _l||d instanceof Al||d instanceof Sl||kl&&d instanceof kl?o.texImage2D(o.TEXTURE_2D,0,this.format,this.format,o.UNSIGNED_BYTE,d):o.texImage2D(o.TEXTURE_2D,0,this.format,r,n,0,this.format,o.UNSIGNED_BYTE,d.data);else{var s=e||{x:0,y:0},c=s.x,l=s.y;d instanceof wl||d instanceof _l||d instanceof Al||d instanceof Sl||kl&&d instanceof kl?o.texSubImage2D(o.TEXTURE_2D,0,c,l,o.RGBA,o.UNSIGNED_BYTE,d):o.texSubImage2D(o.TEXTURE_2D,0,c,l,r,n,o.RGBA,o.UNSIGNED_BYTE,d.data)}this.useMipmap&&this.isSizePowerOfTwo()&&o.generateMipmap(o.TEXTURE_2D)},Il.prototype.bind=function(a,t,e){var o=this.context.gl;o.bindTexture(o.TEXTURE_2D,this.texture),e!==o.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(e=o.LINEAR),a!==this.filter&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,a),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,e||a),this.filter=a),t!==this.wrap&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,t),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,t),this.wrap=t)},Il.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&0==C(this.size[0])/T%1},Il.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var zl=function(a){var t=this;this._callback=a,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){t._triggered=!1,t._callback()})};zl.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},zl.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Cl=function(a,t,e){this.target=a,this.parent=t,this.mapId=e,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},y(["receive","process"],this),this.invoker=new zl(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=w()?a:self};Cl.prototype.send=function(l,t,e,r,n){var d=this;void 0===n&&(n=!1);var a=Xe(1e18*Math.random()).toString(36).substring(0,10);e&&(this.callbacks[a]=e);var o=od(this.globalScope)?void 0:[];return this.target.postMessage({id:a,type:l,hasCallback:!!e,targetMapId:r,mustQueue:n,sourceMapId:this.mapId,data:Rn(t,o)},o),{cancel:function(){e&&delete d.callbacks[a],d.target.postMessage({id:a,type:"<cancel>",targetMapId:r,sourceMapId:d.mapId})}}},Cl.prototype.receive=function(a){var t=a.data,e=t.id;if(e&&(!t.targetMapId||this.mapId===t.targetMapId))if("<cancel>"===t.type){delete this.tasks[e];var o=this.cancelCallbacks[e];delete this.cancelCallbacks[e],o&&o()}else w()||t.mustQueue?(this.tasks[e]=t,this.taskQueue.push(e),this.invoker.trigger()):this.processTask(e,t)},Cl.prototype.process=function(){if(this.taskQueue.length){var a=this.taskQueue.shift(),t=this.tasks[a];delete this.tasks[a],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(a,t)}},Cl.prototype.processTask=function(d,t){var c=this;if("<response>"===t.type){var e=this.callbacks[d];delete this.callbacks[d],e&&(t.error?e(On(t.error)):e(null,On(t.data)))}else{var r=!1,p=od(this.globalScope)?void 0:[],a=t.hasCallback?function(t,e){r=!0,delete c.cancelCallbacks[d],c.target.postMessage({id:d,type:"<response>",sourceMapId:c.mapId,error:t?Rn(t):null,data:Rn(e,p)},p)}:function(){r=!0},o=null,n=On(t.data);if(this.parent[t.type])o=this.parent[t.type](t.sourceMapId,n,a);else if(this.parent.getWorkerSource){var u=t.type.split(".");o=this.parent.getWorkerSource(t.sourceMapId,u[0],n.source)[u[1]](n,a)}else a(new Error("Could not find function "+t.type));!r&&o&&o.cancel&&(this.cancelCallbacks[d]=o.cancel)}},Cl.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Ml=function(a,t){a&&(t?this.setSouthWest(a).setNorthEast(t):4===a.length?this.setSouthWest([a[0],a[1]]).setNorthEast([a[2],a[3]]):this.setSouthWest(a[0]).setNorthEast(a[1]))};Ml.prototype.setNorthEast=function(e){return this._ne=e instanceof Tl?new Tl(e.lng,e.lat):Tl.convert(e),this},Ml.prototype.setSouthWest=function(e){return this._sw=e instanceof Tl?new Tl(e.lng,e.lat):Tl.convert(e),this},Ml.prototype.extend=function(a){var t=this._sw,o=this._ne,i,n;if(a instanceof Tl)i=a,n=a;else{if(!(a instanceof Ml))return Array.isArray(a)?4===a.length||a.every(Array.isArray)?this.extend(Ml.convert(a)):this.extend(Tl.convert(a)):this;if(n=a._ne,!(i=a._sw)||!n)return this}return t||o?(t.lng=Rt(i.lng,t.lng),t.lat=Rt(i.lat,t.lat),o.lng=ha(n.lng,o.lng),o.lat=ha(n.lat,o.lat)):(this._sw=new Tl(i.lng,i.lat),this._ne=new Tl(n.lng,n.lat)),this},Ml.prototype.getCenter=function(){return new Tl((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Ml.prototype.getSouthWest=function(){return this._sw},Ml.prototype.getNorthEast=function(){return this._ne},Ml.prototype.getNorthWest=function(){return new Tl(this.getWest(),this.getNorth())},Ml.prototype.getSouthEast=function(){return new Tl(this.getEast(),this.getSouth())},Ml.prototype.getWest=function(){return this._sw.lng},Ml.prototype.getSouth=function(){return this._sw.lat},Ml.prototype.getEast=function(){return this._ne.lng},Ml.prototype.getNorth=function(){return this._ne.lat},Ml.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Ml.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Ml.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Ml.prototype.contains=function(a){var t=Tl.convert(a),e=t.lng,o=t.lat,r=this._sw.lng<=e&&e<=this._ne.lng;return this._sw.lng>this._ne.lng&&(r=this._sw.lng>=e&&e>=this._ne.lng),this._sw.lat<=o&&o<=this._ne.lat&&r},Ml.convert=function(e){return!e||e instanceof Ml?e:new Ml(e)};var Tl=function(a,t){if(isNaN(a)||isNaN(t))throw new Error("Invalid LngLat object: ("+a+", "+t+")");if(this.lng=+a,this.lat=+t,90<this.lat||-90>this.lat)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Tl.prototype.wrap=function(){return new Tl(o(this.lng,-180,180),this.lat)},Tl.prototype.toArray=function(){return[this.lng,this.lat]},Tl.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Tl.prototype.distanceTo=function(a){var t=Ke/180,e=this.lat*t,o=a.lat*t,r=Je(e)*Je(o)+Ge(e)*Ge(o)*Ge((a.lng-this.lng)*t);return 6371008.8*p(Rt(r,1))},Tl.prototype.toBounds=function(a){void 0===a&&(a=0);var o=360*a/40075017,e=o/Ge(Ke/180*this.lat);return new Ml(new Tl(this.lng-e,this.lat-o),new Tl(this.lng+e,this.lat+o))},Tl.convert=function(e){if(e instanceof Tl)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new Tl(+e[0],+e[1]);if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new Tl(+("lng"in e?e.lng:e.lon),+e.lat);throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Pl=6371008.8*(2*Ke),Bl=function(a,t,e){void 0===e&&(e=0),this.x=+a,this.y=+t,this.z=+e};Bl.fromLngLat=function(a,t){void 0===t&&(t=0);var o=Tl.convert(a);return new Bl(Vl(o.lng),Fl(o.lat),Dl(t,o.lat))},Bl.prototype.toLngLat=function(){return new Tl(360*this.x-180,Ll(this.y))},Bl.prototype.toAltitude=function(){return this.z*El(Ll(this.y))},Bl.prototype.meterInMercatorCoordinateUnits=function(){return 1/Pl*(e=Ll(this.y),1/Ge(e*Ke/180));var e};var Ol=function(a,t,e){this.z=a,this.x=t,this.y=e,this.key=Rl(0,a,a,t,e)};Ol.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},Ol.prototype.url=function(l,t){var e=(c=this.y,p=this.z,u=ul(256*(d=this.x),256*(c=pa(2,p)-c-1),p),g=ul(256*(d+1),256*(c+1),p),u[0]+","+u[1]+","+g[0]+","+g[1]),s=function(o,t,e){for(var r="",l=o,s;0<l;l--)r+=(t&(s=1<<l-1)?1:0)+(e&s?2:0);return r}(this.z,this.x,this.y),d,c,p,u,g;return l[(this.x+this.y)%l.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",this.z+"").replace("{x}",this.x+"").replace("{y}",("tms"===t?pa(2,this.z)-this.y-1:this.y)+"").replace("{quadkey}",s).replace("{bbox-epsg-3857}",e)},Ol.prototype.getTilePoint=function(a){var t=pa(2,this.z);return new Qd(8192*(a.x*t-this.x),8192*(a.y*t-this.y))},Ol.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Ul=function(a,t){this.wrap=a,this.canonical=t,this.key=Rl(a,t.z,t.z,t.x,t.y)},jl=function(a,t,e,o,r){this.overscaledZ=a,this.wrap=t,this.canonical=new Ol(e,+o,+r),this.key=Rl(t,a,e,o,r)};jl.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},jl.prototype.scaledTo=function(a){var t=this.canonical.z-a;return a>this.canonical.z?new jl(a,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new jl(a,this.wrap,a,this.canonical.x>>t,this.canonical.y>>t)},jl.prototype.calculateScaledKey=function(a,t){var e=this.canonical.z-a;return a>this.canonical.z?Rl(this.wrap*+t,a,this.canonical.z,this.canonical.x,this.canonical.y):Rl(this.wrap*+t,a,a,this.canonical.x>>e,this.canonical.y>>e)},jl.prototype.isChildOf=function(a){if(a.wrap!==this.wrap)return!1;var t=this.canonical.z-a.canonical.z;return 0===a.overscaledZ||a.overscaledZ<this.overscaledZ&&a.canonical.x===this.canonical.x>>t&&a.canonical.y===this.canonical.y>>t},jl.prototype.children=function(a){if(this.overscaledZ>=a)return[new jl(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,e=2*this.canonical.x,o=2*this.canonical.y;return[new jl(t,this.wrap,t,e,o),new jl(t,this.wrap,t,e+1,o),new jl(t,this.wrap,t,e,o+1),new jl(t,this.wrap,t,e+1,o+1)]},jl.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},jl.prototype.wrapped=function(){return new jl(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},jl.prototype.unwrapTo=function(e){return new jl(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},jl.prototype.overscaleFactor=function(){return pa(2,this.overscaledZ-this.canonical.z)},jl.prototype.toUnwrapped=function(){return new Ul(this.wrap,this.canonical)},jl.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},jl.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new Bl(e.x-this.wrap,e.y))},Tn("CanonicalTileID",Ol),Tn("OverscaledTileID",jl,{omit:["posMatrix"]});var ql=function(a,t,e){if(this.uid=a,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(e&&"mapbox"!==e&&"terrarium"!==e)return ad("\""+e+"\" is not a valid encoding type. Valid types include \"mapbox\" and \"terrarium\".");this.stride=t.height;var o=this.dim=t.height-2;this.data=new Uint32Array(t.data.buffer),this.encoding=e||"mapbox";for(var r=0;r<o;r++)this.data[this._idx(-1,r)]=this.data[this._idx(0,r)],this.data[this._idx(o,r)]=this.data[this._idx(o-1,r)],this.data[this._idx(r,-1)]=this.data[this._idx(r,0)],this.data[this._idx(r,o)]=this.data[this._idx(r,o-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(o,-1)]=this.data[this._idx(o-1,0)],this.data[this._idx(-1,o)]=this.data[this._idx(0,o-1)],this.data[this._idx(o,o)]=this.data[this._idx(o-1,o-1)]};ql.prototype.get=function(a,t){var e=new Uint8Array(this.data.buffer),o=4*this._idx(a,t);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(e[o],e[o+1],e[o+2])},ql.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},ql.prototype._idx=function(a,t){if(-1>a||a>=this.dim+1||-1>t||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(a+1)},ql.prototype._unpackMapbox=function(a,t,e){return(256*(256*a)+256*t+e)/10-1e4},ql.prototype._unpackTerrarium=function(a,t,e){return 256*a+t+e/256-32768},ql.prototype.getPixels=function(){return new ho({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},ql.prototype.backfillBorder=function(d,t,e){if(this.dim!==d.dim)throw new Error("dem dimension mismatch");var r=t*this.dim,c=t*this.dim+this.dim,g=e*this.dim,m=e*this.dim+this.dim;-1===t?r=c-1:1===t?c=r+1:void 0,-1===e?g=m-1:1===e?m=g+1:void 0;for(var h=-t*this.dim,s=-e*this.dim,u=g;u<m;u++)for(var y=r;y<c;y++)this.data[this._idx(y,u)]=d.data[this._idx(y+h,u+s)]},Tn("DEMData",ql);var Kl=function(a){this._stringToNumber={},this._numberToString=[];for(var t=0,o;t<a.length;t++)o=a[t],this._stringToNumber[o]=t,this._numberToString[t]=o};Kl.prototype.encode=function(e){return this._stringToNumber[e]},Kl.prototype.decode=function(e){return this._numberToString[e]};var Gl=function(a,t,e,o,r){this.type="Feature",this._vectorTileFeature=a,a._z=t,a._x=e,a._y=o,this.properties=a.properties,this.id=r},Zl={geometry:{configurable:!0}};Zl.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Zl.geometry.set=function(e){this._geometry=e},Gl.prototype.toJSON=function(){var a={geometry:this.geometry};for(var t in this)"_geometry"!=t&&"_vectorTileFeature"!==t&&(a[t]=this[t]);return a},Object.defineProperties(Gl.prototype,Zl);var Xl=function(){this.state={},this.stateChanges={},this.deletedStates={}};Xl.prototype.updateState=function(l,t,e){var r=t+"";if(this.stateChanges[l]=this.stateChanges[l]||{},this.stateChanges[l][r]=this.stateChanges[l][r]||{},_o(this.stateChanges[l][r],e),null===this.deletedStates[l])for(var n in this.deletedStates[l]={},this.state[l])n!==r&&(this.deletedStates[l][n]=null);else if(this.deletedStates[l]&&null===this.deletedStates[l][r])for(var i in this.deletedStates[l][r]={},this.state[l][r])e[i]||(this.deletedStates[l][r][i]=null);else for(var a in e)this.deletedStates[l]&&this.deletedStates[l][r]&&null===this.deletedStates[l][r][a]&&delete this.deletedStates[l][r][a]},Xl.prototype.removeFeatureState=function(a,t,e){if(null!==this.deletedStates[a]){var o=t+"";if(this.deletedStates[a]=this.deletedStates[a]||{},e&&void 0!==t)null!==this.deletedStates[a][o]&&(this.deletedStates[a][o]=this.deletedStates[a][o]||{},this.deletedStates[a][o][e]=null);else if(void 0===t)this.deletedStates[a]=null;else if(this.stateChanges[a]&&this.stateChanges[a][o])for(e in this.deletedStates[a][o]={},this.stateChanges[a][o])this.deletedStates[a][o][e]=null;else this.deletedStates[a][o]=null}},Xl.prototype.getState=function(o,t){var e=t+"",r=_o({},(this.state[o]||{})[e],(this.stateChanges[o]||{})[e]);if(null===this.deletedStates[o])return{};if(this.deletedStates[o]){var n=this.deletedStates[o][t];if(null===n)return{};for(var i in n)delete r[i]}return r},Xl.prototype.initializeTileState=function(a,t){a.setFeatureState(this.state,t)},Xl.prototype.coalesceChanges=function(d,t){var e={};for(var r in this.stateChanges){this.state[r]=this.state[r]||{};var n={};for(var i in this.stateChanges[r])this.state[r][i]||(this.state[r][i]={}),_o(this.state[r][i],this.stateChanges[r][i]),n[i]=this.state[r][i];e[r]=n}for(var a in this.deletedStates){this.state[a]=this.state[a]||{};var o={};if(null===this.deletedStates[a])for(var s in this.state[a])o[s]={},this.state[a][s]={};else for(var p in this.deletedStates[a]){if(null===this.deletedStates[a][p])this.state[a][p]={};else for(var l=0,u=Object.keys(this.deletedStates[a][p]);l<u.length;l+=1)delete this.state[a][p][u[l]];o[p]=this.state[a][p]}e[a]=e[a]||{},_o(e[a],o)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(e).length)for(var g in d)d[g].setFeatureState(e,t)};var Jl=function(a,t){this.tileID=a,this.x=a.canonical.x,this.y=a.canonical.y,this.z=a.canonical.z,this.grid=new Cn(8192,16,0),this.grid3D=new Cn(8192,16,0),this.featureIndexArray=new ea,this.promoteId=t};Jl.prototype.insert=function(d,t,e,r,n,i){var a=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(e,r,n);for(var o=i?this.grid3D:this.grid,s=0;s<t.length;s++){for(var g=t[s],l=[1/0,1/0,-1/0,-1/0],p=0,m;p<g.length;p++)m=g[p],l[0]=Rt(l[0],m.x),l[1]=Rt(l[1],m.y),l[2]=ha(l[2],m.x),l[3]=ha(l[3],m.y);8192>l[0]&&8192>l[1]&&0<=l[2]&&0<=l[3]&&o.insert(a,l[0],l[1],l[2],l[3])}},Jl.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new cs.VectorTile(new Ns(this.rawTileData)).layers,this.sourceLayerCoder=new Kl(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Jl.prototype.query=function(i,t,e,r){var _=this;this.loadVTLayers();for(var a=i.params||{},o=8192/i.tileSize/i.scale,n=tn(a.filter),s=i.queryGeometry,l=i.queryPadding*o,p=Yl(s),u=this.grid.query(p.minX-l,p.minY-l,p.maxX+l,p.maxY+l),c=Yl(i.cameraQueryGeometry),h=this.grid3D.query(c.minX-l,c.minY-l,c.maxX+l,c.maxY+l,function(t,e,o,r){return function(i,t,e,r,n){for(var a=0,d=i,s;a<d.length;a+=1)if(s=d[a],t<=s.x&&e<=s.y&&r>=s.x&&n>=s.y)return!0;var g=[new Qd(t,e),new Qd(t,n),new Qd(r,n),new Qd(r,e)];if(2<i.length)for(var l=0,m=g;l<m.length;l+=1)if(Za(i,m[l]))return!0;for(var c=0;c<i.length-1;c++)if(Xa(i[c],i[c+1],g))return!0;return!1}(i.cameraQueryGeometry,t-l,e-l,o+l,r+l)}),y=0,f=h;y<f.length;y+=1)u.push(f[y]);u.sort($l);for(var m={},g=function(l){var d=u[l];if(d!==w){w=d;var p=_.featureIndexArray.get(d),c=null;_.loadMatchingFeature(m,p.bucketIndex,p.sourceLayerIndex,p.featureIndex,n,a.layers,a.availableImages,t,e,r,function(t,e,a){return c||(c=Ba(t)),e.queryIntersectsFeature(s,t,a,c,_.z,i.transform,o,i.pixelPosMatrix)})}},x=0,w;x<u.length;x++)g(x);return m},Jl.prototype.loadMatchingFeature=function(k,t,e,r,n,i,a,o,s,u,l){var p=this.bucketLayerIDs[t];if(!i||function(a,t){for(var e=0;e<a.length;e++)if(0<=t.indexOf(a[e]))return!0;return!1}(i,p)){var c=this.sourceLayerCoder.decode(e),h=this.vtLayers[c].feature(r);if(n.filter(new ni(this.tileID.overscaledZ),h))for(var f=this.getId(h,c),y=0,T;y<p.length;y++)if(T=p[y],!(i&&0>i.indexOf(T))){var A=o[T];if(A){var v={};void 0!==f&&u&&(v=u.getState(A.sourceLayer||"_geojsonTileLayer",f));var S=s[T];S.paint=Nl(S.paint,A.paint,h,v,a),S.layout=Nl(S.layout,A.layout,h,v,a);var x=!l||l(h,A,v);if(x){var b=new Gl(h,this.z,this.x,this.y,f);b.layer=S;var w=k[T];void 0===w&&(w=k[T]=[]),w.push({featureIndex:r,feature:b,intersectionZ:x})}}}}},Jl.prototype.lookupSymbolFeatures=function(d,t,e,r,n,i,a,o){var s={};this.loadVTLayers();for(var u=tn(n),l=0,g=d;l<g.length;l+=1)this.loadMatchingFeature(s,e,r,g[l],u,i,a,o,t);return s},Jl.prototype.hasLayer=function(a){for(var t=0,o=this.bucketLayerIDs;t<o.length;t+=1)for(var r=0,l=o[t];r<l.length;r+=1)if(a===l[r])return!0;return!1},Jl.prototype.getId=function(a,t){var e=a.id;return this.promoteId&&"boolean"==typeof(e=a.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[t]])&&(e=+e),e},Tn("FeatureIndex",Jl,{omit:["rawTileData","sourceLayerCoder"]});var Hl=function(a,t){this.tileID=a,this.uid=l(),this.uses=0,this.tileSize=t,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Hl.prototype.registerFadeDuration=function(a){var t=a+this.timeAdded;t<F.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},Hl.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},Hl.prototype.loadVectorData=function(l,t,e){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",l){for(var r in l.featureIndex&&(this.latestFeatureIndex=l.featureIndex,l.rawTileData?(this.latestRawTileData=l.rawTileData,this.latestFeatureIndex.rawTileData=l.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=l.collisionBoxArray,this.buckets=function(o,l){var e={};if(!l)return e;for(var t=function(){var a=d[r],i=a.layerIds.map(function(e){return l.getLayer(e)}).filter(Boolean);if(0!==i.length){a.layers=i,a.stateDependentLayerIds&&(a.stateDependentLayers=a.stateDependentLayerIds.map(function(a){return i.filter(function(t){return t.id===a})[0]}));for(var t=0,n=i;t<n.length;t+=1)e[n[t].id]=a}},r=0,d=o;r<d.length;r+=1)t();return e}(l.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var n=this.buckets[r];if(n instanceof pl){if(this.hasSymbolBuckets=!0,!e)break;n.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var i in this.buckets){var a=this.buckets[i];if(a instanceof pl&&a.hasRTLText){this.hasRTLText=!0,ri.isLoading()||ri.isLoaded()||"deferred"!==ti()||ei();break}}for(var o in this.queryPadding=0,this.buckets){var s=this.buckets[o];this.queryPadding=ha(this.queryPadding,t.style.getLayer(o).queryRadius(s))}l.imageAtlas&&(this.imageAtlas=l.imageAtlas),l.glyphAtlasImage&&(this.glyphAtlasImage=l.glyphAtlasImage)}else this.collisionBoxArray=new Xi},Hl.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Hl.prototype.getBucket=function(e){return this.buckets[e.id]},Hl.prototype.upload=function(a){for(var t in this.buckets){var e=this.buckets[t];e.uploadPending()&&e.upload(a)}var o=a.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Il(a,this.imageAtlas.image,o.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Il(a,this.glyphAtlasImage,o.ALPHA),this.glyphAtlasImage=null)},Hl.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},Hl.prototype.queryRenderedFeatures=function(d,t,e,r,n,i,a,o,s,c){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:r,cameraQueryGeometry:n,scale:i,tileSize:this.tileSize,pixelPosMatrix:c,transform:o,params:a,queryPadding:this.queryPadding*s},d,t,e):{}},Hl.prototype.querySourceFeatures=function(g,t){var e=this.latestFeatureIndex;if(e&&e.rawTileData){var r=e.loadVTLayers(),n=t?t.sourceLayer:"",i=r._geojsonTileLayer||r[n];if(i)for(var a=tn(t&&t.filter),o=this.tileID.canonical,s=o.z,u=o.x,l=o.y,p={z:s,x:u,y:l},c=0,m;c<i.length;c++)if(m=i.feature(c),a.filter(new ni(this.tileID.overscaledZ),m)){var x=e.getId(m,n),y=new Gl(m,s,u,l,x);y.tile=p,g.push(y)}}},Hl.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},Hl.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Hl.prototype.setExpiryData=function(o){var t=this.expirationTime;if(o.cacheControl){var e=S(o.cacheControl);e["max-age"]&&(this.expirationTime=Date.now()+1e3*e["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){var r=Date.now(),n=!1;if(this.expirationTime>r)n=!1;else if(!t)n=!0;else if(this.expirationTime<t)n=!0;else{var l=this.expirationTime-t;l?this.expirationTime=r+ha(l,3e4):n=!0}n?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Hl.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Rt(this.expiredRequestCount-1,31)):Rt(this.expirationTime-new Date().getTime(),pa(2,31)-1)},Hl.prototype.setFeatureState=function(l,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(l).length){var e=this.latestFeatureIndex.loadVTLayers();for(var r in this.buckets)if(t.style.hasLayer(r)){var n=this.buckets[r],i=n.layers[0].sourceLayer||"_geojsonTileLayer",a=e[i],o=l[i];if(a&&o&&0!==Object.keys(o).length){n.update(o,a,this.imageAtlas&&this.imageAtlas.patternPositions||{});var s=t&&t.style&&t.style.getLayer(r);s&&s.paint&&(this.queryPadding=ha(this.queryPadding,s.queryRadius(n)))}}}},Hl.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},Hl.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<F.now()},Hl.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Hl.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=F.now()+e},Hl.prototype.setDependencies=function(a,t){for(var e={},o=0,r=t;o<r.length;o+=1)e[r[o]]=!0;this.dependencies[a]=e},Hl.prototype.hasDependency=function(l,t){for(var e=0,s=l,n;e<s.length;e+=1)if(n=this.dependencies[s[e]],n)for(var d=0,c=t;d<c.length;d+=1)if(n[c[d]])return!0;return!1};var Ql=self.performance,jc=function(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},Ql.mark(this._marks.start)};jc.prototype.finish=function(){Ql.mark(this._marks.end);var e=Ql.getEntriesByName(this._marks.measure);return 0===e.length&&(Ql.measure(this._marks.measure,this._marks.start,this._marks.end),e=Ql.getEntriesByName(this._marks.measure),Ql.clearMarks(this._marks.start),Ql.clearMarks(this._marks.end),Ql.clearMeasures(this._marks.measure)),e},q.Actor=Cl,q.AlphaImage=uo,q.CanonicalTileID=Ol,q.CollisionBoxArray=Xi,q.Color=Yt,q.DEMData=ql,q.DataConstantProperty=hi,q.DictionaryCoder=Kl,q.EXTENT=8192,q.ErrorEvent=At,q.EvaluationParameters=ni,q.Event=bt,q.Evented=St,q.FeatureIndex=Jl,q.FillBucket=wo,q.FillExtrusionBucket=vs,q.ImageAtlas=Tc,q.ImagePosition=Zs,q.LineBucket=Cs,q.LngLat=Tl,q.LngLatBounds=Ml,q.MercatorCoordinate=Bl,q.ONE_EM=24,q.OverscaledTileID=jl,q.Point=Qd,q.Point$1=Qd,q.Properties=vi,q.Protobuf=Ns,q.RGBAImage=ho,q.RequestManager=nc,q.RequestPerformance=jc,q.ResourceType=dc,q.SegmentVector=na,q.SourceFeatureState=Xl,q.StructArrayLayout1ui2=Ni,q.StructArrayLayout2f1f2i16=Vi,q.StructArrayLayout2i4=_i,q.StructArrayLayout3ui6=Di,q.StructArrayLayout4i8=ki,q.SymbolBucket=pl,q.Texture=Il,q.Tile=Hl,q.Transitionable=oi,q.Uniform1f=bc,q.Uniform1i=da,q.Uniform2f=va,q.Uniform3f=vc,q.Uniform4f=xa,q.UniformColor=ba,q.UniformMatrix4f=_a,q.UnwrappedTileID=Ul,q.ValidationError=It,q.WritingMode=Ac,q.ZoomHistory=Dn,q.add=function(a,t,e){return a[0]=t[0]+e[0],a[1]=t[1]+e[1],a[2]=t[2]+e[2],a},q.addDynamicAttributes=ol,q.asyncAll=function(o,l,s){if(!o.length)return s(null,[]);var r=o.length,d=Array(o.length),i=null;o.forEach(function(e,a){l(e,function(o,t){o&&(i=o),d[a]=t,0==--r&&s(i,d)})})},q.bezier=a,q.bindAll=y,q.browser=F,q.cacheEntryPossiblyAdded=function(e){++sc>lc&&(e.getActor().send("enforceCacheSizeLimit",it),sc=0)},q.clamp=io,q.clearTileCache=function(a){var t=self.caches.delete("mapbox-tiles");a&&t.catch(a).then(function(){return a()})},q.clipLine=Fd,q.clone=function(a){var t=new Qa(16);return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[8]=a[8],t[9]=a[9],t[10]=a[10],t[11]=a[11],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15],t},q.clone$1=td,q.clone$2=function(a){var t=new Qa(3);return t[0]=a[0],t[1]=a[1],t[2]=a[2],t},q.collisionCircleLayout=Rs,q.config=D,q.create=function(){var e=new Qa(16);return Qa!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},q.create$1=function(){var e=new Qa(9);return Qa!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},q.create$2=function(){var e=new Qa(4);return Qa!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},q.createCommonjsModule=t,q.createExpression=qr,q.createLayout=Qn,q.createStyleLayer=function(e){return"custom"===e.type?new xl(e):new bl[e.type](e)},q.cross=function(l,t,e){var r=t[0],n=t[1],i=t[2],a=e[0],o=e[1],s=e[2];return l[0]=n*s-i*o,l[1]=i*a-r*s,l[2]=r*o-n*a,l},q.deepEqual=function a(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(var o=0;o<t.length;o++)if(!a(t[o],e[o]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==e){if("object"!=typeof e)return!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(var r in t)if(!a(t[r],e[r]))return!1;return!0}return t===e},q.dot=function(a,t){return a[0]*t[0]+a[1]*t[1]+a[2]*t[2]},q.dot$1=function(a,t){return a[0]*t[0]+a[1]*t[1]+a[2]*t[2]+a[3]*t[3]},q.ease=r,q.emitValidationErrors=Sn,q.endsWith=ed,q.enforceCacheSizeLimit=function(a){Y(),ht&&ht.then(function(t){t.keys().then(function(e){for(var o=0;o<e.length-a;o++)t.delete(e[o])})})},q.evaluateSizeForFeature=Pd,q.evaluateSizeForZoom=zd,q.evaluateVariableOffset=Zd,q.evented=Wn,q.extend=_o,q.featureFilter=tn,q.filterObject=v,q.fromRotation=function(a,t){var e=Je(t),o=Ge(t);return a[0]=o,a[1]=e,a[2]=0,a[3]=-e,a[4]=o,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},q.getAnchorAlignment=Cd,q.getAnchorJustification=Kd,q.getArrayBuffer=vt,q.getImage=mc,q.getJSON=function(a,t){return yt(_o(a,{type:"json"}),t)},q.getRTLTextPluginStatus=ti,q.getReferrer=ft,q.getVideo=function(l,t){var e=self.document.createElement("video"),i,s;e.muted=!0,e.onloadstart=function(){t(null,e)};for(var d=0,c;d<l.length;d++)c=self.document.createElement("source"),i=l[d],s=void 0,(s=self.document.createElement("a")).href=i,(s.protocol!==self.document.location.protocol||s.host!==self.document.location.host)&&(e.crossOrigin="Anonymous"),c.src=l[d],e.appendChild(c);return{cancel:function(){}}},q.identity=$a,q.invert=function(T,t){var e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],o=t[5],s=t[6],u=t[7],l=t[8],p=t[9],c=t[10],h=t[11],f=t[12],y=t[13],d=t[14],m=t[15],v=e*o-r*a,g=e*s-n*a,x=e*u-i*a,b=r*s-n*o,w=r*u-i*o,_=n*u-i*s,A=l*y-p*f,S=l*d-c*f,k=l*m-h*f,L=p*d-c*y,I=p*m-h*y,C=c*m-h*d,P=v*C-g*I+x*L+b*k-w*S+_*A;return P?(T[0]=(o*C-s*I+u*L)*(P=1/P),T[1]=(n*I-r*C-i*L)*P,T[2]=(y*_-d*w+m*b)*P,T[3]=(c*w-p*_-h*b)*P,T[4]=(s*k-a*C-u*S)*P,T[5]=(e*C-n*k+i*S)*P,T[6]=(d*x-f*_-m*g)*P,T[7]=(l*_-c*x+h*g)*P,T[8]=(a*I-o*k+u*A)*P,T[9]=(r*k-e*I-i*A)*P,T[10]=(f*w-y*x+m*v)*P,T[11]=(p*x-l*w-h*v)*P,T[12]=(o*S-a*L-s*A)*P,T[13]=(e*L-r*S+n*A)*P,T[14]=(y*g-f*b-d*v)*P,T[15]=(l*b-p*g+c*v)*P,T):null},q.isChar=jn,q.isMapboxURL=j,q.keysDifference=function(a,t){var e=[];for(var o in a)o in t||e.push(o);return e},q.makeRequest=yt,q.mapObject=m,q.mercatorXfromLng=Vl,q.mercatorYfromLat=Fl,q.mercatorZfromAltitude=Dl,q.mul=eo,q.multiply=eo,q.mvt=cs,q.normalize=function(o,t){var e=t[0],r=t[1],n=t[2],i=e*e+r*r+n*n;return 0<i&&(i=1/We(i)),o[0]=t[0]*i,o[1]=t[1]*i,o[2]=t[2]*i,o},q.number=Oe,q.offscreenCanvasSupported=ut,q.ortho=function(d,t,e,r,n,i,a){var o=1/(t-e),s=1/(r-n),c=1/(i-a);return d[0]=-2*o,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=-2*s,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=2*c,d[11]=0,d[12]=(t+e)*o,d[13]=(n+r)*s,d[14]=(a+i)*c,d[15]=1,d},q.parseGlyphPBF=function(e){return new Ns(e).readFields(fd,[])},q.pbf=Ns,q.performSymbolLayout=function(w,t,e,r,n,i,N){w.createArrays(),w.tilePixelRatio=8192/(512*w.overscaling),w.compareText={},w.iconsNeedLinear=!1;var o=w.layers[0].layout,a=w.layers[0]._unevaluatedLayout._values,s={};if("composite"===w.textSizeData.kind){var l=w.textSizeData,p=l.maxZoom;s.compositeTextSizes=[a["text-size"].possiblyEvaluate(new ni(l.minZoom),N),a["text-size"].possiblyEvaluate(new ni(p),N)]}if("composite"===w.iconSizeData.kind){var c=w.iconSizeData,u=c.maxZoom;s.compositeIconSizes=[a["icon-size"].possiblyEvaluate(new ni(c.minZoom),N),a["icon-size"].possiblyEvaluate(new ni(u),N)]}s.layoutTextSize=a["text-size"].possiblyEvaluate(new ni(w.zoom+1),N),s.layoutIconSize=a["icon-size"].possiblyEvaluate(new ni(w.zoom+1),N),s.textMaxSize=a["text-size"].possiblyEvaluate(new ni(18));for(var h=24*o.get("text-line-height"),y="map"===o.get("text-rotation-alignment")&&"point"!==o.get("symbol-placement"),d=o.get("text-keep-upright"),m=o.get("text-size"),f=function(){var i=H[v],a=o.get("text-font").evaluate(i,{},N).join(","),l=m.evaluate(i,{},N),p=s.layoutTextSize.evaluate(i,{},N),c=s.layoutIconSize.evaluate(i,{},N),u={horizontal:{},vertical:void 0},f=i.text,g=[0,0];if(f){var x=f.toString(),b=24*o.get("text-letter-spacing").evaluate(i,{},N),A=function(a){for(var t=0,o=a;t<o.length;t+=1)if(r=o[t].charCodeAt(0),jn.Arabic(r)||jn["Arabic Supplement"](r)||jn["Arabic Extended-A"](r)||jn["Arabic Presentation Forms-A"](r)||jn["Arabic Presentation Forms-B"](r))return!1;var r;return!0}(x)?b:0,k=o.get("text-anchor").evaluate(i,{},N),S=o.get("text-variable-anchor");if(!S){var I=o.get("text-radial-offset").evaluate(i,{},N);g=I?Zd(k,[24*I,Oc]):o.get("text-offset").evaluate(i,{},N).map(function(e){return 24*e})}var C=y?"center":o.get("text-justify").evaluate(i,{},N),z=o.get("symbol-placement"),E="point"===z?24*o.get("text-max-width").evaluate(i,{},N):0,T=function(){w.allowVerticalPlacement&&Un(x)&&(u.vertical=vd(f,t,e,n,a,E,h,k,"left",A,g,Ac.vertical,!0,z,p,l))};if(!y&&S){for(var P="auto"===C?S.map(function(e){return Kd(e)}):[C],B=!1,G=0,Y;G<P.length;G++)if(Y=P[G],!u.horizontal[Y])if(B)u.horizontal[Y]=u.horizontal[0];else{var W=vd(f,t,e,n,a,E,h,"center",Y,A,g,Ac.horizontal,!1,z,p,l);W&&(u.horizontal[Y]=W,B=1===W.positionedLines.length)}T()}else{"auto"===C&&(C=Kd(k));var L=vd(f,t,e,n,a,E,h,k,C,A,g,Ac.horizontal,!1,z,p,l);L&&(u.horizontal[C]=L),T(),Un(x)&&y&&d&&(u.vertical=vd(f,t,e,n,a,E,h,k,C,A,g,Ac.vertical,!1,z,p,l))}}var R=!1,X;if(i.icon&&i.icon.name){var Z=r[i.icon.name];Z&&(X=function(o,t,e){var r=Cd(e),n=t[0]-o.displaySize[0]*r.horizontalAlign,i=t[1]-o.displaySize[1]*r.verticalAlign;return{image:o,top:i,bottom:i+o.displaySize[1],left:n,right:n+o.displaySize[0]}}(n[i.icon.name],o.get("icon-offset").evaluate(i,{},N),o.get("icon-anchor").evaluate(i,{},N)),R=Z.sdf,void 0===w.sdfIcons?w.sdfIcons=Z.sdf:w.sdfIcons!==Z.sdf&&ad("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Z.pixelRatio!==w.pixelRatio||0!==o.get("icon-rotate").constantOr(1))&&(w.iconsNeedLinear=!0))}var j=el(u.horizontal)||u.vertical;w.iconsInText=!!j&&j.iconsInText,(j||X)&&function(w,t,e,r,C,i,a,o,Q,u,l){var s=i.textMaxSize.evaluate(t,{});void 0===s&&(s=a);var p=w.layers[0].layout,f=p.get("icon-offset").evaluate(t,{},l),y=el(e.horizontal),d=a/24,m=w.tilePixelRatio*d,v=w.tilePixelRatio*s/24,g=w.tilePixelRatio*o,x=w.tilePixelRatio*p.get("symbol-spacing"),b=p.get("text-padding")*w.tilePixelRatio,_=p.get("icon-padding")*w.tilePixelRatio,A=p.get("text-max-angle")/180*Ke,S="map"===p.get("text-rotation-alignment")&&"point"!==p.get("symbol-placement"),k="map"===p.get("icon-rotation-alignment")&&"point"!==p.get("symbol-placement"),I=p.get("symbol-placement"),z=p.get("icon-text-fit"),M;r&&"none"!==z&&(w.allowVerticalPlacement&&e.vertical&&(M=Ed(r,e.vertical,z,p.get("icon-text-fit-padding"),f,d)),y&&(r=Ed(r,y,z,p.get("icon-text-fit-padding"),f,d)));var ee=function(o,n){0>n.x||8192<=n.x||0>n.y||8192<=n.y||function(w,t,e,r,n,i,a,o,s,u,l,p,c,h,f,y,d,m,v,g,x,b,_,A,S){var k=w.addToLineVertexArray(t,e),T=0,ee=0,te=0,ae=0,oe=-1,re=-1,ie={},R=_c(""),ne=0,le=0,se,de,ce,pe,ue;if(void 0===o._unevaluatedLayout.getValue("text-radial-offset")?(ne=(se=o.layout.get("text-offset").evaluate(x,{},A).map(function(e){return 24*e}))[0],le=se[1]):(ne=24*o.layout.get("text-radial-offset").evaluate(x,{},A),le=Oc),w.allowVerticalPlacement&&r.vertical){var ge=o.layout.get("text-rotate").evaluate(x,{},A)+90;pe=new zc(s,t,u,l,p,r.vertical,c,h,f,ge),a&&(ue=new zc(s,t,u,l,p,a,d,m,f,ge))}if(n){var q=o.layout.get("icon-rotate").evaluate(x,{}),N="none"!==o.layout.get("icon-text-fit"),K=Nd(n,q,_,N),G=a?Nd(a,q,_,N):void 0;ce=new zc(s,t,u,l,p,n,d,m,!1,q),T=4*K.length;var Z=w.iconSizeData,X=null;"source"===Z.kind?32640<(X=[128*o.layout.get("icon-size").evaluate(x,{})])[0]&&ad(w.layerIds[0]+": Value for \"icon-size\" is >= 255. Reduce your \"icon-size\"."):"composite"===Z.kind&&(32640<(X=[128*b.compositeIconSizes[0].evaluate(x,{},A),128*b.compositeIconSizes[1].evaluate(x,{},A)])[0]||32640<X[1])&&ad(w.layerIds[0]+": Value for \"icon-size\" is >= 255. Reduce your \"icon-size\"."),w.addSymbols(w.icon,K,X,g,v,x,!1,t,k.lineStartIndex,k.lineLength,-1,A),oe=w.icon.placedSymbolArray.length-1,G&&(ee=4*G.length,w.addSymbols(w.icon,G,X,g,v,x,Ac.vertical,t,k.lineStartIndex,k.lineLength,-1,A),re=w.icon.placedSymbolArray.length-1)}for(var me in r.horizontal){var H=r.horizontal[me];if(!de){R=_c(H.text);var Y=o.layout.get("text-rotate").evaluate(x,{},A);de=new zc(s,t,u,l,p,H,c,h,f,Y)}var $=1===H.positionedLines.length;if(te+=tl(w,t,H,i,o,f,x,y,k,r.vertical?Ac.horizontal:Ac.horizontalOnly,$?Object.keys(r.horizontal):[me],ie,oe,b,A),$)break}r.vertical&&(ae+=tl(w,t,r.vertical,i,o,f,x,y,k,Ac.vertical,["vertical"],ie,re,b,A));var W=de?de.boxStartIndex:w.collisionBoxArray.length,Q=de?de.boxEndIndex:w.collisionBoxArray.length,he=pe?pe.boxStartIndex:w.collisionBoxArray.length,ye=pe?pe.boxEndIndex:w.collisionBoxArray.length,fe=ce?ce.boxStartIndex:w.collisionBoxArray.length,xe=ce?ce.boxEndIndex:w.collisionBoxArray.length,_e=ue?ue.boxStartIndex:w.collisionBoxArray.length,be=ue?ue.boxEndIndex:w.collisionBoxArray.length,ve=-1,we=function(a,t){return a&&a.circleDiameter?ha(a.circleDiameter,t):t};ve=we(de,ve),ve=we(pe,ve),ve=we(ce,ve);var ke=-1<(ve=we(ue,ve))?1:0;ke&&(ve*=S/24),w.glyphOffsetArray.length>=pl.MAX_GLYPHS&&ad("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==x.sortKey&&w.addToSortKeyRanges(w.symbolInstances.length,x.sortKey),w.symbolInstances.emplaceBack(t.x,t.y,0<=ie.right?ie.right:-1,0<=ie.center?ie.center:-1,0<=ie.left?ie.left:-1,ie.vertical||-1,oe,re,R,W,Q,he,ye,fe,xe,_e,be,u,te,ae,T,ee,ke,0,c,ne,le,ve)}(w,n,o,e,r,C,M,w.layers[0],w.collisionBoxArray,t.index,t.sourceLayerIndex,w.index,m,b,S,Q,g,_,k,f,t,i,u,l,a)};if("line"===I)for(var E=0,te=Fd(t.geometry,0,0,8192,8192);E<te.length;E+=1)for(var P=te[E],B=0,ae=Bd(P,x,A,e.vertical||y,r,24,v,w.overscaling,8192),F;B<ae.length;B+=1)F=ae[B],y&&rl(w,y.text,x/2,F)||ee(P,F);else if("line-center"===I){for(var oe=0,re=t.geometry,R;oe<re.length;oe+=1)if(R=re[oe],1<R.length){var ie=jd(R,A,e.vertical||y,r,24,v);ie&&ee(R,ie)}}else if("Polygon"===t.type)for(var U=0,ne=$o(t.geometry,0);U<ne.length;U+=1){var q=ne[U],N=Yd(q,16);ee(q[0],new Ic(N.x,N.y,0))}else if("LineString"===t.type)for(var K=0,le=t.geometry,Z;K<le.length;K+=1)Z=le[K],ee(Z,new Ic(Z[0].x,Z[0].y,0));else if("Point"===t.type)for(var se=0,de=t.geometry;se<de.length;se+=1)for(var H=0,ce=de[se],$;H<ce.length;H+=1)$=ce[H],ee([$],new Ic($.x,$.y,0))}(w,i,u,X,r,s,p,c,g,R,N)},v=0,H=w.features;v<H.length;v+=1)f();i&&w.generateCollisionDebugBuffers()},q.perspective=function(l,t,e,r,n){var i=1/ua(t/2),o;return l[0]=i/e,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=i,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=-1,l[12]=0,l[13]=0,l[15]=0,null!=n&&n!==1/0?(l[10]=(n+r)*(o=1/(r-n)),l[14]=2*n*r*o):(l[10]=-1,l[14]=-2*r),l},q.pick=function(a,t){for(var e={},o=0,r;o<t.length;o++)r=t[o],r in a&&(e[r]=a[r]);return e},q.plugin=ri,q.polygonIntersectsPolygon=Da,q.postMapLoadEvent=nt,q.postTurnstileEvent=et,q.potpack=bd,q.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],q.register=Tn,q.registerForPluginStateChange=function(e){return e({pluginStatus:yc,pluginURL:fc}),Wn.on("pluginStateChange",e),e},q.rotate=function(l,t,e){var r=t[0],n=t[1],i=t[2],a=t[3],o=Je(e),s=Ge(e);return l[0]=r*s+i*o,l[1]=n*s+a*o,l[2]=r*-o+i*s,l[3]=n*-o+a*s,l},q.rotateX=function(d,t,e){var r=Je(e),n=Ge(e),i=t[4],a=t[5],o=t[6],s=t[7],u=t[8],l=t[9],p=t[10],c=t[11];return t!==d&&(d[0]=t[0],d[1]=t[1],d[2]=t[2],d[3]=t[3],d[12]=t[12],d[13]=t[13],d[14]=t[14],d[15]=t[15]),d[4]=i*n+u*r,d[5]=a*n+l*r,d[6]=o*n+p*r,d[7]=s*n+c*r,d[8]=u*n-i*r,d[9]=l*n-a*r,d[10]=p*n-o*r,d[11]=c*n-s*r,d},q.rotateZ=function(d,t,e){var r=Je(e),n=Ge(e),i=t[0],a=t[1],o=t[2],s=t[3],u=t[4],l=t[5],p=t[6],c=t[7];return t!==d&&(d[8]=t[8],d[9]=t[9],d[10]=t[10],d[11]=t[11],d[12]=t[12],d[13]=t[13],d[14]=t[14],d[15]=t[15]),d[0]=i*n+u*r,d[1]=a*n+l*r,d[2]=o*n+p*r,d[3]=s*n+c*r,d[4]=u*n-i*r,d[5]=l*n-a*r,d[6]=p*n-o*r,d[7]=c*n-s*r,d},q.scale=function(o,t,e){var r=e[0],n=e[1],i=e[2];return o[0]=t[0]*r,o[1]=t[1]*r,o[2]=t[2]*r,o[3]=t[3]*r,o[4]=t[4]*n,o[5]=t[5]*n,o[6]=t[6]*n,o[7]=t[7]*n,o[8]=t[8]*i,o[9]=t[9]*i,o[10]=t[10]*i,o[11]=t[11]*i,o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15],o},q.scale$1=function(a,t,e){return a[0]=t[0]*e,a[1]=t[1]*e,a[2]=t[2]*e,a[3]=t[3]*e,a},q.scale$2=function(a,t,e){return a[0]=t[0]*e,a[1]=t[1]*e,a[2]=t[2]*e,a},q.setCacheLimits=function(a,t){it=a,lc=t},q.setRTLTextPlugin=function(a,t,e){if(void 0===e&&(e=!1),"deferred"===yc||"loading"===yc||"loaded"===yc)throw new Error("setRTLTextPlugin cannot be called multiple times.");fc=F.resolveURL(a),yc="deferred",qn=t,Jn(),e||ei()},q.sphericalToCartesian=function(a){var t=a[0],e=a[1],o=a[2];return e+=90,e*=Ke/180,o*=Ke/180,{x:t*Ge(e)*Je(o),y:t*Je(e)*Je(o),z:t*Ge(o)}},q.sqrLen=function(a){var t=a[0],e=a[1];return t*t+e*e},q.styleSpec=kt,q.sub=function(a,t,e){return a[0]=t[0]-e[0],a[1]=t[1]-e[1],a[2]=t[2]-e[2],a},q.symbolSize=Pc,q.transformMat3=function(o,t,e){var r=t[0],n=t[1],i=t[2];return o[0]=r*e[0]+n*e[3]+i*e[6],o[1]=r*e[1]+n*e[4]+i*e[7],o[2]=r*e[2]+n*e[5]+i*e[8],o},q.transformMat4=ro,q.translate=function(g,t,e){var r=e[0],d=e[1],m=e[2],x,_,b,v,w,k,T,A,S,C,L,E;return t===g?(g[12]=t[0]*r+t[4]*d+t[8]*m+t[12],g[13]=t[1]*r+t[5]*d+t[9]*m+t[13],g[14]=t[2]*r+t[6]*d+t[10]*m+t[14],g[15]=t[3]*r+t[7]*d+t[11]*m+t[15]):(_=t[1],b=t[2],v=t[3],w=t[4],k=t[5],T=t[6],A=t[7],S=t[8],C=t[9],L=t[10],E=t[11],g[0]=x=t[0],g[1]=_,g[2]=b,g[3]=v,g[4]=w,g[5]=k,g[6]=T,g[7]=A,g[8]=S,g[9]=C,g[10]=L,g[11]=E,g[12]=x*r+w*d+S*m+t[12],g[13]=_*r+k*d+C*m+t[13],g[14]=b*r+T*d+L*m+t[14],g[15]=v*r+A*d+E*m+t[15]),g},q.triggerPluginCompletionEvent=xc,q.uniqueId=l,q.validateCustomStyleLayer=function(a){var t=[],e=a.id;return void 0===e&&t.push({message:"layers."+e+": missing required property \"id\""}),void 0===a.render&&t.push({message:"layers."+e+": missing required method \"render\""}),a.renderingMode&&"2d"!==a.renderingMode&&"3d"!==a.renderingMode&&t.push({message:"layers."+e+": property \"renderingMode\" must be either \"2d\" or \"3d\""}),t},q.validateLight=kn,q.validateStyle=xn,q.values=function(a){var t=[];for(var e in a)t.push(a[e]);return t},q.vectorTile=cs,q.version="1.10.0",q.warnOnce=ad,q.webpSupported=L,q.window=self,q.wrap=o}),e(["./shared"],function(_e){function S(t){var e=typeof t;if("number"==e||"boolean"===e||"string"===e||null==t)return JSON.stringify(t);if(Array.isArray(t)){for(var r="[",d=0,c=t;d<c.length;d+=1)r+=S(c[d])+",";return r+"]"}for(var n=Object.keys(t).sort(),s="{",p=0;p<n.length;p++)s+=JSON.stringify(n[p])+":"+S(t[n[p]])+",";return s+"}"}function be(e){for(var t="",a=0,r=_e.refProperties;a<r.length;a+=1)t+="/"+S(e[r[a]]);return t}function e(e,t,a){for(var r=new _e.EvaluationParameters(t),o=0,i=e;o<i.length;o+=1)i[o].recalculate(r,a)}function s(e,a){var t=_e.getArrayBuffer(e.request,function(e,t,r,o){e?a(e):t&&a(null,{vectorTile:new _e.vectorTile.VectorTile(new _e.pbf(t)),rawData:t,cacheControl:r,expires:o})});return function(){t.cancel(),a()}}function a(a,e){if(0!==a.length){c(a[0],e);for(var t=1;t<a.length;t++)c(a[t],!e)}}function c(a,e){for(var t=0,l=0,s=a.length,o=s-1;l<s;o=l++)t+=(a[l][0]-a[o][0])*(a[o][1]+a[l][1]);0<=t!=!!e&&a.reverse()}function t(a,e){this.options=e||{},this.features=a,this.length=a.length}function r(a,e){this.id="number"==typeof a.id?a.id:void 0,this.type=a.type,this.rawGeometry=1===a.type?[a.geometry]:a.geometry,this.properties=a.tags,this.extent=e||4096}function p(e){var t=new _e.pbf;return function(a,e){for(var t in a.layers)e.writeMessage(3,y,a.layers[t])}(e,t),t.finish()}function y(a,e){var t;e.writeVarintField(15,a.version||1),e.writeStringField(1,a.name||""),e.writeVarintField(5,a.extent||4096);var l={keys:[],values:[],keycache:{},valuecache:{}};for(t=0;t<a.length;t++)l.feature=a.feature(t),e.writeMessage(2,x,l);var i=l.keys;for(t=0;t<i.length;t++)e.writeStringField(3,i[t]);var o=l.values;for(t=0;t<o.length;t++)e.writeMessage(4,T,o[t])}function x(a,e){var t=a.feature;void 0!==t.id&&e.writeVarintField(1,t.id),e.writeMessage(2,b,a),e.writeVarintField(3,t.type),e.writeMessage(4,I,t)}function b(d,e){var t=d.feature,r=d.keys,i=d.values,o=d.keycache,n=d.valuecache;for(var s in t.properties){var a=o[s];void 0===a&&(r.push(s),o[s]=a=r.length-1),e.writeVarint(a);var g=t.properties[s],m=typeof g;"string"!=m&&"boolean"!==m&&"number"!==m&&(g=JSON.stringify(g));var h=m+":"+g,c=n[h];void 0===c&&(i.push(g),n[h]=c=i.length-1),e.writeVarint(c)}}function _(a,e){return(e<<3)+(7&a)}function k(t){return t<<1^t>>31}function I(d,e){for(var t=d.loadGeometry(),r=d.type,i=0,g=0,m=t.length,s=0;s<m;s++){var y=t[s],l=1;1===r&&(l=y.length),e.writeVarint(_(1,l));for(var x=3===r?y.length-1:y.length,h=0;h<x;h++){1==h&&1!==r&&e.writeVarint(_(2,x-1));var b=y[h].x-i,p=y[h].y-g;e.writeVarint(k(b)),e.writeVarint(k(p)),i+=b,g+=p}3===r&&e.writeVarint(_(7,1))}}function T(a,e){var t=typeof a;"string"==t?e.writeStringField(1,a):"boolean"===t?e.writeBooleanField(7,a):"number"===t&&(0==a%1?0>a?e.writeSVarintField(6,a):e.writeVarintField(5,a):e.writeDoubleField(3,a))}function P(a,e,t,o){D(a,t,o),D(e,2*t,2*o),D(e,2*t+1,2*o+1)}function D(a,e,t){var o=a[e];a[e]=a[t],a[t]=o}function L(a,e,t,r){var i=a-t,o=e-r;return i*i+o*o}function O(a,e,t,r,i){return{x:a,y:e,zoom:1/0,id:t,parentId:-1,numPoints:r,properties:i}}function M(a,e){var t=a.geometry.coordinates,o=t[1];return{x:G(t[0]),y:Y(o),zoom:1/0,index:e,parentId:-1}}function A(a){return{type:"Feature",id:a.id,properties:B(a),geometry:{type:"Point",coordinates:[(n=a.x,360*(n-.5)),(e=a.y,o=(180-360*e)*Ke/180,360*ga(g(o))/Ke-90)]}};var e,o,n}function B(a){var e=a.numPoints,t=1e4<=e?Xe(e/1e3)+"k":1e3<=e?Xe(e/100)/10+"k":e;return j(j({},a.properties),{cluster:!0,cluster_id:a.id,point_count:e,point_count_abbreviated:t})}function G(t){return t/360+.5}function Y(a){var e=Je(a*Ke/180),t=.5-.25*C((1+e)/(1-e))/Ke;return 0>t?0:1<t?1:t}function j(a,e){for(var t in e)a[t]=e[t];return a}function V(t){return t.x}function X(t){return t.y}function W(d,e,t,c,p,o){var n=p-t,u=o-c;if(0!=n||0!==u){var g=((d-t)*n+(e-c)*u)/(n*n+u*u);1<g?(t=p,c=o):0<g&&(t+=n*g,c+=u*g)}return(n=d-t)*n+(u=e-c)*u}function R(a,e,t,r){var i={id:void 0===a?null:a,type:e,geometry:t,tags:r,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(a){var e=a.geometry,t=a.type;if("Point"===t||"MultiPoint"===t||"LineString"===t)q(a,e);else if("Polygon"===t||"MultiLineString"===t)for(var r=0;r<e.length;r++)q(a,e[r]);else if("MultiPolygon"===t)for(r=0;r<e.length;r++)for(var n=0;n<e[r].length;n++)q(a,e[r][n])}(i),i}function q(a,e){for(var t=0;t<e.length;t+=3)a.minX=Rt(a.minX,e[t]),a.minY=Rt(a.minY,e[t+1]),a.maxX=ha(a.maxX,e[t]),a.maxY=ha(a.maxY,e[t+1])}function U(d,e,t,r){if(e.geometry){var i=e.geometry.coordinates,o=e.geometry.type,n=pa(t.tolerance/((1<<t.maxZoom)*t.extent),2),s=[],c=e.id;if(t.promoteId?c=e.properties[t.promoteId]:t.generateId&&(c=r||0),"Point"===o)Z(i,s);else if("MultiPoint"===o)for(var p=0;p<i.length;p++)Z(i[p],s);else if("LineString"===o)H(i,s,n,!1);else if("MultiLineString"===o){if(t.lineMetrics){for(p=0;p<i.length;p++)H(i[p],s=[],n,!1),d.push(R(c,"LineString",s,e.properties));return}K(i,s,n,!1)}else if("Polygon"===o)K(i,s,n,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"===o){for(p=0;p<e.geometry.geometries.length;p++)U(d,{id:c,geometry:e.geometry.geometries[p],properties:e.properties},t,r);return}throw new Error("Input data is not a valid GeoJSON object.")}for(p=0;p<i.length;p++){var g=[];K(i[p],g,n,!0),s.push(g)}}d.push(R(c,o,s,e.properties))}}function Z(a,e){e.push($(a[0])),e.push(Q(a[1])),e.push(0)}function H(d,e,t,r){for(var i=0,c=0,p,g;c<d.length;c++){var m=$(d[c][0]),l=Q(d[c][1]);e.push(m),e.push(l),e.push(0),0<c&&(i+=r?(p*l-m*g)/2:We(pa(m-p,2)+pa(l-g,2))),p=m,g=l}var u=e.length-3;e[2]=1,function a(e,t,r,i){for(var o=i,m=r-t,y=e[t],u=e[t+1],h=e[r],c=e[r+1],p=t+3,x,_;p<r;p+=3)if(_=W(e[p],e[p+1],y,u,h,c),_>o)x=p,o=_;else if(_===o){var b=ma(p-(r-t>>1));b<m&&(x=p,m=b)}o>i&&(3<x-t&&a(e,t,x,i),e[x+2]=o,3<r-x&&a(e,x,r,i))}(e,0,u,t),e[u+2]=1,e.size=ma(i),e.start=0,e.end=e.size}function K(a,e,t,r){for(var i=0,l;i<a.length;i++)l=[],H(a[i],l,t,r),e.push(l)}function $(t){return t/360+.5}function Q(a){var e=Je(a*Ke/180),t=.5-.25*C((1+e)/(1-e))/Ke;return 0>t?0:1<t?1:t}function ee(y,e,t,x,_,o,n,s){if(x/=e,o>=(t/=e)&&n<x)return y;if(n<t||o>=x)return null;for(var a=[],l=0;l<y.length;l++){var b=y[l],h=b.geometry,c=b.type,w=0===_?b.minX:b.minY,f=0===_?b.maxX:b.maxY;if(w>=t&&f<x)a.push(b);else if(!(f<t||w>=x)){var d=[];if("Point"===c||"MultiPoint"===c)te(h,d,t,x,_);else if("LineString"===c)re(h,d,t,x,_,!1,s.lineMetrics);else if("MultiLineString"===c)ie(h,d,t,x,_,!1);else if("Polygon"===c)ie(h,d,t,x,_,!0);else if("MultiPolygon"===c)for(var k=0,T;k<h.length;k++)T=[],ie(h[k],T,t,x,_,!0),T.length&&d.push(T);if(d.length){if(s.lineMetrics&&"LineString"===c){for(k=0;k<d.length;k++)a.push(R(b.id,c,d[k],b.tags));continue}"LineString"!==c&&"MultiLineString"!==c||(1===d.length?(c="LineString",d=d[0]):c="MultiLineString"),"Point"!==c&&"MultiPoint"!==c||(c=3===d.length?"Point":"MultiPoint"),a.push(R(b.id,c,d,b.tags))}}}return a.length?a:null}function te(a,e,t,r,i){for(var o=0,l;o<a.length;o+=3)l=a[o+i],l>=t&&l<=r&&(e.push(a[o]),e.push(a[o+1]),e.push(a[o+2]))}function re(_,e,t,r,i,o,n){for(var s=oe(_),b=0===i?ae:le,h=_.start,k=0,T,A;k<_.length-3;k+=3){var C=_[k],L=_[k+1],E=_[k+2],I=_[k+3],m=_[k+4],v=0===i?C:L,P=0===i?I:m,x=!1;n&&(T=We(pa(C-I,2)+pa(L-m,2))),v<t?P>t&&(A=b(s,C,L,I,m,t),n&&(s.start=h+T*A)):v>r?P<r&&(A=b(s,C,L,I,m,r),n&&(s.start=h+T*A)):ne(s,C,L,E),P<t&&v>=t&&(A=b(s,C,L,I,m,t),x=!0),P>r&&v<=r&&(A=b(s,C,L,I,m,r),x=!0),!o&&x&&(n&&(s.end=h+T*A),e.push(s),s=oe(_)),n&&(h+=T)}var z=_.length-3;C=_[z],L=_[z+1],E=_[z+2],(v=0===i?C:L)>=t&&v<=r&&ne(s,C,L,E),z=s.length-3,o&&3<=z&&(s[z]!==s[0]||s[z+1]!==s[1])&&ne(s,s[0],s[1],s[2]),s.length&&e.push(s)}function oe(a){var e=[];return e.size=a.size,e.start=a.start,e.end=a.end,e}function ie(a,e,t,r,i,o){for(var n=0;n<a.length;n++)re(a[n],e,t,r,i,o,!1)}function ne(a,e,t,o){a.push(e),a.push(t),a.push(o)}function ae(a,e,t,r,i,o){var n=(o-e)/(r-e);return a.push(o),a.push(t+(i-t)*n),a.push(1),n}function le(a,e,t,r,i,o){var n=(o-t)/(i-t);return a.push(e+(r-e)*n),a.push(o),a.push(1),n}function se(d,e){for(var t=[],r=0;r<d.length;r++){var c=d[r],n=c.type,s;if("Point"===n||"MultiPoint"===n||"LineString"===n)s=ue(c.geometry,e);else if("MultiLineString"===n||"Polygon"===n){s=[];for(var p=0;p<c.geometry.length;p++)s.push(ue(c.geometry[p],e))}else if("MultiPolygon"===n)for(s=[],p=0;p<c.geometry.length;p++){for(var g=[],l=0;l<c.geometry[p].length;l++)g.push(ue(c.geometry[p][l],e));s.push(g)}t.push(R(c.id,n,s,c.tags))}return t}function ue(a,e){var t=[];t.size=a.size,void 0!==a.start&&(t.start=a.start,t.end=a.end);for(var o=0;o<a.length;o+=3)t.push(a[o]+e,a[o+1],a[o+2]);return t}function ce(d,e){if(d.transformed)return d;var t=1<<d.z,n=d.x,s=d.y,a,p,g;for(a=0;a<d.features.length;a++){var m=d.features[a],l=m.geometry,u=m.type;if(m.geometry=[],1===u)for(p=0;p<l.length;p+=2)m.geometry.push(pe(l[p],l[p+1],e,t,n,s));else for(p=0;p<l.length;p++){var h=[];for(g=0;g<l[p].length;g+=2)h.push(pe(l[p][g],l[p][g+1],e,t,n,s));m.geometry.push(h)}}return d.transformed=!0,d}function pe(a,e,t,r,i,o){return[Xe(t*(a*r-i)),Xe(t*(e*r-o))]}function he(d,e,t,r,i){for(var o=e===i.maxZoom?0:i.tolerance/((1<<e)*i.extent),n={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:t,y:r,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<d.length;s++){n.numFeatures++,de(n,d[s],o,i);var p=d[s].minX,l=d[s].minY,u=d[s].maxX,g=d[s].maxY;p<n.minX&&(n.minX=p),l<n.minY&&(n.minY=l),u>n.maxX&&(n.maxX=u),g>n.maxY&&(n.maxY=g)}return n}function de(d,e,t,r){var i=e.geometry,o=e.type,n=[];if("Point"===o||"MultiPoint"===o)for(var s=0;s<i.length;s+=3)n.push(i[s]),n.push(i[s+1]),d.numPoints++,d.numSimplified++;else if("LineString"===o)ge(n,i,d,t,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(s=0;s<i.length;s++)ge(n,i[s],d,t,"Polygon"===o,0==s);else if("MultiPolygon"===o)for(var g=0,m;g<i.length;g++)for(m=i[g],s=0;s<m.length;s++)ge(n,m[s],d,t,!0,0==s);if(n.length){var y=e.tags||null;if("LineString"===o&&r.lineMetrics){for(var f in y={},e.tags)y[f]=e.tags[f];y.mapbox_clip_start=i.start/i.size,y.mapbox_clip_end=i.end/i.size}var c={geometry:n,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:y};null!==e.id&&(c.id=e.id),d.features.push(c)}}function ge(d,e,t,r,i,o){var n=r*r;if(0<r&&e.size<(i?n:r))t.numPoints+=e.length/3;else{for(var s=[],a=0;a<e.length;a+=3)(0==r||e[a+2]>n)&&(t.numSimplified++,s.push(e[a]),s.push(e[a+1])),t.numPoints++;i&&function(l,e){for(var t=0,d=0,c=l.length,p=c-2;d<c;p=d,d+=2)t+=(l[d]-l[p])*(l[d+1]+l[p+1]);if(0<t===e)for(d=0,c=l.length;d<c/2;d+=2){var u=l[d],s=l[d+1];l[d]=l[c-2-d],l[d+1]=l[c-1-d],l[c-2-d]=u,l[c-1-d]=s}}(s,o),d.push(s)}}function me(a,e){var o=(e=this.options=function(a,e){for(var t in e)a[t]=e[t];return a}(Object.create(this.options),e)).debug;if(o&&console.time("preprocess data"),0>e.maxZoom||24<e.maxZoom)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var r=function(a,e){var t=[];if("FeatureCollection"===a.type)for(var o=0;o<a.features.length;o++)U(t,a.features[o],e,o);else U(t,"Feature"===a.type?a:{geometry:a},e);return t}(a,e);this.tiles={},this.tileCoords=[],o&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(r=function(a,e){var t=e.buffer/e.extent,r=a,l=ee(a,1,-1-t,t,0,-1,2,e),o=ee(a,1,1-t,2+t,0,-1,2,e);return(l||o)&&(r=ee(a,1,-t,1+t,0,-1,2,e)||[],l&&(r=se(l,1).concat(r)),o&&(r=r.concat(se(o,-1)))),r}(r,e)).length&&this.splitTile(r,0,0,0),o&&(r.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function fe(a,e,t){return 32*((1<<a)*t+e)+a}function ye(a,e){var t=a.tileID.canonical;if(!this._geoJSONIndex)return e(null,null);var r=this._geoJSONIndex.getTile(t.z,t.x,t.y);if(!r)return e(null,null);var i=new d(r.features),o=f(i);0===o.byteOffset&&o.byteLength===o.buffer.byteLength||(o=new Uint8Array(o)),e(null,{vectorTile:i,rawData:o.buffer})}var xe=function(t){this.keyCache={},t&&this.replace(t)};xe.prototype.replace=function(t){this._layerConfigs={},this._layers={},this.update(t,[])},xe.prototype.update=function(e,t){for(var r=this,o=0,i=e,s;o<i.length;o+=1){s=i[o],this._layerConfigs[s.id]=s;var _=this._layers[s.id]=_e.createStyleLayer(s);_._featureFilter=_e.featureFilter(_.filter),this.keyCache[s.id]&&delete this.keyCache[s.id]}for(var l=0,b=t,h;l<b.length;l+=1)h=b[l],delete this.keyCache[h],delete this._layerConfigs[h],delete this._layers[h];this.familiesBySource={};for(var w=0,k=function(r,e){for(var t={},i=0,d;i<r.length;i++){d=e&&e[r[i].id]||be(r[i]),e&&(e[r[i].id]=d);var c=t[d];c||(c=t[d]=[]),c.push(r[i])}var p=[];for(var a in t)p.push(t[a]);return p}(_e.values(this._layerConfigs),this.keyCache);w<k.length;w+=1){var f=k[w].map(function(t){return r._layers[t.id]}),d=f[0];if("none"!==d.visibility){var g=d.source||"",m=this.familiesBySource[g];m||(m=this.familiesBySource[g]={});var T=d.sourceLayer||"_geojsonTileLayer",y=m[T];y||(y=m[T]=[]),y.push(f)}}};var ve=function(e){var t={},r=[];for(var i in e){var o=e[i],n=t[i]={};for(var s in o){var a=o[+s];if(a&&0!==a.bitmap.width&&0!==a.bitmap.height){var l={x:0,y:0,w:a.bitmap.width+2,h:a.bitmap.height+2};r.push(l),n[s]={rect:l,metrics:a.metrics}}}}var u=_e.potpack(r),h=new _e.AlphaImage({width:u.w||1,height:u.h||1});for(var c in e){var p=e[c];for(var y in p){var d=p[+y];if(d&&0!==d.bitmap.width&&0!==d.bitmap.height){var g=t[c][y].rect;_e.AlphaImage.copy(d.bitmap,h,{x:0,y:0},{x:g.x+1,y:g.y+1},d.bitmap)}}}this.image=h,this.positions=t};_e.register("GlyphAtlas",ve);var ke=function(e){this.tileID=new _e.OverscaledTileID(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.uid=e.uid,this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId};ke.prototype.parse=function(o,t,s,r,i){function a(){if(v)return i(v);if(A&&E&&z){var a=new ve(A),t=new _e.ImageAtlas(E,z);for(var o in h){var r=h[o];r instanceof _e.SymbolBucket?(e(r.layers,this.zoom,s),_e.performSymbolLayout(r,A,a.positions,E,t.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):r.hasPattern&&(r instanceof _e.LineBucket||r instanceof _e.FillBucket||r instanceof _e.FillExtrusionBucket)&&(e(r.layers,this.zoom,s),r.addFeatures(g,this.tileID.canonical,t.patternPositions))}this.status="done",i(null,{buckets:_e.values(h).filter(function(t){return!t.isEmpty()}),featureIndex:u,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:a.image,imageAtlas:t,glyphMap:this.returnDependencies?A:null,iconMap:this.returnDependencies?E:null,glyphPositions:this.returnDependencies?a.positions:null})}}var n=this;this.status="parsing",this.data=o,this.collisionBoxArray=new _e.CollisionBoxArray;var l=new _e.DictionaryCoder(Object.keys(o.layers).sort()),u=new _e.FeatureIndex(this.tileID,this.promoteId);u.bucketLayerIDs=[];var h={},g={featureIndex:u,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:s},m=t.familiesBySource[this.source],v,A,E,z;for(var O in m){var y=o.layers[O];if(y){1===y.version&&_e.warnOnce("Vector tile source \""+this.source+"\" layer \""+O+"\" does not use vector tile spec v2 and therefore may have some rendering errors.");for(var x=l.encode(O),w=[],S=0;S<y.length;S++){var R=y.feature(S),M=u.getId(R,O);w.push({feature:R,id:M,index:S,sourceLayerIndex:x})}for(var b=0,j=m[O];b<j.length;b+=1){var k=j[b],P=k[0];P.minzoom&&this.zoom<ya(P.minzoom)||P.maxzoom&&this.zoom>=P.maxzoom||"none"!==P.visibility&&(e(k,this.zoom,s),(h[P.id]=P.createBucket({index:u.bucketLayerIDs.length,layers:k,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:x,sourceID:this.source})).populate(w,g,this.tileID.canonical),u.bucketLayerIDs.push(k.map(function(t){return t.id})))}}}var T=_e.mapObject(g.glyphDependencies,function(t){return Object.keys(t).map(Number)});Object.keys(T).length?r.send("getGlyphs",{uid:this.uid,stacks:T},function(o,e){v||(v=o,A=e,a.call(n))}):A={};var C=Object.keys(g.iconDependencies);C.length?r.send("getImages",{icons:C,source:this.source,tileID:this.tileID,type:"icons"},function(o,e){v||(v=o,E=e,a.call(n))}):E={};var D=Object.keys(g.patternDependencies);D.length?r.send("getImages",{icons:D,source:this.source,tileID:this.tileID,type:"patterns"},function(o,e){v||(v=o,z=e,a.call(n))}):z={},a.call(this)};var o=function(a,e,t,o){this.actor=a,this.layerIndex=e,this.availableImages=t,this.loadVectorData=o||s,this.loading={},this.loaded={}};o.prototype.loadTile=function(e,d){var r=this,i=e.uid;this.loading||(this.loading={});var o=!!(e&&e.request&&e.request.collectResourceTiming)&&new _e.RequestPerformance(e.request),s=this.loading[i]=new ke(e);s.abort=this.loadVectorData(e,function(e,t){if(delete r.loading[i],e||!t)return s.status="done",r.loaded[i]=s,d(e);var a=t.rawData,n={};t.expires&&(n.expires=t.expires),t.cacheControl&&(n.cacheControl=t.cacheControl);var l={};if(o){var p=o.finish();p&&(l.resourceTiming=JSON.parse(JSON.stringify(p)))}s.vectorTile=t.vectorTile,s.parse(t.vectorTile,r.layerIndex,r.availableImages,r.actor,function(e,t){return e||!t?d(e):void d(null,_e.extend({rawTileData:a.slice(0)},t,n,l))}),r.loaded=r.loaded||{},r.loaded[i]=s})},o.prototype.reloadTile=function(l,d){var t=this,e=this.loaded,r=l.uid,c=this;if(e&&e[r]){var n=e[r];n.showCollisionBoxes=l.showCollisionBoxes;var o=function(a,e){var r=n.reloadCallback;r&&(delete n.reloadCallback,n.parse(n.vectorTile,c.layerIndex,t.availableImages,c.actor,r)),d(a,e)};"parsing"===n.status?n.reloadCallback=o:"done"===n.status&&(n.vectorTile?n.parse(n.vectorTile,this.layerIndex,this.availableImages,this.actor,o):o())}},o.prototype.abortTile=function(a,e){var t=this.loading,o=a.uid;t&&t[o]&&t[o].abort&&(t[o].abort(),delete t[o]),e()},o.prototype.removeTile=function(a,e){var t=this.loaded,o=a.uid;t&&t[o]&&delete t[o],e()};var l=_e.window.ImageBitmap,i=function(){this.loaded={}};i.prototype.loadTile=function(e,t){var r=e.uid,i=e.encoding,o=e.rawImageData,n=l&&o instanceof l?this.getImageData(o):o,s=new _e.DEMData(r,n,i);this.loaded=this.loaded||{},this.loaded[r]=s,t(null,s)},i.prototype.getImageData=function(e){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(e.width,e.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=e.width,this.offscreenCanvas.height=e.height,this.offscreenCanvasContext.drawImage(e,0,0,e.width,e.height);var t=this.offscreenCanvasContext.getImageData(-1,-1,e.width+2,e.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new _e.RGBAImage({width:t.width,height:t.height},t.data)},i.prototype.removeTile=function(a){var e=this.loaded,t=a.uid;e&&e[t]&&delete e[t]};var n=_e.vectorTile.VectorTileFeature.prototype.toGeoJSON,u=function(e){this._feature=e,this.extent=_e.EXTENT,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))};u.prototype.loadGeometry=function(){if(1===this._feature.type){for(var e=[],t=0,d=this._feature.geometry,i;t<d.length;t+=1)i=d[t],e.push([new _e.Point$1(i[0],i[1])]);return e}for(var p=[],n=0,g=this._feature.geometry;n<g.length;n+=1){for(var a=[],l=0,m=g[n],h;l<m.length;l+=1)h=m[l],a.push(new _e.Point$1(h[0],h[1]));p.push(a)}return p},u.prototype.toGeoJSON=function(a,e,t){return n.call(this,a,e,t)};var d=function(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=_e.EXTENT,this.length=e.length,this._features=e};d.prototype.feature=function(t){return new u(this._features[t])};var h=_e.vectorTile.VectorTileFeature,m=t;t.prototype.feature=function(t){return new r(this.features[t],this.options.extent)},r.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var t=0;t<e.length;t++){for(var a=e[t],i=[],o=0;o<a.length;o++)i.push(new _e.Point$1(a[o][0],a[o][1]));this.geometry.push(i)}return this.geometry},r.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var d=this.geometry,e=1/0,c=-1/0,p=1/0,u=-1/0,g=0;g<d.length;g++)for(var m=d[g],s=0,h;s<m.length;s++)h=m[s],e=Rt(e,h.x),c=ha(c,h.x),p=Rt(p,h.y),u=ha(u,h.y);return[e,p,c,u]},r.prototype.toGeoJSON=h.prototype.toGeoJSON;var f=p;f.fromVectorTileJs=p,f.fromGeojsonVt=function(a,e){e=e||{};var o={};for(var r in a)o[r]=new m(a[r].features,e),o[r].name=r,o[r].version=e.version,o[r].extent=e.extent;return p({layers:o})},f.GeoJSONWrapper=m;var v=function(t){return t[0]},w=function(t){return t[1]},E=function(d,e,c,p,u){void 0===e&&(e=v),void 0===c&&(c=w),void 0===p&&(p=64),void 0===u&&(u=Float64Array),this.nodeSize=p,this.points=d;for(var m=65536>d.length?Uint16Array:Uint32Array,n=this.ids=new m(d.length),s=this.coords=new u(2*d.length),a=0;a<d.length;a++)n[a]=a,s[2*a]=e(d[a]),s[2*a+1]=c(d[a]);!function l(e,t,r,i,o,n){if(!(o-i<=r)){var s=i+o>>1;!function m(e,t,r,i,y,x){for(;y>i;){if(600<y-i){var s=y-i+1,a=r-i+1,l=C(s),u=.5*g(2*l/3),h=.5*We(l*u*(s-u)/s)*(0>a-s/2?-1:1);m(e,t,r,ha(i,ya(r-a*u/s+h)),Rt(y,ya(r+(s-a)*u/s+h)),x)}var c=t[2*r+x],p=i,_=y;for(P(e,t,i,r),t[2*y+x]>c&&P(e,t,i,y);p<_;){for(P(e,t,p,_),p++,_--;t[2*p+x]<c;)p++;for(;t[2*_+x]>c;)_--}t[2*i+x]===c?P(e,t,i,_):P(e,t,++_,y),_<=r&&(i=_+1),r<=_&&(y=_-1)}}(e,t,s,i,o,n%2),l(e,t,r,i,s-1,n+1),l(e,t,r,s+1,o,n+1)}}(n,s,p,0,n.length-1,0)};E.prototype.range=function(a,e,t,o){return function(y,e,t,r,i,o,n){for(var s=[0,y.length-1,0],u=[],h,x;s.length;){var _=s.pop(),c=s.pop(),p=s.pop();if(c-p<=n)for(var f=p;f<=c;f++)x=e[2*f+1],(h=e[2*f])>=t&&h<=i&&x>=r&&x<=o&&u.push(y[f]);else{var b=ya((p+c)/2);x=e[2*b+1],(h=e[2*b])>=t&&h<=i&&x>=r&&x<=o&&u.push(y[b]);var g=(_+1)%2;(0===_?t<=h:r<=x)&&(s.push(p),s.push(b-1),s.push(g)),(0===_?i>=h:o>=x)&&(s.push(b+1),s.push(c),s.push(g))}}return u}(this.ids,this.coords,a,e,t,o,this.nodeSize)},E.prototype.within=function(a,e,t){return function(y,e,t,r,i,o){for(var n=[0,y.length-1,0],s=[],a=i*i;n.length;){var l=n.pop(),u=n.pop(),h=n.pop();if(u-h<=o)for(var c=h;c<=u;c++)L(e[2*c],e[2*c+1],t,r)<=a&&s.push(y[c]);else{var x=ya((h+u)/2),f=e[2*x],d=e[2*x+1];L(f,d,t,r)<=a&&s.push(y[x]);var g=(l+1)%2;(0===l?t-i<=f:r-i<=d)&&(n.push(h),n.push(x-1),n.push(g)),(0===l?t+i>=f:r+i>=d)&&(n.push(x+1),n.push(u),n.push(g))}}return s}(this.ids,this.coords,a,e,t,this.nodeSize)};var z={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(t){return t}},F=function(t){this.options=j(Object.create(z),t),this.trees=Array(this.options.maxZoom+1)};F.prototype.load=function(d){var e=this.options,t=e.log,r=e.minZoom,i=e.maxZoom,o=e.nodeSize;t&&console.time("total time");var n="prepare "+d.length+" points";t&&console.time(n),this.points=d;for(var s=[],c=0;c<d.length;c++)d[c].geometry&&s.push(M(d[c],c));this.trees[i+1]=new E(s,V,X,o,Float32Array),t&&console.timeEnd(n);for(var p=i,g;p>=r;p--)g=+Date.now(),s=this._cluster(s,p),this.trees[p]=new E(s,V,X,o,Float32Array),t&&console.log("z%d: %d clusters in %dms",p,s.length,+Date.now()-g);return t&&console.timeEnd("total time"),this},F.prototype.getClusters=function(d,e){var t=((d[0]+180)%360+360)%360-180,g=ha(-90,Rt(90,d[1])),i=180===d[2]?180:((d[2]+180)%360+360)%360-180,m=ha(-90,Rt(90,d[3]));if(360<=d[2]-d[0])t=-180,i=180;else if(t>i){var n=this.getClusters([t,g,180,m],e),s=this.getClusters([-180,g,i,m],e);return n.concat(s)}for(var a=this.trees[this._limitZoom(e)],l=[],u=0,y=a.range(G(t),Y(m),G(i),Y(g)),c;u<y.length;u+=1)c=a.points[y[u]],l.push(c.numPoints?A(c):this.points[c.index]);return l},F.prototype.getChildren=function(i){var e=this._getOriginId(i),t=this._getOriginZoom(i),r=this.trees[t];if(!r)throw new Error("No cluster with the specified id.");var o=r.points[e];if(!o)throw new Error("No cluster with the specified id.");for(var n=this.options.radius/(this.options.extent*pa(2,t-1)),s=[],a=0,d=r.within(o.x,o.y,n),c;a<d.length;a+=1)c=r.points[d[a]],c.parentId===i&&s.push(c.numPoints?A(c):this.points[c.index]);if(0===s.length)throw new Error("No cluster with the specified id.");return s},F.prototype.getLeaves=function(a,e,o){var n=[];return this._appendLeaves(n,a,e=e||10,o=o||0,0),n},F.prototype.getTile=function(d,e,t){var r=this.trees[this._limitZoom(d)],i=pa(2,d),o=this.options,n=o.radius/o.extent,s=(t-n)/i,a=(t+1+n)/i,l={features:[]};return this._addTileFeatures(r.range((e-n)/i,s,(e+1+n)/i,a),r.points,e,t,i,l),0===e&&this._addTileFeatures(r.range(1-n/i,s,1,a),r.points,i,t,i,l),e===i-1&&this._addTileFeatures(r.range(0,s,n/i,a),r.points,-1,t,i,l),l.features.length?l:null},F.prototype.getClusterExpansionZoom=function(a){for(var o=this._getOriginZoom(a)-1,i;o<=this.options.maxZoom&&(i=this.getChildren(a),o++,1===i.length);)a=i[0].properties.cluster_id;return o},F.prototype._appendLeaves=function(d,e,t,r,i){for(var c=0,p=this.getChildren(e);c<p.length;c+=1){var s=p[c],a=s.properties;if(a&&a.cluster?i+a.point_count<=r?i+=a.point_count:i=this._appendLeaves(d,a.cluster_id,t,r,i):i<r?i++:d.push(s),d.length===t)break}return i},F.prototype._addTileFeatures=function(d,e,t,r,i,o){for(var n=0,p=d;n<p.length;n+=1){var a=e[p[n]],l=a.numPoints,u={type:1,geometry:[[Xe(this.options.extent*(a.x*i-t)),Xe(this.options.extent*(a.y*i-r))]],tags:l?B(a):this.points[a.index].properties},g=void 0;l?g=a.id:this.options.generateId?g=a.index:this.points[a.index].id&&(g=this.points[a.index].id),void 0!==g&&(u.id=g),o.features.push(u)}},F.prototype._limitZoom=function(t){return ha(this.options.minZoom,Rt(t,this.options.maxZoom+1))},F.prototype._cluster=function(x,e){for(var t=[],r=this.options,i=r.reduce,o=r.radius/(r.extent*pa(2,e)),n=0,_;n<x.length;n++)if(_=x[n],!(_.zoom<=e)){_.zoom=e;for(var b=this.trees[e+1],l=b.within(_.x,_.y,o),u=_.numPoints||1,w=_.x*u,k=_.y*u,T=i&&1<u?this._map(_,!0):null,A=(n<<5)+(e+1)+this.points.length,d=0,S=l,m;d<S.length;d+=1)if(m=b.points[S[d]],!(m.zoom<=e)){m.zoom=e;var C=m.numPoints||1;w+=m.x*C,k+=m.y*C,u+=C,m.parentId=A,i&&(T||(T=this._map(_,!0)),i(T,this._map(m)))}1===u?t.push(_):(_.parentId=A,t.push(O(w/u,k/u,A,u,T)))}return t},F.prototype._getOriginId=function(t){return t-this.points.length>>5},F.prototype._getOriginZoom=function(t){return(t-this.points.length)%32},F.prototype._map=function(a,e){if(a.numPoints)return e?j({},a.properties):a.properties;var t=this.points[a.index].properties,o=this.options.map(t);return e&&o===t?j({},o):o},me.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},me.prototype.splitTile=function(_,k,T,A,C,o,n){for(var s=[_,k,T,A],a=this.options,l=a.debug;s.length;){A=s.pop(),T=s.pop(),k=s.pop(),_=s.pop();var u=1<<k,h=fe(k,T,A),c=this.tiles[h];if(!c&&(1<l&&console.time("creation"),c=this.tiles[h]=he(_,k,T,A,a),this.tileCoords.push({z:k,x:T,y:A}),l)){1<l&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",k,T,A,c.numFeatures,c.numPoints,c.numSimplified),console.timeEnd("creation"));var L="z"+k;this.stats[L]=(this.stats[L]||0)+1,this.total++}if(c.source=_,C){if(k===a.maxZoom||k===C)continue;var f=1<<C-k;if(T!==ya(o/f)||A!==ya(n/f))continue}else if(k===a.indexMaxZoom||c.numPoints<=a.indexMaxPoints)continue;if(c.source=null,0!==_.length){1<l&&console.time("clipping");var d=.5*a.buffer/a.extent,S=.5-d,E=.5+d,I=1+d,b,P,z,D,O,R;b=P=z=D=null,O=ee(_,u,T-d,T+E,0,c.minX,c.maxX,a),R=ee(_,u,T+S,T+I,0,c.minX,c.maxX,a),_=null,O&&(b=ee(O,u,A-d,A+E,1,c.minY,c.maxY,a),P=ee(O,u,A+S,A+I,1,c.minY,c.maxY,a),O=null),R&&(z=ee(R,u,A-d,A+E,1,c.minY,c.maxY,a),D=ee(R,u,A+S,A+I,1,c.minY,c.maxY,a),R=null),1<l&&console.timeEnd("clipping"),s.push(b||[],k+1,2*T,2*A),s.push(P||[],k+1,2*T,2*A+1),s.push(z||[],k+1,2*T+1,2*A),s.push(D||[],k+1,2*T+1,2*A+1)}}},me.prototype.getTile=function(d,e,p){var r=this.options,i=r.extent,o=r.debug;if(0>d||24<d)return null;var n=1<<d,s=fe(d,e=(e%n+n)%n,p);if(this.tiles[s])return ce(this.tiles[s],i);1<o&&console.log("drilling down to z%d-%d-%d",d,e,p);for(var a=d,g=e,m=p,y;!y&&0<a;)a--,g=ya(g/2),m=ya(m/2),y=this.tiles[fe(a,g,m)];return y&&y.source?(1<o&&console.log("found parent tile z%d-%d-%d",a,g,m),1<o&&console.time("drilling down"),this.splitTile(y.source,a,g,m,d,e,p),1<o&&console.timeEnd("drilling down"),this.tiles[s]?ce(this.tiles[s],i):null):null};var N=function(n){function e(t,e,a,r){n.call(this,t,e,a,ye),r&&(this.loadGeoJSON=r)}return n&&(e.__proto__=n),(e.prototype=Object.create(n&&n.prototype)).constructor=e,e.prototype.loadData=function(a,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=e,this._pendingLoadDataParams=a,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},e.prototype._loadData=function(){var e=this;if(this._pendingCallback&&this._pendingLoadDataParams){var t=this._pendingCallback,r=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var i=!!(r&&r.request&&r.request.collectResourceTiming)&&new _e.RequestPerformance(r.request);this.loadGeoJSON(r,function(o,n){if(o||!n)return t(o);if("object"!=typeof n)return t(new Error("Input data given to '"+r.source+"' is not a valid GeoJSON object."));!function n(e,t){var r=e&&e.type,o;if("FeatureCollection"===r)for(o=0;o<e.features.length;o++)n(e.features[o],t);else if("GeometryCollection"===r)for(o=0;o<e.geometries.length;o++)n(e.geometries[o],t);else if("Feature"===r)n(e.geometry,t);else if("Polygon"===r)a(e.coordinates,t);else if("MultiPolygon"===r)for(o=0;o<e.coordinates.length;o++)a(e.coordinates[o],t);return e}(n,!0);try{e._geoJSONIndex=r.cluster?new F(function(e){var t=e.superclusterOptions,r=e.clusterProperties;if(!r||!t)return t;for(var m={},y={},x={accumulated:null,zoom:0},s={properties:null},a=Object.keys(r),o=0,i=a;o<i.length;o+=1){var n=i[o],l=r[n],c=l[0],p=_e.createExpression(l[1]),d=_e.createExpression("string"==typeof c?[c,["accumulated"],["get",n]]:c);m[n]=p.value,y[n]=d.value}return t.map=function(o){s.properties=o;for(var e={},t=0,l=a,i;t<l.length;t+=1)i=l[t],e[i]=m[i].evaluate(x,s);return e},t.reduce=function(n,e){s.properties=e;for(var t=0,l=a,i;t<l.length;t+=1)i=l[t],x.accumulated=n[i],n[i]=y[i].evaluate(x,s)},t}(r)).load(n.features):function(a,e){return new me(a,e)}(n,r.geojsonVtOptions)}catch(e){return t(e)}e.loaded={};var s={};if(i){var d=i.finish();d&&(s.resourceTiming={},s.resourceTiming[r.source]=JSON.parse(JSON.stringify(d)))}t(null,s)})}},e.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},e.prototype.reloadTile=function(t,e){var a=this.loaded;return a&&a[t.uid]?n.prototype.reloadTile.call(this,t,e):this.loadTile(t,e)},e.prototype.loadGeoJSON=function(a,t){if(a.request)_e.getJSON(a.request,t);else{if("string"!=typeof a.data)return t(new Error("Input data given to '"+a.source+"' is not a valid GeoJSON object."));try{return t(null,JSON.parse(a.data))}catch(o){return t(new Error("Input data given to '"+a.source+"' is not a valid GeoJSON object."))}}},e.prototype.removeSource=function(a,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),e()},e.prototype.getClusterExpansionZoom=function(a,o){try{o(null,this._geoJSONIndex.getClusterExpansionZoom(a.clusterId))}catch(t){o(t)}},e.prototype.getClusterChildren=function(a,o){try{o(null,this._geoJSONIndex.getChildren(a.clusterId))}catch(t){o(t)}},e.prototype.getClusterLeaves=function(a,o){try{o(null,this._geoJSONIndex.getLeaves(a.clusterId,a.limit,a.offset))}catch(t){o(t)}},e}(o),J=function(e){var a=this;this.self=e,this.actor=new _e.Actor(e,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:o,geojson:N},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(o,e){if(a.workerSourceTypes[o])throw new Error("Worker source with name \""+o+"\" already registered.");a.workerSourceTypes[o]=e},this.self.registerRTLTextPlugin=function(e){if(_e.plugin.isParsed())throw new Error("RTL text plugin already registered.");_e.plugin.applyArabicShaping=e.applyArabicShaping,_e.plugin.processBidirectionalText=e.processBidirectionalText,_e.plugin.processStyledBidirectionalText=e.processStyledBidirectionalText}};return J.prototype.setReferrer=function(a,e){this.referrer=e},J.prototype.setImages=function(a,e,t){this.availableImages[a]=e,t()},J.prototype.setLayers=function(a,e,t){this.getLayerIndex(a).replace(e),t()},J.prototype.updateLayers=function(a,e,t){this.getLayerIndex(a).update(e.layers,e.removedIds),t()},J.prototype.loadTile=function(a,e,t){this.getWorkerSource(a,e.type,e.source).loadTile(e,t)},J.prototype.loadDEMTile=function(a,e,t){this.getDEMWorkerSource(a,e.source).loadTile(e,t)},J.prototype.reloadTile=function(a,e,t){this.getWorkerSource(a,e.type,e.source).reloadTile(e,t)},J.prototype.abortTile=function(a,e,t){this.getWorkerSource(a,e.type,e.source).abortTile(e,t)},J.prototype.removeTile=function(a,e,t){this.getWorkerSource(a,e.type,e.source).removeTile(e,t)},J.prototype.removeDEMTile=function(a,e){this.getDEMWorkerSource(a,e.source).removeTile(e)},J.prototype.removeSource=function(a,e,t){if(this.workerSources[a]&&this.workerSources[a][e.type]&&this.workerSources[a][e.type][e.source]){var o=this.workerSources[a][e.type][e.source];delete this.workerSources[a][e.type][e.source],void 0===o.removeSource?t():o.removeSource(e,t)}},J.prototype.loadWorkerSource=function(a,e,t){try{this.self.importScripts(e.url),t()}catch(a){t(a.toString())}},J.prototype.syncRTLPluginState=function(e,t,a){try{_e.plugin.setState(t);var r=_e.plugin.getPluginURL();if(_e.plugin.isLoaded()&&!_e.plugin.isParsed()&&null!=r){this.self.importScripts(r);var o=_e.plugin.isParsed();a(o?void 0:new Error("RTL Text Plugin failed to import scripts from "+r),o)}}catch(t){a(t.toString())}},J.prototype.getAvailableImages=function(a){var e=this.availableImages[a];return e||(e=[]),e},J.prototype.getLayerIndex=function(a){var e=this.layerIndexes[a];return e||(e=this.layerIndexes[a]=new xe),e},J.prototype.getWorkerSource=function(a,e,t){var n=this;return this.workerSources[a]||(this.workerSources[a]={}),this.workerSources[a][e]||(this.workerSources[a][e]={}),this.workerSources[a][e][t]||(this.workerSources[a][e][t]=new this.workerSourceTypes[e]({send:function(e,t,r){n.actor.send(e,t,r,a)}},this.getLayerIndex(a),this.getAvailableImages(a))),this.workerSources[a][e][t]},J.prototype.getDEMWorkerSource=function(a,e){return this.demWorkerSources[a]||(this.demWorkerSources[a]={}),this.demWorkerSources[a][e]||(this.demWorkerSources[a][e]=new i),this.demWorkerSources[a][e]},J.prototype.enforceCacheSizeLimit=function(e,t){_e.enforceCacheSizeLimit(t)},"undefined"!=typeof WorkerGlobalScope&&void 0!==_e.window&&_e.window instanceof WorkerGlobalScope&&(_e.window.worker=new J(_e.window)),J}),e(["./shared"],function(ea){function t(a){if(!i)return a[0];for(var t=0;t<a.length;t++)if(a[t]in i)return a[t];return a[0]}function f(a){var t=a.userImage;return!!(t&&t.render&&t.render())&&(a.data.replace(new Uint8Array(t.data.buffer)),!0)}function r(l,t,e,i,o,r){this.fontSize=l||24,this.buffer=void 0===t?3:t,this.cutoff=i||.25,this.fontFamily=o||"sans-serif",this.fontWeight=r||"normal",this.radius=e||8;var a=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.d=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Int16Array(a),this.middle=Xe(a/2*(0<=navigator.userAgent.indexOf("Gecko/")?1.2:1))}function m(d,t,e,i,o,r,a){for(var n=0;n<t;n++){for(var c=0;c<e;c++)i[c]=d[c*t+n];for(h(i,o,r,a,e),c=0;c<e;c++)d[c*t+n]=o[c]}for(c=0;c<e;c++){for(n=0;n<t;n++)i[n]=d[c*t+n];for(h(i,o,r,a,t),n=0;n<t;n++)d[c*t+n]=We(o[n])}}function h(l,t,e,i,o){e[0]=0,i[0]=-100000000000000000000,i[1]=100000000000000000000;for(var r=1,d=0;r<o;r++){for(var c=(l[r]+r*r-(l[e[d]]+e[d]*e[d]))/(2*r-2*e[d]);c<=i[d];)d--,c=(l[r]+r*r-(l[e[d]]+e[d]*e[d]))/(2*r-2*e[d]);e[++d]=r,i[d]=c,i[d+1]=100000000000000000000}for(r=0,d=0;r<o;r++){for(;i[d+1]<r;)d++;t[r]=(r-e[d])*(r-e[d])+l[e[d]]}}function _(t,e,i){var a=function(o,r){if(o)return i(o);if(r){var a=ea.pick(ea.extend(r,t),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);r.vector_layers&&(a.vectorLayers=r.vector_layers,a.vectorLayerIds=a.vectorLayers.map(function(e){return e.id})),a.tiles=e.canonicalizeTileset(a,t.url),i(null,a)}};return t.url?ea.getJSON(e.transformRequest(e.normalizeSourceURL(t.url),ea.ResourceType.Source),a):ea.browser.frame(function(){return a(null,t)})}function v(t,e){var a=ea.identity([]);return ea.translate(a,a,[1,1,0]),ea.scale(a,a,[.5*t.width,.5*t.height,1]),ea.multiply(a,a,t.calculatePosMatrix(e.toUnwrapped()))}function I(g,t,e,i,o,r){var a=function(l,t,e){if(l){for(var i=0,d=l,r;i<d.length;i+=1)if(r=t[d[i]],r&&r.source===e&&"fill-extrusion"===r.type)return!0;}else for(var c in t){var n=t[c];if(n.source===e&&"fill-extrusion"===n.type)return!0}return!1}(o&&o.layers,t,g.id),n=r.maxPitchScaleFactor(),s=g.tilesIn(i,n,a);s.sort(O);for(var l=[],c=0,m=s,h;c<m.length;c+=1)h=m[c],l.push({wrappedTileID:h.tileID.wrapped().key,queryResults:h.tile.queryRenderedFeatures(t,e,g._state,h.queryGeometry,h.cameraQueryGeometry,h.scale,o,r,n,v(g.transform,h.tileID))});var y=function(g){for(var t={},e={},i=0,m=g;i<m.length;i+=1){var r=m[i],a=r.queryResults,n=r.wrappedTileID,s=e[n]=e[n]||{};for(var l in a)for(var c=a[l],u=s[l]=s[l]||{},h=t[l]=t[l]||[],p=0,y=c,x;p<y.length;p+=1)x=y[p],u[x.featureIndex]||(u[x.featureIndex]=!0,h.push(x))}return t}(l);for(var d in y)y[d].forEach(function(t){var e=t.feature,a=g.getFeatureState(e.layer["source-layer"],e.id);e.source=e.layer.source,e.layer["source-layer"]&&(e.sourceLayer=e.layer["source-layer"]),e.state=a});return y}function O(a,t){var e=a.tileID,r=t.tileID;return e.overscaledZ-r.overscaledZ||e.canonical.y-r.canonical.y||e.wrap-r.wrap||e.canonical.x-r.canonical.x}function B(a,t){var e=ma(2*a.wrap)-+(0>a.wrap),r=ma(2*t.wrap)-+(0>t.wrap);return a.overscaledZ-t.overscaledZ||r-e||t.canonical.y-a.canonical.y||t.canonical.x-a.canonical.x}function F(e){return"raster"===e||"image"===e||"video"===e}function At(){return new ea.window.Worker(Gr.workerUrl)}function Lt(){return Ot||(Ot=new Dt),Ot}function Mt(t,e){var a={};for(var o in t)"ref"!=o&&(a[o]=t[o]);return ea.refProperties.forEach(function(o){o in e&&(a[o]=e[o])}),a}function Ft(a){a=a.slice();for(var r=Object.create(null),e=0;e<a.length;e++)r[a[e].id]=a[e];for(var n=0;n<a.length;n++)"ref"in a[n]&&(a[n]=Mt(a[n],r[a[n].ref]));return a}function Nt(a,t,e){e.push({command:Wa.addSource,args:[a,t[a]]})}function jt(a,t,e){t.push({command:Wa.removeSource,args:[a]}),e[a]=!0}function Ut(a,t,e,r){jt(a,e,r),Nt(a,t,e)}function Vt(t,e,a){for(var o in t[a])if(t[a].hasOwnProperty(o)&&"data"!==o&&!ea.deepEqual(t[a][o],e[a][o]))return!1;for(o in e[a])if(e[a].hasOwnProperty(o)&&"data"!==o&&!ea.deepEqual(t[a][o],e[a][o]))return!1;return!0}function qt(t,l,d,o,r,a){for(var n in l=l||{},t=t||{})t.hasOwnProperty(n)&&(ea.deepEqual(t[n],l[n])||d.push({command:a,args:[o,n,l[n],r]}));for(n in l)l.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(ea.deepEqual(t[n],l[n])||d.push({command:a,args:[o,n,l[n],r]}))}function Gt(e){return e.id}function Wt(a,t){return a[t.id]=t,a}function Ht(t,e,i,o,r){var a=ea.create();return e?(ea.scale(a,a,[1/r,1/r,1]),i||ea.rotateZ(a,a,o.angle)):ea.multiply(a,o.labelPlaneMatrix,t),a}function Xt(t,e,i,o,r){if(e){var a=ea.clone(t);return ea.scale(a,a,[r,r,1]),i||ea.rotateZ(a,a,-o.angle),a}return o.glCoordMatrix}function Jt(t,e){var a=[t.x,t.y,0,1];ce(a,a,e);var o=a[3];return{point:new ea.Point(a[0]/o,a[1]/o),signedDistanceFromCamera:o}}function $t(a,t){return .5+.5*(a/t)}function te(a,t){var e=a[0]/a[3],r=a[1]/a[3];return e>=-t[0]&&e<=t[0]&&r>=-t[1]&&r<=t[1]}function ee(t,e,i,o,r,a,n,s){var l=o?t.textSizeData:t.iconSizeData,c=ea.evaluateSizeForZoom(l,i.transform.zoom),u=[2*(256/i.width)+1,2*(256/i.height)+1],h=o?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;h.clear();for(var p=t.lineVertexArray,d=o?t.text.placedSymbolArray:t.icon.placedSymbolArray,_=i.transform.width/i.transform.height,f=!1,k=0,A;k<d.length;k++)if(A=d.get(k),A.hidden||A.writingMode===ea.WritingMode.vertical&&!f)se(A.numGlyphs,h);else{f=!1;var S=[A.anchorX,A.anchorY,0,1];if(ea.transformMat4(S,S,e),te(S,u)){var y=$t(i.transform.cameraToCenterDistance,S[3]),x=ea.evaluateSizeForFeature(l,c,A),b=n?x/y:x*y,w=new ea.Point(A.anchorX,A.anchorY),T=Jt(w,r).point,C={},L=re(A,b,!1,s,e,r,a,t.glyphOffsetArray,p,h,T,w,C,_);f=L.useVertical,(L.notEnoughRoom||f||L.needsFlipping&&re(A,b,!0,s,e,r,a,t.glyphOffsetArray,p,h,T,w,C,_).notEnoughRoom)&&se(A.numGlyphs,h)}else se(A.numGlyphs,h)}o?t.text.dynamicLayoutVertexBuffer.updateData(h):t.icon.dynamicLayoutVertexBuffer.updateData(h)}function ie(y,t,e,i,o,r,a,n,s,l,c){var u=n.glyphStartIndex+n.numGlyphs,h=n.lineStartIndex,p=n.lineStartIndex+n.lineLength,d=t.getoffsetX(n.glyphStartIndex),x=t.getoffsetX(u-1),f=ne(y*d,e,i,o,r,a,n.segment,h,p,s,l,c);if(!f)return null;var m=ne(y*x,e,i,o,r,a,n.segment,h,p,s,l,c);return m?{first:f,last:m}:null}function oe(t,e,a,o){return t===ea.WritingMode.horizontal&&ma(a.y-e.y)>ma(a.x-e.x)*o?{useVertical:!0}:(t===ea.WritingMode.vertical?e.y<a.y:e.x>a.x)?{needsFlipping:!0}:null}function re(t,e,i,o,r,a,n,s,l,c,u,h,p,d){var _=e/24,m=t.lineOffsetX*_,g=t.lineOffsetY*_,v;if(1<t.numGlyphs){var O=t.glyphStartIndex+t.numGlyphs,y=t.lineStartIndex,x=t.lineStartIndex+t.lineLength,b=ie(_,s,m,g,i,u,h,t,l,a,p);if(!b)return{notEnoughRoom:!0};var w=Jt(b.first.point,n).point,T=Jt(b.last.point,n).point;if(o&&!i){var E=oe(t.writingMode,w,T,d);if(E)return E}v=[b.first];for(var I=t.glyphStartIndex+1;I<O-1;I++)v.push(ne(_*s.getoffsetX(I),m,g,i,u,h,t.segment,y,x,l,a,p));v.push(b.last)}else{if(o&&!i){var j=Jt(h,r).point,S=t.lineStartIndex+t.segment+1,C=new ea.Point(l.getx(S),l.gety(S)),z=Jt(C,r),D=0<z.signedDistanceFromCamera?z.point:ae(h,C,j,1,r),M=oe(t.writingMode,j,D,d);if(M)return M}var A=ne(_*s.getoffsetX(t.glyphStartIndex),m,g,i,u,h,t.segment,t.lineStartIndex,t.lineStartIndex+t.lineLength,l,a,p);if(!A)return{notEnoughRoom:!0};v=[A]}for(var L=0,F=v,k;L<F.length;L+=1)k=F[L],ea.addDynamicAttributes(c,k.point,k.angle);return{}}function ae(l,t,e,i,o){var r=Jt(l.add(l.sub(t)._unit()),o).point,a=e.sub(r);return e.add(a._mult(i/a.mag()))}function ne(t,e,i,o,r,a,n,s,l,c,u,h){var p=o?t-e:t+e,d=0<p?1:-1,A=0;o&&(d*=-1,A=Ke),0>d&&(A+=Ke);for(var L=0<d?s+n:s+n+1,D=r,O=r,R=0,M=0,j=ma(p),b=[];R+M<=j;){if((L+=d)<s||L>=l)return null;if(O=D,b.push(D),void 0===(D=h[L])){var w=new ea.Point(c.getx(L),c.gety(L)),T=Jt(w,u);if(0<T.signedDistanceFromCamera)D=h[L]=T.point;else{var E=L-d;D=ae(0===R?a:new ea.Point(c.getx(E),c.gety(E)),w,O,j-R+1,u)}}R+=M,M=O.dist(D)}var I=(j-R)/M,P=D.sub(O),S=P.mult(I)._add(O);S._add(P._unit()._perp()._mult(i*d));var C=A+k(D.y-O.y,D.x-O.x);return b.push(S),{point:S,angle:C,path:b}}function se(a,t){for(var e=0,r;e<a;e++)r=t.length,t.resize(r+4),t.float32.set(Yt,3*r)}function ce(a,t,e){var i=t[0],o=t[1];return a[0]=e[0]*i+e[4]*o+e[12],a[1]=e[1]*i+e[5]*o+e[13],a[3]=e[3]*i+e[7]*o+e[15],a}function ue(t,e,a){return e*(ea.EXTENT/(t.tileSize*pa(2,a-t.tileID.overscaledZ)))}function pe(t,e,i,o,r){var a=ea.getAnchorAlignment(t),n=-(a.horizontalAlign-.5)*e,s=-(a.verticalAlign-.5)*i,l=ea.evaluateVariableOffset(t,o);return new ea.Point(n+l[0]*r,s+l[1]*r)}function ye(t,e,i,o,r,a){var n=t.x1,s=t.x2,l=t.y1,c=t.y2,u=t.anchorPointX,g=t.anchorPointY,p=new ea.Point(e,i);return o&&p._rotate(r?a:-a),{x1:n+p.x,y1:l+p.y,x2:s+p.x,y2:c+p.y,anchorPointX:u,anchorPointY:g}}function xe(a,t,e,i,o){a.emplaceBack(t?1:0,e?1:0,i||0,o||0),a.emplaceBack(t?1:0,e?1:0,i||0,o||0),a.emplaceBack(t?1:0,e?1:0,i||0,o||0),a.emplaceBack(t?1:0,e?1:0,i||0,o||0)}function we(a){if(0===a.opacity&&!a.placed)return 0;if(1===a.opacity&&a.placed)return 4294967295;var t=a.placed?1:0,e=ya(127*a.opacity);return 33554432*e+16777216*t+131072*e+65536*t+512*e+256*t+2*e+t}function De(a,r){var n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l={};return{fragmentSource:a=a.replace(n,function(o,t,e,i,r){return l[r]=!0,"define"===t?"\n#ifndef HAS_UNIFORM_u_"+r+"\nvarying "+e+" "+i+" "+r+";\n#else\nuniform "+e+" "+i+" u_"+r+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+r+"\n    "+e+" "+i+" "+r+" = u_"+r+";\n#endif\n"}),vertexSource:r=r.replace(n,function(o,t,e,i,r){var a="float"===i?"vec2":"vec4",n=r.match(/color/)?"color":a;return l[r]?"define"===t?"\n#ifndef HAS_UNIFORM_u_"+r+"\nuniform lowp float u_"+r+"_t;\nattribute "+e+" "+a+" a_"+r+";\nvarying "+e+" "+i+" "+r+";\n#else\nuniform "+e+" "+i+" u_"+r+";\n#endif\n":"vec4"===n?"\n#ifndef HAS_UNIFORM_u_"+r+"\n    "+r+" = a_"+r+";\n#else\n    "+e+" "+i+" "+r+" = u_"+r+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+r+"\n    "+r+" = unpack_mix_"+n+"(a_"+r+", u_"+r+"_t);\n#else\n    "+e+" "+i+" "+r+" = u_"+r+";\n#endif\n":"define"===t?"\n#ifndef HAS_UNIFORM_u_"+r+"\nuniform lowp float u_"+r+"_t;\nattribute "+e+" "+a+" a_"+r+";\n#else\nuniform "+e+" "+i+" u_"+r+";\n#endif\n":"vec4"===n?"\n#ifndef HAS_UNIFORM_u_"+r+"\n    "+e+" "+i+" "+r+" = a_"+r+";\n#else\n    "+e+" "+i+" "+r+" = u_"+r+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+r+"\n    "+e+" "+i+" "+r+" = unpack_mix_"+n+"(a_"+r+", u_"+r+"_t);\n#else\n    "+e+" "+i+" "+r+" = u_"+r+";\n#endif\n"})}}function Qt(l,t,e){var i=1/ue(e,1,t.transform.tileZoom),o=pa(2,e.tileID.overscaledZ),r=e.tileSize*pa(2,t.transform.tileZoom)/o,a=r*(e.tileID.canonical.x+e.tileID.wrap*o),n=r*e.tileID.canonical.y;return{u_image:0,u_texsize:e.imageAtlasTexture.size,u_scale:[i,l.fromScale,l.toScale],u_fade:l.t,u_pixel_coord_upper:[a>>16,n>>16],u_pixel_coord_lower:[65535&a,65535&n]}}function ta(a,t){return 1/ue(a,1,t.tileZoom)}function aa(a,t,e){return a.translatePosMatrix(t.tileID.posMatrix,t,e.paint.get("line-translate"),e.paint.get("line-translate-anchor"))}function oa(a){a*=Ke/180;var o=Je(a),e=Ge(a);return[(2*e+1)/3,(-We(3)*o-e+1)/3,(We(3)*o-e+1)/3]}function ra(t,e,i,o,r,a,n){for(var s=t.context,l=s.gl,c=t.useProgram("collisionBox"),u=[],h=0,j=0,V=0;V<o.length;V++){var H=o[V],f=e.getTile(H),m=f.getBucket(i);if(m){var g=H.posMatrix;0===r[0]&&0===r[1]||(g=t.translatePosMatrix(H.posMatrix,f,r,a));var q=n?m.textCollisionBox:m.iconCollisionBox,y=m.collisionCircleArray;if(0<y.length){var x=ea.create(),b=g;ea.mul(x,m.placementInvProjMatrix,t.transform.glCoordMatrix),ea.mul(x,x,m.placementViewportMatrix),u.push({circleArray:y,circleOffset:j,transform:b,invTransform:x}),j=h+=y.length/4}q&&c.draw(s,l.LINES,Et.disabled,It.disabled,t.colorModeForRenderPass(),St.disabled,Xr(g,t.transform,f),i.id,q.layoutVertexBuffer,q.indexBuffer,q.segments,null,t.transform.zoom,null,null,q.collisionVertexBuffer)}}if(n&&u.length){var w=t.useProgram("collisionCircle"),T=new ea.StructArrayLayout2f1f2i16;T.resize(4*h),T._trim();for(var E=0,G=0,Y=u;G<Y.length;G+=1)for(var S=Y[G],C=0;C<S.circleArray.length/4;C++){var W=4*C,D=S.circleArray[W+0],M=S.circleArray[W+1],A=S.circleArray[W+2],L=S.circleArray[W+3];T.emplace(E++,D,M,A,L,0),T.emplace(E++,D,M,A,L,1),T.emplace(E++,D,M,A,L,2),T.emplace(E++,D,M,A,L,3)}(!vo||vo.length<2*h)&&(vo=function(t){var e=2*t,i=new ea.StructArrayLayout3ui6;i.resize(e),i._trim();for(var o=0,n;o<e;o++)n=6*o,i.uint16[n+0]=4*o+0,i.uint16[n+1]=4*o+1,i.uint16[n+2]=4*o+2,i.uint16[n+3]=4*o+2,i.uint16[n+4]=4*o+3,i.uint16[n+5]=4*o+0;return i}(h));for(var R=s.createIndexBuffer(vo,!0),k=s.createVertexBuffer(T,ea.collisionCircleLayout.members,!0),B=0,X=u;B<X.length;B+=1){var F=X[B],U=Zr(F.transform,F.invTransform,t.transform);w.draw(s,l.TRIANGLES,Et.disabled,It.disabled,t.colorModeForRenderPass(),St.disabled,U,i.id,k,R,ea.SegmentVector.simpleSegment(0,2*F.circleOffset,F.circleArray.length,F.circleArray.length/2),null,t.transform.zoom,null,null,null)}k.destroy(),R.destroy()}}function ia(t,e,i,o,r,a){var n=ea.getAnchorAlignment(t),s=-(n.horizontalAlign-.5)*e,l=-(n.verticalAlign-.5)*i,d=ea.evaluateVariableOffset(t,o);return new ea.Point((s/r+d[0])*a,(l/r+d[1])*a)}function na(t,e,i,o,r,a,n,s,l,c,u){var h=t.text.placedSymbolArray,p=t.text.dynamicLayoutVertexArray,d=t.icon.dynamicLayoutVertexArray,_={};p.clear();for(var f=0;f<h.length;f++){var k=h.get(f),g=k.hidden||!k.crossTileID||t.allowVerticalPlacement&&!k.placedOrientation?null:o[k.crossTileID];if(g){var v=new ea.Point(k.anchorX,k.anchorY),y=Jt(v,i?s:n),x=$t(a.cameraToCenterDistance,y.signedDistanceFromCamera),b=r.evaluateSizeForFeature(t.textSizeData,c,k)*x/ea.ONE_EM;i&&(b*=t.tilePixelRatio/l);for(var A=ia(g.anchor,g.width,g.height,g.textOffset,g.textBoxScale,b),T=i?Jt(v.add(A),n).point:y.point.add(e?A.rotate(-a.angle):A),L=t.allowVerticalPlacement&&k.placedOrientation===ea.WritingMode.vertical?Ke/2:0,E=0;E<k.numGlyphs;E++)ea.addDynamicAttributes(p,T,L);u&&0<=k.associatedIconIndex&&(_[k.associatedIconIndex]={shiftedAnchor:T,angle:L})}else se(k.numGlyphs,p)}if(u){d.clear();for(var I=t.icon.placedSymbolArray,S=0,O;S<I.length;S++)if(O=I.get(S),O.hidden)se(O.numGlyphs,d);else{var R=_[S];if(R)for(var D=0;D<O.numGlyphs;D++)ea.addDynamicAttributes(d,R.shiftedAnchor,R.angle);else se(O.numGlyphs,d)}t.icon.dynamicLayoutVertexBuffer.updateData(d)}t.text.dynamicLayoutVertexBuffer.updateData(p)}function la(a,t,e){return e.iconsInText&&t?"symbolTextAndIcon":a?"symbolSDF":"symbolIcon"}function sa(t,e,i,o,r,a,n,s,l,c,u,h){for(var p=t.context,d=p.gl,_=t.transform,f="map"===s,m="map"===l,g=f&&"point"!==i.layout.get("symbol-placement"),v=f&&!m&&!g,y=void 0!==i.layout.get("symbol-sort-key").constantOr(1),x=t.depthModeForSublayer(0,Et.ReadOnly),b=i.layout.get("text-variable-anchor"),w=[],T=0,te=o;T<te.length;T+=1){var I=te[T],P=e.getTile(I),S=P.getBucket(i);if(S){var C=r?S.text:S.icon;if(C&&C.segments.get().length){var z=C.programConfigurations.get(i.id),D=r||S.sdfIcons,M=r?S.textSizeData:S.iconSizeData,A=m||0!==_.pitch,L=t.useProgram(la(D,r,S),z),R=ea.evaluateSizeForZoom(M,_.zoom),k=void 0,ae=[0,0],oe=void 0,re=void 0,ie=null,ne=void 0;if(r)oe=P.glyphAtlasTexture,re=d.LINEAR,k=P.glyphAtlasTexture.size,S.iconsInText&&(ae=P.imageAtlasTexture.size,ie=P.imageAtlasTexture,ne=A||t.options.rotating||t.options.zooming||"composite"===M.kind||"camera"===M.kind?d.LINEAR:d.NEAREST);else{var le=1!==i.layout.get("icon-size").constantOr(0)||S.iconsNeedLinear;oe=P.imageAtlasTexture,re=D||t.options.rotating||t.options.zooming||le||A?d.LINEAR:d.NEAREST,k=P.imageAtlasTexture.size}var j=ue(P,1,t.transform.zoom),q=Ht(I.posMatrix,m,f,t.transform,j),V=Xt(I.posMatrix,m,f,t.transform,j),G=b&&S.hasTextData(),W="none"!==i.layout.get("icon-text-fit")&&G&&S.hasIconData();g&&ee(S,I.posMatrix,t,r,q,V,m,c);var X=t.translatePosMatrix(I.posMatrix,P,a,n),H=g||r&&b||W?ci:q,K=t.translatePosMatrix(V,P,a,n,!0),Y=D&&0!==i.paint.get(r?"text-halo-width":"icon-halo-width").constantOr(1),J={program:L,buffers:C,uniformValues:D?S.iconsInText?ni(M.kind,R,v,m,t,X,H,K,k,ae):ii(M.kind,R,v,m,t,X,H,K,r,k,!0):ri(M.kind,R,v,m,t,X,H,K,r,k),atlasTexture:oe,atlasTextureIcon:ie,atlasInterpolation:re,atlasInterpolationIcon:ne,isSDF:D,hasHalo:Y};if(y)for(var Q=0,se=C.segments.get(),de;Q<se.length;Q+=1)de=se[Q],w.push({segments:new ea.SegmentVector([de]),sortKey:de.sortKey,state:J});else w.push({segments:C.segments,sortKey:0,state:J})}}}y&&w.sort(function(a,t){return a.sortKey-t.sortKey});for(var ce=0,pe=w;ce<pe.length;ce+=1){var ge=pe[ce],me=ge.state;if(p.activeTexture.set(d.TEXTURE0),me.atlasTexture.bind(me.atlasInterpolation,d.CLAMP_TO_EDGE),me.atlasTextureIcon&&(p.activeTexture.set(d.TEXTURE1),me.atlasTextureIcon&&me.atlasTextureIcon.bind(me.atlasInterpolationIcon,d.CLAMP_TO_EDGE)),me.isSDF){var he=me.uniformValues;me.hasHalo&&(he.u_is_halo=1,da(me.buffers,ge.segments,i,t,me.program,x,u,h,he)),he.u_is_halo=0}da(me.buffers,ge.segments,i,t,me.program,x,u,h,me.uniformValues)}}function da(d,t,e,i,o,r,a,n,s){var l=i.context;o.draw(l,l.gl.TRIANGLES,r,a,n,St.disabled,s,e.id,d.layoutVertexBuffer,d.indexBuffer,t,e.paint,i.transform.zoom,d.programConfigurations.get(e.id),d.dynamicLayoutVertexBuffer,d.opacityVertexBuffer)}function ca(k,t,e,i,o,r,a){var n=k.context.gl,p=e.paint.get("fill-pattern"),d=p&&p.constantOr(1),_=e.getCrossfadeParameters(),f,A,L,z,D;a?(A=d&&!e.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",f=n.LINES):(A=d?"fillPattern":"fill",f=n.TRIANGLES);for(var O=0,R=i;O<R.length;O+=1){var g=R[O],v=t.getTile(g);if(!d||v.patternsLoaded()){var y=v.getBucket(e);if(y){var x=y.programConfigurations.get(e.id),b=k.useProgram(A,x);d&&(k.context.activeTexture.set(n.TEXTURE0),v.imageAtlasTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE),x.updatePaintBuffers(_));var w=p.constantOr(null);if(w&&v.imageAtlas){var T=v.imageAtlas,E=T.patternPositions[w.to.toString()],I=T.patternPositions[w.from.toString()];E&&I&&x.setConstantPatternPositions(E,I)}var P=k.translatePosMatrix(g.posMatrix,v,e.paint.get("fill-translate"),e.paint.get("fill-translate-anchor"));if(a){z=y.indexBuffer2,D=y.segments2;var S=[n.drawingBufferWidth,n.drawingBufferHeight];L="fillOutlinePattern"===A&&d?Hr(P,k,_,v,S):jr(P,S)}else z=y.indexBuffer,D=y.segments,L=d?Dr(P,k,_,v):Pr(P);b.draw(k.context,f,o,k.stencilModeForClipping(g),r,St.disabled,L,e.id,y.layoutVertexBuffer,z,D,e.paint,k.transform.zoom,x)}}}}function ga(k,t,e,i,o,r,a){for(var n=k.context,s=n.gl,l=e.paint.get("fill-extrusion-pattern"),c=l.constantOr(1),u=e.getCrossfadeParameters(),h=e.paint.get("fill-extrusion-opacity"),p=0,A=i;p<A.length;p+=1){var _=A[p],f=t.getTile(_),m=f.getBucket(e);if(m){var g=m.programConfigurations.get(e.id),v=k.useProgram(c?"fillExtrusionPattern":"fillExtrusion",g);c&&(k.context.activeTexture.set(s.TEXTURE0),f.imageAtlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE),g.updatePaintBuffers(u));var y=l.constantOr(null);if(y&&f.imageAtlas){var x=f.imageAtlas,b=x.patternPositions[y.to.toString()],w=x.patternPositions[y.from.toString()];b&&w&&g.setConstantPatternPositions(b,w)}var T=k.translatePosMatrix(_.posMatrix,f,e.paint.get("fill-extrusion-translate"),e.paint.get("fill-extrusion-translate-anchor")),S=e.paint.get("fill-extrusion-vertical-gradient"),C=c?Ar(T,k,S,h,_,u,f):_r(T,k,S,h);v.draw(n,n.gl.TRIANGLES,o,r,a,St.backCCW,C,e.id,m.layoutVertexBuffer,m.indexBuffer,m.segments,e.paint,k.transform.zoom,g)}}}function fa(t,e,i,o,r,a){var n=t.context,s=n.gl,l=e.fbo;if(l){var d=t.useProgram("hillshade");n.activeTexture.set(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,l.colorAttachment.get());var c=function(t,e,i){var o=i.paint.get("hillshade-shadow-color"),r=i.paint.get("hillshade-highlight-color"),a=i.paint.get("hillshade-accent-color"),n=i.paint.get("hillshade-illumination-direction")*(Ke/180);"viewport"===i.paint.get("hillshade-illumination-anchor")&&(n-=t.transform.angle);var d=!t.options.moving,p,g,m;return{u_matrix:t.transform.calculatePosMatrix(e.tileID.toUnwrapped(),d),u_image:0,u_latrange:(p=e.tileID,g=pa(2,p.canonical.z),m=p.canonical.y,[new ea.MercatorCoordinate(0,m/g).toLngLat().lat,new ea.MercatorCoordinate(0,(m+1)/g).toLngLat().lat]),u_light:[i.paint.get("hillshade-exaggeration"),n],u_shadow:o,u_highlight:r,u_accent:a}}(t,e,i);d.draw(n,s.TRIANGLES,o,r,a,St.disabled,c,i.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}}function xa(t,e,i,o,r,a,n){var s=t.context,l=s.gl,c=e.dem;if(c&&c.data){var u=c.dim,g=c.stride,p=c.getPixels();if(s.activeTexture.set(l.TEXTURE1),s.pixelStoreUnpackPremultiplyAlpha.set(!1),e.demTexture=e.demTexture||t.getTileTexture(g),e.demTexture){var d=e.demTexture;d.update(p,{premultiply:!1}),d.bind(l.NEAREST,l.CLAMP_TO_EDGE)}else e.demTexture=new ea.Texture(s,p,l.RGBA,{premultiply:!1}),e.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE);s.activeTexture.set(l.TEXTURE0);var h=e.fbo;if(!h){var y=new ea.Texture(s,{width:u,height:u,data:null},l.RGBA);y.bind(l.LINEAR,l.CLAMP_TO_EDGE),(h=e.fbo=s.createFramebuffer(u,u,!0)).colorAttachment.set(y.texture)}s.bindFramebuffer.set(h.framebuffer),s.viewport.set([0,0,u,u]),t.useProgram("hillshadePrepare").draw(s,l.TRIANGLES,r,a,n,St.disabled,function(t,e,i){var o=e.stride,r=ea.create();return ea.ortho(r,0,ea.EXTENT,-ea.EXTENT,0,0,1),ea.translate(r,r,[0,-ea.EXTENT,0]),{u_matrix:r,u_image:1,u_dimension:[o,o],u_zoom:t.overscaledZ,u_maxzoom:i,u_unpack:e.getUnpackVector()}}(e.tileID,c,o),i.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments),e.needsHillshadePrepare=!1}}function _a(t,e,i,o,r){var a=o.paint.get("raster-fade-duration");if(0<a){var n=ea.browser.now(),s=(n-t.timeAdded)/a,l=e?(n-e.timeAdded)/a:-1,c=i.getSource(),u=r.coveringZoomLevel({tileSize:c.tileSize,roundZoom:c.roundZoom}),g=!e||ma(e.tileID.overscaledZ-u)>ma(t.tileID.overscaledZ-u),p=g&&t.refreshedUponExpiration?1:ea.clamp(g?s:1-l,0,1);return t.refreshedUponExpiration&&1<=s&&(t.refreshedUponExpiration=!1),e?{opacity:1,mix:1-p}:{opacity:p,mix:0}}return{opacity:1,mix:0}}function ba(a,t,e,r){wa(a,0,t+e/2,a.transform.width,e,r)}function va(a,t,e,r){wa(a,t-e/2,0,e,a.transform.height,r)}function wa(t,e,i,o,r,a){var n=t.context,s=n.gl;s.enable(s.SCISSOR_TEST),s.scissor(e*ea.browser.devicePixelRatio,i*ea.browser.devicePixelRatio,o*ea.browser.devicePixelRatio,r*ea.browser.devicePixelRatio),n.clear({color:a}),s.disable(s.SCISSOR_TEST)}function ka(t,e,i){var o=t.context,r=o.gl,a=i.posMatrix,n=t.useProgram("debug"),s=Et.disabled,l=It.disabled,c=t.colorModeForRenderPass();o.activeTexture.set(r.TEXTURE0),t.emptyTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE),n.draw(o,r.LINE_STRIP,s,l,c,St.disabled,Kr(a,ea.Color.red),"$debug",t.debugBuffer,t.tileBorderIndexBuffer,t.debugSegments);var u=e.getTileByID(i.key).latestRawTileData,g=ya((u&&u.byteLength||0)/1024),p=e.getTile(i).tileSize,d=.5*(512/Rt(p,512)*(i.overscaledZ/t.transform.zoom)),m=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(m+=" => "+i.overscaledZ),function(a,t){a.initDebugOverlayCanvas();var e=a.debugOverlayCanvas,i=a.context.gl,o=a.debugOverlayCanvas.getContext("2d");o.clearRect(0,0,e.width,e.height),o.shadowColor="white",o.shadowBlur=2,o.lineWidth=1.5,o.strokeStyle="white",o.textBaseline="top",o.font="bold 36px Open Sans, sans-serif",o.fillText(t,5,5),o.strokeText(t,5,5),a.debugOverlayTexture.update(e),a.debugOverlayTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)}(t,m+" "+g+"kb"),n.draw(o,r.TRIANGLES,s,l,Pt.alphaBlended,St.disabled,Kr(a,ea.Color.transparent,d),"$debug",t.debugBuffer,t.quadTriangleIndexBuffer,t.debugSegments)}function Ta(a,t){(!a.duration||a.duration<t.duration)&&(a.duration=t.duration,a.easing=t.easing)}function Aa(t,e,i){var o=i.maxSpeed,r=i.linearity,a=i.deceleration,n=ea.clamp(t*r/(e/1e3),-o,o),s=ma(n)/(a*r);return{easing:i.easing,duration:1e3*s,amount:n*(s/2)}}function Sa(a,t){for(var e={},r=0;r<a.length;r++)e[a[r].identifier]=t[r];return e}function Ca(a,t,e){for(var r=0;r<a.targetTouches.length;r++)if(a.targetTouches[r].identifier===e)return t[r]}function La(a,t){return C(a/t)/T}function Ea(a,t){return 180*a.angleWith(t)/Ke}function Ia(e){return ma(e.y)>ma(e.x)}function Pa(e){return e*(2-e)}function za(e){return e.panDelta&&e.panDelta.mag()||e.zoomDelta||e.bearingDelta||e.pitchDelta}function Da(e){e.parentNode&&e.parentNode.removeChild(e)}function Oa(t,l,i){if(t=new ea.LngLat(t.lng,t.lat),l){var o=new ea.LngLat(t.lng-360,t.lat),r=new ea.LngLat(t.lng+360,t.lat),a=i.locationPoint(t).distSqr(l);i.locationPoint(o).distSqr(l)<a?t=o:i.locationPoint(r).distSqr(l)<a&&(t=r)}for(;180<ma(t.lng-i.center.lng);){var n=i.locationPoint(t);if(0<=n.x&&0<=n.y&&n.x<=i.width&&n.y<=i.height)break;t.lng>i.center.lng?t.lng-=360:t.lng+=360}return t}function Ra(a,t,e){var i=a.classList;for(var o in zr)i.remove("mapboxgl-"+e+"-anchor-"+o);i.add("mapboxgl-"+e+"-anchor-"+t)}function Ma(d,t,e){var i=e&&e.maxWidth||100,o=d._container.clientHeight/2,r=d.unproject([0,o]),a=d.unproject([i,o]),n=r.distanceTo(a);if(e&&"imperial"===e.unit){var s=3.2808*n;5280<s?ja(t,i,s/5280,d._getUIString("ScaleControl.Miles")):ja(t,i,s,d._getUIString("ScaleControl.Feet"))}else e&&"nautical"===e.unit?ja(t,i,n/1852,d._getUIString("ScaleControl.NauticalMiles")):1e3<=n?ja(t,i,n/1e3,d._getUIString("ScaleControl.Kilometers")):ja(t,i,n,d._getUIString("ScaleControl.Meters"))}function ja(l,t,e,i){var o=(s=e,(d=pa(10,(""+ya(s)).length-1))*(c=10<=(c=s/d)?10:5<=c?5:3<=c?3:2<=c?2:1<=c?1:function(a){var t=pa(10,Ye(-C(a)/A));return Xe(a*t)/t}(c))),s,d,c;l.style.width=t*(o/e)+"px",l.innerHTML=o+"&nbsp;"+i}var Ba=ea.createCommonjsModule(function(a){function r(a){return!e(a)}function e(e){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var a=new Blob([""],{type:"text/javascript"}),r=URL.createObjectURL(a),o,i;try{i=new Worker(r),o=!0}catch(t){o=!1}return i&&i.terminate(),URL.revokeObjectURL(r),o}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var a=document.createElement("canvas");a.width=a.height=1;var t=a.getContext("2d");if(!t)return!1;var e=t.getImageData(0,0,1,1);return e&&e.width===a.width}()?(void 0===n[t=e&&e.failIfMajorPerformanceCaveat]&&(n[t]=function(e){var t=function(e){var t=document.createElement("canvas"),a=Object.create(r.webGLContextAttributes);return a.failIfMajorPerformanceCaveat=e,t.probablySupportsContext?t.probablySupportsContext("webgl",a)||t.probablySupportsContext("experimental-webgl",a):t.supportsContext?t.supportsContext("webgl",a)||t.supportsContext("experimental-webgl",a):t.getContext("webgl",a)||t.getContext("experimental-webgl",a)}(e);if(!t)return!1;var a=t.createShader(t.VERTEX_SHADER);return a&&!t.isContextLost()&&(t.shaderSource(a,"void main() {}"),t.compileShader(a),!0===t.getShaderParameter(a,t.COMPILE_STATUS))}(t)),n[t]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var t}a.exports?a.exports=r:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=r,window.mapboxgl.notSupportedReason=e);var n={};r.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),Fa={create:function(t,e,a){var o=ea.window.document.createElement(t);return void 0!==e&&(o.className=e),a&&a.appendChild(o),o},createNS:function(t,e){return ea.window.document.createElementNS(t,e)}},i=ea.window.document.documentElement.style,e=t(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),n;Fa.disableDrag=function(){i&&e&&(n=i[e],i[e]="none")},Fa.enableDrag=function(){i&&e&&(i[e]=n)};var Na=t(["transform","WebkitTransform"]);Fa.setTransform=function(a,t){a.style[Na]=t};var s=!1;try{var Va=Object.defineProperty({},"passive",{get:function(){s=!0}});ea.window.addEventListener("test",Va,Va),ea.window.removeEventListener("test",Va,Va)}catch(e){s=!1}Fa.addEventListener=function(a,t,e,r){void 0===r&&(r={}),a.addEventListener(t,e,"passive"in r&&s?r:r.capture)},Fa.removeEventListener=function(a,t,e,r){void 0===r&&(r={}),a.removeEventListener(t,e,"passive"in r&&s?r:r.capture)};var c=function(t){t.preventDefault(),t.stopPropagation(),ea.window.removeEventListener("click",c,!0)};Fa.suppressClick=function(){ea.window.addEventListener("click",c,!0),ea.window.setTimeout(function(){ea.window.removeEventListener("click",c,!0)},0)},Fa.mousePos=function(t,e){var a=t.getBoundingClientRect();return new ea.Point(e.clientX-a.left-t.clientLeft,e.clientY-a.top-t.clientTop)},Fa.touchPos=function(t,e){for(var i=t.getBoundingClientRect(),o=[],r=0;r<e.length;r++)o.push(new ea.Point(e[r].clientX-i.left-t.clientLeft,e[r].clientY-i.top-t.clientTop));return o},Fa.mouseButton=function(t){return void 0!==ea.window.InstallTrigger&&2===t.button&&t.ctrlKey&&0<=ea.window.navigator.platform.toUpperCase().indexOf("MAC")?0:t.button},Fa.remove=function(e){e.parentNode&&e.parentNode.removeChild(e)};var u=function(t){function e(){t.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new ea.RGBAImage({width:1,height:1}),this.dirty=!0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.isLoaded=function(){return this.loaded},e.prototype.setLoaded=function(a){if(this.loaded!==a&&(this.loaded=a,a)){for(var t=0,r=this.requestors,i;t<r.length;t+=1)i=r[t],this._notify(i.ids,i.callback);this.requestors=[]}},e.prototype.getImage=function(e){return this.images[e]},e.prototype.addImage=function(a,t){this._validate(a,t)&&(this.images[a]=t)},e.prototype._validate=function(t,e){var a=!0;return this._validateStretch(e.stretchX,e.data&&e.data.width)||(this.fire(new ea.ErrorEvent(new Error("Image \""+t+"\" has invalid \"stretchX\" value"))),a=!1),this._validateStretch(e.stretchY,e.data&&e.data.height)||(this.fire(new ea.ErrorEvent(new Error("Image \""+t+"\" has invalid \"stretchY\" value"))),a=!1),this._validateContent(e.content,e)||(this.fire(new ea.ErrorEvent(new Error("Image \""+t+"\" has invalid \"content\" value"))),a=!1),a},e.prototype._validateStretch=function(n,t){if(!n)return!0;for(var e=0,l=0,s=n,r;l<s.length;l+=1){if(r=s[l],r[0]<e||r[1]<r[0]||t<r[1])return!1;e=r[1]}return!0},e.prototype._validateContent=function(a,t){return!(a&&(4!==a.length||0>a[0]||t.data.width<a[0]||0>a[1]||t.data.height<a[1]||0>a[2]||t.data.width<a[2]||0>a[3]||t.data.height<a[3]||a[2]<a[0]||a[3]<a[1]))},e.prototype.updateImage=function(a,t){t.version=this.images[a].version+1,this.images[a]=t,this.updatedImages[a]=!0},e.prototype.removeImage=function(a){var t=this.images[a];delete this.images[a],delete this.patterns[a],t.userImage&&t.userImage.onRemove&&t.userImage.onRemove()},e.prototype.listImages=function(){return Object.keys(this.images)},e.prototype.getImages=function(a,t){var e=!0;if(!this.isLoaded())for(var n=0,l=a;n<l.length;n+=1)this.images[l[n]]||(e=!1);this.isLoaded()||e?this._notify(a,t):this.requestors.push({ids:a,callback:t})},e.prototype._notify=function(t,e){for(var i={},o=0,l=t,a;o<l.length;o+=1){a=l[o],this.images[a]||this.fire(new ea.Event("styleimagemissing",{id:a}));var d=this.images[a];d?i[a]={data:d.data.clone(),pixelRatio:d.pixelRatio,sdf:d.sdf,version:d.version,stretchX:d.stretchX,stretchY:d.stretchY,content:d.content,hasRenderCallback:!!(d.userImage&&d.userImage.render)}:ea.warnOnce("Image \""+a+"\" could not be loaded. Please make sure you have added the image with map.addImage() or a \"sprite\" property in your style. You can provide missing images by listening for the \"styleimagemissing\" map event.")}e(null,i)},e.prototype.getPixelSize=function(){var e=this.atlasImage;return{width:e.width,height:e.height}},e.prototype.getPattern=function(t){var e=this.patterns[t],i=this.getImage(t);if(!i)return null;if(e&&e.position.version===i.version)return e.position;if(e)e.position.version=i.version;else{var o={w:i.data.width+2,h:i.data.height+2,x:0,y:0},r=new ea.ImagePosition(o,i);this.patterns[t]={bin:o,position:r}}return this._updatePatternAtlas(),this.patterns[t].position},e.prototype.bind=function(t){var e=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new ea.Texture(t,this.atlasImage,e.RGBA),this.atlasTexture.bind(e.LINEAR,e.CLAMP_TO_EDGE)},e.prototype._updatePatternAtlas=function(){var t=[];for(var e in this.patterns)t.push(this.patterns[e].bin);var i=ea.potpack(t),o=i.w,r=i.h,a=this.atlasImage;for(var n in a.resize({width:o||1,height:r||1}),this.patterns){var s=this.patterns[n].bin,l=s.x+1,c=s.y+1,u=this.images[n].data,g=u.width,p=u.height;ea.RGBAImage.copy(u,a,{x:0,y:0},{x:l,y:c},{width:g,height:p}),ea.RGBAImage.copy(u,a,{x:0,y:p-1},{x:l,y:c-1},{width:g,height:1}),ea.RGBAImage.copy(u,a,{x:0,y:0},{x:l,y:c+p},{width:g,height:1}),ea.RGBAImage.copy(u,a,{x:g-1,y:0},{x:l-1,y:c},{width:1,height:p}),ea.RGBAImage.copy(u,a,{x:0,y:0},{x:l+g,y:c},{width:1,height:p})}this.dirty=!0},e.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},e.prototype.dispatchRenderCallbacks=function(a){for(var t=0,n=a,i;t<n.length;t+=1)if(i=n[t],!this.callbackDispatchedThisFrame[i]){this.callbackDispatchedThisFrame[i]=!0;var l=this.images[i];f(l)&&this.updateImage(i,l)}},e}(ea.Evented),p=r;r.prototype.draw=function(a){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(a,this.buffer,this.middle);for(var t=this.ctx.getImageData(0,0,this.size,this.size),e=new Uint8ClampedArray(this.size*this.size),i=0,n;i<this.size*this.size;i++)n=t.data[4*i+3]/255,this.gridOuter[i]=1===n?0:0===n?100000000000000000000:pa(ha(0,.5-n),2),this.gridInner[i]=1===n?100000000000000000000:0===n?0:pa(ha(0,n-.5),2);for(m(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),m(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),i=0;i<this.size*this.size;i++)e[i]=ha(0,Rt(255,Xe(255-255*((this.gridOuter[i]-this.gridInner[i])/this.radius+this.cutoff))));return e},p.default=r;var Ua=function(a,t){this.requestManager=a,this.localIdeographFontFamily=t,this.entries={}};Ua.prototype.setURL=function(e){this.url=e},Ua.prototype.getGlyphs=function(t,d){var c=this,e=[];for(var o in t)for(var a=0,r=t[o];a<r.length;a+=1)e.push({stack:o,id:r[a]});ea.asyncAll(e,function(o,d){var e=o.stack,i=o.id,p=c.entries[e];p||(p=c.entries[e]={glyphs:{},requests:{},ranges:{}});var t=p.glyphs[i];if(void 0===t){if(t=c._tinySDF(p,e,i))return p.glyphs[i]=t,void d(null,{stack:e,id:i,glyph:t});var u=ya(i/256);if(65535<256*u)d(new Error("glyphs > 65535 not supported"));else if(p.ranges[u])d(null,{stack:e,id:i,glyph:t});else{var s=p.requests[u];s||(s=p.requests[u]=[],Ua.loadGlyphRange(e,u,c.url,c.requestManager,function(a,t){if(t){for(var e in t)c._doesCharSupportLocalGlyph(+e)||(p.glyphs[+e]=t[+e]);p.ranges[u]=!0}for(var o=0,i=s;o<i.length;o+=1)(0,i[o])(a,t);delete p.requests[u]})),s.push(function(a,t){a?d(a):t&&d(null,{stack:e,id:i,glyph:t[i]||null})})}}else d(null,{stack:e,id:i,glyph:t})},function(i,t){if(i)d(i);else if(t){for(var e={},o=0,p=t;o<p.length;o+=1){var a=p[o],n=a.stack,s=a.id,l=a.glyph;(e[n]||(e[n]={}))[s]=l&&{id:l.id,bitmap:l.bitmap.clone(),metrics:l.metrics}}d(null,e)}})},Ua.prototype._doesCharSupportLocalGlyph=function(t){return!!this.localIdeographFontFamily&&(ea.isChar["CJK Unified Ideographs"](t)||ea.isChar["Hangul Syllables"](t)||ea.isChar.Hiragana(t)||ea.isChar.Katakana(t))},Ua.prototype._tinySDF=function(t,e,i){var o=this.localIdeographFontFamily;if(o&&this._doesCharSupportLocalGlyph(i)){var r=t.tinySDF;if(!r){var l="400";/bold/i.test(e)?l="900":/medium/i.test(e)?l="500":/light/i.test(e)&&(l="200"),r=t.tinySDF=new Ua.TinySDF(24,3,8,.25,o,l)}return{id:i,bitmap:new ea.AlphaImage({width:30,height:30},r.draw(d(i))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Ua.loadGlyphRange=function(t,e,i,o,d){var a=256*e,r=o.transformRequest(o.normalizeGlyphsURL(i).replace("{fontstack}",t).replace("{range}",a+"-"+(a+255)),ea.ResourceType.Glyphs);ea.getArrayBuffer(r,function(t,e){if(t)d(t);else if(e){for(var a={},o=0,i=ea.parseGlyphPBF(e),n;o<i.length;o+=1)n=i[o],a[n.id]=n;d(null,a)}})},Ua.TinySDF=p;var y=function(){this.specification=ea.styleSpec.light.position};y.prototype.possiblyEvaluate=function(t,e){return ea.sphericalToCartesian(t.expression.evaluate(e))},y.prototype.interpolate=function(t,e,a){return{x:ea.number(t.x,e.x,a),y:ea.number(t.y,e.y,a),z:ea.number(t.z,e.z,a)}};var x=new ea.Properties({anchor:new ea.DataConstantProperty(ea.styleSpec.light.anchor),position:new y,color:new ea.DataConstantProperty(ea.styleSpec.light.color),intensity:new ea.DataConstantProperty(ea.styleSpec.light.intensity)}),b=function(t){function e(e){t.call(this),this._transitionable=new ea.Transitionable(x),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getLight=function(){return this._transitionable.serialize()},e.prototype.setLight=function(t,e){if(void 0===e&&(e={}),!this._validate(ea.validateLight,t,e))for(var a in t){var o=t[a];ea.endsWith(a,"-transition")?this._transitionable.setTransition(a.slice(0,-11),o):this._transitionable.setValue(a,o)}},e.prototype.updateTransitions=function(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)},e.prototype.hasTransition=function(){return this._transitioning.hasTransition()},e.prototype.recalculate=function(e){this.properties=this._transitioning.possiblyEvaluate(e)},e.prototype._validate=function(t,e,a){return(!a||!1!==a.validate)&&ea.emitValidationErrors(this,t.call(ea.validateStyle,ea.extend({value:e,style:{glyphs:!0,sprite:!0},styleSpec:ea.styleSpec})))},e}(ea.Evented),w=function(a,t){this.width=a,this.height=t,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};w.prototype.getDash=function(a,t){var e=a.join(",")+(t+"");return this.dashEntry[e]||(this.dashEntry[e]=this.addDash(a,t)),this.dashEntry[e]},w.prototype.getDashRanges=function(d,t,e){var i=[],o=1==d.length%2?-d[d.length-1]*e:0,p=d[0]*e,u=!0;i.push({left:o,right:p,isDash:u,zeroLength:0===d[0]});for(var g=d[0],m=1,h;m<d.length;m++)h=d[m],i.push({left:o=g*e,right:p=(g+=h)*e,isDash:u=!u,zeroLength:0===h});return i},w.prototype.addRoundDash=function(g,t,e){for(var i=t/2,o=-e;o<=e;o++)for(var m=this.width*(this.nextRow+e+o),a=0,y=g[a],f=0;f<this.width;f++){1<f/y.right&&(y=g[++a]);var x=ma(f-y.left),c=ma(f-y.right),u=Rt(x,c),h=void 0,b=o/e*(i+1);if(y.isDash){var d=i-ma(b);h=We(u*u+d*d)}else h=i-We(u*u+b*b);this.data[m+f]=ha(0,Rt(255,h+128))}},w.prototype.addRegularDash=function(d){for(var t=d.length-1;0<=t;--t){var g=d[t],i=d[t+1];g.zeroLength?d.splice(t,1):i&&i.isDash===g.isDash&&(i.left=g.left,d.splice(t,1))}var o=d[0],r=d[d.length-1];o.isDash===r.isDash&&(o.left=r.left-this.width,r.right=o.right+this.width);for(var a=this.width*this.nextRow,n=0,m=d[n],y=0;y<this.width;y++){1<y/m.right&&(m=d[++n]);var f=ma(y-m.left),u=ma(y-m.right),h=Rt(f,u);this.data[a+y]=ha(0,Rt(255,(m.isDash?h:-h)+128))}},w.prototype.addDash=function(t,e){var i=e?7:0,o=2*i+1;if(this.nextRow+o>this.height)return ea.warnOnce("LineAtlas out of space"),null;for(var r=0,d=0;d<t.length;d++)r+=t[d];if(0!==r){var p=this.width/r,s=this.getDashRanges(t,this.width,p);e?this.addRoundDash(s,p,i):this.addRegularDash(s)}var l={y:(this.nextRow+i+.5)/this.height,height:2*i/this.height,width:r};return this.nextRow+=o,this.dirty=!0,l},w.prototype.bind=function(a){var t=a.gl;this.texture?(t.bindTexture(t.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,t.ALPHA,t.UNSIGNED_BYTE,this.data))):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.ALPHA,this.width,this.height,0,t.ALPHA,t.UNSIGNED_BYTE,this.data))};var Ha=function t(e,i){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=ea.uniqueId();for(var o=this.workerPool.acquire(this.id),r=0,l;r<o.length;r++)l=new t.Actor(o[r],i,this.id),l.name="Worker "+r,this.actors.push(l)};Ha.prototype.broadcast=function(a,e,t){ea.asyncAll(this.actors,function(r,t){r.send(a,e,t)},t=t||function(){})},Ha.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},Ha.prototype.remove=function(){this.actors.forEach(function(e){e.remove()}),this.actors=[],this.workerPool.release(this.id)},Ha.Actor=ea.Actor;var E=function(t,e,a){this.bounds=ea.LngLatBounds.convert(this.validateBounds(t)),this.minzoom=e||0,this.maxzoom=a||24};E.prototype.validateBounds=function(e){return Array.isArray(e)&&4===e.length?[ha(-180,e[0]),ha(-90,e[1]),Rt(180,e[2]),Rt(90,e[3])]:[-180,-90,180,90]},E.prototype.contains=function(t){var e=pa(2,t.z),i=ya(ea.mercatorXfromLng(this.bounds.getWest())*e),o=ya(ea.mercatorYfromLat(this.bounds.getNorth())*e),r=Ye(ea.mercatorXfromLng(this.bounds.getEast())*e),a=Ye(ea.mercatorYfromLat(this.bounds.getSouth())*e);return t.x>=i&&t.x<r&&t.y>=o&&t.y<a};var P=function(t){function e(e,i,o,r){if(t.call(this),this.id=e,this.dispatcher=o,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,ea.extend(this,ea.pick(i,["url","scheme","tileSize","promoteId"])),this._options=ea.extend({type:"vector"},i),this._collectResourceTiming=i.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(r)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.load=function(){var t=this;this._loaded=!1,this.fire(new ea.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=_(this._options,this.map._requestManager,function(e,a){t._tileJSONRequest=null,t._loaded=!0,e?t.fire(new ea.ErrorEvent(e)):a&&(ea.extend(t,a),a.bounds&&(t.tileBounds=new E(a.bounds,t.minzoom,t.maxzoom)),ea.postTurnstileEvent(a.tiles,t.map._requestManager._customAccessToken),ea.postMapLoadEvent(a.tiles,t.map._getMapId(),t.map._requestManager._skuToken,t.map._requestManager._customAccessToken),t.fire(new ea.Event("data",{dataType:"source",sourceDataType:"metadata"})),t.fire(new ea.Event("data",{dataType:"source",sourceDataType:"content"})))})},e.prototype.loaded=function(){return this._loaded},e.prototype.hasTile=function(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)},e.prototype.onAdd=function(e){this.map=e,this.load()},e.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},e.prototype.serialize=function(){return ea.extend({},this._options)},e.prototype.loadTile=function(t,e){function i(a,o){return delete t.request,t.aborted?e(null):a&&404!==a.status?e(a):(o&&o.resourceTiming&&(t.resourceTiming=o.resourceTiming),this.map._refreshExpiredTiles&&o&&t.setExpiryData(o),t.loadVectorData(o,this.map.painter),ea.cacheEntryPossiblyAdded(this.dispatcher),e(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}var a=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme)),o={request:this.map._requestManager.transformRequest(a,ea.ResourceType.Tile),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:ea.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};o.request.collectResourceTiming=this._collectResourceTiming,t.actor&&"expired"!==t.state?"loading"===t.state?t.reloadCallback=e:t.request=t.actor.send("reloadTile",o,i.bind(this)):(t.actor=this.dispatcher.getActor(),t.request=t.actor.send("loadTile",o,i.bind(this)))},e.prototype.abortTile=function(e){e.request&&(e.request.cancel(),delete e.request),e.actor&&e.actor.send("abortTile",{uid:e.uid,type:this.type,source:this.id},void 0)},e.prototype.unloadTile=function(e){e.unloadVectorData(),e.actor&&e.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id},void 0)},e.prototype.hasTransition=function(){return!1},e}(ea.Evented),S=function(t){function e(e,i,o,r){t.call(this),this.id=e,this.dispatcher=o,this.setEventedParent(r),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=ea.extend({type:"raster"},i),ea.extend(this,ea.pick(i,["url","scheme","tileSize"]))}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.load=function(){var t=this;this._loaded=!1,this.fire(new ea.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=_(this._options,this.map._requestManager,function(e,a){t._tileJSONRequest=null,t._loaded=!0,e?t.fire(new ea.ErrorEvent(e)):a&&(ea.extend(t,a),a.bounds&&(t.tileBounds=new E(a.bounds,t.minzoom,t.maxzoom)),ea.postTurnstileEvent(a.tiles),ea.postMapLoadEvent(a.tiles,t.map._getMapId(),t.map._requestManager._skuToken),t.fire(new ea.Event("data",{dataType:"source",sourceDataType:"metadata"})),t.fire(new ea.Event("data",{dataType:"source",sourceDataType:"content"})))})},e.prototype.loaded=function(){return this._loaded},e.prototype.onAdd=function(e){this.map=e,this.load()},e.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},e.prototype.serialize=function(){return ea.extend({},this._options)},e.prototype.hasTile=function(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)},e.prototype.loadTile=function(t,e){var i=this,a=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);t.request=ea.getImage(this.map._requestManager.transformRequest(a,ea.ResourceType.Tile),function(o,r){if(delete t.request,t.aborted)t.state="unloaded",e(null);else if(o)t.state="errored",e(o);else if(r){i.map._refreshExpiredTiles&&t.setExpiryData(r),delete r.cacheControl,delete r.expires;var a=i.map.painter.context,n=a.gl;t.texture=i.map.painter.getTileTexture(r.width),t.texture?t.texture.update(r,{useMipmap:!0}):(t.texture=new ea.Texture(a,r,n.RGBA,{useMipmap:!0}),t.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE,n.LINEAR_MIPMAP_NEAREST),a.extTextureFilterAnisotropic&&n.texParameterf(n.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax)),t.state="loaded",ea.cacheEntryPossiblyAdded(i.dispatcher),e(null)}})},e.prototype.abortTile=function(a,t){a.request&&(a.request.cancel(),delete a.request),t()},e.prototype.unloadTile=function(a,t){a.texture&&this.map.painter.saveTileTexture(a.texture),t()},e.prototype.hasTransition=function(){return!1},e}(ea.Evented),qa=function(t){function e(e,i,o,r){t.call(this,e,i,o,r),this.type="raster-dem",this.maxzoom=22,this._options=ea.extend({type:"raster-dem"},i),this.encoding=i.encoding||"mapbox"}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},e.prototype.loadTile=function(l,e){function t(a,t){a&&(l.state="errored",e(a)),t&&(l.dem=t,l.needsHillshadePrepare=!0,l.state="loaded",e(null))}var a=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);l.request=ea.getImage(this.map._requestManager.transformRequest(a,ea.ResourceType.Tile),function(r,o){if(delete l.request,l.aborted)l.state="unloaded",e(null);else if(r)l.state="errored",e(r);else if(o){this.map._refreshExpiredTiles&&l.setExpiryData(o),delete o.cacheControl,delete o.expires;var a=ea.window.ImageBitmap&&o instanceof ea.window.ImageBitmap&&ea.offscreenCanvasSupported()?o:ea.browser.getImageData(o,1),i={uid:l.uid,coord:l.tileID,source:this.id,rawImageData:a,encoding:this.encoding};l.actor&&"expired"!==l.state||(l.actor=this.dispatcher.getActor(),l.actor.send("loadDEMTile",i,t.bind(this)))}}.bind(this)),l.neighboringTiles=this._getNeighboringTiles(l.tileID)},e.prototype._getNeighboringTiles=function(t){var e=t.canonical,i=pa(2,e.z),o=(e.x-1+i)%i,r=0===e.x?t.wrap-1:t.wrap,a=(e.x+1+i)%i,n=e.x+1===i?t.wrap+1:t.wrap,s={};return s[new ea.OverscaledTileID(t.overscaledZ,r,e.z,o,e.y).key]={backfilled:!1},s[new ea.OverscaledTileID(t.overscaledZ,n,e.z,a,e.y).key]={backfilled:!1},0<e.y&&(s[new ea.OverscaledTileID(t.overscaledZ,r,e.z,o,e.y-1).key]={backfilled:!1},s[new ea.OverscaledTileID(t.overscaledZ,t.wrap,e.z,e.x,e.y-1).key]={backfilled:!1},s[new ea.OverscaledTileID(t.overscaledZ,n,e.z,a,e.y-1).key]={backfilled:!1}),e.y+1<i&&(s[new ea.OverscaledTileID(t.overscaledZ,r,e.z,o,e.y+1).key]={backfilled:!1},s[new ea.OverscaledTileID(t.overscaledZ,t.wrap,e.z,e.x,e.y+1).key]={backfilled:!1},s[new ea.OverscaledTileID(t.overscaledZ,n,e.z,a,e.y+1).key]={backfilled:!1}),s},e.prototype.unloadTile=function(e){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&e.actor.send("removeDEMTile",{uid:e.uid,source:this.id})},e}(S),z=function(t){function e(e,i,o,r){t.call(this),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=o.getActor(),this.setEventedParent(r),this._data=i.data,this._options=ea.extend({},i),this._collectResourceTiming=i.collectResourceTiming,this._resourceTiming=[],void 0!==i.maxzoom&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution),this.promoteId=i.promoteId;var a=ea.EXTENT/this.tileSize;this.workerOptions=ea.extend({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(void 0===i.buffer?128:i.buffer)*a,tolerance:(void 0===i.tolerance?.375:i.tolerance)*a,extent:ea.EXTENT,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:void 0===i.clusterMaxZoom?this.maxzoom-1:Rt(i.clusterMaxZoom,this.maxzoom-1),extent:ea.EXTENT,radius:(i.clusterRadius||50)*a,log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties},i.workerOptions)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.load=function(){var t=this;this.fire(new ea.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(e){if(e)t.fire(new ea.ErrorEvent(e));else{var a={dataType:"source",sourceDataType:"metadata"};t._collectResourceTiming&&t._resourceTiming&&0<t._resourceTiming.length&&(a.resourceTiming=t._resourceTiming,t._resourceTiming=[]),t.fire(new ea.Event("data",a))}})},e.prototype.onAdd=function(e){this.map=e,this.load()},e.prototype.setData=function(t){var a=this;return this._data=t,this.fire(new ea.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(t){if(t)a.fire(new ea.ErrorEvent(t));else{var e={dataType:"source",sourceDataType:"content"};a._collectResourceTiming&&a._resourceTiming&&0<a._resourceTiming.length&&(e.resourceTiming=a._resourceTiming,a._resourceTiming=[]),a.fire(new ea.Event("data",e))}}),this},e.prototype.getClusterExpansionZoom=function(a,t){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:a,source:this.id},t),this},e.prototype.getClusterChildren=function(a,t){return this.actor.send("geojson.getClusterChildren",{clusterId:a,source:this.id},t),this},e.prototype.getClusterLeaves=function(a,t,e,r){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:a,limit:t,offset:e},r),this},e.prototype._updateWorkerData=function(a){var e=this;this._loaded=!1;var i=ea.extend({},this.workerOptions),t=this._data;"string"==typeof t?(i.request=this.map._requestManager.transformRequest(ea.browser.resolveURL(t),ea.ResourceType.Source),i.request.collectResourceTiming=this._collectResourceTiming):i.data=JSON.stringify(t),this.actor.send(this.type+".loadData",i,function(o,t){e._removed||t&&t.abandoned||(e._loaded=!0,t&&t.resourceTiming&&t.resourceTiming[e.id]&&(e._resourceTiming=t.resourceTiming[e.id].slice(0)),e.actor.send(e.type+".coalesce",{source:i.source},null),a(o))})},e.prototype.loaded=function(){return this._loaded},e.prototype.loadTile=function(n,e){var i=this,o=n.actor?"reloadTile":"loadTile";n.actor=this.actor,n.request=this.actor.send(o,{type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:ea.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(r,t){return delete n.request,n.unloadVectorData(),n.aborted?e(null):r?e(r):(n.loadVectorData(t,i.map.painter,"reloadTile"===o),e(null))})},e.prototype.abortTile=function(e){e.request&&(e.request.cancel(),delete e.request),e.aborted=!0},e.prototype.unloadTile=function(e){e.unloadVectorData(),this.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id})},e.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},e.prototype.serialize=function(){return ea.extend({},this._options,{type:this.type,data:this._data})},e.prototype.hasTransition=function(){return!1},e}(ea.Evented),D=ea.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),M=function(a){function e(e,t,i,o){a.call(this),this.id=e,this.dispatcher=i,this.coordinates=t.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(o),this.options=t}return a&&(e.__proto__=a),(e.prototype=Object.create(a&&a.prototype)).constructor=e,e.prototype.load=function(t,e){var i=this;this._loaded=!1,this.fire(new ea.Event("dataloading",{dataType:"source"})),this.url=this.options.url,ea.getImage(this.map._requestManager.transformRequest(this.url,ea.ResourceType.Image),function(o,r){i._loaded=!0,o?i.fire(new ea.ErrorEvent(o)):r&&(i.image=r,t&&(i.coordinates=t),e&&e(),i._finishLoading())})},e.prototype.loaded=function(){return this._loaded},e.prototype.updateImage=function(a){var t=this;return this.image&&a.url?(this.options.url=a.url,this.load(a.coordinates,function(){t.texture=null}),this):this},e.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new ea.Event("data",{dataType:"source",sourceDataType:"metadata"})))},e.prototype.onAdd=function(e){this.map=e,this.load()},e.prototype.setCoordinates=function(t){var e=this;this.coordinates=t;var a=t.map(ea.MercatorCoordinate.fromLngLat);this.tileID=function(t){for(var e=1/0,d=1/0,p=-1/0,g=-1/0,m=0,y=t,s;m<y.length;m+=1)s=y[m],e=Rt(e,s.x),d=Rt(d,s.y),p=ha(p,s.x),g=ha(g,s.y);var f=ha(p-e,g-d),c=ha(0,ya(-C(f)/T)),u=pa(2,c);return new ea.CanonicalTileID(c,ya((e+p)/2*u),ya((d+g)/2*u))}(a),this.minzoom=this.maxzoom=this.tileID.z;var o=a.map(function(a){return e.tileID.getTilePoint(a)._round()});return this._boundsArray=new ea.StructArrayLayout4i8,this._boundsArray.emplaceBack(o[0].x,o[0].y,0,0),this._boundsArray.emplaceBack(o[1].x,o[1].y,ea.EXTENT,0),this._boundsArray.emplaceBack(o[3].x,o[3].y,0,ea.EXTENT),this._boundsArray.emplaceBack(o[2].x,o[2].y,ea.EXTENT,ea.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new ea.Event("data",{dataType:"source",sourceDataType:"content"})),this},e.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var t=this.map.painter.context,e=t.gl;for(var a in this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,D.members)),this.boundsSegments||(this.boundsSegments=ea.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new ea.Texture(t,this.image,e.RGBA),this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE)),this.tiles){var o=this.tiles[a];"loaded"!==o.state&&(o.state="loaded",o.texture=this.texture)}}},e.prototype.loadTile=function(a,t){this.tileID&&this.tileID.equals(a.tileID.canonical)?(this.tiles[a.tileID.wrap+""]=a,a.buckets={},t(null)):(a.state="errored",t(null))},e.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},e.prototype.hasTransition=function(){return!1},e}(ea.Evented),Ga=function(a){function e(e,t,i,o){a.call(this,e,t,i,o),this.roundZoom=!0,this.type="video",this.options=t}return a&&(e.__proto__=a),(e.prototype=Object.create(a&&a.prototype)).constructor=e,e.prototype.load=function(){var t=this;this._loaded=!1;var e=this.options;this.urls=[];for(var a=0,i=e.urls;a<i.length;a+=1)this.urls.push(this.map._requestManager.transformRequest(i[a],ea.ResourceType.Source).url);ea.getVideo(this.urls,function(e,a){t._loaded=!0,e?t.fire(new ea.ErrorEvent(e)):a&&(t.video=a,t.video.loop=!0,t.video.addEventListener("playing",function(){t.map.triggerRepaint()}),t.map&&t.video.play(),t._finishLoading())})},e.prototype.pause=function(){this.video&&this.video.pause()},e.prototype.play=function(){this.video&&this.video.play()},e.prototype.seek=function(t){if(this.video){var e=this.video.seekable;t<e.start(0)||t>e.end(0)?this.fire(new ea.ErrorEvent(new ea.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+e.start(0)+" and "+e.end(0)+"-second mark."))):this.video.currentTime=t}},e.prototype.getVideo=function(){return this.video},e.prototype.onAdd=function(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},e.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||2>this.video.readyState)){var t=this.map.painter.context,e=t.gl;for(var a in this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,D.members)),this.boundsSegments||(this.boundsSegments=ea.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE),e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,this.video)):(this.texture=new ea.Texture(t,this.video,e.RGBA),this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE)),this.tiles){var o=this.tiles[a];"loaded"!==o.state&&(o.state="loaded",o.texture=this.texture)}}},e.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},e.prototype.hasTransition=function(){return this.video&&!this.video.paused},e}(M),L=function(t){function e(e,i,o,r){t.call(this,e,i,o,r),i.coordinates?Array.isArray(i.coordinates)&&4===i.coordinates.length&&!i.coordinates.some(function(e){return!Array.isArray(e)||2!==e.length||e.some(function(e){return"number"!=typeof e})})||this.fire(new ea.ErrorEvent(new ea.ValidationError("sources."+e,null,"\"coordinates\" property must be an array of 4 longitude/latitude array pairs"))):this.fire(new ea.ErrorEvent(new ea.ValidationError("sources."+e,null,"missing required property \"coordinates\""))),i.animate&&"boolean"!=typeof i.animate&&this.fire(new ea.ErrorEvent(new ea.ValidationError("sources."+e,null,"optional \"animate\" property must be a boolean value"))),i.canvas?"string"==typeof i.canvas||i.canvas instanceof ea.window.HTMLCanvasElement||this.fire(new ea.ErrorEvent(new ea.ValidationError("sources."+e,null,"\"canvas\" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance"))):this.fire(new ea.ErrorEvent(new ea.ValidationError("sources."+e,null,"missing required property \"canvas\""))),this.options=i,this.animate=void 0===i.animate||i.animate}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof ea.window.HTMLCanvasElement?this.options.canvas:ea.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new ea.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},e.prototype.getCanvas=function(){return this.canvas},e.prototype.onAdd=function(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()},e.prototype.onRemove=function(){this.pause()},e.prototype.prepare=function(){var t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var n=this.map.painter.context,i=n.gl;for(var o in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,D.members)),this.boundsSegments||(this.boundsSegments=ea.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new ea.Texture(n,this.canvas,i.RGBA,{premultiply:!0}),this.tiles){var r=this.tiles[o];"loaded"!==r.state&&(r.state="loaded",r.texture=this.texture)}}},e.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},e.prototype.hasTransition=function(){return this._playing},e.prototype._hasInvalidDimensions=function(){for(var a=0,o=[this.canvas.width,this.canvas.height],e;a<o.length;a+=1)if(e=o[a],isNaN(e)||0>=e)return!0;return!1},e}(M),R={vector:P,raster:S,"raster-dem":qa,geojson:z,video:Ga,image:M,canvas:L},Ya=function(a,t){this.max=a,this.onRemove=t,this.reset()};Ya.prototype.reset=function(){for(var a in this.data)for(var t=0,r=this.data[a],i;t<r.length;t+=1)i=r[t],i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value);return this.data={},this.order=[],this},Ya.prototype.add=function(l,t,e){var i=this,o=l.wrapped().key;void 0===this.data[o]&&(this.data[o]=[]);var r={value:t,timeout:void 0};if(void 0!==e&&(r.timeout=setTimeout(function(){i.remove(l,r)},e)),this.data[o].push(r),this.order.push(o),this.order.length>this.max){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},Ya.prototype.has=function(e){return e.wrapped().key in this.data},Ya.prototype.getAndRemove=function(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null},Ya.prototype._getAndRemoveByKey=function(a){var t=this.data[a].shift();return t.timeout&&clearTimeout(t.timeout),0===this.data[a].length&&delete this.data[a],this.order.splice(this.order.indexOf(a),1),t.value},Ya.prototype.getByKey=function(a){var t=this.data[a];return t?t[0].value:null},Ya.prototype.get=function(e){return this.has(e)?this.data[e.wrapped().key][0].value:null},Ya.prototype.remove=function(a,t){if(!this.has(a))return this;var e=a.wrapped().key,i=void 0===t?0:this.data[e].indexOf(t),o=this.data[e][i];return this.data[e].splice(i,1),o.timeout&&clearTimeout(o.timeout),0===this.data[e].length&&delete this.data[e],this.onRemove(o.value),this.order.splice(this.order.indexOf(e),1),this},Ya.prototype.setMaxSize=function(a){for(this.max=a;this.order.length>this.max;){var t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this},Ya.prototype.filter=function(d){var t=[];for(var e in this.data)for(var i=0,c=this.data[e],r;i<c.length;i+=1)r=c[i],d(r.value)||t.push(r);for(var p=0,u=t,s;p<u.length;p+=1)s=u[p],this.remove(s.value.tileID,s)};var U=function(a,t,e){this.context=a;var r=a.gl;this.buffer=r.createBuffer(),this.dynamicDraw=!!e,this.context.unbindVAO(),a.bindElementBuffer.set(this.buffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer};U.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},U.prototype.updateData=function(a){var t=this.context.gl;this.context.unbindVAO(),this.bind(),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,a.arrayBuffer)},U.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var N={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Z=function(a,t,e,i){this.length=t.length,this.attributes=e,this.itemSize=t.bytesPerElement,this.dynamicDraw=i,this.context=a;var o=a.gl;this.buffer=o.createBuffer(),a.bindVertexBuffer.set(this.buffer),o.bufferData(o.ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?o.DYNAMIC_DRAW:o.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer};Z.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Z.prototype.updateData=function(a){var t=this.context.gl;this.bind(),t.bufferSubData(t.ARRAY_BUFFER,0,a.arrayBuffer)},Z.prototype.enableAttributes=function(a,t){for(var e=0,r;e<this.attributes.length;e++)r=t.attributes[this.attributes[e].name],void 0!==r&&a.enableVertexAttribArray(r)},Z.prototype.setVertexAttribPointers=function(n,t,e){for(var i=0;i<this.attributes.length;i++){var l=this.attributes[i],r=t.attributes[l.name];void 0!==r&&n.vertexAttribPointer(r,l.components,n[N[l.type]],!1,this.itemSize,l.offset+this.itemSize*(e||0))}},Z.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var j=function(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};j.prototype.get=function(){return this.current},j.prototype.set=function(){},j.prototype.getDefault=function(){return this.default},j.prototype.setDefault=function(){this.set(this.default)};var q=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return ea.Color.transparent},e.prototype.set=function(a){var t=this.current;(a.r!==t.r||a.g!==t.g||a.b!==t.b||a.a!==t.a||this.dirty)&&(this.gl.clearColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)},e}(j),V=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getDefault=function(){return 1},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)},t}(j),G=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getDefault=function(){return 0},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)},t}(j),W=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getDefault=function(){return[!0,!0,!0,!0]},t.prototype.set=function(a){var t=this.current;(a[0]!==t[0]||a[1]!==t[1]||a[2]!==t[2]||a[3]!==t[3]||this.dirty)&&(this.gl.colorMask(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)},t}(j),X=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getDefault=function(){return!0},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)},t}(j),H=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getDefault=function(){return 255},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)},t}(j),K=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},t.prototype.set=function(a){var t=this.current;(a.func!==t.func||a.ref!==t.ref||a.mask!==t.mask||this.dirty)&&(this.gl.stencilFunc(a.func,a.ref,a.mask),this.current=a,this.dirty=!1)},t}(j),Y=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getDefault=function(){var e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]},t.prototype.set=function(a){var t=this.current;(a[0]!==t[0]||a[1]!==t[1]||a[2]!==t[2]||this.dirty)&&(this.gl.stencilOp(a[0],a[1],a[2]),this.current=a,this.dirty=!1)},t}(j),J=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getDefault=function(){return!1},t.prototype.set=function(a){if(a!==this.current||this.dirty){var t=this.gl;a?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this.current=a,this.dirty=!1}},t}(j),Q=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getDefault=function(){return[0,1]},t.prototype.set=function(a){var t=this.current;(a[0]!==t[0]||a[1]!==t[1]||this.dirty)&&(this.gl.depthRange(a[0],a[1]),this.current=a,this.dirty=!1)},t}(j),$=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getDefault=function(){return!1},t.prototype.set=function(a){if(a!==this.current||this.dirty){var t=this.gl;a?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),this.current=a,this.dirty=!1}},t}(j),tt=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getDefault=function(){return this.gl.LESS},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)},t}(j),et=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getDefault=function(){return!1},t.prototype.set=function(a){if(a!==this.current||this.dirty){var t=this.gl;a?t.enable(t.BLEND):t.disable(t.BLEND),this.current=a,this.dirty=!1}},t}(j),it=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getDefault=function(){var e=this.gl;return[e.ONE,e.ZERO]},t.prototype.set=function(a){var t=this.current;(a[0]!==t[0]||a[1]!==t[1]||this.dirty)&&(this.gl.blendFunc(a[0],a[1]),this.current=a,this.dirty=!1)},t}(j),ot=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return ea.Color.transparent},e.prototype.set=function(a){var t=this.current;(a.r!==t.r||a.g!==t.g||a.b!==t.b||a.a!==t.a||this.dirty)&&(this.gl.blendColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)},e}(j),rt=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getDefault=function(){return this.gl.FUNC_ADD},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)},t}(j),at=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getDefault=function(){return!1},t.prototype.set=function(a){if(a!==this.current||this.dirty){var t=this.gl;a?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),this.current=a,this.dirty=!1}},t}(j),nt=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getDefault=function(){return this.gl.BACK},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)},t}(j),st=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getDefault=function(){return this.gl.CCW},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)},t}(j),lt=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)},t}(j),ct=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getDefault=function(){return this.gl.TEXTURE0},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)},t}(j),ut=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getDefault=function(){var e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]},t.prototype.set=function(a){var t=this.current;(a[0]!==t[0]||a[1]!==t[1]||a[2]!==t[2]||a[3]!==t[3]||this.dirty)&&(this.gl.viewport(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)},t}(j),ht=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(a){if(a!==this.current||this.dirty){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,a),this.current=a,this.dirty=!1}},t}(j),pt=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(a){if(a!==this.current||this.dirty){var t=this.gl;t.bindRenderbuffer(t.RENDERBUFFER,a),this.current=a,this.dirty=!1}},t}(j),dt=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(a){if(a!==this.current||this.dirty){var t=this.gl;t.bindTexture(t.TEXTURE_2D,a),this.current=a,this.dirty=!1}},t}(j),_t=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(a){if(a!==this.current||this.dirty){var t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,a),this.current=a,this.dirty=!1}},t}(j),ft=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(a){var t=this.gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,a),this.current=a,this.dirty=!1},t}(j),mt=function(a){function t(t){a.call(this,t),this.vao=t.extVertexArrayObject}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(e){this.vao&&(e!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(e),this.current=e,this.dirty=!1)},t}(j),gt=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getDefault=function(){return 4},t.prototype.set=function(a){if(a!==this.current||this.dirty){var t=this.gl;t.pixelStorei(t.UNPACK_ALIGNMENT,a),this.current=a,this.dirty=!1}},t}(j),vt=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getDefault=function(){return!1},t.prototype.set=function(a){if(a!==this.current||this.dirty){var t=this.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a),this.current=a,this.dirty=!1}},t}(j),yt=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getDefault=function(){return!1},t.prototype.set=function(a){if(a!==this.current||this.dirty){var t=this.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,a),this.current=a,this.dirty=!1}},t}(j),xt=function(a){function t(t,e){a.call(this,t),this.context=t,this.parent=e}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.getDefault=function(){return null},t}(j),bt=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.setDirty=function(){this.dirty=!0},t.prototype.set=function(a){if(a!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var t=this.gl;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,a,0),this.current=a,this.dirty=!1}},t}(xt),wt=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.set=function(a){if(a!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,a),this.current=a,this.dirty=!1}},t}(xt),Tt=function(a,t,e,i){this.context=a,this.width=t,this.height=e;var o=this.framebuffer=a.gl.createFramebuffer();this.colorAttachment=new bt(a,o),i&&(this.depthAttachment=new wt(a,o))};Tt.prototype.destroy=function(){var a=this.context.gl,t=this.colorAttachment.get();if(t&&a.deleteTexture(t),this.depthAttachment){var e=this.depthAttachment.get();e&&a.deleteRenderbuffer(e)}a.deleteFramebuffer(this.framebuffer)};var Et=function(a,t,e){this.func=a,this.mask=t,this.range=e};Et.ReadOnly=!1,Et.ReadWrite=!0,Et.disabled=new Et(519,Et.ReadOnly,[0,1]);var It=function(n,t,e,i,o,r){this.test=n,this.ref=t,this.mask=e,this.fail=i,this.depthFail=o,this.pass=r};It.disabled=new It({func:519,mask:0},0,0,7680,7680,7680);var Pt=function(a,t,e){this.blendFunction=a,this.blendColor=t,this.mask=e};Pt.disabled=new Pt(Pt.Replace=[1,0],ea.Color.transparent,[!1,!1,!1,!1]),Pt.unblended=new Pt(Pt.Replace,ea.Color.transparent,[!0,!0,!0,!0]),Pt.alphaBlended=new Pt([1,771],ea.Color.transparent,[!0,!0,!0,!0]);var St=function(a,t,e){this.enable=a,this.mode=t,this.frontFace=e};St.disabled=new St(!1,1029,2305),St.backCCW=new St(!0,1029,2305);var Ct=function(e){this.gl=e,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new q(this),this.clearDepth=new V(this),this.clearStencil=new G(this),this.colorMask=new W(this),this.depthMask=new X(this),this.stencilMask=new H(this),this.stencilFunc=new K(this),this.stencilOp=new Y(this),this.stencilTest=new J(this),this.depthRange=new Q(this),this.depthTest=new $(this),this.depthFunc=new tt(this),this.blend=new et(this),this.blendFunc=new it(this),this.blendColor=new ot(this),this.blendEquation=new rt(this),this.cullFace=new at(this),this.cullFaceSide=new nt(this),this.frontFace=new st(this),this.program=new lt(this),this.activeTexture=new ct(this),this.viewport=new ut(this),this.bindFramebuffer=new ht(this),this.bindRenderbuffer=new pt(this),this.bindTexture=new dt(this),this.bindVertexBuffer=new _t(this),this.bindElementBuffer=new ft(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new mt(this),this.pixelStoreUnpack=new gt(this),this.pixelStoreUnpackPremultiplyAlpha=new vt(this),this.pixelStoreUnpackFlipY=new yt(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=e.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(e.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=e.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=e.getExtension("EXT_disjoint_timer_query")};Ct.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Ct.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Ct.prototype.createIndexBuffer=function(a,t){return new U(this,a,t)},Ct.prototype.createVertexBuffer=function(a,t,e){return new Z(this,a,t,e)},Ct.prototype.createRenderbuffer=function(a,t,e){var i=this.gl,o=i.createRenderbuffer();return this.bindRenderbuffer.set(o),i.renderbufferStorage(i.RENDERBUFFER,a,t,e),this.bindRenderbuffer.set(null),o},Ct.prototype.createFramebuffer=function(a,t,e){return new Tt(this,a,t,e)},Ct.prototype.clear=function(a){var t=a.color,e=a.depth,i=this.gl,o=0;t&&(o|=i.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),void 0!==e&&(o|=i.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(e),this.depthMask.set(!0)),i.clear(o)},Ct.prototype.setCullFace=function(e){!1===e.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))},Ct.prototype.setDepthMode=function(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)},Ct.prototype.setStencilMode=function(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)},Ct.prototype.setColorMode=function(t){ea.deepEqual(t.blendFunction,Pt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)},Ct.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var zt=function(t){function k(e,i,o){var r=this;t.call(this),this.id=e,this.dispatcher=o,this.on("data",function(e){"source"===e.dataType&&"metadata"===e.sourceDataType&&(r._sourceLoaded=!0),r._sourceLoaded&&!r._paused&&"source"===e.dataType&&"content"===e.sourceDataType&&(r.reload(),r.transform&&r.update(r.transform))}),this.on("error",function(){r._sourceErrored=!0}),this._source=function(t,e,i,o){var r=new R[e.type](t,e,i,o);if(r.id!==t)throw new Error("Expected Source id to be "+t+" instead of "+r.id);return ea.bindAll(["load","abort","unload","serialize","prepare"],r),r}(e,i,o,this),this._tiles={},this._cache=new Ya(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new ea.SourceFeatureState}return t&&(k.__proto__=t),(k.prototype=Object.create(t&&t.prototype)).constructor=k,k.prototype.onAdd=function(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(e)},k.prototype.onRemove=function(e){this._source&&this._source.onRemove&&this._source.onRemove(e)},k.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(var a in this._tiles){var t=this._tiles[a];if("loaded"!==t.state&&"errored"!==t.state)return!1}return!0},k.prototype.getSource=function(){return this._source},k.prototype.pause=function(){this._paused=!0},k.prototype.resume=function(){if(this._paused){var e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}},k.prototype._loadTile=function(a,t){return this._source.loadTile(a,t)},k.prototype._unloadTile=function(e){if(this._source.unloadTile)return this._source.unloadTile(e,function(){})},k.prototype._abortTile=function(e){if(this._source.abortTile)return this._source.abortTile(e,function(){})},k.prototype.serialize=function(){return this._source.serialize()},k.prototype.prepare=function(a){for(var t in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var e=this._tiles[t];e.upload(a),e.prepare(this.map.style.imageManager)}},k.prototype.getIds=function(){return ea.values(this._tiles).map(function(e){return e.tileID}).sort(B).map(function(e){return e.key})},k.prototype.getRenderableIds=function(t){var l=this,e=[];for(var a in this._tiles)this._isIdRenderable(a,t)&&e.push(this._tiles[a]);return t?e.sort(function(t,e){var o=t.tileID,r=e.tileID,a=new ea.Point(o.canonical.x,o.canonical.y)._rotate(l.transform.angle),i=new ea.Point(r.canonical.x,r.canonical.y)._rotate(l.transform.angle);return o.overscaledZ-r.overscaledZ||i.y-a.y||i.x-a.x}).map(function(e){return e.tileID.key}):e.map(function(e){return e.tileID}).sort(B).map(function(e){return e.key})},k.prototype.hasRenderableParent=function(a){var t=this.findLoadedParent(a,0);return!!t&&this._isIdRenderable(t.tileID.key)},k.prototype._isIdRenderable=function(a,t){return this._tiles[a]&&this._tiles[a].hasData()&&!this._coveredTiles[a]&&(t||!this._tiles[a].holdingForFade())},k.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var e in this._cache.reset(),this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(e,"reloading")},k.prototype._reloadTile=function(a,t){var e=this._tiles[a];e&&("loading"!==e.state&&(e.state=t),this._loadTile(e,this._tileLoaded.bind(this,e,a,t)))},k.prototype._tileLoaded=function(t,e,a,o){return o?(t.state="errored",void(404===o.status?this.update(this.transform):this._source.fire(new ea.ErrorEvent(o,{tile:t})))):void(t.timeAdded=ea.browser.now(),"expired"===a&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(e,t),"raster-dem"===this.getSource().type&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new ea.Event("data",{dataType:"source",tile:t,coord:t.tileID})))},k.prototype._backfillDEM=function(n){function t(n,t){n.needsHillshadePrepare=!0;var e=t.tileID.canonical.x-n.tileID.canonical.x,l=t.tileID.canonical.y-n.tileID.canonical.y,o=pa(2,n.tileID.canonical.z),r=t.tileID.key;0===e&&0===l||1<ma(l)||(1<ma(e)&&(1===ma(e+o)?e+=o:1===ma(e-o)&&(e-=o)),t.dem&&n.dem&&(n.dem.backfillBorder(t.dem,e,l),n.neighboringTiles&&n.neighboringTiles[r]&&(n.neighboringTiles[r].backfilled=!0)))}for(var a=this.getRenderableIds(),e=0,l;e<a.length;e++)if(l=a[e],n.neighboringTiles&&n.neighboringTiles[l]){var s=this.getTileByID(l);t(n,s),t(s,n)}},k.prototype.getTile=function(e){return this.getTileByID(e.key)},k.prototype.getTileByID=function(e){return this._tiles[e]},k.prototype._retainLoadedChildren=function(d,t,e,i){for(var o in this._tiles){var r=this._tiles[o];if(!(i[o]||!r.hasData()||r.tileID.overscaledZ<=t||r.tileID.overscaledZ>e)){for(var c=r.tileID,p;r&&r.tileID.overscaledZ>t+1;)p=r.tileID.scaledTo(r.tileID.overscaledZ-1),(r=this._tiles[p.key])&&r.hasData()&&(c=p);for(var u=c;u.overscaledZ>t;)if(d[(u=u.scaledTo(u.overscaledZ-1)).key]){i[c.key]=c;break}}}},k.prototype.findLoadedParent=function(n,t){if(n.key in this._loadedParentTiles){var e=this._loadedParentTiles[n.key];return e&&e.tileID.overscaledZ>=t?e:null}for(var i=n.overscaledZ-1;i>=t;i--){var l=n.scaledTo(i),r=this._getLoadedTile(l);if(r)return r}},k.prototype._getLoadedTile=function(a){var t=this._tiles[a.key];return t&&t.hasData()?t:this._cache.getByKey(a.wrapped().key)},k.prototype.updateCacheSize=function(a){var t=Ye(a.width/this._source.tileSize)+1,e=Ye(a.height/this._source.tileSize)+1,i=ya(5*(t*e)),o="number"==typeof this._maxTileCacheSize?Rt(this._maxTileCacheSize,i):i;this._cache.setMaxSize(o)},k.prototype.handleWrapJump=function(l){var t=Xe((l-(void 0===this._prevLng?l:this._prevLng))/360);if(this._prevLng=l,t){var e={};for(var i in this._tiles){var o=this._tiles[i];o.tileID=o.tileID.unwrapTo(o.tileID.wrap+t),e[o.tileID.key]=o}for(var r in this._tiles=e,this._timers)clearTimeout(this._timers[r]),delete this._timers[r];for(var a in this._tiles)this._setTileReloadTimer(a,this._tiles[a])}},k.prototype.update=function(t){var e=this;if(this.transform=t,this._sourceLoaded&&!this._paused){var o;this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?o=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(t){return new ea.OverscaledTileID(t.canonical.z,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y)}):(o=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(o=o.filter(function(a){return e._source.hasTile(a)}))):o=[];var i=t.coveringZoomLevel(this._source),a=ha(i-k.maxOverzooming,this._source.minzoom),n=ha(i+k.maxUnderzooming,this._source.minzoom),s=this._updateRetainedTiles(o,i);if(F(this._source.type)){for(var l={},c={},u=0,T=Object.keys(s);u<T.length;u+=1){var p=T[u],d=s[p],_=this._tiles[p];if(_&&!(_.fadeEndTime&&_.fadeEndTime<=ea.browser.now())){var f=this.findLoadedParent(d,a);f&&(this._addTile(f.tileID),l[f.tileID.key]=f.tileID),c[p]=d}}for(var m in this._retainLoadedChildren(c,i,n,s),l)s[m]||(this._coveredTiles[m]=!0,s[m]=l[m])}for(var g in s)this._tiles[g].clearFadeHold();for(var v=0,A=ea.keysDifference(this._tiles,s);v<A.length;v+=1){var x=A[v],b=this._tiles[x];b.hasSymbolBuckets&&!b.holdingForFade()?b.setHoldDuration(this.map._fadeDuration):b.hasSymbolBuckets&&!b.symbolFadeFinished()||this._removeTile(x)}this._updateLoadedParentTileCache()}},k.prototype.releaseSymbolFadeTiles=function(){for(var e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)},k.prototype._updateRetainedTiles=function(i,t){for(var e={},o={},r=ha(t-k.maxOverzooming,this._source.minzoom),a=ha(t+k.maxUnderzooming,this._source.minzoom),n={},s=0,w=i;s<w.length;s+=1){var c=w[s],u=this._addTile(c);e[c.key]=c,u.hasData()||t<this._source.maxzoom&&(n[c.key]=c)}this._retainLoadedChildren(n,t,a,e);for(var h=0,T=i;h<T.length;h+=1){var d=T[h],_=this._tiles[d.key];if(!_.hasData()){if(t+1>this._source.maxzoom){var A=d.children(this._source.maxzoom)[0],m=this.getTile(A);if(m&&m.hasData()){e[A.key]=A;continue}}else{var g=d.children(this._source.maxzoom);if(e[g[0].key]&&e[g[1].key]&&e[g[2].key]&&e[g[3].key])continue}for(var v=_.wasRequested(),S=d.overscaledZ-1,C;S>=r&&(C=d.scaledTo(S),!o[C.key])&&(o[C.key]=!0,!(_=this.getTile(C))&&v&&(_=this._addTile(C)),!(_&&(e[C.key]=C,v=_.wasRequested(),_.hasData())));--S);}}return e},k.prototype._updateLoadedParentTileCache=function(){for(var l in this._loadedParentTiles={},this._tiles){for(var t=[],e=void 0,s=this._tiles[l].tileID;0<s.overscaledZ;){if(s.key in this._loadedParentTiles){e=this._loadedParentTiles[s.key];break}t.push(s.key);var d=s.scaledTo(s.overscaledZ-1);if(e=this._getLoadedTile(d))break;s=d}for(var r=0,c=t;r<c.length;r+=1)this._loadedParentTiles[c[r]]=e}},k.prototype._addTile=function(t){var e=this._tiles[t.key];if(e)return e;(e=this._cache.getAndRemove(t))&&(this._setTileReloadTimer(t.key,e),e.tileID=t,this._state.initializeTileState(e,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,e)));var a=!!e;return a||(e=new ea.Tile(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(e,this._tileLoaded.bind(this,e,t.key,e.state))),e?(e.uses++,this._tiles[t.key]=e,a||this._source.fire(new ea.Event("dataloading",{tile:e,coord:e.tileID,dataType:"source"})),e):null},k.prototype._setTileReloadTimer=function(a,t){var e=this;a in this._timers&&(clearTimeout(this._timers[a]),delete this._timers[a]);var r=t.getExpiryTimeout();r&&(this._timers[a]=setTimeout(function(){e._reloadTile(a,"expired"),delete e._timers[a]},r))},k.prototype._removeTile=function(a){var t=this._tiles[a];t&&(t.uses--,delete this._tiles[a],this._timers[a]&&(clearTimeout(this._timers[a]),delete this._timers[a]),0<t.uses||(t.hasData()&&"reloading"!==t.state?this._cache.add(t.tileID,t,t.getExpiryTimeout()):(t.aborted=!0,this._abortTile(t),this._unloadTile(t))))},k.prototype.clearTiles=function(){for(var e in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(e);this._cache.reset()},k.prototype.tilesIn=function(t,e,i){var x=this,r=[],a=this.transform;if(!a)return r;for(var o=i?a.getCameraQueryGeometry(t):t,n=t.map(function(e){return a.pointCoordinate(e)}),l=o.map(function(e){return a.pointCoordinate(e)}),c=this.getIds(),u=1/0,b=1/0,w=-1/0,k=-1/0,s=0,T=l,m;s<T.length;s+=1)m=T[s],u=Rt(u,m.x),b=Rt(b,m.y),w=ha(w,m.x),k=ha(k,m.y);for(var A=function(t){var i=x._tiles[c[t]];if(!i.holdingForFade()){var o=i.tileID,s=pa(2,a.zoom-i.tileID.overscaledZ),d=e*i.queryPadding*ea.EXTENT/i.tileSize/s,p=[o.getTilePoint(new ea.MercatorCoordinate(u,b)),o.getTilePoint(new ea.MercatorCoordinate(w,k))];if(p[0].x-d<ea.EXTENT&&p[0].y-d<ea.EXTENT&&0<=p[1].x+d&&0<=p[1].y+d){var g=n.map(function(e){return o.getTilePoint(e)}),m=l.map(function(e){return o.getTilePoint(e)});r.push({tile:i,tileID:o,queryGeometry:g,cameraQueryGeometry:m,scale:s})}}},v=0;v<c.length;v++)A(v);return r},k.prototype.getVisibleCoordinates=function(n){for(var l=this,e=this.getRenderableIds(n).map(function(e){return l._tiles[e].tileID}),t=0,i=e,r;t<i.length;t+=1)r=i[t],r.posMatrix=this.transform.calculatePosMatrix(r.toUnwrapped());return e},k.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(F(this._source.type))for(var t in this._tiles){var e=this._tiles[t];if(void 0!==e.fadeEndTime&&e.fadeEndTime>=ea.browser.now())return!0}return!1},k.prototype.setFeatureState=function(a,o,e){this._state.updateState(a=a||"_geojsonTileLayer",o,e)},k.prototype.removeFeatureState=function(a,o,e){this._state.removeFeatureState(a=a||"_geojsonTileLayer",o,e)},k.prototype.getFeatureState=function(a,o){return this._state.getState(a=a||"_geojsonTileLayer",o)},k.prototype.setDependencies=function(a,t,e){var r=this._tiles[a];r&&r.setDependencies(t,e)},k.prototype.reloadTilesForDependencies=function(a,t){for(var e in this._tiles)this._tiles[e].hasDependency(a,t)&&this._reloadTile(e,"reloading");this._cache.filter(function(e){return!e.hasDependency(a,t)})},k}(ea.Evented);zt.maxOverzooming=10,zt.maxUnderzooming=3;var Dt=function(){this.active={}};Dt.prototype.acquire=function(e){if(!this.workers)for(this.workers=[];this.workers.length<Dt.workerCount;)this.workers.push(new At);return this.active[e]=!0,this.workers.slice()},Dt.prototype.release=function(e){delete this.active[e],0===this.numActive()&&(this.workers.forEach(function(e){e.terminate()}),this.workers=null)},Dt.prototype.isPreloaded=function(){return!!this.active.mapboxgl_preloaded_worker_pool},Dt.prototype.numActive=function(){return Object.keys(this.active).length};var kt=ya(ea.browser.hardwareConcurrency/2),Ot;Dt.workerCount=ha(Rt(kt,6),1);var Wa={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"},Zt=function(a,t){this.reset(a,t)};Zt.prototype.reset=function(a,t){this.points=a||[],this._distances=[0];for(var e=1;e<this.points.length;e++)this._distances[e]=this._distances[e-1]+this.points[e].dist(this.points[e-1]);this.length=this._distances[this._distances.length-1],this.padding=Rt(t||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Zt.prototype.lerp=function(t){if(1===this.points.length)return this.points[0];t=ea.clamp(t,0,1);for(var d=1,c=this._distances[d],p=t*this.paddedLength+this.padding;c<p&&d<this._distances.length;)c=this._distances[++d];var r=d-1,a=this._distances[r],n=c-a,s=0<n?(p-a)/n:0;return this.points[r].mult(1-s).add(this.points[d].mult(s))};var Kt=function(n,t,e){var i=this.boxCells=[],o=this.circleCells=[];this.xCellCount=Ye(n/e),this.yCellCount=Ye(t/e);for(var r=0;r<this.xCellCount*this.yCellCount;r++)i.push([]),o.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=t,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/t,this.boxUid=0,this.circleUid=0};Kt.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Kt.prototype.insert=function(a,t,e,i,o){this._forEachCell(t,e,i,o,this._insertBoxCell,this.boxUid++),this.boxKeys.push(a),this.bboxes.push(t),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(o)},Kt.prototype.insertCircle=function(a,t,e,r){this._forEachCell(t-r,e-r,t+r,e+r,this._insertCircleCell,this.circleUid++),this.circleKeys.push(a),this.circles.push(t),this.circles.push(e),this.circles.push(r)},Kt.prototype._insertBoxCell=function(n,t,e,i,o,r){this.boxCells[o].push(r)},Kt.prototype._insertCircleCell=function(n,t,e,i,o,r){this.circleCells[o].push(r)},Kt.prototype._query=function(d,t,e,i,o,r){if(0>e||d>this.width||0>i||t>this.height)return!o&&[];var a=[];if(0>=d&&0>=t&&this.width<=e&&this.height<=i){if(o)return!0;for(var n=0;n<this.boxKeys.length;n++)a.push({key:this.boxKeys[n],x1:this.bboxes[4*n],y1:this.bboxes[4*n+1],x2:this.bboxes[4*n+2],y2:this.bboxes[4*n+3]});for(var p=0;p<this.circleKeys.length;p++){var g=this.circles[3*p],c=this.circles[3*p+1],u=this.circles[3*p+2];a.push({key:this.circleKeys[p],x1:g-u,y1:c-u,x2:g+u,y2:c+u})}return r?a.filter(r):a}return this._forEachCell(d,t,e,i,this._queryCell,a,{hitTest:o,seenUids:{box:{},circle:{}}},r),o?0<a.length:a},Kt.prototype._queryCircle=function(d,t,e,i,o){var r=d-e,a=d+e,n=t-e,s=t+e;if(0>a||r>this.width||0>s||n>this.height)return!i&&[];var l=[];return this._forEachCell(r,n,a,s,this._queryCellCircle,l,{hitTest:i,circle:{x:d,y:t,radius:e},seenUids:{box:{},circle:{}}},o),i?0<l.length:l},Kt.prototype.query=function(a,t,e,i,o){return this._query(a,t,e,i,!1,o)},Kt.prototype.hitTest=function(a,t,e,i,o){return this._query(a,t,e,i,!0,o)},Kt.prototype.hitTestCircle=function(a,t,e,r){return this._queryCircle(a,t,e,!0,r)},Kt.prototype._queryCell=function(k,t,e,i,o,r,a,n){var s=a.seenUids,l=this.boxCells[o];if(null!==l)for(var c=this.bboxes,u=0,A=l,p;u<A.length;u+=1)if(p=A[u],!s.box[p]){s.box[p]=!0;var S=4*p;if(k<=c[S+2]&&t<=c[S+3]&&e>=c[S+0]&&i>=c[S+1]&&(!n||n(this.boxKeys[p]))){if(a.hitTest)return r.push(!0),!0;r.push({key:this.boxKeys[p],x1:c[S],y1:c[S+1],x2:c[S+2],y2:c[S+3]})}}var _=this.circleCells[o];if(null!==_)for(var f=this.circles,m=0,C=_,v;m<C.length;m+=1)if(v=C[m],!s.circle[v]){s.circle[v]=!0;var L=3*v;if(this._circleAndRectCollide(f[L],f[L+1],f[L+2],k,t,e,i)&&(!n||n(this.circleKeys[v]))){if(a.hitTest)return r.push(!0),!0;var x=f[L],b=f[L+1],w=f[L+2];r.push({key:this.circleKeys[v],x1:x-w,y1:b-w,x2:x+w,y2:b+w})}}},Kt.prototype._queryCellCircle=function(w,t,e,i,o,r,a,n){var s=a.circle,l=a.seenUids,c=this.boxCells[o];if(null!==c)for(var u=this.bboxes,h=0,k=c,d;h<k.length;h+=1)if(d=k[h],!l.box[d]){l.box[d]=!0;var T=4*d;if(this._circleAndRectCollide(s.x,s.y,s.radius,u[T+0],u[T+1],u[T+2],u[T+3])&&(!n||n(this.boxKeys[d])))return r.push(!0),!0}var f=this.circleCells[o];if(null!==f)for(var m=this.circles,g=0,A=f,y;g<A.length;g+=1)if(y=A[g],!l.circle[y]){l.circle[y]=!0;var S=3*y;if(this._circlesCollide(m[S],m[S+1],m[S+2],s.x,s.y,s.radius)&&(!n||n(this.circleKeys[y])))return r.push(!0),!0}},Kt.prototype._forEachCell=function(g,t,e,i,o,r,a,n){for(var s=this._convertToXCellCoord(g),l=this._convertToYCellCoord(t),c=this._convertToXCellCoord(e),u=this._convertToYCellCoord(i),m=s;m<=c;m++)for(var h=l;h<=u;h++)if(o.call(this,g,t,e,i,this.xCellCount*h+m,r,a,n))return},Kt.prototype._convertToXCellCoord=function(e){return ha(0,Rt(this.xCellCount-1,ya(e*this.xScale)))},Kt.prototype._convertToYCellCoord=function(e){return ha(0,Rt(this.yCellCount-1,ya(e*this.yScale)))},Kt.prototype._circlesCollide=function(d,t,e,i,o,r){var a=i-d,n=o-t,s=e+r;return s*s>a*a+n*n},Kt.prototype._circleAndRectCollide=function(d,t,e,i,o,r,a){var n=(r-i)/2,s=ma(d-(i+n));if(s>n+e)return!1;var l=(a-o)/2,c=ma(t-(o+l));if(c>l+e)return!1;if(s<=n||c<=l)return!0;var u=s-n,g=c-l;return u*u+g*g<=e*e};var Yt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]),le=function(a,t,o){void 0===t&&(t=new Kt(a.width+200,a.height+200,25)),void 0===o&&(o=new Kt(a.width+200,a.height+200,25)),this.transform=a,this.grid=t,this.ignoredGrid=o,this.pitchfactor=Ge(a._pitch)*a.cameraToCenterDistance,this.screenRightBoundary=a.width+100,this.screenBottomBoundary=a.height+100,this.gridRightBoundary=a.width+200,this.gridBottomBoundary=a.height+200};le.prototype.placeCollisionBox=function(d,t,e,i,o){var r=this.projectAndGetPerspectiveRatio(i,d.anchorPointX,d.anchorPointY),a=e*r.perspectiveRatio,n=d.x1*a+r.point.x,s=d.y1*a+r.point.y,l=d.x2*a+r.point.x,c=d.y2*a+r.point.y;return this.isInsideGrid(n,s,l,c)&&(t||!this.grid.hitTest(n,s,l,c,o))?{box:[n,s,l,c],offscreen:this.isOffscreen(n,s,l,c)}:{box:[],offscreen:!1}},le.prototype.placeCollisionCircles=function(t,e,i,o,r,a,n,s,l,c,u,h,p){var d=[],_=new ea.Point(e.anchorX,e.anchorY),f=Jt(_,a),m=$t(this.transform.cameraToCenterDistance,f.signedDistanceFromCamera),g=(c?r/m:r*m)/ea.ONE_EM,v=Jt(_,n).point,y=ie(g,o,e.lineOffsetX*g,e.lineOffsetY*g,!1,v,_,e,i,n,{}),x=!1,L=!1,$=!0;if(y){for(var J=.5*h*m+p,E=new ea.Point(-100,-100),I=new ea.Point(this.screenRightBoundary,this.screenBottomBoundary),P=new Zt,S=y.first,C=y.last,z=[],Q=S.path.length-1;1<=Q;Q--)z.push(S.path[Q]);for(var ee=1;ee<C.path.length;ee++)z.push(C.path[ee]);if(s){var te=z.map(function(e){return Jt(e,s)});z=te.some(function(e){return 0>=e.signedDistanceFromCamera})?[]:te.map(function(e){return e.point})}var R=[];if(0<z.length){for(var ae=z[0].clone(),B=z[0].clone(),O=1;O<z.length;O++)ae.x=Rt(ae.x,z[O].x),ae.y=Rt(ae.y,z[O].y),B.x=ha(B.x,z[O].x),B.y=ha(B.y,z[O].y);R=ae.x>=E.x&&B.x<=I.x&&ae.y>=E.y&&B.y<=I.y?[z]:B.x<E.x||ae.x>I.x||B.y<E.y||ae.y>I.y?[]:ea.clipLine([z],E.x,E.y,I.x,I.y)}for(var oe=0,re=R;oe<re.length;oe+=1){var N;P.reset(re[oe],.25*J),N=P.length<=.5*J?1:Ye(P.paddedLength/(2.5*J))+1;for(var ne=0;ne<N;ne++){var le=ne/ha(N-1,1),q=P.lerp(le),V=q.x+100,G=q.y+100;d.push(V,G,J,0);var W=V-J,X=G-J,H=V+J,K=G+J;if($=$&&this.isOffscreen(W,X,H,K),L=L||this.isInsideGrid(W,X,H,K),!t&&this.grid.hitTestCircle(V,G,J,u)&&(x=!0,!l))return{circles:[],offscreen:!1,collisionDetected:x}}}}return{circles:(l||!x)&&L?d:[],offscreen:$,collisionDetected:x}},le.prototype.queryRenderedSymbols=function(t){if(0===t.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var e=[],i=1/0,y=1/0,x=-1/0,b=-1/0,v=0,w=t;v<w.length;v+=1){var l=w[v],c=new ea.Point(l.x+100,l.y+100);i=Rt(i,c.x),y=Rt(y,c.y),x=ha(x,c.x),b=ha(b,c.y),e.push(c)}for(var u={},h={},p=0,k=this.grid.query(i,y,x,b).concat(this.ignoredGrid.query(i,y,x,b));p<k.length;p+=1){var _=k[p],f=_.key;if(void 0===u[f.bucketInstanceId]&&(u[f.bucketInstanceId]={}),!u[f.bucketInstanceId][f.featureIndex]){var m=[new ea.Point(_.x1,_.y1),new ea.Point(_.x2,_.y1),new ea.Point(_.x2,_.y2),new ea.Point(_.x1,_.y2)];ea.polygonIntersectsPolygon(e,m)&&(u[f.bucketInstanceId][f.featureIndex]=!0,void 0===h[f.bucketInstanceId]&&(h[f.bucketInstanceId]=[]),h[f.bucketInstanceId].push(f.featureIndex))}}return h},le.prototype.insertCollisionBox=function(a,t,e,i,o){(t?this.ignoredGrid:this.grid).insert({bucketInstanceId:e,featureIndex:i,collisionGroupID:o},a[0],a[1],a[2],a[3])},le.prototype.insertCollisionCircles=function(l,t,e,i,o){for(var r=t?this.ignoredGrid:this.grid,a={bucketInstanceId:e,featureIndex:i,collisionGroupID:o},n=0;n<l.length;n+=4)r.insertCircle(a,l[n],l[n+1],l[n+2])},le.prototype.projectAndGetPerspectiveRatio=function(t,e,a){var o=[e,a,0,1];return ce(o,o,t),{point:new ea.Point((o[0]/o[3]+1)/2*this.transform.width+100,(-o[1]/o[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+.5*(this.transform.cameraToCenterDistance/o[3])}},le.prototype.isOffscreen=function(a,t,e,r){return 100>e||a>=this.screenRightBoundary||100>r||t>this.screenBottomBoundary},le.prototype.isInsideGrid=function(a,t,e,r){return 0<=e&&a<this.gridRightBoundary&&0<=r&&t<this.gridBottomBoundary},le.prototype.getViewportMatrix=function(){var t=ea.identity([]);return ea.translate(t,t,[-100,-100,0]),t};var he=function(a,t,e,r){this.opacity=a?ha(0,Rt(1,a.opacity+(a.placed?t:-t))):r&&e?1:0,this.placed=e};he.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var de=function(a,t,e,i,o){this.text=new he(a?a.text:null,t,e,o),this.icon=new he(a?a.icon:null,t,i,o)};de.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var _e=function(a,t,e){this.text=a,this.icon=t,this.skipFade=e},fe=function(){this.invProjMatrix=ea.create(),this.viewportMatrix=ea.create(),this.circles=[]},me=function(a,t,e,i,o){this.bucketInstanceId=a,this.featureIndex=t,this.sourceLayerIndex=e,this.bucketIndex=i,this.tileID=o},ge=function(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}};ge.prototype.get=function(a){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[a]){var o=++this.maxGroupID;this.collisionGroups[a]={ID:o,predicate:function(e){return e.collisionGroupID===o}}}return this.collisionGroups[a]};var ve=function(a,t,e,r){this.transform=a.clone(),this.collisionIndex=new le(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=t,this.retainedQueryData={},this.collisionGroups=new ge(e),this.collisionCircleArrays={},this.prevPlacement=r,r&&(r.prevPlacement=void 0),this.placedOrientations={}};ve.prototype.getBucketParts=function(t,e,i,o){var r=i.getBucket(e),a=i.latestFeatureIndex;if(r&&a&&e.id===r.layerIds[0]){var n=i.collisionBoxArray,s=r.layers[0].layout,l=pa(2,this.transform.zoom-i.tileID.overscaledZ),c=i.tileSize/ea.EXTENT,u=this.transform.calculatePosMatrix(i.tileID.toUnwrapped()),h="map"===s.get("text-pitch-alignment"),p="map"===s.get("text-rotation-alignment"),d=ue(i,1,this.transform.zoom),_=Ht(u,h,p,this.transform,d),f=null;if(h){var w=Xt(u,h,p,this.transform,d);f=ea.multiply([],this.transform.labelPlaneMatrix,w)}this.retainedQueryData[r.bucketInstanceId]=new me(r.bucketInstanceId,a,r.sourceLayerIndex,r.index,i.tileID);var g={bucket:r,layout:s,posMatrix:u,textLabelPlaneMatrix:_,labelToScreenMatrix:f,scale:l,textPixelRatio:c,holdingForFade:i.holdingForFade(),collisionBoxArray:n,partiallyEvaluatedTextSize:ea.evaluateSizeForZoom(r.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(r.sourceID)};if(o)for(var v=0,k=r.sortKeyRanges,x;v<k.length;v+=1)x=k[v],t.push({sortKey:x.sortKey,symbolInstanceStart:x.symbolInstanceStart,symbolInstanceEnd:x.symbolInstanceEnd,parameters:g});else t.push({symbolInstanceStart:0,symbolInstanceEnd:r.symbolInstances.length,parameters:g})}},ve.prototype.attemptAnchorPlacement=function(y,t,e,i,o,r,a,n,s,l,c,u,h,p,d){var x=[u.textOffset0,u.textOffset1],m=pe(y,e,i,x,o),g=this.collisionIndex.placeCollisionBox(ye(t,m.x,m.y,r,a,this.transform.angle),c,n,s,l.predicate),_;if(!d||0!==this.collisionIndex.placeCollisionBox(ye(d,m.x,m.y,r,a,this.transform.angle),c,n,s,l.predicate).box.length)return 0<g.box.length?(this.prevPlacement&&this.prevPlacement.variableOffsets[u.crossTileID]&&this.prevPlacement.placements[u.crossTileID]&&this.prevPlacement.placements[u.crossTileID].text&&(_=this.prevPlacement.variableOffsets[u.crossTileID].anchor),this.variableOffsets[u.crossTileID]={textOffset:x,width:e,height:i,anchor:y,textBoxScale:o,prevAnchor:_},this.markUsedJustification(h,y,u,p),h.allowVerticalPlacement&&(this.markUsedOrientation(h,p,u),this.placedOrientations[u.crossTileID]=p),{shift:m,placedGlyphBoxes:g}):void 0},ve.prototype.placeLayerBucketPart=function(t,ee,i){var te=this,e=t.parameters,ae=e.bucket,o=e.layout,r=e.posMatrix,a=e.textLabelPlaneMatrix,n=e.labelToScreenMatrix,l=e.textPixelRatio,s=e.holdingForFade,c=e.collisionBoxArray,d=e.partiallyEvaluatedTextSize,h=e.collisionGroup,p=o.get("text-optional"),u=o.get("icon-optional"),g=o.get("text-allow-overlap"),f=o.get("icon-allow-overlap"),y="map"===o.get("text-rotation-alignment"),x="map"===o.get("text-pitch-alignment"),b="none"!==o.get("icon-text-fit"),m="viewport-y"===o.get("symbol-z-order"),_=g&&(f||!ae.hasIconData()||u),v=f&&(g||!ae.hasTextData()||p);!ae.collisionArrays&&c&&ae.deserializeCollisionBoxes(c);var w=function(w,e){if(!ee[w.crossTileID])if(s)te.placements[w.crossTileID]=new _e(!1,!1,!1);else{var t=!1,c=!1,m=!0,E=null,I={box:null,offscreen:null},oe={box:null,offscreen:null},re=null,ie=null,ne=0,le=0,se=0,de;e.textFeatureIndex?ne=e.textFeatureIndex:w.useRuntimeCollisionCircles&&(ne=w.featureIndex),e.verticalTextFeatureIndex&&(le=e.verticalTextFeatureIndex);var ce=e.textBox;if(ce){var B=function(e){var t=ea.WritingMode.horizontal;if(ae.allowVerticalPlacement&&!e&&te.prevPlacement){var r=te.prevPlacement.placedOrientations[w.crossTileID];r&&(te.placedOrientations[w.crossTileID]=r,te.markUsedOrientation(ae,t=r,w))}return t},O=function(t,a){if(ae.allowVerticalPlacement&&0<w.numVerticalGlyphVertices&&e.verticalTextBox)for(var o=0,i=ae.writingModes;o<i.length&&(i[o]===ea.WritingMode.vertical?(I=a(),oe=I):I=t(),!(I&&I.box&&I.box.length));o+=1);else I=t()};if(o.get("text-variable-anchor")){var F=o.get("text-variable-anchor");if(te.prevPlacement&&te.prevPlacement.variableOffsets[w.crossTileID]){var pe=te.prevPlacement.variableOffsets[w.crossTileID];0<F.indexOf(pe.anchor)&&(F=F.filter(function(e){return e!==pe.anchor})).unshift(pe.anchor)}var N=function(e,n,i){for(var o=e.x2-e.x1,a=e.y2-e.y1,s=w.textBoxScale,c=b&&!f?n:null,u={box:[],offscreen:!1},v=g?2*F.length:F.length,d=0,k;d<v;++d)if(k=te.attemptAnchorPlacement(F[d%F.length],e,o,a,s,y,x,l,r,h,d>=F.length,w,ae,i,c),k&&(u=k.placedGlyphBoxes)&&u.box&&u.box.length){t=!0,E=k.shift;break}return u};O(function(){return N(ce,e.iconBox,ea.WritingMode.horizontal)},function(){var t=e.verticalTextBox;return ae.allowVerticalPlacement&&!(I&&I.box&&I.box.length)&&0<w.numVerticalGlyphVertices&&t?N(t,e.verticalIconBox,ea.WritingMode.vertical):{box:null,offscreen:null}}),I&&(t=I.box,m=I.offscreen);var Z=B(I&&I.box);if(!t&&te.prevPlacement){var j=te.prevPlacement.variableOffsets[w.crossTileID];j&&(te.variableOffsets[w.crossTileID]=j,te.markUsedJustification(ae,j.anchor,w,Z))}}else{var q=function(e,t){var a=te.collisionIndex.placeCollisionBox(e,g,l,r,h.predicate);return a&&a.box&&a.box.length&&(te.markUsedOrientation(ae,t,w),te.placedOrientations[w.crossTileID]=t),a};O(function(){return q(ce,ea.WritingMode.horizontal)},function(){var t=e.verticalTextBox;return ae.allowVerticalPlacement&&0<w.numVerticalGlyphVertices&&t?q(t,ea.WritingMode.vertical):{box:null,offscreen:null}}),B(I&&I.box&&I.box.length)}}if(t=(de=I)&&de.box&&0<de.box.length,m=de&&de.offscreen,w.useRuntimeCollisionCircles){var V=ae.text.placedSymbolArray.get(w.centerJustifiedTextSymbolIndex),G=ea.evaluateSizeForFeature(ae.textSizeData,d,V),W=o.get("text-padding");re=te.collisionIndex.placeCollisionCircles(g,V,ae.lineVertexArray,ae.glyphOffsetArray,G,r,a,n,i,x,h.predicate,w.collisionCircleDiameter,W),t=g||0<re.circles.length&&!re.collisionDetected,m=m&&re.offscreen}if(e.iconFeatureIndex&&(se=e.iconFeatureIndex),e.iconBox){var X=function(a){var t=b&&E?ye(a,E.x,E.y,y,x,te.transform.angle):a;return te.collisionIndex.placeCollisionBox(t,f,l,r,h.predicate)};c=oe&&oe.box&&oe.box.length&&e.verticalIconBox?0<(ie=X(e.verticalIconBox)).box.length:0<(ie=X(e.iconBox)).box.length,m=m&&ie.offscreen}var H=p||0===w.numHorizontalGlyphVertices&&0===w.numVerticalGlyphVertices,K=u||0===w.numIconVertices;if(H||K?K?H||(c=c&&t):t=c&&t:c=t=c&&t,t&&de&&de.box&&te.collisionIndex.insertCollisionBox(de.box,o.get("text-ignore-placement"),ae.bucketInstanceId,oe&&oe.box&&le?le:ne,h.ID),c&&ie&&te.collisionIndex.insertCollisionBox(ie.box,o.get("icon-ignore-placement"),ae.bucketInstanceId,se,h.ID),re&&(t&&te.collisionIndex.insertCollisionCircles(re.circles,o.get("text-ignore-placement"),ae.bucketInstanceId,ne,h.ID),i)){var Y=ae.bucketInstanceId,J=te.collisionCircleArrays[Y];void 0===J&&(J=te.collisionCircleArrays[Y]=new fe);for(var ue=0;ue<re.circles.length;ue+=4)J.circles.push(re.circles[ue+0]),J.circles.push(re.circles[ue+1]),J.circles.push(re.circles[ue+2]),J.circles.push(re.collisionDetected?1:0)}te.placements[w.crossTileID]=new _e(t||_,c||v,m||ae.justReloaded),ee[w.crossTileID]=!0}};if(m)for(var k=ae.getSortedSymbolIndexes(this.transform.angle),T=k.length-1,A;0<=T;--T)A=k[T],w(ae.symbolInstances.get(A),ae.collisionArrays[A]);else for(var S=t.symbolInstanceStart;S<t.symbolInstanceEnd;S++)w(ae.symbolInstances.get(S),ae.collisionArrays[S]);if(i&&ae.bucketInstanceId in this.collisionCircleArrays){var L=this.collisionCircleArrays[ae.bucketInstanceId];ea.invert(L.invProjMatrix,r),L.viewportMatrix=this.collisionIndex.getViewportMatrix()}ae.justReloaded=!1},ve.prototype.markUsedJustification=function(t,e,i,o){var r=o===ea.WritingMode.vertical?i.verticalPlacedTextSymbolIndex:{left:i.leftJustifiedTextSymbolIndex,center:i.centerJustifiedTextSymbolIndex,right:i.rightJustifiedTextSymbolIndex}[ea.getAnchorJustification(e)];for(var a=0,d=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex,i.verticalPlacedTextSymbolIndex],s;a<d.length;a+=1)s=d[a],0<=s&&(t.text.placedSymbolArray.get(s).crossTileID=0<=r&&s!==r?0:i.crossTileID)},ve.prototype.markUsedOrientation=function(t,e,i){for(var o=e===ea.WritingMode.horizontal||e===ea.WritingMode.horizontalOnly?e:0,r=e===ea.WritingMode.vertical?e:0,a=0,l=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex];a<l.length;a+=1)t.text.placedSymbolArray.get(l[a]).placedOrientation=o;i.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(i.verticalPlacedTextSymbolIndex).placedOrientation=r)},ve.prototype.commit=function(g){this.commitTime=g,this.zoomAtLastRecencyCheck=this.transform.zoom;var t=this.prevPlacement,e=!1;this.prevZoomAdjustment=t?t.zoomAdjustment(this.transform.zoom):0;var m=t?t.symbolFadeChange(g):1,o=t?t.opacities:{},r=t?t.variableOffsets:{},a=t?t.placedOrientations:{};for(var n in this.placements){var s=this.placements[n],l=o[n];l?(this.opacities[n]=new de(l,m,s.text,s.icon),e=e||s.text!==l.text.placed||s.icon!==l.icon.placed):(this.opacities[n]=new de(null,m,s.text,s.icon,s.skipFade),e=e||s.text||s.icon)}for(var c in o){var u=o[c];if(!this.opacities[c]){var h=new de(u,m,!1,!1);h.isHidden()||(this.opacities[c]=h,e=e||u.text.placed||u.icon.placed)}}for(var p in r)this.variableOffsets[p]||!this.opacities[p]||this.opacities[p].isHidden()||(this.variableOffsets[p]=r[p]);for(var d in a)this.placedOrientations[d]||!this.opacities[d]||this.opacities[d].isHidden()||(this.placedOrientations[d]=a[d]);e?this.lastPlacementChangeTime=g:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:g)},ve.prototype.updateLayerOpacities=function(l,t){for(var e={},i=0,s=t;i<s.length;i+=1){var r=s[i],a=r.getBucket(l);a&&r.latestFeatureIndex&&l.id===a.layerIds[0]&&this.updateBucketOpacities(a,e,r.collisionBoxArray)}},ve.prototype.updateBucketOpacities=function(k,e,t){var i=this;k.hasTextData()&&k.text.opacityVertexArray.clear(),k.hasIconData()&&k.icon.opacityVertexArray.clear(),k.hasIconCollisionBoxData()&&k.iconCollisionBox.collisionVertexArray.clear(),k.hasTextCollisionBoxData()&&k.textCollisionBox.collisionVertexArray.clear();var o=k.layers[0].layout,r=new de(null,0,!1,!1,!0),a=o.get("text-allow-overlap"),n=o.get("icon-allow-overlap"),l=o.get("text-variable-anchor"),s="map"===o.get("text-rotation-alignment"),c="map"===o.get("text-pitch-alignment"),u="none"!==o.get("icon-text-fit"),p=new de(null,0,a&&(n||!k.hasIconData()||o.get("icon-optional")),n&&(a||!k.hasTextData()||o.get("text-optional")),!0);!k.collisionArrays&&t&&(k.hasIconCollisionBoxData()||k.hasTextCollisionBoxData())&&k.deserializeCollisionBoxes(t);for(var d=function(a,t,e){for(var r=0;r<t/4;r++)a.opacityVertexArray.emplaceBack(e)},h=function(t){var o=k.symbolInstances.get(t),a=o.numHorizontalGlyphVertices,n=o.numVerticalGlyphVertices,h=o.crossTileID,f=i.opacities[h];e[h]?f=r:f||(i.opacities[h]=f=p),e[h]=!0;var _=0<o.numIconVertices,g=i.placedOrientations[o.crossTileID],v=g===ea.WritingMode.vertical,y=g===ea.WritingMode.horizontal||g===ea.WritingMode.horizontalOnly;if(0<a||0<n){var x=we(f.text);d(k.text,a,v?ze:x),d(k.text,n,y?ze:x);var b=f.text.isHidden();[o.rightJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.leftJustifiedTextSymbolIndex].forEach(function(e){0<=e&&(k.text.placedSymbolArray.get(e).hidden=b||v?1:0)}),0<=o.verticalPlacedTextSymbolIndex&&(k.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).hidden=b||y?1:0);var w=i.variableOffsets[o.crossTileID];w&&i.markUsedJustification(k,w.anchor,o,g);var T=i.placedOrientations[o.crossTileID];T&&(i.markUsedJustification(k,"left",o,T),i.markUsedOrientation(k,T,o))}if(_){var A=we(f.icon),L=!(u&&o.verticalPlacedIconSymbolIndex&&v);0<=o.placedIconSymbolIndex&&(d(k.icon,o.numIconVertices,L?A:ze),k.icon.placedSymbolArray.get(o.placedIconSymbolIndex).hidden=f.icon.isHidden()),0<=o.verticalPlacedIconSymbolIndex&&(d(k.icon,o.numVerticalIconVertices,L?ze:A),k.icon.placedSymbolArray.get(o.verticalPlacedIconSymbolIndex).hidden=f.icon.isHidden())}if(k.hasIconCollisionBoxData()||k.hasTextCollisionBoxData()){var E=k.collisionArrays[t];if(E){var S=new ea.Point(0,0);if(E.textBox||E.verticalTextBox){var I=!0;if(l){var P=i.variableOffsets[h];P?(S=pe(P.anchor,P.width,P.height,P.textOffset,P.textBoxScale),s&&S._rotate(c?i.transform.angle:-i.transform.angle)):I=!1}E.textBox&&xe(k.textCollisionBox.collisionVertexArray,f.text.placed,!I||v,S.x,S.y),E.verticalTextBox&&xe(k.textCollisionBox.collisionVertexArray,f.text.placed,!I||y,S.x,S.y)}var D=!y&&E.verticalIconBox;E.iconBox&&xe(k.iconCollisionBox.collisionVertexArray,f.icon.placed,D,u?S.x:0,u?S.y:0),E.verticalIconBox&&xe(k.iconCollisionBox.collisionVertexArray,f.icon.placed,!D,u?S.x:0,u?S.y:0)}}},y=0;y<k.symbolInstances.length;y++)h(y);if(k.sortFeatures(this.transform.angle),this.retainedQueryData[k.bucketInstanceId]&&(this.retainedQueryData[k.bucketInstanceId].featureSortOrder=k.featureSortOrder),k.hasTextData()&&k.text.opacityVertexBuffer&&k.text.opacityVertexBuffer.updateData(k.text.opacityVertexArray),k.hasIconData()&&k.icon.opacityVertexBuffer&&k.icon.opacityVertexBuffer.updateData(k.icon.opacityVertexArray),k.hasIconCollisionBoxData()&&k.iconCollisionBox.collisionVertexBuffer&&k.iconCollisionBox.collisionVertexBuffer.updateData(k.iconCollisionBox.collisionVertexArray),k.hasTextCollisionBoxData()&&k.textCollisionBox.collisionVertexBuffer&&k.textCollisionBox.collisionVertexBuffer.updateData(k.textCollisionBox.collisionVertexArray),k.bucketInstanceId in this.collisionCircleArrays){var f=this.collisionCircleArrays[k.bucketInstanceId];k.placementInvProjMatrix=f.invProjMatrix,k.placementViewportMatrix=f.viewportMatrix,k.collisionCircleArray=f.circles,delete this.collisionCircleArrays[k.bucketInstanceId]}},ve.prototype.symbolFadeChange=function(e){return 0===this.fadeDuration?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},ve.prototype.zoomAdjustment=function(e){return ha(0,(this.transform.zoom-e)/1.5)},ve.prototype.hasTransitions=function(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration},ve.prototype.stillRecent=function(a,t){var e=this.zoomAtLastRecencyCheck===t?1-this.zoomAdjustment(t):1;return this.zoomAtLastRecencyCheck=t,this.commitTime+this.fadeDuration*e>a},ve.prototype.setStale=function(){this.stale=!0};var be=pa(2,25),Te=pa(2,24),Ee=pa(2,17),Ie=pa(2,16),Pe=pa(2,9),Se=pa(2,8),Ce=pa(2,1),ze=0,Me=function(e){this._sortAcrossTiles="viewport-y"!==e.layout.get("symbol-z-order")&&void 0!==e.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Me.prototype.continuePlacement=function(n,t,e,i,o){for(var r=this._bucketParts;this._currentTileIndex<n.length;)if(t.getBucketParts(r,i,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,o())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,r.sort(function(a,t){return a.sortKey-t.sortKey}));this._currentPartIndex<r.length;)if(t.placeLayerBucketPart(r[this._currentPartIndex],this._seenCrossTileIDs,e),this._currentPartIndex++,o())return!0;return!1};var Ae=function(l,t,e,i,o,r,a){this.placement=new ve(l,o,r,a),this._currentPlacementIndex=t.length-1,this._forceFullPlacement=e,this._showCollisionBoxes=i,this._done=!1};Ae.prototype.isDone=function(){return this._done},Ae.prototype.continuePlacement=function(t,e,i){for(var o=this,r=ea.browser.now(),a=function(){var t=ea.browser.now()-r;return!o._forceFullPlacement&&2<t};0<=this._currentPlacementIndex;){var n=e[t[this._currentPlacementIndex]],s=this.placement.collisionIndex.transform.zoom;if("symbol"===n.type&&(!n.minzoom||n.minzoom<=s)&&(!n.maxzoom||n.maxzoom>s)){if(this._inProgressLayer||(this._inProgressLayer=new Me(n)),this._inProgressLayer.continuePlacement(i[n.source],this.placement,this._showCollisionBoxes,n,a))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Ae.prototype.commit=function(e){return this.placement.commit(e),this.placement};var Le=512/ea.EXTENT/2,Re=function(n,t,e){this.tileID=n,this.indexedSymbolInstances={},this.bucketInstanceId=e;for(var i=0;i<t.length;i++){var l=t.get(i),r=l.key;this.indexedSymbolInstances[r]||(this.indexedSymbolInstances[r]=[]),this.indexedSymbolInstances[r].push({crossTileID:l.crossTileID,coord:this.getScaledCoordinates(l,n)})}};Re.prototype.getScaledCoordinates=function(t,e){var a=Le/pa(2,e.canonical.z-this.tileID.canonical.z);return{x:ya((e.canonical.x*ea.EXTENT+t.anchorX)*a),y:ya((e.canonical.y*ea.EXTENT+t.anchorY)*a)}},Re.prototype.findMatches=function(d,t,e){for(var i=this.tileID.canonical.z<t.canonical.z?1:pa(2,this.tileID.canonical.z-t.canonical.z),o=0,p;o<d.length;o++)if(p=d.get(o),!p.crossTileID){var g=this.indexedSymbolInstances[p.key];if(g)for(var n=this.getScaledCoordinates(p,t),s=0,m=g,c;s<m.length;s+=1)if(c=m[s],ma(c.coord.x-n.x)<=i&&ma(c.coord.y-n.y)<=i&&!e[c.crossTileID]){e[c.crossTileID]=!0,p.crossTileID=c.crossTileID;break}}};var ke=function(){this.maxCrossTileID=0};ke.prototype.generate=function(){return++this.maxCrossTileID};var Be=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Be.prototype.handleWrapJump=function(l){var t=Xe((l-this.lng)/360);if(0!==t)for(var e in this.indexes){var i=this.indexes[e],o={};for(var r in i){var a=i[r];a.tileID=a.tileID.unwrapTo(a.tileID.wrap+t),o[a.tileID.key]=a}this.indexes[e]=o}this.lng=l},Be.prototype.addBucket=function(d,t,e){if(this.indexes[d.overscaledZ]&&this.indexes[d.overscaledZ][d.key]){if(this.indexes[d.overscaledZ][d.key].bucketInstanceId===t.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(d.overscaledZ,this.indexes[d.overscaledZ][d.key])}for(var i=0;i<t.symbolInstances.length;i++)t.symbolInstances.get(i).crossTileID=0;this.usedCrossTileIDs[d.overscaledZ]||(this.usedCrossTileIDs[d.overscaledZ]={});var p=this.usedCrossTileIDs[d.overscaledZ];for(var r in this.indexes){var a=this.indexes[r];if(+r>d.overscaledZ)for(var n in a){var s=a[n];s.tileID.isChildOf(d)&&s.findMatches(t.symbolInstances,d,p)}else{var l=a[d.scaledTo(+r).key];l&&l.findMatches(t.symbolInstances,d,p)}}for(var c=0,g;c<t.symbolInstances.length;c++)g=t.symbolInstances.get(c),g.crossTileID||(g.crossTileID=e.generate(),p[g.crossTileID]=!0);return void 0===this.indexes[d.overscaledZ]&&(this.indexes[d.overscaledZ]={}),this.indexes[d.overscaledZ][d.key]=new Re(d,t.symbolInstances,t.bucketInstanceId),!0},Be.prototype.removeBucketCrossTileIDs=function(a,t){for(var e in t.indexedSymbolInstances)for(var i=0,n=t.indexedSymbolInstances[e];i<n.length;i+=1)delete this.usedCrossTileIDs[a][n[i].crossTileID]},Be.prototype.removeStaleBuckets=function(a){var t=!1;for(var n in this.indexes){var i=this.indexes[n];for(var o in i)a[i[o].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,i[o]),delete i[o],t=!0)}return t};var Oe=function(){this.layerIndexes={},this.crossTileIDs=new ke,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Oe.prototype.addLayer=function(d,t,e){var i=this.layerIndexes[d.id];void 0===i&&(i=this.layerIndexes[d.id]=new Be);var p=!1,u={};i.handleWrapJump(e);for(var a=0,g=t;a<g.length;a+=1){var s=g[a],l=s.getBucket(d);l&&d.id===l.layerIds[0]&&(l.bucketInstanceId||(l.bucketInstanceId=++this.maxBucketInstanceId),i.addBucket(s.tileID,l,this.crossTileIDs)&&(p=!0),u[l.bucketInstanceId]=!0)}return i.removeStaleBuckets(u)&&(p=!0),p},Oe.prototype.pruneUnusedLayers=function(a){var o={};for(var e in a.forEach(function(e){o[e]=!0}),this.layerIndexes)o[e]||delete this.layerIndexes[e]};var Fe=function(t,e){return ea.emitValidationErrors(t,e&&e.filter(function(e){return"source.canvas"!==e.identifier}))},Ue=ea.pick(Wa,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Ne=ea.pick(Wa,["setCenter","setZoom","setBearing","setPitch"]),Ze=function(){var t={},e=ea.styleSpec.$version;for(var i in ea.styleSpec.$root){var o=ea.styleSpec.$root[i],a;o.required&&null!=(a="version"===i?e:"array"===o.type?[]:{})&&(t[i]=a)}return t}(),je=function(t){function l(e,o){var s=this;void 0===o&&(o={}),t.call(this),this.map=e,this.dispatcher=new Ha(Lt(),this),this.imageManager=new u,this.imageManager.setEventedParent(this),this.glyphManager=new Ua(e._requestManager,o.localIdeographFontFamily),this.lineAtlas=new w(256,512),this.crossTileSymbolIndex=new Oe,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new ea.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",ea.getReferrer());var a=this;this._rtlTextPluginCallback=l.registerForPluginStateChange(function(t){a.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:t.pluginStatus,pluginURL:t.pluginURL},function(t,e){if(ea.triggerPluginCompletionEvent(t),e&&e.every(function(e){return e}))for(var r in a.sourceCaches)a.sourceCaches[r].reload()})}),this.on("data",function(a){if("source"===a.dataType&&"metadata"===a.sourceDataType){var t=s.sourceCaches[a.sourceId];if(t){var e=t.getSource();if(e&&e.vectorLayerIds)for(var i in s._layers){var o=s._layers[i];o.source===e.id&&s._validateLayer(o)}}}})}return t&&(l.__proto__=t),(l.prototype=Object.create(t&&t.prototype)).constructor=l,l.prototype.loadURL=function(t,n){var l=this;void 0===n&&(n={}),this.fire(new ea.Event("dataloading",{dataType:"style"}));var o="boolean"==typeof n.validate?n.validate:!ea.isMapboxURL(t);t=this.map._requestManager.normalizeStyleURL(t,n.accessToken);var r=this.map._requestManager.transformRequest(t,ea.ResourceType.Style);this._request=ea.getJSON(r,function(t,e){l._request=null,t?l.fire(new ea.ErrorEvent(t)):e&&l._load(e,o)})},l.prototype.loadJSON=function(t,e){var a=this;void 0===e&&(e={}),this.fire(new ea.Event("dataloading",{dataType:"style"})),this._request=ea.browser.frame(function(){a._request=null,a._load(t,!1!==e.validate)})},l.prototype.loadEmpty=function(){this.fire(new ea.Event("dataloading",{dataType:"style"})),this._load(Ze,!1)},l.prototype._load=function(t,e){if(!e||!Fe(this,ea.validateStyle(t))){for(var i in this._loaded=!0,this.stylesheet=t,t.sources)this.addSource(i,t.sources[i],{validate:!1});t.sprite?this._loadSprite(t.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(t.glyphs);var o=Ft(this.stylesheet.layers);this._order=o.map(function(e){return e.id}),this._layers={},this._serializedLayers={};for(var r=0,l=o,n;r<l.length;r+=1)n=l[r],(n=ea.createStyleLayer(n)).setEventedParent(this,{layer:{id:n.id}}),this._layers[n.id]=n,this._serializedLayers[n.id]=n.serialize();this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new b(this.stylesheet.light),this.fire(new ea.Event("data",{dataType:"style"})),this.fire(new ea.Event("style.load"))}},l.prototype._loadSprite=function(t){var a=this;this._spriteRequest=function(t,e,y){function o(){if(w)y(w);else if(x&&b){var t=ea.browser.getImageData(b),e={};for(var a in x){var o=x[a],r=o.width,i=o.height,n=o.x,l=o.y,s=o.sdf,d=o.pixelRatio,c=o.stretchX,p=o.stretchY,u=o.content,g=new ea.RGBAImage({width:r,height:i});ea.RGBAImage.copy(t,g,{x:n,y:l},{x:0,y:0},{width:r,height:i}),e[a]={data:g,pixelRatio:d,sdf:s,stretchX:c,stretchY:p,content:u}}y(null,e)}}var i=1<ea.browser.devicePixelRatio?"@2x":"",s=ea.getJSON(e.transformRequest(e.normalizeSpriteURL(t,i,".json"),ea.ResourceType.SpriteJSON),function(a,t){s=null,w||(w=a,x=t,o())}),d=ea.getImage(e.transformRequest(e.normalizeSpriteURL(t,i,".png"),ea.ResourceType.SpriteImage),function(a,t){d=null,w||(w=a,b=t,o())}),x,b,w;return{cancel:function(){s&&(s.cancel(),s=null),d&&(d.cancel(),d=null)}}}(t,this.map._requestManager,function(t,e){if(a._spriteRequest=null,t)a.fire(new ea.ErrorEvent(t));else if(e)for(var o in e)a.imageManager.addImage(o,e[o]);a.imageManager.setLoaded(!0),a._availableImages=a.imageManager.listImages(),a.dispatcher.broadcast("setImages",a._availableImages),a.fire(new ea.Event("data",{dataType:"style"}))})},l.prototype._validateLayer=function(t){var e=this.sourceCaches[t.source];if(e){var a=t.sourceLayer;if(a){var o=e.getSource();("geojson"===o.type||o.vectorLayerIds&&-1===o.vectorLayerIds.indexOf(a))&&this.fire(new ea.ErrorEvent(new Error("Source layer \""+a+"\" does not exist on source \""+o.id+"\" as specified by style layer \""+t.id+"\"")))}}},l.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()},l.prototype._serializeLayers=function(a){for(var t=[],e=0,n=a,o;e<n.length;e+=1)o=this._layers[n[e]],"custom"!==o.type&&t.push(o.serialize());return t},l.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var a in this.sourceCaches)if(this.sourceCaches[a].hasTransition())return!0;for(var t in this._layers)if(this._layers[t].hasTransition())return!0;return!1},l.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},l.prototype.update=function(t){if(this._loaded){var e=this._changed;if(this._changed){var i=Object.keys(this._updatedLayers),o=Object.keys(this._removedLayers);for(var r in(i.length||o.length)&&this._updateWorkerLayers(i,o),this._updatedSources){var a=this._updatedSources[r];"reload"===a?this._reloadSource(r):"clear"===a&&this._clearSource(r)}for(var n in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[n].updateTransitions(t);this.light.updateTransitions(t),this._resetUpdates()}for(var s in this.sourceCaches)this.sourceCaches[s].used=!1;for(var l=0,d=this._order,p;l<d.length;l+=1)p=this._layers[d[l]],p.recalculate(t,this._availableImages),!p.isHidden(t.zoom)&&p.source&&(this.sourceCaches[p.source].used=!0);this.light.recalculate(t),this.z=t.zoom,e&&this.fire(new ea.Event("data",{dataType:"style"}))}},l.prototype._updateTilesForChangedImages=function(){var a=Object.keys(this._changedImages);if(a.length){for(var t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["icons","patterns"],a);this._changedImages={}}},l.prototype._updateWorkerLayers=function(a,t){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(a),removedIds:t})},l.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},l.prototype.setState=function(t){var a=this;if(this._checkLoaded(),Fe(this,ea.validateStyle(t)))return!1;(t=ea.clone$1(t)).layers=Ft(t.layers);var i=function(t,e){if(!t)return[{command:Wa.setStyle,args:[e]}];var i=[];try{if(!ea.deepEqual(t.version,e.version))return[{command:Wa.setStyle,args:[e]}];ea.deepEqual(t.center,e.center)||i.push({command:Wa.setCenter,args:[e.center]}),ea.deepEqual(t.zoom,e.zoom)||i.push({command:Wa.setZoom,args:[e.zoom]}),ea.deepEqual(t.bearing,e.bearing)||i.push({command:Wa.setBearing,args:[e.bearing]}),ea.deepEqual(t.pitch,e.pitch)||i.push({command:Wa.setPitch,args:[e.pitch]}),ea.deepEqual(t.sprite,e.sprite)||i.push({command:Wa.setSprite,args:[e.sprite]}),ea.deepEqual(t.glyphs,e.glyphs)||i.push({command:Wa.setGlyphs,args:[e.glyphs]}),ea.deepEqual(t.transition,e.transition)||i.push({command:Wa.setTransition,args:[e.transition]}),ea.deepEqual(t.light,e.light)||i.push({command:Wa.setLight,args:[e.light]});var l={},r=[];!function(t,n,l,o){for(var r in n=n||{},t=t||{})t.hasOwnProperty(r)&&(n.hasOwnProperty(r)||jt(r,l,o));for(r in n)n.hasOwnProperty(r)&&(t.hasOwnProperty(r)?ea.deepEqual(t[r],n[r])||("geojson"===t[r].type&&"geojson"===n[r].type&&Vt(t,n,r)?l.push({command:Wa.setGeoJSONSourceData,args:[r,n[r].data]}):Ut(r,n,l,o)):Nt(r,n,l))}(t.sources,e.sources,r,l);var a=[];t.layers&&t.layers.forEach(function(e){l[e.source]?i.push({command:Wa.removeLayer,args:[e.id]}):a.push(e)}),i=i.concat(r),function(t,g,y){g=g||[];var o=(t=t||[]).map(Gt),h=g.map(Gt),p=t.reduce(Wt,{}),d=g.reduce(Wt,{}),x=o.slice(),f=Object.create(null),m,_,b,v,w,k,T;for(m=0,_=0;m<o.length;m++)d.hasOwnProperty(b=o[m])?_++:(y.push({command:Wa.removeLayer,args:[b]}),x.splice(x.indexOf(b,_),1));for(m=0,_=0;m<h.length;m++)x[x.length-1-m]!==(b=h[h.length-1-m])&&(p.hasOwnProperty(b)?(y.push({command:Wa.removeLayer,args:[b]}),x.splice(x.lastIndexOf(b,x.length-_),1)):_++,y.push({command:Wa.addLayer,args:[d[b],k=x[x.length-m]]}),x.splice(x.length-m,0,b),f[b]=!0);for(m=0;m<h.length;m++)if(v=p[b=h[m]],w=d[b],!f[b]&&!ea.deepEqual(v,w))if(ea.deepEqual(v.source,w.source)&&ea.deepEqual(v["source-layer"],w["source-layer"])&&ea.deepEqual(v.type,w.type)){for(T in qt(v.layout,w.layout,y,b,null,Wa.setLayoutProperty),qt(v.paint,w.paint,y,b,null,Wa.setPaintProperty),ea.deepEqual(v.filter,w.filter)||y.push({command:Wa.setFilter,args:[b,w.filter]}),ea.deepEqual(v.minzoom,w.minzoom)&&ea.deepEqual(v.maxzoom,w.maxzoom)||y.push({command:Wa.setLayerZoomRange,args:[b,w.minzoom,w.maxzoom]}),v)v.hasOwnProperty(T)&&"layout"!==T&&"paint"!==T&&"filter"!==T&&"metadata"!==T&&"minzoom"!==T&&"maxzoom"!==T&&(0===T.indexOf("paint.")?qt(v[T],w[T],y,b,T.slice(6),Wa.setPaintProperty):ea.deepEqual(v[T],w[T])||y.push({command:Wa.setLayerProperty,args:[b,T,w[T]]}));for(T in w)w.hasOwnProperty(T)&&!v.hasOwnProperty(T)&&"layout"!==T&&"paint"!==T&&"filter"!==T&&"metadata"!==T&&"minzoom"!==T&&"maxzoom"!==T&&(0===T.indexOf("paint.")?qt(v[T],w[T],y,b,T.slice(6),Wa.setPaintProperty):ea.deepEqual(v[T],w[T])||y.push({command:Wa.setLayerProperty,args:[b,T,w[T]]}))}else y.push({command:Wa.removeLayer,args:[b]}),k=x[x.lastIndexOf(b)+1],y.push({command:Wa.addLayer,args:[w,k]})}(a,e.layers,i)}catch(a){console.warn("Unable to compute style diff:",a),i=[{command:Wa.setStyle,args:[e]}]}return i}(this.serialize(),t).filter(function(e){return!(e.command in Ne)});if(0===i.length)return!1;var o=i.filter(function(e){return!(e.command in Ue)});if(0<o.length)throw new Error("Unimplemented: "+o.map(function(e){return e.command}).join(", ")+".");return i.forEach(function(e){"setTransition"!==e.command&&a[e.command].apply(a,e.args)}),this.stylesheet=t,!0},l.prototype.addImage=function(t,e){return this.getImage(t)?this.fire(new ea.ErrorEvent(new Error("An image with this name already exists."))):void(this.imageManager.addImage(t,e),this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.fire(new ea.Event("data",{dataType:"style"})))},l.prototype.updateImage=function(a,t){this.imageManager.updateImage(a,t)},l.prototype.getImage=function(e){return this.imageManager.getImage(e)},l.prototype.removeImage=function(t){return this.getImage(t)?void(this.imageManager.removeImage(t),this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.fire(new ea.Event("data",{dataType:"style"}))):this.fire(new ea.ErrorEvent(new Error("No image with this name exists.")))},l.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},l.prototype.addSource=function(t,e,i){var n=this;if(void 0===i&&(i={}),this._checkLoaded(),void 0!==this.sourceCaches[t])throw new Error("There is already a source with this ID");if(!e.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(e).join(", ")+".");if(!(0<=["vector","raster","geojson","video","image"].indexOf(e.type)&&this._validate(ea.validateStyle.source,"sources."+t,e,null,i))){this.map&&this.map._collectResourceTiming&&(e.collectResourceTiming=!0);var r=this.sourceCaches[t]=new zt(t,e,this.dispatcher);r.style=this,r.setEventedParent(this,function(){return{isSourceLoaded:n.loaded(),source:r.serialize(),sourceId:t}}),r.onAdd(this.map),this._changed=!0}},l.prototype.removeSource=function(t){if(this._checkLoaded(),void 0===this.sourceCaches[t])throw new Error("There is no source with this ID");for(var e in this._layers)if(this._layers[e].source===t)return this.fire(new ea.ErrorEvent(new Error("Source \""+t+"\" cannot be removed while layer \""+e+"\" is using it.")));var a=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],a.fire(new ea.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),a.setEventedParent(null),a.clearTiles(),a.onRemove&&a.onRemove(this.map),this._changed=!0},l.prototype.setGeoJSONSourceData=function(a,t){this._checkLoaded(),this.sourceCaches[a].getSource().setData(t),this._changed=!0},l.prototype.getSource=function(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()},l.prototype.addLayer=function(t,l,i){void 0===i&&(i={}),this._checkLoaded();var d=t.id;if(this.getLayer(d))this.fire(new ea.ErrorEvent(new Error("Layer with id \""+d+"\" already exists on this map")));else{var r;if("custom"===t.type){if(Fe(this,ea.validateCustomStyleLayer(t)))return;r=ea.createStyleLayer(t)}else{if("object"==typeof t.source&&(this.addSource(d,t.source),t=ea.clone$1(t),t=ea.extend(t,{source:d})),this._validate(ea.validateStyle.layer,"layers."+d,t,{arrayIndex:-1},i))return;r=ea.createStyleLayer(t),this._validateLayer(r),r.setEventedParent(this,{layer:{id:d}}),this._serializedLayers[r.id]=r.serialize()}var c=l?this._order.indexOf(l):this._order.length;if(l&&-1===c)this.fire(new ea.ErrorEvent(new Error("Layer with id \""+l+"\" does not exist on this map.")));else{if(this._order.splice(c,0,d),this._layerOrderChanged=!0,this._layers[d]=r,this._removedLayers[d]&&r.source&&"custom"!==r.type){var n=this._removedLayers[d];delete this._removedLayers[d],n.type===r.type?(this._updatedSources[r.source]="reload",this.sourceCaches[r.source].pause()):this._updatedSources[r.source]="clear"}this._updateLayer(r),r.onAdd&&r.onAdd(this.map)}}},l.prototype.moveLayer=function(t,e){if(this._checkLoaded(),this._changed=!0,!this._layers[t])this.fire(new ea.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be moved.")));else if(t!==e){var a=this._order.indexOf(t);this._order.splice(a,1);var o=e?this._order.indexOf(e):this._order.length;e&&-1===o?this.fire(new ea.ErrorEvent(new Error("Layer with id \""+e+"\" does not exist on this map."))):(this._order.splice(o,0,t),this._layerOrderChanged=!0)}},l.prototype.removeLayer=function(t){this._checkLoaded();var e=this._layers[t];if(e){e.setEventedParent(null);var a=this._order.indexOf(t);this._order.splice(a,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=e,delete this._layers[t],delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],e.onRemove&&e.onRemove(this.map)}else this.fire(new ea.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be removed.")))},l.prototype.getLayer=function(e){return this._layers[e]},l.prototype.hasLayer=function(e){return e in this._layers},l.prototype.setLayerZoomRange=function(t,e,a){this._checkLoaded();var o=this.getLayer(t);o?o.minzoom===e&&o.maxzoom===a||(null!=e&&(o.minzoom=e),null!=a&&(o.maxzoom=a),this._updateLayer(o)):this.fire(new ea.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot have zoom extent.")))},l.prototype.setFilter=function(t,e,a){void 0===a&&(a={}),this._checkLoaded();var i=this.getLayer(t);if(!i)this.fire(new ea.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be filtered.")));else if(!ea.deepEqual(i.filter,e))return null==e?(i.filter=void 0,void this._updateLayer(i)):void(this._validate(ea.validateStyle.filter,"layers."+i.id+".filter",e,null,a)||(i.filter=ea.clone$1(e),this._updateLayer(i)))},l.prototype.getFilter=function(t){return ea.clone$1(this.getLayer(t).filter)},l.prototype.setLayoutProperty=function(t,e,i,o){void 0===o&&(o={}),this._checkLoaded();var n=this.getLayer(t);n?ea.deepEqual(n.getLayoutProperty(e),i)||(n.setLayoutProperty(e,i,o),this._updateLayer(n)):this.fire(new ea.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be styled.")))},l.prototype.getLayoutProperty=function(t,e){var a=this.getLayer(t);return a?a.getLayoutProperty(e):void this.fire(new ea.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style.")))},l.prototype.setPaintProperty=function(t,e,i,o){void 0===o&&(o={}),this._checkLoaded();var n=this.getLayer(t);n?ea.deepEqual(n.getPaintProperty(e),i)||(n.setPaintProperty(e,i,o)&&this._updateLayer(n),this._changed=!0,this._updatedPaintProps[t]=!0):this.fire(new ea.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be styled.")))},l.prototype.getPaintProperty=function(a,t){return this.getLayer(a).getPaintProperty(t)},l.prototype.setFeatureState=function(t,e){this._checkLoaded();var i=t.source,o=t.sourceLayer,r=this.sourceCaches[i];if(void 0!==r){var a=r.getSource().type;"geojson"===a&&o?this.fire(new ea.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==a||o?(void 0===t.id&&this.fire(new ea.ErrorEvent(new Error("The feature id parameter must be provided."))),r.setFeatureState(o,t.id,e)):this.fire(new ea.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new ea.ErrorEvent(new Error("The source '"+i+"' does not exist in the map's style.")))},l.prototype.removeFeatureState=function(t,e){this._checkLoaded();var i=t.source,o=this.sourceCaches[i];if(void 0!==o){var r=o.getSource().type,a="vector"===r?t.sourceLayer:void 0;"vector"!==r||a?e&&"string"!=typeof t.id&&"number"!=typeof t.id?this.fire(new ea.ErrorEvent(new Error("A feature id is requred to remove its specific state property."))):o.removeFeatureState(a,t.id,e):this.fire(new ea.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new ea.ErrorEvent(new Error("The source '"+i+"' does not exist in the map's style.")))},l.prototype.getFeatureState=function(t){this._checkLoaded();var e=t.source,a=t.sourceLayer,o=this.sourceCaches[e];if(void 0!==o){if("vector"!==o.getSource().type||a)return void 0===t.id&&this.fire(new ea.ErrorEvent(new Error("The feature id parameter must be provided."))),o.getFeatureState(a,t.id);this.fire(new ea.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new ea.ErrorEvent(new Error("The source '"+e+"' does not exist in the map's style.")))},l.prototype.getTransition=function(){return ea.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},l.prototype.serialize=function(){return ea.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:ea.mapObject(this.sourceCaches,function(e){return e.serialize()}),layers:this._serializeLayers(this._order)},function(e){return void 0!==e})},l.prototype._updateLayer=function(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&"raster"!==this.sourceCaches[e.source].getSource().type&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._changed=!0},l.prototype._flattenAndSortRenderedFeatures=function(w){for(var k=this,e=function(e){return"fill-extrusion"===k._layers[e].type},t={},o=[],r=this._order.length-1,i;0<=r;r--)if(i=this._order[r],e(i)){t[i]=r;for(var T=0,A=w,l;T<A.length;T+=1)if(l=A[T][i],l)for(var S=0,C=l;S<C.length;S+=1)o.push(C[S])}o.sort(function(a,t){return t.intersectionZ-a.intersectionZ});for(var h=[],p=this._order.length-1,L;0<=p;p--)if(L=this._order[p],e(L))for(var E=o.length-1,I;0<=E&&(I=o[E].feature,!(t[I.layer.id]<p));E--)h.push(I),o.pop();else for(var P=0,z=w,v;P<z.length;P+=1)if(v=z[P][L],v)for(var D=0,O=v;D<O.length;D+=1)h.push(O[D].feature);return h},l.prototype.queryRenderedFeatures=function(t,e,i){e&&e.filter&&this._validate(ea.validateStyle.filter,"queryRenderedFeatures.filter",e.filter,null,e);var o={};if(e&&e.layers){if(!Array.isArray(e.layers))return this.fire(new ea.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var r=0,d=e.layers;r<d.length;r+=1){var n=d[r],s=this._layers[n];if(!s)return this.fire(new ea.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be queried for features."))),[];o[s.source]=!0}}var l=[];for(var c in e.availableImages=this._availableImages,this.sourceCaches)e.layers&&!o[c]||l.push(I(this.sourceCaches[c],this._layers,this._serializedLayers,t,e,i));return this.placement&&l.push(function(g,t,y,e,x,o,a){for(var r={},s=o.queryRenderedSymbols(e),i=[],n=0,l=Object.keys(s).map(Number);n<l.length;n+=1)i.push(a[l[n]]);i.sort(O);for(var c=function(){var l=b[p],e=l.featureIndex.lookupSymbolFeatures(s[l.bucketInstanceId],t,l.bucketIndex,l.sourceLayerIndex,x.filter,x.layers,x.availableImages,g);for(var o in e){var a=r[o]=r[o]||[],i=e[o];i.sort(function(a,t){var e=l.featureSortOrder;if(e){var o=e.indexOf(a.featureIndex);return e.indexOf(t.featureIndex)-o}return t.featureIndex-a.featureIndex});for(var n=0,d=i;n<d.length;n+=1)a.push(d[n])}},p=0,b=i;p<b.length;p+=1)c();var h=function(t){r[t].forEach(function(e){var o=e.feature,r=y[g[t].source].getFeatureState(o.layer["source-layer"],o.id);o.source=o.layer.source,o.layer["source-layer"]&&(o.sourceLayer=o.layer["source-layer"]),o.state=r})};for(var f in r)h(f);return r}(this._layers,this._serializedLayers,this.sourceCaches,t,e,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(l)},l.prototype.querySourceFeatures=function(t,e){e&&e.filter&&this._validate(ea.validateStyle.filter,"querySourceFeatures.filter",e.filter,null,e);var a=this.sourceCaches[t];return a?function(l,t){for(var e=l.getRenderableIds().map(function(t){return l.getTileByID(t)}),i=[],o={},r=0;r<e.length;r++){var d=e[r],n=d.tileID.canonical.key;o[n]||(o[n]=!0,d.querySourceFeatures(i,t))}return i}(a,e):[]},l.prototype.addSourceType=function(a,t,e){return l.getSourceType(a)?e(new Error("A source type called \""+a+"\" already exists.")):(l.setSourceType(a,t),t.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:a,url:t.workerSourceURL},e):e(null,null))},l.prototype.getLight=function(){return this.light.getLight()},l.prototype.setLight=function(t,e){void 0===e&&(e={}),this._checkLoaded();var l=this.light.getLight(),o=!1;for(var s in t)if(!ea.deepEqual(t[s],l[s])){o=!0;break}if(o){var a={now:ea.browser.now(),transition:ea.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,e),this.light.updateTransitions(a)}},l.prototype._validate=function(t,e,i,o,r){return void 0===r&&(r={}),(!r||!1!==r.validate)&&Fe(this,t.call(ea.validateStyle,ea.extend({key:e,style:this.serialize(),value:i,styleSpec:ea.styleSpec},o)))},l.prototype._remove=function(){for(var t in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),ea.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[t].setEventedParent(null);for(var e in this.sourceCaches)this.sourceCaches[e].clearTiles(),this.sourceCaches[e].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},l.prototype._clearSource=function(e){this.sourceCaches[e].clearTiles()},l.prototype._reloadSource=function(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()},l.prototype._updateSources=function(a){for(var t in this.sourceCaches)this.sourceCaches[t].update(a)},l.prototype._generateCollisionBoxes=function(){for(var e in this.sourceCaches)this._reloadSource(e)},l.prototype._updatePlacement=function(t,e,i,o,r){void 0===r&&(r=!1);for(var g=!1,y=!1,x={},l=0,b=this._order,u;l<b.length;l+=1)if(u=this._layers[b[l]],"symbol"===u.type){if(!x[u.source]){var v=this.sourceCaches[u.source];x[u.source]=v.getRenderableIds(!0).map(function(e){return v.getTileByID(e)}).sort(function(a,t){return t.tileID.overscaledZ-a.tileID.overscaledZ||(a.tileID.isLessThan(t.tileID)?-1:1)})}var p=this.crossTileSymbolIndex.addLayer(u,x[u.source],t.center.lng);g=g||p}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((r=r||this._layerOrderChanged||0===i)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(ea.browser.now(),t.zoom))&&(this.pauseablePlacement=new Ae(t,this._order,r,e,i,o,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,x),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(ea.browser.now()),y=!0),g&&this.pauseablePlacement.placement.setStale()),y||g)for(var d=0,w=this._order,f;d<w.length;d+=1)f=this._layers[w[d]],"symbol"===f.type&&this.placement.updateLayerOpacities(f,x[f.source]);return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(ea.browser.now())},l.prototype._releaseSymbolFadeTiles=function(){for(var e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()},l.prototype.getImages=function(a,t,e){this.imageManager.getImages(t.icons,e),this._updateTilesForChangedImages();var r=this.sourceCaches[t.source];r&&r.setDependencies(t.tileID.key,t.type,t.icons)},l.prototype.getGlyphs=function(a,t,e){this.glyphManager.getGlyphs(t.stacks,e)},l.prototype.getResource=function(t,e,a){return ea.makeRequest(e,a)},l}(ea.Evented);je.getSourceType=function(e){return R[e]},je.setSourceType=function(a,t){R[a]=t},je.registerForPluginStateChange=ea.registerForPluginStateChange;var qe=ea.createLayout([{name:"a_pos",type:"Int16",components:2}]),Ve=De("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),Xa=De("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Za=De("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Ka=De("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),He=De("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),$a=De("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),Ja=De("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Qa=De("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Qe=De("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),$e=De("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),eo=De("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),to=De("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),ao=De("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),oo=De("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),ro=De("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),io=De("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),no=De("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),po=De("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),mo=De("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),fo=De("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define MAX_LINE_DISTANCE 32767.0\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),_o=De("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),Ao=De("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),Mo=De("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Uo=De("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),Yo=De("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),Ko=De("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),Qo=Object.freeze({__proto__:null,prelude:Ve,background:Xa,backgroundPattern:Za,circle:Ka,clippingMask:He,heatmap:$a,heatmapTexture:Ja,collisionBox:Qa,collisionCircle:Qe,debug:$e,fill:eo,fillOutline:to,fillOutlinePattern:ao,fillPattern:oo,fillExtrusion:ro,fillExtrusionPattern:io,hillshadePrepare:no,hillshade:po,line:mo,lineGradient:fo,linePattern:_o,lineSDF:Ao,raster:Mo,symbolIcon:Uo,symbolSDF:Yo,symbolTextAndIcon:Ko}),tr=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};tr.prototype.bind=function(d,t,e,i,o,r,a,n){this.context=d;for(var s=this.boundPaintVertexBuffers.length!==i.length,p=0;!s&&p<i.length;p++)this.boundPaintVertexBuffers[p]!==i[p]&&(s=!0);d.extVertexArrayObject&&this.vao&&this.boundProgram===t&&this.boundLayoutVertexBuffer===e&&!s&&this.boundIndexBuffer===o&&this.boundVertexOffset===r&&this.boundDynamicVertexBuffer===a&&this.boundDynamicVertexBuffer2===n?(d.bindVertexArrayOES.set(this.vao),a&&a.bind(),o&&o.dynamicDraw&&o.bind(),n&&n.bind()):this.freshBind(t,e,i,o,r,a,n)},tr.prototype.freshBind=function(g,t,e,i,o,r,a){var n=g.numAttributes,l=this.context,c=l.gl,u;if(l.extVertexArrayObject)this.vao&&this.destroy(),this.vao=l.extVertexArrayObject.createVertexArrayOES(),l.bindVertexArrayOES.set(this.vao),u=0,this.boundProgram=g,this.boundLayoutVertexBuffer=t,this.boundPaintVertexBuffers=e,this.boundIndexBuffer=i,this.boundVertexOffset=o,this.boundDynamicVertexBuffer=r,this.boundDynamicVertexBuffer2=a;else{u=l.currentNumAttributes||0;for(var y=n;y<u;y++)c.disableVertexAttribArray(y)}t.enableAttributes(c,g);for(var x=0,b=e;x<b.length;x+=1)b[x].enableAttributes(c,g);r&&r.enableAttributes(c,g),a&&a.enableAttributes(c,g),t.bind(),t.setVertexAttribPointers(c,g,o);for(var d=0,v=e,f;d<v.length;d+=1)f=v[d],f.bind(),f.setVertexAttribPointers(c,g,o);r&&(r.bind(),r.setVertexAttribPointers(c,g,o)),i&&i.bind(),a&&(a.bind(),a.setVertexAttribPointers(c,g,o)),l.currentNumAttributes=n},tr.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var rr=function(y,t,e,i,o){var r=y.gl;this.program=r.createProgram();var a=e?e.defines():[];o&&a.push("#define OVERDRAW_INSPECTOR;");var n=a.concat(Ve.fragmentSource,t.fragmentSource).join("\n"),s=a.concat(Ve.vertexSource,t.vertexSource).join("\n"),l=r.createShader(r.FRAGMENT_SHADER);if(r.isContextLost())this.failedToCreate=!0;else{r.shaderSource(l,n),r.compileShader(l),r.attachShader(this.program,l);var c=r.createShader(r.VERTEX_SHADER);if(r.isContextLost())this.failedToCreate=!0;else{r.shaderSource(c,s),r.compileShader(c),r.attachShader(this.program,c);for(var u=e?e.layoutAttributes:[],h=0;h<u.length;h++)r.bindAttribLocation(this.program,h,u[h].name);r.linkProgram(this.program),r.deleteShader(c),r.deleteShader(l),this.numAttributes=r.getProgramParameter(this.program,r.ACTIVE_ATTRIBUTES),this.attributes={};for(var x={},d=0,b;d<this.numAttributes;d++)b=r.getActiveAttrib(this.program,d),b&&(this.attributes[b.name]=r.getAttribLocation(this.program,b.name));for(var w=r.getProgramParameter(this.program,r.ACTIVE_UNIFORMS),m=0,k;m<w;m++)k=r.getActiveUniform(this.program,m),k&&(x[k.name]=r.getUniformLocation(this.program,k.name));this.fixedUniforms=i(y,x),this.binderUniforms=e?e.getUniforms(y,x):[]}}};rr.prototype.draw=function(k,t,e,i,o,r,a,n,s,l,c,u,h,p,d,_){var f=k.gl,g;if(!this.failedToCreate){for(var A in k.program.set(this.program),k.setDepthMode(e),k.setStencilMode(i),k.setColorMode(o),k.setCullFace(r),this.fixedUniforms)this.fixedUniforms[A].set(a[A]);p&&p.setUniforms(k,this.binderUniforms,u,{zoom:h});for(var v=(g={},g[f.LINES]=2,g[f.TRIANGLES]=3,g[f.LINE_STRIP]=1,g)[t],y=0,S=c.get();y<S.length;y+=1){var b=S[y],w=b.vaos||(b.vaos={});(w[n]||(w[n]=new tr)).bind(k,this,s,p?p.getPaintVertexBuffers():[],l,b.vertexOffset,d,_),f.drawElements(t,b.primitiveLength*v,f.UNSIGNED_SHORT,2*(b.primitiveOffset*v))}}};var _r=function(t,e,i,o){var r=e.style.light,a=r.properties.get("position"),n=[a.x,a.y,a.z],s=ea.create$1();"viewport"===r.properties.get("anchor")&&ea.fromRotation(s,-e.transform.angle),ea.transformMat3(n,n,s);var l=r.properties.get("color");return{u_matrix:t,u_lightpos:n,u_lightintensity:r.properties.get("intensity"),u_lightcolor:[l.r,l.g,l.b],u_vertical_gradient:+i,u_opacity:o}},Ar=function(t,e,i,o,r,a,n){return ea.extend(_r(t,e,i,o),Qt(a,e,n),{u_height_factor:-pa(2,r.overscaledZ)/n.tileSize/8})},Pr=function(e){return{u_matrix:e}},Dr=function(t,e,a,o){return ea.extend(Pr(t),Qt(a,e,o))},jr=function(a,t){return{u_matrix:a,u_world:t}},Hr=function(t,e,i,o,r){return ea.extend(Dr(t,e,i,o),{u_world:r})},Yr=function(t,e,i,o){var r=t.transform,s,d;if("map"===o.paint.get("circle-pitch-alignment")){var c=ue(i,1,r.zoom);s=!0,d=[c,c]}else s=!1,d=r.pixelsToGLUnits;return{u_camera_to_center_distance:r.cameraToCenterDistance,u_scale_with_map:+("map"===o.paint.get("circle-pitch-scale")),u_matrix:t.translatePosMatrix(e.posMatrix,i,o.paint.get("circle-translate"),o.paint.get("circle-translate-anchor")),u_pitch_with_map:+s,u_device_pixel_ratio:ea.browser.devicePixelRatio,u_extrude_scale:d}},Xr=function(n,t,e){var i=ue(e,1,t.zoom),o=pa(2,t.zoom-e.tileID.overscaledZ),r=e.tileID.overscaleFactor();return{u_matrix:n,u_camera_to_center_distance:t.cameraToCenterDistance,u_pixels_to_tile_units:i,u_extrude_scale:[t.pixelsToGLUnits[0]/(i*o),t.pixelsToGLUnits[1]/(i*o)],u_overscale_factor:r}},Zr=function(a,t,e){return{u_matrix:a,u_inv_matrix:t,u_camera_to_center_distance:e.cameraToCenterDistance,u_viewport_size:[e.width,e.height]}},Kr=function(a,t,e){return void 0===e&&(e=1),{u_matrix:a,u_color:t,u_overlay:0,u_overlay_scale:e}},$r=function(e){return{u_matrix:e}},Jr=function(a,t,e,r){return{u_matrix:a,u_extrude_scale:ue(t,1,e),u_intensity:r}},Qr=function(t,e,a){var o=t.transform;return{u_matrix:aa(t,e,a),u_ratio:1/ue(e,1,o.zoom),u_device_pixel_ratio:ea.browser.devicePixelRatio,u_units_to_pixels:[1/o.pixelsToGLUnits[0],1/o.pixelsToGLUnits[1]]}},ei=function(t,e,a){return ea.extend(Qr(t,e,a),{u_image:0})},ti=function(t,e,i,o){var r=t.transform,a=ta(e,r);return{u_matrix:aa(t,e,i),u_texsize:e.imageAtlasTexture.size,u_ratio:1/ue(e,1,r.zoom),u_device_pixel_ratio:ea.browser.devicePixelRatio,u_image:0,u_scale:[a,o.fromScale,o.toScale],u_fade:o.t,u_units_to_pixels:[1/r.pixelsToGLUnits[0],1/r.pixelsToGLUnits[1]]}},ai=function(t,e,i,o,r){var a=t.lineAtlas,n=ta(e,t.transform),s="round"===i.layout.get("line-cap"),l=a.getDash(o.from,s),d=a.getDash(o.to,s),c=l.width*r.fromScale,u=d.width*r.toScale;return ea.extend(Qr(t,e,i),{u_patternscale_a:[n/c,-l.height/2],u_patternscale_b:[n/u,-d.height/2],u_sdfgamma:a.width/(256*Rt(c,u)*ea.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:l.y,u_tex_y_b:d.y,u_mix:r.t})},oi=function(l,t,e,i,o){return{u_matrix:l,u_tl_parent:t,u_scale_parent:e,u_buffer_scale:1,u_fade_t:i.mix,u_opacity:i.opacity*o.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:o.paint.get("raster-brightness-min"),u_brightness_high:o.paint.get("raster-brightness-max"),u_saturation_factor:(s=o.paint.get("raster-saturation"),0<s?1-1/(1.001-s):-s),u_contrast_factor:(r=o.paint.get("raster-contrast"),0<r?1/(1-r):1+r),u_spin_weights:oa(o.paint.get("raster-hue-rotate"))};var r,s},ri=function(d,t,e,i,o,r,a,n,s,l){var c=o.transform;return{u_is_size_zoom_constant:+("constant"===d||"source"===d),u_is_size_feature_constant:+("constant"===d||"camera"===d),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:c.cameraToCenterDistance,u_pitch:2*(c.pitch/360)*Ke,u_rotate_symbol:+e,u_aspect_ratio:c.width/c.height,u_fade_change:o.options.fadeDuration?o.symbolFadeChange:1,u_matrix:r,u_label_plane_matrix:a,u_coord_matrix:n,u_is_text:+s,u_pitch_with_map:+i,u_texsize:l,u_texture:0}},ii=function(t,e,i,o,r,a,n,s,l,d,c){var u=r.transform;return ea.extend(ri(t,e,i,o,r,a,n,s,l,d),{u_gamma_scale:o?Ge(u._pitch)*u.cameraToCenterDistance:1,u_device_pixel_ratio:ea.browser.devicePixelRatio,u_is_halo:+c})},ni=function(t,e,i,o,r,a,n,s,l,d){return ea.extend(ii(t,e,i,o,r,a,n,s,!0,l,!0),{u_texsize_icon:d,u_texture_icon:1})},li=function(a,t,e){return{u_matrix:a,u_opacity:t,u_color:e}},si=function(t,e,i,o,r,a){return ea.extend(function(d,t,e,i){var o=e.imageManager.getPattern(d.from.toString()),r=e.imageManager.getPattern(d.to.toString()),a=e.imageManager.getPixelSize(),n=a.width,s=a.height,l=pa(2,i.tileID.overscaledZ),c=i.tileSize*pa(2,e.transform.tileZoom)/l,u=c*(i.tileID.canonical.x+i.tileID.wrap*l),g=c*i.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:o.tl,u_pattern_br_a:o.br,u_pattern_tl_b:r.tl,u_pattern_br_b:r.br,u_texsize:[n,s],u_mix:t.t,u_pattern_size_a:o.displaySize,u_pattern_size_b:r.displaySize,u_scale_a:t.fromScale,u_scale_b:t.toScale,u_tile_units_to_pixels:1/ue(i,1,e.transform.tileZoom),u_pixel_coord_upper:[u>>16,g>>16],u_pixel_coord_lower:[65535&u,65535&g]}}(o,a,i,r),{u_matrix:t,u_opacity:e})},di={fillExtrusion:function(t,e){return{u_matrix:new ea.UniformMatrix4f(t,e.u_matrix),u_lightpos:new ea.Uniform3f(t,e.u_lightpos),u_lightintensity:new ea.Uniform1f(t,e.u_lightintensity),u_lightcolor:new ea.Uniform3f(t,e.u_lightcolor),u_vertical_gradient:new ea.Uniform1f(t,e.u_vertical_gradient),u_opacity:new ea.Uniform1f(t,e.u_opacity)}},fillExtrusionPattern:function(t,e){return{u_matrix:new ea.UniformMatrix4f(t,e.u_matrix),u_lightpos:new ea.Uniform3f(t,e.u_lightpos),u_lightintensity:new ea.Uniform1f(t,e.u_lightintensity),u_lightcolor:new ea.Uniform3f(t,e.u_lightcolor),u_vertical_gradient:new ea.Uniform1f(t,e.u_vertical_gradient),u_height_factor:new ea.Uniform1f(t,e.u_height_factor),u_image:new ea.Uniform1i(t,e.u_image),u_texsize:new ea.Uniform2f(t,e.u_texsize),u_pixel_coord_upper:new ea.Uniform2f(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new ea.Uniform2f(t,e.u_pixel_coord_lower),u_scale:new ea.Uniform3f(t,e.u_scale),u_fade:new ea.Uniform1f(t,e.u_fade),u_opacity:new ea.Uniform1f(t,e.u_opacity)}},fill:function(t,e){return{u_matrix:new ea.UniformMatrix4f(t,e.u_matrix)}},fillPattern:function(t,e){return{u_matrix:new ea.UniformMatrix4f(t,e.u_matrix),u_image:new ea.Uniform1i(t,e.u_image),u_texsize:new ea.Uniform2f(t,e.u_texsize),u_pixel_coord_upper:new ea.Uniform2f(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new ea.Uniform2f(t,e.u_pixel_coord_lower),u_scale:new ea.Uniform3f(t,e.u_scale),u_fade:new ea.Uniform1f(t,e.u_fade)}},fillOutline:function(t,e){return{u_matrix:new ea.UniformMatrix4f(t,e.u_matrix),u_world:new ea.Uniform2f(t,e.u_world)}},fillOutlinePattern:function(t,e){return{u_matrix:new ea.UniformMatrix4f(t,e.u_matrix),u_world:new ea.Uniform2f(t,e.u_world),u_image:new ea.Uniform1i(t,e.u_image),u_texsize:new ea.Uniform2f(t,e.u_texsize),u_pixel_coord_upper:new ea.Uniform2f(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new ea.Uniform2f(t,e.u_pixel_coord_lower),u_scale:new ea.Uniform3f(t,e.u_scale),u_fade:new ea.Uniform1f(t,e.u_fade)}},circle:function(t,e){return{u_camera_to_center_distance:new ea.Uniform1f(t,e.u_camera_to_center_distance),u_scale_with_map:new ea.Uniform1i(t,e.u_scale_with_map),u_pitch_with_map:new ea.Uniform1i(t,e.u_pitch_with_map),u_extrude_scale:new ea.Uniform2f(t,e.u_extrude_scale),u_device_pixel_ratio:new ea.Uniform1f(t,e.u_device_pixel_ratio),u_matrix:new ea.UniformMatrix4f(t,e.u_matrix)}},collisionBox:function(t,e){return{u_matrix:new ea.UniformMatrix4f(t,e.u_matrix),u_camera_to_center_distance:new ea.Uniform1f(t,e.u_camera_to_center_distance),u_pixels_to_tile_units:new ea.Uniform1f(t,e.u_pixels_to_tile_units),u_extrude_scale:new ea.Uniform2f(t,e.u_extrude_scale),u_overscale_factor:new ea.Uniform1f(t,e.u_overscale_factor)}},collisionCircle:function(t,e){return{u_matrix:new ea.UniformMatrix4f(t,e.u_matrix),u_inv_matrix:new ea.UniformMatrix4f(t,e.u_inv_matrix),u_camera_to_center_distance:new ea.Uniform1f(t,e.u_camera_to_center_distance),u_viewport_size:new ea.Uniform2f(t,e.u_viewport_size)}},debug:function(t,e){return{u_color:new ea.UniformColor(t,e.u_color),u_matrix:new ea.UniformMatrix4f(t,e.u_matrix),u_overlay:new ea.Uniform1i(t,e.u_overlay),u_overlay_scale:new ea.Uniform1f(t,e.u_overlay_scale)}},clippingMask:function(t,e){return{u_matrix:new ea.UniformMatrix4f(t,e.u_matrix)}},heatmap:function(t,e){return{u_extrude_scale:new ea.Uniform1f(t,e.u_extrude_scale),u_intensity:new ea.Uniform1f(t,e.u_intensity),u_matrix:new ea.UniformMatrix4f(t,e.u_matrix)}},heatmapTexture:function(t,e){return{u_matrix:new ea.UniformMatrix4f(t,e.u_matrix),u_world:new ea.Uniform2f(t,e.u_world),u_image:new ea.Uniform1i(t,e.u_image),u_color_ramp:new ea.Uniform1i(t,e.u_color_ramp),u_opacity:new ea.Uniform1f(t,e.u_opacity)}},hillshade:function(t,e){return{u_matrix:new ea.UniformMatrix4f(t,e.u_matrix),u_image:new ea.Uniform1i(t,e.u_image),u_latrange:new ea.Uniform2f(t,e.u_latrange),u_light:new ea.Uniform2f(t,e.u_light),u_shadow:new ea.UniformColor(t,e.u_shadow),u_highlight:new ea.UniformColor(t,e.u_highlight),u_accent:new ea.UniformColor(t,e.u_accent)}},hillshadePrepare:function(t,e){return{u_matrix:new ea.UniformMatrix4f(t,e.u_matrix),u_image:new ea.Uniform1i(t,e.u_image),u_dimension:new ea.Uniform2f(t,e.u_dimension),u_zoom:new ea.Uniform1f(t,e.u_zoom),u_maxzoom:new ea.Uniform1f(t,e.u_maxzoom),u_unpack:new ea.Uniform4f(t,e.u_unpack)}},line:function(t,e){return{u_matrix:new ea.UniformMatrix4f(t,e.u_matrix),u_ratio:new ea.Uniform1f(t,e.u_ratio),u_device_pixel_ratio:new ea.Uniform1f(t,e.u_device_pixel_ratio),u_units_to_pixels:new ea.Uniform2f(t,e.u_units_to_pixels)}},lineGradient:function(t,e){return{u_matrix:new ea.UniformMatrix4f(t,e.u_matrix),u_ratio:new ea.Uniform1f(t,e.u_ratio),u_device_pixel_ratio:new ea.Uniform1f(t,e.u_device_pixel_ratio),u_units_to_pixels:new ea.Uniform2f(t,e.u_units_to_pixels),u_image:new ea.Uniform1i(t,e.u_image)}},linePattern:function(t,e){return{u_matrix:new ea.UniformMatrix4f(t,e.u_matrix),u_texsize:new ea.Uniform2f(t,e.u_texsize),u_ratio:new ea.Uniform1f(t,e.u_ratio),u_device_pixel_ratio:new ea.Uniform1f(t,e.u_device_pixel_ratio),u_image:new ea.Uniform1i(t,e.u_image),u_units_to_pixels:new ea.Uniform2f(t,e.u_units_to_pixels),u_scale:new ea.Uniform3f(t,e.u_scale),u_fade:new ea.Uniform1f(t,e.u_fade)}},lineSDF:function(t,e){return{u_matrix:new ea.UniformMatrix4f(t,e.u_matrix),u_ratio:new ea.Uniform1f(t,e.u_ratio),u_device_pixel_ratio:new ea.Uniform1f(t,e.u_device_pixel_ratio),u_units_to_pixels:new ea.Uniform2f(t,e.u_units_to_pixels),u_patternscale_a:new ea.Uniform2f(t,e.u_patternscale_a),u_patternscale_b:new ea.Uniform2f(t,e.u_patternscale_b),u_sdfgamma:new ea.Uniform1f(t,e.u_sdfgamma),u_image:new ea.Uniform1i(t,e.u_image),u_tex_y_a:new ea.Uniform1f(t,e.u_tex_y_a),u_tex_y_b:new ea.Uniform1f(t,e.u_tex_y_b),u_mix:new ea.Uniform1f(t,e.u_mix)}},raster:function(t,e){return{u_matrix:new ea.UniformMatrix4f(t,e.u_matrix),u_tl_parent:new ea.Uniform2f(t,e.u_tl_parent),u_scale_parent:new ea.Uniform1f(t,e.u_scale_parent),u_buffer_scale:new ea.Uniform1f(t,e.u_buffer_scale),u_fade_t:new ea.Uniform1f(t,e.u_fade_t),u_opacity:new ea.Uniform1f(t,e.u_opacity),u_image0:new ea.Uniform1i(t,e.u_image0),u_image1:new ea.Uniform1i(t,e.u_image1),u_brightness_low:new ea.Uniform1f(t,e.u_brightness_low),u_brightness_high:new ea.Uniform1f(t,e.u_brightness_high),u_saturation_factor:new ea.Uniform1f(t,e.u_saturation_factor),u_contrast_factor:new ea.Uniform1f(t,e.u_contrast_factor),u_spin_weights:new ea.Uniform3f(t,e.u_spin_weights)}},symbolIcon:function(t,e){return{u_is_size_zoom_constant:new ea.Uniform1i(t,e.u_is_size_zoom_constant),u_is_size_feature_constant:new ea.Uniform1i(t,e.u_is_size_feature_constant),u_size_t:new ea.Uniform1f(t,e.u_size_t),u_size:new ea.Uniform1f(t,e.u_size),u_camera_to_center_distance:new ea.Uniform1f(t,e.u_camera_to_center_distance),u_pitch:new ea.Uniform1f(t,e.u_pitch),u_rotate_symbol:new ea.Uniform1i(t,e.u_rotate_symbol),u_aspect_ratio:new ea.Uniform1f(t,e.u_aspect_ratio),u_fade_change:new ea.Uniform1f(t,e.u_fade_change),u_matrix:new ea.UniformMatrix4f(t,e.u_matrix),u_label_plane_matrix:new ea.UniformMatrix4f(t,e.u_label_plane_matrix),u_coord_matrix:new ea.UniformMatrix4f(t,e.u_coord_matrix),u_is_text:new ea.Uniform1i(t,e.u_is_text),u_pitch_with_map:new ea.Uniform1i(t,e.u_pitch_with_map),u_texsize:new ea.Uniform2f(t,e.u_texsize),u_texture:new ea.Uniform1i(t,e.u_texture)}},symbolSDF:function(t,e){return{u_is_size_zoom_constant:new ea.Uniform1i(t,e.u_is_size_zoom_constant),u_is_size_feature_constant:new ea.Uniform1i(t,e.u_is_size_feature_constant),u_size_t:new ea.Uniform1f(t,e.u_size_t),u_size:new ea.Uniform1f(t,e.u_size),u_camera_to_center_distance:new ea.Uniform1f(t,e.u_camera_to_center_distance),u_pitch:new ea.Uniform1f(t,e.u_pitch),u_rotate_symbol:new ea.Uniform1i(t,e.u_rotate_symbol),u_aspect_ratio:new ea.Uniform1f(t,e.u_aspect_ratio),u_fade_change:new ea.Uniform1f(t,e.u_fade_change),u_matrix:new ea.UniformMatrix4f(t,e.u_matrix),u_label_plane_matrix:new ea.UniformMatrix4f(t,e.u_label_plane_matrix),u_coord_matrix:new ea.UniformMatrix4f(t,e.u_coord_matrix),u_is_text:new ea.Uniform1i(t,e.u_is_text),u_pitch_with_map:new ea.Uniform1i(t,e.u_pitch_with_map),u_texsize:new ea.Uniform2f(t,e.u_texsize),u_texture:new ea.Uniform1i(t,e.u_texture),u_gamma_scale:new ea.Uniform1f(t,e.u_gamma_scale),u_device_pixel_ratio:new ea.Uniform1f(t,e.u_device_pixel_ratio),u_is_halo:new ea.Uniform1i(t,e.u_is_halo)}},symbolTextAndIcon:function(t,e){return{u_is_size_zoom_constant:new ea.Uniform1i(t,e.u_is_size_zoom_constant),u_is_size_feature_constant:new ea.Uniform1i(t,e.u_is_size_feature_constant),u_size_t:new ea.Uniform1f(t,e.u_size_t),u_size:new ea.Uniform1f(t,e.u_size),u_camera_to_center_distance:new ea.Uniform1f(t,e.u_camera_to_center_distance),u_pitch:new ea.Uniform1f(t,e.u_pitch),u_rotate_symbol:new ea.Uniform1i(t,e.u_rotate_symbol),u_aspect_ratio:new ea.Uniform1f(t,e.u_aspect_ratio),u_fade_change:new ea.Uniform1f(t,e.u_fade_change),u_matrix:new ea.UniformMatrix4f(t,e.u_matrix),u_label_plane_matrix:new ea.UniformMatrix4f(t,e.u_label_plane_matrix),u_coord_matrix:new ea.UniformMatrix4f(t,e.u_coord_matrix),u_is_text:new ea.Uniform1i(t,e.u_is_text),u_pitch_with_map:new ea.Uniform1i(t,e.u_pitch_with_map),u_texsize:new ea.Uniform2f(t,e.u_texsize),u_texsize_icon:new ea.Uniform2f(t,e.u_texsize_icon),u_texture:new ea.Uniform1i(t,e.u_texture),u_texture_icon:new ea.Uniform1i(t,e.u_texture_icon),u_gamma_scale:new ea.Uniform1f(t,e.u_gamma_scale),u_device_pixel_ratio:new ea.Uniform1f(t,e.u_device_pixel_ratio),u_is_halo:new ea.Uniform1i(t,e.u_is_halo)}},background:function(t,e){return{u_matrix:new ea.UniformMatrix4f(t,e.u_matrix),u_opacity:new ea.Uniform1f(t,e.u_opacity),u_color:new ea.UniformColor(t,e.u_color)}},backgroundPattern:function(t,e){return{u_matrix:new ea.UniformMatrix4f(t,e.u_matrix),u_opacity:new ea.Uniform1f(t,e.u_opacity),u_image:new ea.Uniform1i(t,e.u_image),u_pattern_tl_a:new ea.Uniform2f(t,e.u_pattern_tl_a),u_pattern_br_a:new ea.Uniform2f(t,e.u_pattern_br_a),u_pattern_tl_b:new ea.Uniform2f(t,e.u_pattern_tl_b),u_pattern_br_b:new ea.Uniform2f(t,e.u_pattern_br_b),u_texsize:new ea.Uniform2f(t,e.u_texsize),u_mix:new ea.Uniform1f(t,e.u_mix),u_pattern_size_a:new ea.Uniform2f(t,e.u_pattern_size_a),u_pattern_size_b:new ea.Uniform2f(t,e.u_pattern_size_b),u_scale_a:new ea.Uniform1f(t,e.u_scale_a),u_scale_b:new ea.Uniform1f(t,e.u_scale_b),u_pixel_coord_upper:new ea.Uniform2f(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new ea.Uniform2f(t,e.u_pixel_coord_lower),u_tile_units_to_pixels:new ea.Uniform1f(t,e.u_tile_units_to_pixels)}}},ci=ea.identity(new Float32Array(16)),pi=new ea.Color(1,0,0,1),so=new ea.Color(0,1,0,1),lo=new ea.Color(0,0,1,1),co=new ea.Color(1,0,1,1),uo=new ea.Color(0,1,1,1),ho={symbol:function(t,e,i,o,r){if("translucent"===t.renderPass){var a=It.disabled,n=t.colorModeForRenderPass();i.layout.get("text-variable-anchor")&&function(t,e,i,o,r,a,n){for(var s=e.transform,l="map"===r,c="map"===a,u=0,b=t;u<b.length;u+=1){var p=b[u],d=o.getTile(p),_=d.getBucket(i);if(_&&_.text&&_.text.segments.get().length){var f=ea.evaluateSizeForZoom(_.textSizeData,s.zoom),m=ue(d,1,e.transform.zoom),g=Ht(p.posMatrix,c,l,e.transform,m),v="none"!==i.layout.get("icon-text-fit")&&_.hasIconData();if(f){var y=pa(2,s.zoom-d.tileID.overscaledZ);na(_,l,c,n,ea.symbolSize,s,g,p.posMatrix,y,f,v)}}}}(o,t,i,e,i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),r),0!==i.paint.get("icon-opacity").constantOr(1)&&sa(t,e,i,o,!1,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),i.layout.get("icon-rotation-alignment"),i.layout.get("icon-pitch-alignment"),i.layout.get("icon-keep-upright"),a,n),0!==i.paint.get("text-opacity").constantOr(1)&&sa(t,e,i,o,!0,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),i.layout.get("text-keep-upright"),a,n),e.map.showCollisionBoxes&&(ra(t,e,i,o,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),!0),ra(t,e,i,o,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),!1))}},circle:function(t,e,i,o){if("translucent"===t.renderPass){var r=i.paint.get("circle-opacity"),a=i.paint.get("circle-stroke-width"),n=i.paint.get("circle-stroke-opacity"),s=void 0!==i.layout.get("circle-sort-key").constantOr(1);if(0!==r.constantOr(1)||0!==a.constantOr(1)&&0!==n.constantOr(1)){for(var l=t.context,c=l.gl,u=t.depthModeForSublayer(0,Et.ReadOnly),h=It.disabled,p=t.colorModeForRenderPass(),d=[],_=0;_<o.length;_++){var k=o[_],m=e.getTile(k),g=m.getBucket(i);if(g){var v=g.programConfigurations.get(i.id),y={programConfiguration:v,program:t.useProgram("circle",v),layoutVertexBuffer:g.layoutVertexBuffer,indexBuffer:g.indexBuffer,uniformValues:Yr(t,k,m,i)};if(s)for(var x=0,A=g.segments.get(),w;x<A.length;x+=1)w=A[x],d.push({segments:new ea.SegmentVector([w]),sortKey:w.sortKey,state:y});else d.push({segments:g.segments,sortKey:0,state:y})}}s&&d.sort(function(a,t){return a.sortKey-t.sortKey});for(var C=0,L=d;C<L.length;C+=1){var I=L[C],P=I.state;P.program.draw(l,c.TRIANGLES,u,h,p,St.disabled,P.uniformValues,i.id,P.layoutVertexBuffer,P.indexBuffer,I.segments,i.paint,t.transform.zoom,P.programConfiguration)}}}},heatmap:function(t,e,i,o){if(0!==i.paint.get("heatmap-opacity"))if("offscreen"===t.renderPass){var r=t.context,a=r.gl,n=It.disabled,s=new Pt([a.ONE,a.ONE],ea.Color.transparent,[!0,!0,!0,!0]);!function(n,t,e){var i=n.gl;n.activeTexture.set(i.TEXTURE1),n.viewport.set([0,0,t.width/4,t.height/4]);var o=e.heatmapFbo;if(o)i.bindTexture(i.TEXTURE_2D,o.colorAttachment.get()),n.bindFramebuffer.set(o.framebuffer);else{var l=i.createTexture();i.bindTexture(i.TEXTURE_2D,l),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),o=e.heatmapFbo=n.createFramebuffer(t.width/4,t.height/4,!1),function(a,t,e,i){var o=a.gl;o.texImage2D(o.TEXTURE_2D,0,o.RGBA,t.width/4,t.height/4,0,o.RGBA,a.extRenderToTextureHalfFloat?a.extTextureHalfFloat.HALF_FLOAT_OES:o.UNSIGNED_BYTE,null),i.colorAttachment.set(e)}(n,t,l,o)}}(r,t,i),r.clear({color:ea.Color.transparent});for(var l=0,g;l<o.length;l++)if(g=o[l],!e.hasRenderableParent(g)){var m=e.getTile(g),h=m.getBucket(i);if(h){var p=h.programConfigurations.get(i.id);t.useProgram("heatmap",p).draw(r,a.TRIANGLES,Et.disabled,n,s,St.disabled,Jr(g.posMatrix,m,t.transform.zoom,i.paint.get("heatmap-intensity")),i.id,h.layoutVertexBuffer,h.indexBuffer,h.segments,i.paint,t.transform.zoom,p)}}r.viewport.set([0,0,t.width,t.height])}else"translucent"===t.renderPass&&(t.context.setColorMode(t.colorModeForRenderPass()),function(t,e){var i=t.context,o=i.gl,r=e.heatmapFbo;if(r){i.activeTexture.set(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,r.colorAttachment.get()),i.activeTexture.set(o.TEXTURE1);var a=e.colorRampTexture;a||(a=e.colorRampTexture=new ea.Texture(i,e.colorRamp,o.RGBA)),a.bind(o.LINEAR,o.CLAMP_TO_EDGE),t.useProgram("heatmapTexture").draw(i,o.TRIANGLES,Et.disabled,It.disabled,t.colorModeForRenderPass(),St.disabled,function(t,e){var o=ea.create();ea.ortho(o,0,t.width,t.height,0,0,1);var a=t.context.gl;return{u_matrix:o,u_world:[a.drawingBufferWidth,a.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:e.paint.get("heatmap-opacity")}}(t,e),e.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments,e.paint,t.transform.zoom)}}(t,i))},line:function(t,e,i,o){if("translucent"===t.renderPass){var r=i.paint.get("line-opacity"),a=i.paint.get("line-width");if(0!==r.constantOr(1)&&0!==a.constantOr(1)){var n=t.depthModeForSublayer(0,Et.ReadOnly),s=t.colorModeForRenderPass(),l=i.paint.get("line-dasharray"),c=i.paint.get("line-pattern"),u=c.constantOr(1),h=i.paint.get("line-gradient"),p=i.getCrossfadeParameters(),d=u?"linePattern":l?"lineSDF":h?"lineGradient":"line",_=t.context,f=_.gl,m=!0;if(h){_.activeTexture.set(f.TEXTURE0);var k=i.gradientTexture;if(!i.gradient)return;k||(k=i.gradientTexture=new ea.Texture(_,i.gradient,f.RGBA)),k.bind(f.LINEAR,f.CLAMP_TO_EDGE)}for(var L=0,O=o;L<O.length;L+=1){var x=O[L],b=e.getTile(x);if(!u||b.patternsLoaded()){var w=b.getBucket(i);if(w){var T=w.programConfigurations.get(i.id),E=t.context.program.get(),I=t.useProgram(d,T),P=m||I.program!==E,S=c.constantOr(null);if(S&&b.imageAtlas){var C=b.imageAtlas,z=C.patternPositions[S.to.toString()],D=C.patternPositions[S.from.toString()];z&&D&&T.setConstantPatternPositions(z,D)}var R=u?ti(t,b,i,p):l?ai(t,b,i,l,p):h?ei(t,b,i):Qr(t,b,i);u?(_.activeTexture.set(f.TEXTURE0),b.imageAtlasTexture.bind(f.LINEAR,f.CLAMP_TO_EDGE),T.updatePaintBuffers(p)):l&&(P||t.lineAtlas.dirty)&&(_.activeTexture.set(f.TEXTURE0),t.lineAtlas.bind(_)),I.draw(_,f.TRIANGLES,n,t.stencilModeForClipping(x),s,St.disabled,R,i.id,w.layoutVertexBuffer,w.indexBuffer,w.segments,i.paint,t.transform.zoom,T),m=!1}}}}}},fill:function(t,e,i,o){var r=i.paint.get("fill-color"),a=i.paint.get("fill-opacity");if(0!==a.constantOr(1)){var n=t.colorModeForRenderPass(),s=i.paint.get("fill-pattern"),l=t.opaquePassEnabledForLayer()&&!s.constantOr(1)&&1===r.constantOr(ea.Color.transparent).a&&1===a.constantOr(0)?"opaque":"translucent";if(t.renderPass===l){var d=t.depthModeForSublayer(1,"opaque"===t.renderPass?Et.ReadWrite:Et.ReadOnly);ca(t,e,i,o,d,n,!1)}if("translucent"===t.renderPass&&i.paint.get("fill-antialias")){var c=t.depthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,Et.ReadOnly);ca(t,e,i,o,c,n,!0)}}},"fill-extrusion":function(l,t,e,i){var o=e.paint.get("fill-extrusion-opacity");if(0!==o&&"translucent"===l.renderPass){var r=new Et(l.context.gl.LEQUAL,Et.ReadWrite,l.depthRangeFor3D);if(1!==o||e.paint.get("fill-extrusion-pattern").constantOr(1))ga(l,t,e,i,r,It.disabled,Pt.disabled),ga(l,t,e,i,r,l.stencilModeFor3D(),l.colorModeForRenderPass());else{var a=l.colorModeForRenderPass();ga(l,t,e,i,r,It.disabled,a)}}},hillshade:function(g,t,e,i){if("offscreen"===g.renderPass||"translucent"===g.renderPass){for(var o=g.context,r=t.getSource().maxzoom,a=g.depthModeForSublayer(0,Et.ReadOnly),n=g.colorModeForRenderPass(),s="translucent"===g.renderPass?g.stencilConfigForOverlap(i):[{},i],l=s[0],c=0,m=s[1];c<m.length;c+=1){var h=m[c],p=t.getTile(h);p.needsHillshadePrepare&&"offscreen"===g.renderPass?xa(g,p,e,r,a,It.disabled,n):"translucent"===g.renderPass&&fa(g,p,e,a,l[h.overscaledZ],n)}o.viewport.set([0,0,g.width,g.height])}},raster:function(k,t,e,i){if("translucent"===k.renderPass&&0!==e.paint.get("raster-opacity")&&i.length)for(var o=k.context,r=o.gl,a=t.getSource(),n=k.useProgram("raster"),s=k.colorModeForRenderPass(),l=a instanceof M?[{},i]:k.stencilConfigForOverlap(i),c=l[0],u=l[1],h=u[u.length-1].overscaledZ,p=!k.options.moving,d=0,A=u;d<A.length;d+=1){var f=A[d],m=k.depthModeForSublayer(f.overscaledZ-h,1===e.paint.get("raster-opacity")?Et.ReadWrite:Et.ReadOnly,r.LESS),g=t.getTile(f),v=k.transform.calculatePosMatrix(f.toUnwrapped(),p);g.registerFadeDuration(e.paint.get("raster-fade-duration"));var y=t.findLoadedParent(f,0),x=_a(g,y,t,e,k.transform),b=void 0,S=void 0,C="nearest"===e.paint.get("raster-resampling")?r.NEAREST:r.LINEAR;o.activeTexture.set(r.TEXTURE0),g.texture.bind(C,r.CLAMP_TO_EDGE,r.LINEAR_MIPMAP_NEAREST),o.activeTexture.set(r.TEXTURE1),y?(y.texture.bind(C,r.CLAMP_TO_EDGE,r.LINEAR_MIPMAP_NEAREST),b=pa(2,y.tileID.overscaledZ-g.tileID.overscaledZ),S=[g.tileID.canonical.x*b%1,g.tileID.canonical.y*b%1]):g.texture.bind(C,r.CLAMP_TO_EDGE,r.LINEAR_MIPMAP_NEAREST);var L=oi(v,S||[0,0],b||1,x,e);a instanceof M?n.draw(o,r.TRIANGLES,m,It.disabled,s,St.disabled,L,e.id,a.boundsBuffer,k.quadTriangleIndexBuffer,a.boundsSegments):n.draw(o,r.TRIANGLES,m,c[f.overscaledZ],s,St.disabled,L,e.id,k.rasterBoundsBuffer,k.quadTriangleIndexBuffer,k.rasterBoundsSegments)}},background:function(w,t,e){var i=e.paint.get("background-color"),o=e.paint.get("background-opacity");if(0!==o){var r=w.context,a=r.gl,n=w.transform,s=n.tileSize,l=e.paint.get("background-pattern");if(!w.isPatternMissing(l)){var c=!l&&1===i.a&&1===o&&w.opaquePassEnabledForLayer()?"opaque":"translucent";if(w.renderPass===c){var u=It.disabled,h=w.depthModeForSublayer(0,"opaque"===c?Et.ReadWrite:Et.ReadOnly),p=w.colorModeForRenderPass(),d=w.useProgram(l?"backgroundPattern":"background"),_=n.coveringTiles({tileSize:s});l&&(r.activeTexture.set(a.TEXTURE0),w.imageManager.bind(w.context));for(var f=e.getCrossfadeParameters(),m=0,k=_;m<k.length;m+=1){var v=k[m],y=w.transform.calculatePosMatrix(v.toUnwrapped()),x=l?si(y,o,w,l,{tileID:v,tileSize:s},f):li(y,o,i);d.draw(r,a.TRIANGLES,h,u,p,St.disabled,x,e.id,w.tileExtentBuffer,w.quadTriangleIndexBuffer,w.tileExtentSegments)}}}}},debug:function(a,t,e){for(var r=0;r<e.length;r++)ka(a,t,e[r])},custom:function(l,t,e){var i=l.context,o=e.implementation;if("offscreen"===l.renderPass){var r=o.prerender;r&&(l.setCustomLayerDefaults(),i.setColorMode(l.colorModeForRenderPass()),r.call(o,i.gl,l.transform.customLayerMatrix()),i.setDirty(),l.setBaseState())}else if("translucent"===l.renderPass){l.setCustomLayerDefaults(),i.setColorMode(l.colorModeForRenderPass()),i.setStencilMode(It.disabled);var a="3d"===o.renderingMode?new Et(l.context.gl.LEQUAL,Et.ReadWrite,l.depthRangeFor3D):l.depthModeForSublayer(0,Et.ReadOnly);i.setDepthMode(a),o.render(i.gl,l.transform.customLayerMatrix()),i.setDirty(),l.setBaseState(),i.bindFramebuffer.set(null)}}},go=function(a,t){this.context=new Ct(a),this.transform=t,this._tileTextures={},this.setup(),this.numSublayers=zt.maxUnderzooming+zt.maxOverzooming+1,this.depthEpsilon=1/pa(2,16),this.crossTileSymbolIndex=new Oe,this.gpuTimers={}},vo;go.prototype.resize=function(t,e){if(this.width=t*ea.browser.devicePixelRatio,this.height=e*ea.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var a=0,i=this.style._order;a<i.length;a+=1)this.style._layers[i[a]].resize()},go.prototype.setup=function(){var t=this.context,e=new ea.StructArrayLayout2i4;e.emplaceBack(0,0),e.emplaceBack(ea.EXTENT,0),e.emplaceBack(0,ea.EXTENT),e.emplaceBack(ea.EXTENT,ea.EXTENT),this.tileExtentBuffer=t.createVertexBuffer(e,qe.members),this.tileExtentSegments=ea.SegmentVector.simpleSegment(0,0,4,2);var i=new ea.StructArrayLayout2i4;i.emplaceBack(0,0),i.emplaceBack(ea.EXTENT,0),i.emplaceBack(0,ea.EXTENT),i.emplaceBack(ea.EXTENT,ea.EXTENT),this.debugBuffer=t.createVertexBuffer(i,qe.members),this.debugSegments=ea.SegmentVector.simpleSegment(0,0,4,5);var o=new ea.StructArrayLayout4i8;o.emplaceBack(0,0,0,0),o.emplaceBack(ea.EXTENT,0,ea.EXTENT,0),o.emplaceBack(0,ea.EXTENT,0,ea.EXTENT),o.emplaceBack(ea.EXTENT,ea.EXTENT,ea.EXTENT,ea.EXTENT),this.rasterBoundsBuffer=t.createVertexBuffer(o,D.members),this.rasterBoundsSegments=ea.SegmentVector.simpleSegment(0,0,4,2);var r=new ea.StructArrayLayout2i4;r.emplaceBack(0,0),r.emplaceBack(1,0),r.emplaceBack(0,1),r.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(r,qe.members),this.viewportSegments=ea.SegmentVector.simpleSegment(0,0,4,2);var a=new ea.StructArrayLayout1ui2;a.emplaceBack(0),a.emplaceBack(1),a.emplaceBack(3),a.emplaceBack(2),a.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(a);var n=new ea.StructArrayLayout3ui6;n.emplaceBack(0,1,2),n.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(n),this.emptyTexture=new ea.Texture(t,{width:1,height:1,data:new Uint8Array([0,0,0,0])},t.gl.RGBA);var s=this.context.gl;this.stencilClearMode=new It({func:s.ALWAYS,mask:0},0,255,s.ZERO,s.ZERO,s.ZERO)},go.prototype.clearStencil=function(){var t=this.context,e=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var a=ea.create();ea.ortho(a,0,this.width,this.height,0,0,1),ea.scale(a,a,[e.drawingBufferWidth,e.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(t,e.TRIANGLES,Et.disabled,this.stencilClearMode,Pt.disabled,St.disabled,$r(a),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},go.prototype._renderTileClippingMasks=function(d,t){if(this.currentStencilSource!==d.source&&d.isTileClipped()&&t&&t.length){this.currentStencilSource=d.source;var e=this.context,i=e.gl;256<this.nextStencilID+t.length&&this.clearStencil(),e.setColorMode(Pt.disabled),e.setDepthMode(Et.disabled);var o=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var r=0,c=t;r<c.length;r+=1){var n=c[r],s=this._tileClippingMaskIDs[n.key]=this.nextStencilID++;o.draw(e,i.TRIANGLES,Et.disabled,new It({func:i.ALWAYS,mask:0},s,255,i.KEEP,i.KEEP,i.REPLACE),Pt.disabled,St.disabled,$r(n.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},go.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,256<this.nextStencilID+1&&this.clearStencil();var a=this.nextStencilID++,t=this.context.gl;return new It({func:t.NOTEQUAL,mask:255},a,255,t.KEEP,t.KEEP,t.REPLACE)},go.prototype.stencilModeForClipping=function(a){var t=this.context.gl;return new It({func:t.EQUAL,mask:255},this._tileClippingMaskIDs[a.key],0,t.KEEP,t.KEEP,t.REPLACE)},go.prototype.stencilConfigForOverlap=function(l){var t=this.context.gl,i=l.sort(function(a,t){return t.overscaledZ-a.overscaledZ}),o=i[i.length-1].overscaledZ,r=i[0].overscaledZ-o+1,a;if(1<r){this.currentStencilSource=void 0,256<this.nextStencilID+r&&this.clearStencil();for(var d={},n=0;n<r;n++)d[n+o]=new It({func:t.GEQUAL,mask:255},n+this.nextStencilID,255,t.KEEP,t.KEEP,t.REPLACE);return this.nextStencilID+=r,[d,i]}return[(a={},a[o]=It.disabled,a),i]},go.prototype.colorModeForRenderPass=function(){var t=this.context.gl;return this._showOverdrawInspector?new Pt([t.CONSTANT_COLOR,t.ONE],new ea.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?Pt.unblended:Pt.alphaBlended},go.prototype.depthModeForSublayer=function(a,t,e){if(!this.opaquePassEnabledForLayer())return Et.disabled;var r=1-((1+this.currentLayer)*this.numSublayers+a)*this.depthEpsilon;return new Et(e||this.context.gl.LEQUAL,t,[r,r])},go.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},go.prototype.render=function(t,e){var i=this;this.style=t,this.options=e,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(ea.browser.now()),this.imageManager.beginFrame();var o=this.style._order,r=this.style.sourceCaches;for(var a in r){var n=r[a];n.used&&n.prepare(this.context)}var s={},u={},h={},p,k;for(var A in r){var d=r[A];s[A]=d.getVisibleCoordinates(),u[A]=s[A].slice().reverse(),h[A]=d.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var _=0;_<o.length;_++)if(this.style._layers[o[_]].is3D()){this.opaquePassCutoff=_;break}this.renderPass="offscreen";for(var S=0,C=o,g;S<C.length;S+=1)if(g=this.style._layers[C[S]],g.hasOffscreenPass()&&!g.isHidden(this.transform.zoom)){var L=u[g.source];("custom"===g.type||L.length)&&this.renderLayer(this,r[g.source],g,L)}for(this.context.bindFramebuffer.set(null),this.context.clear({color:e.showOverdrawInspector?ea.Color.black:ea.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=e.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=o.length-1;0<=this.currentLayer;this.currentLayer--){var y=this.style._layers[o[this.currentLayer]],x=r[y.source],b=s[y.source];this._renderTileClippingMasks(y,b),this.renderLayer(this,x,y,b)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<o.length;this.currentLayer++){var w=this.style._layers[o[this.currentLayer]],T=r[w.source],E=("symbol"===w.type?h:u)[w.source];this._renderTileClippingMasks(w,s[w.source]),this.renderLayer(this,T,w,E)}this.options.showTileBoundaries&&(ea.values(this.style._layers).forEach(function(e){e.source&&!e.isHidden(i.transform.zoom)&&(e.source!==(k&&k.id)&&(k=i.style.sourceCaches[e.source]),(!p||p.getSource().maxzoom<k.getSource().maxzoom)&&(p=k))}),p&&ho.debug(this,p,p.getVisibleCoordinates())),this.options.showPadding&&function(a){var t=a.transform.padding;ba(a,a.transform.height-(t.top||0),3,pi),ba(a,t.bottom||0,3,so),va(a,t.left||0,3,lo),va(a,a.transform.width-(t.right||0),3,co);var e=a.transform.centerPoint;!function(a,t,e,r){wa(a,t-1,e-10,2,20,r),wa(a,t-10,e-1,20,2,r)}(a,e.x,a.transform.height-e.y,uo)}(this),this.context.setDefault()},go.prototype.renderLayer=function(a,t,e,r){e.isHidden(this.transform.zoom)||("background"===e.type||"custom"===e.type||r.length)&&(this.id=e.id,this.gpuTimingStart(e),ho[e.type](a,t,e,r,this.style.placement.variableOffsets),this.gpuTimingEnd())},go.prototype.gpuTimingStart=function(a){if(this.options.gpuTiming){var t=this.context.extTimerQuery,e=this.gpuTimers[a.id];e||(e=this.gpuTimers[a.id]={calls:0,cpuTime:0,query:t.createQueryEXT()}),e.calls++,t.beginQueryEXT(t.TIME_ELAPSED_EXT,e.query)}},go.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var e=this.context.extTimerQuery;e.endQueryEXT(e.TIME_ELAPSED_EXT)}},go.prototype.collectGpuTimers=function(){var e=this.gpuTimers;return this.gpuTimers={},e},go.prototype.queryGpuTimers=function(n){var t={};for(var e in n){var i=n[e],o=this.context.extTimerQuery,r=o.getQueryObjectEXT(i.query,o.QUERY_RESULT_EXT)/1e6;o.deleteQueryEXT(i.query),t[e]=r}return t},go.prototype.translatePosMatrix=function(t,e,i,d,r){if(!i[0]&&!i[1])return t;var a=r?"map"===d?this.transform.angle:0:"viewport"===d?-this.transform.angle:0;if(a){var n=Je(a),s=Ge(a);i=[i[0]*s-i[1]*n,i[0]*n+i[1]*s]}var l=[r?i[0]:ue(e,i[0],this.transform.zoom),r?i[1]:ue(e,i[1],this.transform.zoom),0],c=new Float32Array(16);return ea.translate(c,t,l),c},go.prototype.saveTileTexture=function(a){var t=this._tileTextures[a.size[0]];t?t.push(a):this._tileTextures[a.size[0]]=[a]},go.prototype.getTileTexture=function(a){var t=this._tileTextures[a];return t&&0<t.length?t.pop():null},go.prototype.isPatternMissing=function(a){if(!a)return!1;if(!a.from||!a.to)return!0;var t=this.imageManager.getPattern(a.from.toString()),e=this.imageManager.getPattern(a.to.toString());return!t||!e},go.prototype.useProgram=function(a,t){this.cache=this.cache||{};var e=""+a+(t?t.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[e]||(this.cache[e]=new rr(this.context,Qo[a],t,di[a],this._showOverdrawInspector)),this.cache[e]},go.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},go.prototype.setBaseState=function(){var e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)},go.prototype.initDebugOverlayCanvas=function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=ea.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new ea.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},go.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var ui=function(a,t){this.points=a,this.planes=t};ui.fromInvProjectionMatrix=function(t,l,e){var o=pa(2,e),s=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(e){return ea.transformMat4([],e,t)}).map(function(t){return ea.scale$1([],t,1/t[3]/l*o)}),a=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(t){var e=ea.sub([],s[t[0]],s[t[1]]),a=ea.sub([],s[t[2]],s[t[1]]),o=ea.normalize([],ea.cross([],e,a)),r=-ea.dot(o,s[t[1]]);return o.concat(r)});return new ui(s,a)};var yo=function(t,e){this.min=t,this.max=e,this.center=ea.scale$2([],ea.add([],this.min,this.max),.5)};yo.prototype.quadrant=function(t){for(var e=[0==t%2,2>t],i=ea.clone$2(this.min),o=ea.clone$2(this.max),r=0;r<e.length;r++)i[r]=e[r]?this.min[r]:this.center[r],o[r]=e[r]?this.center[r]:this.max[r];return o[2]=this.max[2],new yo(i,o)},yo.prototype.distanceX=function(e){return ha(Rt(this.max[0],e[0]),this.min[0])-e[0]},yo.prototype.distanceY=function(e){return ha(Rt(this.max[1],e[1]),this.min[1])-e[1]},yo.prototype.intersects=function(t){for(var e=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],i=!0,d=0;d<t.planes.length;d++){for(var g=t.planes[d],a=0,m=0;m<e.length;m++)a+=0<=ea.dot$1(g,e[m]);if(0===a)return 0;a!==e.length&&(i=!1)}if(i)return 2;for(var y=0;3>y;y++){for(var f=o,x=-o,_=0,b;_<t.points.length;_++)b=t.points[_][y]-this.min[y],f=Rt(f,b),x=ha(x,b);if(0>x||f>this.max[y]-this.min[y])return 0}return 1};var xo=function(a,r,n,l){if(void 0===a&&(a=0),void 0===r&&(r=0),void 0===n&&(n=0),void 0===l&&(l=0),isNaN(a)||0>a||isNaN(r)||0>r||isNaN(n)||0>n||isNaN(l)||0>l)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=a,this.bottom=r,this.left=n,this.right=l};xo.prototype.interpolate=function(t,e,a){return null!=e.top&&null!=t.top&&(this.top=ea.number(t.top,e.top,a)),null!=e.bottom&&null!=t.bottom&&(this.bottom=ea.number(t.bottom,e.bottom,a)),null!=e.left&&null!=t.left&&(this.left=ea.number(t.left,e.left,a)),null!=e.right&&null!=t.right&&(this.right=ea.number(t.right,e.right,a)),this},xo.prototype.getCenter=function(t,e){var a=ea.clamp((this.left+t-this.right)/2,0,t),o=ea.clamp((this.top+e-this.bottom)/2,0,e);return new ea.Point(a,o)},xo.prototype.equals=function(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right},xo.prototype.clone=function(){return new xo(this.top,this.bottom,this.left,this.right)},xo.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var bo=function(t,e,i,o,r){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===r||r,this._minZoom=t||0,this._maxZoom=e||22,this._minPitch=null==i?0:i,this._maxPitch=null==o?60:o,this.setMaxBounds(),this.width=0,this.height=0,this._center=new ea.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new xo,this._posMatrixCache={},this._alignedPosMatrixCache={}},wo={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};bo.prototype.clone=function(){var e=new bo(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return e.tileSize=this.tileSize,e.latRange=this.latRange,e.width=this.width,e.height=this.height,e._center=this._center,e.zoom=this.zoom,e.angle=this.angle,e._fov=this._fov,e._pitch=this._pitch,e._unmodified=this._unmodified,e._edgeInsets=this._edgeInsets.clone(),e._calcMatrices(),e},wo.minZoom.get=function(){return this._minZoom},wo.minZoom.set=function(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=ha(this.zoom,e))},wo.maxZoom.get=function(){return this._maxZoom},wo.maxZoom.set=function(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Rt(this.zoom,e))},wo.minPitch.get=function(){return this._minPitch},wo.minPitch.set=function(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=ha(this.pitch,e))},wo.maxPitch.get=function(){return this._maxPitch},wo.maxPitch.set=function(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Rt(this.pitch,e))},wo.renderWorldCopies.get=function(){return this._renderWorldCopies},wo.renderWorldCopies.set=function(e){void 0===e?e=!0:null===e&&(e=!1),this._renderWorldCopies=e},wo.worldSize.get=function(){return this.tileSize*this.scale},wo.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},wo.size.get=function(){return new ea.Point(this.width,this.height)},wo.bearing.get=function(){return 180*(-this.angle/Ke)},wo.bearing.set=function(t){var e=-ea.wrap(t,-180,180)*Ke/180;this.angle!==e&&(this._unmodified=!1,this.angle=e,this._calcMatrices(),this.rotationMatrix=ea.create$2(),ea.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},wo.pitch.get=function(){return 180*(this._pitch/Ke)},wo.pitch.set=function(t){var e=ea.clamp(t,this.minPitch,this.maxPitch)/180*Ke;this._pitch!==e&&(this._unmodified=!1,this._pitch=e,this._calcMatrices())},wo.fov.get=function(){return 180*(this._fov/Ke)},wo.fov.set=function(e){e=ha(.01,Rt(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=e/180*Ke,this._calcMatrices())},wo.zoom.get=function(){return this._zoom},wo.zoom.set=function(a){var t=Rt(ha(a,this.minZoom),this.maxZoom);this._zoom!==t&&(this._unmodified=!1,this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=ya(t),this.zoomFraction=t-this.tileZoom,this._constrain(),this._calcMatrices())},wo.center.get=function(){return this._center},wo.center.set=function(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())},wo.padding.get=function(){return this._edgeInsets.toJSON()},wo.padding.set=function(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())},wo.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},bo.prototype.isPaddingEqual=function(e){return this._edgeInsets.equals(e)},bo.prototype.interpolatePadding=function(a,t,e){this._unmodified=!1,this._edgeInsets.interpolate(a,t,e),this._constrain(),this._calcMatrices()},bo.prototype.coveringZoomLevel=function(a){var t=(a.roundZoom?Xe:ya)(this.zoom+this.scaleZoom(this.tileSize/a.tileSize));return ha(0,t)},bo.prototype.getVisibleUnwrappedCoordinates=function(t){var e=[new ea.UnwrappedTileID(0,t)];if(this._renderWorldCopies)for(var i=this.pointCoordinate(new ea.Point(0,0)),o=this.pointCoordinate(new ea.Point(this.width,0)),r=this.pointCoordinate(new ea.Point(this.width,this.height)),a=this.pointCoordinate(new ea.Point(0,this.height)),n=ya(Rt(i.x,o.x,r.x,a.x)),s=ya(ha(i.x,o.x,r.x,a.x)),l=n-1;l<=s+1;l++)0!=l&&e.push(new ea.UnwrappedTileID(l,t));return e},bo.prototype.coveringTiles=function(t){var e=this.coveringZoomLevel(t),k=e;if(void 0!==t.minzoom&&e<t.minzoom)return[];void 0!==t.maxzoom&&e>t.maxzoom&&(e=t.maxzoom);var o=ea.MercatorCoordinate.fromLngLat(this.center),r=pa(2,e),a=[r*o.x,r*o.y,0],n=ui.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,e),s=t.minzoom||0;60>=this.pitch&&.1>this._edgeInsets.top&&(s=e);var A=function(e){return{aabb:new yo([e*r,0,0],[(e+1)*r,r,0]),zoom:0,x:0,y:0,wrap:e,fullyVisible:!1}},c=[],u=[],h=e,p=t.reparseOverscaled?k:e;if(this._renderWorldCopies)for(var d=1;3>=d;d++)c.push(A(-d)),c.push(A(d));for(c.push(A(0));0<c.length;){var S=c.pop(),f=S.x,m=S.y,g=S.fullyVisible;if(!g){var C=S.aabb.intersects(n);if(0===C)continue;g=2===C}var y=S.aabb.distanceX(a),x=S.aabb.distanceY(a),b=ha(ma(y),ma(x));if(S.zoom===h||b>3+(1<<h-S.zoom)-2&&S.zoom>=s)u.push({tileID:new ea.OverscaledTileID(S.zoom===h?p:S.zoom,S.wrap,S.zoom,f,m),distanceSq:ea.sqrLen([a[0]-.5-f,a[1]-.5-m])});else for(var w=0;4>w;w++){var L=(f<<1)+w%2,E=(m<<1)+(w>>1);c.push({aabb:S.aabb.quadrant(w),zoom:S.zoom+1,x:L,y:E,wrap:S.wrap,fullyVisible:g})}}return u.sort(function(a,t){return a.distanceSq-t.distanceSq}).map(function(e){return e.tileID})},bo.prototype.resize=function(a,t){this.width=a,this.height=t,this.pixelsToGLUnits=[2/a,-2/t],this._constrain(),this._calcMatrices()},wo.unmodified.get=function(){return this._unmodified},bo.prototype.zoomScale=function(e){return pa(2,e)},bo.prototype.scaleZoom=function(e){return C(e)/T},bo.prototype.project=function(t){var e=ea.clamp(t.lat,-this.maxValidLatitude,this.maxValidLatitude);return new ea.Point(ea.mercatorXfromLng(t.lng)*this.worldSize,ea.mercatorYfromLat(e)*this.worldSize)},bo.prototype.unproject=function(t){return new ea.MercatorCoordinate(t.x/this.worldSize,t.y/this.worldSize).toLngLat()},wo.point.get=function(){return this.project(this.center)},bo.prototype.setLocationAtPoint=function(t,e){var i=this.pointCoordinate(e),o=this.pointCoordinate(this.centerPoint),r=this.locationCoordinate(t),a=new ea.MercatorCoordinate(r.x-(i.x-o.x),r.y-(i.y-o.y));this.center=this.coordinateLocation(a),this._renderWorldCopies&&(this.center=this.center.wrap())},bo.prototype.locationPoint=function(e){return this.coordinatePoint(this.locationCoordinate(e))},bo.prototype.pointLocation=function(e){return this.coordinateLocation(this.pointCoordinate(e))},bo.prototype.locationCoordinate=function(t){return ea.MercatorCoordinate.fromLngLat(t)},bo.prototype.coordinateLocation=function(e){return e.toLngLat()},bo.prototype.pointCoordinate=function(t){var e=[t.x,t.y,0,1],i=[t.x,t.y,1,1];ea.transformMat4(e,e,this.pixelMatrixInverse),ea.transformMat4(i,i,this.pixelMatrixInverse);var o=e[3],r=i[3],a=e[1]/o,n=i[1]/r,s=e[2]/o,l=i[2]/r,d=s==l?0:(0-s)/(l-s);return new ea.MercatorCoordinate(ea.number(e[0]/o,i[0]/r,d)/this.worldSize,ea.number(a,n,d)/this.worldSize)},bo.prototype.coordinatePoint=function(t){var e=[t.x*this.worldSize,t.y*this.worldSize,0,1];return ea.transformMat4(e,e,this.pixelMatrix),new ea.Point(e[0]/e[3],e[1]/e[3])},bo.prototype.getBounds=function(){return new ea.LngLatBounds().extend(this.pointLocation(new ea.Point(0,0))).extend(this.pointLocation(new ea.Point(this.width,0))).extend(this.pointLocation(new ea.Point(this.width,this.height))).extend(this.pointLocation(new ea.Point(0,this.height)))},bo.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new ea.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},bo.prototype.setMaxBounds=function(e){e?(this.lngRange=[e.getWest(),e.getEast()],this.latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},bo.prototype.calculatePosMatrix=function(t,e){void 0===e&&(e=!1);var d=t.key,o=e?this._alignedPosMatrixCache:this._posMatrixCache;if(o[d])return o[d];var r=t.canonical,a=this.worldSize/this.zoomScale(r.z),n=r.x+pa(2,r.z)*t.wrap,s=ea.identity(new Float64Array(16));return ea.translate(s,s,[n*a,r.y*a,0]),ea.scale(s,s,[a/ea.EXTENT,a/ea.EXTENT,1]),ea.multiply(s,e?this.alignedProjMatrix:this.projMatrix,s),o[d]=new Float32Array(s),o[d]},bo.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},bo.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var t=-90,y=90,x=-180,b=180,w=this.size,c=this._unmodified,u,k,T,A;if(this.latRange){var S=this.latRange;t=ea.mercatorYfromLat(S[1])*this.worldSize,u=(y=ea.mercatorYfromLat(S[0])*this.worldSize)-t<w.y?w.y/(y-t):0}if(this.lngRange){var h=this.lngRange;x=ea.mercatorXfromLng(h[0])*this.worldSize,k=(b=ea.mercatorXfromLng(h[1])*this.worldSize)-x<w.x?w.x/(b-x):0}var p=this.point,d=ha(k||0,u||0);if(d)return this.center=this.unproject(new ea.Point(k?(b+x)/2:p.x,u?(y+t)/2:p.y)),this.zoom+=this.scaleZoom(d),this._unmodified=c,void(this._constraining=!1);if(this.latRange){var _=p.y,f=w.y/2;_-f<t&&(A=t+f),_+f>y&&(A=y-f)}if(this.lngRange){var m=p.x,g=w.x/2;m-g<x&&(T=x+g),m+g>b&&(T=b-g)}void 0===T&&void 0===A||(this.center=this.unproject(new ea.Point(void 0===T?p.x:T,void 0===A?p.y:A))),this._unmodified=c,this._constraining=!1}},bo.prototype._calcMatrices=function(){if(this.height){var t=this.centerOffset;this.cameraToCenterDistance=.5/ua(this._fov/2)*this.height;var e=Ke/2+this._pitch,i=this._fov*(.5+t.y/this.height),o=Je(i)*this.cameraToCenterDistance/Je(ea.clamp(Ke-e-i,.01,Ke-.01)),r=this.point,a=r.x,n=r.y,s=1.01*(Ge(Ke/2-this._pitch)*o+this.cameraToCenterDistance),l=this.height/50,c=new Float64Array(16);ea.perspective(c,this._fov,this.width/this.height,l,s),c[8]=2*-t.x/this.width,c[9]=2*t.y/this.height,ea.scale(c,c,[1,-1,1]),ea.translate(c,c,[0,0,-this.cameraToCenterDistance]),ea.rotateX(c,c,this._pitch),ea.rotateZ(c,c,this.angle),ea.translate(c,c,[-a,-n,0]),this.mercatorMatrix=ea.scale([],c,[this.worldSize,this.worldSize,this.worldSize]),ea.scale(c,c,[1,1,ea.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=c,this.invProjMatrix=ea.invert([],this.projMatrix);var y=this.width%2/2,h=this.height%2/2,p=Ge(this.angle),d=Je(this.angle),x=a-Xe(a)+p*y+d*h,f=n-Xe(n)+p*h+d*y,m=new Float64Array(c);if(ea.translate(m,m,[.5<x?x-1:x,.5<f?f-1:f,0]),this.alignedProjMatrix=m,c=ea.create(),ea.scale(c,c,[this.width/2,-this.height/2,1]),ea.translate(c,c,[1,-1,0]),this.labelPlaneMatrix=c,c=ea.create(),ea.scale(c,c,[1,-1,1]),ea.translate(c,c,[-1,-1,0]),ea.scale(c,c,[2/this.width,2/this.height,1]),this.glCoordMatrix=c,this.pixelMatrix=ea.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(c=ea.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=c,this._posMatrixCache={},this._alignedPosMatrixCache={}}},bo.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var t=this.pointCoordinate(new ea.Point(0,0)),e=[t.x*this.worldSize,t.y*this.worldSize,0,1];return ea.transformMat4(e,e,this.pixelMatrix)[3]/this.cameraToCenterDistance},bo.prototype.getCameraPoint=function(){var t=ua(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new ea.Point(0,t))},bo.prototype.getCameraQueryGeometry=function(t){var e=this.getCameraPoint();if(1===t.length)return[t[0],e];for(var i=e.x,d=e.y,p=e.x,u=e.y,g=0,m=t,l;g<m.length;g+=1)l=m[g],i=Rt(i,l.x),d=Rt(d,l.y),p=ha(p,l.x),u=ha(u,l.y);return[new ea.Point(i,d),new ea.Point(p,d),new ea.Point(p,u),new ea.Point(i,u),new ea.Point(i,d)]},Object.defineProperties(bo.prototype,wo);var To=function(t){var e,n,l,s;this._hashName=t&&encodeURIComponent(t),ea.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(e=this._updateHashUnthrottled.bind(this),n=!1,l=null,s=function(){l=null,n&&(e(),l=setTimeout(s,300),n=!1)},function(){return n=!0,l||s(),l})};To.prototype.addTo=function(t){return this._map=t,ea.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},To.prototype.remove=function(){return ea.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},To.prototype.getHashString=function(t){var e=this._map.getCenter(),i=Xe(100*this._map.getZoom())/100,o=Ye((i*T+C(512/360/.5))/A),r=pa(10,o),a=Xe(e.lng*r)/r,n=Xe(e.lat*r)/r,s=this._map.getBearing(),l=this._map.getPitch(),c="";if(c+=t?"/"+a+"/"+n+"/"+i:i+"/"+n+"/"+a,(s||l)&&(c+="/"+Xe(10*s)/10),l&&(c+="/"+Xe(l)),this._hashName){var g=this._hashName,m=!1,h=ea.window.location.hash.slice(1).split("&").map(function(a){var t=a.split("=")[0];return t===g?(m=!0,t+"="+c):a}).filter(function(e){return e});return m||h.push(g+"="+c),"#"+h.join("&")}return"#"+c},To.prototype._getCurrentHash=function(){var a=this,t=ea.window.location.hash.replace("#",""),o;return this._hashName?(t.split("&").map(function(e){return e.split("=")}).forEach(function(e){e[0]===a._hashName&&(o=e)}),(o&&o[1]||"").split("/")):t.split("/")},To.prototype._onHashChange=function(){var a=this._getCurrentHash();if(3<=a.length&&!a.some(function(e){return isNaN(e)})){var t=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(a[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:t,pitch:+(a[4]||0)}),!0}return!1},To.prototype._updateHashUnthrottled=function(){var t=this.getHashString();try{ea.window.history.replaceState(ea.window.history.state,"",t)}catch(e){}};var Eo={linearity:.3,easing:ea.bezier(0,0,.3,1)},Io=ea.extend({deceleration:2500,maxSpeed:1400},Eo),Po=ea.extend({deceleration:20,maxSpeed:1400},Eo),So=ea.extend({deceleration:1e3,maxSpeed:360},Eo),Co=ea.extend({deceleration:1e3,maxSpeed:90},Eo),zo=function(e){this._map=e,this.clear()};zo.prototype.clear=function(){this._inertiaBuffer=[]},zo.prototype.record=function(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:ea.browser.now(),settings:t})},zo.prototype._drainInertiaBuffer=function(){for(var t=this._inertiaBuffer,e=ea.browser.now();0<t.length&&160<e-t[0].time;)t.shift()},zo.prototype._onMoveEnd=function(t){if(this._drainInertiaBuffer(),!(2>this._inertiaBuffer.length)){for(var e={zoom:0,bearing:0,pitch:0,pan:new ea.Point(0,0),pinchAround:void 0,around:void 0},i=0,d=this._inertiaBuffer,r;i<d.length;i+=1)r=d[i].settings,e.zoom+=r.zoomDelta||0,e.bearing+=r.bearingDelta||0,e.pitch+=r.pitchDelta||0,r.panDelta&&e.pan._add(r.panDelta),r.around&&(e.around=r.around),r.pinchAround&&(e.pinchAround=r.pinchAround);var g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,n={};if(e.pan.mag()){var s=Aa(e.pan.mag(),g,ea.extend({},Io,t||{}));n.offset=e.pan.mult(s.amount/e.pan.mag()),n.center=this._map.transform.center,Ta(n,s)}if(e.zoom){var l=Aa(e.zoom,g,Po);n.zoom=this._map.transform.zoom+l.amount,Ta(n,l)}if(e.bearing){var c=Aa(e.bearing,g,So);n.bearing=this._map.transform.bearing+ea.clamp(c.amount,-179,179),Ta(n,c)}if(e.pitch){var u=Aa(e.pitch,g,Co);n.pitch=this._map.transform.pitch+u.amount,Ta(n,u)}if(n.zoom||n.bearing){var m=void 0===e.pinchAround?e.around:e.pinchAround;n.around=m?this._map.unproject(m):this._map.getCenter()}return this.clear(),ea.extend(n,{noMoveStart:!0})}};var Do=function(t){function e(e,o,r,a){void 0===a&&(a={});var i=Fa.mousePos(o.getCanvasContainer(),r),s=o.unproject(i);t.call(this,e,ea.extend({point:i,lngLat:s,originalEvent:r},a)),this._defaultPrevented=!1,this.target=o}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var a={defaultPrevented:{configurable:!0}};return e.prototype.preventDefault=function(){this._defaultPrevented=!0},a.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(e.prototype,a),e}(ea.Event),Lo=function(t){function e(e,o,r){var a="touchend"===e?r.changedTouches:r.touches,i=Fa.touchPos(o.getCanvasContainer(),a),n=i.map(function(e){return o.unproject(e)}),l=i.reduce(function(a,t,e,r){return a.add(t.div(r.length))},new ea.Point(0,0)),s=o.unproject(l);t.call(this,e,{points:i,point:l,lngLats:n,lngLat:s,originalEvent:r}),this._defaultPrevented=!1}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var a={defaultPrevented:{configurable:!0}};return e.prototype.preventDefault=function(){this._defaultPrevented=!0},a.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(e.prototype,a),e}(ea.Event),Ro=function(a){function t(t,e,r){a.call(this,t,{originalEvent:r}),this._defaultPrevented=!1}a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t;var e={defaultPrevented:{configurable:!0}};return t.prototype.preventDefault=function(){this._defaultPrevented=!0},e.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(t.prototype,e),t}(ea.Event),ko=function(a,t){this._map=a,this._clickTolerance=t.clickTolerance};ko.prototype.reset=function(){delete this._mousedownPos},ko.prototype.wheel=function(e){return this._firePreventable(new Ro(e.type,this._map,e))},ko.prototype.mousedown=function(a,t){return this._mousedownPos=t,this._firePreventable(new Do(a.type,this._map,a))},ko.prototype.mouseup=function(e){this._map.fire(new Do(e.type,this._map,e))},ko.prototype.click=function(a,t){this._mousedownPos&&this._mousedownPos.dist(t)>=this._clickTolerance||this._map.fire(new Do(a.type,this._map,a))},ko.prototype.dblclick=function(e){return this._firePreventable(new Do(e.type,this._map,e))},ko.prototype.mouseover=function(e){this._map.fire(new Do(e.type,this._map,e))},ko.prototype.mouseout=function(e){this._map.fire(new Do(e.type,this._map,e))},ko.prototype.touchstart=function(e){return this._firePreventable(new Lo(e.type,this._map,e))},ko.prototype.touchend=function(e){this._map.fire(new Lo(e.type,this._map,e))},ko.prototype.touchcancel=function(e){this._map.fire(new Lo(e.type,this._map,e))},ko.prototype._firePreventable=function(e){if(this._map.fire(e),e.defaultPrevented)return{}},ko.prototype.isEnabled=function(){return!0},ko.prototype.isActive=function(){return!1},ko.prototype.enable=function(){},ko.prototype.disable=function(){};var Bo=function(e){this._map=e};Bo.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Bo.prototype.mousemove=function(e){this._map.fire(new Do(e.type,this._map,e))},Bo.prototype.touchmove=function(e){this._map.fire(new Lo(e.type,this._map,e))},Bo.prototype.mousedown=function(){this._delayContextMenu=!0},Bo.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Do("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Bo.prototype.contextmenu=function(e){this._delayContextMenu?this._contextMenuEvent=e:this._map.fire(new Do(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()},Bo.prototype.isEnabled=function(){return!0},Bo.prototype.isActive=function(){return!1},Bo.prototype.enable=function(){},Bo.prototype.disable=function(){};var Oo=function(a,t){this._map=a,this._el=a.getCanvasContainer(),this._container=a.getContainer(),this._clickTolerance=t.clickTolerance||1};Oo.prototype.isEnabled=function(){return!!this._enabled},Oo.prototype.isActive=function(){return!!this._active},Oo.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Oo.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Oo.prototype.mousedown=function(a,t){this.isEnabled()&&a.shiftKey&&0===a.button&&(Fa.disableDrag(),this._startPos=this._lastPos=t,this._active=!0)},Oo.prototype.mousemoveWindow=function(i,t){if(this._active){var e=t;if(!(this._lastPos.equals(e)||!this._box&&e.dist(this._startPos)<this._clickTolerance)){var o=this._startPos;this._lastPos=e,this._box||(this._box=Fa.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",i));var r=Rt(o.x,e.x),a=ha(o.x,e.x),n=Rt(o.y,e.y),s=ha(o.y,e.y);Fa.setTransform(this._box,"translate("+r+"px,"+n+"px)"),this._box.style.width=a-r+"px",this._box.style.height=s-n+"px"}}},Oo.prototype.mouseupWindow=function(t,e){var o=this;if(this._active&&0===t.button){var r=this._startPos,a=e;if(this.reset(),Fa.suppressClick(),r.x!==a.x||r.y!==a.y)return this._map.fire(new ea.Event("boxzoomend",{originalEvent:t})),{cameraAnimation:function(e){return e.fitScreenCoordinates(r,a,o._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",t)}},Oo.prototype.keydown=function(e){this._active&&27===e.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",e))},Oo.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(Fa.remove(this._box),this._box=null),Fa.enableDrag(),delete this._startPos,delete this._lastPos},Oo.prototype._fireEvent=function(t,e){return this._map.fire(new ea.Event(t,{originalEvent:e}))};var Fo=function(e){this.reset(),this.numTouches=e.numTouches};Fo.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Fo.prototype.touchstart=function(t,e){(this.centroid||t.targetTouches.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=t.timeStamp),t.targetTouches.length===this.numTouches&&(this.centroid=function(t){for(var e=new ea.Point(0,0),a=0,i=t;a<i.length;a+=1)e._add(i[a]);return e.div(t.length)}(e),this.touches=Sa(t.targetTouches,e)))},Fo.prototype.touchmove=function(a,t){if(!this.aborted&&this.centroid){var e=Sa(a.targetTouches,t);for(var i in this.touches){var o=e[i];(!o||30<o.dist(this.touches[i]))&&(this.aborted=!0)}}},Fo.prototype.touchend=function(a){if((!this.centroid||500<a.timeStamp-this.startTime)&&(this.aborted=!0),0===a.targetTouches.length){var t=!this.aborted&&this.centroid;if(this.reset(),t)return t}};var No=function(e){this.singleTap=new Fo(e),this.numTaps=e.numTaps,this.reset()};No.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},No.prototype.touchstart=function(a,t){this.singleTap.touchstart(a,t)},No.prototype.touchmove=function(a,t){this.singleTap.touchmove(a,t)},No.prototype.touchend=function(a){var t=this.singleTap.touchend(a);if(t){var e=500>a.timeStamp-this.lastTime,r=!this.lastTap||30>this.lastTap.dist(t);if(e&&r||this.reset(),this.count++,this.lastTime=a.timeStamp,this.lastTap=t,this.count===this.numTaps)return this.reset(),t}};var Zo=function(){this._zoomIn=new No({numTouches:1,numTaps:2}),this._zoomOut=new No({numTouches:2,numTaps:1}),this.reset()};Zo.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Zo.prototype.touchstart=function(a,t){this._zoomIn.touchstart(a,t),this._zoomOut.touchstart(a,t)},Zo.prototype.touchmove=function(a,t){this._zoomIn.touchmove(a,t),this._zoomOut.touchmove(a,t)},Zo.prototype.touchend=function(a){var t=this,r=this._zoomIn.touchend(a),i=this._zoomOut.touchend(a);return r?(this._active=!0,a.preventDefault(),setTimeout(function(){return t.reset()},0),{cameraAnimation:function(t){return t.easeTo({duration:300,zoom:t.getZoom()+1,around:t.unproject(r)},{originalEvent:a})}}):i?(this._active=!0,a.preventDefault(),setTimeout(function(){return t.reset()},0),{cameraAnimation:function(t){return t.easeTo({duration:300,zoom:t.getZoom()-1,around:t.unproject(i)},{originalEvent:a})}}):void 0},Zo.prototype.touchcancel=function(){this.reset()},Zo.prototype.enable=function(){this._enabled=!0},Zo.prototype.disable=function(){this._enabled=!1,this.reset()},Zo.prototype.isEnabled=function(){return this._enabled},Zo.prototype.isActive=function(){return this._active};var jo=function(e){this.reset(),this._clickTolerance=e.clickTolerance||1};jo.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},jo.prototype._correctButton=function(){return!1},jo.prototype._move=function(){return{}},jo.prototype.mousedown=function(a,t){if(!this._lastPoint){var e=Fa.mouseButton(a);this._correctButton(a,e)&&(this._lastPoint=t,this._eventButton=e)}},jo.prototype.mousemoveWindow=function(a,t){var e=this._lastPoint;if(e&&(a.preventDefault(),this._moved||!(t.dist(e)<this._clickTolerance)))return this._moved=!0,this._lastPoint=t,this._move(e,t)},jo.prototype.mouseupWindow=function(e){Fa.mouseButton(e)===this._eventButton&&(this._moved&&Fa.suppressClick(),this.reset())},jo.prototype.enable=function(){this._enabled=!0},jo.prototype.disable=function(){this._enabled=!1,this.reset()},jo.prototype.isEnabled=function(){return this._enabled},jo.prototype.isActive=function(){return this._active};var qo=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.mousedown=function(t,e){a.prototype.mousedown.call(this,t,e),this._lastPoint&&(this._active=!0)},t.prototype._correctButton=function(a,t){return 0===t&&!a.ctrlKey},t.prototype._move=function(a,t){return{around:t,panDelta:t.sub(a)}},t}(jo),Vo=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype._correctButton=function(a,t){return 0===t&&a.ctrlKey||2===t},t.prototype._move=function(a,t){var e=.8*(t.x-a.x);if(e)return this._active=!0,{bearingDelta:e}},t.prototype.contextmenu=function(e){e.preventDefault()},t}(jo),Go=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype._correctButton=function(a,t){return 0===t&&a.ctrlKey||2===t},t.prototype._move=function(a,t){var e=-.5*(t.y-a.y);if(e)return this._active=!0,{pitchDelta:e}},t.prototype.contextmenu=function(e){e.preventDefault()},t}(jo),Wo=function(e){this._minTouches=1,this._clickTolerance=e.clickTolerance||1,this.reset()};Wo.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new ea.Point(0,0)},Wo.prototype.touchstart=function(a,t){return this._calculateTransform(a,t)},Wo.prototype.touchmove=function(a,t){if(this._active)return a.preventDefault(),this._calculateTransform(a,t)},Wo.prototype.touchend=function(a,t){this._calculateTransform(a,t),this._active&&a.targetTouches.length<this._minTouches&&this.reset()},Wo.prototype.touchcancel=function(){this.reset()},Wo.prototype._calculateTransform=function(t,e){0<t.targetTouches.length&&(this._active=!0);var i=Sa(t.targetTouches,e),o=new ea.Point(0,0),r=new ea.Point(0,0),a=0;for(var d in i){var s=i[d],l=this._touches[d];l&&(o._add(s),r._add(s.sub(l)),a++,i[d]=s)}if(this._touches=i,!(a<this._minTouches)&&r.mag()){var c=r.div(a);if(this._sum._add(c),!(this._sum.mag()<this._clickTolerance))return{around:o.div(a),panDelta:c}}},Wo.prototype.enable=function(){this._enabled=!0},Wo.prototype.disable=function(){this._enabled=!1,this.reset()},Wo.prototype.isEnabled=function(){return this._enabled},Wo.prototype.isActive=function(){return this._active};var Xo=function(){this.reset()};Xo.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Xo.prototype._start=function(){},Xo.prototype._move=function(){return{}},Xo.prototype.touchstart=function(a,t){this._firstTwoTouches||2>a.targetTouches.length||(this._firstTwoTouches=[a.targetTouches[0].identifier,a.targetTouches[1].identifier],this._start([t[0],t[1]]))},Xo.prototype.touchmove=function(l,t){if(this._firstTwoTouches){l.preventDefault();var e=this._firstTwoTouches,i=e[1],o=Ca(l,t,e[0]),r=Ca(l,t,i);if(o&&r){var a=this._aroundCenter?null:o.add(r).div(2);return this._move([o,r],a,l)}}},Xo.prototype.touchend=function(i,t){if(this._firstTwoTouches){var e=this._firstTwoTouches,o=e[1],r=Ca(i,t,e[0]),a=Ca(i,t,o);r&&a||(this._active&&Fa.suppressClick(),this.reset())}},Xo.prototype.touchcancel=function(){this.reset()},Xo.prototype.enable=function(e){this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around},Xo.prototype.disable=function(){this._enabled=!1,this.reset()},Xo.prototype.isEnabled=function(){return this._enabled},Xo.prototype.isActive=function(){return this._active};var Ho=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.reset=function(){a.prototype.reset.call(this),delete this._distance,delete this._startDistance},t.prototype._start=function(e){this._startDistance=this._distance=e[0].dist(e[1])},t.prototype._move=function(a,t){var e=this._distance;if(this._distance=a[0].dist(a[1]),this._active||!(.1>ma(La(this._distance,this._startDistance))))return this._active=!0,{zoomDelta:La(this._distance,e),pinchAround:t}},t}(Xo),Jo=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.reset=function(){a.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},t.prototype._start=function(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])},t.prototype._move=function(a,t){var e=this._vector;if(this._vector=a[0].sub(a[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ea(this._vector,e),pinchAround:t}},t.prototype._isBelowThreshold=function(a){this._minDiameter=Rt(this._minDiameter,a.mag());var t=360*(25/(Ke*this._minDiameter)),e=Ea(a,this._startVector);return ma(e)<t},t}(Xo),$o=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t.prototype.reset=function(){a.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},t.prototype._start=function(e){this._lastPoints=e,Ia(e[0].sub(e[1]))&&(this._valid=!1)},t.prototype._move=function(a,t,e){var i=a[0].sub(this._lastPoints[0]),o=a[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(i,o,e.timeStamp),this._valid)return this._lastPoints=a,this._active=!0,{pitchDelta:-.5*((i.y+o.y)/2)}},t.prototype.gestureBeginsVertically=function(n,t,e){if(void 0!==this._valid)return this._valid;var i=2<=n.mag(),o=2<=t.mag();if(i||o){if(!i||!o)return void 0===this._firstMove&&(this._firstMove=e),100>e-this._firstMove&&void 0;var r=0<n.y==0<t.y;return Ia(n)&&Ia(t)&&r}},t}(Xo),er={panStep:100,bearingStep:15,pitchStep:10},ir=function(){var e=er;this._panStep=e.panStep,this._bearingStep=e.bearingStep,this._pitchStep=e.pitchStep};ir.prototype.reset=function(){this._active=!1},ir.prototype.keydown=function(d){var t=this;if(!(d.altKey||d.ctrlKey||d.metaKey)){var e=0,c=0,p=0,u=0,g=0;switch(d.keyCode){case 61:case 107:case 171:case 187:e=1;break;case 189:case 109:case 173:e=-1;break;case 37:d.shiftKey?c=-1:(d.preventDefault(),u=-1);break;case 39:d.shiftKey?c=1:(d.preventDefault(),u=1);break;case 38:d.shiftKey?p=1:(d.preventDefault(),g=-1);break;case 40:d.shiftKey?p=-1:(d.preventDefault(),g=1);break;default:return;}return{cameraAnimation:function(a){var o=a.getZoom();a.easeTo({duration:300,easeId:"keyboardHandler",easing:Pa,zoom:e?Xe(o)+e*(d.shiftKey?2:1):o,bearing:a.getBearing()+c*t._bearingStep,pitch:a.getPitch()+p*t._pitchStep,offset:[-u*t._panStep,-g*t._panStep],center:a.getCenter()},{originalEvent:d})}}}},ir.prototype.enable=function(){this._enabled=!0},ir.prototype.disable=function(){this._enabled=!1,this.reset()},ir.prototype.isEnabled=function(){return this._enabled},ir.prototype.isActive=function(){return this._active};var or=function(t,e){this._map=t,this._el=t.getCanvasContainer(),this._handler=e,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,ea.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};or.prototype.setZoomRate=function(e){this._defaultZoomRate=e},or.prototype.setWheelZoomRate=function(e){this._wheelZoomRate=e},or.prototype.isEnabled=function(){return!!this._enabled},or.prototype.isActive=function(){return!!this._active||void 0!==this._finishTimeout},or.prototype.isZooming=function(){return!!this._zooming},or.prototype.enable=function(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=e&&"center"===e.around)},or.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},or.prototype.wheel=function(t){if(this.isEnabled()){var e=t.deltaMode===ea.window.WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY,a=ea.browser.now(),o=a-(this._lastWheelEventTime||0);this._lastWheelEventTime=a,0!==e&&0==e%4.000244140625?this._type="wheel":0!==e&&4>ma(e)?this._type="trackpad":400<o?(this._type=null,this._lastValue=e,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=200>ma(o*e)?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,e+=this._lastValue)),t.shiftKey&&e&&(e/=4),this._type&&(this._lastWheelEvent=t,this._delta-=e,this._active||this._start(t)),t.preventDefault()}},or.prototype._onTimeout=function(e){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(e)},or.prototype._start=function(t){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var e=Fa.mousePos(this._el,t);this._around=ea.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(e)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},or.prototype.renderFrame=function(){return this._onScrollFrame()},or.prototype._onScrollFrame=function(){var t=this;if(this._frameId&&(this._frameId=null,this.isActive())){var e=this._map.transform;if(0!==this._delta){var i="wheel"===this._type&&4.000244140625<ma(this._delta)?this._wheelZoomRate:this._defaultZoomRate,o=2/(1+g(-ma(this._delta*i)));0>this._delta&&0!==o&&(o=1/o);var d="number"==typeof this._targetZoom?e.zoomScale(this._targetZoom):e.scale;this._targetZoom=Rt(e.maxZoom,ha(e.minZoom,e.scaleZoom(d*o))),"wheel"===this._type&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var a="number"==typeof this._targetZoom?this._targetZoom:e.zoom,s=this._startZoom,l=this._easing,c=!1,m;if("wheel"===this._type&&s&&l){var y=Rt((ea.browser.now()-this._lastWheelEventTime)/200,1),h=l(y);m=ea.number(s,a,h),1>y?this._frameId||(this._frameId=!0):c=!0}else m=a,c=!0;return this._active=!0,c&&(this._active=!1,this._finishTimeout=setTimeout(function(){t._zooming=!1,t._handler._triggerRenderFrame(),delete t._targetZoom,delete t._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!c,zoomDelta:m-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},or.prototype._smoothOutEasing=function(t){var e=ea.ease;if(this._prevEase){var l=this._prevEase,o=(ea.browser.now()-l.start)/l.duration,r=l.easing(o+.01)-l.easing(o),a=.01*(.27/We(r*r+1e-4)),n=We(.0729-a*a);e=ea.bezier(a,n,.25,1)}return this._prevEase={start:ea.browser.now(),duration:t,easing:e},e},or.prototype.reset=function(){this._active=!1};var ar=function(a,t){this._clickZoom=a,this._tapZoom=t};ar.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},ar.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},ar.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},ar.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var nr=function(){this.reset()};nr.prototype.reset=function(){this._active=!1},nr.prototype.dblclick=function(a,t){return a.preventDefault(),{cameraAnimation:function(e){e.easeTo({duration:300,zoom:e.getZoom()+(a.shiftKey?-1:1),around:e.unproject(t)},{originalEvent:a})}}},nr.prototype.enable=function(){this._enabled=!0},nr.prototype.disable=function(){this._enabled=!1,this.reset()},nr.prototype.isEnabled=function(){return this._enabled},nr.prototype.isActive=function(){return this._active};var sr=function(){this._tap=new No({numTouches:1,numTaps:1}),this.reset()};sr.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},sr.prototype.touchstart=function(a,t){this._swipePoint||(this._tapTime&&500<a.timeStamp-this._tapTime&&this.reset(),this._tapTime?0<a.targetTouches.length&&(this._swipePoint=t[0],this._swipeTouch=a.targetTouches[0].identifier):this._tap.touchstart(a,t))},sr.prototype.touchmove=function(a,t){if(!this._tapTime)this._tap.touchmove(a,t);else if(this._swipePoint){if(a.targetTouches[0].identifier!==this._swipeTouch)return;var e=t[0],r=e.y-this._swipePoint.y;return this._swipePoint=e,a.preventDefault(),this._active=!0,{zoomDelta:r/128}}},sr.prototype.touchend=function(e){this._tapTime?this._swipePoint&&0===e.targetTouches.length&&this.reset():this._tap.touchend(e)&&(this._tapTime=e.timeStamp)},sr.prototype.touchcancel=function(){this.reset()},sr.prototype.enable=function(){this._enabled=!0},sr.prototype.disable=function(){this._enabled=!1,this.reset()},sr.prototype.isEnabled=function(){return this._enabled},sr.prototype.isActive=function(){return this._active};var lr=function(a,t,e){this._el=a,this._mousePan=t,this._touchPan=e};lr.prototype.enable=function(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},lr.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},lr.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},lr.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var cr=function(a,t,e){this._pitchWithRotate=a.pitchWithRotate,this._mouseRotate=t,this._mousePitch=e};cr.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},cr.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},cr.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},cr.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var ur=function(a,t,e,r){this._el=a,this._touchZoom=t,this._touchRotate=e,this._tapDragZoom=r,this._rotationDisabled=!1,this._enabled=!0};ur.prototype.enable=function(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},ur.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},ur.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},ur.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},ur.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},ur.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var hr=function(e){return e.zoom||e.drag||e.pitch||e.rotate},pr=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),(t.prototype=Object.create(a&&a.prototype)).constructor=t,t}(ea.Event),dr=function(t,e){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new zo(t),this._bearingSnap=e.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(e),ea.bindAll(["handleEvent","handleWindowEvent"],this);var o=this._el;this._listeners=[[o,"touchstart",{passive:!1}],[o,"touchmove",{passive:!1}],[o,"touchend",void 0],[o,"touchcancel",void 0],[o,"mousedown",void 0],[o,"mousemove",void 0],[o,"mouseup",void 0],[ea.window.document,"mousemove",{capture:!0}],[ea.window.document,"mouseup",void 0],[o,"mouseover",void 0],[o,"mouseout",void 0],[o,"dblclick",void 0],[o,"click",void 0],[o,"keydown",{capture:!1}],[o,"keyup",void 0],[o,"wheel",{passive:!1}],[o,"contextmenu",void 0],[ea.window,"blur",void 0]];for(var r=0,i=this._listeners;r<i.length;r+=1){var n=i[r],s=n[0];Fa.addEventListener(s,n[1],s===ea.window.document?this.handleWindowEvent:this.handleEvent,n[2])}};dr.prototype.destroy=function(){for(var t=0,i=this._listeners;t<i.length;t+=1){var o=i[t],r=o[0];Fa.removeEventListener(r,o[1],r===ea.window.document?this.handleWindowEvent:this.handleEvent,o[2])}},dr.prototype._addDefaultHandlers=function(y){var t=this._map,e=t.getCanvasContainer();this._add("mapEvent",new ko(t,y));var i=t.boxZoom=new Oo(t,y);this._add("boxZoom",i);var o=new Zo,r=new nr;t.doubleClickZoom=new ar(r,o),this._add("tapZoom",o),this._add("clickZoom",r);var a=new sr;this._add("tapDragZoom",a);var n=t.touchPitch=new $o;this._add("touchPitch",n);var s=new Vo(y),l=new Go(y);t.dragRotate=new cr(y,s,l),this._add("mouseRotate",s,["mousePitch"]),this._add("mousePitch",l,["mouseRotate"]);var c=new qo(y),u=new Wo(y);t.dragPan=new lr(e,c,u),this._add("mousePan",c),this._add("touchPan",u,["touchZoom","touchRotate"]);var h=new Jo,p=new Ho;t.touchZoomRotate=new ur(e,p,h,a),this._add("touchRotate",h,["touchPan","touchZoom"]),this._add("touchZoom",p,["touchPan","touchRotate"]);var d=t.scrollZoom=new or(t,this);this._add("scrollZoom",d,["mousePan"]);var x=t.keyboard=new ir;this._add("keyboard",x),this._add("blockableMapEvent",new Bo(t));for(var f=0,_=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"],g;f<_.length;f+=1)g=_[f],y.interactive&&y[g]&&t[g].enable(y[g])},dr.prototype._add=function(a,t,e){this._handlers.push({handlerName:a,handler:t,allowed:e}),this._handlersById[a]=t},dr.prototype.stop=function(){if(!this._updatingCamera){for(var a=0,o=this._handlers;a<o.length;a+=1)o[a].handler.reset();this._inertia.clear(),this._fireEvents({},{}),this._changes=[]}},dr.prototype.isActive=function(){for(var a=0,o=this._handlers;a<o.length;a+=1)if(o[a].handler.isActive())return!0;return!1},dr.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},dr.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},dr.prototype._blockedByActive=function(a,t,e){for(var r in a)if(r!==e&&(!t||0>t.indexOf(r)))return!0;return!1},dr.prototype.handleWindowEvent=function(e){this.handleEvent(e,e.type+"Window")},dr.prototype.handleEvent=function(i,t){if("blur"!==i.type){this._updatingCamera=!0;for(var e="renderFrame"===i.type?void 0:i,o={needsRenderFrame:!1},r={},a={},n=i?i.targetTouches?Fa.touchPos(this._el,i.targetTouches):Fa.mousePos(this._el,i):null,s=0,y=this._handlers;s<y.length;s+=1){var c=y[s],u=c.handlerName,h=c.handler,p=c.allowed;if(h.isEnabled()){var d=void 0;this._blockedByActive(a,p,u)?h.reset():h[t||i.type]&&(d=h[t||i.type](i,n),this.mergeHandlerResult(o,r,d,u,e),d&&d.needsRenderFrame&&this._triggerRenderFrame()),(d||h.isActive())&&(a[u]=h)}}var x={};for(var f in this._previousActiveHandlers)a[f]||(x[f]=e);this._previousActiveHandlers=a,(Object.keys(x).length||za(o))&&(this._changes.push([o,r,x]),this._triggerRenderFrame()),(Object.keys(a).length||za(o))&&this._map._stop(!0),this._updatingCamera=!1;var m=o.cameraAnimation;m&&(this._inertia.clear(),this._fireEvents({},{}),this._changes=[],m(this._map))}else this.stop()},dr.prototype.mergeHandlerResult=function(t,e,i,o,r){if(i){ea.extend(t,i);var a={handlerName:o,originalEvent:i.originalEvent||r};void 0!==i.zoomDelta&&(e.zoom=a),void 0!==i.panDelta&&(e.drag=a),void 0!==i.pitchDelta&&(e.pitch=a),void 0!==i.bearingDelta&&(e.rotate=a)}},dr.prototype._applyChanges=function(){for(var t={},e={},i={},o=0,d=this._changes;o<d.length;o+=1){var a=d[o],n=a[0],s=a[1],l=a[2];n.panDelta&&(t.panDelta=(t.panDelta||new ea.Point(0,0))._add(n.panDelta)),n.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+n.zoomDelta),n.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+n.bearingDelta),n.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+n.pitchDelta),void 0!==n.around&&(t.around=n.around),void 0!==n.pinchAround&&(t.pinchAround=n.pinchAround),n.noInertia&&(t.noInertia=n.noInertia),ea.extend(e,s),ea.extend(i,l)}this._updateMapTransform(t,e,i),this._changes=[]},dr.prototype._updateMapTransform=function(d,t,e){var i=this._map,o=i.transform;if(!za(d))return this._fireEvents(t,e);var r=d.panDelta,a=d.zoomDelta,n=d.bearingDelta,s=d.pitchDelta,l=d.around,p=d.pinchAround;void 0!==p&&(l=p),i._stop(!0),l=l||i.transform.centerPoint;var u=o.pointLocation(r?l.sub(r):l);n&&(o.bearing+=n),s&&(o.pitch+=s),a&&(o.zoom+=a),o.setLocationAtPoint(u,l),this._map._update(),d.noInertia||this._inertia.record(d),this._fireEvents(t,e)},dr.prototype._fireEvents=function(t,e){var i=this,r=hr(this._eventsInProgress),a=hr(t),n;for(var y in!r&&a&&this._fireEvent("movestart",a.originalEvent),t){var s=t[y].originalEvent,l=!this._eventsInProgress[y];this._eventsInProgress[y]=t[y],l&&this._fireEvent(y+"start",s)}for(var c in t.rotate&&(this._bearingChanged=!0),a&&this._fireEvent("move",a.originalEvent),t)this._fireEvent(c,t[c].originalEvent);for(var u in this._eventsInProgress){var h=this._eventsInProgress[u],p=h.handlerName,d=h.originalEvent;this._handlersById[p].isActive()||(delete this._eventsInProgress[u],this._fireEvent(u+"end",n=e[p]||d))}var x=hr(this._eventsInProgress);if((r||a)&&!x){this._updatingCamera=!0;var f=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),m=function(e){return 0!==e&&-i._bearingSnap<e&&e<i._bearingSnap};f?(m(f.bearing||this._map.getBearing())&&(f.bearing=0),this._map.easeTo(f,{originalEvent:n})):(this._map.fire(new ea.Event("moveend",{originalEvent:n})),m(this._map.getBearing())&&this._map.resetNorth()),this._bearingChanged=!1,this._updatingCamera=!1}},dr.prototype._fireEvent=function(t,e){this._map.fire(new ea.Event(t,e?{originalEvent:e}:{}))},dr.prototype._triggerRenderFrame=function(){var a=this;void 0===this._frameId&&(this._frameId=this._map._requestRenderFrame(function(t){delete a._frameId,a.handleEvent(new pr("renderFrame",{timeStamp:t})),a._applyChanges()}))};var fr=function(t){function e(e,a){t.call(this),this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=a.bearingSnap,ea.bindAll(["_renderFrameCallback"],this)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getCenter=function(){return new ea.LngLat(this.transform.center.lng,this.transform.center.lat)},e.prototype.setCenter=function(a,t){return this.jumpTo({center:a},t)},e.prototype.panBy=function(t,a,r){return t=ea.Point.convert(t).mult(-1),this.panTo(this.transform.center,ea.extend({offset:t},a),r)},e.prototype.panTo=function(t,e,a){return this.easeTo(ea.extend({center:t},e),a)},e.prototype.getZoom=function(){return this.transform.zoom},e.prototype.setZoom=function(a,t){return this.jumpTo({zoom:a},t),this},e.prototype.zoomTo=function(t,e,a){return this.easeTo(ea.extend({zoom:t},e),a)},e.prototype.zoomIn=function(a,t){return this.zoomTo(this.getZoom()+1,a,t),this},e.prototype.zoomOut=function(a,t){return this.zoomTo(this.getZoom()-1,a,t),this},e.prototype.getBearing=function(){return this.transform.bearing},e.prototype.setBearing=function(a,t){return this.jumpTo({bearing:a},t),this},e.prototype.getPadding=function(){return this.transform.padding},e.prototype.setPadding=function(a,t){return this.jumpTo({padding:a},t),this},e.prototype.rotateTo=function(t,e,a){return this.easeTo(ea.extend({bearing:t},e),a)},e.prototype.resetNorth=function(t,e){return this.rotateTo(0,ea.extend({duration:1e3},t),e),this},e.prototype.resetNorthPitch=function(t,e){return this.easeTo(ea.extend({bearing:0,pitch:0,duration:1e3},t),e),this},e.prototype.snapToNorth=function(a,t){return ma(this.getBearing())<this._bearingSnap?this.resetNorth(a,t):this},e.prototype.getPitch=function(){return this.transform.pitch},e.prototype.setPitch=function(a,t){return this.jumpTo({pitch:a},t),this},e.prototype.cameraForBounds=function(t,a){return t=ea.LngLatBounds.convert(t),this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),0,a)},e.prototype._cameraForBoxAndBearing=function(t,e,i,o){var b={top:0,bottom:0,right:0,left:0};if("number"==typeof(o=ea.extend({padding:b,offset:[0,0],maxZoom:this.transform.maxZoom},o)).padding){var a=o.padding;o.padding={top:a,bottom:a,right:a,left:a}}o.padding=ea.extend(b,o.padding);var n=this.transform,s=n.padding,l=n.project(ea.LngLat.convert(t)),c=n.project(ea.LngLat.convert(e)),u=l.rotate(-i*Ke/180),h=c.rotate(-i*Ke/180),p=new ea.Point(ha(u.x,h.x),ha(u.y,h.y)),d=new ea.Point(Rt(u.x,h.x),Rt(u.y,h.y)),_=p.sub(d),f=(n.width-(s.left+s.right+o.padding.left+o.padding.right))/_.x,m=(n.height-(s.top+s.bottom+o.padding.top+o.padding.bottom))/_.y;if(!(0>m||0>f)){var g=Rt(n.scaleZoom(n.scale*Rt(f,m)),o.maxZoom),v=ea.Point.convert(o.offset),y=new ea.Point(v.x+(o.padding.left-o.padding.right)/2,v.y+(o.padding.top-o.padding.bottom)/2).mult(n.scale/n.zoomScale(g));return{center:n.unproject(l.add(c).div(2).sub(y)),zoom:g,bearing:i}}ea.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},e.prototype.fitBounds=function(a,t,e){return this._fitInternal(this.cameraForBounds(a,t),t,e)},e.prototype.fitScreenCoordinates=function(t,e,i,o,r){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(ea.Point.convert(t)),this.transform.pointLocation(ea.Point.convert(e)),i,o),o,r)},e.prototype._fitInternal=function(t,e,a){return t?(delete(e=ea.extend(t,e)).padding,e.linear?this.easeTo(e,a):this.flyTo(e,a)):this},e.prototype.jumpTo=function(t,e){this.stop();var i=this.transform,o=!1,l=!1,s=!1;return"zoom"in t&&i.zoom!==+t.zoom&&(o=!0,i.zoom=+t.zoom),void 0!==t.center&&(i.center=ea.LngLat.convert(t.center)),"bearing"in t&&i.bearing!==+t.bearing&&(l=!0,i.bearing=+t.bearing),"pitch"in t&&i.pitch!==+t.pitch&&(s=!0,i.pitch=+t.pitch),null==t.padding||i.isPaddingEqual(t.padding)||(i.padding=t.padding),this.fire(new ea.Event("movestart",e)).fire(new ea.Event("move",e)),o&&this.fire(new ea.Event("zoomstart",e)).fire(new ea.Event("zoom",e)).fire(new ea.Event("zoomend",e)),l&&this.fire(new ea.Event("rotatestart",e)).fire(new ea.Event("rotate",e)).fire(new ea.Event("rotateend",e)),s&&this.fire(new ea.Event("pitchstart",e)).fire(new ea.Event("pitch",e)).fire(new ea.Event("pitchend",e)),this.fire(new ea.Event("moveend",e))},e.prototype.easeTo=function(t,k){var i=this;this._stop(!1,t.easeId),(!1===(t=ea.extend({offset:[0,0],duration:500,easing:ea.ease},t)).animate||!t.essential&&ea.browser.prefersReducedMotion)&&(t.duration=0);var o=this.transform,r=this.getZoom(),a=this.getBearing(),n=this.getPitch(),s=this.getPadding(),l="zoom"in t?+t.zoom:r,c="bearing"in t?this._normalizeBearing(t.bearing,a):a,u="pitch"in t?+t.pitch:n,h="padding"in t?t.padding:o.padding,p=ea.Point.convert(t.offset),d=o.centerPoint.add(p),T=o.pointLocation(d),f=ea.LngLat.convert(t.center||T);this._normalizeCenter(f);var A=o.project(T),y=o.project(f).sub(A),x=o.zoomScale(l-r),b,S;t.around&&(b=ea.LngLat.convert(t.around),S=o.locationPoint(b));var m={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||l!==r,this._rotating=this._rotating||a!==c,this._pitching=this._pitching||u!==n,this._padding=!o.isPaddingEqual(h),this._easeId=t.easeId,this._prepareEase(k,t.noMoveStart,m),clearTimeout(this._easeEndTimeoutID),this._ease(function(t){if(i._zooming&&(o.zoom=ea.number(r,l,t)),i._rotating&&(o.bearing=ea.number(a,c,t)),i._pitching&&(o.pitch=ea.number(n,u,t)),i._padding&&(o.interpolatePadding(s,h,t),d=o.centerPoint.add(p)),b)o.setLocationAtPoint(b,S);else{var e=o.zoomScale(o.zoom-r),g=l>r?Rt(2,x):ha(.5,x),m=pa(g,1-t),f=o.unproject(A.add(y.mult(t*m)).mult(e));o.setLocationAtPoint(o.renderWorldCopies?f.wrap():f,d)}i._fireMoveEvents(k)},function(e){i._afterEase(k,e)},t),this},e.prototype._prepareEase=function(t,e,a){void 0===a&&(a={}),this._moving=!0,e||a.moving||this.fire(new ea.Event("movestart",t)),this._zooming&&!a.zooming&&this.fire(new ea.Event("zoomstart",t)),this._rotating&&!a.rotating&&this.fire(new ea.Event("rotatestart",t)),this._pitching&&!a.pitching&&this.fire(new ea.Event("pitchstart",t))},e.prototype._fireMoveEvents=function(t){this.fire(new ea.Event("move",t)),this._zooming&&this.fire(new ea.Event("zoom",t)),this._rotating&&this.fire(new ea.Event("rotate",t)),this._pitching&&this.fire(new ea.Event("pitch",t))},e.prototype._afterEase=function(t,e){if(!this._easeId||!e||this._easeId!==e){delete this._easeId;var i=this._zooming,o=this._rotating,r=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,i&&this.fire(new ea.Event("zoomend",t)),o&&this.fire(new ea.Event("rotateend",t)),r&&this.fire(new ea.Event("pitchend",t)),this.fire(new ea.Event("moveend",t))}},e.prototype.flyTo=function(t,O){function i(a){var t=(w*w-N*N+(a?-1:1)*P*P*T*T)/(2*(a?w:N)*P*T);return C(We(t*t+1)-t)}function j(e){return(g(e)-g(-e))/2}function z(e){return(g(e)+g(-e))/2}var D=this;if(!t.essential&&ea.browser.prefersReducedMotion){var o=ea.pick(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(o,O)}this.stop(),t=ea.extend({offset:[0,0],speed:1.2,curve:1.42,easing:ea.ease},t);var B=this.transform,a=this.getZoom(),n=this.getBearing(),s=this.getPitch(),l=this.getPadding(),c="zoom"in t?ea.clamp(+t.zoom,B.minZoom,B.maxZoom):a,u="bearing"in t?this._normalizeBearing(t.bearing,n):n,h="pitch"in t?+t.pitch:s,p="padding"in t?t.padding:B.padding,r=B.zoomScale(c-a),d=ea.Point.convert(t.offset),f=B.centerPoint.add(d),_=B.pointLocation(f),F=ea.LngLat.convert(t.center||_);this._normalizeCenter(F);var v=B.project(_),y=B.project(F).sub(v),x=t.curve,N=ha(B.width,B.height),w=N/r,T=y.mag();if("minZoom"in t){var E=ea.clamp(Rt(t.minZoom,a,c),B.minZoom,B.maxZoom),I=N/B.zoomScale(E-a);x=We(2*(I/T))}var P=x*x,S=i(0),M=function(e){return z(S)/z(S+x*e)},V=function(a){return N*((z(S)*(j(t=S+x*a)/z(t))-j(S))/P)/T;var t},U=(i(1)-S)/x;if(1e-6>ma(T)||!isFinite(U)){if(1e-6>ma(N-w))return this.easeTo(t,O);var H=w<N?-1:1;U=ma(C(w/N))/x,V=function(){return 0},M=function(e){return g(H*x*e)}}return t.duration="duration"in t?+t.duration:1e3*U/("screenSpeed"in t?+t.screenSpeed/x:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=n!==u,this._pitching=h!==s,this._padding=!B.isPaddingEqual(p),this._prepareEase(O,!1),this._ease(function(t){var e=t*U,o=1/M(e);B.zoom=1===t?c:a+B.scaleZoom(o),D._rotating&&(B.bearing=ea.number(n,u,t)),D._pitching&&(B.pitch=ea.number(s,h,t)),D._padding&&(B.interpolatePadding(l,p,t),f=B.centerPoint.add(d));var r=1===t?F:B.unproject(v.add(y.mult(V(e))).mult(o));B.setLocationAtPoint(B.renderWorldCopies?r.wrap():r,f),D._fireMoveEvents(O)},function(){return D._afterEase(O)},t),this},e.prototype.isEasing=function(){return!!this._easeFrameId},e.prototype.stop=function(){return this._stop()},e.prototype._stop=function(a,t){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var e=this._onEaseEnd;delete this._onEaseEnd,e.call(this,t)}if(!a){var r=this.handlers;r&&r.stop()}return this},e.prototype._ease=function(t,e,a){!1===a.animate||0===a.duration?(t(1),e()):(this._easeStart=ea.browser.now(),this._easeOptions=a,this._onEaseFrame=t,this._onEaseEnd=e,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},e.prototype._renderFrameCallback=function(){var t=Rt((ea.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(t)),1>t?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},e.prototype._normalizeBearing=function(t,a){t=ea.wrap(t,-180,180);var r=ma(t-a);return ma(t-360-a)<r&&(t-=360),ma(t+360-a)<r&&(t+=360),t},e.prototype._normalizeCenter=function(a){var t=this.transform;if(t.renderWorldCopies&&!t.lngRange){var e=a.lng-t.center.lng;a.lng+=180<e?-360:-180>e?360:0}},e}(ea.Evented),mr=function(t){void 0===t&&(t={}),this.options=t,ea.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};mr.prototype.getDefaultPosition=function(){return"bottom-right"},mr.prototype.onAdd=function(a){var t=this.options&&this.options.compact;return this._map=a,this._container=Fa.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=Fa.create("div","mapboxgl-ctrl-attrib-inner",this._container),t&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===t&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},mr.prototype.onRemove=function(){Fa.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},mr.prototype._updateEditLink=function(){var t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));var a=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||ea.config.ACCESS_TOKEN}];if(t){var r=a.reduce(function(r,i,e){return i.value&&(r+=i.key+"="+i.value+(e<a.length-1?"&":"")),r},"?");t.href=ea.config.FEEDBACK_URL+"/"+r+(this._map._hash?this._map._hash.getHashString(!0):""),t.rel="noopener nofollow"}},mr.prototype._updateData=function(e){e&&("metadata"===e.sourceDataType||"style"===e.dataType)&&(this._updateAttributions(),this._updateEditLink())},mr.prototype._updateAttributions=function(){if(this._map.style){var l=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=l.concat(this.options.customAttribution.map(function(e){return"string"==typeof e?e:""})):"string"==typeof this.options.customAttribution&&l.push(this.options.customAttribution)),this._map.style.stylesheet){var s=this._map.style.stylesheet;this.styleOwner=s.owner,this.styleId=s.id}var e=this._map.style.sourceCaches;for(var i in e){var o=e[i];if(o.used){var r=o.getSource();r.attribution&&0>l.indexOf(r.attribution)&&l.push(r.attribution)}}l.sort(function(a,t){return a.length-t.length});var a=(l=l.filter(function(t,e){for(var a=e+1;a<l.length;a++)if(0<=l[a].indexOf(t))return!1;return!0})).join(" | ");a!==this._attribHTML&&(this._attribHTML=a,l.length?(this._innerContainer.innerHTML=a,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},mr.prototype._updateCompact=function(){640>=this._map.getCanvasContainer().offsetWidth?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var gr=function(){ea.bindAll(["_updateLogo"],this),ea.bindAll(["_updateCompact"],this)};gr.prototype.onAdd=function(a){this._map=a,this._container=Fa.create("div","mapboxgl-ctrl");var t=Fa.create("a","mapboxgl-ctrl-logo");return t.target="_blank",t.rel="noopener nofollow",t.href="https://www.mapbox.com/",t.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),t.setAttribute("rel","noopener nofollow"),this._container.appendChild(t),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},gr.prototype.onRemove=function(){Fa.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},gr.prototype.getDefaultPosition=function(){return"bottom-left"},gr.prototype._updateLogo=function(e){e&&"metadata"!==e.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},gr.prototype._logoRequired=function(){if(this._map.style){var a=this._map.style.sourceCaches;for(var t in a)if(a[t].getSource().mapbox_logo)return!0;return!1}},gr.prototype._updateCompact=function(){var a=this._container.children;if(a.length){var t=a[0];250>this._map.getCanvasContainer().offsetWidth?t.classList.add("mapboxgl-compact"):t.classList.remove("mapboxgl-compact")}};var vr=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};vr.prototype.add=function(a){var t=++this._id;return this._queue.push({callback:a,id:t,cancelled:!1}),t},vr.prototype.remove=function(a){for(var t=this._currentlyRunning,e=0,n=t?this._queue.concat(t):this._queue,o;e<n.length;e+=1)if(o=n[e],o.id===a)return void(o.cancelled=!0)},vr.prototype.run=function(a){void 0===a&&(a=0);var n=this._currentlyRunning=this._queue;this._queue=[];for(var e=0,l=n,o;e<l.length&&(o=l[e],o.cancelled||(o.callback(a),!this._cleared));e+=1);this._cleared=!1,this._currentlyRunning=!1},vr.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var yr={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},xr=ea.window.HTMLImageElement,br=ea.window.HTMLElement,wr=ea.window.ImageBitmap,Tr={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Er=function(n){function e(t){var a=this;if(null!=(t=ea.extend({},Tr,t)).minZoom&&null!=t.maxZoom&&t.minZoom>t.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=t.minPitch&&null!=t.maxPitch&&t.minPitch>t.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=t.minPitch&&0>t.minPitch)throw new Error("minPitch must be greater than or equal to 0");if(null!=t.maxPitch&&60<t.maxPitch)throw new Error("maxPitch must be less than or equal to 60");var o=new bo(t.minZoom,t.maxZoom,t.minPitch,t.maxPitch,t.renderWorldCopies);if(n.call(this,o,t),this._interactive=t.interactive,this._maxTileCacheSize=t.maxTileCacheSize,this._failIfMajorPerformanceCaveat=t.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=t.preserveDrawingBuffer,this._antialias=t.antialias,this._trackResize=t.trackResize,this._bearingSnap=t.bearingSnap,this._refreshExpiredTiles=t.refreshExpiredTiles,this._fadeDuration=t.fadeDuration,this._crossSourceCollisions=t.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=t.collectResourceTiming,this._renderTaskQueue=new vr,this._controls=[],this._mapId=ea.uniqueId(),this._locale=ea.extend({},yr,t.locale),this._requestManager=new ea.RequestManager(t.transformRequest,t.accessToken),"string"!=typeof t.container){if(!(t.container instanceof br))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=t.container}else if(this._container=ea.window.document.getElementById(t.container),!this._container)throw new Error("Container '"+t.container+"' not found.");if(t.maxBounds&&this.setMaxBounds(t.maxBounds),ea.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return a._update(!1)}),this.on("moveend",function(){return a._update(!1)}),this.on("zoom",function(){return a._update(!0)}),void 0!==ea.window&&(ea.window.addEventListener("online",this._onWindowOnline,!1),ea.window.addEventListener("resize",this._onWindowResize,!1)),this.handlers=new dr(this,t),this._hash=t.hash&&new To("string"==typeof t.hash&&t.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}),t.bounds&&(this.resize(),this.fitBounds(t.bounds,ea.extend({},t.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=t.localIdeographFontFamily,t.style&&this.setStyle(t.style,{localIdeographFontFamily:t.localIdeographFontFamily}),t.attributionControl&&this.addControl(new mr({customAttribution:t.customAttribution})),this.addControl(new gr,t.logoPosition),this.on("style.load",function(){a.transform.unmodified&&a.jumpTo(a.style.stylesheet)}),this.on("data",function(t){a._update("style"===t.dataType),a.fire(new ea.Event(t.dataType+"data",t))}),this.on("dataloading",function(t){a.fire(new ea.Event(t.dataType+"dataloading",t))})}n&&(e.__proto__=n),(e.prototype=Object.create(n&&n.prototype)).constructor=e;var t={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return e.prototype._getMapId=function(){return this._mapId},e.prototype.addControl=function(t,e){if(void 0===e&&t.getDefaultPosition&&(e=t.getDefaultPosition()),void 0===e&&(e="top-right"),!t||!t.onAdd)return this.fire(new ea.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var a=t.onAdd(this);this._controls.push(t);var o=this._controlPositions[e];return-1===e.indexOf("bottom")?o.appendChild(a):o.insertBefore(a,o.firstChild),this},e.prototype.removeControl=function(t){if(!t||!t.onRemove)return this.fire(new ea.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var e=this._controls.indexOf(t);return-1<e&&this._controls.splice(e,1),t.onRemove(this),this},e.prototype.resize=function(t){var e=this._containerDimensions(),i=e[0],o=e[1];this._resizeCanvas(i,o),this.transform.resize(i,o),this.painter.resize(i,o);var r=!this._moving;return r&&(this.stop(),this.fire(new ea.Event("movestart",t)).fire(new ea.Event("move",t))),this.fire(new ea.Event("resize",t)),r&&this.fire(new ea.Event("moveend",t)),this},e.prototype.getBounds=function(){return this.transform.getBounds()},e.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},e.prototype.setMaxBounds=function(t){return this.transform.setMaxBounds(ea.LngLatBounds.convert(t)),this._update()},e.prototype.setMinZoom=function(e){if(-2<=(e=null==e?-2:e)&&e<=this.transform.maxZoom)return this.transform.minZoom=e,this._update(),this.getZoom()<e&&this.setZoom(e),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},e.prototype.getMinZoom=function(){return this.transform.minZoom},e.prototype.setMaxZoom=function(e){if((e=null==e?22:e)>=this.transform.minZoom)return this.transform.maxZoom=e,this._update(),this.getZoom()>e&&this.setZoom(e),this;throw new Error("maxZoom must be greater than the current minZoom")},e.prototype.getMaxZoom=function(){return this.transform.maxZoom},e.prototype.setMinPitch=function(e){if(0>(e=null==e?0:e))throw new Error("minPitch must be greater than or equal to 0");if(0<=e&&e<=this.transform.maxPitch)return this.transform.minPitch=e,this._update(),this.getPitch()<e&&this.setPitch(e),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},e.prototype.getMinPitch=function(){return this.transform.minPitch},e.prototype.setMaxPitch=function(e){if(60<(e=null==e?60:e))throw new Error("maxPitch must be less than or equal to 60");if(e>=this.transform.minPitch)return this.transform.maxPitch=e,this._update(),this.getPitch()>e&&this.setPitch(e),this;throw new Error("maxPitch must be greater than the current minPitch")},e.prototype.getMaxPitch=function(){return this.transform.maxPitch},e.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},e.prototype.setRenderWorldCopies=function(e){return this.transform.renderWorldCopies=e,this._update()},e.prototype.project=function(t){return this.transform.locationPoint(ea.LngLat.convert(t))},e.prototype.unproject=function(t){return this.transform.pointLocation(ea.Point.convert(t))},e.prototype.isMoving=function(){return this._moving||this.handlers.isActive()},e.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},e.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},e.prototype._createDelegatedListener=function(l,s,d){var i=this,e;if("mouseenter"===l||"mouseover"===l){var t=!1;return{layer:s,listener:d,delegates:{mousemove:function(e){var a=i.getLayer(s)?i.queryRenderedFeatures(e.point,{layers:[s]}):[];a.length?t||(t=!0,d.call(i,new Do(l,i,e.originalEvent,{features:a}))):t=!1},mouseout:function(){t=!1}}}}if("mouseleave"===l||"mouseout"===l){var r=!1;return{layer:s,listener:d,delegates:{mousemove:function(e){(i.getLayer(s)?i.queryRenderedFeatures(e.point,{layers:[s]}):[]).length?r=!0:r&&(r=!1,d.call(i,new Do(l,i,e.originalEvent)))},mouseout:function(t){r&&(r=!1,d.call(i,new Do(l,i,t.originalEvent)))}}}}return{layer:s,listener:d,delegates:(e={},e[l]=function(e){var t=i.getLayer(s)?i.queryRenderedFeatures(e.point,{layers:[s]}):[];t.length&&(e.features=t,d.call(i,e),delete e.features)},e)}},e.prototype.on=function(o,t,e){if(void 0===e)return n.prototype.on.call(this,o,t);var i=this._createDelegatedListener(o,t,e);for(var r in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[o]=this._delegatedListeners[o]||[],this._delegatedListeners[o].push(i),i.delegates)this.on(r,i.delegates[r]);return this},e.prototype.once=function(o,t,e){if(void 0===e)return n.prototype.once.call(this,o,t);var i=this._createDelegatedListener(o,t,e);for(var r in i.delegates)this.once(r,i.delegates[r]);return this},e.prototype.off=function(d,t,e){var o=this;return void 0===e?n.prototype.off.call(this,d,t):(this._delegatedListeners&&this._delegatedListeners[d]&&function(r){for(var i=r[d],a=0,c;a<i.length;a++)if(c=i[a],c.layer===t&&c.listener===e){for(var p in c.delegates)o.off(p,c.delegates[p]);return i.splice(a,1),o}}(this._delegatedListeners),this)},e.prototype.queryRenderedFeatures=function(t,n){if(!this.style)return[];var l;if(void 0!==n||void 0===t||t instanceof ea.Point||Array.isArray(t)||(n=t,t=void 0),n=n||{},(t=t||[[0,0],[this.transform.width,this.transform.height]])instanceof ea.Point||"number"==typeof t[0])l=[ea.Point.convert(t)];else{var s=ea.Point.convert(t[0]),r=ea.Point.convert(t[1]);l=[s,new ea.Point(r.x,s.y),r,new ea.Point(s.x,r.y),s]}return this.style.queryRenderedFeatures(l,n,this.transform)},e.prototype.querySourceFeatures=function(a,t){return this.style.querySourceFeatures(a,t)},e.prototype.setStyle=function(t,e){return!1!==(e=ea.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},e)).diff&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&t?(this._diffStyle(t,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(t,e))},e.prototype._getUIString=function(a){var t=this._locale[a];if(null==t)throw new Error("Missing UI string '"+a+"'");return t},e.prototype._updateStyle=function(a,t){return this.style&&(this.style.setEventedParent(null),this.style._remove()),a?(this.style=new je(this,t||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof a?this.style.loadURL(a):this.style.loadJSON(a),this):(delete this.style,this)},e.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new je(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},e.prototype._diffStyle=function(t,n){var i=this;if("string"==typeof t){var e=this._requestManager.normalizeStyleURL(t),o=this._requestManager.transformRequest(e,ea.ResourceType.Style);ea.getJSON(o,function(t,e){t?i.fire(new ea.ErrorEvent(t)):e&&i._updateDiff(e,n)})}else"object"==typeof t&&this._updateDiff(t,n)},e.prototype._updateDiff=function(t,e){try{this.style.setState(t)&&this._update(!0)}catch(a){ea.warnOnce("Unable to perform style diff: "+(a.message||a.error||a)+".  Rebuilding the style from scratch."),this._updateStyle(t,e)}},e.prototype.getStyle=function(){if(this.style)return this.style.serialize()},e.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():ea.warnOnce("There is no style added to the map.")},e.prototype.addSource=function(a,t){return this._lazyInitEmptyStyle(),this.style.addSource(a,t),this._update(!0)},e.prototype.isSourceLoaded=function(t){var e=this.style&&this.style.sourceCaches[t];return void 0===e?void this.fire(new ea.ErrorEvent(new Error("There is no source with ID '"+t+"'"))):e.loaded()},e.prototype.areTilesLoaded=function(){var a=this.style&&this.style.sourceCaches;for(var t in a){var e=a[t]._tiles;for(var i in e){var o=e[i];if("loaded"!==o.state&&"errored"!==o.state)return!1}}return!0},e.prototype.addSourceType=function(a,t,e){return this._lazyInitEmptyStyle(),this.style.addSourceType(a,t,e)},e.prototype.removeSource=function(e){return this.style.removeSource(e),this._update(!0)},e.prototype.getSource=function(e){return this.style.getSource(e)},e.prototype.addImage=function(t,e,i){void 0===i&&(i={});var d=i.pixelRatio;void 0===d&&(d=1);var p=i.sdf;void 0===p&&(p=!1);var g=i.stretchX,n=i.stretchY,s=i.content;if(this._lazyInitEmptyStyle(),e instanceof xr||wr&&e instanceof wr){var l=ea.browser.getImageData(e);this.style.addImage(t,{data:new ea.RGBAImage({width:l.width,height:l.height},l.data),pixelRatio:d,stretchX:g,stretchY:n,content:s,sdf:p,version:0})}else{if(void 0===e.width||void 0===e.height)return this.fire(new ea.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var c=e;this.style.addImage(t,{data:new ea.RGBAImage({width:e.width,height:e.height},new Uint8Array(e.data)),pixelRatio:d,stretchX:g,stretchY:n,content:s,sdf:p,version:0,userImage:c}),c.onAdd&&c.onAdd(this,t)}},e.prototype.updateImage=function(t,e){var i=this.style.getImage(t);if(!i)return this.fire(new ea.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var o=e instanceof xr||wr&&e instanceof wr?ea.browser.getImageData(e):e,r=o.width,a=o.height,n=o.data;return void 0===r||void 0===a?this.fire(new ea.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):r!==i.data.width||a!==i.data.height?this.fire(new ea.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(i.data.replace(n,!(e instanceof xr||wr&&e instanceof wr)),void this.style.updateImage(t,i))},e.prototype.hasImage=function(t){return t?!!this.style.getImage(t):(this.fire(new ea.ErrorEvent(new Error("Missing required image id"))),!1)},e.prototype.removeImage=function(e){this.style.removeImage(e)},e.prototype.loadImage=function(t,e){ea.getImage(this._requestManager.transformRequest(t,ea.ResourceType.Image),e)},e.prototype.listImages=function(){return this.style.listImages()},e.prototype.addLayer=function(a,t){return this._lazyInitEmptyStyle(),this.style.addLayer(a,t),this._update(!0)},e.prototype.moveLayer=function(a,t){return this.style.moveLayer(a,t),this._update(!0)},e.prototype.removeLayer=function(e){return this.style.removeLayer(e),this._update(!0)},e.prototype.getLayer=function(e){return this.style.getLayer(e)},e.prototype.setLayerZoomRange=function(a,t,e){return this.style.setLayerZoomRange(a,t,e),this._update(!0)},e.prototype.setFilter=function(a,t,e){return void 0===e&&(e={}),this.style.setFilter(a,t,e),this._update(!0)},e.prototype.getFilter=function(e){return this.style.getFilter(e)},e.prototype.setPaintProperty=function(a,t,e,r){return void 0===r&&(r={}),this.style.setPaintProperty(a,t,e,r),this._update(!0)},e.prototype.getPaintProperty=function(a,t){return this.style.getPaintProperty(a,t)},e.prototype.setLayoutProperty=function(a,t,e,r){return void 0===r&&(r={}),this.style.setLayoutProperty(a,t,e,r),this._update(!0)},e.prototype.getLayoutProperty=function(a,t){return this.style.getLayoutProperty(a,t)},e.prototype.setLight=function(a,t){return void 0===t&&(t={}),this._lazyInitEmptyStyle(),this.style.setLight(a,t),this._update(!0)},e.prototype.getLight=function(){return this.style.getLight()},e.prototype.setFeatureState=function(a,t){return this.style.setFeatureState(a,t),this._update()},e.prototype.removeFeatureState=function(a,t){return this.style.removeFeatureState(a,t),this._update()},e.prototype.getFeatureState=function(e){return this.style.getFeatureState(e)},e.prototype.getContainer=function(){return this._container},e.prototype.getCanvasContainer=function(){return this._canvasContainer},e.prototype.getCanvas=function(){return this._canvas},e.prototype._containerDimensions=function(){var a=0,o=0;return this._container&&(a=this._container.clientWidth||400,o=this._container.clientHeight||300),[a,o]},e.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==ea.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&ea.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},e.prototype._setupContainer=function(){var i=this._container;i.classList.add("mapboxgl-map"),(this._missingCSSCanary=Fa.create("div","mapboxgl-canary",i)).style.visibility="hidden",this._detectMissingCSS();var t=this._canvasContainer=Fa.create("div","mapboxgl-canvas-container",i);this._interactive&&t.classList.add("mapboxgl-interactive"),this._canvas=Fa.create("canvas","mapboxgl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var e=this._containerDimensions();this._resizeCanvas(e[0],e[1]);var o=this._controlContainer=Fa.create("div","mapboxgl-control-container",i),r=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(e){r[e]=Fa.create("div","mapboxgl-ctrl-"+e,o)})},e.prototype._resizeCanvas=function(t,e){var a=ea.browser.devicePixelRatio||1;this._canvas.width=a*t,this._canvas.height=a*e,this._canvas.style.width=t+"px",this._canvas.style.height=e+"px"},e.prototype._setupPainter=function(){var e=ea.extend({},Ba.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),t=this._canvas.getContext("webgl",e)||this._canvas.getContext("experimental-webgl",e);t?(this.painter=new go(t,this.transform),ea.webpSupported.testSupport(t)):this.fire(new ea.ErrorEvent(new Error("Failed to initialize WebGL")))},e.prototype._contextLost=function(t){t.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new ea.Event("webglcontextlost",{originalEvent:t}))},e.prototype._contextRestored=function(t){this._setupPainter(),this.resize(),this._update(),this.fire(new ea.Event("webglcontextrestored",{originalEvent:t}))},e.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},e.prototype._update=function(e){return this.style?(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint(),this):this},e.prototype._requestRenderFrame=function(e){return this._update(),this._renderTaskQueue.add(e)},e.prototype._cancelRenderFrame=function(e){this._renderTaskQueue.remove(e)},e.prototype._render=function(t){var d=this,e=0,o=this.painter.context.extTimerQuery,a;if(this.listens("gpu-timing-frame")&&(a=o.createQueryEXT(),o.beginQueryEXT(o.TIME_ELAPSED_EXT,a),e=ea.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(t),!this._removed){var g=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var m=this.transform.zoom,s=ea.browser.now();this.style.zoomHistory.update(m,s);var l=new ea.EvaluationParameters(m,{now:s,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),c=l.crossFadingFactor();1===c&&c===this._crossFadingFactor||(g=!0,this._crossFadingFactor=c),this.style.update(l)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new ea.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new ea.Event("load"))),this.style&&(this.style.hasTransitions()||g)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var u=ea.browser.now()-e;o.endQueryEXT(o.TIME_ELAPSED_EXT,a),setTimeout(function(){var t=o.getQueryObjectEXT(a,o.QUERY_RESULT_EXT)/1e6;o.deleteQueryEXT(a),d.fire(new ea.Event("gpu-timing-frame",{cpuTime:u,gpuTime:t}))},50)}if(this.listens("gpu-timing-layer")){var h=this.painter.collectGpuTimers();setTimeout(function(){var t=d.painter.queryGpuTimers(h);d.fire(new ea.Event("gpu-timing-layer",{layerTimes:t}))},50)}return this._sourcesDirty||this._styleDirty||this._placementDirty||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&(this._fullyLoaded||(this._fullyLoaded=!0),this.fire(new ea.Event("idle"))),this}},e.prototype.remove=function(){this._hash&&this._hash.remove();for(var t=0,a=this._controls;t<a.length;t+=1)a[t].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==ea.window&&(ea.window.removeEventListener("resize",this._onWindowResize,!1),ea.window.removeEventListener("online",this._onWindowOnline,!1));var r=this.painter.context.gl.getExtension("WEBGL_lose_context");r&&r.loseContext(),Da(this._canvasContainer),Da(this._controlContainer),Da(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new ea.Event("remove"))},e.prototype.triggerRepaint=function(){var a=this;this.style&&!this._frame&&(this._frame=ea.browser.frame(function(e){a._frame=null,a._render(e)}))},e.prototype._onWindowOnline=function(){this._update()},e.prototype._onWindowResize=function(e){this._trackResize&&this.resize({originalEvent:e})._update()},t.showTileBoundaries.get=function(){return!!this._showTileBoundaries},t.showTileBoundaries.set=function(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())},t.showPadding.get=function(){return!!this._showPadding},t.showPadding.set=function(e){this._showPadding!==e&&(this._showPadding=e,this._update())},t.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},t.showCollisionBoxes.set=function(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,e?this.style._generateCollisionBoxes():this._update())},t.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},t.showOverdrawInspector.set=function(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())},t.repaint.get=function(){return!!this._repaint},t.repaint.set=function(e){this._repaint!==e&&(this._repaint=e,this.triggerRepaint())},t.vertices.get=function(){return!!this._vertices},t.vertices.set=function(e){this._vertices=e,this._update()},e.prototype._setCacheLimits=function(t,e){ea.setCacheLimits(t,e)},t.version.get=function(){return ea.version},Object.defineProperties(e.prototype,t),e}(fr),Ir={showCompass:!0,showZoom:!0,visualizePitch:!1},Sr=function(t){var e=this;this.options=ea.extend({},Ir,t),this._container=Fa.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(e){return e.preventDefault()}),this.options.showZoom&&(ea.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(a){return e._map.zoomIn({},{originalEvent:a})}),Fa.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(a){return e._map.zoomOut({},{originalEvent:a})}),Fa.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(ea.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(a){e.options.visualizePitch?e._map.resetNorthPitch({},{originalEvent:a}):e._map.resetNorth({},{originalEvent:a})}),this._compassIcon=Fa.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Sr.prototype._updateZoomButtons=function(){var e=this._map.getZoom();this._zoomInButton.disabled=e===this._map.getMaxZoom(),this._zoomOutButton.disabled=e===this._map.getMinZoom()},Sr.prototype._rotateCompassArrow=function(){var e=this.options.visualizePitch?"scale("+1/pa(Ge(this._map.transform.pitch*(Ke/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Ke)+"deg)":"rotate("+this._map.transform.angle*(180/Ke)+"deg)";this._compassIcon.style.transform=e},Sr.prototype.onAdd=function(e){return this._map=e,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Cr(this._map,this._compass,this.options.visualizePitch)),this._container},Sr.prototype.onRemove=function(){Fa.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Sr.prototype._createButton=function(a,t){var e=Fa.create("button",a,this._container);return e.type="button",e.addEventListener("click",t),e},Sr.prototype._setButtonTitle=function(a,t){var e=this._map._getUIString("NavigationControl."+t);a.title=e,a.setAttribute("aria-label",e)};var Cr=function(t,e,a){void 0===a&&(a=!1),this._clickTolerance=10,this.element=e,this.mouseRotate=new Vo({clickTolerance:t.dragRotate._mouseRotate._clickTolerance}),this.map=t,a&&(this.mousePitch=new Go({clickTolerance:t.dragRotate._mousePitch._clickTolerance})),ea.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),Fa.addEventListener(e,"mousedown",this.mousedown),Fa.addEventListener(e,"touchstart",this.touchstart,{passive:!1}),Fa.addEventListener(e,"touchmove",this.touchmove),Fa.addEventListener(e,"touchend",this.touchend),Fa.addEventListener(e,"touchcancel",this.reset)};Cr.prototype.down=function(a,t){this.mouseRotate.mousedown(a,t),this.mousePitch&&this.mousePitch.mousedown(a,t),Fa.disableDrag()},Cr.prototype.move=function(a,t){var e=this.map,i=this.mouseRotate.mousemoveWindow(a,t);if(i&&i.bearingDelta&&e.setBearing(e.getBearing()+i.bearingDelta),this.mousePitch){var o=this.mousePitch.mousemoveWindow(a,t);o&&o.pitchDelta&&e.setPitch(e.getPitch()+o.pitchDelta)}},Cr.prototype.off=function(){var e=this.element;Fa.removeEventListener(e,"mousedown",this.mousedown),Fa.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),Fa.removeEventListener(e,"touchmove",this.touchmove),Fa.removeEventListener(e,"touchend",this.touchend),Fa.removeEventListener(e,"touchcancel",this.reset),this.offTemp()},Cr.prototype.offTemp=function(){Fa.enableDrag(),Fa.removeEventListener(ea.window,"mousemove",this.mousemove),Fa.removeEventListener(ea.window,"mouseup",this.mouseup)},Cr.prototype.mousedown=function(t){this.down(ea.extend({},t,{ctrlKey:!0,preventDefault:function(){return t.preventDefault()}}),Fa.mousePos(this.element,t)),Fa.addEventListener(ea.window,"mousemove",this.mousemove),Fa.addEventListener(ea.window,"mouseup",this.mouseup)},Cr.prototype.mousemove=function(e){this.move(e,Fa.mousePos(this.element,e))},Cr.prototype.mouseup=function(e){this.mouseRotate.mouseupWindow(e),this.mousePitch&&this.mousePitch.mouseupWindow(e),this.offTemp()},Cr.prototype.touchstart=function(e){1===e.targetTouches.length?(this._startPos=this._lastPos=Fa.touchPos(this.element,e.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return e.preventDefault()}},this._startPos)):this.reset()},Cr.prototype.touchmove=function(e){1===e.targetTouches.length?(this._lastPos=Fa.touchPos(this.element,e.targetTouches)[0],this.move({preventDefault:function(){return e.preventDefault()}},this._lastPos)):this.reset()},Cr.prototype.touchend=function(e){0===e.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Cr.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var zr={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},Mr=function(t){function e(e,i){var r=this;if(t.call(this),(e instanceof ea.window.HTMLElement||i)&&(e=ea.extend({element:e},i)),ea.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._draggable=e&&e.draggable||!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&"auto"!==e.pitchAlignment?e.pitchAlignment:this._rotationAlignment,e&&e.element)this._element=e.element,this._offset=ea.Point.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=Fa.create("div"),this._element.setAttribute("aria-label","Map marker");var a=Fa.createNS("http://www.w3.org/2000/svg","svg");a.setAttributeNS(null,"display","block"),a.setAttributeNS(null,"height","41px"),a.setAttributeNS(null,"width","27px"),a.setAttributeNS(null,"viewBox","0 0 27 41");var n=Fa.createNS("http://www.w3.org/2000/svg","g");n.setAttributeNS(null,"stroke","none"),n.setAttributeNS(null,"stroke-width","1"),n.setAttributeNS(null,"fill","none"),n.setAttributeNS(null,"fill-rule","evenodd");var s=Fa.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"fill-rule","nonzero");var l=Fa.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"transform","translate(3.0, 29.0)"),l.setAttributeNS(null,"fill","#000000");for(var c=0,w=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];c<w.length;c+=1){var h=w[c],p=Fa.createNS("http://www.w3.org/2000/svg","ellipse");p.setAttributeNS(null,"opacity","0.04"),p.setAttributeNS(null,"cx","10.5"),p.setAttributeNS(null,"cy","5.80029008"),p.setAttributeNS(null,"rx",h.rx),p.setAttributeNS(null,"ry",h.ry),l.appendChild(p)}var d=Fa.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"fill",this._color);var _=Fa.createNS("http://www.w3.org/2000/svg","path");_.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),d.appendChild(_);var f=Fa.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"opacity","0.25"),f.setAttributeNS(null,"fill","#000000");var m=Fa.createNS("http://www.w3.org/2000/svg","path");m.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),f.appendChild(m);var g=Fa.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"transform","translate(6.0, 7.0)"),g.setAttributeNS(null,"fill","#FFFFFF");var v=Fa.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"transform","translate(8.0, 8.0)");var y=Fa.createNS("http://www.w3.org/2000/svg","circle");y.setAttributeNS(null,"fill","#000000"),y.setAttributeNS(null,"opacity","0.25"),y.setAttributeNS(null,"cx","5.5"),y.setAttributeNS(null,"cy","5.5"),y.setAttributeNS(null,"r","5.4999962");var x=Fa.createNS("http://www.w3.org/2000/svg","circle");x.setAttributeNS(null,"fill","#FFFFFF"),x.setAttributeNS(null,"cx","5.5"),x.setAttributeNS(null,"cy","5.5"),x.setAttributeNS(null,"r","5.4999962"),v.appendChild(y),v.appendChild(x),s.appendChild(l),s.appendChild(d),s.appendChild(f),s.appendChild(g),s.appendChild(v),a.appendChild(s),this._element.appendChild(a),this._offset=ea.Point.convert(e&&e.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(e){e.preventDefault()}),this._element.addEventListener("mousedown",function(e){e.preventDefault()}),this._element.addEventListener("focus",function(){var e=r._map.getContainer();e.scrollTop=0,e.scrollLeft=0}),Ra(this._element,this._anchor,"marker"),this._popup=null}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.addTo=function(e){return this.remove(),this._map=e,e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},e.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),Fa.remove(this._element),this._popup&&this._popup.remove(),this},e.prototype.getLngLat=function(){return this._lngLat},e.prototype.setLngLat=function(t){return this._lngLat=ea.LngLat.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},e.prototype.getElement=function(){return this._element},e.prototype.setPopup=function(a){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),a){if(!("offset"in a.options)){var t=We(pa(13.5,2)/2);a.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[t,-1*(24.6+t)],"bottom-right":[-t,-1*(24.6+t)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=a,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},e.prototype._onKeyPress=function(a){var t=a.code,e=a.charCode||a.keyCode;"Space"!==t&&"Enter"!==t&&32!==e&&13!==e||this.togglePopup()},e.prototype._onMapClick=function(a){var t=a.originalEvent.target,e=this._element;this._popup&&(t===e||e.contains(t))&&this.togglePopup()},e.prototype.getPopup=function(){return this._popup},e.prototype.togglePopup=function(){var e=this._popup;return e?(e.isOpen()?e.remove():e.addTo(this._map),this):this},e.prototype._update=function(a){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Oa(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var t="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?t="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(t="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var r="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?r="rotateX(0deg)":"map"===this._pitchAlignment&&(r="rotateX("+this._map.getPitch()+"deg)"),a&&"moveend"!==a.type||(this._pos=this._pos.round()),Fa.setTransform(this._element,zr[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+r+" "+t)}},e.prototype.getOffset=function(){return this._offset},e.prototype.setOffset=function(t){return this._offset=ea.Point.convert(t),this._update(),this},e.prototype._onMove=function(t){this._pos=t.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new ea.Event("dragstart"))),this.fire(new ea.Event("drag"))},e.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new ea.Event("dragend")),this._state="inactive"},e.prototype._addDragHandler=function(e){this._element.contains(e.originalEvent.target)&&(e.preventDefault(),this._positionDelta=e.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},e.prototype.setDraggable=function(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},e.prototype.isDraggable=function(){return this._draggable},e.prototype.setRotation=function(e){return this._rotation=e||0,this._update(),this},e.prototype.getRotation=function(){return this._rotation},e.prototype.setRotationAlignment=function(e){return this._rotationAlignment=e||"auto",this._update(),this},e.prototype.getRotationAlignment=function(){return this._rotationAlignment},e.prototype.setPitchAlignment=function(e){return this._pitchAlignment=e&&"auto"!==e?e:this._rotationAlignment,this._update(),this},e.prototype.getPitchAlignment=function(){return this._pitchAlignment},e}(ea.Evented),Rr={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},kr=0,gi=!1,mi=function(t){function e(e){t.call(this),this.options=ea.extend({},Rr,e),ea.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.onAdd=function(t){var e;return this._map=t,this._container=Fa.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),e=this._setupUI,void 0===Nr?void 0===ea.window.navigator.permissions?e(Nr=!!ea.window.navigator.geolocation):ea.window.navigator.permissions.query({name:"geolocation"}).then(function(a){e(Nr="denied"!==a.state)}):e(Nr),this._container},e.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(ea.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),Fa.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,kr=0,gi=!1},e.prototype._isOutOfMapMaxBounds=function(a){var t=this._map.getMaxBounds(),e=a.coords;return t&&(e.longitude<t.getWest()||e.longitude>t.getEast()||e.latitude<t.getSouth()||e.latitude>t.getNorth())},e.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");}},e.prototype._onSuccess=function(t){if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new ea.Event("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(t),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new ea.Event("geolocate",t)),this._finish()}},e.prototype._updateCamera=function(t){var e=new ea.LngLat(t.coords.longitude,t.coords.latitude),i=t.coords.accuracy,o=this._map.getBearing(),r=ea.extend({bearing:o},this.options.fitBoundsOptions);this._map.fitBounds(e.toBounds(i),r,{geolocateSource:!0})},e.prototype._updateMarker=function(t){if(t){var e=new ea.LngLat(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(e).addTo(this._map),this._userLocationDotMarker.setLngLat(e).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},e.prototype._updateCircleRadius=function(){var a=this._map._container.clientHeight/2,t=this._map.unproject([0,a]),e=this._map.unproject([1,a]),i=t.distanceTo(e),o=Ye(2*this._accuracy/i);this._circleElement.style.width=o+"px",this._circleElement.style.height=o+"px"},e.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},e.prototype._onError=function(t){if(this._map){if(this.options.trackUserLocation)if(1===t.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===t.code&&gi)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new ea.Event("error",t)),this._finish()}},e.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},e.prototype._setupUI=function(t){var i=this;if(this._container.addEventListener("contextmenu",function(e){return e.preventDefault()}),this._geolocateButton=Fa.create("button","mapboxgl-ctrl-geolocate",this._container),Fa.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===t){ea.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e)}else{var o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Fa.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Mr(this._dotElement),this._circleElement=Fa.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Mr({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(t){t.geolocateSource||"ACTIVE_LOCK"!==i._watchState||t.originalEvent&&"resize"===t.originalEvent.type||(i._watchState="BACKGROUND",i._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),i._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),i.fire(new ea.Event("trackuserlocationend")))})},e.prototype.trigger=function(){if(!this._setup)return ea.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new ea.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":kr--,gi=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new ea.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new ea.Event("trackuserlocationstart"));}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error");}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var t;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),1<++kr?(t={maximumAge:6e5,timeout:0},gi=!0):(t=this.options.positionOptions,gi=!1),this._geolocationWatchID=ea.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,t)}}else ea.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},e.prototype._clearWatch=function(){ea.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},e}(ea.Evented),Fr={maxWidth:100,unit:"metric"},Ur=function(t){this.options=ea.extend({},Fr,t),ea.bindAll(["_onMove","setUnit"],this)},Nr;Ur.prototype.getDefaultPosition=function(){return"bottom-left"},Ur.prototype._onMove=function(){Ma(this._map,this._container,this.options)},Ur.prototype.onAdd=function(e){return this._map=e,this._container=Fa.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",e.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Ur.prototype.onRemove=function(){Fa.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Ur.prototype.setUnit=function(e){this.options.unit=e,Ma(this._map,this._container,this.options)};var hi=function(t){this._fullscreen=!1,t&&t.container&&(t.container instanceof ea.window.HTMLElement?this._container=t.container:ea.warnOnce("Full screen control 'container' must be a DOM element.")),ea.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in ea.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in ea.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in ea.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in ea.window.document&&(this._fullscreenchange="MSFullscreenChange")};hi.prototype.onAdd=function(t){return this._map=t,this._container||(this._container=this._map.getContainer()),this._controlContainer=Fa.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",ea.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},hi.prototype.onRemove=function(){Fa.remove(this._controlContainer),this._map=null,ea.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},hi.prototype._checkFullscreenSupport=function(){return!!(ea.window.document.fullscreenEnabled||ea.window.document.mozFullScreenEnabled||ea.window.document.msFullscreenEnabled||ea.window.document.webkitFullscreenEnabled)},hi.prototype._setupUI=function(){var t=this._fullscreenButton=Fa.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Fa.create("span","mapboxgl-ctrl-icon",t).setAttribute("aria-hidden",!0),t.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),ea.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},hi.prototype._updateTitle=function(){var e=this._getTitle();this._fullscreenButton.setAttribute("aria-label",e),this._fullscreenButton.title=e},hi.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},hi.prototype._isFullscreen=function(){return this._fullscreen},hi.prototype._changeIcon=function(){(ea.window.document.fullscreenElement||ea.window.document.mozFullScreenElement||ea.window.document.webkitFullscreenElement||ea.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},hi.prototype._onClickFullscreen=function(){this._isFullscreen()?ea.window.document.exitFullscreen?ea.window.document.exitFullscreen():ea.window.document.mozCancelFullScreen?ea.window.document.mozCancelFullScreen():ea.window.document.msExitFullscreen?ea.window.document.msExitFullscreen():ea.window.document.webkitCancelFullScreen&&ea.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var qr={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},Vr=function(t){function e(e){t.call(this),this.options=ea.extend(Object.create(qr),e),ea.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.addTo=function(t){return this._map&&this.remove(),this._map=t,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new ea.Event("open")),this},e.prototype.isOpen=function(){return!!this._map},e.prototype.remove=function(){return this._content&&Fa.remove(this._content),this._container&&(Fa.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new ea.Event("close")),this},e.prototype.getLngLat=function(){return this._lngLat},e.prototype.setLngLat=function(t){return this._lngLat=ea.LngLat.convert(t),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},e.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},e.prototype.getElement=function(){return this._container},e.prototype.setText=function(t){return this.setDOMContent(ea.window.document.createTextNode(t))},e.prototype.setHTML=function(t){var e=ea.window.document.createDocumentFragment(),a=ea.window.document.createElement("body"),o;for(a.innerHTML=t;o=a.firstChild;)e.appendChild(o);return this.setDOMContent(e)},e.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},e.prototype.setMaxWidth=function(e){return this.options.maxWidth=e,this._update(),this},e.prototype.setDOMContent=function(e){return this._createContent(),this._content.appendChild(e),this._update(),this},e.prototype.addClassName=function(e){this._container&&this._container.classList.add(e)},e.prototype.removeClassName=function(e){this._container&&this._container.classList.remove(e)},e.prototype.toggleClassName=function(e){if(this._container)return this._container.classList.toggle(e)},e.prototype._createContent=function(){this._content&&Fa.remove(this._content),this._content=Fa.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=Fa.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},e.prototype._onMouseUp=function(e){this._update(e.point)},e.prototype._onMouseMove=function(e){this._update(e.point)},e.prototype._onDrag=function(e){this._update(e.point)},e.prototype._update=function(t){var e=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=Fa.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=Fa.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(a){return e._container.classList.add(a)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Oa(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||t)){var o=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat),r=this.options.anchor,i=function t(e){if(e){if("number"==typeof e){var a=Xe(We(.5*pa(e,2)));return{center:new ea.Point(0,0),top:new ea.Point(0,e),"top-left":new ea.Point(a,a),"top-right":new ea.Point(-a,a),bottom:new ea.Point(0,-e),"bottom-left":new ea.Point(a,-a),"bottom-right":new ea.Point(-a,-a),left:new ea.Point(e,0),right:new ea.Point(-e,0)}}if(e instanceof ea.Point||Array.isArray(e)){var o=ea.Point.convert(e);return{center:o,top:o,"top-left":o,"top-right":o,bottom:o,"bottom-left":o,"bottom-right":o,left:o,right:o}}return{center:ea.Point.convert(e.center||[0,0]),top:ea.Point.convert(e.top||[0,0]),"top-left":ea.Point.convert(e["top-left"]||[0,0]),"top-right":ea.Point.convert(e["top-right"]||[0,0]),bottom:ea.Point.convert(e.bottom||[0,0]),"bottom-left":ea.Point.convert(e["bottom-left"]||[0,0]),"bottom-right":ea.Point.convert(e["bottom-right"]||[0,0]),left:ea.Point.convert(e.left||[0,0]),right:ea.Point.convert(e.right||[0,0])}}return t(new ea.Point(0,0))}(this.options.offset);if(!r){var n=this._container.offsetWidth,l=this._container.offsetHeight,d;d=o.y+i.bottom.y<l?["top"]:o.y>this._map.transform.height-l?["bottom"]:[],o.x<n/2?d.push("left"):o.x>this._map.transform.width-n/2&&d.push("right"),r=0===d.length?"bottom":d.join("-")}var c=o.add(i[r]).round();Fa.setTransform(this._container,zr[r]+" translate("+c.x+"px,"+c.y+"px)"),Ra(this._container,r,"popup")}},e.prototype._onClose=function(){this.remove()},e}(ea.Evented),Gr={version:ea.version,supported:Ba,setRTLTextPlugin:ea.setRTLTextPlugin,getRTLTextPluginStatus:ea.getRTLTextPluginStatus,Map:Er,NavigationControl:Sr,GeolocateControl:mi,AttributionControl:mr,ScaleControl:Ur,FullscreenControl:hi,Popup:Vr,Marker:Mr,Style:je,LngLat:ea.LngLat,LngLatBounds:ea.LngLatBounds,Point:ea.Point,MercatorCoordinate:ea.MercatorCoordinate,Evented:ea.Evented,config:ea.config,prewarm:function(){Lt().acquire("mapboxgl_preloaded_worker_pool")},clearPrewarmedResources:function(){var e=Ot;e&&(e.isPreloaded()&&1===e.numActive()?(e.release("mapboxgl_preloaded_worker_pool"),Ot=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return ea.config.ACCESS_TOKEN},set accessToken(t){ea.config.ACCESS_TOKEN=t},get baseApiUrl(){return ea.config.API_URL},set baseApiUrl(t){ea.config.API_URL=t},get workerCount(){return Dt.workerCount},set workerCount(e){Dt.workerCount=e},get maxParallelImageRequests(){return ea.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(t){ea.config.MAX_PARALLEL_IMAGE_REQUESTS=t},clearStorage:function(t){ea.clearTileCache(t)},workerUrl:""};return Gr}),r})},{}],397:[function(e,t){'use strict';function a(e,t,a){for(var o=Array(e),r=0;r<e;++r)o[r]=0,r===t&&(o[r]+=.5),r===a&&(o[r]+=.5);return o}function o(e,t){if(0===t||t===(1<<e+1)-1)return[];for(var o=[],n=[],l=0;l<=e;++l)if(t&1<<l){o.push(a(e,l-1,l-1)),n.push(null);for(var s=0;s<=e;++s)~t&1<<s&&(o.push(a(e,l-1,s-1)),n.push([l,s]))}var d=r(o),c=[];i_loop:for(var l=0;l<d.length;++l){for(var p=d[l],u=[],s=0;s<p.length;++s){if(!n[p[s]])continue i_loop;u.push(n[p[s]].slice())}c.push(u)}return c}t.exports=function(e){for(var t=1<<e+1,a=Array(t),r=0;r<t;++r)a[r]=o(e,r);return a};var r=e("convex-hull")},{"convex-hull":77}],398:[function(e,t){var n=Math.sqrt,l=Math.abs,s=Math.max;function a(e,t,a){var o=t[0],r=t[1],i=t[2],n=t[3];return e[0]=a[0]*o+a[4]*r+a[8]*i+a[12]*n,e[1]=a[1]*o+a[5]*r+a[9]*i+a[13]*n,e[2]=a[2]*o+a[6]*r+a[10]*i+a[14]*n,e[3]=a[3]*o+a[7]*r+a[11]*i+a[15]*n,e}function o(e,t){e[0][0]=t[0],e[0][1]=t[1],e[0][2]=t[2],e[1][0]=t[4],e[1][1]=t[5],e[1][2]=t[6],e[2][0]=t[8],e[2][1]=t[9],e[2][2]=t[10]}function r(e,t,a,o,r){e[0]=t[0]*o+a[0]*r,e[1]=t[1]*o+a[1]*r,e[2]=t[2]*o+a[2]*r}var d=e("./normalize"),c=e("gl-mat4/create"),p=e("gl-mat4/clone"),u=e("gl-mat4/determinant"),g=e("gl-mat4/invert"),m=e("gl-mat4/transpose"),h={length:e("gl-vec3/length"),normalize:e("gl-vec3/normalize"),dot:e("gl-vec3/dot"),cross:e("gl-vec3/cross")},y=c(),f=c(),x=[0,0,0,0],_=[[0,0,0],[0,0,0],[0,0,0]],b=[0,0,0];t.exports=function(e,t,c,v,w,k){if(t||(t=[0,0,0]),c||(c=[0,0,0]),v||(v=[0,0,0]),w||(w=[0,0,0,1]),k||(k=[0,0,0,1]),!d(y,e))return!1;if(p(f,y),f[3]=0,f[7]=0,f[11]=0,f[15]=1,l(1e-8>u(f)))return!1;var T=y[3],A=y[7],S=y[11],C=y[12],L=y[13],E=y[14],I=y[15];if(0!==T||0!==A||0!==S){x[0]=T,x[1]=A,x[2]=S,x[3]=I;var P=g(f,f);if(!P)return!1;m(f,f),a(w,x,f)}else w[0]=w[1]=w[2]=0,w[3]=1;if(t[0]=C,t[1]=L,t[2]=E,o(_,y),c[0]=h.length(_[0]),h.normalize(_[0],_[0]),v[0]=h.dot(_[0],_[1]),r(_[1],_[1],_[0],1,-v[0]),c[1]=h.length(_[1]),h.normalize(_[1],_[1]),v[0]/=c[1],v[1]=h.dot(_[0],_[2]),r(_[2],_[2],_[0],1,-v[1]),v[2]=h.dot(_[1],_[2]),r(_[2],_[2],_[1],1,-v[2]),c[2]=h.length(_[2]),h.normalize(_[2],_[2]),v[1]/=c[2],v[2]/=c[2],h.cross(b,_[1],_[2]),0>h.dot(_[0],b))for(var z=0;3>z;z++)c[z]*=-1,_[z][0]*=-1,_[z][1]*=-1,_[z][2]*=-1;return k[0]=.5*n(s(1+_[0][0]-_[1][1]-_[2][2],0)),k[1]=.5*n(s(1-_[0][0]+_[1][1]-_[2][2],0)),k[2]=.5*n(s(1-_[0][0]-_[1][1]+_[2][2],0)),k[3]=.5*n(s(1+_[0][0]+_[1][1]+_[2][2],0)),_[2][1]>_[1][2]&&(k[0]=-k[0]),_[0][2]>_[2][0]&&(k[1]=-k[1]),_[1][0]>_[0][1]&&(k[2]=-k[2]),!0}},{"./normalize":399,"gl-mat4/clone":236,"gl-mat4/create":237,"gl-mat4/determinant":238,"gl-mat4/invert":242,"gl-mat4/transpose":253,"gl-vec3/cross":304,"gl-vec3/dot":309,"gl-vec3/length":319,"gl-vec3/normalize":326}],399:[function(e,t){t.exports=function(e,t){var a=t[15];if(0===a)return!1;for(var o=0;16>o;o++)e[o]=t[o]*(1/a);return!0}},{}],400:[function(e,t){function a(){return{translate:o(),scale:o(1),skew:o(),perspective:r(),quaternion:r()}}function o(e){return[e||0,e||0,e||0]}function r(){return[0,0,0,1]}var i=e("gl-vec3/lerp"),n=e("mat4-recompose"),l=e("mat4-decompose"),s=e("gl-mat4/determinant"),d=e("quat-slerp"),c=a(),p=a(),u=a();t.exports=function(e,t,a,o){if(0===s(t)||0===s(a))return!1;var r=l(t,c.translate,c.scale,c.skew,c.perspective,c.quaternion),g=l(a,p.translate,p.scale,p.skew,p.perspective,p.quaternion);return!!(r&&g)&&(i(u.translate,c.translate,p.translate,o),i(u.skew,c.skew,p.skew,o),i(u.scale,c.scale,p.scale,o),i(u.perspective,c.perspective,p.perspective,o),d(u.quaternion,c.quaternion,p.quaternion,o),n(e,u.translate,u.scale,u.skew,u.perspective,u.quaternion),!0)}},{"gl-mat4/determinant":238,"gl-vec3/lerp":320,"mat4-decompose":398,"mat4-recompose":401,"quat-slerp":1258}],401:[function(e,t){var a={identity:e("gl-mat4/identity"),translate:e("gl-mat4/translate"),multiply:e("gl-mat4/multiply"),create:e("gl-mat4/create"),scale:e("gl-mat4/scale"),fromRotationTranslation:e("gl-mat4/fromRotationTranslation")},o=a.create(),r=a.create();t.exports=function(e,t,o,i,n,l){return a.identity(e),a.fromRotationTranslation(e,l,t),e[3]=n[0],e[7]=n[1],e[11]=n[2],e[15]=n[3],a.identity(r),0!==i[2]&&(r[9]=i[2],a.multiply(e,e,r)),0!==i[1]&&(r[9]=0,r[8]=i[1],a.multiply(e,e,r)),0!==i[0]&&(r[8]=0,r[4]=i[0],a.multiply(e,e,r)),a.scale(e,e,o),e}},{"gl-mat4/create":237,"gl-mat4/fromRotationTranslation":240,"gl-mat4/identity":241,"gl-mat4/multiply":244,"gl-mat4/scale":251,"gl-mat4/translate":252}],402:[function(e,t){'use strict';t.exports=Math.log2||function(e){return Math.log(e)*Math.LOG2E}},{}],403:[function(e,t){'use strict';var o=Math.exp;function a(e){this._components=e.slice(),this._time=[0],this.prevMatrix=e.slice(),this.nextMatrix=e.slice(),this.computedMatrix=e.slice(),this.computedInverse=e.slice(),this.computedEye=[0,0,0],this.computedUp=[0,0,0],this.computedCenter=[0,0,0],this.computedRadius=[0],this._limits=[-Infinity,1/0]}var r=e("binary-search-bounds"),n=e("mat4-interpolate"),l=e("gl-mat4/invert"),s=e("gl-mat4/rotateX"),d=e("gl-mat4/rotateY"),c=e("gl-mat4/rotateZ"),p=e("gl-mat4/lookAt"),u=e("gl-mat4/translate"),g=e("gl-mat4/scale"),m=e("gl-vec3/normalize"),h=[0,0,0];t.exports=function(e){e=e||{};var t=e.matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return new a(t)};var y=a.prototype;y.recalcMatrix=function(e){var t=this._time,a=r.le(t,e),s=this.computedMatrix;if(!(0>a)){var d=this._components;if(a===t.length-1)for(var c=16*a,p=0;16>p;++p)s[p]=d[c++];else{for(var u=t[a+1]-t[a],c=16*a,g=this.prevMatrix,h=!0,p=0;16>p;++p)g[p]=d[c++];for(var y=this.nextMatrix,p=0;16>p;++p)y[p]=d[c++],h=h&&g[p]===y[p];if(1e-6>u||h)for(var p=0;16>p;++p)s[p]=g[p];else n(s,g,y,(e-t[a])/u)}var f=this.computedUp;f[0]=s[1],f[1]=s[5],f[2]=s[9],m(f,f);var x=this.computedInverse;l(x,s);var _=this.computedEye,b=x[15];_[0]=x[12]/b,_[1]=x[13]/b,_[2]=x[14]/b;for(var v=this.computedCenter,w=o(this.computedRadius[0]),p=0;3>p;++p)v[p]=_[p]-s[2+4*p]*w}},y.idle=function(e){if(!(e<this.lastT())){for(var t=this._components,a=t.length-16,o=0;16>o;++o)t.push(t[a++]);this._time.push(e)}},y.flush=function(e){var t=r.gt(this._time,e)-2;0>t||(this._time.splice(0,t),this._components.splice(0,16*t))},y.lastT=function(){return this._time[this._time.length-1]},y.lookAt=function(e,t,a,o){this.recalcMatrix(e),t=t||this.computedEye,a=a||h,o=o||this.computedUp,this.setMatrix(e,p(this.computedMatrix,t,a,o));for(var r=0,n=0;3>n;++n)r+=Math.pow(a[n]-t[n],2);r=Math.log(Math.sqrt(r)),this.computedRadius[0]=r},y.rotate=function(e,t,a,o){this.recalcMatrix(e);var r=this.computedInverse;t&&d(r,r,t),a&&s(r,r,a),o&&c(r,r,o),this.setMatrix(e,l(this.computedMatrix,r))};var f=[0,0,0];y.pan=function(e,t,a,o){f[0]=-(t||0),f[1]=-(a||0),f[2]=-(o||0),this.recalcMatrix(e);var r=this.computedInverse;u(r,r,f),this.setMatrix(e,l(r,r))},y.translate=function(e,t,a,o){f[0]=t||0,f[1]=a||0,f[2]=o||0,this.recalcMatrix(e);var r=this.computedMatrix;u(r,r,f),this.setMatrix(e,r)},y.setMatrix=function(e,t){if(!(e<this.lastT())){this._time.push(e);for(var a=0;16>a;++a)this._components.push(t[a])}},y.setDistance=function(e,t){this.computedRadius[0]=t},y.setDistanceLimits=function(e,t){var a=this._limits;a[0]=e,a[1]=t},y.getDistanceLimits=function(e){var t=this._limits;return e?(e[0]=t[0],e[1]=t[1],e):t}},{"binary-search-bounds":404,"gl-mat4/invert":242,"gl-mat4/lookAt":243,"gl-mat4/rotateX":248,"gl-mat4/rotateY":249,"gl-mat4/rotateZ":250,"gl-mat4/scale":251,"gl-mat4/translate":252,"gl-vec3/normalize":326,"mat4-interpolate":400}],404:[function(e,t,a){arguments[4][204][0].apply(a,arguments)},{dup:204}],405:[function(a,o,r){!function(i,e){"object"==typeof r&&"object"==typeof o?o.exports=e(a("matter-js")):"function"==typeof define&&define.amd?define(["matter-js"],e):"object"==typeof r?r.MatterCollisionEvents=e(a("matter-js")):i.MatterCollisionEvents=e(i.Matter)}(this,function(a){return function(a){function i(t){if(e[t])return e[t].exports;var o=e[t]={i:t,l:!1,exports:{}};return a[t].call(o.exports,o,o.exports,i),o.l=!0,o.exports}var e={};return i.m=a,i.c=e,i.i=function(t){return t},i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:a})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(a,e){return Object.prototype.hasOwnProperty.call(a,e)},i.p="",i(i.s=1)}([function(e){e.exports=a},function(a,e,t){var i=t(0),o={name:"matter-collision-events",version:"0.1.5",for:"matter-js@^0.12.0",install:function(a){var o=a.Body.create;a.Body.create=function(){var a=o.apply(null,arguments);return a.onCollide=function(e){a._mceOC=e},a.onCollideEnd=function(e){a._mceOCE=e},a.onCollideActive=function(e){a._mceOCA=e},a},a.after("Engine.create",function(){a.Events.on(this,"collisionStart",function(e){e.pairs.map(function(e){a.Events.trigger(e.bodyA,"onCollide",{pair:e}),a.Events.trigger(e.bodyB,"onCollide",{pair:e}),e.bodyA._mceOC&&e.bodyA._mceOC(e),e.bodyB._mceOC&&e.bodyB._mceOC(e)})}),a.Events.on(this,"collisionActive",function(e){e.pairs.map(function(e){a.Events.trigger(e.bodyA,"onCollideActive",{pair:e}),a.Events.trigger(e.bodyB,"onCollideActive",{pair:e}),e.bodyA._mceOCA&&e.bodyA._mceOCA(e),e.bodyB._mceOCA&&e.bodyB._mceOCA(e)})}),a.Events.on(this,"collisionEnd",function(e){e.pairs.map(function(e){a.Events.trigger(e.bodyA,"onCollideEnd",{pair:e}),a.Events.trigger(e.bodyB,"onCollideEnd",{pair:e}),e.bodyA._mceOCE&&e.bodyA._mceOCE(e),e.bodyB._mceOCE&&e.bodyB._mceOCE(e)})})})}};i.Plugin.register(o),a.exports.MatterCollisionEvents=o}])})},{"matter-js":406}],406:[function(e,t,a){var o=Number.MAX_VALUE,r=Math.cos,n=Math.ceil,l=Math.sqrt,s=Math.round,d=Math.PI,c=Math.sin,p=Math.min,u=Math.pow,g=Math.abs,m=Math.max,h=Math.floor;(function(i){(function(e){if("object"==typeof a&&"undefined"!=typeof t)t.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var o;o="undefined"==typeof window?"undefined"==typeof i?"undefined"==typeof self?this:self:i:window,o.Matter=e()}})(function(){return function d(c,t,n){function a(i,o){if(!t[i]){if(!c[i]){var s="function"==typeof e&&e;if(!o&&s)return s(i,!0);if(r)return r(i,!0);var p=new Error("Cannot find module '"+i+"'");throw p.code="MODULE_NOT_FOUND",p}var u=t[i]={exports:{}};c[i][0].call(u.exports,function(t){var e=c[i][1][t];return a(e?e:t)},u,u.exports,d,c,t,n)}return t[i].exports}for(var r="function"==typeof e&&e,i=0;i<n.length;i++)a(n[i]);return a}({1:[function(e,t){var a={};t.exports=a;var o=e("../geometry/Vertices"),r=e("../geometry/Vector"),i=e("../core/Sleeping"),n=e("../render/Render"),l=e("../core/Common"),s=e("../geometry/Bounds"),d=e("../geometry/Axes");(function(){a._inertiaScale=4,a._nextCollidingGroupId=1,a._nextNonCollidingGroupId=-1,a._nextCategory=1,a.create=function(t){var a={id:l.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:o.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0},lineWidth:0}},r=l.extend(a,t);return e(r,t),r},a.nextGroup=function(e){return e?a._nextNonCollidingGroupId--:a._nextCollidingGroupId++},a.nextCategory=function(){return a._nextCategory<<=1,a._nextCategory};var e=function(e,t){t=t||{},a.set(e,{bounds:e.bounds||s.create(e.vertices),positionPrev:e.positionPrev||r.clone(e.position),anglePrev:e.anglePrev||e.angle,vertices:e.vertices,parts:e.parts||[e],isStatic:e.isStatic,isSleeping:e.isSleeping,parent:e.parent||e}),o.rotate(e.vertices,e.angle,e.position),d.rotate(e.axes,e.angle),s.update(e.bounds,e.vertices,e.velocity),a.set(e,{axes:t.axes||e.axes,area:t.area||e.area,mass:t.mass||e.mass,inertia:t.inertia||e.inertia});var i=e.isStatic?"#2e2b44":l.choose(["#006BA6","#0496FF","#FFBC42","#D81159","#8F2D56"]),n=l.shadeColor(i,-20);e.render.fillStyle=e.render.fillStyle||i,e.render.strokeStyle=e.render.strokeStyle||n,e.render.sprite.xOffset+=-(e.bounds.min.x-e.position.x)/(e.bounds.max.x-e.bounds.min.x),e.render.sprite.yOffset+=-(e.bounds.min.y-e.position.y)/(e.bounds.max.y-e.bounds.min.y)};a.set=function(e,t,o){for(var r in"string"==typeof t&&(r=t,t={},t[r]=o),t)o=t[r],t.hasOwnProperty(r)&&("isStatic"===r?a.setStatic(e,o):"isSleeping"===r?i.set(e,o):"mass"===r?a.setMass(e,o):"density"===r?a.setDensity(e,o):"inertia"===r?a.setInertia(e,o):"vertices"===r?a.setVertices(e,o):"position"===r?a.setPosition(e,o):"angle"===r?a.setAngle(e,o):"velocity"===r?a.setVelocity(e,o):"angularVelocity"===r?a.setAngularVelocity(e,o):"parts"===r?a.setParts(e,o):e[r]=o)},a.setStatic=function(e,t){for(var a=0,o;a<e.parts.length;a++)o=e.parts[a],o.isStatic=t,t?(o._original={restitution:o.restitution,friction:o.friction,mass:o.mass,inertia:o.inertia,density:o.density,inverseMass:o.inverseMass,inverseInertia:o.inverseInertia},o.restitution=0,o.friction=1,o.mass=o.inertia=o.density=1/0,o.inverseMass=o.inverseInertia=0,o.positionPrev.x=o.position.x,o.positionPrev.y=o.position.y,o.anglePrev=o.angle,o.angularVelocity=0,o.speed=0,o.angularSpeed=0,o.motion=0):o._original&&(o.restitution=o._original.restitution,o.friction=o._original.friction,o.mass=o._original.mass,o.inertia=o._original.inertia,o.density=o._original.density,o.inverseMass=o._original.inverseMass,o.inverseInertia=o._original.inverseInertia,delete o._original)},a.setMass=function(e,t){e.mass=t,e.inverseMass=1/e.mass,e.density=e.mass/e.area},a.setDensity=function(e,t){a.setMass(e,t*e.area),e.density=t},a.setInertia=function(e,t){e.inertia=t,e.inverseInertia=1/e.inertia},a.setVertices=function(e,t){e.vertices=t[0].body===e?t:o.create(t,e),e.axes=d.fromVertices(e.vertices),e.area=o.area(e.vertices),a.setMass(e,e.density*e.area);var r=o.centre(e.vertices);o.translate(e.vertices,r,-1),a.setInertia(e,a._inertiaScale*o.inertia(e.vertices,e.mass)),o.translate(e.vertices,e.position),s.update(e.bounds,e.vertices,e.velocity)},a.setParts=function(e,r,n){var l;for(r=r.slice(0),e.parts.length=0,e.parts.push(e),e.parent=e,l=0;l<r.length;l++){var s=r[l];s!==e&&(s.parent=e,e.parts.push(s))}if(1!==e.parts.length){if(n="undefined"==typeof n||n,n){var d=[];for(l=0;l<r.length;l++)d=d.concat(r[l].vertices);o.clockwiseSort(d);var c=o.hull(d),p=o.centre(c);a.setVertices(e,c),o.translate(e.vertices,p)}var u=t(e);e.area=u.area,e.parent=e,e.position.x=u.centre.x,e.position.y=u.centre.y,e.positionPrev.x=u.centre.x,e.positionPrev.y=u.centre.y,a.setMass(e,u.mass),a.setInertia(e,u.inertia),a.setPosition(e,u.centre)}},a.setPosition=function(e,t){var a=r.sub(t,e.position);e.positionPrev.x+=a.x,e.positionPrev.y+=a.y;for(var n=0,l;n<e.parts.length;n++)l=e.parts[n],l.position.x+=a.x,l.position.y+=a.y,o.translate(l.vertices,a),s.update(l.bounds,l.vertices,e.velocity)},a.setAngle=function(e,t){var a=t-e.angle;e.anglePrev+=a;for(var n=0,l;n<e.parts.length;n++)l=e.parts[n],l.angle+=a,o.rotate(l.vertices,a,e.position),d.rotate(l.axes,a),s.update(l.bounds,l.vertices,e.velocity),0<n&&r.rotateAbout(l.position,a,e.position,l.position)},a.setVelocity=function(e,t){e.positionPrev.x=e.position.x-t.x,e.positionPrev.y=e.position.y-t.y,e.velocity.x=t.x,e.velocity.y=t.y,e.speed=r.magnitude(e.velocity)},a.setAngularVelocity=function(e,t){e.anglePrev=e.angle-t,e.angularVelocity=t,e.angularSpeed=g(e.angularVelocity)},a.translate=function(e,t){a.setPosition(e,r.add(e.position,t))},a.rotate=function(e,t){a.setAngle(e,e.angle+t)},a.scale=function(e,r,n){for(var l=0,c;l<e.parts.length;l++)c=e.parts[l],o.scale(c.vertices,r,n,e.position),c.axes=d.fromVertices(c.vertices),e.isStatic||(c.area=o.area(c.vertices),a.setMass(c,e.density*c.area),o.translate(c.vertices,{x:-c.position.x,y:-c.position.y}),a.setInertia(c,o.inertia(c.vertices,c.mass)),o.translate(c.vertices,{x:c.position.x,y:c.position.y})),s.update(c.bounds,c.vertices,e.velocity);if(e.circleRadius&&(r===n?e.circleRadius*=r:e.circleRadius=null),!e.isStatic){var p=t(e);e.area=p.area,a.setMass(e,p.mass),a.setInertia(e,p.inertia)}},a.update=function(e,t,a,n){var l=u(t*a*e.timeScale,2),c=1-e.frictionAir*a*e.timeScale,p=e.position.x-e.positionPrev.x,m=e.position.y-e.positionPrev.y;e.velocity.x=p*c*n+e.force.x/e.mass*l,e.velocity.y=m*c*n+e.force.y/e.mass*l,e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y,e.position.x+=e.velocity.x,e.position.y+=e.velocity.y,e.angularVelocity=(e.angle-e.anglePrev)*c*n+e.torque/e.inertia*l,e.anglePrev=e.angle,e.angle+=e.angularVelocity,e.speed=r.magnitude(e.velocity),e.angularSpeed=g(e.angularVelocity);for(var h=0,y;h<e.parts.length;h++)y=e.parts[h],o.translate(y.vertices,e.velocity),0<h&&(y.position.x+=e.velocity.x,y.position.y+=e.velocity.y),0!==e.angularVelocity&&(o.rotate(y.vertices,e.angularVelocity,e.position),d.rotate(y.axes,e.angularVelocity),0<h&&r.rotateAbout(y.position,e.angularVelocity,e.position,y.position)),s.update(y.bounds,y.vertices,e.velocity)},a.applyForce=function(e,t,a){e.force.x+=a.x,e.force.y+=a.y;var o={x:t.x-e.position.x,y:t.y-e.position.y};e.torque+=o.x*a.y-o.y*a.x};var t=function(e){for(var t={mass:0,area:0,inertia:0,centre:{x:0,y:0}},a=1===e.parts.length?0:1,o;a<e.parts.length;a++)o=e.parts[a],t.mass+=o.mass,t.area+=o.area,t.inertia+=o.inertia,t.centre=r.add(t.centre,r.mult(o.position,o.mass===1/0?1:o.mass));return t.centre=r.div(t.centre,t.mass===1/0?e.parts.length:t.mass),t}})()},{"../core/Common":14,"../core/Sleeping":22,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29,"../render/Render":31}],2:[function(e,t){var a={};t.exports=a;var o=e("../core/Events"),n=e("../core/Common"),l=e("./Body");(function(){a.create=function(e){return n.extend({id:n.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{}},e)},a.setModified=function(e,t,o,r){if(e.isModified=t,o&&e.parent&&a.setModified(e.parent,t,o,r),r)for(var n=0,l;n<e.composites.length;n++)l=e.composites[n],a.setModified(l,t,o,r)},a.add=function(e,t){var r=[].concat(t);o.trigger(e,"beforeAdd",{object:t});for(var l=0,s;l<r.length;l++)switch(s=r[l],s.type){case"body":if(s.parent!==s){n.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}a.addBody(e,s);break;case"constraint":a.addConstraint(e,s);break;case"composite":a.addComposite(e,s);break;case"mouseConstraint":a.addConstraint(e,s.constraint);}return o.trigger(e,"afterAdd",{object:t}),e},a.remove=function(e,t,r){var n=[].concat(t);o.trigger(e,"beforeRemove",{object:t});for(var l=0,s;l<n.length;l++)switch(s=n[l],s.type){case"body":a.removeBody(e,s,r);break;case"constraint":a.removeConstraint(e,s,r);break;case"composite":a.removeComposite(e,s,r);break;case"mouseConstraint":a.removeConstraint(e,s.constraint);}return o.trigger(e,"afterRemove",{object:t}),e},a.addComposite=function(e,t){return e.composites.push(t),t.parent=e,a.setModified(e,!0,!0,!1),e},a.removeComposite=function(e,t,o){var r=n.indexOf(e.composites,t);if(-1!==r&&(a.removeCompositeAt(e,r),a.setModified(e,!0,!0,!1)),o)for(var l=0;l<e.composites.length;l++)a.removeComposite(e.composites[l],t,!0);return e},a.removeCompositeAt=function(e,t){return e.composites.splice(t,1),a.setModified(e,!0,!0,!1),e},a.addBody=function(e,t){return e.bodies.push(t),a.setModified(e,!0,!0,!1),e},a.removeBody=function(e,t,o){var r=n.indexOf(e.bodies,t);if(-1!==r&&(a.removeBodyAt(e,r),a.setModified(e,!0,!0,!1)),o)for(var l=0;l<e.composites.length;l++)a.removeBody(e.composites[l],t,!0);return e},a.removeBodyAt=function(e,t){return e.bodies.splice(t,1),a.setModified(e,!0,!0,!1),e},a.addConstraint=function(e,t){return e.constraints.push(t),a.setModified(e,!0,!0,!1),e},a.removeConstraint=function(e,t,o){var r=n.indexOf(e.constraints,t);if(-1!==r&&a.removeConstraintAt(e,r),o)for(var l=0;l<e.composites.length;l++)a.removeConstraint(e.composites[l],t,!0);return e},a.removeConstraintAt=function(e,t){return e.constraints.splice(t,1),a.setModified(e,!0,!0,!1),e},a.clear=function(e,t,o){if(o)for(var r=0;r<e.composites.length;r++)a.clear(e.composites[r],t,!0);return t?e.bodies=e.bodies.filter(function(e){return e.isStatic}):e.bodies.length=0,e.constraints.length=0,e.composites.length=0,a.setModified(e,!0,!0,!1),e},a.allBodies=function(e){for(var t=[].concat(e.bodies),o=0;o<e.composites.length;o++)t=t.concat(a.allBodies(e.composites[o]));return t},a.allConstraints=function(e){for(var t=[].concat(e.constraints),o=0;o<e.composites.length;o++)t=t.concat(a.allConstraints(e.composites[o]));return t},a.allComposites=function(e){for(var t=[].concat(e.composites),o=0;o<e.composites.length;o++)t=t.concat(a.allComposites(e.composites[o]));return t},a.get=function(e,t,o){var r,i;return("body"===o?r=a.allBodies(e):"constraint"===o?r=a.allConstraints(e):"composite"===o?r=a.allComposites(e).concat(e):void 0,!r)?null:(i=r.filter(function(e){return e.id.toString()===t.toString()}),0===i.length?null:i[0])},a.move=function(e,t,o){return a.remove(e,t),a.add(o,t),e},a.rebase=function(e){for(var t=a.allBodies(e).concat(a.allConstraints(e)).concat(a.allComposites(e)),o=0;o<t.length;o++)t[o].id=n.nextId();return a.setModified(e,!0,!0,!1),e},a.translate=function(e,t,o){for(var r=o?a.allBodies(e):e.bodies,n=0;n<r.length;n++)l.translate(r[n],t);return a.setModified(e,!0,!0,!1),e},a.rotate=function(e,t,o,n){for(var s=r(t),d=c(t),p=n?a.allBodies(e):e.bodies,u=0;u<p.length;u++){var g=p[u],m=g.position.x-o.x,h=g.position.y-o.y;l.setPosition(g,{x:o.x+(m*s-h*d),y:o.y+(m*d+h*s)}),l.rotate(g,t)}return a.setModified(e,!0,!0,!1),e},a.scale=function(e,t,o,r,n){for(var s=n?a.allBodies(e):e.bodies,d=0;d<s.length;d++){var c=s[d],p=c.position.x-r.x,u=c.position.y-r.y;l.setPosition(c,{x:r.x+p*t,y:r.y+u*o}),l.scale(c,t,o)}return a.setModified(e,!0,!0,!1),e}})()},{"../core/Common":14,"../core/Events":16,"./Body":1}],3:[function(e,t){var a={};t.exports=a;var o=e("./Composite"),r=e("../constraint/Constraint"),i=e("../core/Common");(function(){a.create=function(e){var t=o.create(),a={label:"World",gravity:{x:0,y:1,scale:.001},bounds:{min:{x:-Infinity,y:-Infinity},max:{x:1/0,y:1/0}}};return i.extend(t,a,e)}})()},{"../constraint/Constraint":12,"../core/Common":14,"./Composite":2}],4:[function(e,t){var a={};t.exports=a,function(){a.create=function(e){return{id:a.id(e),vertex:e,normalImpulse:0,tangentImpulse:0}},a.id=function(e){return e.body.id+"_"+e.index}}()},{}],5:[function(e,t){var a={};t.exports=a;var o=e("./SAT"),r=e("./Pair"),n=e("../geometry/Bounds");(function(){a.collisions=function(e,t){for(var l=[],s=t.pairs.table,d=0;d<e.length;d++){var c=e[d][0],p=e[d][1];if(!((c.isStatic||c.isSleeping)&&(p.isStatic||p.isSleeping))&&a.canCollide(c.collisionFilter,p.collisionFilter)&&n.overlaps(c.bounds,p.bounds))for(var u=1<c.parts.length?1:0,g;u<c.parts.length;u++){g=c.parts[u];for(var m=1<p.parts.length?1:0,h;m<p.parts.length;m++)if(h=p.parts[m],g===c&&h===p||n.overlaps(g.bounds,h.bounds)){var y=r.id(g,h),f=s[y],x;x=f&&f.isActive?f.collision:null;var _=o.collides(g,h,x);_.collided&&l.push(_)}}}return l},a.canCollide=function(e,t){return e.group===t.group&&0!==e.group?0<e.group:0!=(e.mask&t.category)&&0!=(t.mask&e.category)}})()},{"../geometry/Bounds":26,"./Pair":7,"./SAT":11}],6:[function(e,t){var a={};t.exports=a;var o=e("./Pair"),r=e("./Detector"),n=e("../core/Common");(function(){a.create=function(e){var t={controller:a,detector:r.collisions,buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48};return n.extend(t,e)},a.update=function(a,o,r,n){var p=r.world,g=a.buckets,m=!1,h,y,f,x,_;for(h=0;h<o.length;h++){var b=o[h];if((!b.isSleeping||n)&&!(b.bounds.max.x<p.bounds.min.x||b.bounds.min.x>p.bounds.max.x||b.bounds.max.y<p.bounds.min.y||b.bounds.min.y>p.bounds.max.y)){var v=t(a,b);if(!b.region||v.id!==b.region.id||n){(!b.region||n)&&(b.region=v);var w=e(v,b.region);for(y=w.startCol;y<=w.endCol;y++)for(f=w.startRow;f<=w.endRow;f++){_=l(y,f),x=g[_];var k=y>=v.startCol&&y<=v.endCol&&f>=v.startRow&&f<=v.endRow,T=y>=b.region.startCol&&y<=b.region.endCol&&f>=b.region.startRow&&f<=b.region.endRow;!k&&T&&T&&x&&c(a,x,b),(b.region===v||k&&!T||n)&&(!x&&(x=s(g,_)),d(a,x,b))}b.region=v,m=!0}}}m&&(a.pairsList=u(a))},a.clear=function(e){e.buckets={},e.pairs={},e.pairsList=[]};var e=function(e,t){var a=p(e.startCol,t.startCol),o=m(e.endCol,t.endCol),r=p(e.startRow,t.startRow),n=m(e.endRow,t.endRow);return i(a,o,r,n)},t=function(e,t){var a=t.bounds,o=h(a.min.x/e.bucketWidth),r=h(a.max.x/e.bucketWidth),n=h(a.min.y/e.bucketHeight),l=h(a.max.y/e.bucketHeight);return i(o,r,n,l)},i=function(e,t,a,o){return{id:e+","+t+","+a+","+o,startCol:e,endCol:t,startRow:a,endRow:o}},l=function(e,t){return"C"+e+"R"+t},s=function(e,t){var a=e[t]=[];return a},d=function(e,t,a){for(var r=0,n;r<t.length;r++)if(n=t[r],!(a.id===n.id||a.isStatic&&n.isStatic)){var l=o.id(a,n),s=e.pairs[l];s?s[2]+=1:e.pairs[l]=[a,n,1]}t.push(a)},c=function(e,t,a){t.splice(n.indexOf(t,a),1);for(var r=0;r<t.length;r++){var l=t[r],s=o.id(a,l),d=e.pairs[s];d&&(d[2]-=1)}},u=function(e){var t=[],a,o;a=n.keys(e.pairs);for(var r=0;r<a.length;r++)o=e.pairs[a[r]],0<o[2]?t.push(o):delete e.pairs[a[r]];return t}})()},{"../core/Common":14,"./Detector":5,"./Pair":7}],7:[function(e,t){var a={};t.exports=a;var o=e("./Contact");(function(){a.create=function(e,t){var o=e.bodyA,r=e.bodyB,i=e.parentA,n=e.parentB,l={id:a.id(o,r),bodyA:o,bodyB:r,contacts:{},activeContacts:[],separation:0,isActive:!0,isSensor:o.isSensor||r.isSensor,timeCreated:t,timeUpdated:t,inverseMass:i.inverseMass+n.inverseMass,friction:p(i.friction,n.friction),frictionStatic:m(i.frictionStatic,n.frictionStatic),restitution:m(i.restitution,n.restitution),slop:m(i.slop,n.slop)};return a.update(l,e,t),l},a.update=function(e,t,r){var n=e.contacts,l=t.supports,s=e.activeContacts,d=t.parentA,c=t.parentB;if(e.collision=t,e.inverseMass=d.inverseMass+c.inverseMass,e.friction=p(d.friction,c.friction),e.frictionStatic=m(d.frictionStatic,c.frictionStatic),e.restitution=m(d.restitution,c.restitution),e.slop=m(d.slop,c.slop),s.length=0,t.collided){for(var u=0;u<l.length;u++){var g=l[u],h=o.id(g),y=n[h];y?s.push(y):s.push(n[h]=o.create(g))}e.separation=t.depth,a.setActive(e,!0,r)}else!0===e.isActive&&a.setActive(e,!1,r)},a.setActive=function(e,t,a){t?(e.isActive=!0,e.timeUpdated=a):(e.isActive=!1,e.activeContacts.length=0)},a.id=function(e,t){return e.id<t.id?"A"+e.id+"B"+t.id:"A"+t.id+"B"+e.id}})()},{"./Contact":4}],8:[function(e,t){var a={};t.exports=a;var o=e("./Pair"),r=e("../core/Common");(function(){a.create=function(e){return r.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},e)},a.update=function(e,t,a){var n=e.list,l=e.table,s=e.collisionStart,d=e.collisionEnd,c=e.collisionActive,p=[],u,g,m,h;for(s.length=0,d.length=0,c.length=0,h=0;h<t.length;h++)u=t[h],u.collided&&(g=o.id(u.bodyA,u.bodyB),p.push(g),m=l[g],m?(m.isActive?c.push(m):s.push(m),o.update(m,u,a)):(m=o.create(u,a),l[g]=m,s.push(m),n.push(m)));for(h=0;h<n.length;h++)m=n[h],m.isActive&&-1===r.indexOf(p,m.id)&&(o.setActive(m,!1,a),d.push(m))},a.removeOld=function(e,t){var a=e.list,o=e.table,r=[],n,l,s,d;for(d=0;d<a.length;d++){if(n=a[d],l=n.collision,l.bodyA.isSleeping||l.bodyB.isSleeping){n.timeUpdated=t;continue}1000<t-n.timeUpdated&&r.push(d)}for(d=0;d<r.length;d++)s=r[d]-d,n=a[s],delete o[n.id],a.splice(s,1)},a.clear=function(e){return e.table={},e.list.length=0,e.collisionStart.length=0,e.collisionActive.length=0,e.collisionEnd.length=0,e}})()},{"../core/Common":14,"./Pair":7}],9:[function(e,t){var a={};t.exports=a;var o=e("../geometry/Vector"),r=e("./SAT"),n=e("../geometry/Bounds"),l=e("../factory/Bodies"),s=e("../geometry/Vertices");(function(){a.ray=function(e,t,a,s){s=s||1e-100;for(var d=o.angle(t,a),c=o.magnitude(o.sub(t,a)),p=.5*(a.x+t.x),u=.5*(a.y+t.y),g=l.rectangle(p,u,c,s,{angle:d}),m=[],h=0,y;h<e.length;h++)if(y=e[h],n.overlaps(y.bounds,g.bounds))for(var f=1===y.parts.length?0:1,x;f<y.parts.length;f++)if(x=y.parts[f],n.overlaps(x.bounds,g.bounds)){var _=r.collides(x,g);if(_.collided){_.body=_.bodyA=_.bodyB=y,m.push(_);break}}return m},a.region=function(e,t,a){for(var o=[],r=0;r<e.length;r++){var l=e[r],s=n.overlaps(l.bounds,t);(s&&!a||!s&&a)&&o.push(l)}return o},a.point=function(e,t){for(var a=[],o=0,r;o<e.length;o++)if(r=e[o],n.contains(r.bounds,t))for(var l=1===r.parts.length?0:1,d;l<r.parts.length;l++)if(d=r.parts[l],n.contains(d.bounds,t)&&s.contains(d.vertices,t)){a.push(r);break}return a}})()},{"../factory/Bodies":23,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29,"./SAT":11}],10:[function(e,t){var a={};t.exports=a;var o=e("../geometry/Vertices"),r=e("../geometry/Vector"),i=e("../core/Common"),n=e("../geometry/Bounds");(function(){a._restingThresh=4,a._restingThreshTangent=6,a._positionDampen=.9,a._positionWarming=.8,a._frictionNormalMultiplier=5,a.preSolvePosition=function(e){var t,a,o;for(t=0;t<e.length;t++)a=e[t],a.isActive&&(o=a.activeContacts.length,a.collision.parentA.totalContacts+=o,a.collision.parentB.totalContacts+=o)},a.solvePosition=function(e,t){var o=r._temp[0],n=r._temp[1],l=r._temp[2],s=r._temp[3],d,c,p,u,g,m,h,y,f;for(d=0;d<e.length;d++)c=e[d],!c.isActive||c.isSensor||(p=c.collision,u=p.parentA,g=p.parentB,m=p.normal,h=r.sub(r.add(g.positionImpulse,g.position,o),r.add(u.positionImpulse,r.sub(g.position,p.penetration,n),l),s),c.separation=r.dot(m,h));for(d=0;d<e.length;d++)c=e[d],!c.isActive||c.isSensor||0>c.separation||(p=c.collision,u=p.parentA,g=p.parentB,m=p.normal,f=(c.separation-c.slop)*t,(u.isStatic||g.isStatic)&&(f*=2),!(u.isStatic||u.isSleeping)&&(y=a._positionDampen/u.totalContacts,u.positionImpulse.x+=m.x*f*y,u.positionImpulse.y+=m.y*f*y),!(g.isStatic||g.isSleeping)&&(y=a._positionDampen/g.totalContacts,g.positionImpulse.x-=m.x*f*y,g.positionImpulse.y-=m.y*f*y))},a.postSolvePosition=function(e){for(var t=0,l;t<e.length;t++)if(l=e[t],l.totalContacts=0,0!==l.positionImpulse.x||0!==l.positionImpulse.y){for(var s=0,d;s<l.parts.length;s++)d=l.parts[s],o.translate(d.vertices,l.positionImpulse),n.update(d.bounds,d.vertices,l.velocity),d.position.x+=l.positionImpulse.x,d.position.y+=l.positionImpulse.y;l.positionPrev.x+=l.positionImpulse.x,l.positionPrev.y+=l.positionImpulse.y,0>r.dot(l.positionImpulse,l.velocity)?(l.positionImpulse.x=0,l.positionImpulse.y=0):(l.positionImpulse.x*=a._positionWarming,l.positionImpulse.y*=a._positionWarming)}},a.preSolveVelocity=function(e){var t=r._temp[0],a=r._temp[1],o,n,l,s,d,c,p,u,g,m,h,y,f,x;for(o=0;o<e.length;o++)if(l=e[o],l.isActive&&!l.isSensor)for(s=l.activeContacts,d=l.collision,c=d.parentA,p=d.parentB,u=d.normal,g=d.tangent,n=0;n<s.length;n++)m=s[n],h=m.vertex,y=m.normalImpulse,f=m.tangentImpulse,(0!==y||0!==f)&&(t.x=u.x*y+g.x*f,t.y=u.y*y+g.y*f,!(c.isStatic||c.isSleeping)&&(x=r.sub(h,c.position,a),c.positionPrev.x+=t.x*c.inverseMass,c.positionPrev.y+=t.y*c.inverseMass,c.anglePrev+=r.cross(x,t)*c.inverseInertia),!(p.isStatic||p.isSleeping)&&(x=r.sub(h,p.position,a),p.positionPrev.x-=t.x*p.inverseMass,p.positionPrev.y-=t.y*p.inverseMass,p.anglePrev-=r.cross(x,t)*p.inverseInertia))},a.solveVelocity=function(e,t){for(var o=t*t,n=r._temp[0],l=r._temp[1],s=r._temp[2],d=r._temp[3],c=r._temp[4],u=r._temp[5],m=0,h;m<e.length;m++)if(h=e[m],h.isActive&&!h.isSensor){var y=h.collision,f=y.parentA,x=y.parentB,_=y.normal,b=y.tangent,v=h.activeContacts,w=1/v.length;f.velocity.x=f.position.x-f.positionPrev.x,f.velocity.y=f.position.y-f.positionPrev.y,x.velocity.x=x.position.x-x.positionPrev.x,x.velocity.y=x.position.y-x.positionPrev.y,f.angularVelocity=f.angle-f.anglePrev,x.angularVelocity=x.angle-x.anglePrev;for(var k=0;k<v.length;k++){var T=v[k],A=T.vertex,S=r.sub(A,f.position,l),C=r.sub(A,x.position,s),L=r.add(f.velocity,r.mult(r.perp(S),f.angularVelocity),d),E=r.add(x.velocity,r.mult(r.perp(C),x.angularVelocity),c),I=r.sub(L,E,u),P=r.dot(_,I),z=r.dot(b,I),D=g(z),O=i.sign(z),R=(1+h.restitution)*P,M=i.clamp(h.separation+P,0,1)*a._frictionNormalMultiplier,B=z,F=1/0;D>h.friction*h.frictionStatic*M*o&&(F=D,B=i.clamp(h.friction*O*o,-F,F));var N=r.cross(S,_),V=r.cross(C,_),U=w/(f.inverseMass+x.inverseMass+f.inverseInertia*N*N+x.inverseInertia*V*V);if(R*=U,B*=U,0>P&&P*P>a._restingThresh*o)T.normalImpulse=0;else{var H=T.normalImpulse;T.normalImpulse=p(T.normalImpulse+R,0),R=T.normalImpulse-H}if(z*z>a._restingThreshTangent*o)T.tangentImpulse=0;else{var q=T.tangentImpulse;T.tangentImpulse=i.clamp(T.tangentImpulse+B,-F,F),B=T.tangentImpulse-q}n.x=_.x*R+b.x*B,n.y=_.y*R+b.y*B,f.isStatic||f.isSleeping||(f.positionPrev.x+=n.x*f.inverseMass,f.positionPrev.y+=n.y*f.inverseMass,f.anglePrev+=r.cross(S,n)*f.inverseInertia),x.isStatic||x.isSleeping||(x.positionPrev.x-=n.x*x.inverseMass,x.positionPrev.y-=n.y*x.inverseMass,x.anglePrev-=r.cross(C,n)*x.inverseInertia)}}}})()},{"../core/Common":14,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],11:[function(e,t){var a={};t.exports=a;var r=e("../geometry/Vertices"),n=e("../geometry/Vector");(function(){a.collides=function(t,a,o){var l=!1,s,d,c,p;if(o){var u=t.parent,g=a.parent,m=u.speed*u.speed+u.angularSpeed*u.angularSpeed+g.speed*g.speed+g.angularSpeed*g.angularSpeed;l=o&&o.collided&&.2>m,p=o}else p={collided:!1,bodyA:t,bodyB:a};if(o&&l){var h=p.axisBody,y=h===t?a:t,f=[h.axes[o.axisNumber]];if(c=e(h.vertices,y.vertices,f),p.reused=!0,0>=c.overlap)return p.collided=!1,p}else{if(s=e(t.vertices,a.vertices,t.axes),0>=s.overlap)return p.collided=!1,p;if(d=e(a.vertices,t.vertices,a.axes),0>=d.overlap)return p.collided=!1,p;s.overlap<d.overlap?(c=s,p.axisBody=t):(c=d,p.axisBody=a),p.axisNumber=c.axisNumber}p.bodyA=t.id<a.id?t:a,p.bodyB=t.id<a.id?a:t,p.collided=!0,p.depth=c.overlap,p.parentA=p.bodyA.parent,p.parentB=p.bodyB.parent,t=p.bodyA,a=p.bodyB,p.normal=0>n.dot(c.axis,n.sub(a.position,t.position))?{x:c.axis.x,y:c.axis.y}:{x:-c.axis.x,y:-c.axis.y},p.tangent=n.perp(p.normal),p.penetration=p.penetration||{},p.penetration.x=p.normal.x*p.depth,p.penetration.y=p.normal.y*p.depth;var x=i(t,a,p.normal),_=[];if(r.contains(t.vertices,x[0])&&_.push(x[0]),r.contains(t.vertices,x[1])&&_.push(x[1]),2>_.length){var b=i(a,t,n.neg(p.normal));r.contains(a.vertices,b[0])&&_.push(b[0]),2>_.length&&r.contains(a.vertices,b[1])&&_.push(b[1])}return 1>_.length&&(_=[x[0]]),p.supports=_,p};var e=function(e,a,r){for(var l=n._temp[0],s=n._temp[1],d={overlap:o},c=0,u,g;c<r.length;c++){if(g=r[c],t(l,e,g),t(s,a,g),u=p(l.max-s.min,s.max-l.min),0>=u)return d.overlap=u,d;u<d.overlap&&(d.overlap=u,d.axis=g,d.axisNumber=c)}return d},t=function(e,t,a){for(var o=n.dot(t[0],a),r=o,l=1,s;l<t.length;l+=1)s=n.dot(t[l],a),s>r?r=s:s<o&&(o=s);e.min=o,e.max=r},i=function(e,t,a){for(var r=o,l=n._temp[0],s=t.vertices,d=e.position,c=0,p,u,g,m;c<s.length;c++)u=s[c],l.x=u.x-d.x,l.y=u.y-d.y,p=-n.dot(a,l),p<r&&(r=p,g=u);var h=0<=g.index-1?g.index-1:s.length-1;u=s[h],l.x=u.x-d.x,l.y=u.y-d.y,r=-n.dot(a,l),m=u;var y=(g.index+1)%s.length;return u=s[y],l.x=u.x-d.x,l.y=u.y-d.y,p=-n.dot(a,l),p<r&&(m=u),[g,m]}})()},{"../geometry/Vector":28,"../geometry/Vertices":29}],12:[function(e,t){var a={};t.exports=a;var o=e("../geometry/Vertices"),r=e("../geometry/Vector"),i=e("../core/Sleeping"),n=e("../geometry/Bounds"),l=e("../geometry/Axes"),s=e("../core/Common");(function(){var e=1e-6;a.create=function(t){var a=t;a.bodyA&&!a.pointA&&(a.pointA={x:0,y:0}),a.bodyB&&!a.pointB&&(a.pointB={x:0,y:0});var o=a.bodyA?r.add(a.bodyA.position,a.pointA):a.pointA,i=a.bodyB?r.add(a.bodyB.position,a.pointB):a.pointB,n=r.magnitude(r.sub(o,i));a.length=a.length||n||e;return a.render=s.extend({visible:!0,lineWidth:2,strokeStyle:"#ffffff"},a.render),a.id=a.id||s.nextId(),a.label=a.label||"Constraint",a.type="constraint",a.stiffness=a.stiffness||1,a.angularStiffness=a.angularStiffness||0,a.angleA=a.bodyA?a.bodyA.angle:a.angleA,a.angleB=a.bodyB?a.bodyB.angle:a.angleB,a.plugin={},a},a.solveAll=function(e,t){for(var o=0;o<e.length;o++)a.solve(e[o],t)},a.solve=function(t,a){var o=t.bodyA,i=t.bodyB,n=t.pointA,l=t.pointB;o&&!o.isStatic&&(t.pointA=r.rotate(n,o.angle-t.angleA),t.angleA=o.angle),i&&!i.isStatic&&(t.pointB=r.rotate(l,i.angle-t.angleB),t.angleB=i.angle);var s=n,d=l;if(o&&(s=r.add(o.position,n)),i&&(d=r.add(i.position,l)),s&&d){var c=r.sub(s,d),p=r.magnitude(c);0===p&&(p=e);var u=(p-t.length)/p,m=r.div(c,p),h=r.mult(c,.5*u*t.stiffness*a*a);if(!(g(1-p/t.length)<.001*a)){var y,f,x,_,b,v,w,k;o&&!o.isStatic?(x={x:s.x-o.position.x+h.x,y:s.y-o.position.y+h.y},o.velocity.x=o.position.x-o.positionPrev.x,o.velocity.y=o.position.y-o.positionPrev.y,o.angularVelocity=o.angle-o.anglePrev,y=r.add(o.velocity,r.mult(r.perp(x),o.angularVelocity)),b=r.dot(x,m),w=o.inverseMass+o.inverseInertia*b*b):(y={x:0,y:0},w=o?o.inverseMass:0),i&&!i.isStatic?(_={x:d.x-i.position.x-h.x,y:d.y-i.position.y-h.y},i.velocity.x=i.position.x-i.positionPrev.x,i.velocity.y=i.position.y-i.positionPrev.y,i.angularVelocity=i.angle-i.anglePrev,f=r.add(i.velocity,r.mult(r.perp(_),i.angularVelocity)),v=r.dot(_,m),k=i.inverseMass+i.inverseInertia*v*v):(f={x:0,y:0},k=i?i.inverseMass:0);var T=r.sub(f,y),A=r.dot(m,T)/(w+k);0<A&&(A=0);var S={x:m.x*A,y:m.y*A},C;o&&!o.isStatic&&(C=r.cross(x,S)*o.inverseInertia*(1-t.angularStiffness),o.constraintImpulse.x-=h.x,o.constraintImpulse.y-=h.y,o.constraintImpulse.angle+=C,o.position.x-=h.x,o.position.y-=h.y,o.angle+=C),i&&!i.isStatic&&(C=r.cross(_,S)*i.inverseInertia*(1-t.angularStiffness),i.constraintImpulse.x+=h.x,i.constraintImpulse.y+=h.y,i.constraintImpulse.angle-=C,i.position.x+=h.x,i.position.y+=h.y,i.angle-=C)}}},a.postSolveAll=function(e){for(var t=0;t<e.length;t++){var a=e[t],s=a.constraintImpulse;if(0!==s.x||0!==s.y||0!==s.angle){i.set(a,!1);for(var d=0,c;d<a.parts.length;d++)c=a.parts[d],o.translate(c.vertices,s),0<d&&(c.position.x+=s.x,c.position.y+=s.y),0!==s.angle&&(o.rotate(c.vertices,s.angle,a.position),l.rotate(c.axes,s.angle),0<d&&r.rotateAbout(c.position,s.angle,a.position,c.position)),n.update(c.bounds,c.vertices,a.velocity);s.angle=0,s.x=0,s.y=0}}}})()},{"../core/Common":14,"../core/Sleeping":22,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],13:[function(e,t){var a={};t.exports=a;var o=e("../geometry/Vertices"),r=e("../core/Sleeping"),i=e("../core/Mouse"),n=e("../core/Events"),l=e("../collision/Detector"),s=e("./Constraint"),d=e("../body/Composite"),c=e("../core/Common"),p=e("../geometry/Bounds");(function(){a.create=function(t,o){var r=(t?t.mouse:null)||(o?o.mouse:null);r||(t&&t.render&&t.render.canvas?r=i.create(t.render.canvas):o&&o.element?r=i.create(o.element):(r=i.create(),c.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var l=s.create({label:"Mouse Constraint",pointA:r.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),p={type:"mouseConstraint",mouse:r,element:null,body:null,constraint:l,collisionFilter:{category:1,mask:4294967295,group:0}},u=c.extend(p,o);return n.on(t,"beforeUpdate",function(){var o=d.allBodies(t.world);a.update(u,o),e(u)}),u},a.update=function(e,t){var a=e.mouse,s=e.constraint,d=e.body;if(!(0===a.button))s.bodyB=e.body=null,s.pointB=null,d&&n.trigger(e,"enddrag",{mouse:a,body:d});else if(!s.bodyB){for(var c=0;c<t.length;c++)if(d=t[c],p.contains(d.bounds,a.position)&&l.canCollide(d.collisionFilter,e.collisionFilter))for(var u=1<d.parts.length?1:0,g;u<d.parts.length;u++)if(g=d.parts[u],o.contains(g.vertices,a.position)){s.pointA=a.position,s.bodyB=e.body=d,s.pointB={x:a.position.x-d.position.x,y:a.position.y-d.position.y},s.angleB=d.angle,r.set(d,!1),n.trigger(e,"startdrag",{mouse:a,body:d});break}}else r.set(s.bodyB,!1),s.pointA=a.position};var e=function(e){var t=e.mouse,a=t.sourceEvents;a.mousemove&&n.trigger(e,"mousemove",{mouse:t}),a.mousedown&&n.trigger(e,"mousedown",{mouse:t}),a.mouseup&&n.trigger(e,"mouseup",{mouse:t}),i.clearSourceEvents(t)}})()},{"../body/Composite":2,"../collision/Detector":5,"../core/Common":14,"../core/Events":16,"../core/Mouse":19,"../core/Sleeping":22,"../geometry/Bounds":26,"../geometry/Vertices":29,"./Constraint":12}],14:[function(e,t){var a={};t.exports=a,function(){a._nextId=0,a._seed=0,a.extend=function(e,t){var o,r;"boolean"==typeof t?(o=2,r=t):(o=1,r=!0);for(var n=o,l;n<arguments.length;n++)if(l=arguments[n],l)for(var s in l)r&&l[s]&&l[s].constructor===Object?e[s]&&e[s].constructor!==Object?e[s]=l[s]:(e[s]=e[s]||{},a.extend(e[s],r,l[s])):e[s]=l[s];return e},a.clone=function(e,t){return a.extend({},t,e)},a.keys=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var a in e)t.push(a);return t},a.values=function(e){var t=[];if(Object.keys){for(var a=Object.keys(e),o=0;o<a.length;o++)t.push(e[a[o]]);return t}for(var r in e)t.push(e[r]);return t},a.get=function(e,t,a,o){t=t.split(".").slice(a,o);for(var r=0;r<t.length;r+=1)e=e[t[r]];return e},a.set=function(e,t,o,r,i){var n=t.split(".").slice(r,i);return a.get(e,t,0,-1)[n[n.length-1]]=o,o},a.shadeColor=function(e,t){var a=parseInt(e.slice(1),16),o=s(2.55*t),r=(a>>16)+o,i=(255&a>>8)+o,n=(255&a)+o;return"#"+(16777216+65536*(255>r?1>r?0:r:255)+256*(255>i?1>i?0:i:255)+(255>n?1>n?0:n:255)).toString(16).slice(1)},a.shuffle=function(e){for(var t=e.length-1;0<t;t--){var o=h(a.random()*(t+1)),r=e[t];e[t]=e[o],e[o]=r}return e},a.choose=function(e){return e[h(a.random()*e.length)]},a.isElement=function(t){try{return t instanceof HTMLElement}catch(a){return"object"==typeof t&&1===t.nodeType&&"object"==typeof t.style&&"object"==typeof t.ownerDocument}},a.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},a.isFunction=function(e){return"function"==typeof e},a.isPlainObject=function(e){return"object"==typeof e&&e.constructor===Object},a.isString=function(e){return"[object String]"===toString.call(e)},a.clamp=function(e,t,a){return e<t?t:e>a?a:e},a.sign=function(e){return 0>e?-1:1},a.now=function(){var e=window.performance||{};return e.now=function(){return e.now||e.webkitNow||e.msNow||e.oNow||e.mozNow||function(){return+new Date}}(),e.now()},a.random=function(t,a){return t="undefined"==typeof t?0:t,a="undefined"==typeof a?1:a,t+e()*(a-t)};var e=function(){return a._seed=(9301*a._seed+49297)%233280,a._seed/233280};a.colorToNumber=function(e){return e=e.replace("#",""),3==e.length&&(e=e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)),parseInt(e,16)},a.logLevel=1,a.log=function(){console&&0<a.logLevel&&3>=a.logLevel&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},a.info=function(){console&&0<a.logLevel&&2>=a.logLevel&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},a.warn=function(){console&&0<a.logLevel&&3>=a.logLevel&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},a.nextId=function(){return a._nextId++},a.indexOf=function(e,t){if(e.indexOf)return e.indexOf(t);for(var a=0;a<e.length;a++)if(e[a]===t)return a;return-1},a.map=function(e,t){if(e.map)return e.map(t);for(var a=[],o=0;o<e.length;o+=1)a.push(t(e[o]));return a},a.topologicalSort=function(e){var a=[],o=[],r=[];for(var i in e)o[i]||r[i]||t(i,o,r,e,a);return a};var t=function(e,a,o,r,n){var l=r[e]||[];o[e]=!0;for(var s=0,d;s<l.length;s+=1)(d=l[s],!o[d])&&(a[d]||t(d,a,o,r,n));o[e]=!1,a[e]=!0,n.push(e)};a.chain=function(){for(var e=[],t=0,a;t<arguments.length;t+=1)a=arguments[t],a._chained?e.push.apply(e,a._chained):e.push(a);var o=function(){for(var t=Array(arguments.length),a=0,o=arguments.length,r;a<o;a++)t[a]=arguments[a];for(a=0;a<e.length;a+=1){var n=e[a].apply(r,t);"undefined"!=typeof n&&(r=n)}return r};return o._chained=e,o},a.chainPathBefore=function(e,t,o){return a.set(e,t,a.chain(o,a.get(e,t)))},a.chainPathAfter=function(e,t,o){return a.set(e,t,a.chain(a.get(e,t),o))}}()},{}],15:[function(e,t){var a={};t.exports=a;var o=e("../body/World"),r=e("./Sleeping"),n=e("../collision/Resolver"),l=e("../render/Render"),s=e("../collision/Pairs"),d=e("./Metrics"),c=e("../collision/Grid"),p=e("./Events"),u=e("../body/Composite"),g=e("../constraint/Constraint"),m=e("./Common"),h=e("../body/Body");(function(){a.create=function(e,t){t=m.isElement(e)?t:e,e=m.isElement(e)?e:null,t=t||{},(e||t.render)&&m.warn("Engine.create: engine.render is deprecated (see docs)");var a=m.extend({positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},timing:{timestamp:0,timeScale:1},broadphase:{controller:c}},t);if(e||a.render){var r={element:e,controller:l};a.render=m.extend(r,a.render)}return a.render&&a.render.controller&&(a.render=a.render.controller.create(a.render)),a.render&&(a.render.engine=a),a.world=t.world||o.create(a.world),a.pairs=s.create(),a.broadphase=a.broadphase.controller.create(a.broadphase),a.metrics=a.metrics||{extended:!1},a},a.update=function(a,o,l){o=o||1e3/60,l=l||1;var c=a.world,m=a.timing,h=a.broadphase,y=[],f;m.timestamp+=o*m.timeScale;var x={timestamp:m.timestamp};p.trigger(a,"beforeUpdate",x);var _=u.allBodies(c),b=u.allConstraints(c);for(a.enableSleeping&&r.update(_,m.timeScale),t(_,c.gravity),d(_,o,m.timeScale,l,c.bounds),f=0;f<a.constraintIterations;f++)g.solveAll(b,m.timeScale);g.postSolveAll(_),h.controller?(c.isModified&&h.controller.clear(h),h.controller.update(h,_,a,c.isModified),y=h.pairsList):y=_,c.isModified&&u.setModified(c,!1,!1,!0);var v=h.detector(y,a),w=a.pairs,k=m.timestamp;for(s.update(w,v,k),s.removeOld(w,k),a.enableSleeping&&r.afterCollisions(w.list,m.timeScale),0<w.collisionStart.length&&p.trigger(a,"collisionStart",{pairs:w.collisionStart}),n.preSolvePosition(w.list),f=0;f<a.positionIterations;f++)n.solvePosition(w.list,m.timeScale);for(n.postSolvePosition(_),n.preSolveVelocity(w.list),f=0;f<a.velocityIterations;f++)n.solveVelocity(w.list,m.timeScale);return 0<w.collisionActive.length&&p.trigger(a,"collisionActive",{pairs:w.collisionActive}),0<w.collisionEnd.length&&p.trigger(a,"collisionEnd",{pairs:w.collisionEnd}),e(_),p.trigger(a,"afterUpdate",x),a},a.merge=function(e,t){if(m.extend(e,t),t.world){e.world=t.world,a.clear(e);for(var o=u.allBodies(e.world),n=0,l;n<o.length;n++)l=o[n],r.set(l,!1),l.id=m.nextId()}},a.clear=function(e){var t=e.world;s.clear(e.pairs);var a=e.broadphase;if(a.controller){var o=u.allBodies(t);a.controller.clear(a),a.controller.update(a,o,e,!0)}};var e=function(e){for(var t=0,a;t<e.length;t++)a=e[t],a.force.x=0,a.force.y=0,a.torque=0},t=function(e,t){var a="undefined"==typeof t.scale?.001:t.scale;if((0!==t.x||0!==t.y)&&0!==a)for(var o=0,r;o<e.length;o++)r=e[o],r.isStatic||r.isSleeping||(r.force.y+=r.mass*t.y*a,r.force.x+=r.mass*t.x*a)},d=function(e,t,a,o){for(var r=0,n;r<e.length;r++)n=e[r],n.isStatic||n.isSleeping||h.update(n,t,a,o)}})()},{"../body/Body":1,"../body/Composite":2,"../body/World":3,"../collision/Grid":6,"../collision/Pairs":8,"../collision/Resolver":10,"../constraint/Constraint":12,"../render/Render":31,"./Common":14,"./Events":16,"./Metrics":18,"./Sleeping":22}],16:[function(e,t){var a={};t.exports=a;var o=e("./Common");(function(){a.on=function(e,t,a){for(var o=t.split(" "),r=0,n;r<o.length;r++)n=o[r],e.events=e.events||{},e.events[n]=e.events[n]||[],e.events[n].push(a);return a},a.off=function(e,t,a){if(!t)return void(e.events={});"function"==typeof t&&(a=t,t=o.keys(e.events).join(" "));for(var r=t.split(" "),n=0;n<r.length;n++){var l=e.events[r[n]],s=[];if(a&&l)for(var d=0;d<l.length;d++)l[d]!==a&&s.push(l[d]);e.events[r[n]]=s}},a.trigger=function(e,t,a){var r,n,l,s;if(e.events){a||(a={}),r=t.split(" ");for(var d=0;d<r.length;d++)if(n=r[d],l=e.events[n],l){s=o.clone(a,!1),s.name=n,s.source=e;for(var c=0;c<l.length;c++)l[c].apply(e,[s])}}}})()},{"./Common":14}],17:[function(e,t){var a={};t.exports=a;var o=e("./Plugin"),r=e("./Common");(function(){a.name="matter-js",a.version="0.12.0",a.uses=[],a.used=[],a.use=function(){o.use(a,Array.prototype.slice.call(arguments))},a.before=function(e,t){return e=e.replace(/^Matter./,""),r.chainPathBefore(a,e,t)},a.after=function(e,t){return e=e.replace(/^Matter./,""),r.chainPathAfter(a,e,t)}})()},{"./Common":14,"./Plugin":20}],18:[function(){},{"../body/Composite":2,"./Common":14}],19:[function(e,t){var a={};t.exports=a;var o=e("../core/Common");(function(){a.create=function(t){var r={};return t||o.log("Mouse.create: element was undefined, defaulting to document.body","warn"),r.element=t||document.body,r.absolute={x:0,y:0},r.position={x:0,y:0},r.mousedownPosition={x:0,y:0},r.mouseupPosition={x:0,y:0},r.offset={x:0,y:0},r.scale={x:1,y:1},r.wheelDelta=0,r.button=-1,r.pixelRatio=r.element.getAttribute("data-pixel-ratio")||1,r.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},r.mousemove=function(t){var a=e(t,r.element,r.pixelRatio),o=t.changedTouches;o&&(r.button=0,t.preventDefault()),r.absolute.x=a.x,r.absolute.y=a.y,r.position.x=r.absolute.x*r.scale.x+r.offset.x,r.position.y=r.absolute.y*r.scale.y+r.offset.y,r.sourceEvents.mousemove=t},r.mousedown=function(t){var a=e(t,r.element,r.pixelRatio),o=t.changedTouches;o?(r.button=0,t.preventDefault()):r.button=t.button,r.absolute.x=a.x,r.absolute.y=a.y,r.position.x=r.absolute.x*r.scale.x+r.offset.x,r.position.y=r.absolute.y*r.scale.y+r.offset.y,r.mousedownPosition.x=r.position.x,r.mousedownPosition.y=r.position.y,r.sourceEvents.mousedown=t},r.mouseup=function(t){var a=e(t,r.element,r.pixelRatio),o=t.changedTouches;o&&t.preventDefault(),r.button=-1,r.absolute.x=a.x,r.absolute.y=a.y,r.position.x=r.absolute.x*r.scale.x+r.offset.x,r.position.y=r.absolute.y*r.scale.y+r.offset.y,r.mouseupPosition.x=r.position.x,r.mouseupPosition.y=r.position.y,r.sourceEvents.mouseup=t},r.mousewheel=function(e){r.wheelDelta=m(-1,p(1,e.wheelDelta||-e.detail)),e.preventDefault()},a.setElement(r,r.element),r},a.setElement=function(e,t){e.element=t,t.addEventListener("mousemove",e.mousemove),t.addEventListener("mousedown",e.mousedown),t.addEventListener("mouseup",e.mouseup),t.addEventListener("mousewheel",e.mousewheel),t.addEventListener("DOMMouseScroll",e.mousewheel),t.addEventListener("touchmove",e.mousemove),t.addEventListener("touchstart",e.mousedown),t.addEventListener("touchend",e.mouseup)},a.clearSourceEvents=function(e){e.sourceEvents.mousemove=null,e.sourceEvents.mousedown=null,e.sourceEvents.mouseup=null,e.sourceEvents.mousewheel=null,e.wheelDelta=0},a.setOffset=function(e,t){e.offset.x=t.x,e.offset.y=t.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y},a.setScale=function(e,t){e.scale.x=t.x,e.scale.y=t.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y};var e=function(e,t,a){var o=t.getBoundingClientRect(),r=document.documentElement||document.body.parentNode||document.body,i=void 0===window.pageXOffset?r.scrollLeft:window.pageXOffset,n=void 0===window.pageYOffset?r.scrollTop:window.pageYOffset,l=e.changedTouches,s,d;return l?(s=l[0].pageX-o.left-i,d=l[0].pageY-o.top-n):(s=e.pageX-o.left-i,d=e.pageY-o.top-n),{x:s/(t.clientWidth/(t.width||t.clientWidth)*a),y:d/(t.clientHeight/(t.height||t.clientHeight)*a)}}})()},{"../core/Common":14}],20:[function(e,t){var a={};t.exports=a;var o=e("./Common");(function(){a._registry={},a.register=function(e){if(a.isPlugin(e)||o.warn("Plugin.register:",a.toString(e),"does not implement all required fields."),e.name in a._registry){var t=a._registry[e.name],r=a.versionParse(e.version).number,i=a.versionParse(t.version).number;r>i?(o.warn("Plugin.register:",a.toString(t),"was upgraded to",a.toString(e)),a._registry[e.name]=e):r<i?o.warn("Plugin.register:",a.toString(t),"can not be downgraded to",a.toString(e)):e!==t&&o.warn("Plugin.register:",a.toString(e),"is already registered to different plugin object")}else a._registry[e.name]=e;return e},a.resolve=function(e){return a._registry[a.dependencyParse(e).name]},a.toString=function(e){return"string"==typeof e?e:(e.name||"anonymous")+"@"+(e.version||e.range||"0.0.0")},a.isPlugin=function(e){return e&&e.name&&e.version&&e.install},a.isUsed=function(e,t){return-1<e.used.indexOf(t)},a.isFor=function(e,t){var o=e.for&&a.dependencyParse(e.for);return!e.for||t.name===o.name&&a.versionSatisfies(t.version,o.range)},a.use=function(e,t){if(e.uses=(e.uses||[]).concat(t||[]),0===e.uses.length)return void o.warn("Plugin.use:",a.toString(e),"does not specify any dependencies to install.");for(var r=a.dependencies(e),n=o.topologicalSort(r),l=[],s=0;s<n.length;s+=1)if(n[s]!==e.name){var d=a.resolve(n[s]);if(!d){l.push("\u274C "+n[s]);continue}a.isUsed(e,d.name)||(a.isFor(d,e)||(o.warn("Plugin.use:",a.toString(d),"is for",d.for,"but installed on",a.toString(e)+"."),d._warned=!0),d.install?d.install(e):(o.warn("Plugin.use:",a.toString(d),"does not specify an install function."),d._warned=!0),d._warned?(l.push("\uD83D\uDD36 "+a.toString(d)),delete d._warned):l.push("\u2705 "+a.toString(d)),e.used.push(d.name))}0<l.length&&o.info(l.join("  "))},a.dependencies=function(e,t){var r=a.dependencyParse(e),n=r.name;if(t=t||{},!(n in t)){e=a.resolve(e)||e,t[n]=o.map(e.uses||[],function(t){a.isPlugin(t)&&a.register(t);var i=a.dependencyParse(t),n=a.resolve(t);return n&&!a.versionSatisfies(n.version,i.range)?(o.warn("Plugin.dependencies:",a.toString(n),"does not satisfy",a.toString(i),"used by",a.toString(r)+"."),n._warned=!0,e._warned=!0):!n&&(o.warn("Plugin.dependencies:",a.toString(t),"used by",a.toString(r),"could not be resolved."),e._warned=!0),i.name});for(var l=0;l<t[n].length;l+=1)a.dependencies(t[n][l],t);return t}},a.dependencyParse=function(e){if(o.isString(e)){return /^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?))?$/.test(e)||o.warn("Plugin.dependencyParse:",e,"is not a valid dependency string."),{name:e.split("@")[0],range:e.split("@")[1]||"*"}}return{name:e.name,range:e.range||e.version}},a.versionParse=function(e){/^\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?$/.test(e)||o.warn("Plugin.versionParse:",e,"is not a valid version or range.");var t=e.split("-");e=t[0];var a=isNaN(+e[0]),r=a?e.substr(1):e,i=o.map(r.split("."),function(e){return+e});return{isRange:a,version:r,range:e,operator:a?e[0]:"",parts:i,prerelease:t[1],number:1e8*i[0]+1e4*i[1]+i[2]}},a.versionSatisfies=function(e,t){t=t||"*";var o=a.versionParse(t),r=o.parts,i=a.versionParse(e),n=i.parts;if(o.isRange){if("*"===o.operator||"*"===e)return!0;if("~"===o.operator)return n[0]===r[0]&&n[1]===r[1]&&n[2]>=r[2];if("^"===o.operator)return 0<r[0]?n[0]===r[0]&&i.number>=o.number:0<r[1]?n[1]===r[1]&&n[2]>=r[2]:n[2]===r[2]}return e===t||"*"===e}})()},{"./Common":14}],21:[function(e,t){var a={};t.exports=a;var o=e("./Events"),r=e("./Engine"),i=e("./Common");(function(){var e,t;if("undefined"!=typeof window&&(e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),!e){var n;e=function(e){n=setTimeout(function(){e(i.now())},1e3/60)},t=function(){clearTimeout(n)}}a.create=function(e){var t=i.extend({fps:60,correction:1,deltaSampleSize:60,counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,timeScalePrev:1,frameRequestId:null,isFixed:!1,enabled:!0},e);return t.delta=t.delta||1e3/t.fps,t.deltaMin=t.deltaMin||1e3/t.fps,t.deltaMax=t.deltaMax||1e3/(.5*t.fps),t.fps=1e3/t.delta,t},a.run=function(t,o){return"undefined"!=typeof t.positionIterations&&(o=t,t=a.create()),function r(i){t.frameRequestId=e(r),i&&t.enabled&&a.tick(t,o,i)}(),t},a.tick=function(e,t,a){var i=t.timing,n=1,l={timestamp:i.timestamp},s;o.trigger(e,"beforeTick",l),o.trigger(t,"beforeTick",l),e.isFixed?s=e.delta:(s=a-e.timePrev||e.delta,e.timePrev=a,e.deltaHistory.push(s),e.deltaHistory=e.deltaHistory.slice(-e.deltaSampleSize),s=p.apply(null,e.deltaHistory),s=s<e.deltaMin?e.deltaMin:s,s=s>e.deltaMax?e.deltaMax:s,n=s/e.delta,e.delta=s),0!==e.timeScalePrev&&(n*=i.timeScale/e.timeScalePrev),0===i.timeScale&&(n=0),e.timeScalePrev=i.timeScale,e.correction=n,e.frameCounter+=1,1e3<=a-e.counterTimestamp&&(e.fps=e.frameCounter*((a-e.counterTimestamp)/1e3),e.counterTimestamp=a,e.frameCounter=0),o.trigger(e,"tick",l),o.trigger(t,"tick",l),t.world.isModified&&t.render&&t.render.controller&&t.render.controller.clear&&t.render.controller.clear(t.render),o.trigger(e,"beforeUpdate",l),r.update(t,s,n),o.trigger(e,"afterUpdate",l),t.render&&t.render.controller&&(o.trigger(e,"beforeRender",l),o.trigger(t,"beforeRender",l),t.render.controller.world(t.render),o.trigger(e,"afterRender",l),o.trigger(t,"afterRender",l)),o.trigger(e,"afterTick",l),o.trigger(t,"afterTick",l)},a.stop=function(e){t(e.frameRequestId)},a.start=function(e,t){a.run(e,t)}})()},{"./Common":14,"./Engine":15,"./Events":16}],22:[function(e,t){var a={};t.exports=a;var o=e("./Events");(function(){a._motionWakeThreshold=.18,a._motionSleepThreshold=.08,a._minBias=.9,a.update=function(e,t){for(var o=0;o<e.length;o++){var r=e[o],n=r.speed*r.speed+r.angularSpeed*r.angularSpeed;if(0!==r.force.x||0!==r.force.y){a.set(r,!1);continue}var l=p(r.motion,n),s=m(r.motion,n);r.motion=a._minBias*l+(1-a._minBias)*s,0<r.sleepThreshold&&r.motion<a._motionSleepThreshold*(t*t*t)?(r.sleepCounter+=1,r.sleepCounter>=r.sleepThreshold&&a.set(r,!0)):0<r.sleepCounter&&(r.sleepCounter-=1)}},a.afterCollisions=function(e,t){for(var o=0,r;o<e.length;o++)if(r=e[o],r.isActive){var n=r.collision,l=n.bodyA.parent,s=n.bodyB.parent;if(!(l.isSleeping&&s.isSleeping||l.isStatic||s.isStatic)&&(l.isSleeping||s.isSleeping)){var d=l.isSleeping&&!l.isStatic?l:s,c=d===l?s:l;!d.isStatic&&c.motion>a._motionWakeThreshold*(t*t*t)&&a.set(d,!1)}}},a.set=function(e,t){var a=e.isSleeping;t?(e.isSleeping=!0,e.sleepCounter=e.sleepThreshold,e.positionImpulse.x=0,e.positionImpulse.y=0,e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y,e.anglePrev=e.angle,e.speed=0,e.angularSpeed=0,e.motion=0,!a&&o.trigger(e,"sleepStart")):(e.isSleeping=!1,e.sleepCounter=0,a&&o.trigger(e,"sleepEnd"))}})()},{"./Events":16}],23:[function(e,t){(function(a){var o={};t.exports=o;var l=e("../geometry/Vertices"),s=e("../core/Common"),u=e("../body/Body"),g=e("../geometry/Bounds"),h=e("../geometry/Vector"),f="undefined"==typeof window?"undefined"==typeof a?null:a.decomp:window.decomp;(function(){o.rectangle=function(e,t,a,o,r){r=r||{};var i={label:"Rectangle Body",position:{x:e,y:t},vertices:l.fromPath("L 0 0 L "+a+" 0 L "+a+" "+o+" L 0 "+o)};if(r.chamfer){var n=r.chamfer;i.vertices=l.chamfer(i.vertices,n.radius,n.quality,n.qualityMin,n.qualityMax),delete r.chamfer}return u.create(s.extend({},i,r))},o.trapezoid=function(e,t,a,o,r,i){i=i||{},r*=.5;var n=(1-2*r)*a,d=a*r,c=d+n,p=c+d,g;g=.5>r?"L 0 0 L "+d+" "+-o+" L "+c+" "+-o+" L "+p+" 0":"L 0 0 L "+c+" "+-o+" L "+p+" 0";var m={label:"Trapezoid Body",position:{x:e,y:t},vertices:l.fromPath(g)};if(i.chamfer){var h=i.chamfer;m.vertices=l.chamfer(m.vertices,h.radius,h.quality,h.qualityMin,h.qualityMax),delete i.chamfer}return u.create(s.extend({},m,i))},o.circle=function(e,t,a,r,i){r=r||{};i=i||25;var l=n(m(10,p(i,a)));return 1==l%2&&(l+=1),o.polygon(e,t,l,a,s.extend({},{label:"Circle Body",circleRadius:a},r))},o.polygon=function(e,t,a,n,p){if(p=p||{},3>a)return o.circle(e,t,n,p);for(var g=2*d/a,m="",h=0;h<a;h+=1){var y=.5*g+h*g,f=r(y)*n,x=c(y)*n;m+="L "+f.toFixed(3)+" "+x.toFixed(3)+" "}var _={label:"Polygon Body",position:{x:e,y:t},vertices:l.fromPath(m)};if(p.chamfer){var b=p.chamfer;_.vertices=l.chamfer(_.vertices,b.radius,b.quality,b.qualityMin,b.qualityMax),delete p.chamfer}return u.create(s.extend({},_,p))},o.fromVertices=function(e,t,a,o,r,n,d){var c,p,m,y,x,_,b,w,T;for(o=o||{},p=[],r="undefined"!=typeof r&&r,n="undefined"==typeof n?.01:n,d="undefined"==typeof d?10:d,f||s.warn("Bodies.fromVertices: poly-decomp.js required. Could not decompose vertices. Fallback to convex hull."),s.isArray(a[0])||(a=[a]),w=0;w<a.length;w+=1)if(y=a[w],m=l.isConvex(y),m||!f)y=m?l.clockwiseSort(y):l.hull(y),p.push({position:{x:e,y:t},vertices:y});else{var A=y.map(function(e){return[e.x,e.y]});f.makeCCW(A),!1!==n&&f.removeCollinearPoints(A,n);var S=f.quickDecomp(A);for(x=0;x<S.length;x++){var C=S[x],L=C.map(function(e){return{x:e[0],y:e[1]}});0<d&&l.area(L)<d||p.push({position:l.centre(L),vertices:L})}}for(x=0;x<p.length;x++)p[x]=u.create(s.extend(p[x],o));if(r){for(x=0;x<p.length;x++){var E=p[x];for(_=x+1;_<p.length;_++){var I=p[_];if(g.overlaps(E.bounds,I.bounds)){var P=E.vertices,D=I.vertices;for(b=0;b<E.vertices.length;b++)for(T=0;T<I.vertices.length;T++){var O=h.magnitudeSquared(h.sub(P[(b+1)%P.length],D[T])),R=h.magnitudeSquared(h.sub(P[b],D[(T+1)%D.length]));O<5&&R<5&&(P[b].isInternal=!0,D[T].isInternal=!0)}}}}}return 1<p.length?(c=u.create(s.extend({parts:p.slice(0)},o)),u.setPosition(c,{x:e,y:t}),c):p[0]}})()}).call(this,"undefined"==typeof i?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:i)},{"../body/Body":1,"../core/Common":14,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],24:[function(e,t){var a={};t.exports=a;var o=e("../body/Composite"),r=e("../constraint/Constraint"),l=e("../core/Common"),s=e("../body/Body"),d=e("./Bodies");(function(){a.stack=function(e,t,a,r,n,l,d){for(var c=o.create({label:"Stack"}),p=e,u=t,g=0,m=0,h,f;m<r;m++){f=0;for(var _=0,b;_<a;_++)if(b=d(p,u,_,m,h,g),b){var v=b.bounds.max.y-b.bounds.min.y,w=b.bounds.max.x-b.bounds.min.x;v>f&&(f=v),s.translate(b,{x:.5*w,y:.5*v}),p=b.bounds.max.x+n,o.addBody(c,b),h=b,g+=1}else p+=n;u+=f+l,p=e}return c},a.chain=function(e,t,a,n,s,d){for(var c=e.bodies,p=1;p<c.length;p++){var u=c[p-1],g=c[p],m=u.bounds.max.y-u.bounds.min.y,h=u.bounds.max.x-u.bounds.min.x,y=g.bounds.max.y-g.bounds.min.y,f=g.bounds.max.x-g.bounds.min.x,x=l.extend({bodyA:u,pointA:{x:h*t,y:m*a},bodyB:g,pointB:{x:f*n,y:y*s}},d);o.addConstraint(e,r.create(x))}return e.label+=" Chain",e},a.mesh=function(e,t,a,i,n){var s=e.bodies,d,c,p,u,g;for(d=0;d<a;d++){for(c=1;c<t;c++)p=s[c-1+d*t],u=s[c+d*t],o.addConstraint(e,r.create(l.extend({bodyA:p,bodyB:u},n)));if(0<d)for(c=0;c<t;c++)p=s[c+(d-1)*t],u=s[c+d*t],o.addConstraint(e,r.create(l.extend({bodyA:p,bodyB:u},n))),i&&0<c&&(g=s[c-1+(d-1)*t],o.addConstraint(e,r.create(l.extend({bodyA:g,bodyB:u},n)))),i&&c<t-1&&(g=s[c+1+(d-1)*t],o.addConstraint(e,r.create(l.extend({bodyA:g,bodyB:u},n))))}return e.label+=" Mesh",e},a.pyramid=function(e,t,o,r,l,d,c){return a.stack(e,t,o,r,l,d,function(t,a,d,u,g,m){var i=p(r,n(o/2)),h=g?g.bounds.max.x-g.bounds.min.x:0;if(!(u>i)){u=i-u;var y=u,f=o-1-u;if(!(d<y||d>f)){1===m&&s.translate(g,{x:(d+(1==o%2?1:-1))*h,y:0});var x=g?d*h:0;return c(e+x+d*l,a,d,u,g,m)}}})},a.newtonsCradle=function(e,t,a,n,l){for(var s=o.create({label:"Newtons Cradle"}),c=0;c<a;c++){var p=1.9,u=d.circle(e+c*(n*p),t+l,n,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),g=r.create({pointA:{x:e+c*(n*p),y:t},bodyB:u});o.addBody(s,u),o.addConstraint(s,g)}return s},a.car=function(e,t,a,i,n){var l=s.nextGroup(!0),c=.5*-a+-20,p=.5*a- -20,u=o.create({label:"Car"}),g=d.trapezoid(e,t,a,i,.3,{collisionFilter:{group:l},friction:.01,chamfer:{radius:10}}),m=d.circle(e+c,t+0,n,{collisionFilter:{group:l},friction:.8,density:.01}),h=d.circle(e+p,t+0,n,{collisionFilter:{group:l},friction:.8,density:.01}),y=r.create({bodyA:g,pointA:{x:c,y:0},bodyB:m,stiffness:.2,render:{lineWidth:0}}),f=r.create({bodyA:g,pointA:{x:p,y:0},bodyB:h,stiffness:.2,render:{lineWidth:0}});return o.addBody(u,g),o.addBody(u,m),o.addBody(u,h),o.addConstraint(u,y),o.addConstraint(u,f),u},a.softBody=function(e,t,o,r,i,n,s,c,p,u){p=l.extend({inertia:1/0},p),u=l.extend({stiffness:.4},u);var g=a.stack(e,t,o,r,i,n,function(e,t){return d.circle(e,t,c,p)});return a.mesh(g,o,r,s,u),g.label="Soft Body",g}})()},{"../body/Body":1,"../body/Composite":2,"../constraint/Constraint":12,"../core/Common":14,"./Bodies":23}],25:[function(e,t){var a={};t.exports=a;var o=e("../geometry/Vector"),n=e("../core/Common");(function(){a.fromVertices=function(e){for(var t={},a=0;a<e.length;a++){var r=(a+1)%e.length,l=o.normalise({x:e[r].y-e[a].y,y:e[a].x-e[r].x}),s=0===l.y?1/0:l.x/l.y;s=s.toFixed(3).toString(),t[s]=l}return n.values(t)},a.rotate=function(e,t){if(0!==t)for(var a=r(t),o=c(t),n=0;n<e.length;n++){var l=e[n],s;s=l.x*a-l.y*o,l.y=l.x*o+l.y*a,l.x=s}}})()},{"../core/Common":14,"../geometry/Vector":28}],26:[function(e,t){var a={};t.exports=a,function(){a.create=function(e){var t={min:{x:0,y:0},max:{x:0,y:0}};return e&&a.update(t,e),t},a.update=function(e,t,a){e.min.x=1/0,e.max.x=-Infinity,e.min.y=1/0,e.max.y=-Infinity;for(var o=0,r;o<t.length;o++)r=t[o],r.x>e.max.x&&(e.max.x=r.x),r.x<e.min.x&&(e.min.x=r.x),r.y>e.max.y&&(e.max.y=r.y),r.y<e.min.y&&(e.min.y=r.y);a&&(0<a.x?e.max.x+=a.x:e.min.x+=a.x,0<a.y?e.max.y+=a.y:e.min.y+=a.y)},a.contains=function(e,t){return t.x>=e.min.x&&t.x<=e.max.x&&t.y>=e.min.y&&t.y<=e.max.y},a.overlaps=function(e,t){return e.min.x<=t.max.x&&e.max.x>=t.min.x&&e.max.y>=t.min.y&&e.min.y<=t.max.y},a.translate=function(e,t){e.min.x+=t.x,e.max.x+=t.x,e.min.y+=t.y,e.max.y+=t.y},a.shift=function(e,t){var a=e.max.x-e.min.x,o=e.max.y-e.min.y;e.min.x=t.x,e.max.x=t.x+a,e.min.y=t.y,e.max.y=t.y+o}}()},{}],27:[function(e,t){var a={};t.exports=a;e("../geometry/Bounds");(function(){a.pathToVertices=function(t,a){var o=[],r=0,n=0,l=0,s,d,c,p,u,g,m,h,f,_,b,v;a=a||15;var w=function(e,t,a){var r=1==a%2&&1<a;if(!f||e!=f.x||t!=f.y){f&&r?(b=f.x,v=f.y):(b=0,v=0);var i={x:b+e,y:v+t};(r||!f)&&(f=i),o.push(i),n=b+e,l=v+t}},k=function(e){var t=e.pathSegTypeAsLetter.toUpperCase();"Z"!==t&&("M"===t||"L"===t||"T"===t||"C"===t||"S"===t||"Q"===t?(n=e.x,l=e.y):"H"===t?n=e.x:"V"===t?l=e.y:void 0,w(n,l,e.pathSegType))};for(e(t),c=t.getTotalLength(),g=[],s=0;s<t.pathSegList.numberOfItems;s+=1)g.push(t.pathSegList.getItem(s));for(m=g.concat();r<c;){if(_=t.getPathSegAtLength(r),u=g[_],u!=h){for(;m.length&&m[0]!=u;)k(m.shift());h=u}switch(u.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":p=t.getPointAtLength(r),w(p.x,p.y,0);}r+=a}for(s=0,d=m.length;s<d;++s)k(m[s]);return o};var e=function(e){for(var t=e.pathSegList,a=0,o=0,r=t.numberOfItems,n=0,l,s,d,c,p,u;n<r;++n){var g=t.getItem(n),m=g.pathSegTypeAsLetter;/[MLHVCSQTA]/.test(m)?("x"in g&&(a=g.x),"y"in g&&(o=g.y)):("x1"in g&&(d=a+g.x1),"x2"in g&&(p=a+g.x2),"y1"in g&&(c=o+g.y1),"y2"in g&&(u=o+g.y2),"x"in g&&(a+=g.x),"y"in g&&(o+=g.y),"m"===m?t.replaceItem(e.createSVGPathSegMovetoAbs(a,o),n):"l"===m?t.replaceItem(e.createSVGPathSegLinetoAbs(a,o),n):"h"===m?t.replaceItem(e.createSVGPathSegLinetoHorizontalAbs(a),n):"v"===m?t.replaceItem(e.createSVGPathSegLinetoVerticalAbs(o),n):"c"===m?t.replaceItem(e.createSVGPathSegCurvetoCubicAbs(a,o,d,c,p,u),n):"s"===m?t.replaceItem(e.createSVGPathSegCurvetoCubicSmoothAbs(a,o,p,u),n):"q"===m?t.replaceItem(e.createSVGPathSegCurvetoQuadraticAbs(a,o,d,c),n):"t"===m?t.replaceItem(e.createSVGPathSegCurvetoQuadraticSmoothAbs(a,o),n):"a"===m?t.replaceItem(e.createSVGPathSegArcAbs(a,o,g.r1,g.r2,g.angle,g.largeArcFlag,g.sweepFlag),n):"z"===m||"Z"===m?(a=l,o=s):void 0);("M"==m||"m"==m)&&(l=a,s=o)}}})()},{"../geometry/Bounds":26}],28:[function(e,t){var a={};t.exports=a,function(){a.create=function(e,t){return{x:e||0,y:t||0}},a.clone=function(e){return{x:e.x,y:e.y}},a.magnitude=function(e){return l(e.x*e.x+e.y*e.y)},a.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y},a.rotate=function(e,t){var a=r(t),o=c(t);return{x:e.x*a-e.y*o,y:e.x*o+e.y*a}},a.rotateAbout=function(e,t,a,o){var i=r(t),n=c(t);o||(o={});var l=a.x+((e.x-a.x)*i-(e.y-a.y)*n);return o.y=a.y+((e.x-a.x)*n+(e.y-a.y)*i),o.x=l,o},a.normalise=function(e){var t=a.magnitude(e);return 0===t?{x:0,y:0}:{x:e.x/t,y:e.y/t}},a.dot=function(e,t){return e.x*t.x+e.y*t.y},a.cross=function(e,t){return e.x*t.y-e.y*t.x},a.cross3=function(e,t,a){return(t.x-e.x)*(a.y-e.y)-(t.y-e.y)*(a.x-e.x)},a.add=function(e,t,a){return a||(a={}),a.x=e.x+t.x,a.y=e.y+t.y,a},a.sub=function(e,t,a){return a||(a={}),a.x=e.x-t.x,a.y=e.y-t.y,a},a.mult=function(e,t){return{x:e.x*t,y:e.y*t}},a.div=function(e,t){return{x:e.x/t,y:e.y/t}},a.perp=function(e,t){return t=!0===t?-1:1,{x:t*-e.y,y:t*e.x}},a.neg=function(e){return{x:-e.x,y:-e.y}},a.angle=function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)},a._temp=[a.create(),a.create(),a.create(),a.create(),a.create(),a.create()]}()},{}],29:[function(e,t){var a={};t.exports=a;var o=e("../geometry/Vector"),n=e("../core/Common");(function(){a.create=function(e,t){for(var a=[],o=0;o<e.length;o++){var r=e[o],n={x:r.x,y:r.y,index:o,body:t,isInternal:!1};a.push(n)}return a},a.fromPath=function(e,t){var o=[];return e.replace(/L?\s*([\-\d\.e]+)[\s,]*([\-\d\.e]+)*/ig,function(e,t,a){o.push({x:parseFloat(t),y:parseFloat(a)})}),a.create(o,t)},a.centre=function(e){for(var t=a.area(e,!0),r={x:0,y:0},n=0,l,s,d;n<e.length;n++)d=(n+1)%e.length,l=o.cross(e[n],e[d]),s=o.mult(o.add(e[n],e[d]),l),r=o.add(r,s);return o.div(r,6*t)},a.mean=function(e){for(var t={x:0,y:0},a=0;a<e.length;a++)t.x+=e[a].x,t.y+=e[a].y;return o.div(t,e.length)},a.area=function(e,t){for(var a=0,o=e.length-1,r=0;r<e.length;r++)a+=(e[o].x-e[r].x)*(e[o].y+e[r].y),o=r;return t?a/2:g(a)/2},a.inertia=function(e,t){for(var a=0,r=0,i=e,l=0,s,d;l<i.length;l++)d=(l+1)%i.length,s=g(o.cross(i[d],i[l])),a+=s*(o.dot(i[d],i[d])+o.dot(i[d],i[l])+o.dot(i[l],i[l])),r+=s;return t/6*(a/r)},a.translate=function(e,t,a){var o;if(a)for(o=0;o<e.length;o++)e[o].x+=t.x*a,e[o].y+=t.y*a;else for(o=0;o<e.length;o++)e[o].x+=t.x,e[o].y+=t.y;return e},a.rotate=function(e,t,a){if(0!==t){for(var o=r(t),n=c(t),l=0;l<e.length;l++){var s=e[l],d=s.x-a.x,p=s.y-a.y;s.x=a.x+(d*o-p*n),s.y=a.y+(d*n+p*o)}return e}},a.contains=function(e,t){for(var a=0;a<e.length;a++){var o=e[a],r=e[(a+1)%e.length];if(0<(t.x-o.x)*(r.y-o.y)+(t.y-o.y)*(o.x-r.x))return!1}return!0},a.scale=function(e,t,r,n){if(1===t&&1===r)return e;n=n||a.centre(e);for(var l=0,s,d;l<e.length;l++)s=e[l],d=o.sub(s,n),e[l].x=n.x+d.x*t,e[l].y=n.y+d.y*r;return e},a.chamfer=function(e,t,a,r,s){t=t||[8],t.length||(t=[t]),a="undefined"==typeof a?-1:a,r=r||2,s=s||14;for(var d=[],c=0;c<e.length;c++){var p=e[0<=c-1?c-1:e.length-1],g=e[c],m=e[(c+1)%e.length],h=t[c<t.length?c:t.length-1];if(0===h){d.push(g);continue}var y=o.normalise({x:g.y-p.y,y:p.x-g.x}),f=o.normalise({x:m.y-g.y,y:g.x-m.x}),x=l(2*u(h,2)),_=o.mult(n.clone(y),h),b=o.normalise(o.mult(o.add(y,f),.5)),v=o.sub(g,o.mult(b,x)),w=a;-1===a&&(w=1.75*u(h,.32)),w=n.clamp(w,r,s),1==w%2&&(w+=1);for(var k=Math.acos(o.dot(y,f)),T=k/w,A=0;A<w;A++)d.push(o.add(o.rotate(_,T*A),v))}return d},a.clockwiseSort=function(e){var t=a.mean(e);return e.sort(function(e,a){return o.angle(t,e)-o.angle(t,a)}),e},a.isConvex=function(e){var t=0,a=e.length,o,r,n,l;if(3>a)return null;for(o=0;o<a;o++)if(r=(o+1)%a,n=(o+2)%a,l=(e[r].x-e[o].x)*(e[n].y-e[r].y),l-=(e[r].y-e[o].y)*(e[n].x-e[r].x),0>l?t|=1:0<l&&(t|=2),3===t)return!1;return 0!=t||null},a.hull=function(e){var t=[],a=[],r,n;for(e=e.slice(0),e.sort(function(e,t){var a=e.x-t.x;return 0==a?e.y-t.y:a}),n=0;n<e.length;n++){for(r=e[n];2<=a.length&&0>=o.cross3(a[a.length-2],a[a.length-1],r);)a.pop();a.push(r)}for(n=e.length-1;0<=n;n--){for(r=e[n];2<=t.length&&0>=o.cross3(t[t.length-2],t[t.length-1],r);)t.pop();t.push(r)}return t.pop(),a.pop(),t.concat(a)}})()},{"../core/Common":14,"../geometry/Vector":28}],30:[function(e,t){var a=t.exports=e("../core/Matter");a.Body=e("../body/Body"),a.Composite=e("../body/Composite"),a.World=e("../body/World"),a.Contact=e("../collision/Contact"),a.Detector=e("../collision/Detector"),a.Grid=e("../collision/Grid"),a.Pairs=e("../collision/Pairs"),a.Pair=e("../collision/Pair"),a.Query=e("../collision/Query"),a.Resolver=e("../collision/Resolver"),a.SAT=e("../collision/SAT"),a.Constraint=e("../constraint/Constraint"),a.MouseConstraint=e("../constraint/MouseConstraint"),a.Common=e("../core/Common"),a.Engine=e("../core/Engine"),a.Events=e("../core/Events"),a.Mouse=e("../core/Mouse"),a.Runner=e("../core/Runner"),a.Sleeping=e("../core/Sleeping"),a.Plugin=e("../core/Plugin"),a.Bodies=e("../factory/Bodies"),a.Composites=e("../factory/Composites"),a.Axes=e("../geometry/Axes"),a.Bounds=e("../geometry/Bounds"),a.Svg=e("../geometry/Svg"),a.Vector=e("../geometry/Vector"),a.Vertices=e("../geometry/Vertices"),a.Render=e("../render/Render"),a.RenderPixi=e("../render/RenderPixi"),a.World.add=a.Composite.add,a.World.remove=a.Composite.remove,a.World.addComposite=a.Composite.addComposite,a.World.addBody=a.Composite.addBody,a.World.addConstraint=a.Composite.addConstraint,a.World.clear=a.Composite.clear,a.Engine.run=a.Runner.run},{"../body/Body":1,"../body/Composite":2,"../body/World":3,"../collision/Contact":4,"../collision/Detector":5,"../collision/Grid":6,"../collision/Pair":7,"../collision/Pairs":8,"../collision/Query":9,"../collision/Resolver":10,"../collision/SAT":11,"../constraint/Constraint":12,"../constraint/MouseConstraint":13,"../core/Common":14,"../core/Engine":15,"../core/Events":16,"../core/Matter":17,"../core/Metrics":18,"../core/Mouse":19,"../core/Plugin":20,"../core/Runner":21,"../core/Sleeping":22,"../factory/Bodies":23,"../factory/Composites":24,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Svg":27,"../geometry/Vector":28,"../geometry/Vertices":29,"../render/Render":31,"../render/RenderPixi":32}],31:[function(e,t){var a={};t.exports=a;var o=e("../core/Common"),r=e("../body/Composite"),n=e("../geometry/Bounds"),l=e("../core/Events"),c=e("../collision/Grid"),u=e("../geometry/Vector"),m=e("../core/Mouse");(function(){var e,t;"undefined"!=typeof window&&(e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(function(){e(o.now())},1e3/60)},t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),a.create=function(e){var t={controller:a,engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,options:{width:800,height:600,pixelRatio:1,background:"#18181d",wireframeBackground:"#0f0f13",hasBounds:!!e.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},r=o.extend(t,e);return r.canvas&&(r.canvas.width=r.options.width||r.canvas.width,r.canvas.height=r.options.height||r.canvas.height),r.mouse=e.mouse,r.engine=e.engine,r.canvas=r.canvas||i(r.options.width,r.options.height),r.context=r.canvas.getContext("2d"),r.textures={},r.bounds=r.bounds||{min:{x:0,y:0},max:{x:r.canvas.width,y:r.canvas.height}},1!==r.options.pixelRatio&&a.setPixelRatio(r,r.options.pixelRatio),o.isElement(r.element)?r.element.appendChild(r.canvas):o.log("Render.create: options.element was undefined, render.canvas was created but not appended","warn"),r},a.run=function(t){(function o(){t.frameRequestId=e(o),a.world(t)})()},a.stop=function(e){t(e.frameRequestId)},a.setPixelRatio=function(e,t){var a=e.options,o=e.canvas;"auto"===t&&(t=y(o)),a.pixelRatio=t,o.setAttribute("data-pixel-ratio",t),o.width=a.width*t,o.height=a.height*t,o.style.width=a.width+"px",o.style.height=a.height+"px",e.context.scale(t,t)},a.lookAt=function(e,t,a,r){r=!("undefined"!=typeof r)||r,t=o.isArray(t)?t:[t],a=a||{x:0,y:0};for(var n={min:{x:1/0,y:1/0},max:{x:-Infinity,y:-Infinity}},l=0;l<t.length;l+=1){var s=t[l],d=s.bounds?s.bounds.min:s.min||s.position||s,c=s.bounds?s.bounds.max:s.max||s.position||s;d&&c&&(d.x<n.min.x&&(n.min.x=d.x),c.x>n.max.x&&(n.max.x=c.x),d.y<n.min.y&&(n.min.y=d.y),c.y>n.max.y&&(n.max.y=c.y))}var p=n.max.x-n.min.x+2*a.x,u=n.max.y-n.min.y+2*a.y,g=e.canvas.height,h=e.canvas.width,y=h/g,f=p/u,x=1,_=1;f>y?_=f/y:x=y/f,e.options.hasBounds=!0,e.bounds.min.x=n.min.x,e.bounds.max.x=n.min.x+p*x,e.bounds.min.y=n.min.y,e.bounds.max.y=n.min.y+u*_,r&&(e.bounds.min.x+=.5*p-.5*(p*x),e.bounds.max.x+=.5*p-.5*(p*x),e.bounds.min.y+=.5*u-.5*(u*_),e.bounds.max.y+=.5*u-.5*(u*_)),e.bounds.min.x-=a.x,e.bounds.max.x-=a.x,e.bounds.min.y-=a.y,e.bounds.max.y-=a.y,e.mouse&&(m.setScale(e.mouse,{x:(e.bounds.max.x-e.bounds.min.x)/e.canvas.width,y:(e.bounds.max.y-e.bounds.min.y)/e.canvas.height}),m.setOffset(e.mouse,e.bounds.min))},a.startViewTransform=function(e){var t=e.bounds.max.x-e.bounds.min.x,a=e.bounds.max.y-e.bounds.min.y,o=t/e.options.width,r=a/e.options.height;e.context.scale(1/o,1/r),e.context.translate(-e.bounds.min.x,-e.bounds.min.y)},a.endViewTransform=function(e){e.context.setTransform(e.options.pixelRatio,0,0,e.options.pixelRatio,0,0)},a.world=function(e){var t=e.engine,o=t.world,s=e.canvas,d=e.context,p=e.options,g=r.allBodies(o),h=r.allConstraints(o),y=p.wireframes?p.wireframeBackground:p.background,f=[],_=[],b={timestamp:t.timing.timestamp},v;if(l.trigger(e,"beforeRender",b),e.currentBackground!==y&&x(e,y),d.globalCompositeOperation="source-in",d.fillStyle="transparent",d.fillRect(0,0,s.width,s.height),d.globalCompositeOperation="source-over",p.hasBounds){for(v=0;v<g.length;v++){var w=g[v];n.overlaps(w.bounds,e.bounds)&&f.push(w)}for(v=0;v<h.length;v++){var k=h[v],T=k.bodyA,A=k.bodyB,S=k.pointA,C=k.pointB;T&&(S=u.add(T.position,k.pointA)),A&&(C=u.add(A.position,k.pointB)),S&&C&&(n.contains(e.bounds,S)||n.contains(e.bounds,C))&&_.push(k)}a.startViewTransform(e),e.mouse&&(m.setScale(e.mouse,{x:(e.bounds.max.x-e.bounds.min.x)/e.canvas.width,y:(e.bounds.max.y-e.bounds.min.y)/e.canvas.height}),m.setOffset(e.mouse,e.bounds.min))}else _=h,f=g;!p.wireframes||t.enableSleeping&&p.showSleeping?a.bodies(e,f,d):(p.showConvexHulls&&a.bodyConvexHulls(e,f,d),a.bodyWireframes(e,f,d)),p.showBounds&&a.bodyBounds(e,f,d),(p.showAxes||p.showAngleIndicator)&&a.bodyAxes(e,f,d),p.showPositions&&a.bodyPositions(e,f,d),p.showVelocity&&a.bodyVelocity(e,f,d),p.showIds&&a.bodyIds(e,f,d),p.showSeparations&&a.separations(e,t.pairs.list,d),p.showCollisions&&a.collisions(e,t.pairs.list,d),p.showVertexNumbers&&a.vertexNumbers(e,f,d),p.showMousePosition&&a.mousePosition(e,e.mouse,d),a.constraints(_,d),p.showBroadphase&&t.broadphase.controller===c&&a.grid(e,t.broadphase,d),p.showDebug&&a.debug(e,d),p.hasBounds&&a.endViewTransform(e),l.trigger(e,"afterRender",b)},a.debug=function(e,t){var a=t,o=e.engine,n=o.world,l=o.metrics,d=e.options,c=r.allBodies(n);if(500<=o.timing.timestamp-(e.debugTimestamp||0)){var p="";l.timing&&(p+="fps: "+s(l.timing.fps)+"    "),e.debugString=p,e.debugTimestamp=o.timing.timestamp}if(e.debugString){a.font="12px Arial",a.fillStyle=d.wireframes?"rgba(255,255,255,0.5)":"rgba(0,0,0,0.5)";for(var u=e.debugString.split("\n"),g=0;g<u.length;g++)a.fillText(u[g],50,50+18*g)}},a.constraints=function(e,t){for(var a=t,o=0,r;o<e.length;o++)if(r=e[o],r.render.visible&&r.pointA&&r.pointB){var n=r.bodyA,l=r.bodyB;n?(a.beginPath(),a.moveTo(n.position.x+r.pointA.x,n.position.y+r.pointA.y)):(a.beginPath(),a.moveTo(r.pointA.x,r.pointA.y)),l?a.lineTo(l.position.x+r.pointB.x,l.position.y+r.pointB.y):a.lineTo(r.pointB.x,r.pointB.y),r.render.lineWidth&&(a.lineWidth=r.render.lineWidth,a.strokeStyle=r.render.strokeStyle,a.stroke())}},a.bodyShadows=function(e,t,a){for(var o=a,r=e.engine,n=0,l;n<t.length;n++)if(l=t[n],l.render.visible){if(l.circleRadius)o.beginPath(),o.arc(l.position.x,l.position.y,l.circleRadius,0,2*d),o.closePath();else{o.beginPath(),o.moveTo(l.vertices[0].x,l.vertices[0].y);for(var s=1;s<l.vertices.length;s++)o.lineTo(l.vertices[s].x,l.vertices[s].y);o.closePath()}var c=l.position.x-.5*e.options.width,u=l.position.y-.2*e.options.height,m=g(c)+g(u);o.shadowColor="rgba(0,0,0,0.15)",o.shadowOffsetX=.05*c,o.shadowOffsetY=.05*u,o.shadowBlur=1+12*p(1,m/1e3),o.fill(),o.shadowColor=null,o.shadowOffsetX=null,o.shadowOffsetY=null,o.shadowBlur=null}},a.bodies=function(e,t,a){var o=a,r=e.engine,n=e.options,l=n.showInternalEdges||!n.wireframes,s,c,p,u;for(p=0;p<t.length;p++)if(s=t[p],s.render.visible)for(u=1<s.parts.length?1:0;u<s.parts.length;u++)if(c=s.parts[u],c.render.visible){if(n.showSleeping&&s.isSleeping?o.globalAlpha=.5*c.render.opacity:1!==c.render.opacity&&(o.globalAlpha=c.render.opacity),c.render.sprite&&c.render.sprite.texture&&!n.wireframes){var g=c.render.sprite,m=f(e,g.texture);o.translate(c.position.x,c.position.y),o.rotate(c.angle),o.drawImage(m,m.width*-g.xOffset*g.xScale,m.height*-g.yOffset*g.yScale,m.width*g.xScale,m.height*g.yScale),o.rotate(-c.angle),o.translate(-c.position.x,-c.position.y)}else{if(c.circleRadius)o.beginPath(),o.arc(c.position.x,c.position.y,c.circleRadius,0,2*d);else{o.beginPath(),o.moveTo(c.vertices[0].x,c.vertices[0].y);for(var h=1;h<c.vertices.length;h++)!c.vertices[h-1].isInternal||l?o.lineTo(c.vertices[h].x,c.vertices[h].y):o.moveTo(c.vertices[h].x,c.vertices[h].y),c.vertices[h].isInternal&&!l&&o.moveTo(c.vertices[(h+1)%c.vertices.length].x,c.vertices[(h+1)%c.vertices.length].y);o.lineTo(c.vertices[0].x,c.vertices[0].y),o.closePath()}n.wireframes?(o.lineWidth=1,o.strokeStyle="#bbb",o.stroke()):(o.fillStyle=c.render.fillStyle,c.render.lineWidth&&(o.lineWidth=c.render.lineWidth,o.strokeStyle=c.render.strokeStyle,o.stroke()),o.fill())}o.globalAlpha=1}},a.bodyWireframes=function(e,t,a){var o=a,r=e.options.showInternalEdges,n,l,s,d,c;for(o.beginPath(),s=0;s<t.length;s++)if(n=t[s],n.render.visible)for(c=1<n.parts.length?1:0;c<n.parts.length;c++){for(l=n.parts[c],o.moveTo(l.vertices[0].x,l.vertices[0].y),d=1;d<l.vertices.length;d++)!l.vertices[d-1].isInternal||r?o.lineTo(l.vertices[d].x,l.vertices[d].y):o.moveTo(l.vertices[d].x,l.vertices[d].y),l.vertices[d].isInternal&&!r&&o.moveTo(l.vertices[(d+1)%l.vertices.length].x,l.vertices[(d+1)%l.vertices.length].y);o.lineTo(l.vertices[0].x,l.vertices[0].y)}o.lineWidth=1,o.strokeStyle="#bbb",o.stroke()},a.bodyConvexHulls=function(e,t,a){var o=a,r,n,l;for(o.beginPath(),n=0;n<t.length;n++)if(r=t[n],r.render.visible&&1!==r.parts.length){for(o.moveTo(r.vertices[0].x,r.vertices[0].y),l=1;l<r.vertices.length;l++)o.lineTo(r.vertices[l].x,r.vertices[l].y);o.lineTo(r.vertices[0].x,r.vertices[0].y)}o.lineWidth=1,o.strokeStyle="rgba(255,255,255,0.2)",o.stroke()},a.vertexNumbers=function(e,t,a){var o=a,r,n,l;for(r=0;r<t.length;r++){var s=t[r].parts;for(l=1<s.length?1:0;l<s.length;l++){var d=s[l];for(n=0;n<d.vertices.length;n++)o.fillStyle="rgba(255,255,255,0.2)",o.fillText(r+"_"+n,d.position.x+.8*(d.vertices[n].x-d.position.x),d.position.y+.8*(d.vertices[n].y-d.position.y))}}},a.mousePosition=function(e,t,a){var o=a;o.fillStyle="rgba(255,255,255,0.8)",o.fillText(t.position.x+"  "+t.position.y,t.position.x+5,t.position.y-5)},a.bodyBounds=function(e,t,a){var o=a,r=e.engine,n=e.options;o.beginPath();for(var l=0,s;l<t.length;l++)if(s=t[l],s.render.visible)for(var d=t[l].parts,c=1<d.length?1:0,p;c<d.length;c++)p=d[c],o.rect(p.bounds.min.x,p.bounds.min.y,p.bounds.max.x-p.bounds.min.x,p.bounds.max.y-p.bounds.min.y);o.strokeStyle=n.wireframes?"rgba(255,255,255,0.08)":"rgba(0,0,0,0.1)",o.lineWidth=1,o.stroke()},a.bodyAxes=function(e,t,a){var o=a,r=e.engine,n=e.options,l,s,d,c;for(o.beginPath(),s=0;s<t.length;s++){var p=t[s],u=p.parts;if(p.render.visible)if(n.showAxes)for(d=1<u.length?1:0;d<u.length;d++)for(l=u[d],c=0;c<l.axes.length;c++){var g=l.axes[c];o.moveTo(l.position.x,l.position.y),o.lineTo(l.position.x+20*g.x,l.position.y+20*g.y)}else for(d=1<u.length?1:0;d<u.length;d++)for(l=u[d],c=0;c<l.axes.length;c++)o.moveTo(l.position.x,l.position.y),o.lineTo((l.vertices[0].x+l.vertices[l.vertices.length-1].x)/2,(l.vertices[0].y+l.vertices[l.vertices.length-1].y)/2)}n.wireframes?(o.strokeStyle="indianred",o.lineWidth=1):(o.strokeStyle="rgba(255, 255, 255, 0.4)",o.globalCompositeOperation="overlay",o.lineWidth=2),o.stroke(),o.globalCompositeOperation="source-over"},a.bodyPositions=function(e,t,a){var o=a,r=e.engine,n=e.options,l,s,c,p;for(o.beginPath(),c=0;c<t.length;c++)if(l=t[c],l.render.visible)for(p=0;p<l.parts.length;p++)s=l.parts[p],o.arc(s.position.x,s.position.y,3,0,2*d,!1),o.closePath();for(o.fillStyle=n.wireframes?"indianred":"rgba(0,0,0,0.5)",o.fill(),o.beginPath(),c=0;c<t.length;c++)l=t[c],l.render.visible&&(o.arc(l.positionPrev.x,l.positionPrev.y,2,0,2*d,!1),o.closePath());o.fillStyle="rgba(255,165,0,0.8)",o.fill()},a.bodyVelocity=function(e,t,a){var o=a;o.beginPath();for(var r=0,n;r<t.length;r++)n=t[r],n.render.visible&&(o.moveTo(n.position.x,n.position.y),o.lineTo(n.position.x+2*(n.position.x-n.positionPrev.x),n.position.y+2*(n.position.y-n.positionPrev.y)));o.lineWidth=3,o.strokeStyle="cornflowerblue",o.stroke()},a.bodyIds=function(e,t,a){var o=a,r,n;for(r=0;r<t.length;r++)if(t[r].render.visible){var l=t[r].parts;for(n=1<l.length?1:0;n<l.length;n++){var s=l[n];o.font="12px Arial",o.fillStyle="rgba(255,255,255,0.5)",o.fillText(s.id,s.position.x+10,s.position.y-10)}}},a.collisions=function(e,t,a){var o=a,r=e.options,n,l,s,d;for(o.beginPath(),s=0;s<t.length;s++)if(n=t[s],n.isActive)for(l=n.collision,d=0;d<n.activeContacts.length;d++){var c=n.activeContacts[d],p=c.vertex;o.rect(p.x-1.5,p.y-1.5,3.5,3.5)}for(o.fillStyle=r.wireframes?"rgba(255,255,255,0.7)":"orange",o.fill(),o.beginPath(),s=0;s<t.length;s++)if(n=t[s],n.isActive&&(l=n.collision,0<n.activeContacts.length)){var u=n.activeContacts[0].vertex.x,g=n.activeContacts[0].vertex.y;2===n.activeContacts.length&&(u=(n.activeContacts[0].vertex.x+n.activeContacts[1].vertex.x)/2,g=(n.activeContacts[0].vertex.y+n.activeContacts[1].vertex.y)/2),l.bodyB===l.supports[0].body||!0===l.bodyA.isStatic?o.moveTo(u-8*l.normal.x,g-8*l.normal.y):o.moveTo(u+8*l.normal.x,g+8*l.normal.y),o.lineTo(u,g)}o.strokeStyle=r.wireframes?"rgba(255,165,0,0.7)":"orange",o.lineWidth=1,o.stroke()},a.separations=function(e,t,a){var o=a,r=e.options,n,l,s,d,c;for(o.beginPath(),c=0;c<t.length;c++)if(n=t[c],n.isActive){l=n.collision,s=l.bodyA,d=l.bodyB;var p=1;d.isStatic||s.isStatic||(p=.5),d.isStatic&&(p=0),o.moveTo(d.position.x,d.position.y),o.lineTo(d.position.x-l.penetration.x*p,d.position.y-l.penetration.y*p),p=1,d.isStatic||s.isStatic||(p=.5),s.isStatic&&(p=0),o.moveTo(s.position.x,s.position.y),o.lineTo(s.position.x+l.penetration.x*p,s.position.y+l.penetration.y*p)}o.strokeStyle=r.wireframes?"rgba(255,165,0,0.5)":"orange",o.stroke()},a.grid=function(e,t,a){var r=a,n=e.options;r.strokeStyle=n.wireframes?"rgba(255,180,0,0.1)":"rgba(255,180,0,0.5)",r.beginPath();for(var l=o.keys(t.buckets),s=0,d;s<l.length;s++)if(d=l[s],!(2>t.buckets[d].length)){var c=d.split(/C|R/);r.rect(.5+parseInt(c[1],10)*t.bucketWidth,.5+parseInt(c[2],10)*t.bucketHeight,t.bucketWidth,t.bucketHeight)}r.lineWidth=1,r.stroke()},a.inspector=function(e,t){var a=e.engine,o=e.selected,r=e.render,n=r.options,l;if(n.hasBounds){var s=r.bounds.max.x-r.bounds.min.x,c=r.bounds.max.y-r.bounds.min.y,p=s/r.options.width,u=c/r.options.height;t.scale(1/p,1/u),t.translate(-r.bounds.min.x,-r.bounds.min.y)}for(var g=0,m;g<o.length;g++){switch(m=o[g].data,t.translate(.5,.5),t.lineWidth=1,t.strokeStyle="rgba(255,165,0,0.9)",t.setLineDash([1,2]),m.type){case"body":l=m.bounds,t.beginPath(),t.rect(h(l.min.x-3),h(l.min.y-3),h(l.max.x-l.min.x+6),h(l.max.y-l.min.y+6)),t.closePath(),t.stroke();break;case"constraint":var y=m.pointA;m.bodyA&&(y=m.pointB),t.beginPath(),t.arc(y.x,y.y,10,0,2*d),t.closePath(),t.stroke();}t.setLineDash([]),t.translate(-.5,-.5)}null!==e.selectStart&&(t.translate(.5,.5),t.lineWidth=1,t.strokeStyle="rgba(255,165,0,0.6)",t.fillStyle="rgba(255,165,0,0.1)",l=e.selectBounds,t.beginPath(),t.rect(h(l.min.x),h(l.min.y),h(l.max.x-l.min.x),h(l.max.y-l.min.y)),t.closePath(),t.stroke(),t.fill(),t.translate(-.5,-.5)),n.hasBounds&&t.setTransform(1,0,0,1,0,0)};var i=function(e,t){var a=document.createElement("canvas");return a.width=e,a.height=t,a.oncontextmenu=function(){return!1},a.onselectstart=function(){return!1},a},y=function(e){var t=e.getContext("2d"),a=window.devicePixelRatio||1,o=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return a/o},f=function(e,t){var a=e.textures[t];return a?a:(a=e.textures[t]=new Image,a.src=t,a)},x=function(e,t){var a=t;/(jpg|gif|png)$/.test(t)&&(a="url("+t+")"),e.canvas.style.background=a,e.canvas.style.backgroundSize="contain",e.currentBackground=t}})()},{"../body/Composite":2,"../collision/Grid":6,"../core/Common":14,"../core/Events":16,"../core/Mouse":19,"../geometry/Bounds":26,"../geometry/Vector":28}],32:[function(e,t){var a={};t.exports=a;var o=e("../geometry/Bounds"),r=e("../body/Composite"),i=e("../core/Common"),n=e("../core/Events"),l=e("../geometry/Vector");(function(){var e,t;"undefined"!=typeof window&&(e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(function(){e(i.now())},1e3/60)},t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),a.create=function(e){i.warn("RenderPixi.create: Matter.RenderPixi is deprecated (see docs)");var t=i.extend({controller:a,engine:null,element:null,frameRequestId:null,canvas:null,renderer:null,container:null,spriteContainer:null,pixiOptions:null,options:{width:800,height:600,background:"#fafafa",wireframeBackground:"#222",hasBounds:!1,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1}},e),o=!t.options.wireframes&&"transparent"===t.options.background;return t.pixiOptions=t.pixiOptions||{view:t.canvas,transparent:o,antialias:!0,backgroundColor:e.background},t.mouse=e.mouse,t.engine=e.engine,t.renderer=t.renderer||new PIXI.WebGLRenderer(t.options.width,t.options.height,t.pixiOptions),t.container=t.container||new PIXI.Container,t.spriteContainer=t.spriteContainer||new PIXI.Container,t.canvas=t.canvas||t.renderer.view,t.bounds=t.bounds||{min:{x:0,y:0},max:{x:t.options.width,y:t.options.height}},n.on(t.engine,"beforeUpdate",function(){a.clear(t)}),t.textures={},t.sprites={},t.primitives={},t.container.addChild(t.spriteContainer),i.isElement(t.element)?t.element.appendChild(t.canvas):i.warn("No \"render.element\" passed, \"render.canvas\" was not inserted into document."),t.canvas.oncontextmenu=function(){return!1},t.canvas.onselectstart=function(){return!1},t},a.run=function(t){(function o(){t.frameRequestId=e(o),a.world(t)})()},a.stop=function(e){t(e.frameRequestId)},a.clear=function(e){for(var t=e.container,a=e.spriteContainer;t.children[0];)t.removeChild(t.children[0]);for(;a.children[0];)a.removeChild(a.children[0]);var o=e.sprites["bg-0"];e.textures={},e.sprites={},e.primitives={},e.sprites["bg-0"]=o,o&&t.addChildAt(o,0),e.container.addChild(e.spriteContainer),e.currentBackground=null,t.scale.set(1,1),t.position.set(0,0)},a.setBackground=function(e,t){if(e.currentBackground!==t){var a=t.indexOf&&-1!==t.indexOf("#"),o=e.sprites["bg-0"];if(a){var r=i.colorToNumber(t);e.renderer.backgroundColor=r,o&&e.container.removeChild(o)}else if(!o){var n=c(e,t);o=e.sprites["bg-0"]=new PIXI.Sprite(n),o.position.x=0,o.position.y=0,e.container.addChildAt(o,0)}e.currentBackground=t}},a.world=function(e){var t=e.engine,n=t.world,s=e.renderer,d=e.container,c=e.options,p=r.allBodies(n),u=r.allConstraints(n),g=[],m;c.wireframes?a.setBackground(e,c.wireframeBackground):a.setBackground(e,c.background);var h=e.bounds.max.x-e.bounds.min.x,y=e.bounds.max.y-e.bounds.min.y,f=h/e.options.width,x=y/e.options.height;if(c.hasBounds){for(m=0;m<p.length;m++){var _=p[m];_.render.sprite.visible=o.overlaps(_.bounds,e.bounds)}for(m=0;m<u.length;m++){var b=u[m],v=b.bodyA,w=b.bodyB,k=b.pointA,T=b.pointB;v&&(k=l.add(v.position,b.pointA)),w&&(T=l.add(w.position,b.pointB)),k&&T&&(o.contains(e.bounds,k)||o.contains(e.bounds,T))&&g.push(b)}d.scale.set(1/f,1/x),d.position.set(-e.bounds.min.x*(1/f),-e.bounds.min.y*(1/x))}else g=u;for(m=0;m<p.length;m++)a.body(e,p[m]);for(m=0;m<g.length;m++)a.constraint(e,g[m]);s.render(d)},a.constraint=function(e,t){var a=e.engine,o=t.bodyA,r=t.bodyB,n=t.pointA,l=t.pointB,s=e.container,d=t.render,c="c-"+t.id,p=e.primitives[c];return p||(p=e.primitives[c]=new PIXI.Graphics),d.visible&&t.pointA&&t.pointB?void(-1===i.indexOf(s.children,p)&&s.addChild(p),p.clear(),p.beginFill(0,0),p.lineStyle(d.lineWidth,i.colorToNumber(d.strokeStyle),1),o?p.moveTo(o.position.x+n.x,o.position.y+n.y):p.moveTo(n.x,n.y),r?p.lineTo(r.position.x+l.x,r.position.y+l.y):p.lineTo(l.x,l.y),p.endFill()):void p.clear()},a.body=function(e,t){var a=e.engine,o=t.render;if(o.visible)if(o.sprite&&o.sprite.texture){var r="b-"+t.id,n=e.sprites[r],l=e.spriteContainer;n||(n=e.sprites[r]=s(e,t)),-1===i.indexOf(l.children,n)&&l.addChild(n),n.position.x=t.position.x,n.position.y=t.position.y,n.rotation=t.angle,n.scale.x=o.sprite.xScale||1,n.scale.y=o.sprite.yScale||1}else{var c="b-"+t.id,p=e.primitives[c],u=e.container;p||(p=e.primitives[c]=d(e,t),p.initialAngle=t.angle),-1===i.indexOf(u.children,p)&&u.addChild(p),p.position.x=t.position.x,p.position.y=t.position.y,p.rotation=t.angle-p.initialAngle}};var s=function(e,t){var a=t.render,o=a.sprite.texture,r=c(e,o),i=new PIXI.Sprite(r);return i.anchor.x=t.render.sprite.xOffset,i.anchor.y=t.render.sprite.yOffset,i},d=function(e,t){var a=t.render,o=e.options,r=new PIXI.Graphics,n=i.colorToNumber(a.fillStyle),l=i.colorToNumber(a.strokeStyle),s=i.colorToNumber(a.strokeStyle),d=i.colorToNumber("#bbb"),c=i.colorToNumber("#CD5C5C"),p;r.clear();for(var u=1<t.parts.length?1:0;u<t.parts.length;u++){p=t.parts[u],o.wireframes?(r.beginFill(0,0),r.lineStyle(1,d,1)):(r.beginFill(n,1),r.lineStyle(a.lineWidth,l,1)),r.moveTo(p.vertices[0].x-t.position.x,p.vertices[0].y-t.position.y);for(var g=1;g<p.vertices.length;g++)r.lineTo(p.vertices[g].x-t.position.x,p.vertices[g].y-t.position.y);r.lineTo(p.vertices[0].x-t.position.x,p.vertices[0].y-t.position.y),r.endFill(),(o.showAngleIndicator||o.showAxes)&&(r.beginFill(0,0),o.wireframes?r.lineStyle(1,c,1):r.lineStyle(1,s),r.moveTo(p.position.x-t.position.x,p.position.y-t.position.y),r.lineTo((p.vertices[0].x+p.vertices[p.vertices.length-1].x)/2-t.position.x,(p.vertices[0].y+p.vertices[p.vertices.length-1].y)/2-t.position.y),r.endFill())}return r},c=function(e,t){var a=e.textures[t];return a||(a=e.textures[t]=PIXI.Texture.fromImage(t)),a}})()},{"../body/Composite":2,"../core/Common":14,"../core/Events":16,"../geometry/Bounds":26,"../geometry/Vector":28}]},{},[30])(30)})}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{}],407:[function(e,t,a){var o=Number.MAX_VALUE,r=Math.cos,n=Math.ceil,l=Math.sqrt,s=Math.PI,d=Math.sin,p=Math.min,u=Math.pow,g=Math.abs,m=Math.max,h=Math.floor;(function(i){(function(e){if("object"==typeof a&&"undefined"!=typeof t)t.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var o;o="undefined"==typeof window?"undefined"==typeof i?"undefined"==typeof self?this:self:i:window,o.Matter=e()}})(function(){return function(){function l(s,r,n){function t(d,i){if(!r[d]){if(!s[d]){var u="function"==typeof e&&e;if(!i&&u)return u(d,!0);if(o)return o(d,!0);var c=new Error("Cannot find module '"+d+"'");throw c.code="MODULE_NOT_FOUND",c}var a=r[d]={exports:{}};s[d][0].call(a.exports,function(e){var a=s[d][1][e];return t(a||e)},a,a.exports,l,s,r,n)}return r[d].exports}for(var o="function"==typeof e&&e,a=0;a<n.length;a++)t(n[a]);return t}return l}()({1:[function(e,t){var a={};t.exports=a;var o=e("../geometry/Vertices"),n=e("../geometry/Vector"),l=e("../core/Sleeping"),s=e("../render/Render"),c=e("../core/Common"),p=e("../geometry/Bounds"),m=e("../geometry/Axes");(function(){a._inertiaScale=4,a._nextCollidingGroupId=1,a._nextNonCollidingGroupId=-1,a._nextCategory=1,a.create=function(t){var a={id:c.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:o.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0},lineWidth:0}},r=c.extend(a,t);return e(r,t),r},a.nextGroup=function(e){return e?a._nextNonCollidingGroupId--:a._nextCollidingGroupId++},a.nextCategory=function(){return a._nextCategory<<=1,a._nextCategory};var e=function(e,t){t=t||{},a.set(e,{bounds:e.bounds||p.create(e.vertices),positionPrev:e.positionPrev||n.clone(e.position),anglePrev:e.anglePrev||e.angle,vertices:e.vertices,parts:e.parts||[e],isStatic:e.isStatic,isSleeping:e.isSleeping,parent:e.parent||e}),o.rotate(e.vertices,e.angle,e.position),m.rotate(e.axes,e.angle),p.update(e.bounds,e.vertices,e.velocity),a.set(e,{axes:t.axes||e.axes,area:t.area||e.area,mass:t.mass||e.mass,inertia:t.inertia||e.inertia});var r=e.isStatic?"#2e2b44":c.choose(["#006BA6","#0496FF","#FFBC42","#D81159","#8F2D56"]);e.render.fillStyle=e.render.fillStyle||r,e.render.strokeStyle=e.render.strokeStyle||"#000",e.render.sprite.xOffset+=-(e.bounds.min.x-e.position.x)/(e.bounds.max.x-e.bounds.min.x),e.render.sprite.yOffset+=-(e.bounds.min.y-e.position.y)/(e.bounds.max.y-e.bounds.min.y)};a.set=function(e,t,o){for(var r in"string"==typeof t&&(r=t,t={},t[r]=o),t)o=t[r],t.hasOwnProperty(r)&&("isStatic"===r?a.setStatic(e,o):"isSleeping"===r?l.set(e,o):"mass"===r?a.setMass(e,o):"density"===r?a.setDensity(e,o):"inertia"===r?a.setInertia(e,o):"vertices"===r?a.setVertices(e,o):"position"===r?a.setPosition(e,o):"angle"===r?a.setAngle(e,o):"velocity"===r?a.setVelocity(e,o):"angularVelocity"===r?a.setAngularVelocity(e,o):"parts"===r?a.setParts(e,o):e[r]=o)},a.setStatic=function(e,t){for(var a=0,o;a<e.parts.length;a++)o=e.parts[a],o.isStatic=t,t?(o._original={restitution:o.restitution,friction:o.friction,mass:o.mass,inertia:o.inertia,density:o.density,inverseMass:o.inverseMass,inverseInertia:o.inverseInertia},o.restitution=0,o.friction=1,o.mass=o.inertia=o.density=1/0,o.inverseMass=o.inverseInertia=0,o.positionPrev.x=o.position.x,o.positionPrev.y=o.position.y,o.anglePrev=o.angle,o.angularVelocity=0,o.speed=0,o.angularSpeed=0,o.motion=0):o._original&&(o.restitution=o._original.restitution,o.friction=o._original.friction,o.mass=o._original.mass,o.inertia=o._original.inertia,o.density=o._original.density,o.inverseMass=o._original.inverseMass,o.inverseInertia=o._original.inverseInertia,delete o._original)},a.setMass=function(e,t){var a=e.inertia/(e.mass/6);e.inertia=a*(t/6),e.inverseInertia=1/e.inertia,e.mass=t,e.inverseMass=1/e.mass,e.density=e.mass/e.area},a.setDensity=function(e,t){a.setMass(e,t*e.area),e.density=t},a.setInertia=function(e,t){e.inertia=t,e.inverseInertia=1/e.inertia},a.setVertices=function(e,t){e.vertices=t[0].body===e?t:o.create(t,e),e.axes=m.fromVertices(e.vertices),e.area=o.area(e.vertices),a.setMass(e,e.density*e.area);var r=o.centre(e.vertices);o.translate(e.vertices,r,-1),a.setInertia(e,a._inertiaScale*o.inertia(e.vertices,e.mass)),o.translate(e.vertices,e.position),p.update(e.bounds,e.vertices,e.velocity)},a.setParts=function(e,t,r){var n;for(t=t.slice(0),e.parts.length=0,e.parts.push(e),e.parent=e,n=0;n<t.length;n++){var l=t[n];l!==e&&(l.parent=e,e.parts.push(l))}if(1!==e.parts.length){if(r="undefined"==typeof r||r,r){var s=[];for(n=0;n<t.length;n++)s=s.concat(t[n].vertices);o.clockwiseSort(s);var d=o.hull(s),c=o.centre(d);a.setVertices(e,d),o.translate(e.vertices,c)}var p=a._totalProperties(e);e.area=p.area,e.parent=e,e.position.x=p.centre.x,e.position.y=p.centre.y,e.positionPrev.x=p.centre.x,e.positionPrev.y=p.centre.y,a.setMass(e,p.mass),a.setInertia(e,p.inertia),a.setPosition(e,p.centre)}},a.setPosition=function(e,t){var a=n.sub(t,e.position);e.positionPrev.x+=a.x,e.positionPrev.y+=a.y;for(var r=0,l;r<e.parts.length;r++)l=e.parts[r],l.position.x+=a.x,l.position.y+=a.y,o.translate(l.vertices,a),p.update(l.bounds,l.vertices,e.velocity)},a.setAngle=function(e,t){var a=t-e.angle;e.anglePrev+=a;for(var r=0,l;r<e.parts.length;r++)l=e.parts[r],l.angle+=a,o.rotate(l.vertices,a,e.position),m.rotate(l.axes,a),p.update(l.bounds,l.vertices,e.velocity),0<r&&n.rotateAbout(l.position,a,e.position,l.position)},a.setVelocity=function(e,t){e.positionPrev.x=e.position.x-t.x,e.positionPrev.y=e.position.y-t.y,e.velocity.x=t.x,e.velocity.y=t.y,e.speed=n.magnitude(e.velocity)},a.setAngularVelocity=function(e,t){e.anglePrev=e.angle-t,e.angularVelocity=t,e.angularSpeed=g(e.angularVelocity)},a.translate=function(e,t){a.setPosition(e,n.add(e.position,t))},a.rotate=function(e,t,o){if(!o)a.setAngle(e,e.angle+t);else{var i=r(t),n=d(t),l=e.position.x-o.x,s=e.position.y-o.y;a.setPosition(e,{x:o.x+(l*i-s*n),y:o.y+(l*n+s*i)}),a.setAngle(e,e.angle+t)}},a.scale=function(e,t,r,n){var l=0,s=0;n=n||e.position;for(var d=0,c;d<e.parts.length;d++)c=e.parts[d],o.scale(c.vertices,t,r,n),c.axes=m.fromVertices(c.vertices),c.area=o.area(c.vertices),a.setMass(c,e.density*c.area),o.translate(c.vertices,{x:-c.position.x,y:-c.position.y}),a.setInertia(c,a._inertiaScale*o.inertia(c.vertices,c.mass)),o.translate(c.vertices,{x:c.position.x,y:c.position.y}),0<d&&(l+=c.area,s+=c.inertia),c.position.x=n.x+(c.position.x-n.x)*t,c.position.y=n.y+(c.position.y-n.y)*r,p.update(c.bounds,c.vertices,e.velocity);1<e.parts.length&&(e.area=l,!e.isStatic&&(a.setMass(e,e.density*l),a.setInertia(e,s))),e.circleRadius&&(t===r?e.circleRadius*=t:e.circleRadius=null)},a.update=function(e,t,a,r){var l=u(t*a*e.timeScale,2),s=1-e.frictionAir*a*e.timeScale,d=e.position.x-e.positionPrev.x,c=e.position.y-e.positionPrev.y;e.velocity.x=d*s*r+e.force.x/e.mass*l,e.velocity.y=c*s*r+e.force.y/e.mass*l,e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y,e.position.x+=e.velocity.x,e.position.y+=e.velocity.y,e.angularVelocity=(e.angle-e.anglePrev)*s*r+e.torque/e.inertia*l,e.anglePrev=e.angle,e.angle+=e.angularVelocity,e.speed=n.magnitude(e.velocity),e.angularSpeed=g(e.angularVelocity);for(var h=0,y;h<e.parts.length;h++)y=e.parts[h],o.translate(y.vertices,e.velocity),0<h&&(y.position.x+=e.velocity.x,y.position.y+=e.velocity.y),0!==e.angularVelocity&&(o.rotate(y.vertices,e.angularVelocity,e.position),m.rotate(y.axes,e.angularVelocity),0<h&&n.rotateAbout(y.position,e.angularVelocity,e.position,y.position)),p.update(y.bounds,y.vertices,e.velocity)},a.applyForce=function(e,t,a){e.force.x+=a.x,e.force.y+=a.y;var o={x:t.x-e.position.x,y:t.y-e.position.y};e.torque+=o.x*a.y-o.y*a.x},a._totalProperties=function(e){for(var t={mass:0,area:0,inertia:0,centre:{x:0,y:0}},a=1===e.parts.length?0:1;a<e.parts.length;a++){var o=e.parts[a],r=o.mass===1/0?1:o.mass;t.mass+=r,t.area+=o.area,t.inertia+=o.inertia,t.centre=n.add(t.centre,n.mult(o.position,r))}return t.centre=n.div(t.centre,t.mass),t}})()},{"../core/Common":14,"../core/Sleeping":22,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29,"../render/Render":31}],2:[function(e,t){var a={};t.exports=a;var o=e("../core/Events"),n=e("../core/Common"),l=e("../geometry/Bounds"),s=e("./Body");(function(){a.create=function(e){return n.extend({id:n.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{}},e)},a.setModified=function(e,t,o,r){if(e.isModified=t,o&&e.parent&&a.setModified(e.parent,t,o,r),r)for(var n=0,l;n<e.composites.length;n++)l=e.composites[n],a.setModified(l,t,o,r)},a.add=function(e,t){var r=[].concat(t);o.trigger(e,"beforeAdd",{object:t});for(var l=0,s;l<r.length;l++)switch(s=r[l],s.type){case"body":if(s.parent!==s){n.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}a.addBody(e,s);break;case"constraint":a.addConstraint(e,s);break;case"composite":a.addComposite(e,s);break;case"mouseConstraint":a.addConstraint(e,s.constraint);}return o.trigger(e,"afterAdd",{object:t}),e},a.remove=function(e,t,r){var n=[].concat(t);o.trigger(e,"beforeRemove",{object:t});for(var l=0,s;l<n.length;l++)switch(s=n[l],s.type){case"body":a.removeBody(e,s,r);break;case"constraint":a.removeConstraint(e,s,r);break;case"composite":a.removeComposite(e,s,r);break;case"mouseConstraint":a.removeConstraint(e,s.constraint);}return o.trigger(e,"afterRemove",{object:t}),e},a.addComposite=function(e,t){return e.composites.push(t),t.parent=e,a.setModified(e,!0,!0,!1),e},a.removeComposite=function(e,t,o){var r=n.indexOf(e.composites,t);if(-1!==r&&(a.removeCompositeAt(e,r),a.setModified(e,!0,!0,!1)),o)for(var l=0;l<e.composites.length;l++)a.removeComposite(e.composites[l],t,!0);return e},a.removeCompositeAt=function(e,t){return e.composites.splice(t,1),a.setModified(e,!0,!0,!1),e},a.addBody=function(e,t){return e.bodies.push(t),a.setModified(e,!0,!0,!1),e},a.removeBody=function(e,t,o){var r=n.indexOf(e.bodies,t);if(-1!==r&&(a.removeBodyAt(e,r),a.setModified(e,!0,!0,!1)),o)for(var l=0;l<e.composites.length;l++)a.removeBody(e.composites[l],t,!0);return e},a.removeBodyAt=function(e,t){return e.bodies.splice(t,1),a.setModified(e,!0,!0,!1),e},a.addConstraint=function(e,t){return e.constraints.push(t),a.setModified(e,!0,!0,!1),e},a.removeConstraint=function(e,t,o){var r=n.indexOf(e.constraints,t);if(-1!==r&&a.removeConstraintAt(e,r),o)for(var l=0;l<e.composites.length;l++)a.removeConstraint(e.composites[l],t,!0);return e},a.removeConstraintAt=function(e,t){return e.constraints.splice(t,1),a.setModified(e,!0,!0,!1),e},a.clear=function(e,t,o){if(o)for(var r=0;r<e.composites.length;r++)a.clear(e.composites[r],t,!0);return t?e.bodies=e.bodies.filter(function(e){return e.isStatic}):e.bodies.length=0,e.constraints.length=0,e.composites.length=0,a.setModified(e,!0,!0,!1),e},a.allBodies=function(e){for(var t=[].concat(e.bodies),o=0;o<e.composites.length;o++)t=t.concat(a.allBodies(e.composites[o]));return t},a.allConstraints=function(e){for(var t=[].concat(e.constraints),o=0;o<e.composites.length;o++)t=t.concat(a.allConstraints(e.composites[o]));return t},a.allComposites=function(e){for(var t=[].concat(e.composites),o=0;o<e.composites.length;o++)t=t.concat(a.allComposites(e.composites[o]));return t},a.get=function(e,t,o){var r,i;return("body"===o?r=a.allBodies(e):"constraint"===o?r=a.allConstraints(e):"composite"===o?r=a.allComposites(e).concat(e):void 0,!r)?null:(i=r.filter(function(e){return e.id.toString()===t.toString()}),0===i.length?null:i[0])},a.move=function(e,t,o){return a.remove(e,t),a.add(o,t),e},a.rebase=function(e){for(var t=a.allBodies(e).concat(a.allConstraints(e)).concat(a.allComposites(e)),o=0;o<t.length;o++)t[o].id=n.nextId();return a.setModified(e,!0,!0,!1),e},a.translate=function(e,t,o){for(var r=o?a.allBodies(e):e.bodies,n=0;n<r.length;n++)s.translate(r[n],t);return a.setModified(e,!0,!0,!1),e},a.rotate=function(e,t,o,n){for(var l=r(t),c=d(t),p=n?a.allBodies(e):e.bodies,u=0;u<p.length;u++){var g=p[u],m=g.position.x-o.x,h=g.position.y-o.y;s.setPosition(g,{x:o.x+(m*l-h*c),y:o.y+(m*c+h*l)}),s.rotate(g,t)}return a.setModified(e,!0,!0,!1),e},a.scale=function(e,t,o,r,n){for(var l=n?a.allBodies(e):e.bodies,d=0;d<l.length;d++){var c=l[d],p=c.position.x-r.x,u=c.position.y-r.y;s.setPosition(c,{x:r.x+p*t,y:r.y+u*o}),s.scale(c,t,o)}return a.setModified(e,!0,!0,!1),e},a.bounds=function(e){for(var t=a.allBodies(e),o=[],r=0,n;r<t.length;r+=1)n=t[r],o.push(n.bounds.min,n.bounds.max);return l.create(o)}})()},{"../core/Common":14,"../core/Events":16,"../geometry/Bounds":26,"./Body":1}],3:[function(e,t){var a={};t.exports=a;var o=e("./Composite"),r=e("../constraint/Constraint"),i=e("../core/Common");(function(){a.create=function(e){var t=o.create(),a={label:"World",gravity:{x:0,y:1,scale:.001},bounds:{min:{x:-Infinity,y:-Infinity},max:{x:1/0,y:1/0}}};return i.extend(t,a,e)}})()},{"../constraint/Constraint":12,"../core/Common":14,"./Composite":2}],4:[function(e,t){var a={};t.exports=a,function(){a.create=function(e){return{id:a.id(e),vertex:e,normalImpulse:0,tangentImpulse:0}},a.id=function(e){return e.body.id+"_"+e.index}}()},{}],5:[function(e,t){var a={};t.exports=a;var o=e("./SAT"),r=e("./Pair"),n=e("../geometry/Bounds");(function(){a.collisions=function(e,t){for(var l=[],s=t.pairs.table,d=0;d<e.length;d++){var c=e[d][0],p=e[d][1];if(!((c.isStatic||c.isSleeping)&&(p.isStatic||p.isSleeping))&&a.canCollide(c.collisionFilter,p.collisionFilter)&&n.overlaps(c.bounds,p.bounds))for(var u=1<c.parts.length?1:0,g;u<c.parts.length;u++){g=c.parts[u];for(var m=1<p.parts.length?1:0,h;m<p.parts.length;m++)if(h=p.parts[m],g===c&&h===p||n.overlaps(g.bounds,h.bounds)){var y=r.id(g,h),f=s[y],x;x=f&&f.isActive?f.collision:null;var _=o.collides(g,h,x);_.collided&&l.push(_)}}}return l},a.canCollide=function(e,t){return e.group===t.group&&0!==e.group?0<e.group:0!=(e.mask&t.category)&&0!=(t.mask&e.category)}})()},{"../geometry/Bounds":26,"./Pair":7,"./SAT":11}],6:[function(e,t){var a={};t.exports=a;var o=e("./Pair"),r=e("./Detector"),n=e("../core/Common");(function(){a.create=function(e){var t={controller:a,detector:r.collisions,buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48};return n.extend(t,e)},a.update=function(e,t,o,r){var n=o.world,l=e.buckets,s=!1,d,c,p,u,g;for(d=0;d<t.length;d++){var m=t[d];if((!m.isSleeping||r)&&!(m.bounds.max.x<n.bounds.min.x||m.bounds.min.x>n.bounds.max.x||m.bounds.max.y<n.bounds.min.y||m.bounds.min.y>n.bounds.max.y)){var h=a._getRegion(e,m);if(!m.region||h.id!==m.region.id||r){(!m.region||r)&&(m.region=h);var y=a._regionUnion(h,m.region);for(c=y.startCol;c<=y.endCol;c++)for(p=y.startRow;p<=y.endRow;p++){g=a._getBucketId(c,p),u=l[g];var f=c>=h.startCol&&c<=h.endCol&&p>=h.startRow&&p<=h.endRow,x=c>=m.region.startCol&&c<=m.region.endCol&&p>=m.region.startRow&&p<=m.region.endRow;!f&&x&&x&&u&&a._bucketRemoveBody(e,u,m),(m.region===h||f&&!x||r)&&(!u&&(u=a._createBucket(l,g)),a._bucketAddBody(e,u,m))}m.region=h,s=!0}}}s&&(e.pairsList=a._createActivePairsList(e))},a.clear=function(e){e.buckets={},e.pairs={},e.pairsList=[]},a._regionUnion=function(e,t){var o=p(e.startCol,t.startCol),r=m(e.endCol,t.endCol),i=p(e.startRow,t.startRow),n=m(e.endRow,t.endRow);return a._createRegion(o,r,i,n)},a._getRegion=function(e,t){var o=t.bounds,r=h(o.min.x/e.bucketWidth),i=h(o.max.x/e.bucketWidth),n=h(o.min.y/e.bucketHeight),l=h(o.max.y/e.bucketHeight);return a._createRegion(r,i,n,l)},a._createRegion=function(e,t,a,o){return{id:e+","+t+","+a+","+o,startCol:e,endCol:t,startRow:a,endRow:o}},a._getBucketId=function(e,t){return"C"+e+"R"+t},a._createBucket=function(e,t){var a=e[t]=[];return a},a._bucketAddBody=function(e,t,a){for(var r=0,n;r<t.length;r++)if(n=t[r],!(a.id===n.id||a.isStatic&&n.isStatic)){var l=o.id(a,n),s=e.pairs[l];s?s[2]+=1:e.pairs[l]=[a,n,1]}t.push(a)},a._bucketRemoveBody=function(e,t,a){t.splice(n.indexOf(t,a),1);for(var r=0;r<t.length;r++){var l=t[r],s=o.id(a,l),d=e.pairs[s];d&&(d[2]-=1)}},a._createActivePairsList=function(e){var t=[],a,o;a=n.keys(e.pairs);for(var r=0;r<a.length;r++)o=e.pairs[a[r]],0<o[2]?t.push(o):delete e.pairs[a[r]];return t}})()},{"../core/Common":14,"./Detector":5,"./Pair":7}],7:[function(e,t){var a={};t.exports=a;var o=e("./Contact");(function(){a.create=function(e,t){var o=e.bodyA,r=e.bodyB,i=e.parentA,n=e.parentB,l={id:a.id(o,r),bodyA:o,bodyB:r,contacts:{},activeContacts:[],separation:0,isActive:!0,isSensor:o.isSensor||r.isSensor,timeCreated:t,timeUpdated:t,inverseMass:i.inverseMass+n.inverseMass,friction:p(i.friction,n.friction),frictionStatic:m(i.frictionStatic,n.frictionStatic),restitution:m(i.restitution,n.restitution),slop:m(i.slop,n.slop)};return a.update(l,e,t),l},a.update=function(e,t,r){var n=e.contacts,l=t.supports,s=e.activeContacts,d=t.parentA,c=t.parentB;if(e.collision=t,e.inverseMass=d.inverseMass+c.inverseMass,e.friction=p(d.friction,c.friction),e.frictionStatic=m(d.frictionStatic,c.frictionStatic),e.restitution=m(d.restitution,c.restitution),e.slop=m(d.slop,c.slop),s.length=0,t.collided){for(var u=0;u<l.length;u++){var g=l[u],h=o.id(g),y=n[h];y?s.push(y):s.push(n[h]=o.create(g))}e.separation=t.depth,a.setActive(e,!0,r)}else!0===e.isActive&&a.setActive(e,!1,r)},a.setActive=function(e,t,a){t?(e.isActive=!0,e.timeUpdated=a):(e.isActive=!1,e.activeContacts.length=0)},a.id=function(e,t){return e.id<t.id?"A"+e.id+"B"+t.id:"A"+t.id+"B"+e.id}})()},{"./Contact":4}],8:[function(e,t){var a={};t.exports=a;var o=e("./Pair"),r=e("../core/Common");(function(){a._pairMaxIdleLife=1e3,a.create=function(e){return r.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},e)},a.update=function(e,t,a){var n=e.list,l=e.table,s=e.collisionStart,d=e.collisionEnd,c=e.collisionActive,p=[],u,g,m,h;for(s.length=0,d.length=0,c.length=0,h=0;h<t.length;h++)u=t[h],u.collided&&(g=o.id(u.bodyA,u.bodyB),p.push(g),m=l[g],m?(m.isActive?c.push(m):s.push(m),o.update(m,u,a)):(m=o.create(u,a),l[g]=m,s.push(m),n.push(m)));for(h=0;h<n.length;h++)m=n[h],m.isActive&&-1===r.indexOf(p,m.id)&&(o.setActive(m,!1,a),d.push(m))},a.removeOld=function(e,t){var o=e.list,r=e.table,n=[],l,s,d,c;for(c=0;c<o.length;c++){if(l=o[c],s=l.collision,s.bodyA.isSleeping||s.bodyB.isSleeping){l.timeUpdated=t;continue}t-l.timeUpdated>a._pairMaxIdleLife&&n.push(c)}for(c=0;c<n.length;c++)d=n[c]-c,l=o[d],delete r[l.id],o.splice(d,1)},a.clear=function(e){return e.table={},e.list.length=0,e.collisionStart.length=0,e.collisionActive.length=0,e.collisionEnd.length=0,e}})()},{"../core/Common":14,"./Pair":7}],9:[function(e,t){var a={};t.exports=a;var o=e("../geometry/Vector"),r=e("./SAT"),n=e("../geometry/Bounds"),l=e("../factory/Bodies"),s=e("../geometry/Vertices");(function(){a.collides=function(e,t){for(var a=[],o=0,l;o<t.length;o++)if(l=t[o],n.overlaps(l.bounds,e.bounds))for(var s=1===l.parts.length?0:1,d;s<l.parts.length;s++)if(d=l.parts[s],n.overlaps(d.bounds,e.bounds)){var c=r.collides(d,e);if(c.collided){a.push(c);break}}return a},a.ray=function(e,t,r,n){n=n||1e-100;for(var s=o.angle(t,r),d=o.magnitude(o.sub(t,r)),c=.5*(r.x+t.x),p=.5*(r.y+t.y),u=l.rectangle(c,p,d,n,{angle:s}),g=a.collides(u,e),m=0,h;m<g.length;m+=1)h=g[m],h.body=h.bodyB=h.bodyA;return g},a.region=function(e,t,a){for(var o=[],r=0;r<e.length;r++){var l=e[r],s=n.overlaps(l.bounds,t);(s&&!a||!s&&a)&&o.push(l)}return o},a.point=function(e,t){for(var a=[],o=0,r;o<e.length;o++)if(r=e[o],n.contains(r.bounds,t))for(var l=1===r.parts.length?0:1,d;l<r.parts.length;l++)if(d=r.parts[l],n.contains(d.bounds,t)&&s.contains(d.vertices,t)){a.push(r);break}return a}})()},{"../factory/Bodies":23,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29,"./SAT":11}],10:[function(e,t){var a={};t.exports=a;var o=e("../geometry/Vertices"),r=e("../geometry/Vector"),i=e("../core/Common"),n=e("../geometry/Bounds");(function(){a._restingThresh=4,a._restingThreshTangent=6,a._positionDampen=.9,a._positionWarming=.8,a._frictionNormalMultiplier=5,a.preSolvePosition=function(e){var t,a,o;for(t=0;t<e.length;t++)a=e[t],a.isActive&&(o=a.activeContacts.length,a.collision.parentA.totalContacts+=o,a.collision.parentB.totalContacts+=o)},a.solvePosition=function(e,t){var o=r._temp[0],n=r._temp[1],l=r._temp[2],s=r._temp[3],d,c,p,u,g,m,h,y,f;for(d=0;d<e.length;d++)c=e[d],!c.isActive||c.isSensor||(p=c.collision,u=p.parentA,g=p.parentB,m=p.normal,h=r.sub(r.add(g.positionImpulse,g.position,o),r.add(u.positionImpulse,r.sub(g.position,p.penetration,n),l),s),c.separation=r.dot(m,h));for(d=0;d<e.length;d++)c=e[d],!c.isActive||c.isSensor||(p=c.collision,u=p.parentA,g=p.parentB,m=p.normal,f=(c.separation-c.slop)*t,(u.isStatic||g.isStatic)&&(f*=2),!(u.isStatic||u.isSleeping)&&(y=a._positionDampen/u.totalContacts,u.positionImpulse.x+=m.x*f*y,u.positionImpulse.y+=m.y*f*y),!(g.isStatic||g.isSleeping)&&(y=a._positionDampen/g.totalContacts,g.positionImpulse.x-=m.x*f*y,g.positionImpulse.y-=m.y*f*y))},a.postSolvePosition=function(e){for(var t=0,l;t<e.length;t++)if(l=e[t],l.totalContacts=0,0!==l.positionImpulse.x||0!==l.positionImpulse.y){for(var s=0,d;s<l.parts.length;s++)d=l.parts[s],o.translate(d.vertices,l.positionImpulse),n.update(d.bounds,d.vertices,l.velocity),d.position.x+=l.positionImpulse.x,d.position.y+=l.positionImpulse.y;l.positionPrev.x+=l.positionImpulse.x,l.positionPrev.y+=l.positionImpulse.y,0>r.dot(l.positionImpulse,l.velocity)?(l.positionImpulse.x=0,l.positionImpulse.y=0):(l.positionImpulse.x*=a._positionWarming,l.positionImpulse.y*=a._positionWarming)}},a.preSolveVelocity=function(e){var t=r._temp[0],a=r._temp[1],o,n,l,s,d,c,p,u,g,m,h,y,f,x;for(o=0;o<e.length;o++)if(l=e[o],l.isActive&&!l.isSensor)for(s=l.activeContacts,d=l.collision,c=d.parentA,p=d.parentB,u=d.normal,g=d.tangent,n=0;n<s.length;n++)m=s[n],h=m.vertex,y=m.normalImpulse,f=m.tangentImpulse,(0!==y||0!==f)&&(t.x=u.x*y+g.x*f,t.y=u.y*y+g.y*f,!(c.isStatic||c.isSleeping)&&(x=r.sub(h,c.position,a),c.positionPrev.x+=t.x*c.inverseMass,c.positionPrev.y+=t.y*c.inverseMass,c.anglePrev+=r.cross(x,t)*c.inverseInertia),!(p.isStatic||p.isSleeping)&&(x=r.sub(h,p.position,a),p.positionPrev.x-=t.x*p.inverseMass,p.positionPrev.y-=t.y*p.inverseMass,p.anglePrev-=r.cross(x,t)*p.inverseInertia))},a.solveVelocity=function(e,t){for(var o=t*t,n=r._temp[0],l=r._temp[1],s=r._temp[2],d=r._temp[3],c=r._temp[4],u=r._temp[5],m=0,h;m<e.length;m++)if(h=e[m],h.isActive&&!h.isSensor){var y=h.collision,f=y.parentA,x=y.parentB,_=y.normal,b=y.tangent,v=h.activeContacts,w=1/v.length;f.velocity.x=f.position.x-f.positionPrev.x,f.velocity.y=f.position.y-f.positionPrev.y,x.velocity.x=x.position.x-x.positionPrev.x,x.velocity.y=x.position.y-x.positionPrev.y,f.angularVelocity=f.angle-f.anglePrev,x.angularVelocity=x.angle-x.anglePrev;for(var k=0;k<v.length;k++){var T=v[k],A=T.vertex,S=r.sub(A,f.position,l),C=r.sub(A,x.position,s),L=r.add(f.velocity,r.mult(r.perp(S),f.angularVelocity),d),E=r.add(x.velocity,r.mult(r.perp(C),x.angularVelocity),c),I=r.sub(L,E,u),P=r.dot(_,I),z=r.dot(b,I),D=g(z),O=i.sign(z),R=(1+h.restitution)*P,M=i.clamp(h.separation+P,0,1)*a._frictionNormalMultiplier,B=z,F=1/0;D>h.friction*h.frictionStatic*M*o&&(F=D,B=i.clamp(h.friction*O*o,-F,F));var N=r.cross(S,_),V=r.cross(C,_),U=w/(f.inverseMass+x.inverseMass+f.inverseInertia*N*N+x.inverseInertia*V*V);if(R*=U,B*=U,0>P&&P*P>a._restingThresh*o)T.normalImpulse=0;else{var H=T.normalImpulse;T.normalImpulse=p(T.normalImpulse+R,0),R=T.normalImpulse-H}if(z*z>a._restingThreshTangent*o)T.tangentImpulse=0;else{var q=T.tangentImpulse;T.tangentImpulse=i.clamp(T.tangentImpulse+B,-F,F),B=T.tangentImpulse-q}n.x=_.x*R+b.x*B,n.y=_.y*R+b.y*B,f.isStatic||f.isSleeping||(f.positionPrev.x+=n.x*f.inverseMass,f.positionPrev.y+=n.y*f.inverseMass,f.anglePrev+=r.cross(S,n)*f.inverseInertia),x.isStatic||x.isSleeping||(x.positionPrev.x-=n.x*x.inverseMass,x.positionPrev.y-=n.y*x.inverseMass,x.anglePrev-=r.cross(C,n)*x.inverseInertia)}}}})()},{"../core/Common":14,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],11:[function(e,t){var a={};t.exports=a;var r=e("../geometry/Vertices"),n=e("../geometry/Vector");(function(){a.collides=function(e,t,o){var i=!1,l,s,d,c;if(o){var p=e.parent,u=t.parent,g=p.speed*p.speed+p.angularSpeed*p.angularSpeed+u.speed*u.speed+u.angularSpeed*u.angularSpeed;i=o&&o.collided&&.2>g,c=o}else c={collided:!1,bodyA:e,bodyB:t};if(o&&i){var m=c.axisBody,h=m===e?t:e,y=[m.axes[o.axisNumber]];if(d=a._overlapAxes(m.vertices,h.vertices,y),c.reused=!0,0>=d.overlap)return c.collided=!1,c}else{if(l=a._overlapAxes(e.vertices,t.vertices,e.axes),0>=l.overlap)return c.collided=!1,c;if(s=a._overlapAxes(t.vertices,e.vertices,t.axes),0>=s.overlap)return c.collided=!1,c;l.overlap<s.overlap?(d=l,c.axisBody=e):(d=s,c.axisBody=t),c.axisNumber=d.axisNumber}c.bodyA=e.id<t.id?e:t,c.bodyB=e.id<t.id?t:e,c.collided=!0,c.depth=d.overlap,c.parentA=c.bodyA.parent,c.parentB=c.bodyB.parent,e=c.bodyA,t=c.bodyB,c.normal=0>n.dot(d.axis,n.sub(t.position,e.position))?{x:d.axis.x,y:d.axis.y}:{x:-d.axis.x,y:-d.axis.y},c.tangent=n.perp(c.normal),c.penetration=c.penetration||{},c.penetration.x=c.normal.x*c.depth,c.penetration.y=c.normal.y*c.depth;var f=a._findSupports(e,t,c.normal),x=[];if(r.contains(e.vertices,f[0])&&x.push(f[0]),r.contains(e.vertices,f[1])&&x.push(f[1]),2>x.length){var _=a._findSupports(t,e,n.neg(c.normal));r.contains(t.vertices,_[0])&&x.push(_[0]),2>x.length&&r.contains(t.vertices,_[1])&&x.push(_[1])}return 1>x.length&&(x=[f[0]]),c.supports=x,c},a._overlapAxes=function(e,t,r){for(var l=n._temp[0],s=n._temp[1],d={overlap:o},c=0,u,g;c<r.length;c++){if(g=r[c],a._projectToAxis(l,e,g),a._projectToAxis(s,t,g),u=p(l.max-s.min,s.max-l.min),0>=u)return d.overlap=u,d;u<d.overlap&&(d.overlap=u,d.axis=g,d.axisNumber=c)}return d},a._projectToAxis=function(e,t,a){for(var o=n.dot(t[0],a),r=o,l=1,s;l<t.length;l+=1)s=n.dot(t[l],a),s>r?r=s:s<o&&(o=s);e.min=o,e.max=r},a._findSupports=function(e,t,a){for(var r=o,l=n._temp[0],s=t.vertices,d=e.position,c=0,p,u,g,m;c<s.length;c++)u=s[c],l.x=u.x-d.x,l.y=u.y-d.y,p=-n.dot(a,l),p<r&&(r=p,g=u);var h=0<=g.index-1?g.index-1:s.length-1;u=s[h],l.x=u.x-d.x,l.y=u.y-d.y,r=-n.dot(a,l),m=u;var y=(g.index+1)%s.length;return u=s[y],l.x=u.x-d.x,l.y=u.y-d.y,p=-n.dot(a,l),p<r&&(m=u),[g,m]}})()},{"../geometry/Vector":28,"../geometry/Vertices":29}],12:[function(e,t){var a={};t.exports=a;var o=e("../geometry/Vertices"),r=e("../geometry/Vector"),i=e("../core/Sleeping"),n=e("../geometry/Bounds"),l=e("../geometry/Axes"),s=e("../core/Common");(function(){a._warming=.4,a._torqueDampen=1,a._minLength=1e-6,a.create=function(e){var t=e;t.bodyA&&!t.pointA&&(t.pointA={x:0,y:0}),t.bodyB&&!t.pointB&&(t.pointB={x:0,y:0});var a=t.bodyA?r.add(t.bodyA.position,t.pointA):t.pointA,o=t.bodyB?r.add(t.bodyB.position,t.pointB):t.pointB,i=r.magnitude(r.sub(a,o));t.length="undefined"==typeof t.length?i:t.length,t.id=t.id||s.nextId(),t.label=t.label||"Constraint",t.type="constraint",t.stiffness=t.stiffness||(0<t.length?1:.7),t.damping=t.damping||0,t.angularStiffness=t.angularStiffness||0,t.angleA=t.bodyA?t.bodyA.angle:t.angleA,t.angleB=t.bodyB?t.bodyB.angle:t.angleB,t.plugin={};var n={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return 0===t.length&&.1<t.stiffness?(n.type="pin",n.anchors=!1):.9>t.stiffness&&(n.type="spring"),t.render=s.extend(n,t.render),t},a.preSolveAll=function(e){for(var t=0;t<e.length;t+=1){var a=e[t],o=a.constraintImpulse;a.isStatic||0===o.x&&0===o.y&&0===o.angle||(a.position.x+=o.x,a.position.y+=o.y,a.angle+=o.angle)}},a.solveAll=function(e,t){for(var o=0;o<e.length;o+=1){var r=e[o],n=!r.bodyA||r.bodyA&&r.bodyA.isStatic,l=!r.bodyB||r.bodyB&&r.bodyB.isStatic;(n||l)&&a.solve(e[o],t)}for(o=0;o<e.length;o+=1)r=e[o],n=!r.bodyA||r.bodyA&&r.bodyA.isStatic,l=!r.bodyB||r.bodyB&&r.bodyB.isStatic,n||l||a.solve(e[o],t)},a.solve=function(e,t){var o=e.bodyA,i=e.bodyB,n=e.pointA,l=e.pointB;if(o||i){o&&!o.isStatic&&(r.rotate(n,o.angle-e.angleA,n),e.angleA=o.angle),i&&!i.isStatic&&(r.rotate(l,i.angle-e.angleB,l),e.angleB=i.angle);var s=n,d=l;if(o&&(s=r.add(o.position,n)),i&&(d=r.add(i.position,l)),s&&d){var c=r.sub(s,d),p=r.magnitude(c);p<a._minLength&&(p=a._minLength);var u=(p-e.length)/p,g=1>e.stiffness?e.stiffness*t:e.stiffness,m=r.mult(c,u*g),h=(o?o.inverseMass:0)+(i?i.inverseMass:0),y=(o?o.inverseInertia:0)+(i?i.inverseInertia:0),f=h+y,x,_,b,v,w;if(e.damping){var k=r.create();b=r.div(c,p),w=r.sub(i&&r.sub(i.position,i.positionPrev)||k,o&&r.sub(o.position,o.positionPrev)||k),v=r.dot(b,w)}o&&!o.isStatic&&(_=o.inverseMass/h,o.constraintImpulse.x-=m.x*_,o.constraintImpulse.y-=m.y*_,o.position.x-=m.x*_,o.position.y-=m.y*_,e.damping&&(o.positionPrev.x-=e.damping*b.x*v*_,o.positionPrev.y-=e.damping*b.y*v*_),x=r.cross(n,m)/f*a._torqueDampen*o.inverseInertia*(1-e.angularStiffness),o.constraintImpulse.angle-=x,o.angle-=x),i&&!i.isStatic&&(_=i.inverseMass/h,i.constraintImpulse.x+=m.x*_,i.constraintImpulse.y+=m.y*_,i.position.x+=m.x*_,i.position.y+=m.y*_,e.damping&&(i.positionPrev.x+=e.damping*b.x*v*_,i.positionPrev.y+=e.damping*b.y*v*_),x=r.cross(l,m)/f*a._torqueDampen*i.inverseInertia*(1-e.angularStiffness),i.constraintImpulse.angle+=x,i.angle+=x)}}},a.postSolveAll=function(e){for(var t=0;t<e.length;t++){var s=e[t],d=s.constraintImpulse;if(!(s.isStatic||0===d.x&&0===d.y&&0===d.angle)){i.set(s,!1);for(var c=0,p;c<s.parts.length;c++)p=s.parts[c],o.translate(p.vertices,d),0<c&&(p.position.x+=d.x,p.position.y+=d.y),0!==d.angle&&(o.rotate(p.vertices,d.angle,s.position),l.rotate(p.axes,d.angle),0<c&&r.rotateAbout(p.position,d.angle,s.position,p.position)),n.update(p.bounds,p.vertices,s.velocity);d.angle*=a._warming,d.x*=a._warming,d.y*=a._warming}}}})()},{"../core/Common":14,"../core/Sleeping":22,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],13:[function(e,t){var a={};t.exports=a;var o=e("../geometry/Vertices"),r=e("../core/Sleeping"),i=e("../core/Mouse"),n=e("../core/Events"),l=e("../collision/Detector"),s=e("./Constraint"),d=e("../body/Composite"),c=e("../core/Common"),p=e("../geometry/Bounds");(function(){a.create=function(e,t){var o=(e?e.mouse:null)||(t?t.mouse:null);o||(e&&e.render&&e.render.canvas?o=i.create(e.render.canvas):t&&t.element?o=i.create(t.element):(o=i.create(),c.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var r=s.create({label:"Mouse Constraint",pointA:o.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),l={type:"mouseConstraint",mouse:o,element:null,body:null,constraint:r,collisionFilter:{category:1,mask:4294967295,group:0}},p=c.extend(l,t);return n.on(e,"beforeUpdate",function(){var t=d.allBodies(e.world);a.update(p,t),a._triggerEvents(p)}),p},a.update=function(e,t){var a=e.mouse,s=e.constraint,d=e.body;if(!(0===a.button))s.bodyB=e.body=null,s.pointB=null,d&&n.trigger(e,"enddrag",{mouse:a,body:d});else if(!s.bodyB){for(var c=0;c<t.length;c++)if(d=t[c],p.contains(d.bounds,a.position)&&l.canCollide(d.collisionFilter,e.collisionFilter))for(var u=1<d.parts.length?1:0,g;u<d.parts.length;u++)if(g=d.parts[u],o.contains(g.vertices,a.position)){s.pointA=a.position,s.bodyB=e.body=d,s.pointB={x:a.position.x-d.position.x,y:a.position.y-d.position.y},s.angleB=d.angle,r.set(d,!1),n.trigger(e,"startdrag",{mouse:a,body:d});break}}else r.set(s.bodyB,!1),s.pointA=a.position},a._triggerEvents=function(e){var t=e.mouse,a=t.sourceEvents;a.mousemove&&n.trigger(e,"mousemove",{mouse:t}),a.mousedown&&n.trigger(e,"mousedown",{mouse:t}),a.mouseup&&n.trigger(e,"mouseup",{mouse:t}),i.clearSourceEvents(t)}})()},{"../body/Composite":2,"../collision/Detector":5,"../core/Common":14,"../core/Events":16,"../core/Mouse":19,"../core/Sleeping":22,"../geometry/Bounds":26,"../geometry/Vertices":29,"./Constraint":12}],14:[function(e,t){(function(a){var o={};t.exports=o,function(){o._nextId=0,o._seed=0,o._nowStartTime=+new Date,o.extend=function(e,t){var a,r;"boolean"==typeof t?(a=2,r=t):(a=1,r=!0);for(var n=a,l;n<arguments.length;n++)if(l=arguments[n],l)for(var s in l)r&&l[s]&&l[s].constructor===Object?e[s]&&e[s].constructor!==Object?e[s]=l[s]:(e[s]=e[s]||{},o.extend(e[s],r,l[s])):e[s]=l[s];return e},o.clone=function(e,t){return o.extend({},t,e)},o.keys=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var a in e)t.push(a);return t},o.values=function(e){var t=[];if(Object.keys){for(var a=Object.keys(e),o=0;o<a.length;o++)t.push(e[a[o]]);return t}for(var r in e)t.push(e[r]);return t},o.get=function(e,t,a,o){t=t.split(".").slice(a,o);for(var r=0;r<t.length;r+=1)e=e[t[r]];return e},o.set=function(e,t,a,r,i){var n=t.split(".").slice(r,i);return o.get(e,t,0,-1)[n[n.length-1]]=a,a},o.shuffle=function(e){for(var t=e.length-1;0<t;t--){var a=h(o.random()*(t+1)),r=e[t];e[t]=e[a],e[a]=r}return e},o.choose=function(e){return e[h(o.random()*e.length)]},o.isElement=function(e){return"undefined"==typeof HTMLElement?!!(e&&e.nodeType&&e.nodeName):e instanceof HTMLElement},o.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},o.isFunction=function(e){return"function"==typeof e},o.isPlainObject=function(e){return"object"==typeof e&&e.constructor===Object},o.isString=function(e){return"[object String]"===toString.call(e)},o.clamp=function(e,t,a){return e<t?t:e>a?a:e},o.sign=function(e){return 0>e?-1:1},o.now=function(){if(window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return new Date-o._nowStartTime},o.random=function(e,a){return e="undefined"==typeof e?0:e,a="undefined"==typeof a?1:a,e+t()*(a-e)};var t=function(){return o._seed=(9301*o._seed+49297)%233280,o._seed/233280};o.colorToNumber=function(e){return e=e.replace("#",""),3==e.length&&(e=e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)),parseInt(e,16)},o.logLevel=1,o.log=function(){console&&0<o.logLevel&&3>=o.logLevel&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},o.info=function(){console&&0<o.logLevel&&2>=o.logLevel&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},o.warn=function(){console&&0<o.logLevel&&3>=o.logLevel&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},o.nextId=function(){return o._nextId++},o.indexOf=function(e,t){if(e.indexOf)return e.indexOf(t);for(var a=0;a<e.length;a++)if(e[a]===t)return a;return-1},o.map=function(e,t){if(e.map)return e.map(t);for(var a=[],o=0;o<e.length;o+=1)a.push(t(e[o]));return a},o.topologicalSort=function(e){var t=[],a=[],r=[];for(var i in e)a[i]||r[i]||o._topologicalSort(i,a,r,e,t);return t},o._topologicalSort=function(e,t,a,r,n){var l=r[e]||[];a[e]=!0;for(var s=0,d;s<l.length;s+=1)(d=l[s],!a[d])&&(t[d]||o._topologicalSort(d,t,a,r,n));a[e]=!1,t[e]=!0,n.push(e)},o.chain=function(){for(var e=[],t=0,a;t<arguments.length;t+=1)a=arguments[t],a._chained?e.push.apply(e,a._chained):e.push(a);var o=function(){for(var t=Array(arguments.length),a=0,o=arguments.length,r;a<o;a++)t[a]=arguments[a];for(a=0;a<e.length;a+=1){var n=e[a].apply(r,t);"undefined"!=typeof n&&(r=n)}return r};return o._chained=e,o},o.chainPathBefore=function(e,t,a){return o.set(e,t,o.chain(a,o.get(e,t)))},o.chainPathAfter=function(e,t,a){return o.set(e,t,o.chain(o.get(e,t),a))},o._requireGlobal=function(t,o){var r="undefined"==typeof window?"undefined"==typeof a?null:a[t]:window[t];return r||e(o)}}()}).call(this,"undefined"==typeof i?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:i)},{}],15:[function(e,t){var a={};t.exports=a;var o=e("../body/World"),r=e("./Sleeping"),n=e("../collision/Resolver"),l=e("../render/Render"),s=e("../collision/Pairs"),d=e("./Metrics"),c=e("../collision/Grid"),p=e("./Events"),u=e("../body/Composite"),g=e("../constraint/Constraint"),m=e("./Common"),h=e("../body/Body");(function(){a.create=function(e,t){t=m.isElement(e)?t:e,e=m.isElement(e)?e:null,t=t||{},(e||t.render)&&m.warn("Engine.create: engine.render is deprecated (see docs)");var a=m.extend({positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},timing:{timestamp:0,timeScale:1},broadphase:{controller:c}},t);if(e||a.render){var r={element:e,controller:l};a.render=m.extend(r,a.render)}return a.render&&a.render.controller&&(a.render=a.render.controller.create(a.render)),a.render&&(a.render.engine=a),a.world=t.world||o.create(a.world),a.pairs=s.create(),a.broadphase=a.broadphase.controller.create(a.broadphase),a.metrics=a.metrics||{extended:!1},a},a.update=function(e,t,o){t=t||1e3/60,o=o||1;var l=e.world,d=e.timing,c=e.broadphase,m=[],h;d.timestamp+=t*d.timeScale;var y={timestamp:d.timestamp};p.trigger(e,"beforeUpdate",y);var f=u.allBodies(l),x=u.allConstraints(l);for(e.enableSleeping&&r.update(f,d.timeScale),a._bodiesApplyGravity(f,l.gravity),a._bodiesUpdate(f,t,d.timeScale,o,l.bounds),g.preSolveAll(f),h=0;h<e.constraintIterations;h++)g.solveAll(x,d.timeScale);g.postSolveAll(f),c.controller?(l.isModified&&c.controller.clear(c),c.controller.update(c,f,e,l.isModified),m=c.pairsList):m=f,l.isModified&&u.setModified(l,!1,!1,!0);var _=c.detector(m,e),b=e.pairs,v=d.timestamp;for(s.update(b,_,v),s.removeOld(b,v),e.enableSleeping&&r.afterCollisions(b.list,d.timeScale),0<b.collisionStart.length&&p.trigger(e,"collisionStart",{pairs:b.collisionStart}),n.preSolvePosition(b.list),h=0;h<e.positionIterations;h++)n.solvePosition(b.list,d.timeScale);for(n.postSolvePosition(f),g.preSolveAll(f),h=0;h<e.constraintIterations;h++)g.solveAll(x,d.timeScale);for(g.postSolveAll(f),n.preSolveVelocity(b.list),h=0;h<e.velocityIterations;h++)n.solveVelocity(b.list,d.timeScale);return 0<b.collisionActive.length&&p.trigger(e,"collisionActive",{pairs:b.collisionActive}),0<b.collisionEnd.length&&p.trigger(e,"collisionEnd",{pairs:b.collisionEnd}),a._bodiesClearForces(f),p.trigger(e,"afterUpdate",y),e},a.merge=function(e,t){if(m.extend(e,t),t.world){e.world=t.world,a.clear(e);for(var o=u.allBodies(e.world),n=0,l;n<o.length;n++)l=o[n],r.set(l,!1),l.id=m.nextId()}},a.clear=function(e){var t=e.world;s.clear(e.pairs);var a=e.broadphase;if(a.controller){var o=u.allBodies(t);a.controller.clear(a),a.controller.update(a,o,e,!0)}},a._bodiesClearForces=function(e){for(var t=0,a;t<e.length;t++)a=e[t],a.force.x=0,a.force.y=0,a.torque=0},a._bodiesApplyGravity=function(e,t){var a="undefined"==typeof t.scale?.001:t.scale;if((0!==t.x||0!==t.y)&&0!==a)for(var o=0,r;o<e.length;o++)r=e[o],r.isStatic||r.isSleeping||(r.force.y+=r.mass*t.y*a,r.force.x+=r.mass*t.x*a)},a._bodiesUpdate=function(e,t,a,o){for(var r=0,n;r<e.length;r++)n=e[r],n.isStatic||n.isSleeping||h.update(n,t,a,o)}})()},{"../body/Body":1,"../body/Composite":2,"../body/World":3,"../collision/Grid":6,"../collision/Pairs":8,"../collision/Resolver":10,"../constraint/Constraint":12,"../render/Render":31,"./Common":14,"./Events":16,"./Metrics":18,"./Sleeping":22}],16:[function(e,t){var a={};t.exports=a;var o=e("./Common");(function(){a.on=function(e,t,a){for(var o=t.split(" "),r=0,n;r<o.length;r++)n=o[r],e.events=e.events||{},e.events[n]=e.events[n]||[],e.events[n].push(a);return a},a.off=function(e,t,a){if(!t)return void(e.events={});"function"==typeof t&&(a=t,t=o.keys(e.events).join(" "));for(var r=t.split(" "),n=0;n<r.length;n++){var l=e.events[r[n]],s=[];if(a&&l)for(var d=0;d<l.length;d++)l[d]!==a&&s.push(l[d]);e.events[r[n]]=s}},a.trigger=function(e,t,a){var r,n,l,s;if(e.events){a||(a={}),r=t.split(" ");for(var d=0;d<r.length;d++)if(n=r[d],l=e.events[n],l){s=o.clone(a,!1),s.name=n,s.source=e;for(var c=0;c<l.length;c++)l[c].apply(e,[s])}}}})()},{"./Common":14}],17:[function(e,t){var a={};t.exports=a;var o=e("./Plugin"),r=e("./Common");(function(){a.name="matter-js",a.version="0.14.2",a.uses=[],a.used=[],a.use=function(){o.use(a,Array.prototype.slice.call(arguments))},a.before=function(e,t){return e=e.replace(/^Matter./,""),r.chainPathBefore(a,e,t)},a.after=function(e,t){return e=e.replace(/^Matter./,""),r.chainPathAfter(a,e,t)}})()},{"./Common":14,"./Plugin":20}],18:[function(){},{"../body/Composite":2,"./Common":14}],19:[function(e,t){var a={};t.exports=a;var o=e("../core/Common");(function(){a.create=function(e){var t={};return e||o.log("Mouse.create: element was undefined, defaulting to document.body","warn"),t.element=e||document.body,t.absolute={x:0,y:0},t.position={x:0,y:0},t.mousedownPosition={x:0,y:0},t.mouseupPosition={x:0,y:0},t.offset={x:0,y:0},t.scale={x:1,y:1},t.wheelDelta=0,t.button=-1,t.pixelRatio=t.element.getAttribute("data-pixel-ratio")||1,t.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},t.mousemove=function(e){var o=a._getRelativeMousePosition(e,t.element,t.pixelRatio),r=e.changedTouches;r&&(t.button=0,e.preventDefault()),t.absolute.x=o.x,t.absolute.y=o.y,t.position.x=t.absolute.x*t.scale.x+t.offset.x,t.position.y=t.absolute.y*t.scale.y+t.offset.y,t.sourceEvents.mousemove=e},t.mousedown=function(e){var o=a._getRelativeMousePosition(e,t.element,t.pixelRatio),r=e.changedTouches;r?(t.button=0,e.preventDefault()):t.button=e.button,t.absolute.x=o.x,t.absolute.y=o.y,t.position.x=t.absolute.x*t.scale.x+t.offset.x,t.position.y=t.absolute.y*t.scale.y+t.offset.y,t.mousedownPosition.x=t.position.x,t.mousedownPosition.y=t.position.y,t.sourceEvents.mousedown=e},t.mouseup=function(e){var o=a._getRelativeMousePosition(e,t.element,t.pixelRatio),r=e.changedTouches;r&&e.preventDefault(),t.button=-1,t.absolute.x=o.x,t.absolute.y=o.y,t.position.x=t.absolute.x*t.scale.x+t.offset.x,t.position.y=t.absolute.y*t.scale.y+t.offset.y,t.mouseupPosition.x=t.position.x,t.mouseupPosition.y=t.position.y,t.sourceEvents.mouseup=e},t.mousewheel=function(e){t.wheelDelta=m(-1,p(1,e.wheelDelta||-e.detail)),e.preventDefault()},a.setElement(t,t.element),t},a.setElement=function(e,t){e.element=t,t.addEventListener("mousemove",e.mousemove),t.addEventListener("mousedown",e.mousedown),t.addEventListener("mouseup",e.mouseup),t.addEventListener("mousewheel",e.mousewheel),t.addEventListener("DOMMouseScroll",e.mousewheel),t.addEventListener("touchmove",e.mousemove),t.addEventListener("touchstart",e.mousedown),t.addEventListener("touchend",e.mouseup)},a.clearSourceEvents=function(e){e.sourceEvents.mousemove=null,e.sourceEvents.mousedown=null,e.sourceEvents.mouseup=null,e.sourceEvents.mousewheel=null,e.wheelDelta=0},a.setOffset=function(e,t){e.offset.x=t.x,e.offset.y=t.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y},a.setScale=function(e,t){e.scale.x=t.x,e.scale.y=t.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y},a._getRelativeMousePosition=function(e,t,a){var o=t.getBoundingClientRect(),r=document.documentElement||document.body.parentNode||document.body,i=void 0===window.pageXOffset?r.scrollLeft:window.pageXOffset,n=void 0===window.pageYOffset?r.scrollTop:window.pageYOffset,l=e.changedTouches,s,d;return l?(s=l[0].pageX-o.left-i,d=l[0].pageY-o.top-n):(s=e.pageX-o.left-i,d=e.pageY-o.top-n),{x:s/(t.clientWidth/(t.width||t.clientWidth)*a),y:d/(t.clientHeight/(t.height||t.clientHeight)*a)}}})()},{"../core/Common":14}],20:[function(e,t){var a={};t.exports=a;var o=e("./Common");(function(){a._registry={},a.register=function(e){if(a.isPlugin(e)||o.warn("Plugin.register:",a.toString(e),"does not implement all required fields."),e.name in a._registry){var t=a._registry[e.name],r=a.versionParse(e.version).number,i=a.versionParse(t.version).number;r>i?(o.warn("Plugin.register:",a.toString(t),"was upgraded to",a.toString(e)),a._registry[e.name]=e):r<i?o.warn("Plugin.register:",a.toString(t),"can not be downgraded to",a.toString(e)):e!==t&&o.warn("Plugin.register:",a.toString(e),"is already registered to different plugin object")}else a._registry[e.name]=e;return e},a.resolve=function(e){return a._registry[a.dependencyParse(e).name]},a.toString=function(e){return"string"==typeof e?e:(e.name||"anonymous")+"@"+(e.version||e.range||"0.0.0")},a.isPlugin=function(e){return e&&e.name&&e.version&&e.install},a.isUsed=function(e,t){return-1<e.used.indexOf(t)},a.isFor=function(e,t){var o=e.for&&a.dependencyParse(e.for);return!e.for||t.name===o.name&&a.versionSatisfies(t.version,o.range)},a.use=function(e,t){if(e.uses=(e.uses||[]).concat(t||[]),0===e.uses.length)return void o.warn("Plugin.use:",a.toString(e),"does not specify any dependencies to install.");for(var r=a.dependencies(e),n=o.topologicalSort(r),l=[],s=0;s<n.length;s+=1)if(n[s]!==e.name){var d=a.resolve(n[s]);if(!d){l.push("\u274C "+n[s]);continue}a.isUsed(e,d.name)||(a.isFor(d,e)||(o.warn("Plugin.use:",a.toString(d),"is for",d.for,"but installed on",a.toString(e)+"."),d._warned=!0),d.install?d.install(e):(o.warn("Plugin.use:",a.toString(d),"does not specify an install function."),d._warned=!0),d._warned?(l.push("\uD83D\uDD36 "+a.toString(d)),delete d._warned):l.push("\u2705 "+a.toString(d)),e.used.push(d.name))}0<l.length&&o.info(l.join("  "))},a.dependencies=function(e,t){var r=a.dependencyParse(e),n=r.name;if(t=t||{},!(n in t)){e=a.resolve(e)||e,t[n]=o.map(e.uses||[],function(t){a.isPlugin(t)&&a.register(t);var i=a.dependencyParse(t),n=a.resolve(t);return n&&!a.versionSatisfies(n.version,i.range)?(o.warn("Plugin.dependencies:",a.toString(n),"does not satisfy",a.toString(i),"used by",a.toString(r)+"."),n._warned=!0,e._warned=!0):!n&&(o.warn("Plugin.dependencies:",a.toString(t),"used by",a.toString(r),"could not be resolved."),e._warned=!0),i.name});for(var l=0;l<t[n].length;l+=1)a.dependencies(t[n][l],t);return t}},a.dependencyParse=function(e){if(o.isString(e)){return /^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?))?$/.test(e)||o.warn("Plugin.dependencyParse:",e,"is not a valid dependency string."),{name:e.split("@")[0],range:e.split("@")[1]||"*"}}return{name:e.name,range:e.range||e.version}},a.versionParse=function(e){/^\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?$/.test(e)||o.warn("Plugin.versionParse:",e,"is not a valid version or range.");var t=e.split("-");e=t[0];var a=isNaN(+e[0]),r=a?e.substr(1):e,i=o.map(r.split("."),function(e){return+e});return{isRange:a,version:r,range:e,operator:a?e[0]:"",parts:i,prerelease:t[1],number:1e8*i[0]+1e4*i[1]+i[2]}},a.versionSatisfies=function(e,t){t=t||"*";var o=a.versionParse(t),r=o.parts,i=a.versionParse(e),n=i.parts;if(o.isRange){if("*"===o.operator||"*"===e)return!0;if("~"===o.operator)return n[0]===r[0]&&n[1]===r[1]&&n[2]>=r[2];if("^"===o.operator)return 0<r[0]?n[0]===r[0]&&i.number>=o.number:0<r[1]?n[1]===r[1]&&n[2]>=r[2]:n[2]===r[2]}return e===t||"*"===e}})()},{"./Common":14}],21:[function(e,t){var a={};t.exports=a;var o=e("./Events"),r=e("./Engine"),i=e("./Common");(function(){var e,t;if("undefined"!=typeof window&&(e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),!e){var n;e=function(e){n=setTimeout(function(){e(i.now())},1e3/60)},t=function(){clearTimeout(n)}}a.create=function(e){var t=i.extend({fps:60,correction:1,deltaSampleSize:60,counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,timeScalePrev:1,frameRequestId:null,isFixed:!1,enabled:!0},e);return t.delta=t.delta||1e3/t.fps,t.deltaMin=t.deltaMin||1e3/t.fps,t.deltaMax=t.deltaMax||1e3/(.5*t.fps),t.fps=1e3/t.delta,t},a.run=function(t,o){return"undefined"!=typeof t.positionIterations&&(o=t,t=a.create()),function r(i){t.frameRequestId=e(r),i&&t.enabled&&a.tick(t,o,i)}(),t},a.tick=function(e,t,a){var i=t.timing,n=1,l={timestamp:i.timestamp},s;o.trigger(e,"beforeTick",l),o.trigger(t,"beforeTick",l),e.isFixed?s=e.delta:(s=a-e.timePrev||e.delta,e.timePrev=a,e.deltaHistory.push(s),e.deltaHistory=e.deltaHistory.slice(-e.deltaSampleSize),s=p.apply(null,e.deltaHistory),s=s<e.deltaMin?e.deltaMin:s,s=s>e.deltaMax?e.deltaMax:s,n=s/e.delta,e.delta=s),0!==e.timeScalePrev&&(n*=i.timeScale/e.timeScalePrev),0===i.timeScale&&(n=0),e.timeScalePrev=i.timeScale,e.correction=n,e.frameCounter+=1,1e3<=a-e.counterTimestamp&&(e.fps=e.frameCounter*((a-e.counterTimestamp)/1e3),e.counterTimestamp=a,e.frameCounter=0),o.trigger(e,"tick",l),o.trigger(t,"tick",l),t.world.isModified&&t.render&&t.render.controller&&t.render.controller.clear&&t.render.controller.clear(t.render),o.trigger(e,"beforeUpdate",l),r.update(t,s,n),o.trigger(e,"afterUpdate",l),t.render&&t.render.controller&&(o.trigger(e,"beforeRender",l),o.trigger(t,"beforeRender",l),t.render.controller.world(t.render),o.trigger(e,"afterRender",l),o.trigger(t,"afterRender",l)),o.trigger(e,"afterTick",l),o.trigger(t,"afterTick",l)},a.stop=function(e){t(e.frameRequestId)},a.start=function(e,t){a.run(e,t)}})()},{"./Common":14,"./Engine":15,"./Events":16}],22:[function(e,t){var a={};t.exports=a;var o=e("./Events");(function(){a._motionWakeThreshold=.18,a._motionSleepThreshold=.08,a._minBias=.9,a.update=function(e,t){for(var o=0;o<e.length;o++){var r=e[o],n=r.speed*r.speed+r.angularSpeed*r.angularSpeed;if(0!==r.force.x||0!==r.force.y){a.set(r,!1);continue}var l=p(r.motion,n),s=m(r.motion,n);r.motion=a._minBias*l+(1-a._minBias)*s,0<r.sleepThreshold&&r.motion<a._motionSleepThreshold*(t*t*t)?(r.sleepCounter+=1,r.sleepCounter>=r.sleepThreshold&&a.set(r,!0)):0<r.sleepCounter&&(r.sleepCounter-=1)}},a.afterCollisions=function(e,t){for(var o=0,r;o<e.length;o++)if(r=e[o],r.isActive){var n=r.collision,l=n.bodyA.parent,s=n.bodyB.parent;if(!(l.isSleeping&&s.isSleeping||l.isStatic||s.isStatic)&&(l.isSleeping||s.isSleeping)){var d=l.isSleeping&&!l.isStatic?l:s,c=d===l?s:l;!d.isStatic&&c.motion>a._motionWakeThreshold*(t*t*t)&&a.set(d,!1)}}},a.set=function(e,t){var a=e.isSleeping;t?(e.isSleeping=!0,e.sleepCounter=e.sleepThreshold,e.positionImpulse.x=0,e.positionImpulse.y=0,e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y,e.anglePrev=e.angle,e.speed=0,e.angularSpeed=0,e.motion=0,!a&&o.trigger(e,"sleepStart")):(e.isSleeping=!1,e.sleepCounter=0,a&&o.trigger(e,"sleepEnd"))}})()},{"./Events":16}],23:[function(e,t){var a={};t.exports=a;var o=e("../geometry/Vertices"),l=e("../core/Common"),c=e("../body/Body"),u=e("../geometry/Bounds"),g=e("../geometry/Vector"),h;(function(){a.rectangle=function(e,t,a,r,i){i=i||{};var n={label:"Rectangle Body",position:{x:e,y:t},vertices:o.fromPath("L 0 0 L "+a+" 0 L "+a+" "+r+" L 0 "+r)};if(i.chamfer){var s=i.chamfer;n.vertices=o.chamfer(n.vertices,s.radius,s.quality,s.qualityMin,s.qualityMax),delete i.chamfer}return c.create(l.extend({},n,i))},a.trapezoid=function(e,t,a,r,i,n){n=n||{},i*=.5;var s=(1-2*i)*a,d=a*i,p=d+s,u=p+d,g;g=.5>i?"L 0 0 L "+d+" "+-r+" L "+p+" "+-r+" L "+u+" 0":"L 0 0 L "+p+" "+-r+" L "+u+" 0";var m={label:"Trapezoid Body",position:{x:e,y:t},vertices:o.fromPath(g)};if(n.chamfer){var h=n.chamfer;m.vertices=o.chamfer(m.vertices,h.radius,h.quality,h.qualityMin,h.qualityMax),delete n.chamfer}return c.create(l.extend({},m,n))},a.circle=function(e,t,o,r,i){r=r||{};i=i||25;var s=n(m(10,p(i,o)));return 1==s%2&&(s+=1),a.polygon(e,t,s,o,l.extend({},{label:"Circle Body",circleRadius:o},r))},a.polygon=function(e,t,n,p,u){if(u=u||{},3>n)return a.circle(e,t,p,u);for(var g=2*s/n,m="",h=0;h<n;h+=1){var y=.5*g+h*g,f=r(y)*p,x=d(y)*p;m+="L "+f.toFixed(3)+" "+x.toFixed(3)+" "}var _={label:"Polygon Body",position:{x:e,y:t},vertices:o.fromPath(m)};if(u.chamfer){var b=u.chamfer;_.vertices=o.chamfer(_.vertices,b.radius,b.quality,b.qualityMin,b.qualityMax),delete u.chamfer}return c.create(l.extend({},_,u))},a.fromVertices=function(e,t,a,r,n,s,d){h||(h=l._requireGlobal("decomp","poly-decomp"));var p,m,y,f,x,_,b,w,T;for(r=r||{},m=[],n="undefined"!=typeof n&&n,s="undefined"==typeof s?.01:s,d="undefined"==typeof d?10:d,h||l.warn("Bodies.fromVertices: poly-decomp.js required. Could not decompose vertices. Fallback to convex hull."),l.isArray(a[0])||(a=[a]),w=0;w<a.length;w+=1)if(f=a[w],y=o.isConvex(f),y||!h)f=y?o.clockwiseSort(f):o.hull(f),m.push({position:{x:e,y:t},vertices:f});else{var A=f.map(function(e){return[e.x,e.y]});h.makeCCW(A),!1!==s&&h.removeCollinearPoints(A,s);var S=h.quickDecomp(A);for(x=0;x<S.length;x++){var C=S[x],L=C.map(function(e){return{x:e[0],y:e[1]}});0<d&&o.area(L)<d||m.push({position:o.centre(L),vertices:L})}}for(x=0;x<m.length;x++)m[x]=c.create(l.extend(m[x],r));if(n){for(x=0;x<m.length;x++){var E=m[x];for(_=x+1;_<m.length;_++){var I=m[_];if(u.overlaps(E.bounds,I.bounds)){var P=E.vertices,D=I.vertices;for(b=0;b<E.vertices.length;b++)for(T=0;T<I.vertices.length;T++){var O=g.magnitudeSquared(g.sub(P[(b+1)%P.length],D[T])),R=g.magnitudeSquared(g.sub(P[b],D[(T+1)%D.length]));O<5&&R<5&&(P[b].isInternal=!0,D[T].isInternal=!0)}}}}}return 1<m.length?(p=c.create(l.extend({parts:m.slice(0)},r)),c.setPosition(p,{x:e,y:t}),p):m[0]}})()},{"../body/Body":1,"../core/Common":14,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],24:[function(e,t){var a={};t.exports=a;var o=e("../body/Composite"),r=e("../constraint/Constraint"),l=e("../core/Common"),s=e("../body/Body"),d=e("./Bodies");(function(){a.stack=function(e,t,a,r,n,l,d){for(var c=o.create({label:"Stack"}),p=e,u=t,g=0,m=0,h,f;m<r;m++){f=0;for(var _=0,b;_<a;_++)if(b=d(p,u,_,m,h,g),b){var v=b.bounds.max.y-b.bounds.min.y,w=b.bounds.max.x-b.bounds.min.x;v>f&&(f=v),s.translate(b,{x:.5*w,y:.5*v}),p=b.bounds.max.x+n,o.addBody(c,b),h=b,g+=1}else p+=n;u+=f+l,p=e}return c},a.chain=function(e,t,a,n,s,d){for(var c=e.bodies,p=1;p<c.length;p++){var u=c[p-1],g=c[p],m=u.bounds.max.y-u.bounds.min.y,h=u.bounds.max.x-u.bounds.min.x,y=g.bounds.max.y-g.bounds.min.y,f=g.bounds.max.x-g.bounds.min.x,x=l.extend({bodyA:u,pointA:{x:h*t,y:m*a},bodyB:g,pointB:{x:f*n,y:y*s}},d);o.addConstraint(e,r.create(x))}return e.label+=" Chain",e},a.mesh=function(e,t,a,i,n){var s=e.bodies,d,c,p,u,g;for(d=0;d<a;d++){for(c=1;c<t;c++)p=s[c-1+d*t],u=s[c+d*t],o.addConstraint(e,r.create(l.extend({bodyA:p,bodyB:u},n)));if(0<d)for(c=0;c<t;c++)p=s[c+(d-1)*t],u=s[c+d*t],o.addConstraint(e,r.create(l.extend({bodyA:p,bodyB:u},n))),i&&0<c&&(g=s[c-1+(d-1)*t],o.addConstraint(e,r.create(l.extend({bodyA:g,bodyB:u},n)))),i&&c<t-1&&(g=s[c+1+(d-1)*t],o.addConstraint(e,r.create(l.extend({bodyA:g,bodyB:u},n))))}return e.label+=" Mesh",e},a.pyramid=function(e,t,o,r,l,d,c){return a.stack(e,t,o,r,l,d,function(t,a,d,u,g,m){var i=p(r,n(o/2)),h=g?g.bounds.max.x-g.bounds.min.x:0;if(!(u>i)){u=i-u;var y=u,f=o-1-u;if(!(d<y||d>f)){1===m&&s.translate(g,{x:(d+(1==o%2?1:-1))*h,y:0});var x=g?d*h:0;return c(e+x+d*l,a,d,u,g,m)}}})},a.newtonsCradle=function(e,t,a,n,l){for(var s=o.create({label:"Newtons Cradle"}),c=0;c<a;c++){var p=1.9,u=d.circle(e+c*(n*p),t+l,n,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),g=r.create({pointA:{x:e+c*(n*p),y:t},bodyB:u});o.addBody(s,u),o.addConstraint(s,g)}return s},a.car=function(e,t,a,i,n){var l=s.nextGroup(!0),c=.5*-a+20,p=.5*a-20,u=o.create({label:"Car"}),g=d.rectangle(e,t,a,i,{collisionFilter:{group:l},chamfer:{radius:.5*i},density:2e-4}),m=d.circle(e+c,t+0,n,{collisionFilter:{group:l},friction:.8}),h=d.circle(e+p,t+0,n,{collisionFilter:{group:l},friction:.8}),y=r.create({bodyB:g,pointB:{x:c,y:0},bodyA:m,stiffness:1,length:0}),f=r.create({bodyB:g,pointB:{x:p,y:0},bodyA:h,stiffness:1,length:0});return o.addBody(u,g),o.addBody(u,m),o.addBody(u,h),o.addConstraint(u,y),o.addConstraint(u,f),u},a.softBody=function(e,t,o,r,i,n,s,c,p,u){p=l.extend({inertia:1/0},p),u=l.extend({stiffness:.2,render:{type:"line",anchors:!1}},u);var g=a.stack(e,t,o,r,i,n,function(e,t){return d.circle(e,t,c,p)});return a.mesh(g,o,r,s,u),g.label="Soft Body",g}})()},{"../body/Body":1,"../body/Composite":2,"../constraint/Constraint":12,"../core/Common":14,"./Bodies":23}],25:[function(e,t){var a={};t.exports=a;var o=e("../geometry/Vector"),n=e("../core/Common");(function(){a.fromVertices=function(e){for(var t={},a=0;a<e.length;a++){var r=(a+1)%e.length,l=o.normalise({x:e[r].y-e[a].y,y:e[a].x-e[r].x}),s=0===l.y?1/0:l.x/l.y;s=s.toFixed(3).toString(),t[s]=l}return n.values(t)},a.rotate=function(e,t){if(0!==t)for(var a=r(t),o=d(t),n=0;n<e.length;n++){var l=e[n],s;s=l.x*a-l.y*o,l.y=l.x*o+l.y*a,l.x=s}}})()},{"../core/Common":14,"../geometry/Vector":28}],26:[function(e,t){var a={};t.exports=a,function(){a.create=function(e){var t={min:{x:0,y:0},max:{x:0,y:0}};return e&&a.update(t,e),t},a.update=function(e,t,a){e.min.x=1/0,e.max.x=-Infinity,e.min.y=1/0,e.max.y=-Infinity;for(var o=0,r;o<t.length;o++)r=t[o],r.x>e.max.x&&(e.max.x=r.x),r.x<e.min.x&&(e.min.x=r.x),r.y>e.max.y&&(e.max.y=r.y),r.y<e.min.y&&(e.min.y=r.y);a&&(0<a.x?e.max.x+=a.x:e.min.x+=a.x,0<a.y?e.max.y+=a.y:e.min.y+=a.y)},a.contains=function(e,t){return t.x>=e.min.x&&t.x<=e.max.x&&t.y>=e.min.y&&t.y<=e.max.y},a.overlaps=function(e,t){return e.min.x<=t.max.x&&e.max.x>=t.min.x&&e.max.y>=t.min.y&&e.min.y<=t.max.y},a.translate=function(e,t){e.min.x+=t.x,e.max.x+=t.x,e.min.y+=t.y,e.max.y+=t.y},a.shift=function(e,t){var a=e.max.x-e.min.x,o=e.max.y-e.min.y;e.min.x=t.x,e.max.x=t.x+a,e.min.y=t.y,e.max.y=t.y+o}}()},{}],27:[function(e,t){var a={};t.exports=a;var o=e("../geometry/Bounds"),r=e("../core/Common");(function(){a.pathToVertices=function(e,t){"undefined"==typeof window||"SVGPathSeg"in window||r.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var o=[],n=0,l=0,s=0,d,c,p,u,g,m,h,f,_,b,v,w;t=t||15;var k=function(e,t,a){var r=1==a%2&&1<a;if(!_||e!=_.x||t!=_.y){_&&r?(v=_.x,w=_.y):(v=0,w=0);var i={x:v+e,y:w+t};(r||!_)&&(_=i),o.push(i),l=v+e,s=w+t}},T=function(e){var t=e.pathSegTypeAsLetter.toUpperCase();"Z"!==t&&("M"===t||"L"===t||"T"===t||"C"===t||"S"===t||"Q"===t?(l=e.x,s=e.y):"H"===t?l=e.x:"V"===t?s=e.y:void 0,k(l,s,e.pathSegType))};for(a._svgPathToAbsolute(e),p=e.getTotalLength(),m=[],d=0;d<e.pathSegList.numberOfItems;d+=1)m.push(e.pathSegList.getItem(d));for(h=m.concat();n<p;){if(b=e.getPathSegAtLength(n),g=m[b],g!=f){for(;h.length&&h[0]!=g;)T(h.shift());f=g}switch(g.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":u=e.getPointAtLength(n),k(u.x,u.y,0);}n+=t}for(d=0,c=h.length;d<c;++d)T(h[d]);return o},a._svgPathToAbsolute=function(e){for(var t=e.pathSegList,a=0,o=0,r=t.numberOfItems,n=0,l,s,d,c,p,u;n<r;++n){var g=t.getItem(n),m=g.pathSegTypeAsLetter;/[MLHVCSQTA]/.test(m)?("x"in g&&(a=g.x),"y"in g&&(o=g.y)):("x1"in g&&(d=a+g.x1),"x2"in g&&(p=a+g.x2),"y1"in g&&(c=o+g.y1),"y2"in g&&(u=o+g.y2),"x"in g&&(a+=g.x),"y"in g&&(o+=g.y),"m"===m?t.replaceItem(e.createSVGPathSegMovetoAbs(a,o),n):"l"===m?t.replaceItem(e.createSVGPathSegLinetoAbs(a,o),n):"h"===m?t.replaceItem(e.createSVGPathSegLinetoHorizontalAbs(a),n):"v"===m?t.replaceItem(e.createSVGPathSegLinetoVerticalAbs(o),n):"c"===m?t.replaceItem(e.createSVGPathSegCurvetoCubicAbs(a,o,d,c,p,u),n):"s"===m?t.replaceItem(e.createSVGPathSegCurvetoCubicSmoothAbs(a,o,p,u),n):"q"===m?t.replaceItem(e.createSVGPathSegCurvetoQuadraticAbs(a,o,d,c),n):"t"===m?t.replaceItem(e.createSVGPathSegCurvetoQuadraticSmoothAbs(a,o),n):"a"===m?t.replaceItem(e.createSVGPathSegArcAbs(a,o,g.r1,g.r2,g.angle,g.largeArcFlag,g.sweepFlag),n):"z"===m||"Z"===m?(a=l,o=s):void 0);("M"==m||"m"==m)&&(l=a,s=o)}}})()},{"../core/Common":14,"../geometry/Bounds":26}],28:[function(e,t){var a={};t.exports=a,function(){a.create=function(e,t){return{x:e||0,y:t||0}},a.clone=function(e){return{x:e.x,y:e.y}},a.magnitude=function(e){return l(e.x*e.x+e.y*e.y)},a.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y},a.rotate=function(e,t,a){var o=r(t),i=d(t);a||(a={});var n=e.x*o-e.y*i;return a.y=e.x*i+e.y*o,a.x=n,a},a.rotateAbout=function(e,t,a,o){var i=r(t),n=d(t);o||(o={});var l=a.x+((e.x-a.x)*i-(e.y-a.y)*n);return o.y=a.y+((e.x-a.x)*n+(e.y-a.y)*i),o.x=l,o},a.normalise=function(e){var t=a.magnitude(e);return 0===t?{x:0,y:0}:{x:e.x/t,y:e.y/t}},a.dot=function(e,t){return e.x*t.x+e.y*t.y},a.cross=function(e,t){return e.x*t.y-e.y*t.x},a.cross3=function(e,t,a){return(t.x-e.x)*(a.y-e.y)-(t.y-e.y)*(a.x-e.x)},a.add=function(e,t,a){return a||(a={}),a.x=e.x+t.x,a.y=e.y+t.y,a},a.sub=function(e,t,a){return a||(a={}),a.x=e.x-t.x,a.y=e.y-t.y,a},a.mult=function(e,t){return{x:e.x*t,y:e.y*t}},a.div=function(e,t){return{x:e.x/t,y:e.y/t}},a.perp=function(e,t){return t=!0===t?-1:1,{x:t*-e.y,y:t*e.x}},a.neg=function(e){return{x:-e.x,y:-e.y}},a.angle=function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)},a._temp=[a.create(),a.create(),a.create(),a.create(),a.create(),a.create()]}()},{}],29:[function(e,t){var a={};t.exports=a;var o=e("../geometry/Vector"),n=e("../core/Common");(function(){a.create=function(e,t){for(var a=[],o=0;o<e.length;o++){var r=e[o],n={x:r.x,y:r.y,index:o,body:t,isInternal:!1};a.push(n)}return a},a.fromPath=function(e,t){var o=[];return e.replace(/L?\s*([\-\d\.e]+)[\s,]*([\-\d\.e]+)*/ig,function(e,t,a){o.push({x:parseFloat(t),y:parseFloat(a)})}),a.create(o,t)},a.centre=function(e){for(var t=a.area(e,!0),r={x:0,y:0},n=0,l,s,d;n<e.length;n++)d=(n+1)%e.length,l=o.cross(e[n],e[d]),s=o.mult(o.add(e[n],e[d]),l),r=o.add(r,s);return o.div(r,6*t)},a.mean=function(e){for(var t={x:0,y:0},a=0;a<e.length;a++)t.x+=e[a].x,t.y+=e[a].y;return o.div(t,e.length)},a.area=function(e,t){for(var a=0,o=e.length-1,r=0;r<e.length;r++)a+=(e[o].x-e[r].x)*(e[o].y+e[r].y),o=r;return t?a/2:g(a)/2},a.inertia=function(e,t){for(var a=0,r=0,i=e,l=0,s,d;l<i.length;l++)d=(l+1)%i.length,s=g(o.cross(i[d],i[l])),a+=s*(o.dot(i[d],i[d])+o.dot(i[d],i[l])+o.dot(i[l],i[l])),r+=s;return t/6*(a/r)},a.translate=function(e,t,a){var o;if(a)for(o=0;o<e.length;o++)e[o].x+=t.x*a,e[o].y+=t.y*a;else for(o=0;o<e.length;o++)e[o].x+=t.x,e[o].y+=t.y;return e},a.rotate=function(e,t,a){if(0!==t){for(var o=r(t),n=d(t),l=0;l<e.length;l++){var s=e[l],c=s.x-a.x,p=s.y-a.y;s.x=a.x+(c*o-p*n),s.y=a.y+(c*n+p*o)}return e}},a.contains=function(e,t){for(var a=0;a<e.length;a++){var o=e[a],r=e[(a+1)%e.length];if(0<(t.x-o.x)*(r.y-o.y)+(t.y-o.y)*(o.x-r.x))return!1}return!0},a.scale=function(e,t,r,n){if(1===t&&1===r)return e;n=n||a.centre(e);for(var l=0,s,d;l<e.length;l++)s=e[l],d=o.sub(s,n),e[l].x=n.x+d.x*t,e[l].y=n.y+d.y*r;return e},a.chamfer=function(e,t,a,r,s){t="number"==typeof t?[t]:t||[8],a="undefined"==typeof a?-1:a,r=r||2,s=s||14;for(var d=[],c=0;c<e.length;c++){var p=e[0<=c-1?c-1:e.length-1],g=e[c],m=e[(c+1)%e.length],h=t[c<t.length?c:t.length-1];if(0===h){d.push(g);continue}var y=o.normalise({x:g.y-p.y,y:p.x-g.x}),f=o.normalise({x:m.y-g.y,y:g.x-m.x}),x=l(2*u(h,2)),_=o.mult(n.clone(y),h),b=o.normalise(o.mult(o.add(y,f),.5)),v=o.sub(g,o.mult(b,x)),w=a;-1===a&&(w=1.75*u(h,.32)),w=n.clamp(w,r,s),1==w%2&&(w+=1);for(var k=Math.acos(o.dot(y,f)),T=k/w,A=0;A<w;A++)d.push(o.add(o.rotate(_,T*A),v))}return d},a.clockwiseSort=function(e){var t=a.mean(e);return e.sort(function(e,a){return o.angle(t,e)-o.angle(t,a)}),e},a.isConvex=function(e){var t=0,a=e.length,o,r,n,l;if(3>a)return null;for(o=0;o<a;o++)if(r=(o+1)%a,n=(o+2)%a,l=(e[r].x-e[o].x)*(e[n].y-e[r].y),l-=(e[r].y-e[o].y)*(e[n].x-e[r].x),0>l?t|=1:0<l&&(t|=2),3===t)return!1;return 0!=t||null},a.hull=function(e){var t=[],a=[],r,n;for(e=e.slice(0),e.sort(function(e,t){var a=e.x-t.x;return 0==a?e.y-t.y:a}),n=0;n<e.length;n+=1){for(r=e[n];2<=a.length&&0>=o.cross3(a[a.length-2],a[a.length-1],r);)a.pop();a.push(r)}for(n=e.length-1;0<=n;n-=1){for(r=e[n];2<=t.length&&0>=o.cross3(t[t.length-2],t[t.length-1],r);)t.pop();t.push(r)}return t.pop(),a.pop(),t.concat(a)}})()},{"../core/Common":14,"../geometry/Vector":28}],30:[function(e,t){var a=t.exports=e("../core/Matter");a.Body=e("../body/Body"),a.Composite=e("../body/Composite"),a.World=e("../body/World"),a.Contact=e("../collision/Contact"),a.Detector=e("../collision/Detector"),a.Grid=e("../collision/Grid"),a.Pairs=e("../collision/Pairs"),a.Pair=e("../collision/Pair"),a.Query=e("../collision/Query"),a.Resolver=e("../collision/Resolver"),a.SAT=e("../collision/SAT"),a.Constraint=e("../constraint/Constraint"),a.MouseConstraint=e("../constraint/MouseConstraint"),a.Common=e("../core/Common"),a.Engine=e("../core/Engine"),a.Events=e("../core/Events"),a.Mouse=e("../core/Mouse"),a.Runner=e("../core/Runner"),a.Sleeping=e("../core/Sleeping"),a.Plugin=e("../core/Plugin"),a.Bodies=e("../factory/Bodies"),a.Composites=e("../factory/Composites"),a.Axes=e("../geometry/Axes"),a.Bounds=e("../geometry/Bounds"),a.Svg=e("../geometry/Svg"),a.Vector=e("../geometry/Vector"),a.Vertices=e("../geometry/Vertices"),a.Render=e("../render/Render"),a.RenderPixi=e("../render/RenderPixi"),a.World.add=a.Composite.add,a.World.remove=a.Composite.remove,a.World.addComposite=a.Composite.addComposite,a.World.addBody=a.Composite.addBody,a.World.addConstraint=a.Composite.addConstraint,a.World.clear=a.Composite.clear,a.Engine.run=a.Runner.run},{"../body/Body":1,"../body/Composite":2,"../body/World":3,"../collision/Contact":4,"../collision/Detector":5,"../collision/Grid":6,"../collision/Pair":7,"../collision/Pairs":8,"../collision/Query":9,"../collision/Resolver":10,"../collision/SAT":11,"../constraint/Constraint":12,"../constraint/MouseConstraint":13,"../core/Common":14,"../core/Engine":15,"../core/Events":16,"../core/Matter":17,"../core/Metrics":18,"../core/Mouse":19,"../core/Plugin":20,"../core/Runner":21,"../core/Sleeping":22,"../factory/Bodies":23,"../factory/Composites":24,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Svg":27,"../geometry/Vector":28,"../geometry/Vertices":29,"../render/Render":31,"../render/RenderPixi":32}],31:[function(e,t){var a={};t.exports=a;var o=e("../core/Common"),r=e("../body/Composite"),l=e("../geometry/Bounds"),d=e("../core/Events"),c=e("../collision/Grid"),u=e("../geometry/Vector"),m=e("../core/Mouse");(function(){var e,t;"undefined"!=typeof window&&(e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(function(){e(o.now())},1e3/60)},t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),a.create=function(e){var t={controller:a,engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,options:{width:800,height:600,pixelRatio:1,background:"#18181d",wireframeBackground:"#0f0f13",hasBounds:!!e.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},r=o.extend(t,e);return r.canvas&&(r.canvas.width=r.options.width||r.canvas.width,r.canvas.height=r.options.height||r.canvas.height),r.mouse=e.mouse,r.engine=e.engine,r.canvas=r.canvas||i(r.options.width,r.options.height),r.context=r.canvas.getContext("2d"),r.textures={},r.bounds=r.bounds||{min:{x:0,y:0},max:{x:r.canvas.width,y:r.canvas.height}},1!==r.options.pixelRatio&&a.setPixelRatio(r,r.options.pixelRatio),o.isElement(r.element)?r.element.appendChild(r.canvas):!r.canvas.parentNode&&o.log("Render.create: options.element was undefined, render.canvas was created but not appended","warn"),r},a.run=function(t){(function o(){t.frameRequestId=e(o),a.world(t)})()},a.stop=function(e){t(e.frameRequestId)},a.setPixelRatio=function(e,t){var a=e.options,o=e.canvas;"auto"===t&&(t=y(o)),a.pixelRatio=t,o.setAttribute("data-pixel-ratio",t),o.width=a.width*t,o.height=a.height*t,o.style.width=a.width+"px",o.style.height=a.height+"px",e.context.scale(t,t)},a.lookAt=function(e,t,a,r){r=!("undefined"!=typeof r)||r,t=o.isArray(t)?t:[t],a=a||{x:0,y:0};for(var n={min:{x:1/0,y:1/0},max:{x:-Infinity,y:-Infinity}},l=0;l<t.length;l+=1){var s=t[l],d=s.bounds?s.bounds.min:s.min||s.position||s,c=s.bounds?s.bounds.max:s.max||s.position||s;d&&c&&(d.x<n.min.x&&(n.min.x=d.x),c.x>n.max.x&&(n.max.x=c.x),d.y<n.min.y&&(n.min.y=d.y),c.y>n.max.y&&(n.max.y=c.y))}var p=n.max.x-n.min.x+2*a.x,u=n.max.y-n.min.y+2*a.y,g=e.canvas.height,h=e.canvas.width,y=h/g,f=p/u,x=1,_=1;f>y?_=f/y:x=y/f,e.options.hasBounds=!0,e.bounds.min.x=n.min.x,e.bounds.max.x=n.min.x+p*x,e.bounds.min.y=n.min.y,e.bounds.max.y=n.min.y+u*_,r&&(e.bounds.min.x+=.5*p-.5*(p*x),e.bounds.max.x+=.5*p-.5*(p*x),e.bounds.min.y+=.5*u-.5*(u*_),e.bounds.max.y+=.5*u-.5*(u*_)),e.bounds.min.x-=a.x,e.bounds.max.x-=a.x,e.bounds.min.y-=a.y,e.bounds.max.y-=a.y,e.mouse&&(m.setScale(e.mouse,{x:(e.bounds.max.x-e.bounds.min.x)/e.canvas.width,y:(e.bounds.max.y-e.bounds.min.y)/e.canvas.height}),m.setOffset(e.mouse,e.bounds.min))},a.startViewTransform=function(e){var t=e.bounds.max.x-e.bounds.min.x,a=e.bounds.max.y-e.bounds.min.y,o=t/e.options.width,r=a/e.options.height;e.context.scale(1/o,1/r),e.context.translate(-e.bounds.min.x,-e.bounds.min.y)},a.endViewTransform=function(e){e.context.setTransform(e.options.pixelRatio,0,0,e.options.pixelRatio,0,0)},a.world=function(e){var t=e.engine,o=t.world,n=e.canvas,s=e.context,p=e.options,g=r.allBodies(o),h=r.allConstraints(o),y=p.wireframes?p.wireframeBackground:p.background,f=[],_=[],b={timestamp:t.timing.timestamp},v;if(d.trigger(e,"beforeRender",b),e.currentBackground!==y&&x(e,y),s.globalCompositeOperation="source-in",s.fillStyle="transparent",s.fillRect(0,0,n.width,n.height),s.globalCompositeOperation="source-over",p.hasBounds){for(v=0;v<g.length;v++){var w=g[v];l.overlaps(w.bounds,e.bounds)&&f.push(w)}for(v=0;v<h.length;v++){var k=h[v],T=k.bodyA,A=k.bodyB,S=k.pointA,C=k.pointB;T&&(S=u.add(T.position,k.pointA)),A&&(C=u.add(A.position,k.pointB)),S&&C&&(l.contains(e.bounds,S)||l.contains(e.bounds,C))&&_.push(k)}a.startViewTransform(e),e.mouse&&(m.setScale(e.mouse,{x:(e.bounds.max.x-e.bounds.min.x)/e.canvas.width,y:(e.bounds.max.y-e.bounds.min.y)/e.canvas.height}),m.setOffset(e.mouse,e.bounds.min))}else _=h,f=g;!p.wireframes||t.enableSleeping&&p.showSleeping?a.bodies(e,f,s):(p.showConvexHulls&&a.bodyConvexHulls(e,f,s),a.bodyWireframes(e,f,s)),p.showBounds&&a.bodyBounds(e,f,s),(p.showAxes||p.showAngleIndicator)&&a.bodyAxes(e,f,s),p.showPositions&&a.bodyPositions(e,f,s),p.showVelocity&&a.bodyVelocity(e,f,s),p.showIds&&a.bodyIds(e,f,s),p.showSeparations&&a.separations(e,t.pairs.list,s),p.showCollisions&&a.collisions(e,t.pairs.list,s),p.showVertexNumbers&&a.vertexNumbers(e,f,s),p.showMousePosition&&a.mousePosition(e,e.mouse,s),a.constraints(_,s),p.showBroadphase&&t.broadphase.controller===c&&a.grid(e,t.broadphase,s),p.showDebug&&a.debug(e,s),p.hasBounds&&a.endViewTransform(e),d.trigger(e,"afterRender",b)},a.debug=function(e,t){var a=t,o=e.engine,n=o.world,l=o.metrics,s=e.options,d=r.allBodies(n);if(500<=o.timing.timestamp-(e.debugTimestamp||0)){var c="";l.timing&&(c+="fps: "+Math.round(l.timing.fps)+"    "),e.debugString=c,e.debugTimestamp=o.timing.timestamp}if(e.debugString){a.font="12px Arial",a.fillStyle=s.wireframes?"rgba(255,255,255,0.5)":"rgba(0,0,0,0.5)";for(var p=e.debugString.split("\n"),u=0;u<p.length;u++)a.fillText(p[u],50,50+18*u)}},a.constraints=function(e,t){for(var a=t,r=0,l;r<e.length;r++)if(l=e[r],l.render.visible&&l.pointA&&l.pointB){var d=l.bodyA,c=l.bodyB,p,g;if(p=d?u.add(d.position,l.pointA):l.pointA,"pin"===l.render.type)a.beginPath(),a.arc(p.x,p.y,3,0,2*s),a.closePath();else{if(g=c?u.add(c.position,l.pointB):l.pointB,a.beginPath(),a.moveTo(p.x,p.y),"spring"===l.render.type)for(var m=u.sub(g,p),h=u.perp(u.normalise(m)),y=n(o.clamp(l.length/5,12,20)),f=1,x;f<y;f+=1)x=0==f%2?1:-1,a.lineTo(p.x+m.x*(f/y)+4*(h.x*x),p.y+m.y*(f/y)+4*(h.y*x));a.lineTo(g.x,g.y)}l.render.lineWidth&&(a.lineWidth=l.render.lineWidth,a.strokeStyle=l.render.strokeStyle,a.stroke()),l.render.anchors&&(a.fillStyle=l.render.strokeStyle,a.beginPath(),a.arc(p.x,p.y,3,0,2*s),a.arc(g.x,g.y,3,0,2*s),a.closePath(),a.fill())}},a.bodyShadows=function(e,t,a){for(var o=a,r=e.engine,n=0,l;n<t.length;n++)if(l=t[n],l.render.visible){if(l.circleRadius)o.beginPath(),o.arc(l.position.x,l.position.y,l.circleRadius,0,2*s),o.closePath();else{o.beginPath(),o.moveTo(l.vertices[0].x,l.vertices[0].y);for(var d=1;d<l.vertices.length;d++)o.lineTo(l.vertices[d].x,l.vertices[d].y);o.closePath()}var c=l.position.x-.5*e.options.width,u=l.position.y-.2*e.options.height,m=g(c)+g(u);o.shadowColor="rgba(0,0,0,0.15)",o.shadowOffsetX=.05*c,o.shadowOffsetY=.05*u,o.shadowBlur=1+12*p(1,m/1e3),o.fill(),o.shadowColor=null,o.shadowOffsetX=null,o.shadowOffsetY=null,o.shadowBlur=null}},a.bodies=function(e,t,a){var o=a,r=e.engine,n=e.options,l=n.showInternalEdges||!n.wireframes,d,c,p,u;for(p=0;p<t.length;p++)if(d=t[p],d.render.visible)for(u=1<d.parts.length?1:0;u<d.parts.length;u++)if(c=d.parts[u],c.render.visible){if(n.showSleeping&&d.isSleeping?o.globalAlpha=.5*c.render.opacity:1!==c.render.opacity&&(o.globalAlpha=c.render.opacity),c.render.sprite&&c.render.sprite.texture&&!n.wireframes){var g=c.render.sprite,m=f(e,g.texture);o.translate(c.position.x,c.position.y),o.rotate(c.angle),o.drawImage(m,m.width*-g.xOffset*g.xScale,m.height*-g.yOffset*g.yScale,m.width*g.xScale,m.height*g.yScale),o.rotate(-c.angle),o.translate(-c.position.x,-c.position.y)}else{if(c.circleRadius)o.beginPath(),o.arc(c.position.x,c.position.y,c.circleRadius,0,2*s);else{o.beginPath(),o.moveTo(c.vertices[0].x,c.vertices[0].y);for(var h=1;h<c.vertices.length;h++)!c.vertices[h-1].isInternal||l?o.lineTo(c.vertices[h].x,c.vertices[h].y):o.moveTo(c.vertices[h].x,c.vertices[h].y),c.vertices[h].isInternal&&!l&&o.moveTo(c.vertices[(h+1)%c.vertices.length].x,c.vertices[(h+1)%c.vertices.length].y);o.lineTo(c.vertices[0].x,c.vertices[0].y),o.closePath()}n.wireframes?(o.lineWidth=1,o.strokeStyle="#bbb",o.stroke()):(o.fillStyle=c.render.fillStyle,c.render.lineWidth&&(o.lineWidth=c.render.lineWidth,o.strokeStyle=c.render.strokeStyle,o.stroke()),o.fill())}o.globalAlpha=1}},a.bodyWireframes=function(e,t,a){var o=a,r=e.options.showInternalEdges,n,l,s,d,c;for(o.beginPath(),s=0;s<t.length;s++)if(n=t[s],n.render.visible)for(c=1<n.parts.length?1:0;c<n.parts.length;c++){for(l=n.parts[c],o.moveTo(l.vertices[0].x,l.vertices[0].y),d=1;d<l.vertices.length;d++)!l.vertices[d-1].isInternal||r?o.lineTo(l.vertices[d].x,l.vertices[d].y):o.moveTo(l.vertices[d].x,l.vertices[d].y),l.vertices[d].isInternal&&!r&&o.moveTo(l.vertices[(d+1)%l.vertices.length].x,l.vertices[(d+1)%l.vertices.length].y);o.lineTo(l.vertices[0].x,l.vertices[0].y)}o.lineWidth=1,o.strokeStyle="#bbb",o.stroke()},a.bodyConvexHulls=function(e,t,a){var o=a,r,n,l;for(o.beginPath(),n=0;n<t.length;n++)if(r=t[n],r.render.visible&&1!==r.parts.length){for(o.moveTo(r.vertices[0].x,r.vertices[0].y),l=1;l<r.vertices.length;l++)o.lineTo(r.vertices[l].x,r.vertices[l].y);o.lineTo(r.vertices[0].x,r.vertices[0].y)}o.lineWidth=1,o.strokeStyle="rgba(255,255,255,0.2)",o.stroke()},a.vertexNumbers=function(e,t,a){var o=a,r,n,l;for(r=0;r<t.length;r++){var s=t[r].parts;for(l=1<s.length?1:0;l<s.length;l++){var d=s[l];for(n=0;n<d.vertices.length;n++)o.fillStyle="rgba(255,255,255,0.2)",o.fillText(r+"_"+n,d.position.x+.8*(d.vertices[n].x-d.position.x),d.position.y+.8*(d.vertices[n].y-d.position.y))}}},a.mousePosition=function(e,t,a){var o=a;o.fillStyle="rgba(255,255,255,0.8)",o.fillText(t.position.x+"  "+t.position.y,t.position.x+5,t.position.y-5)},a.bodyBounds=function(e,t,a){var o=a,r=e.engine,n=e.options;o.beginPath();for(var l=0,s;l<t.length;l++)if(s=t[l],s.render.visible)for(var d=t[l].parts,c=1<d.length?1:0,p;c<d.length;c++)p=d[c],o.rect(p.bounds.min.x,p.bounds.min.y,p.bounds.max.x-p.bounds.min.x,p.bounds.max.y-p.bounds.min.y);o.strokeStyle=n.wireframes?"rgba(255,255,255,0.08)":"rgba(0,0,0,0.1)",o.lineWidth=1,o.stroke()},a.bodyAxes=function(e,t,a){var o=a,r=e.engine,n=e.options,l,s,d,c;for(o.beginPath(),s=0;s<t.length;s++){var p=t[s],u=p.parts;if(p.render.visible)if(n.showAxes)for(d=1<u.length?1:0;d<u.length;d++)for(l=u[d],c=0;c<l.axes.length;c++){var g=l.axes[c];o.moveTo(l.position.x,l.position.y),o.lineTo(l.position.x+20*g.x,l.position.y+20*g.y)}else for(d=1<u.length?1:0;d<u.length;d++)for(l=u[d],c=0;c<l.axes.length;c++)o.moveTo(l.position.x,l.position.y),o.lineTo((l.vertices[0].x+l.vertices[l.vertices.length-1].x)/2,(l.vertices[0].y+l.vertices[l.vertices.length-1].y)/2)}n.wireframes?(o.strokeStyle="indianred",o.lineWidth=1):(o.strokeStyle="rgba(255, 255, 255, 0.4)",o.globalCompositeOperation="overlay",o.lineWidth=2),o.stroke(),o.globalCompositeOperation="source-over"},a.bodyPositions=function(e,t,a){var o=a,r=e.engine,n=e.options,l,d,c,p;for(o.beginPath(),c=0;c<t.length;c++)if(l=t[c],l.render.visible)for(p=0;p<l.parts.length;p++)d=l.parts[p],o.arc(d.position.x,d.position.y,3,0,2*s,!1),o.closePath();for(o.fillStyle=n.wireframes?"indianred":"rgba(0,0,0,0.5)",o.fill(),o.beginPath(),c=0;c<t.length;c++)l=t[c],l.render.visible&&(o.arc(l.positionPrev.x,l.positionPrev.y,2,0,2*s,!1),o.closePath());o.fillStyle="rgba(255,165,0,0.8)",o.fill()},a.bodyVelocity=function(e,t,a){var o=a;o.beginPath();for(var r=0,n;r<t.length;r++)n=t[r],n.render.visible&&(o.moveTo(n.position.x,n.position.y),o.lineTo(n.position.x+2*(n.position.x-n.positionPrev.x),n.position.y+2*(n.position.y-n.positionPrev.y)));o.lineWidth=3,o.strokeStyle="cornflowerblue",o.stroke()},a.bodyIds=function(e,t,a){var o=a,r,n;for(r=0;r<t.length;r++)if(t[r].render.visible){var l=t[r].parts;for(n=1<l.length?1:0;n<l.length;n++){var s=l[n];o.font="12px Arial",o.fillStyle="rgba(255,255,255,0.5)",o.fillText(s.id,s.position.x+10,s.position.y-10)}}},a.collisions=function(e,t,a){var o=a,r=e.options,n,l,s,d;for(o.beginPath(),s=0;s<t.length;s++)if(n=t[s],n.isActive)for(l=n.collision,d=0;d<n.activeContacts.length;d++){var c=n.activeContacts[d],p=c.vertex;o.rect(p.x-1.5,p.y-1.5,3.5,3.5)}for(o.fillStyle=r.wireframes?"rgba(255,255,255,0.7)":"orange",o.fill(),o.beginPath(),s=0;s<t.length;s++)if(n=t[s],n.isActive&&(l=n.collision,0<n.activeContacts.length)){var u=n.activeContacts[0].vertex.x,g=n.activeContacts[0].vertex.y;2===n.activeContacts.length&&(u=(n.activeContacts[0].vertex.x+n.activeContacts[1].vertex.x)/2,g=(n.activeContacts[0].vertex.y+n.activeContacts[1].vertex.y)/2),l.bodyB===l.supports[0].body||!0===l.bodyA.isStatic?o.moveTo(u-8*l.normal.x,g-8*l.normal.y):o.moveTo(u+8*l.normal.x,g+8*l.normal.y),o.lineTo(u,g)}o.strokeStyle=r.wireframes?"rgba(255,165,0,0.7)":"orange",o.lineWidth=1,o.stroke()},a.separations=function(e,t,a){var o=a,r=e.options,n,l,s,d,c;for(o.beginPath(),c=0;c<t.length;c++)if(n=t[c],n.isActive){l=n.collision,s=l.bodyA,d=l.bodyB;var p=1;d.isStatic||s.isStatic||(p=.5),d.isStatic&&(p=0),o.moveTo(d.position.x,d.position.y),o.lineTo(d.position.x-l.penetration.x*p,d.position.y-l.penetration.y*p),p=1,d.isStatic||s.isStatic||(p=.5),s.isStatic&&(p=0),o.moveTo(s.position.x,s.position.y),o.lineTo(s.position.x+l.penetration.x*p,s.position.y+l.penetration.y*p)}o.strokeStyle=r.wireframes?"rgba(255,165,0,0.5)":"orange",o.stroke()},a.grid=function(e,t,a){var r=a,n=e.options;r.strokeStyle=n.wireframes?"rgba(255,180,0,0.1)":"rgba(255,180,0,0.5)",r.beginPath();for(var l=o.keys(t.buckets),s=0,d;s<l.length;s++)if(d=l[s],!(2>t.buckets[d].length)){var c=d.split(/C|R/);r.rect(.5+parseInt(c[1],10)*t.bucketWidth,.5+parseInt(c[2],10)*t.bucketHeight,t.bucketWidth,t.bucketHeight)}r.lineWidth=1,r.stroke()},a.inspector=function(e,t){var a=e.engine,o=e.selected,r=e.render,n=r.options,l;if(n.hasBounds){var d=r.bounds.max.x-r.bounds.min.x,c=r.bounds.max.y-r.bounds.min.y,p=d/r.options.width,u=c/r.options.height;t.scale(1/p,1/u),t.translate(-r.bounds.min.x,-r.bounds.min.y)}for(var g=0,m;g<o.length;g++){switch(m=o[g].data,t.translate(.5,.5),t.lineWidth=1,t.strokeStyle="rgba(255,165,0,0.9)",t.setLineDash([1,2]),m.type){case"body":l=m.bounds,t.beginPath(),t.rect(h(l.min.x-3),h(l.min.y-3),h(l.max.x-l.min.x+6),h(l.max.y-l.min.y+6)),t.closePath(),t.stroke();break;case"constraint":var y=m.pointA;m.bodyA&&(y=m.pointB),t.beginPath(),t.arc(y.x,y.y,10,0,2*s),t.closePath(),t.stroke();}t.setLineDash([]),t.translate(-.5,-.5)}null!==e.selectStart&&(t.translate(.5,.5),t.lineWidth=1,t.strokeStyle="rgba(255,165,0,0.6)",t.fillStyle="rgba(255,165,0,0.1)",l=e.selectBounds,t.beginPath(),t.rect(h(l.min.x),h(l.min.y),h(l.max.x-l.min.x),h(l.max.y-l.min.y)),t.closePath(),t.stroke(),t.fill(),t.translate(-.5,-.5)),n.hasBounds&&t.setTransform(1,0,0,1,0,0)};var i=function(e,t){var a=document.createElement("canvas");return a.width=e,a.height=t,a.oncontextmenu=function(){return!1},a.onselectstart=function(){return!1},a},y=function(e){var t=e.getContext("2d"),a=window.devicePixelRatio||1,o=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return a/o},f=function(e,t){var a=e.textures[t];return a?a:(a=e.textures[t]=new Image,a.src=t,a)},x=function(e,t){var a=t;/(jpg|gif|png)$/.test(t)&&(a="url("+t+")"),e.canvas.style.background=a,e.canvas.style.backgroundSize="contain",e.currentBackground=t}})()},{"../body/Composite":2,"../collision/Grid":6,"../core/Common":14,"../core/Events":16,"../core/Mouse":19,"../geometry/Bounds":26,"../geometry/Vector":28}],32:[function(e,t){var a={};t.exports=a;var o=e("../geometry/Bounds"),r=e("../body/Composite"),i=e("../core/Common"),n=e("../core/Events"),l=e("../geometry/Vector");(function(){var e,t;"undefined"!=typeof window&&(e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(function(){e(i.now())},1e3/60)},t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),a.create=function(e){i.warn("RenderPixi.create: Matter.RenderPixi is deprecated (see docs)");var t=i.extend({controller:a,engine:null,element:null,frameRequestId:null,canvas:null,renderer:null,container:null,spriteContainer:null,pixiOptions:null,options:{width:800,height:600,background:"#fafafa",wireframeBackground:"#222",hasBounds:!1,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1}},e),o=!t.options.wireframes&&"transparent"===t.options.background;return t.pixiOptions=t.pixiOptions||{view:t.canvas,transparent:o,antialias:!0,backgroundColor:e.background},t.mouse=e.mouse,t.engine=e.engine,t.renderer=t.renderer||new PIXI.WebGLRenderer(t.options.width,t.options.height,t.pixiOptions),t.container=t.container||new PIXI.Container,t.spriteContainer=t.spriteContainer||new PIXI.Container,t.canvas=t.canvas||t.renderer.view,t.bounds=t.bounds||{min:{x:0,y:0},max:{x:t.options.width,y:t.options.height}},n.on(t.engine,"beforeUpdate",function(){a.clear(t)}),t.textures={},t.sprites={},t.primitives={},t.container.addChild(t.spriteContainer),i.isElement(t.element)?t.element.appendChild(t.canvas):i.warn("No \"render.element\" passed, \"render.canvas\" was not inserted into document."),t.canvas.oncontextmenu=function(){return!1},t.canvas.onselectstart=function(){return!1},t},a.run=function(t){(function o(){t.frameRequestId=e(o),a.world(t)})()},a.stop=function(e){t(e.frameRequestId)},a.clear=function(e){for(var t=e.container,a=e.spriteContainer;t.children[0];)t.removeChild(t.children[0]);for(;a.children[0];)a.removeChild(a.children[0]);var o=e.sprites["bg-0"];e.textures={},e.sprites={},e.primitives={},e.sprites["bg-0"]=o,o&&t.addChildAt(o,0),e.container.addChild(e.spriteContainer),e.currentBackground=null,t.scale.set(1,1),t.position.set(0,0)},a.setBackground=function(e,t){if(e.currentBackground!==t){var a=t.indexOf&&-1!==t.indexOf("#"),o=e.sprites["bg-0"];if(a){var r=i.colorToNumber(t);e.renderer.backgroundColor=r,o&&e.container.removeChild(o)}else if(!o){var n=c(e,t);o=e.sprites["bg-0"]=new PIXI.Sprite(n),o.position.x=0,o.position.y=0,e.container.addChildAt(o,0)}e.currentBackground=t}},a.world=function(e){var t=e.engine,n=t.world,s=e.renderer,d=e.container,c=e.options,p=r.allBodies(n),u=r.allConstraints(n),g=[],m;c.wireframes?a.setBackground(e,c.wireframeBackground):a.setBackground(e,c.background);var h=e.bounds.max.x-e.bounds.min.x,y=e.bounds.max.y-e.bounds.min.y,f=h/e.options.width,x=y/e.options.height;if(c.hasBounds){for(m=0;m<p.length;m++){var _=p[m];_.render.sprite.visible=o.overlaps(_.bounds,e.bounds)}for(m=0;m<u.length;m++){var b=u[m],v=b.bodyA,w=b.bodyB,k=b.pointA,T=b.pointB;v&&(k=l.add(v.position,b.pointA)),w&&(T=l.add(w.position,b.pointB)),k&&T&&(o.contains(e.bounds,k)||o.contains(e.bounds,T))&&g.push(b)}d.scale.set(1/f,1/x),d.position.set(-e.bounds.min.x*(1/f),-e.bounds.min.y*(1/x))}else g=u;for(m=0;m<p.length;m++)a.body(e,p[m]);for(m=0;m<g.length;m++)a.constraint(e,g[m]);s.render(d)},a.constraint=function(e,t){var a=e.engine,o=t.bodyA,r=t.bodyB,n=t.pointA,l=t.pointB,s=e.container,d=t.render,c="c-"+t.id,p=e.primitives[c];return p||(p=e.primitives[c]=new PIXI.Graphics),d.visible&&t.pointA&&t.pointB?void(-1===i.indexOf(s.children,p)&&s.addChild(p),p.clear(),p.beginFill(0,0),p.lineStyle(d.lineWidth,i.colorToNumber(d.strokeStyle),1),o?p.moveTo(o.position.x+n.x,o.position.y+n.y):p.moveTo(n.x,n.y),r?p.lineTo(r.position.x+l.x,r.position.y+l.y):p.lineTo(l.x,l.y),p.endFill()):void p.clear()},a.body=function(e,t){var a=e.engine,o=t.render;if(o.visible)if(o.sprite&&o.sprite.texture){var r="b-"+t.id,n=e.sprites[r],l=e.spriteContainer;n||(n=e.sprites[r]=s(e,t)),-1===i.indexOf(l.children,n)&&l.addChild(n),n.position.x=t.position.x,n.position.y=t.position.y,n.rotation=t.angle,n.scale.x=o.sprite.xScale||1,n.scale.y=o.sprite.yScale||1}else{var c="b-"+t.id,p=e.primitives[c],u=e.container;p||(p=e.primitives[c]=d(e,t),p.initialAngle=t.angle),-1===i.indexOf(u.children,p)&&u.addChild(p),p.position.x=t.position.x,p.position.y=t.position.y,p.rotation=t.angle-p.initialAngle}};var s=function(e,t){var a=t.render,o=a.sprite.texture,r=c(e,o),i=new PIXI.Sprite(r);return i.anchor.x=t.render.sprite.xOffset,i.anchor.y=t.render.sprite.yOffset,i},d=function(e,t){var a=t.render,o=e.options,r=new PIXI.Graphics,n=i.colorToNumber(a.fillStyle),l=i.colorToNumber(a.strokeStyle),s=i.colorToNumber(a.strokeStyle),d=i.colorToNumber("#bbb"),c=i.colorToNumber("#CD5C5C"),p;r.clear();for(var u=1<t.parts.length?1:0;u<t.parts.length;u++){p=t.parts[u],o.wireframes?(r.beginFill(0,0),r.lineStyle(1,d,1)):(r.beginFill(n,1),r.lineStyle(a.lineWidth,l,1)),r.moveTo(p.vertices[0].x-t.position.x,p.vertices[0].y-t.position.y);for(var g=1;g<p.vertices.length;g++)r.lineTo(p.vertices[g].x-t.position.x,p.vertices[g].y-t.position.y);r.lineTo(p.vertices[0].x-t.position.x,p.vertices[0].y-t.position.y),r.endFill(),(o.showAngleIndicator||o.showAxes)&&(r.beginFill(0,0),o.wireframes?r.lineStyle(1,c,1):r.lineStyle(1,s),r.moveTo(p.position.x-t.position.x,p.position.y-t.position.y),r.lineTo((p.vertices[0].x+p.vertices[p.vertices.length-1].x)/2-t.position.x,(p.vertices[0].y+p.vertices[p.vertices.length-1].y)/2-t.position.y),r.endFill())}return r},c=function(e,t){var a=e.textures[t];return a||(a=e.textures[t]=PIXI.Texture.fromImage(t)),a}})()},{"../body/Composite":2,"../core/Common":14,"../core/Events":16,"../geometry/Bounds":26,"../geometry/Vector":28}]},{},[30])(30)})}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{}],408:[function(e,t,a){/*!
 * matter-wrap 0.2.0 by Liam Brummitt 2017-07-04
 * https://github.com/liabru/matter-wrap
 * License MIT
 */(function(o,r){"object"==typeof a&&"object"==typeof t?t.exports=r(e("matter-js")):"function"==typeof define&&define.amd?define(["matter-js"],r):"object"==typeof a?a.MatterWrap=r(e("matter-js")):o.MatterWrap=r(o.Matter)})(this,function(e){return function(e){function t(o){if(a[o])return a[o].exports;var r=a[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var a={};return t.m=e,t.c=a,t.i=function(e){return e},t.d=function(e,a,o){t.o(e,a)||Object.defineProperty(e,a,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var a=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(a,"a",a),a},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/libs",t(t.s=1)}([function(t){t.exports=e},function(e,t,a){"use strict";var o=a(0),r={name:"matter-wrap",version:"0.1.3",for:"matter-js@^0.12.0",install:function(e){e.after("Engine.update",function(){r.Engine.update(this)})},Engine:{update:function(e){for(var t=e.world,a=o.Composite.allBodies(t),n=o.Composite.allComposites(t),l=0,s;l<a.length;l+=1)s=a[l],s.plugin.wrap&&r.Body.wrap(s,s.plugin.wrap);for(l=0;l<n.length;l+=1){var d=n[l];d.plugin.wrap&&r.Composite.wrap(d,d.plugin.wrap)}}},Bounds:{wrap:function(e,t){var a=null,o=null;if("undefined"!=typeof t.min.x&&"undefined"!=typeof t.max.x&&(e.min.x>t.max.x?a=t.min.x-e.max.x:e.max.x<t.min.x&&(a=t.max.x-e.min.x)),"undefined"!=typeof t.min.y&&"undefined"!=typeof t.max.y&&(e.min.y>t.max.y?o=t.min.y-e.max.y:e.max.y<t.min.y&&(o=t.max.y-e.min.y)),null!==a||null!==o)return{x:a||0,y:o||0}}},Body:{wrap:function(e,t){var a=r.Bounds.wrap(e.bounds,t);return a&&o.Body.translate(e,a),a}},Composite:{bounds:function(e){for(var t=o.Composite.allBodies(e),a=[],r=0,n;r<t.length;r+=1)n=t[r],a.push(n.bounds.min,n.bounds.max);return o.Bounds.create(a)},wrap:function(e,t){var a=r.Bounds.wrap(r.Composite.bounds(e),t);return a&&o.Composite.translate(e,a),a}}};o.Plugin.register(r),e.exports=r}])})},{"matter-js":407}],409:[function(e,t){'use strict';t.exports=function(e){var t=e.length;if(3>t){for(var o=Array(t),r=0;r<t;++r)o[r]=r;return 2===t&&e[0][0]===e[1][0]&&e[0][1]===e[1][1]?[0]:o}for(var n=Array(t),r=0;r<t;++r)n[r]=r;n.sort(function(t,a){var o=e[t][0]-e[a][0];return o?o:e[t][1]-e[a][1]});for(var l=[n[0],n[1]],s=[n[0],n[1]],r=2;r<t;++r){for(var d=n[r],c=e[d],p=l.length;1<p&&0>=a(e[l[p-2]],e[l[p-1]],c);)p-=1,l.pop();for(l.push(d),p=s.length;1<p&&0<=a(e[s[p-2]],e[s[p-1]],c);)p-=1,s.pop();s.push(d)}for(var o=Array(s.length+l.length-2),u=0,r=0,g=l.length;r<g;++r)o[u++]=l[r];for(var h=s.length-2;0<h;--h)o[u++]=s[h];return o};var a=e("robust-orientation")[3]},{"robust-orientation":1277}],410:[function(e,t){'use strict';t.exports=function(e,t){function o(e){var t=!1;return"altKey"in e&&(t=t||e.altKey!==f.alt,f.alt=!!e.altKey),"shiftKey"in e&&(t=t||e.shiftKey!==f.shift,f.shift=!!e.shiftKey),"ctrlKey"in e&&(t=t||e.ctrlKey!==f.control,f.control=!!e.ctrlKey),"metaKey"in e&&(t=t||e.metaKey!==f.meta,f.meta=!!e.metaKey),t}function r(e,r){var i=a.x(r),n=a.y(r);"buttons"in r&&(e=0|r.buttons),(e!==g||i!==m||n!==h||o(r))&&(g=0|e,m=i||0,h=n||0,t&&t(g,m,h,f))}function i(e){r(0,e)}function n(){(g||m||h||f.shift||f.alt||f.meta||f.control)&&(m=h=0,g=0,f.shift=f.alt=f.control=f.meta=!1,t&&t(0,0,0,f))}function l(e){o(e)&&t&&t(g,m,h,f)}function s(e){0===a.buttons(e)?r(0,e):r(g,e)}function d(e){r(g|a.buttons(e),e)}function c(e){r(g&~a.buttons(e),e)}function p(){_||(_=!0,e.addEventListener("mousemove",s),e.addEventListener("mousedown",d),e.addEventListener("mouseup",c),e.addEventListener("mouseleave",i),e.addEventListener("mouseenter",i),e.addEventListener("mouseout",i),e.addEventListener("mouseover",i),e.addEventListener("blur",n),e.addEventListener("keyup",l),e.addEventListener("keydown",l),e.addEventListener("keypress",l),e!==window&&(window.addEventListener("blur",n),window.addEventListener("keyup",l),window.addEventListener("keydown",l),window.addEventListener("keypress",l)))}function u(){_&&(_=!1,e.removeEventListener("mousemove",s),e.removeEventListener("mousedown",d),e.removeEventListener("mouseup",c),e.removeEventListener("mouseleave",i),e.removeEventListener("mouseenter",i),e.removeEventListener("mouseout",i),e.removeEventListener("mouseover",i),e.removeEventListener("blur",n),e.removeEventListener("keyup",l),e.removeEventListener("keydown",l),e.removeEventListener("keypress",l),e!==window&&(window.removeEventListener("blur",n),window.removeEventListener("keyup",l),window.removeEventListener("keydown",l),window.removeEventListener("keypress",l)))}t||(t=e,e=window);var g=0,m=0,h=0,f={shift:!1,alt:!1,control:!1,meta:!1},_=!1;p();var b={element:e};return Object.defineProperties(b,{enabled:{get:function(){return _},set:function(e){e?p():u()},enumerable:!0},buttons:{get:function(){return g},enumerable:!0},x:{get:function(){return m},enumerable:!0},y:{get:function(){return h},enumerable:!0},mods:{get:function(){return f},enumerable:!0}}),b};var a=e("mouse-event")},{"mouse-event":412}],411:[function(e,t){function a(e){return e===window||e===document||e===document.body?o:e.getBoundingClientRect()}var o={left:0,top:0};t.exports=function(e,t,o){t=t||e.currentTarget||e.srcElement,Array.isArray(o)||(o=[0,0]);var r=e.clientX||0,i=e.clientY||0,n=a(t);return o[0]=r-n.left,o[1]=i-n.top,o}},{}],412:[function(e,t,a){'use strict';function o(e){if("object"==typeof e){if("buttons"in e)return e.buttons;if("which"in e){var t=e.which;if(2===t)return 4;if(3===t)return 2;if(0<t)return 1<<t-1}else if("button"in e){var t=e.button;if(1===t)return 4;if(2===t)return 2;if(0<=t)return 1<<t}}return 0}function r(e){return e.target||e.srcElement||window}function i(e){if("object"==typeof e){if("offsetX"in e)return e.offsetX;var t=r(e),a=t.getBoundingClientRect();return e.clientX-a.left}return 0}function n(e){if("object"==typeof e){if("offsetY"in e)return e.offsetY;var t=r(e),a=t.getBoundingClientRect();return e.clientY-a.top}return 0}a.buttons=o,a.element=r,a.x=i,a.y=n},{}],413:[function(e,t){'use strict';var a=e("to-px");t.exports=function(e,t,o){"function"==typeof e&&(o=!!t,t=e,e=window);var r=a("ex",e),i=function(e){o&&e.preventDefault();var a=e.deltaX||0,i=e.deltaY||0,n=e.deltaZ||0,l=e.deltaMode,s=1;if(1===l?s=r:2===l?s=window.innerHeight:void 0,a*=s,i*=s,n*=s,a||i||n)return t(a,i,n,e)};return e.addEventListener("wheel",i),i}},{"to-px":1311}],414:[function(e,t){"use strict";function a(e){return"a"+e}function o(e){return"d"+e}function r(e,t){return"c"+e+"_"+t}function n(e){return"s"+e}function l(e,t){return"t"+e+"_"+t}function s(e){return"o"+e}function d(e){return"x"+e}function c(e){return"p"+e}function p(e,t){return"d"+e+"_"+t}function u(e){return"i"+e}function g(e,t){return"u"+e+"_"+t}function m(e){return"b"+e}function h(e){return"y"+e}function y(e){return"e"+e}function f(e){return"v"+e}function x(e,t,a){for(var o=0,n=0;n<e;++n)t&1<<n&&(o|=1<<a[n]);return o}function _(e,t,_,v,w,T){function A(e,t){O.push("for(",u(w[e]),"=",t,";",u(w[e]),"<",n(w[e]),";","++",u(w[e]),"){")}function S(e){for(var t=0;t<P;++t)O.push(c(t),"+=",g(t,w[e]),";");O.push("}")}function C(e){for(var t=e-1;0<=t;--t)A(t,0);for(var a=[],t=0;t<P;++t)T[t]?a.push(o(t)+".get("+c(t)+")"):a.push(o(t)+"["+c(t)+"]");for(var t=0;t<v;++t)a.push(d(t));O.push("P","[","X","++]=phase(",a.join(),");");for(var t=0;t<e;++t)S(t);for(var r=0;r<P;++r)O.push(c(r),"+=",g(r,w[e]),";")}function L(e){for(var t=0;t<P;++t)T[t]?O.push(r(t,0),"=",o(t),".get(",c(t),");"):O.push(r(t,0),"=",o(t),"[",c(t),"];");for(var a=[],t=0;t<P;++t)a.push(r(t,0));for(var t=0;t<v;++t)a.push(d(t));O.push(m(0),"=","P","[","X","]=phase(",a.join(),");");for(var n=1;n<1<<z;++n)O.push(m(n),"=","P","[","X","+",y(n),"];");for(var l=[],n=1;n<1<<z;++n)l.push("("+m(0)+"!=="+m(n)+")");O.push("if(",l.join("||"),"){");for(var s=[],t=0;t<z;++t)s.push(u(t));for(var t=0;t<P;++t){s.push(r(t,0));for(var n=1;n<1<<z;++n)T[t]?O.push(r(t,n),"=",o(t),".get(",c(t),"+",p(t,n),");"):O.push(r(t,n),"=",o(t),"[",c(t),"+",p(t,n),"];"),s.push(r(t,n))}for(var t=0;t<1<<z;++t)s.push(m(t));for(var t=0;t<v;++t)s.push(d(t));O.push("vertex(",s.join(),");",f(0),"=","V","[","X","]=","N","++;");for(var g=(1<<z)-1,h=m(g),n=0;n<z;++n)if(0==(e&~(1<<n))){for(var x=g^1<<n,_=m(x),b=[],w=x;0<w;w=w-1&x)b.push("V[X+"+y(w)+"]");b.push(f(0));for(var w=0;w<P;++w)1&n?b.push(r(w,g),r(w,x)):b.push(r(w,x),r(w,g));1&n?b.push(h,_):b.push(_,h);for(var w=0;w<v;++w)b.push(d(w));O.push("if(",h,"!==",_,"){","face(",b.join(),")}")}O.push("}","X","+=1;")}function E(){for(var e=1;e<1<<z;++e)O.push("T","=",y(e),";",y(e),"=",h(e),";",h(e),"=","T",";")}function I(e,t){if(0>e)return void L(t);C(e),O.push("if(",n(w[e]),">0){",u(w[e]),"=1;"),I(e-1,t|1<<w[e]);for(var a=0;a<P;++a)O.push(c(a),"+=",g(a,w[e]),";");e===z-1&&(O.push("X","=0;"),E()),A(e,2),I(e-1,t),e===z-1&&(O.push("if(",u(w[z-1]),"&1){","X","=0;}"),E()),S(e),O.push("}")}var P=T.length,z=w.length;if(2>z)throw new Error("ndarray-extract-contour: Dimension must be at least 2");for(var D="extractContour"+w.join("_"),O=[],R=[],M=[],B=0;B<P;++B)M.push(a(B));for(var B=0;B<v;++B)M.push(d(B));for(var B=0;B<z;++B)R.push(n(B)+"="+a(0)+".shape["+B+"]|0");for(var B=0;B<P;++B){R.push(o(B)+"="+a(B)+".data",s(B)+"="+a(B)+".offset|0");for(var F=0;F<z;++F)R.push(l(B,F)+"="+a(B)+".stride["+F+"]|0")}for(var B=0;B<P;++B){R.push(c(B)+"="+s(B)),R.push(r(B,0));for(var F=1,N;F<1<<z;++F){N=[];for(var V=0;V<z;++V)F&1<<V&&N.push("-"+l(B,V));R.push(p(B,F)+"=("+N.join("")+")|0"),R.push(r(B,F)+"=0")}}for(var B=0;B<P;++B)for(var F=0,U;F<z;++F)U=[l(B,w[F])],0<F&&U.push(l(B,w[F-1])+"*"+n(w[F-1])),R.push(g(B,w[F])+"=("+U.join("-")+")|0");for(var B=0;B<z;++B)R.push(u(B)+"=0");R.push("N=0");for(var H=["2"],B=z-2;0<=B;--B)H.push(n(w[B]));R.push("Q=("+H.join("*")+")|0","P=mallocUint32(Q)","V=mallocUint32(Q)","X=0"),R.push(m(0)+"=0");for(var F=1;F<1<<z;++F){for(var q=[],G=[],V=0;V<z;++V)F&1<<V&&(0===G.length?q.push("1"):q.unshift(G.join("*"))),G.push(n(w[V]));var Y="";0>q[0].indexOf(n(w[z-2]))&&(Y="-");var W=x(z,F,w);R.push(y(W)+"=(-"+q.join("-")+")|0",h(W)+"=("+Y+q.join("-")+")|0",m(W)+"=0")}R.push(f(0)+"=0","T=0"),I(z-1,0),O.push("freeUint32(","V",");freeUint32(","P",");");var X=["'use strict';","function ",D,"(",M.join(),"){","var ",R.join(),";",O.join(""),"}","return ",D].join(""),Z=new Function("vertex","face","phase","mallocUint32","freeUint32",X);return Z(e,t,_,b.mallocUint32,b.freeUint32)}var b=e("typedarray-pool");t.exports=function(e){function t(e){throw new Error("ndarray-extract-contour: "+e)}"object"!=typeof e&&t("Must specify arguments");var a=e.order;Array.isArray(a)||t("Must specify order");var o=e.arrayArguments||1;1>o&&t("Must have at least one array argument");var r=e.scalarArguments||0;0>r&&t("Scalar arg count must be > 0"),"function"!=typeof e.vertex&&t("Must specify vertex creation function"),"function"!=typeof e.cell&&t("Must specify cell creation function"),"function"!=typeof e.phase&&t("Must specify phase function");for(var n=e.getters||[],l=Array(o),s=0;s<o;++s)l[s]=!!(0<=n.indexOf(s));return _(e.vertex,e.cell,e.phase,r,a,l)}},{"typedarray-pool":1328}],415:[function(e,t){"use strict";var a=e("cwise/lib/wrapper")({args:["index","array","scalar"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{_inline_1_arg1_=_inline_1_arg2_.apply(void 0,_inline_1_arg0_)}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg1_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:[],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:!1,funcName:"cwise",blockSize:64});t.exports=function(e,t){return a(e,t),e}},{"cwise/lib/wrapper":96}],416:[function(e,t){'use strict';var r=Math.abs;function a(e){if(e in s)return s[e];for(var t=[],a=0;a<e;++a)t.push("out",a,"s=0.5*(inp",a,"l-inp",a,"r);");for(var r=["array"],d=["junk"],a=0;a<e;++a){r.push("array"),d.push("out"+a+"s");var c=n(e);c[a]=-1,r.push({array:0,offset:c.slice()}),c[a]=1,r.push({array:0,offset:c.slice()}),d.push("inp"+a+"l","inp"+a+"r")}return s[e]=l({args:r,pre:p,post:p,body:{body:t.join(""),args:d.map(function(e){return{name:e,lvalue:0===e.indexOf("out"),rvalue:0===e.indexOf("inp"),count:0|"junk"!==e}}),thisVars:[],localVars:[]},funcName:"fdTemplate"+e})}function o(e){function t(t){for(var a=l-t.length,o=[],n=[],s=[],c=0;c<l;++c)0<=t.indexOf(c+1)?s.push("0"):0<=t.indexOf(-(c+1))?s.push("s["+c+"]-1"):(s.push("-1"),o.push("1"),n.push("s["+c+"]-2"));var p=".lo("+o.join()+").hi("+n.join()+")";if(0===o.length&&(p=""),0<a){d.push("if(1");for(var c=0;c<l;++c)0<=t.indexOf(c+1)||0<=t.indexOf(-(c+1))||d.push("&&s[",c,"]>2");d.push("){grad",a,"(src.pick(",s.join(),")",p);for(var c=0;c<l;++c)0<=t.indexOf(c+1)||0<=t.indexOf(-(c+1))||d.push(",dst.pick(",s.join(),",",c,")",p);d.push(");")}for(var c=0;c<t.length;++c){var u=r(t[c])-1,g="dst.pick("+s.join()+","+u+")"+p;switch(e[u]){case"clamp":var m=s.slice(),h=s.slice();0>t[c]?m[u]="s["+u+"]-2":h[u]="1",0===a?d.push("if(s[",u,"]>1){dst.set(",s.join(),",",u,",0.5*(src.get(",m.join(),")-src.get(",h.join(),")))}else{dst.set(",s.join(),",",u,",0)};"):d.push("if(s[",u,"]>1){diff(",g,",src.pick(",m.join(),")",p,",src.pick(",h.join(),")",p,");}else{zero(",g,");};");break;case"mirror":0===a?d.push("dst.set(",s.join(),",",u,",0);"):d.push("zero(",g,");");break;case"wrap":var y=s.slice(),f=s.slice();0>t[c]?(y[u]="s["+u+"]-2",f[u]="0"):(y[u]="s["+u+"]-1",f[u]="1"),0===a?d.push("if(s[",u,"]>2){dst.set(",s.join(),",",u,",0.5*(src.get(",y.join(),")-src.get(",f.join(),")))}else{dst.set(",s.join(),",",u,",0)};"):d.push("if(s[",u,"]>2){diff(",g,",src.pick(",y.join(),")",p,",src.pick(",f.join(),")",p,");}else{zero(",g,");};");break;default:throw new Error("ndarray-gradient: Invalid boundary condition");}}0<a&&d.push("};")}var o=e.join(),n=c[o];if(n)return n;for(var l=e.length,d=["function gradient(dst,src){var s=src.shape.slice();"],p=0,m;p<1<<l;++p){m=[];for(var h=0;h<l;++h)p&1<<h&&m.push(h+1);for(var y=0,f;y<1<<m.length;++y){f=m.slice();for(var h=0;h<m.length;++h)y&1<<h&&(f[h]=-f[h]);t(f)}}d.push("return dst;};return gradient");for(var x=["diff","zero"],_=[u,g],p=1;p<=l;++p)x.push("grad"+p),_.push(a(p));x.push(d.join(""));var b=Function.apply(void 0,x),n=b.apply(void 0,_);return s[o]=n,n}t.exports=function(e,t,a){if(!Array.isArray(a))a="string"==typeof a?n(t.dimension,a):n(t.dimension,"clamp");else if(a.length!==t.dimension)throw new Error("ndarray-gradient: invalid boundary conditions");if(e.dimension!==t.dimension+1)throw new Error("ndarray-gradient: output dimension must be +1 input dimension");if(e.shape[t.dimension]!==t.dimension)throw new Error("ndarray-gradient: output shape must match input shape");for(var r=0;r<t.dimension;++r)if(e.shape[r]!==t.shape[r])throw new Error("ndarray-gradient: shape mismatch");if(0===t.size)return e;if(0>=t.dimension)return e.set(0),e;var l=o(a);return l(e,t)};var n=e("dup"),l=e("cwise-compiler"),s={},c={},p={body:"",args:[],thisVars:[],localVars:[]},u=l({args:["array","array","array"],pre:p,post:p,body:{args:[{name:"out",lvalue:!0,rvalue:!1,count:1},{name:"left",lvalue:!1,rvalue:!0,count:1},{name:"right",lvalue:!1,rvalue:!0,count:1}],body:"out=0.5*(left-right)",thisVars:[],localVars:[]},funcName:"cdiff"}),g=l({args:["array"],pre:p,post:p,body:{args:[{name:"out",lvalue:!0,rvalue:!1,count:1}],body:"out=0",thisVars:[],localVars:[]},funcName:"zero"})},{"cwise-compiler":93,dup:116}],417:[function(e,t){'use strict';var a=e("ndarray-warp"),o=e("gl-matrix-invert");t.exports=function(e,t,r){var l=t.dimension,n=o([],r);return a(e,t,function(e,t){for(var a=0;a<l;++a){e[a]=n[(l+1)*l+a];for(var o=0;o<l;++o)e[a]+=n[(l+1)*o+a]*t[o]}for(var r=n[(l+1)*(l+1)-1],o=0;o<l;++o)r+=n[(l+1)*o+l]*t[o];for(var s=1/r,a=0;a<l;++a)e[a]*=s;return e}),e}},{"gl-matrix-invert":254,"ndarray-warp":424}],418:[function(e,t){"use strict";var n=Math.floor;function a(e,t){var a=n(t),o=t-a,r=0<=a&&a<e.shape[0],i=0<=a+1&&a+1<e.shape[0],l=r?+e.get(a):0,s=i?+e.get(a+1):0;return(1-o)*l+o*s}function o(e,t,a){var o=n(t),r=t-o,i=0<=o&&o<e.shape[0],l=0<=o+1&&o+1<e.shape[0],s=n(a),d=a-s,c=0<=s&&s<e.shape[1],p=0<=s+1&&s+1<e.shape[1],u=i&&c?e.get(o,s):0,g=i&&p?e.get(o,s+1):0,m=l&&c?e.get(o+1,s):0,h=l&&p?e.get(o+1,s+1):0;return(1-d)*((1-r)*u+r*m)+d*((1-r)*g+r*h)}function r(e,t,a,o){var r=n(t),i=t-r,l=0<=r&&r<e.shape[0],s=0<=r+1&&r+1<e.shape[0],d=n(a),c=a-d,p=0<=d&&d<e.shape[1],u=0<=d+1&&d+1<e.shape[1],g=n(o),m=o-g,h=0<=g&&g<e.shape[2],y=0<=g+1&&g+1<e.shape[2],f=l&&p&&h?e.get(r,d,g):0,x=l&&u&&h?e.get(r,d+1,g):0,_=s&&p&&h?e.get(r+1,d,g):0,b=s&&u&&h?e.get(r+1,d+1,g):0,v=l&&p&&y?e.get(r,d,g+1):0,w=l&&u&&y?e.get(r,d+1,g+1):0,k=s&&p&&y?e.get(r+1,d,g+1):0,T=s&&u&&y?e.get(r+1,d+1,g+1):0;return(1-m)*((1-c)*((1-i)*f+i*_)+c*((1-i)*x+i*b))+m*((1-c)*((1-i)*v+i*k)+c*((1-i)*w+i*T))}function i(e){var a=0|e.shape.length,o=Array(a),l=Array(a),s=Array(a),d=Array(a),c,p;for(c=0;c<a;++c)p=+arguments[c+1],o[c]=n(p),l[c]=p-o[c],s[c]=0<=o[c]&&o[c]<e.shape[c],d[c]=0<=o[c]+1&&o[c]+1<e.shape[c];var u=0,g,m,h;i_loop:for(c=0;c<1<<a;++c){for(m=1,h=e.offset,g=0;g<a;++g)if(c&1<<g){if(!d[g])continue i_loop;m*=l[g],h+=e.stride[g]*(o[g]+1)}else{if(!s[g])continue i_loop;m*=1-l[g],h+=e.stride[g]*o[g]}u+=m*e.data[h]}return u}t.exports=function(e,t,n,l){switch(e.shape.length){case 0:return 0;case 1:return a(e,t);case 2:return o(e,t,n);case 3:return r(e,t,n,l);default:return i.apply(void 0,arguments);}},t.exports.d1=a,t.exports.d2=o,t.exports.d3=r},{}],419:[function(e,t,a){"use strict";function o(e){if(!e)return s;for(var t=0,o;t<e.args.length;++t)o=e.args[t],e.args[t]=0==t?{name:o,lvalue:!0,rvalue:!!e.rvalue,count:e.count||1}:{name:o,lvalue:!1,rvalue:!0,count:1};return e.thisVars||(e.thisVars=[]),e.localVars||(e.localVars=[]),e}function r(e){return l({args:e.args,pre:o(e.pre),body:o(e.body),post:o(e.proc),funcName:e.funcName})}function n(e){for(var t=[],a=0;a<e.args.length;++a)t.push("a"+a);var o=new Function("P",["return function ",e.funcName,"_ndarrayops(",t.join(","),") {P(",t.join(","),");return a0}"].join(""));return o(r(e))}var l=e("cwise-compiler"),s={body:"",args:[],thisVars:[],localVars:[]},d={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};(function(){for(var e in d){var t=d[e];a[e]=n({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+t+"c"},funcName:e}),a[e+"eq"]=n({args:["array","array"],body:{args:["a","b"],body:"a"+t+"=b"},rvalue:!0,funcName:e+"eq"}),a[e+"s"]=n({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+t+"s"},funcName:e+"s"}),a[e+"seq"]=n({args:["array","scalar"],body:{args:["a","s"],body:"a"+t+"=s"},rvalue:!0,funcName:e+"seq"})}})();var c={not:"!",bnot:"~",neg:"-",recip:"1.0/"};(function(){for(var e in c){var t=c[e];a[e]=n({args:["array","array"],body:{args:["a","b"],body:"a="+t+"b"},funcName:e}),a[e+"eq"]=n({args:["array"],body:{args:["a"],body:"a="+t+"a"},rvalue:!0,count:2,funcName:e+"eq"})}})();var p={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};(function(){for(var e in p){var t=p[e];a[e]=n({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+t+"c"},funcName:e}),a[e+"s"]=n({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+t+"s"},funcName:e+"s"}),a[e+"eq"]=n({args:["array","array"],body:{args:["a","b"],body:"a=a"+t+"b"},rvalue:!0,count:2,funcName:e+"eq"}),a[e+"seq"]=n({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+t+"s"},rvalue:!0,count:2,funcName:e+"seq"})}})();var u=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];(function(){for(var e=0,t;e<u.length;++e)t=u[e],a[t]=n({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:t}),a[t+"eq"]=n({args:["array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"eq"})})();var g=["max","min","atan2","pow"];(function(){for(var e=0,t;e<g.length;++e)t=g[e],a[t]=n({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:t}),a[t+"s"]=n({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:t+"s"}),a[t+"eq"]=n({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"eq"}),a[t+"seq"]=n({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"seq"})})();var m=["atan2","pow"];(function(){for(var e=0,t;e<m.length;++e)t=m[e],a[t+"op"]=n({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:t+"op"}),a[t+"ops"]=n({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:t+"ops"}),a[t+"opeq"]=n({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"opeq"}),a[t+"opseq"]=n({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"opseq"})})(),a.any=l({args:["array"],pre:s,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),a.all=l({args:["array"],pre:s,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),a.sum=l({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),a.prod=l({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),a.norm2squared=l({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),a.norm2=l({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),a.norminf=l({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),a.norm1=l({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),a.sup=l({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),a.inf=l({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),a.argmin=l({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),a.argmax=l({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),a.random=n({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),a.assign=n({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),a.assigns=n({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),a.equals=l({args:["array","array"],pre:s,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},{"cwise-compiler":93}],420:[function(e,t){"use strict";var a=e("ndarray"),o=e("./doConvert.js");t.exports=function(e,t){for(var r=[],i=e,n=1;Array.isArray(i);)r.push(i.length),n*=i.length,i=i[0];return 0===r.length?a():(t||(t=a(new Float64Array(n),r)),o(t,e),t)}},{"./doConvert.js":421,ndarray:425}],421:[function(e,t){t.exports=e("cwise-compiler")({args:["array","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\nvar _inline_1_v=_inline_1_arg1_,_inline_1_i\nfor(_inline_1_i=0;_inline_1_i<_inline_1_arg2_.length-1;++_inline_1_i) {\n_inline_1_v=_inline_1_v[_inline_1_arg2_[_inline_1_i]]\n}\n_inline_1_arg0_=_inline_1_v[_inline_1_arg2_[_inline_1_arg2_.length-1]]\n}",args:[{name:"_inline_1_arg0_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:4}],thisVars:[],localVars:["_inline_1_i","_inline_1_v"]},post:{body:"{}",args:[],thisVars:[],localVars:[]},funcName:"convert",blockSize:64})},{"cwise-compiler":93}],422:[function(e,t){"use strict";function a(e){return"uint8"===e?[l.mallocUint8,l.freeUint8]:"uint16"===e?[l.mallocUint16,l.freeUint16]:"uint32"===e?[l.mallocUint32,l.freeUint32]:"int8"===e?[l.mallocInt8,l.freeInt8]:"int16"===e?[l.mallocInt16,l.freeInt16]:"int32"===e?[l.mallocInt32,l.freeInt32]:"float32"===e?[l.mallocFloat,l.freeFloat]:"float64"===e?[l.mallocDouble,l.freeDouble]:null}function o(e){for(var t=[],a=0;a<e;++a)t.push("s"+a);for(var a=0;a<e;++a)t.push("n"+a);for(var a=1;a<e;++a)t.push("d"+a);for(var a=1;a<e;++a)t.push("e"+a);for(var a=1;a<e;++a)t.push("f"+a);return t}function r(e,t){function r(e){return"generic"===t?["data.get(",e,")"].join(""):["data[",e,"]"].join("")}function n(e,a){return"generic"===t?["data.set(",e,",",a,")"].join(""):["data[",e,"]=",a].join("")}var l=["'use strict'"],s=["ndarrayInsertionSort",e.join("d"),t].join(""),d=["left","right","data","offset"].concat(o(e.length)),c=a(t),p=["i,j,cptr,ptr=left*s0+offset"];if(1<e.length){for(var u=[],g=1;g<e.length;++g)p.push("i"+g),u.push("n"+g);c?p.push("scratch=malloc("+u.join("*")+")"):p.push("scratch=new Array("+u.join("*")+")"),p.push("dptr","sptr","a","b")}else p.push("scratch");if(l.push(["function ",s,"(",d.join(","),"){var ",p.join(",")].join(""),"for(i=left+1;i<=right;++i){","j=i;ptr+=s0","cptr=ptr"),1<e.length){l.push("dptr=0;sptr=ptr");for(var g=e.length-1,m;0<=g;--g)(m=e[g],0!==m)&&l.push(["for(i",m,"=0;i",m,"<n",m,";++i",m,"){"].join(""));l.push("scratch[dptr++]=",r("sptr"));for(var g=0,m;g<e.length;++g)(m=e[g],0!==m)&&l.push("sptr+=d"+m,"}");l.push("__g:while(j-->left){","dptr=0","sptr=cptr-s0");for(var g=1;g<e.length;++g)1==g&&l.push("__l:"),l.push(["for(i",g,"=0;i",g,"<n",g,";++i",g,"){"].join(""));l.push(["a=",r("sptr"),"\nb=scratch[dptr]\nif(a<b){break __g}\nif(a>b){break __l}"].join(""));for(var g=e.length-1;1<=g;--g)l.push("sptr+=e"+g,"dptr+=f"+g,"}");l.push("dptr=cptr;sptr=cptr-s0");for(var g=e.length-1,m;0<=g;--g)(m=e[g],0!==m)&&l.push(["for(i",m,"=0;i",m,"<n",m,";++i",m,"){"].join(""));l.push(n("dptr",r("sptr")));for(var g=0,m;g<e.length;++g)(m=e[g],0!==m)&&l.push(["dptr+=d",m,";sptr+=d",m].join(""),"}");l.push("cptr-=s0\n}"),l.push("dptr=cptr;sptr=0");for(var g=e.length-1,m;0<=g;--g)(m=e[g],0!==m)&&l.push(["for(i",m,"=0;i",m,"<n",m,";++i",m,"){"].join(""));l.push(n("dptr","scratch[sptr++]"));for(var g=0,m;g<e.length;++g)(m=e[g],0!==m)&&l.push("dptr+=d"+m,"}")}else l.push("scratch="+r("ptr"),"while((j-->left)&&("+r("cptr-s0")+">scratch)){",n("cptr",r("cptr-s0")),"cptr-=s0","}",n("cptr","scratch"));if(l.push("}"),1<e.length&&c&&l.push("free(scratch)"),l.push("} return "+s),c){var h=new Function("malloc","free",l.join("\n"));return h(c[0],c[1])}var h=new Function(l.join("\n"));return h()}function n(e,t,r){function l(e){return["(offset+",e,"*s0)"].join("")}function s(e){return"generic"===t?["data.get(",e,")"].join(""):["data[",e,"]"].join("")}function d(e,a){return"generic"===t?["data.set(",e,",",a,")"].join(""):["data[",e,"]=",a].join("")}function c(t,a,o){if(1===t.length)w.push("ptr0="+l(t[0]));else for(var r=0;r<t.length;++r)w.push(["b_ptr",r,"=s0*",t[r]].join(""));a&&w.push("pivot_ptr=0"),w.push("ptr_shift=offset");for(var r=e.length-1,n;0<=r;--r)(n=e[r],0!==n)&&w.push(["for(i",n,"=0;i",n,"<n",n,";++i",n,"){"].join(""));if(1<t.length)for(var r=0;r<t.length;++r)w.push(["ptr",r,"=b_ptr",r,"+ptr_shift"].join(""));w.push(o),a&&w.push("++pivot_ptr");for(var r=0,n;r<e.length;++r)(n=e[r],0!==n)&&(1<t.length?w.push("ptr_shift+=d"+n):w.push("ptr0+=d"+n),w.push("}"))}function p(t,a,o,r){if(1===a.length)w.push("ptr0="+l(a[0]));else{for(var n=0;n<a.length;++n)w.push(["b_ptr",n,"=s0*",a[n]].join(""));w.push("ptr_shift=offset")}o&&w.push("pivot_ptr=0"),t&&w.push(t+":");for(var n=1;n<e.length;++n)w.push(["for(i",n,"=0;i",n,"<n",n,";++i",n,"){"].join(""));if(1<a.length)for(var n=0;n<a.length;++n)w.push(["ptr",n,"=b_ptr",n,"+ptr_shift"].join(""));w.push(r);for(var n=e.length-1;1<=n;--n)o&&w.push("pivot_ptr+=f"+n),1<a.length?w.push("ptr_shift+=e"+n):w.push("ptr0+=e"+n),w.push("}")}function u(){1<e.length&&A&&w.push("free(pivot1)","free(pivot2)")}function g(t,o){var r="el"+t,a="el"+o;if(1<e.length){var i="__l"+ ++S;p(i,[r,a],!1,["comp=",s("ptr0"),"-",s("ptr1"),"\n","if(comp>0){tmp0=",r,";",r,"=",a,";",a,"=tmp0;break ",i,"}\n","if(comp<0){break ",i,"}"].join(""))}else w.push(["if(",s(l(r)),">",s(l(a)),"){tmp0=",r,";",r,"=",a,";",a,"=tmp0}"].join(""))}function m(t,a){1<e.length?c([t,a],!1,d("ptr0",s("ptr1"))):w.push(d(l(t),s(l(a))))}function h(t,a,o){if(1<e.length){var r="__l"+ ++S;p(r,[a],!0,[t,"=",s("ptr0"),"-pivot",o,"[pivot_ptr]\n","if(",t,"!==0){break ",r,"}"].join(""))}else w.push([t,"=",s(l(a)),"-pivot",o].join(""))}function y(t,a){1<e.length?c([t,a],!1,["tmp=",s("ptr0"),"\n",d("ptr0",s("ptr1")),"\n",d("ptr1","tmp")].join("")):w.push(["ptr0=",l(t),"\n","ptr1=",l(a),"\n","tmp=",s("ptr0"),"\n",d("ptr0",s("ptr1")),"\n",d("ptr1","tmp")].join(""))}function f(t,a,o){1<e.length?(c([t,a,o],!1,["tmp=",s("ptr0"),"\n",d("ptr0",s("ptr1")),"\n",d("ptr1",s("ptr2")),"\n",d("ptr2","tmp")].join("")),w.push("++"+a,"--"+o)):w.push(["ptr0=",l(t),"\n","ptr1=",l(a),"\n","ptr2=",l(o),"\n","++",a,"\n","--",o,"\n","tmp=",s("ptr0"),"\n",d("ptr0",s("ptr1")),"\n",d("ptr1",s("ptr2")),"\n",d("ptr2","tmp")].join(""))}function x(e,t){y(e,t),w.push("--"+t)}function _(t,a,o){1<e.length?c([t,a],!0,[d("ptr0",s("ptr1")),"\n",d("ptr1",["pivot",o,"[pivot_ptr]"].join(""))].join("")):w.push(d(l(t),s(l(a))),d(l(a),"pivot"+o))}function b(t,a){w.push(["if((",a,"-",t,")<=",32,"){\n","insertionSort(",t,",",a,",data,offset,",o(e.length).join(","),")\n","}else{\n",k,"(",t,",",a,",data,offset,",o(e.length).join(","),")\n","}"].join(""))}function v(t,a,o){1<e.length?(w.push(["__l",++S,":while(true){"].join("")),c([t],!0,["if(",s("ptr0"),"!==pivot",a,"[pivot_ptr]){break __l",S,"}"].join("")),w.push(o,"}")):w.push(["while(",s(l(t)),"===pivot",a,"){",o,"}"].join(""))}var w=["'use strict'"],k=["ndarrayQuickSort",e.join("d"),t].join(""),T=["left","right","data","offset"].concat(o(e.length)),A=a(t),S=0;w.push(["function ",k,"(",T.join(","),"){"].join(""));var C=["sixth=((right-left+1)/6)|0","index1=left+sixth","index5=right-sixth","index3=(left+right)>>1","index2=index3-sixth","index4=index3+sixth","el1=index1","el2=index2","el3=index3","el4=index4","el5=index5","less=left+1","great=right-1","pivots_are_equal=true","tmp","tmp0","x","y","z","k","ptr0","ptr1","ptr2","comp_pivot1=0","comp_pivot2=0","comp=0"];if(1<e.length){for(var L=[],E=1;E<e.length;++E)L.push("n"+E),C.push("i"+E);for(var E=0;8>E;++E)C.push("b_ptr"+E);C.push("ptr3","ptr4","ptr5","ptr6","ptr7","pivot_ptr","ptr_shift","elementSize="+L.join("*")),A?C.push("pivot1=malloc(elementSize)","pivot2=malloc(elementSize)"):C.push("pivot1=new Array(elementSize),pivot2=new Array(elementSize)")}else C.push("pivot1","pivot2");if(w.push("var "+C.join(",")),g(1,2),g(4,5),g(1,3),g(2,3),g(1,4),g(3,4),g(2,5),g(2,3),g(4,5),1<e.length?c(["el1","el2","el3","el4","el5","index1","index3","index5"],!0,["pivot1[pivot_ptr]=",s("ptr1"),"\n","pivot2[pivot_ptr]=",s("ptr3"),"\n","pivots_are_equal=pivots_are_equal&&(pivot1[pivot_ptr]===pivot2[pivot_ptr])\n","x=",s("ptr0"),"\n","y=",s("ptr2"),"\n","z=",s("ptr4"),"\n",d("ptr5","x"),"\n",d("ptr6","y"),"\n",d("ptr7","z")].join("")):w.push(["pivot1=",s(l("el2")),"\n","pivot2=",s(l("el4")),"\n","pivots_are_equal=pivot1===pivot2\n","x=",s(l("el1")),"\n","y=",s(l("el3")),"\n","z=",s(l("el5")),"\n",d(l("index1"),"x"),"\n",d(l("index3"),"y"),"\n",d(l("index5"),"z")].join("")),m("index2","left"),m("index4","right"),w.push("if(pivots_are_equal){"),w.push("for(k=less;k<=great;++k){"),h("comp","k",1),w.push("if(comp===0){continue}"),w.push("if(comp<0){"),w.push("if(k!==less){"),y("k","less"),w.push("}"),w.push("++less"),w.push("}else{"),w.push("while(true){"),h("comp","great",1),w.push("if(comp>0){"),w.push("great--"),w.push("}else if(comp<0){"),f("k","less","great"),w.push("break"),w.push("}else{"),x("k","great"),w.push("break"),w.push("}"),w.push("}"),w.push("}"),w.push("}"),w.push("}else{"),w.push("for(k=less;k<=great;++k){"),h("comp_pivot1","k",1),w.push("if(comp_pivot1<0){"),w.push("if(k!==less){"),y("k","less"),w.push("}"),w.push("++less"),w.push("}else{"),h("comp_pivot2","k",2),w.push("if(comp_pivot2>0){"),w.push("while(true){"),h("comp","great",2),w.push("if(comp>0){"),w.push("if(--great<k){break}"),w.push("continue"),w.push("}else{"),h("comp","great",1),w.push("if(comp<0){"),f("k","less","great"),w.push("}else{"),x("k","great"),w.push("}"),w.push("break"),w.push("}"),w.push("}"),w.push("}"),w.push("}"),w.push("}"),w.push("}"),_("left","(less-1)",1),_("right","(great+1)",2),b("left","(less-2)"),b("(great+2)","right"),w.push("if(pivots_are_equal){"),u(),w.push("return"),w.push("}"),w.push("if(less<index1&&great>index5){"),v("less",1,"++less"),v("great",2,"--great"),w.push("for(k=less;k<=great;++k){"),h("comp_pivot1","k",1),w.push("if(comp_pivot1===0){"),w.push("if(k!==less){"),y("k","less"),w.push("}"),w.push("++less"),w.push("}else{"),h("comp_pivot2","k",2),w.push("if(comp_pivot2===0){"),w.push("while(true){"),h("comp","great",2),w.push("if(comp===0){"),w.push("if(--great<k){break}"),w.push("continue"),w.push("}else{"),h("comp","great",1),w.push("if(comp<0){"),f("k","less","great"),w.push("}else{"),x("k","great"),w.push("}"),w.push("break"),w.push("}"),w.push("}"),w.push("}"),w.push("}"),w.push("}"),w.push("}"),u(),b("less","great"),w.push("}return "+k),1<e.length&&A){var n=new Function("insertionSort","malloc","free",w.join("\n"));return n(r,A[0],A[1])}var n=new Function("insertionSort",w.join("\n"));return n(r)}var l=e("typedarray-pool");t.exports=function(e,t){var a=["'use strict'"],l=["ndarraySortWrapper",e.join("d"),t].join("");a.push(["function ",l,"(",["array"].join(","),"){"].join(""));for(var s=["data=array.data,offset=array.offset|0,shape=array.shape,stride=array.stride"],d=0;d<e.length;++d)s.push(["s",d,"=stride[",d,"]|0,n",d,"=shape[",d,"]|0"].join(""));for(var c=Array(e.length),u=[],d=0,g;d<e.length;++d)(g=e[d],0!==g)&&(c[g]=0===u.length?"1":u.join("*"),u.push("n"+g));for(var m=-1,h=-1,d=0,y;d<e.length;++d){y=e[d],0!==y&&(0<m?s.push(["d",y,"=s",y,"-d",m,"*n",m].join("")):s.push(["d",y,"=s",y].join("")),m=y);var g=e.length-1-d;0!==g&&(0<h?s.push(["e",g,"=s",g,"-e",h,"*n",h,",f",g,"=",c[g],"-f",h,"*n",h].join("")):s.push(["e",g,"=s",g,",f",g,"=",c[g]].join("")),h=g)}a.push("var "+s.join(","));var f=["0","n0-1","data","offset"].concat(o(e.length));a.push(["if(n0<=",32,"){","insertionSort(",f.join(","),")}else{","quickSort(",f.join(","),")}"].join("")),a.push("}return "+l);var x=new Function("insertionSort","quickSort",a.join("\n")),_=r(e,t),b=n(e,t,_);return x(_,b)}},{"typedarray-pool":1328}],423:[function(e,t){"use strict";var a=e("./lib/compile_sort.js"),o={};t.exports=function(e){var t=e.order,r=e.dtype,i=[t,r].join(":"),n=o[i];return n||(o[i]=n=a(t,r)),n(e),e}},{"./lib/compile_sort.js":422}],424:[function(e,t){'use strict';var a=e("ndarray-linear-interpolate"),o=e("cwise/lib/wrapper")({args:["index","array","scalar","scalar","scalar"],pre:{body:"{this_warped=new Array(_inline_3_arg4_)}",args:[{name:"_inline_3_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_3_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_3_arg2_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_3_arg3_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_3_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_warped"],localVars:[]},body:{body:"{_inline_4_arg2_(this_warped,_inline_4_arg0_),_inline_4_arg1_=_inline_4_arg3_.apply(void 0,this_warped)}",args:[{name:"_inline_4_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_4_arg1_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_4_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_4_arg3_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_4_arg4_",lvalue:!1,rvalue:!1,count:0}],thisVars:["this_warped"],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:!1,funcName:"warpND",blockSize:64}),r=e("cwise/lib/wrapper")({args:["index","array","scalar","scalar","scalar"],pre:{body:"{this_warped=[0]}",args:[],thisVars:["this_warped"],localVars:[]},body:{body:"{_inline_7_arg2_(this_warped,_inline_7_arg0_),_inline_7_arg1_=_inline_7_arg3_(_inline_7_arg4_,this_warped[0])}",args:[{name:"_inline_7_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_7_arg1_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_7_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_7_arg3_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_7_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_warped"],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:!1,funcName:"warp1D",blockSize:64}),i=e("cwise/lib/wrapper")({args:["index","array","scalar","scalar","scalar"],pre:{body:"{this_warped=[0,0]}",args:[],thisVars:["this_warped"],localVars:[]},body:{body:"{_inline_10_arg2_(this_warped,_inline_10_arg0_),_inline_10_arg1_=_inline_10_arg3_(_inline_10_arg4_,this_warped[0],this_warped[1])}",args:[{name:"_inline_10_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_10_arg1_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_10_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_10_arg3_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_10_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_warped"],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:!1,funcName:"warp2D",blockSize:64}),n=e("cwise/lib/wrapper")({args:["index","array","scalar","scalar","scalar"],pre:{body:"{this_warped=[0,0,0]}",args:[],thisVars:["this_warped"],localVars:[]},body:{body:"{_inline_13_arg2_(this_warped,_inline_13_arg0_),_inline_13_arg1_=_inline_13_arg3_(_inline_13_arg4_,this_warped[0],this_warped[1],this_warped[2])}",args:[{name:"_inline_13_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_13_arg1_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_13_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_13_arg3_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_13_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_warped"],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:!1,funcName:"warp3D",blockSize:64});t.exports=function(e,t,l){switch(t.shape.length){case 1:r(e,l,a.d1,t);break;case 2:i(e,l,a.d2,t);break;case 3:n(e,l,a.d3,t);break;default:o(e,l,a.bind(void 0,t),t.shape.length);}return e}},{"cwise/lib/wrapper":96,"ndarray-linear-interpolate":418}],425:[function(e,t){function a(e,t){return e[0]-t[0]}function o(){var e=this.stride,t=Array(e.length),o;for(o=0;o<t.length;++o)t[o]=[Math.abs(e[o]),o];t.sort(a);var r=Array(t.length);for(o=0;o<r.length;++o)r[o]=t[o][1];return r}function r(e,t){var a=["View",t,"d",e].join("");0>t&&(a="View_Nil"+e);var r="generic"===e;if(-1===t){var l="function "+a+"(a){this.data=a;};var proto="+a+".prototype;proto.dtype='"+e+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+a+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+a+"(a){return new "+a+"(a);}",s=new Function(l);return s()}if(0===t){var l="function "+a+"(a,d) {this.data = a;this.offset = d};var proto="+a+".prototype;proto.dtype='"+e+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+a+"_copy() {return new "+a+"(this.data,this.offset)};proto.pick=function "+a+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+a+"_get(){return "+(r?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+a+"_set(v){return "+(r?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+a+"(a,b,c,d){return new "+a+"(a,d)}",s=new Function("TrivialArray",l);return s(c[e][0])}var l=["'use strict'"],d=n(t),p=d.map(function(e){return"i"+e}),u="this.offset+"+d.map(function(e){return"this.stride["+e+"]*i"+e}).join("+"),g=d.map(function(e){return"b"+e}).join(","),m=d.map(function(e){return"c"+e}).join(",");l.push("function "+a+"(a,"+g+","+m+",d){this.data=a","this.shape=["+g+"]","this.stride=["+m+"]","this.offset=d|0}","var proto="+a+".prototype","proto.dtype='"+e+"'","proto.dimension="+t),l.push("Object.defineProperty(proto,'size',{get:function "+a+"_size(){return "+d.map(function(e){return"this.shape["+e+"]"}).join("*"),"}})"),1===t?l.push("proto.order=[0]"):(l.push("Object.defineProperty(proto,'order',{get:"),4>t?(l.push("function "+a+"_order(){"),2===t?l.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3==t&&l.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):l.push("ORDER})")),l.push("proto.set=function "+a+"_set("+p.join(",")+",v){"),r?l.push("return this.data.set("+u+",v)}"):l.push("return this.data["+u+"]=v}"),l.push("proto.get=function "+a+"_get("+p.join(",")+"){"),r?l.push("return this.data.get("+u+")}"):l.push("return this.data["+u+"]}"),l.push("proto.index=function "+a+"_index(",p.join(),"){return "+u+"}"),l.push("proto.hi=function "+a+"_hi("+p.join(",")+"){return new "+a+"(this.data,"+d.map(function(e){return["(typeof i",e,"!=='number'||i",e,"<0)?this.shape[",e,"]:i",e,"|0"].join("")}).join(",")+","+d.map(function(e){return"this.stride["+e+"]"}).join(",")+",this.offset)}");var h=d.map(function(e){return"a"+e+"=this.shape["+e+"]"}),y=d.map(function(e){return"c"+e+"=this.stride["+e+"]"});l.push("proto.lo=function "+a+"_lo("+p.join(",")+"){var b=this.offset,d=0,"+h.join(",")+","+y.join(","));for(var f=0;f<t;++f)l.push("if(typeof i"+f+"==='number'&&i"+f+">=0){d=i"+f+"|0;b+=c"+f+"*d;a"+f+"-=d}");l.push("return new "+a+"(this.data,"+d.map(function(e){return"a"+e}).join(",")+","+d.map(function(e){return"c"+e}).join(",")+",b)}"),l.push("proto.step=function "+a+"_step("+p.join(",")+"){var "+d.map(function(e){return"a"+e+"=this.shape["+e+"]"}).join(",")+","+d.map(function(e){return"b"+e+"=this.stride["+e+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var f=0;f<t;++f)l.push("if(typeof i"+f+"==='number'){d=i"+f+"|0;if(d<0){c+=b"+f+"*(a"+f+"-1);a"+f+"=ceil(-a"+f+"/d)}else{a"+f+"=ceil(a"+f+"/d)}b"+f+"*=d}");l.push("return new "+a+"(this.data,"+d.map(function(e){return"a"+e}).join(",")+","+d.map(function(e){return"b"+e}).join(",")+",c)}");for(var x=Array(t),_=Array(t),f=0;f<t;++f)x[f]="a[i"+f+"]",_[f]="b[i"+f+"]";l.push("proto.transpose=function "+a+"_transpose("+p+"){"+p.map(function(e,t){return e+"=("+e+"===undefined?"+t+":"+e+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+a+"(this.data,"+x.join(",")+","+_.join(",")+",this.offset)}"),l.push("proto.pick=function "+a+"_pick("+p+"){var a=[],b=[],c=this.offset");for(var f=0;f<t;++f)l.push("if(typeof i"+f+"==='number'&&i"+f+">=0){c=(c+this.stride["+f+"]*i"+f+")|0}else{a.push(this.shape["+f+"]);b.push(this.stride["+f+"])}");l.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),l.push("return function construct_"+a+"(data,shape,stride,offset){return new "+a+"(data,"+d.map(function(e){return"shape["+e+"]"}).join(",")+","+d.map(function(e){return"stride["+e+"]"}).join(",")+",offset)}");var s=new Function("CTOR_LIST","ORDER",l.join("\n"));return s(c[e],o)}function i(e){if(l(e))return"buffer";if(s)switch(Object.prototype.toString.call(e)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64";}return Array.isArray(e)?"array":"generic"}var n=e("iota-array"),l=e("is-buffer"),s="undefined"!=typeof Float64Array,c={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};(function(){for(var e in c)c[e].push(r(e,-1))}),t.exports=function(e,t,a,o){if(e===void 0){var n=c.array[0];return n([])}"number"==typeof e&&(e=[e]);t===void 0&&(t=[e.length]);var l=t.length;if(a===void 0){a=Array(l);for(var s=l-1,d=1;0<=s;--s)a[s]=d,d*=t[s]}if(void 0===o){o=0;for(var s=0;s<l;++s)0>a[s]&&(o-=(t[s]-1)*a[s])}for(var p=i(e),u=c[p];u.length<=l+1;)u.push(r(p,u.length-1));var n=u[l+1];return n(e,t,a,o)}},{"iota-array":385,"is-buffer":387}],426:[function(e,t){"use strict";var a=e("double-bits"),o=Math.pow(2,-1074);t.exports=function(e,t){if(isNaN(e)||isNaN(t))return NaN;if(e===t)return e;if(0===e)return 0>t?-o:o;var r=a.hi(e),i=a.lo(e);return t>e==0<e?4294967295===i?(r+=1,i=0):i+=1:0===i?(i=4294967295,r-=1):i-=1,a.pack(i,r)}},{"double-bits":113}],427:[function(e,t){t.exports.degree=e("./src/degree.js"),t.exports.betweenness=e("./src/betweenness.js"),t.exports.closeness=e("./src/closeness.js"),t.exports.eccentricity=e("./src/eccentricity.js")},{"./src/betweenness.js":428,"./src/closeness.js":429,"./src/degree.js":430,"./src/eccentricity.js":431}],428:[function(e,t){t.exports=function(e,t){function a(e){g=e.id,i(g),o()}function o(){for(e.forEachNode(r);l.length;){for(var t=l.pop(),a=(1+p[t])/c[t],o=s[t],i=0,n;i<o.length;++i)n=o[i],p[n]+=c[n]*a;t!==g&&(u[t]+=p[t])}}function r(e){p[e.id]=0}function i(a){function o(e){i(e.id)}function r(e){var t=e.id;s[t]=[],d[t]=-1,c[t]=0}function i(e){-1===d[e]&&(d[e]=d[p]+1,n.push(e)),d[e]===d[p]+1&&(c[e]+=c[p],s[e].push(p))}for(e.forEachNode(r),d[a]=0,c[a]=1,n.push(a);n.length;){var p=n.shift();l.push(p),e.forEachLinkedNode(p,o,t)}}var n=[],l=[],s=Object.create(null),d=Object.create(null),c=Object.create(null),p=Object.create(null),u=Object.create(null),g;return e.forEachNode(function(e){u[e.id]=0}),e.forEachNode(a),t||Object.keys(u).forEach(function(e){u[e]/=2}),u}},{}],429:[function(e,t){t.exports=function(e,t){function a(e){s=e.id,r(s),o()}function o(){var e=Object.keys(n).map(function(e){return n[e]}).filter(function(e){return-1!==e}),t=e.length,a=e.reduce(function(e,t){return e+t});l[s]=0<a?(t-1)/a:0}function r(a){function o(e){var t=e.id;n[t]=-1}function r(e){var t=e.id;-1===n[t]&&(n[t]=n[l]+1,i.push(t))}for(e.forEachNode(o),n[a]=0,i.push(a);i.length;){var l=i.shift();e.forEachLinkedNode(l,r,t)}}var i=[],n=Object.create(null),l=Object.create(null),s;return e.forEachNode(function(e){l[e.id]=0}),e.forEachNode(a),l}},{}],430:[function(e,t){function a(e,t){var a=0;if(!e)return a;for(var o=0;o<e.length;o+=1)a+=e[o].toId===t?1:0;return a}function o(e,t){var a=0;if(!e)return a;for(var o=0;o<e.length;o+=1)a+=e[o].fromId===t?1:0;return a}function r(e){return e?e.length:0}t.exports=function(e,t){function i(t){var a=e.getLinks(t.id);n[t.id]=l(a,t.id)}var n=Object.create(null),l;if(t=(t||"both").toLowerCase(),"both"===t||"inout"===t)l=r;else if("in"===t)l=a;else if("out"===t)l=o;else throw new Error("Expected centrality degree kind is: in, out or both");return e.forEachNode(i),n}},{}],431:[function(e,t){t.exports=function(e,t){function a(e){s=e.id,r(s),o()}function o(){var e=0;Object.keys(n).forEach(function(t){var a=n[t];e<a&&(e=a)}),l[s]=e}function r(a){function o(e){var t=e.id;n[t]=-1}function r(e){var t=e.id;-1===n[t]&&(n[t]=n[l]+1,i.push(t))}for(e.forEachNode(o),n[a]=0,i.push(a);i.length;){var l=i.shift();e.forEachLinkedNode(l,r,t)}}var i=[],n=Object.create(null),l=Object.create(null),s;return e.forEachNode(function(e){l[e.id]=0}),e.forEachNode(a),l}},{}],432:[function(e,t){function a(e){return e}t.exports=function(e,t,r){var n;t=t||a,r=r||a,n="string"==typeof e?JSON.parse(e):e;var l=o(),s;if(n.links===void 0||n.nodes===void 0)throw new Error("Cannot load graph without links and nodes");for(s=0;s<n.nodes.length;++s){var d=t(n.nodes[s]);if(!d.hasOwnProperty("id"))throw new Error("Graph node format is invalid: Node id is missing");l.addNode(d.id,d.data)}for(s=0;s<n.links.length;++s){var c=r(n.links[s]);if(!c.hasOwnProperty("fromId")||!c.hasOwnProperty("toId"))throw new Error("Graph link format is invalid. Both fromId and toId are required");l.addLink(c.fromId,c.toId,c.data)}return l};var o=e("ngraph.graph")},{"ngraph.graph":434}],433:[function(e,t){function a(e){var t=Object.create(null);return{on:function(a,o,r){if("function"!=typeof o)throw new Error("callback is expected to be a function");var i=t[a];return i||(i=t[a]=[]),i.push({callback:o,ctx:r}),e},off:function(a,o){if("undefined"==typeof a)return t=Object.create(null),e;if(t[a]){if("function"!=typeof o)delete t[a];else for(var r=t[a],n=0;n<r.length;++n)r[n].callback===o&&r.splice(n,1)}return e},fire:function(a){var o=t[a];if(!o)return e;var r;1<arguments.length&&(r=Array.prototype.splice.call(arguments,1));for(var n=0,l;n<o.length;++n)l=o[n],l.callback.apply(l.ctx,r);return e}}}function o(e){if(!e)throw new Error("Eventify cannot use falsy object as events subject");for(var t=["on","fire","off"],a=0;a<t.length;++a)if(e.hasOwnProperty(t[a]))throw new Error("Subject cannot be eventified, since it already has property '"+t[a]+"'")}t.exports=function(e){o(e);var t=a(e);return e.on=t.on,e.off=t.off,e.fire=t.fire,e}},{}],434:[function(e,t){function a(e){function t(e,t){I.push({link:e,changeType:t})}function a(e,t){I.push({node:e,changeType:t})}function d(e,t){if(void 0===e)throw new Error("Invalid node identifier");D();var a=c(e);return a?(a.data=t,z(a,"update")):(a=new r(e,t),S++,z(a,"add")),k[e]=a,O(),a}function c(e){return k[e]}function p(e){var t=c(e);if(!t)return!1;D();var a=t.links;if(a){t.links=null;for(var o=0;o<a.length;++o)g(a[o])}return delete k[e],S--,z(t,"remove"),O(),!0}function u(e,t,a){D();var o=c(e)||d(e),r=c(t)||d(t),n=E(e,t,a);return T.push(n),i(o,n),e!==t&&i(r,n),P(n,"add"),O(),n}function g(e){if(!e)return!1;var t=o(e,T);if(0>t)return!1;D(),T.splice(t,1);var a=c(e.fromId),r=c(e.toId);return a&&(t=o(e,a.links),0<=t&&a.links.splice(t,1)),r&&(t=o(e,r.links),0<=t&&r.links.splice(t,1)),P(e,"remove"),O(),!0}function m(e,t){var a=c(e),o;if(!a||!a.links)return null;for(o=0;o<a.links.length;++o){var r=a.links[o];if(r.fromId===e&&r.toId===t)return r}return null}function h(){D(),L(function(e){p(e.id)}),O()}function y(e,t,a){for(var o=0,r;o<e.length;++o){var n=e[o],l=n.fromId===t?n.toId:n.fromId;if(r=a(k[l],n),r)return!0}}function f(e,t,a){for(var o=0,r,n;o<e.length;++o)if(n=e[o],n.fromId===t&&(r=a(k[n.toId],n),r))return!0}function x(){}function _(){C+=1}function b(){C-=1,0===C&&0<I.length&&(R.fire("changed",I),I.length=0)}function v(e){if("function"==typeof e)for(var t=Object.keys(k),a=0;a<t.length;++a)if(e(k[t[a]]))return!0}function w(e){if("function"==typeof e){for(var t in k)if(e(k[t]))return!0}}e=e||{},"uniqueLinkId"in e&&(console.warn("ngraph.graph: Starting from version 0.14 `uniqueLinkId` is deprecated.\nUse `multigraph` option instead\n","\n","Note: there is also change in default behavior: From now own each graph\nis considered to be not a multigraph by default (each edge is unique)."),e.multigraph=e.uniqueLinkId),void 0===e.multigraph&&(e.multigraph=!1);var k="function"==typeof Object.create?Object.create(null):{},T=[],A={},S=0,C=0,L=function(){return Object.keys?v:w}(),E=e.multigraph?function(e,t,a){var o=l(e,t),r=A.hasOwnProperty(o);if(r||m(e,t)){r||(A[o]=0);var i="@"+ ++A[o];o=l(e+i,t+i)}return new n(e,t,a,o)}:function(e,t,a){var o=l(e,t);return new n(e,t,a,o)},I=[],P=x,z=x,D=x,O=x,R={addNode:d,addLink:u,removeLink:g,removeNode:p,getNode:c,getNodesCount:function(){return S},getLinksCount:function(){return T.length},getLinks:function(e){var t=c(e);return t?t.links:null},forEachNode:L,forEachLinkedNode:function(e,t,a){var o=c(e);if(o&&o.links&&"function"==typeof t)return a?f(o.links,e,t):y(o.links,e,t)},forEachLink:function(e){var t,a;if("function"==typeof e)for(t=0,a=T.length;t<a;++t)e(T[t])},beginUpdate:D,endUpdate:O,clear:h,hasLink:m,hasNode:c,getLink:m};return s(R),function(){var e=R.on;R.on=function(){return R.beginUpdate=D=_,R.endUpdate=O=b,P=t,z=a,R.on=e,e.apply(R,arguments)}}(),R}function o(e,t){if(!t)return-1;if(t.indexOf)return t.indexOf(e);var a=t.length,o;for(o=0;o<a;o+=1)if(t[o]===e)return o;return-1}function r(e,t){this.id=e,this.links=null,this.data=t}function i(e,t){e.links?e.links.push(t):e.links=[t]}function n(e,t,a,o){this.fromId=e,this.toId=t,this.data=a,this.id=o}function l(e,t){return e.toString()+"\uD83D\uDC49 "+t.toString()}t.exports=a;var s=e("ngraph.events")},{"ngraph.events":433}],435:[function(e,t){t.exports=function(e,t,a){var o={nodes:[],links:[]},r=t||function(e){var t={id:e.id};return void 0!==e.data&&(t.data=e.data),t},i=a||function(e){var t={fromId:e.fromId,toId:e.toId};return void 0!==e.data&&(t.data=e.data),t};return e.forEachNode(function(e){o.nodes.push(r(e))}),e.forEachLink(function(e){o.links.push(i(e))}),JSON.stringify(o)}},{}],436:[function(e,t){var s=Math.asin,d=Math.cos,c=Math.sqrt,p=Math.sin,u=Math.abs;function a(e,t,a,o){return["C",e,t,a,o,a,o]}function o(e,t,a,o,r,i){return["C",e/3+2/3*a,t/3+2/3*o,r/3+2/3*a,i/3+2/3*o,r,i]}function r(e,a,o,l,f,_,b,v,w,T){if(!T){var A=n(e,a,-f);e=A.x,a=A.y,A=n(v,w,-f),v=A.x,w=A.y;var S=(e-v)/2,x=(a-w)/2,y=S*S/(o*o)+x*x/(l*l);1<y&&(y=c(y),o=y*o,l=y*l);var C=o*o,L=l*l,E=(_==b?-1:1)*c(u((C*L-C*x*x-L*S*S)/(C*x*x+L*S*S)));E==1/0&&(E=1);var I=E*o*x/l+(e+v)/2,P=E*-l*S/o+(a+w)/2,z=s(((a-P)/l).toFixed(9)),D=s(((w-P)/l).toFixed(9));z=e<I?g-z:z,D=v<I?g-D:D,0>z&&(z=2*g+z),0>D&&(D=2*g+D),b&&z>D&&(z-=2*g),!b&&D>z&&(D-=2*g)}else z=T[0],D=T[1],I=T[2],P=T[3];if(u(D-z)>m){var O=D,R=v,M=w;D=z+m*(b&&D>z?1:-1),v=I+o*d(D),w=P+l*p(D);var j=r(v,w,o,l,f,0,b,R,M,[D,O,I,P])}var B=Math.tan((D-z)/4),t=4/3*o*B,F=4/3*l*B,N=[2*e-(e+t*p(z)),2*a-(a-F*d(z)),v+t*p(D),w-F*d(D),v,w];if(T)return N;j&&(N=N.concat(j));for(var V=0,U;V<N.length;)U=n(N[V],N[V+1],f),N[V++]=U.x,N[V++]=U.y;return N}function n(e,t,a){return{x:e*d(a)-t*p(a),y:e*p(a)+t*d(a)}}function l(e){return e*(g/180)}var g=Math.PI,m=l(120);t.exports=function(e){for(var t=[],n=0,s=0,d=0,c=0,p=null,u=null,g=0,m=0,h=0,f=e.length,_;h<f;h++){var b=e[h],v=b[0];switch(v){case"M":d=b[1],c=b[2];break;case"A":b=r(g,m,b[1],b[2],l(b[3]),b[4],b[5],b[6],b[7]),b.unshift("C"),7<b.length&&(t.push(b.splice(0,7)),b.unshift("C"));break;case"S":var w=g,k=m;("C"==_||"S"==_)&&(w+=w-n,k+=k-s),b=["C",w,k,b[1],b[2],b[3],b[4]];break;case"T":"Q"==_||"T"==_?(p=2*g-p,u=2*m-u):(p=g,u=m),b=o(g,m,p,u,b[1],b[2]);break;case"Q":p=b[1],u=b[2],b=o(g,m,b[1],b[2],b[3],b[4]);break;case"L":b=a(g,m,b[1],b[2]);break;case"H":b=a(g,m,b[1],m);break;case"V":b=a(g,m,g,b[1]);break;case"Z":b=a(g,m,d,c);}_=v,g=b[b.length-2],m=b[b.length-1],4<b.length?(n=b[b.length-4],s=b[b.length-3]):(n=g,s=m),t.push(b)}return t}},{}],437:[function(e,t,a){var o=Math.sqrt;a.vertexNormals=function(e,t,a){for(var r=t.length,l=Array(r),s=void 0===a?1e-6:a,d=0;d<r;++d)l[d]=[0,0,0];for(var d=0;d<e.length;++d)for(var g=e[d],h=0,y=g[g.length-1],f=g[0],x=0;x<g.length;++x){h=y,y=f,f=g[(x+1)%g.length];for(var _=t[h],b=t[y],T=t[f],A=[,,,],S=0,C=[,,,],L=0,E=0;3>E;++E)A[E]=_[E]-b[E],S+=A[E]*A[E],C[E]=T[E]-b[E],L+=C[E]*C[E];if(S*L>s)for(var I=l[y],P=1/o(S*L),E=0;3>E;++E){var z=(E+1)%3,u=(E+2)%3;I[E]+=P*(C[z]*A[u]-C[u]*A[z])}}for(var d=0;d<r;++d){for(var I=l[d],v=0,E=0;3>E;++E)v+=I[E]*I[E];if(v>s)for(var P=1/o(v),E=0;3>E;++E)I[E]*=P;else for(var E=0;3>E;++E)I[E]=0}return l},a.faceNormals=function(e,t,a){for(var r=e.length,s=Array(r),d=void 0===a?1e-6:a,c=0;c<r;++c){for(var p=e[c],g=[,,,],m=0;3>m;++m)g[m]=t[p[m]];for(var h=[,,,],y=[,,,],m=0;3>m;++m)h[m]=g[1][m]-g[0][m],y[m]=g[2][m]-g[0][m];for(var f=[,,,],n=0,m=0;3>m;++m){var x=(m+1)%3,u=(m+2)%3;f[m]=h[x]*y[u]-h[u]*y[x],n+=f[m]*f[m]}n=n>d?1/o(n):0;for(var m=0;3>m;++m)f[m]*=n;s[c]=f}return s}},{}],438:[function(e,t){/*
object-assign
(c) Sindre Sorhus
@license MIT
*/'use strict';var o=String.fromCharCode;function a(e){if(null===e||e===void 0)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},a=0;10>a;a++)t["_"+o(a)]=a;var r=Object.getOwnPropertyNames(t).map(function(e){return t[e]});if("0123456789"!==r.join(""))return!1;var n={};return["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t"].forEach(function(e){n[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e){for(var t=a(e),o=1,l,d;o<arguments.length;o++){for(var c in l=Object(arguments[o]),l)i.call(l,c)&&(t[c]=l[c]);if(r){d=r(l);for(var p=0;p<d.length;p++)n.call(l,d[p])&&(t[d[p]]=l[d[p]])}}return t}},{}],439:[function(e,t){'use strict';var a=Math.sqrt;t.exports=function(e,t,o,r,i,n,s,d,c,p){var u=t+n+p;if(0<g){var g=a(u+1);e[0]=.5*(s-c)/g,e[1]=.5*(d-r)/g,e[2]=.5*(o-n)/g,e[3]=.5*g}else{var m=Math.max(t,n,p),g=a(2*m-u+1);t>=m?(e[0]=.5*g,e[1]=.5*(i+o)/g,e[2]=.5*(d+r)/g,e[3]=.5*(s-c)/g):n>=m?(e[0]=.5*(o+i)/g,e[1]=.5*g,e[2]=.5*(c+s)/g,e[3]=.5*(d-r)/g):(e[0]=.5*(r+d)/g,e[1]=.5*(s+c)/g,e[2]=.5*g,e[3]=.5*(o-i)/g)}return e}},{}],440:[function(e,t){'use strict';var d=Math.exp,p=Math.log,u=Math.sqrt,g=Math.pow,m=Math.max;function a(e,t,a){return u(g(e,2)+g(t,2)+g(a,2))}function o(e,t,a,o){return u(g(e,2)+g(t,2)+g(a,2)+g(o,2))}function n(e,t){var a=t[0],r=t[1],i=t[2],n=t[3],l=o(a,r,i,n);1e-6<l?(e[0]=a/l,e[1]=r/l,e[2]=i/l,e[3]=n/l):(e[0]=e[1]=e[2]=0,e[3]=1)}function l(e,t,a){this.radius=h([a]),this.center=h(t),this.rotation=h(e),this.computedRadius=this.radius.curve(0),this.computedCenter=this.center.curve(0),this.computedRotation=this.rotation.curve(0),this.computedUp=[.1,0,0],this.computedEye=[.1,0,0],this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.recalcMatrix(0)}function s(e){e=e||{};var t=e.center||[0,0,0],a=e.rotation||[0,0,0,1],o=e.radius||1;t=[].slice.call(t,0,3),a=[].slice.call(a,0,4),n(a,a);var r=new l(a,t,p(o));return r.setDistanceLimits(e.zoomMin,e.zoomMax),("eye"in e||"up"in e)&&r.lookAt(0,e.eye,e.center,e.up),r}t.exports=s;var h=e("filtered-vector"),y=e("gl-mat4/lookAt"),f=e("gl-mat4/fromQuat"),x=e("gl-mat4/invert"),_=e("./lib/quatFromFrame"),b=l.prototype;b.lastT=function(){return m(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())},b.recalcMatrix=function(e){this.radius.curve(e),this.center.curve(e),this.rotation.curve(e);var t=this.computedRotation;n(t,t);var a=this.computedMatrix;f(a,t);var o=this.computedCenter,r=this.computedEye,l=this.computedUp,s=d(this.computedRadius[0]);r[0]=o[0]+s*a[2],r[1]=o[1]+s*a[6],r[2]=o[2]+s*a[10],l[0]=a[1],l[1]=a[5],l[2]=a[9];for(var c=0,p;3>c;++c){p=0;for(var u=0;3>u;++u)p+=a[c+4*u]*r[u];a[12+c]=-p}},b.getMatrix=function(e,t){this.recalcMatrix(e);var a=this.computedMatrix;if(t){for(var o=0;16>o;++o)t[o]=a[o];return t}return a},b.idle=function(e){this.center.idle(e),this.radius.idle(e),this.rotation.idle(e)},b.flush=function(e){this.center.flush(e),this.radius.flush(e),this.rotation.flush(e)},b.pan=function(e,t,o,r){t=t||0,o=o||0,r=r||0,this.recalcMatrix(e);var i=this.computedMatrix,n=i[1],l=i[5],s=i[9],c=a(n,l,s);n/=c,l/=c,s/=c;var u=i[0],g=i[4],h=i[8],y=u*n+g*l+h*s;u-=n*y,g-=l*y,h-=s*y;var f=a(u,g,h);u/=f,g/=f,h/=f;var x=i[2],_=i[6],b=i[10],v=x*n+_*l+b*s,w=x*u+_*g+b*h;x-=v*n+w*u,_-=v*l+w*g,b-=v*s+w*h;var k=a(x,_,b);x/=k,_/=k,b/=k;var T=u*t+n*o,A=g*t+l*o,S=h*t+s*o;this.center.move(e,T,A,S);var C=d(this.computedRadius[0]);C=m(1e-4,C+r),this.radius.set(e,p(C))},b.rotate=function(e,t,r,i){this.recalcMatrix(e),t=t||0,r=r||0;var n=this.computedMatrix,l=n[0],d=n[4],c=n[8],p=n[1],h=n[5],y=n[9],f=n[2],x=n[6],_=n[10],b=t*l+r*p,v=t*d+r*h,w=t*c+r*y,k=-(x*w-_*v),T=-(_*b-f*w),A=-(f*v-x*b),S=u(m(0,1-g(k,2)-g(T,2)-g(A,2))),C=o(k,T,A,S);1e-6<C?(k/=C,T/=C,A/=C,S/=C):(k=T=A=0,S=1);var L=this.computedRotation,E=L[0],I=L[1],P=L[2],z=L[3],D=E*S+z*k+I*A-P*T,O=I*S+z*T+P*k-E*A,R=P*S+z*A+E*T-I*k,M=z*S-E*k-I*T-P*A;if(i){k=f,T=x,A=_;var j=Math.sin(i)/a(k,T,A);k*=j,T*=j,A*=j,S=Math.cos(t),D=D*S+M*k+O*A-R*T,O=O*S+M*T+R*k-D*A,R=R*S+M*A+D*T-O*k,M=M*S-D*k-O*T-R*A}var s=o(D,O,R,M);1e-6<s?(D/=s,O/=s,R/=s,M/=s):(D=O=R=0,M=1),this.rotation.set(e,D,O,R,M)},b.lookAt=function(e,t,a,o){this.recalcMatrix(e),a=a||this.computedCenter,t=t||this.computedEye,o=o||this.computedUp;var r=this.computedMatrix;y(r,t,a,o);var l=this.computedRotation;_(l,r[0],r[1],r[2],r[4],r[5],r[6],r[8],r[9],r[10]),n(l,l),this.rotation.set(e,l[0],l[1],l[2],l[3]);for(var s=0,d=0;3>d;++d)s+=g(a[d]-t[d],2);this.radius.set(e,.5*p(m(s,1e-6))),this.center.set(e,a[0],a[1],a[2])},b.translate=function(e,t,a,o){this.center.move(e,t||0,a||0,o||0)},b.setMatrix=function(e,t){var a=this.computedRotation;_(a,t[0],t[1],t[2],t[4],t[5],t[6],t[8],t[9],t[10]),n(a,a),this.rotation.set(e,a[0],a[1],a[2],a[3]);var o=this.computedMatrix;x(o,t);var i=o[15];if(1e-6<Math.abs(i)){var l=o[12]/i,s=o[13]/i,c=o[14]/i;this.recalcMatrix(e);var p=d(this.computedRadius[0]);this.center.set(e,l-o[2]*p,s-o[6]*p,c-o[10]*p),this.radius.idle(e)}else this.center.idle(e),this.radius.idle(e)},b.setDistance=function(e,t){0<t&&this.radius.set(e,p(t))},b.setDistanceLimits=function(e,t){e=0<e?p(e):-Infinity,t=0<t?p(t):1/0,t=m(t,e),this.radius.bounds[0][0]=e,this.radius.bounds[1][0]=t},b.getDistanceLimits=function(e){var t=this.radius.bounds;return e?(e[0]=d(t[0][0]),e[1]=d(t[1][0]),e):[d(t[0][0]),d(t[1][0])]},b.toJSON=function(){return this.recalcMatrix(this.lastT()),{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:p(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}},b.fromJSON=function(e){var a=this.lastT(),t=e.center;t&&this.center.set(a,t[0],t[1],t[2]);var o=e.rotation;o&&this.rotation.set(a,o[0],o[1],o[2],o[3]);var r=e.distance;r&&0<r&&this.radius.set(a,p(r)),this.setDistanceLimits(e.zoomMin,e.zoomMax)}},{"./lib/quatFromFrame":439,"filtered-vector":203,"gl-mat4/fromQuat":239,"gl-mat4/invert":242,"gl-mat4/lookAt":243}],441:[function(e,t){/*!
 * pad-left <https://github.com/jonschlinkert/pad-left>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT license.
 */'use strict';var a=e("repeat-string");t.exports=function(e,t,o){return o="undefined"==typeof o?" ":o+"",a(o,t)+e}},{"repeat-string":1270}],442:[function(e,t){'use strict';function a(e,t){function o(e,t){for(var r=[],i=0,n;n=s.exec(e);){if(1e4<i++)throw Error("Circular references in parenthesis");r.push(e.slice(0,n.index)),r.push(o(t[n[1]],t)),e=e.slice(n.index+n[0].length)}return r.push(e),r}if("string"!=typeof e)return[e];var r=[e];"string"==typeof t||Array.isArray(t)?t={brackets:t}:!t&&(t={});var i=t.brackets?Array.isArray(t.brackets)?t.brackets:[t.brackets]:["{}","[]","()"],n=t.escape||"___",l=!!t.flat;i.forEach(function(e){function t(t){var a=r.push(t.slice(e[0].length,-e[1].length))-1;return i.push(a),n+a+n}var o=new RegExp(["\\",e[0],"[^\\",e[0],"\\",e[1],"]*\\",e[1]].join("")),i=[];r.forEach(function(e,n){for(var i=0,l;e!=l;)if(l=e,e=e.replace(o,t),1e4<i++)throw Error("References have circular dependency. Please, check them.");r[n]=e}),i=i.reverse(),r=r.map(function(t){return i.forEach(function(a){t=t.replace(new RegExp("(\\"+n+a+"\\"+n+")","g"),e[0]+"$1"+e[1])}),t})});var s=new RegExp("\\"+n+"([0-9]+)\\"+n);return l?r:o(r[0],r)}function o(e,t){function o(t,a){if(null==e[a])throw Error("Reference "+a+"is undefined");return e[a]}if(t&&t.flat){var r=t&&t.escape||"___",i=e[0],n;if(!i)return"";for(var l=new RegExp("\\"+r+"([0-9]+)\\"+r),s=0;i!=n;){if(1e4<s++)throw Error("Circular references in "+e);n=i,i=i.replace(l,o)}return i}return e.reduce(function e(t,a){return Array.isArray(a)&&(a=a.reduce(e,"")),t+a},"")}function r(e,t){return Array.isArray(e)?o(e,t):a(e,t)}r.parse=a,r.stringify=o,t.exports=r},{}],443:[function(e,t){'use strict';var a=e("pick-by-alias");t.exports=function(e){var t;return 1<arguments.length&&(e=arguments),"string"==typeof e?e=e.split(/\s/).map(parseFloat):"number"==typeof e&&(e=[e]),e.length&&"number"==typeof e[0]?1===e.length?t={width:e[0],height:e[0],x:0,y:0}:2===e.length?t={width:e[0],height:e[1],x:0,y:0}:t={x:e[0],y:e[1],width:e[2]-e[0]||0,height:e[3]-e[1]||0}:e&&(e=a(e,{left:"x l left Left",top:"y t top Top",width:"w width W Width",height:"h height W Width",bottom:"b bottom Bottom",right:"r right Right"}),t={x:e.left||0,y:e.top||0},t.width=null==e.width?e.right?e.right-t.x:0:e.width,t.height=null==e.height?e.bottom?e.bottom-t.y:0:e.height),t}},{"pick-by-alias":449}],444:[function(e,t){function a(e){var t=e.match(i);return t?t.map(Number):[]}t.exports=function(e){var t=[];return e.replace(r,function(e,r,i){var n=r.toLowerCase();for(i=a(i),"m"==n&&2<i.length&&(t.push([r].concat(i.splice(0,2))),n="l",r="m"==r?"l":"L");;){if(i.length==o[n])return i.unshift(r),t.push(i);if(i.length<o[n])throw new Error("malformed path data");t.push([r].concat(i.splice(0,o[n])))}}),t};var o={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},r=/([astvzqmhlc])([^astvzqmhlc]*)/ig,i=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig},{}],445:[function(e,t){t.exports=function(e,t){t||(t=[0,""]),e+="";var a=parseFloat(e,10);return t[0]=a,t[1]=e.match(/[\d.\-\+]*\s*(.*)/)[1]||"",t}},{}],446:[function(e,t){(function(e){(function(){var a,o,r,i,n,l;"undefined"!=typeof performance&&null!==performance&&performance.now?t.exports=function(){return performance.now()}:"undefined"!=typeof e&&null!==e&&e.hrtime?(t.exports=function(){return(a()-n)/1e6},o=e.hrtime,a=function(){var e;return e=o(),1e9*e[0]+e[1]},i=a(),l=1e9*e.uptime(),n=i-l):Date.now?(t.exports=function(){return Date.now()-r},r=Date.now()):(t.exports=function(){return new Date().getTime()-r},r=new Date().getTime())}).call(this)}).call(this,e("_process"))},{_process:1425}],447:[function(e,t){"use strict";t.exports=function(e){var t=e.length;if(32>t){for(var o=1,r=0;r<t;++r)for(var n=0;n<r;++n)if(e[r]<e[n])o=-o;else if(e[r]===e[n])return 0;return o}for(var l=a.mallocUint8(t),r=0;r<t;++r)l[r]=0;for(var o=1,r=0;r<t;++r)if(!l[r]){var s=1;l[r]=1;for(var n=e[r];n!==r;n=e[n]){if(l[n])return a.freeUint8(l),0;s+=1,l[n]=1}1&s||(o=-o)}return a.freeUint8(l),o};var a=e("typedarray-pool")},{"typedarray-pool":1328}],448:[function(e,t,a){"use strict";var o=e("typedarray-pool"),r=e("invert-permutation");a.rank=function(e){var a=e.length;switch(a){case 0:case 1:return 0;case 2:return e[1];default:}var n=o.mallocUint32(a),l=o.mallocUint32(a),d=0,c,p,u;for(r(e,l),u=0;u<a;++u)n[u]=e[u];for(u=a-1;0<u;--u)p=l[u],c=n[u],n[u]=n[p],n[p]=c,l[u]=l[c],l[c]=p,d=(d+c)*u;return o.freeUint32(l),o.freeUint32(n),d},a.unrank=function(e,a,o){switch(e){case 0:return o?o:[];case 1:return o?(o[0]=0,o):[0];case 2:return o?(a?(o[0]=0,o[1]=1):(o[0]=1,o[1]=0),o):a?[0,1]:[1,0];default:}o=o||Array(e);var n=1,l,d,c;for(o[0]=0,c=1;c<e;++c)o[c]=c,n=0|n*c;for(c=e-1;0<c;--c)l=0|a/n,a=0|a-l*n,n=0|n/c,d=0|o[c],o[c]=0|o[l],o[l]=0|d;return o}},{"invert-permutation":384,"typedarray-pool":1328}],449:[function(e,t){'use strict';function a(e){return o[e]?o[e]:("string"==typeof e&&(e=o[e]=e.split(/\s*,\s*|\s+/)),e)}t.exports=function(e,t,o){var r={},n,l;if("string"==typeof t&&(t=a(t)),Array.isArray(t)){var s={};for(l=0;l<t.length;l++)s[t[l]]=!0;t=s}for(n in t)t[n]=a(t[n]);var d={};for(n in t){var c=t[n];if(Array.isArray(c))for(l=0;l<c.length;l++){var p=c[l];if(o&&(d[p]=!0),p in e){if(r[n]=e[p],o)for(var u=l;u<c.length;u++)d[c[u]]=!0;break}}else n in e&&(t[n]&&(r[n]=e[n]),o&&(d[n]=!0))}if(o)for(n in e)d[n]||(r[n]=e[n]);return r};var o={}},{}],450:[function(e,t){"use strict";t.exports=function(e,t){function r(e,t){var o=g[t][e[t]];o.splice(o.indexOf(e),1)}function n(n,a,l){for(var s=0,d,c,u;2>s;++s)if(0<g[s][a].length){d=g[s][a][0],u=s;break}c=d[1^u];for(var m=0,h;2>m;++m){h=g[m][a];for(var y=0;y<h.length;++y){var f=h[y],e=f[1^m],p=o(t[n],t[a],t[c],t[e]);0<p&&(d=f,c=e,u=m)}}return l?c:(d&&r(d,u),c)}function l(e,i){var l=g[i][e][0],s=[e];r(l,i);for(var p=l[1^i];;){for(;p!==e;)s.push(p),p=n(s[s.length-2],p,!1);if(0===g[0][e].length+g[1][e].length)break;var m=s[s.length-1],a=e,h=s[1],c=n(m,a,!0);if(0>o(t[m],t[a],t[h],t[c]))break;s.push(e),p=n(m,a)}return s}function s(e,t){return t[1]===t[t.length-1]}for(var d=0|t.length,p=e.length,g=[Array(d),Array(d)],m=0;m<d;++m)g[0][m]=[],g[1][m]=[];for(var m=0,a;m<p;++m)a=e[m],g[0][a[0]].push(a),g[1][a[1]].push(a);for(var u=[],m=0;m<d;++m)0===g[0][m].length+g[1][m].length&&u.push([m]);for(var m=0;m<d;++m)for(var h=0,y;2>h;++h){for(y=[];0<g[h][m].length;){var f=g[0][m].length,x=l(m,h);s(y,x)?y.push.apply(y,x):(0<y.length&&u.push(y),y=x)}0<y.length&&u.push(y)}return u};var o=e("compare-angle")},{"compare-angle":74}],451:[function(e,t){'use strict';t.exports=function(t,o){for(var r=a(t,o.length),l=Array(o.length),s=Array(o.length),d=[],c=0,p;c<o.length;++c)p=r[c].length,s[c]=p,l[c]=!0,1>=p&&d.push(c);for(;0<d.length;){var g=d.pop();l[g]=!1;for(var m=r[g],c=0,n;c<m.length;++c)n=m[c],0==--s[n]&&d.push(n)}for(var h=Array(o.length),y=[],c=0;c<o.length;++c)if(l[c]){var g=y.length;h[c]=g,y.push(o[c])}else h[c]=-1;for(var f=[],c=0,x;c<t.length;++c)x=t[c],l[x[0]]&&l[x[1]]&&f.push([h[x[0]],h[x[1]]]);return[f,y]};var a=e("edges-to-adjacency-list")},{"edges-to-adjacency-list":118}],452:[function(e,t){'use strict';var l=Math.min,s=Math.max;function o(e,t){for(var a=Array(e),o=0;o<e;++o)a[o]=t;return a}function r(e){for(var t=Array(e),a=0;a<e;++a)t[a]=[];return t}function i(e,t){function _(e){for(var o=e.length,r=[0],i=0;i<o;++i){var n=t[e[i]],a=t[e[(i+1)%o]],l=m(-n[0],n[1]),s=m(-n[0],a[1]),d=m(a[0],n[1]),c=m(a[0],a[1]);r=h(r,h(h(l,s),h(d,c)))}return 0<r[r.length-1]}function v(e){for(var t=e.length,a=0;a<t;++a)if(!Y[e[a]])return!1;return!0}var w=x(e,t);e=w[0],t=w[1];for(var T=t.length,A=e.length,S=d(e,t.length),C=0;C<T;++C)if(1==S[C].length%2)throw new Error("planar-graph-to-polyline: graph must be manifold");var L=u(e,t);L=L.filter(_);for(var E=L.length,I=Array(E),P=Array(E),C=0;C<E;++C){I[C]=C;var z=Array(E),D=L[C].map(function(e){return t[e]}),O=g([D]),R=0;outer:for(var M=0;M<E;++M)if(z[M]=0,C!==M){for(var B=L[M],F=B.length,N=0,V;N<F;++N)if(V=O(t[B[N]]),0!==V){0>V&&(z[M]=1,R+=1);continue outer}z[M]=1,R+=1}P[C]=[R,C,z]}P.sort(function(e,t){return t[0]-e[0]});for(var C=0;C<E;++C)for(var z=P[C],U=z[1],H=z[2],M=0;M<E;++M)H[M]&&(I[M]=U);for(var q=r(E),C=0;C<E;++C)q[C].push(I[C]),q[I[C]].push(C);for(var G={},Y=o(T,!1),C=0;C<E;++C)for(var B=L[C],F=B.length,M=0;M<F;++M){var W=B[M],a=B[(M+1)%F],b=l(W,a)+":"+s(W,a);if(b in G){var X=G[b];q[X].push(C),q[C].push(X),Y[W]=Y[a]=!0}else G[b]=C}for(var Z=[],K=o(E,-1),C=0;C<E;++C)I[C]!==C||v(L[C])?K[C]=-1:(Z.push(C),K[C]=0);for(var w=[];0<Z.length;){var $=Z.pop(),J=q[$];y(J,function(e,t){return e-t});var Q=J.length,ee=K[$],p;if(0===ee){var B=L[$];p=[B]}for(var C=0,te;C<Q;++C)if((te=J[C],!(0<=K[te]))&&(K[te]=1^ee,Z.push(te),0===ee)){var B=L[te];v(B)||(B.reverse(),p.push(B))}0===ee&&w.push(p)}return w}t.exports=i;var d=e("edges-to-adjacency-list"),u=e("planar-dual"),g=e("point-in-big-polygon"),m=e("two-product"),h=e("robust-sum"),y=e("uniq"),x=e("./lib/trim-leaves")},{"./lib/trim-leaves":451,"edges-to-adjacency-list":118,"planar-dual":450,"point-in-big-polygon":1248,"robust-sum":1282,"two-product":1315,uniq:1331}],453:[function(e){'use strict';var t=e("../src/lib"),a={"X,X div":"direction:ltr;font-family:'Open Sans', verdana, arial, sans-serif;margin:0;padding:0;","X input,X button":"font-family:'Open Sans', verdana, arial, sans-serif;","X input:focus,X button:focus":"outline:none;","X a":"text-decoration:none;","X a:hover":"text-decoration:none;","X .crisp":"shape-rendering:crispEdges;","X .user-select-none":"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;","X svg":"overflow:hidden;","X svg a":"fill:#447adb;","X svg a:hover":"fill:#3c6dc5;","X .main-svg":"position:absolute;top:0;left:0;pointer-events:none;","X .main-svg .draglayer":"pointer-events:all;","X .cursor-default":"cursor:default;","X .cursor-pointer":"cursor:pointer;","X .cursor-crosshair":"cursor:crosshair;","X .cursor-move":"cursor:move;","X .cursor-col-resize":"cursor:col-resize;","X .cursor-row-resize":"cursor:row-resize;","X .cursor-ns-resize":"cursor:ns-resize;","X .cursor-ew-resize":"cursor:ew-resize;","X .cursor-sw-resize":"cursor:sw-resize;","X .cursor-s-resize":"cursor:s-resize;","X .cursor-se-resize":"cursor:se-resize;","X .cursor-w-resize":"cursor:w-resize;","X .cursor-e-resize":"cursor:e-resize;","X .cursor-nw-resize":"cursor:nw-resize;","X .cursor-n-resize":"cursor:n-resize;","X .cursor-ne-resize":"cursor:ne-resize;","X .cursor-grab":"cursor:-webkit-grab;cursor:grab;","X .modebar":"position:absolute;top:2px;right:2px;","X .ease-bg":"-webkit-transition:background-color 0.3s ease 0s;-moz-transition:background-color 0.3s ease 0s;-ms-transition:background-color 0.3s ease 0s;-o-transition:background-color 0.3s ease 0s;transition:background-color 0.3s ease 0s;","X .modebar--hover>:not(.watermark)":"opacity:0;-webkit-transition:opacity 0.3s ease 0s;-moz-transition:opacity 0.3s ease 0s;-ms-transition:opacity 0.3s ease 0s;-o-transition:opacity 0.3s ease 0s;transition:opacity 0.3s ease 0s;","X:hover .modebar--hover .modebar-group":"opacity:1;","X .modebar-group":"float:left;display:inline-block;box-sizing:border-box;padding-left:8px;position:relative;vertical-align:middle;white-space:nowrap;","X .modebar-btn":"position:relative;font-size:16px;padding:3px 4px;height:22px;cursor:pointer;line-height:normal;box-sizing:border-box;","X .modebar-btn svg":"position:relative;top:2px;","X .modebar.vertical":"display:flex;flex-direction:column;flex-wrap:wrap;align-content:flex-end;max-height:100%;","X .modebar.vertical svg":"top:-1px;","X .modebar.vertical .modebar-group":"display:block;float:none;padding-left:0px;padding-bottom:8px;","X .modebar.vertical .modebar-group .modebar-btn":"display:block;text-align:center;","X [data-title]:before,X [data-title]:after":"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;","X [data-title]:hover:before,X [data-title]:hover:after":"display:block;opacity:1;","X [data-title]:before":"content:'';position:absolute;background:transparent;border:6px solid transparent;z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;","X [data-title]:after":"content:attr(data-title);background:#69738a;color:white;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;","X .vertical [data-title]:before,X .vertical [data-title]:after":"top:0%;right:200%;","X .vertical [data-title]:before":"border:6px solid transparent;border-left-color:#69738a;margin-top:8px;margin-right:-30px;","X .select-outline":"fill:none;stroke-width:1;shape-rendering:crispEdges;","X .select-outline-1":"stroke:white;","X .select-outline-2":"stroke:black;stroke-dasharray:2px 2px;",Y:"font-family:'Open Sans', verdana, arial, sans-serif;position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;","Y p":"margin:0;","Y .notifier-note":"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,0.9);color:#fff;padding:10px;overflow-wrap:break-word;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto;","Y .notifier-close":"color:#fff;opacity:0.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;","Y .notifier-close:hover":"color:#444;text-decoration:none;cursor:pointer;"};for(var o in a){var r=o.replace(/^,/," ,").replace(/X/g,".js-plotly-plot .plotly").replace(/Y/g,".plotly-notifier");t.addStyleRule(r,a[o])}},{"../src/lib":657}],454:[function(e,t){'use strict';t.exports=e("../src/transforms/aggregate")},{"../src/transforms/aggregate":1239}],455:[function(e,t){'use strict';t.exports=e("../src/traces/bar")},{"../src/traces/bar":806}],456:[function(e,t){'use strict';t.exports=e("../src/traces/barpolar")},{"../src/traces/barpolar":819}],457:[function(e,t){'use strict';t.exports=e("../src/traces/box")},{"../src/traces/box":829}],458:[function(e,t){'use strict';t.exports=e("../src/components/calendars")},{"../src/components/calendars":522}],459:[function(e,t){'use strict';t.exports=e("../src/traces/candlestick")},{"../src/traces/candlestick":838}],460:[function(e,t){'use strict';t.exports=e("../src/traces/carpet")},{"../src/traces/carpet":857}],461:[function(e,t){'use strict';t.exports=e("../src/traces/choropleth")},{"../src/traces/choropleth":871}],462:[function(e,t){'use strict';t.exports=e("../src/traces/choroplethmapbox")},{"../src/traces/choroplethmapbox":878}],463:[function(e,t){'use strict';t.exports=e("../src/traces/cone")},{"../src/traces/cone":884}],464:[function(e,t){'use strict';t.exports=e("../src/traces/contour")},{"../src/traces/contour":899}],465:[function(e,t){'use strict';t.exports=e("../src/traces/contourcarpet")},{"../src/traces/contourcarpet":910}],466:[function(e,t){'use strict';t.exports=e("../src/core")},{"../src/core":635}],467:[function(e,t){'use strict';t.exports=e("../src/traces/densitymapbox")},{"../src/traces/densitymapbox":918}],468:[function(e,t){'use strict';t.exports=e("../src/transforms/filter")},{"../src/transforms/filter":1240}],469:[function(e,t){'use strict';t.exports=e("../src/traces/funnel")},{"../src/traces/funnel":928}],470:[function(e,t){'use strict';t.exports=e("../src/traces/funnelarea")},{"../src/traces/funnelarea":937}],471:[function(e,t){'use strict';t.exports=e("../src/transforms/groupby")},{"../src/transforms/groupby":1241}],472:[function(e,t){'use strict';t.exports=e("../src/traces/heatmap")},{"../src/traces/heatmap":950}],473:[function(e,t){'use strict';t.exports=e("../src/traces/heatmapgl")},{"../src/traces/heatmapgl":959}],474:[function(e,t){'use strict';t.exports=e("../src/traces/histogram")},{"../src/traces/histogram":971}],475:[function(e,t){'use strict';t.exports=e("../src/traces/histogram2d")},{"../src/traces/histogram2d":977}],476:[function(e,t){'use strict';t.exports=e("../src/traces/histogram2dcontour")},{"../src/traces/histogram2dcontour":981}],477:[function(e,t){'use strict';t.exports=e("../src/traces/image")},{"../src/traces/image":988}],478:[function(e,t){'use strict';var a=e("./core");a.register([e("./bar"),e("./box"),e("./heatmap"),e("./histogram"),e("./histogram2d"),e("./histogram2dcontour"),e("./contour"),e("./scatterternary"),e("./violin"),e("./funnel"),e("./waterfall"),e("./image"),e("./pie"),e("./sunburst"),e("./treemap"),e("./funnelarea"),e("./scatter3d"),e("./surface"),e("./isosurface"),e("./volume"),e("./mesh3d"),e("./cone"),e("./streamtube"),e("./scattergeo"),e("./choropleth"),e("./scattergl"),e("./splom"),e("./pointcloud"),e("./heatmapgl"),e("./parcoords"),e("./parcats"),e("./scattermapbox"),e("./choroplethmapbox"),e("./densitymapbox"),e("./sankey"),e("./indicator"),e("./table"),e("./carpet"),e("./scattercarpet"),e("./contourcarpet"),e("./ohlc"),e("./candlestick"),e("./scatterpolar"),e("./scatterpolargl"),e("./barpolar")]),a.register([e("./aggregate"),e("./filter"),e("./groupby"),e("./sort")]),a.register([e("./calendars")]),t.exports=a},{"./aggregate":454,"./bar":455,"./barpolar":456,"./box":457,"./calendars":458,"./candlestick":459,"./carpet":460,"./choropleth":461,"./choroplethmapbox":462,"./cone":463,"./contour":464,"./contourcarpet":465,"./core":466,"./densitymapbox":467,"./filter":468,"./funnel":469,"./funnelarea":470,"./groupby":471,"./heatmap":472,"./heatmapgl":473,"./histogram":474,"./histogram2d":475,"./histogram2dcontour":476,"./image":477,"./indicator":479,"./isosurface":480,"./mesh3d":481,"./ohlc":482,"./parcats":483,"./parcoords":484,"./pie":485,"./pointcloud":486,"./sankey":487,"./scatter3d":488,"./scattercarpet":489,"./scattergeo":490,"./scattergl":491,"./scattermapbox":492,"./scatterpolar":493,"./scatterpolargl":494,"./scatterternary":495,"./sort":496,"./splom":497,"./streamtube":498,"./sunburst":499,"./surface":500,"./table":501,"./treemap":502,"./violin":503,"./volume":504,"./waterfall":505}],479:[function(e,t){'use strict';t.exports=e("../src/traces/indicator")},{"../src/traces/indicator":996}],480:[function(e,t){'use strict';t.exports=e("../src/traces/isosurface")},{"../src/traces/isosurface":1002}],481:[function(e,t){'use strict';t.exports=e("../src/traces/mesh3d")},{"../src/traces/mesh3d":1007}],482:[function(e,t){'use strict';t.exports=e("../src/traces/ohlc")},{"../src/traces/ohlc":1012}],483:[function(e,t){'use strict';t.exports=e("../src/traces/parcats")},{"../src/traces/parcats":1021}],484:[function(e,t){'use strict';t.exports=e("../src/traces/parcoords")},{"../src/traces/parcoords":1031}],485:[function(e,t){'use strict';t.exports=e("../src/traces/pie")},{"../src/traces/pie":1042}],486:[function(e,t){'use strict';t.exports=e("../src/traces/pointcloud")},{"../src/traces/pointcloud":1051}],487:[function(e,t){'use strict';t.exports=e("../src/traces/sankey")},{"../src/traces/sankey":1057}],488:[function(e,t){'use strict';t.exports=e("../src/traces/scatter3d")},{"../src/traces/scatter3d":1094}],489:[function(e,t){'use strict';t.exports=e("../src/traces/scattercarpet")},{"../src/traces/scattercarpet":1101}],490:[function(e,t){'use strict';t.exports=e("../src/traces/scattergeo")},{"../src/traces/scattergeo":1109}],491:[function(e,t){'use strict';t.exports=e("../src/traces/scattergl")},{"../src/traces/scattergl":1122}],492:[function(e,t){'use strict';t.exports=e("../src/traces/scattermapbox")},{"../src/traces/scattermapbox":1132}],493:[function(e,t){'use strict';t.exports=e("../src/traces/scatterpolar")},{"../src/traces/scatterpolar":1140}],494:[function(e,t){'use strict';t.exports=e("../src/traces/scatterpolargl")},{"../src/traces/scatterpolargl":1147}],495:[function(e,t){'use strict';t.exports=e("../src/traces/scatterternary")},{"../src/traces/scatterternary":1155}],496:[function(e,t){'use strict';t.exports=e("../src/transforms/sort")},{"../src/transforms/sort":1243}],497:[function(e,t){'use strict';t.exports=e("../src/traces/splom")},{"../src/traces/splom":1164}],498:[function(e,t){'use strict';t.exports=e("../src/traces/streamtube")},{"../src/traces/streamtube":1172}],499:[function(e,t){'use strict';t.exports=e("../src/traces/sunburst")},{"../src/traces/sunburst":1180}],500:[function(e,t){'use strict';t.exports=e("../src/traces/surface")},{"../src/traces/surface":1189}],501:[function(e,t){'use strict';t.exports=e("../src/traces/table")},{"../src/traces/table":1197}],502:[function(e,t){'use strict';t.exports=e("../src/traces/treemap")},{"../src/traces/treemap":1206}],503:[function(e,t){'use strict';t.exports=e("../src/traces/violin")},{"../src/traces/violin":1218}],504:[function(e,t){'use strict';t.exports=e("../src/traces/volume")},{"../src/traces/volume":1226}],505:[function(e,t){'use strict';t.exports=e("../src/traces/waterfall")},{"../src/traces/waterfall":1234}],506:[function(e,t){'use strict';t.exports=[{path:"",backoff:0},{path:"M-2.4,-3V3L0.6,0Z",backoff:.6},{path:"M-3.7,-2.5V2.5L1.3,0Z",backoff:1.3},{path:"M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z",backoff:1.55},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",backoff:1.6},{path:"M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z",backoff:2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",backoff:0,noRotate:!0},{path:"M2,2V-2H-2V2Z",backoff:0,noRotate:!0}]},{}],507:[function(e,t){'use strict';var a=e("./arrow_paths"),o=e("../../plots/font_attributes"),r=e("../../plots/cartesian/constants"),i=e("../../plot_api/plot_template").templatedArray;t.exports=i("annotation",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},text:{valType:"string",editType:"calc+arraydraw"},textangle:{valType:"angle",dflt:0,editType:"calc+arraydraw"},font:o({editType:"calc+arraydraw",colorEditType:"arraydraw"}),width:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},height:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},align:{valType:"enumerated",values:["left","center","right"],dflt:"center",editType:"arraydraw"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"arraydraw"},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},bordercolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},borderpad:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},borderwidth:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},showarrow:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},arrowcolor:{valType:"color",editType:"arraydraw"},arrowhead:{valType:"integer",min:0,max:a.length,dflt:1,editType:"arraydraw"},startarrowhead:{valType:"integer",min:0,max:a.length,dflt:1,editType:"arraydraw"},arrowside:{valType:"flaglist",flags:["end","start"],extras:["none"],dflt:"end",editType:"arraydraw"},arrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},startarrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},arrowwidth:{valType:"number",min:.1,editType:"calc+arraydraw"},standoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},startstandoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},ax:{valType:"any",editType:"calc+arraydraw"},ay:{valType:"any",editType:"calc+arraydraw"},axref:{valType:"enumerated",dflt:"pixel",values:["pixel",r.idRegex.x.toString()],editType:"calc"},ayref:{valType:"enumerated",dflt:"pixel",values:["pixel",r.idRegex.y.toString()],editType:"calc"},xref:{valType:"enumerated",values:["paper",r.idRegex.x.toString()],editType:"calc"},x:{valType:"any",editType:"calc+arraydraw"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto",editType:"calc+arraydraw"},xshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},yref:{valType:"enumerated",values:["paper",r.idRegex.y.toString()],editType:"calc"},y:{valType:"any",editType:"calc+arraydraw"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"calc+arraydraw"},yshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},clicktoshow:{valType:"enumerated",values:[!1,"onoff","onout"],dflt:!1,editType:"arraydraw"},xclick:{valType:"any",editType:"arraydraw"},yclick:{valType:"any",editType:"arraydraw"},hovertext:{valType:"string",editType:"arraydraw"},hoverlabel:{bgcolor:{valType:"color",editType:"arraydraw"},bordercolor:{valType:"color",editType:"arraydraw"},font:o({editType:"arraydraw"}),editType:"arraydraw"},captureevents:{valType:"boolean",editType:"arraydraw"},editType:"calc",_deprecated:{ref:{valType:"string",editType:"calc"}}})},{"../../plot_api/plot_template":695,"../../plots/cartesian/constants":711,"../../plots/font_attributes":733,"./arrow_paths":506}],508:[function(e,t){'use strict';var r=Math.max;function a(e){var t=e._fullLayout;i.filterVisible(t.annotations).forEach(function(t){var a=n.getFromId(e,t.xref),r=n.getFromId(e,t.yref);t._extremes={},a&&o(t,a),r&&o(t,r)})}function o(e,t){var a=t._id,o=a.charAt(0),i=e[o],l=e["a"+o],s=e[o+"ref"],d=e["a"+o+"ref"],c=e["_"+o+"padplus"],p=e["_"+o+"padminus"],u={x:1,y:-1}[o]*e[o+"shift"],g=3*e.arrowsize*e.arrowwidth||0,m=g+u,h=g-u,y=3*e.startarrowsize*e.arrowwidth||0,f=y+u,x=y-u,_;if(d===s){var b=n.findExtremes(t,[t.r2c(i)],{ppadplus:m,ppadminus:h}),v=n.findExtremes(t,[t.r2c(l)],{ppadplus:r(c,f),ppadminus:r(p,x)});_={min:[b.min[0],v.min[0]],max:[b.max[0],v.max[0]]}}else f=l?f+l:f,x=l?x-l:x,_=n.findExtremes(t,[t.r2c(i)],{ppadplus:r(c,m,f),ppadminus:r(p,h,x)});e._extremes[a]=_}var i=e("../../lib"),n=e("../../plots/cartesian/axes"),l=e("./draw").draw;t.exports=function(e){var t=e._fullLayout,o=i.filterVisible(t.annotations);if(o.length&&e._fullData.length)return i.syncOrAsync([l,a],e)}},{"../../lib":657,"../../plots/cartesian/axes":705,"./draw":513}],509:[function(e,t){'use strict';function a(e,t){var a=e._fullLayout.annotations,r=[],n=[],l=[],s=(t||[]).length,d,c,p,u,g,m,h,y;for(d=0;d<a.length;d++)if(p=a[d],u=p.clicktoshow,u){for(c=0;c<s;c++)if(g=t[c],m=g.xaxis,h=g.yaxis,m._id===p.xref&&h._id===p.yref&&m.d2r(g.x)===o(p._xclick,m)&&h.d2r(g.y)===o(p._yclick,h)){y=p.visible?"onout"===u?n:l:r,y.push(d);break}c===s&&p.visible&&"onout"===u&&n.push(d)}return{on:r,off:n,explicitOff:l}}function o(e,t){return"log"===t.type?t.l2r(e):t.d2r(e)}var r=e("../../lib"),n=e("../../registry"),l=e("../../plot_api/plot_template").arrayEditor;t.exports={hasClickToShow:function(e,t){var o=a(e,t);return 0<o.on.length||0<o.explicitOff.length},onClick:function(e,t){var o=a(e,t),s=o.on,d=o.off.concat(o.explicitOff),c={},p=e._fullLayout.annotations,u,g;if(s.length||d.length){for(u=0;u<s.length;u++)g=l(e.layout,"annotations",p[s[u]]),g.modifyItem("visible",!0),r.extendFlat(c,g.getUpdateObj());for(u=0;u<d.length;u++)g=l(e.layout,"annotations",p[d[u]]),g.modifyItem("visible",!1),r.extendFlat(c,g.getUpdateObj());return n.call("update",e,{},c)}}}},{"../../lib":657,"../../plot_api/plot_template":695,"../../registry":788}],510:[function(e,t){'use strict';var a=e("../../lib"),o=e("../color");t.exports=function(e,t,r,i){i("opacity");var n=i("bgcolor"),l=i("bordercolor"),s=o.opacity(l);i("borderpad");var d=i("borderwidth"),c=i("showarrow");i("text",c?" ":r._dfltTitle.annotation),i("textangle"),a.coerceFont(i,"font",r.font),i("width"),i("align");var p=i("height");if(p&&i("valign"),c){var u=i("arrowside"),g,m;-1!==u.indexOf("end")&&(g=i("arrowhead"),m=i("arrowsize")),-1!==u.indexOf("start")&&(i("startarrowhead",g),i("startarrowsize",m)),i("arrowcolor",s?t.bordercolor:o.defaultLine),i("arrowwidth",2*(s&&d||1)),i("standoff"),i("startstandoff")}var h=i("hovertext"),y=r.hoverlabel||{};if(h){var f=i("hoverlabel.bgcolor",y.bgcolor||(o.opacity(n)?o.rgb(n):o.defaultLine)),x=i("hoverlabel.bordercolor",y.bordercolor||o.contrast(f));a.coerceFont(i,"hoverlabel.font",{family:y.font.family,size:y.font.size,color:y.font.color||x})}i("captureevents",!!h)}},{"../../lib":657,"../color":524}],511:[function(e,t){'use strict';var a=Math.pow,o=e("fast-isnumeric"),r=e("../../lib/to_log_range");t.exports=function(e,t,n,l){function s(e){var i=m[e],n=null;n=d?r(i,t.range):a(10,i),o(n)||(n=null),l(h+e,n)}t=t||{};var d="log"===n&&"linear"===t.type,c="linear"===n&&"log"===t.type;if(d||c)for(var p=e._fullLayout.annotations,u=t._id.charAt(0),g=0,m,h;g<p.length;g++)m=p[g],h="annotations["+g+"].",m[u+"ref"]===t._id&&s(u),m["a"+u+"ref"]===t._id&&s("a"+u)}},{"../../lib/to_log_range":683,"fast-isnumeric":201}],512:[function(e,t){'use strict';function a(e,t,a){function s(a,r){return o.coerce(e,t,l,a,r)}var d=s("visible"),c=s("clicktoshow");if(d||c){n(e,t,a,s);for(var p=t.showarrow,u=["x","y"],g=[-10,-30],m={_fullLayout:a},h=0;2>h;h++){var y=u[h],f=r.coerceRef(e,t,m,y,"","paper");if("paper"!==f){var x=r.getFromId(m,f);x._annIndices.push(t._index)}if(r.coercePosition(t,m,s,f,y,.5),p){var _="a"+y,b=r.coerceRef(e,t,m,_,"pixel");"pixel"!==b&&b!==f&&(b=t[_]="pixel");var v="pixel"===b?g[h]:.4;r.coercePosition(t,m,s,b,_,v)}s(y+"anchor"),s(y+"shift")}if(o.noneOrAll(e,t,["x","y"]),p&&o.noneOrAll(e,t,["ax","ay"]),c){var w=s("xclick"),k=s("yclick");t._xclick=void 0===w?t.x:r.cleanPosition(w,m,t.xref),t._yclick=void 0===k?t.y:r.cleanPosition(k,m,t.yref)}}}var o=e("../../lib"),r=e("../../plots/cartesian/axes"),i=e("../../plots/array_container_defaults"),n=e("./common_defaults"),l=e("./attributes");t.exports=function(e,t){i(e,t,{name:"annotations",handleItemDefaults:a})}},{"../../lib":657,"../../plots/array_container_defaults":701,"../../plots/cartesian/axes":705,"./attributes":507,"./common_defaults":510}],513:[function(e,t){'use strict';var r=Math.cos,i=Math.sqrt,n=Math.round,l=Math.PI,s=Math.sin,d=Math.min,c=Math.pow,p=Math.abs,u=Math.max;function a(e,t){var a=e._fullLayout,r=a.annotations[t]||{},i=f.getFromId(e,r.xref),n=f.getFromId(e,r.yref);i&&i.setScale(),n&&n.setScale(),o(e,r,t,!1,i,n)}function o(e,t,a,o,h,f){function S(e){var r={index:a,annotation:t._input,fullAnnotation:t,event:e};return o&&(r.subplotId=o),r}function C(a){return a.call(_.font,J).attr({"text-anchor":{left:"start",right:"end"}[t.align]||"middle"}),v.convertToTspans(a,e,L),a}function L(){function a(e,t){return"auto"===t&&(e<1/3?t="left":e>2/3?t="right":t="center"),{center:0,middle:0,left:.5,bottom:-.5,right:-.5,top:.5}[t]}var g=ee.selectAll("a");if(1===g.size()&&g.text()===ee.text()){var b=G.insert("a",":first-child").attr({"xlink:xlink:href":g.attr("xlink:href"),"xlink:xlink:show":g.attr("xlink:show")}).style({cursor:"pointer"});b.node().appendChild(Z.node())}for(var T=G.select(".annotation-text-math-group"),C=!T.empty(),L=_.bBox((C?T:ee).node()),z=L.width,D=L.height,O=t.width||z,q=t.height||D,W=n(O+2*X),J=n(q+2*X),Q=!1,te=["x","y"],ae=0;ae<te.length;ae++){var oe=te[ae],re=t[oe+"ref"]||oe,ie=t["a"+oe+"ref"],ne={x:h,y:f}[oe],le=(N+("x"===oe?0:-90))*l/180,se=W*r(le),de=J*s(le),ce=p(se)+p(de),pe=t[oe+"anchor"],ue=t[oe+"shift"]*("x"===oe?1:-1),ge=F[oe],me,he,ye,fe,xe;if(ne){var _e=ne.r2fraction(t[oe]);(0>_e||1<_e)&&(ie===re?(_e=ne.r2fraction(t["a"+oe]),(0>_e||1<_e)&&(Q=!0)):Q=!0),me=ne._offset+ne.r2p(t[oe]),fe=.5}else"x"===oe?(ye=t[oe],me=I.l+I.w*ye):(ye=1-t[oe],me=I.t+I.h*ye),fe=t.showarrow?.5:ye;if(t.showarrow){ge.head=me;var be=t["a"+oe];xe=se*a(.5,t.xanchor)-de*a(.5,t.yanchor),ie===re?(ge.tail=ne._offset+ne.r2p(be),he=xe):(ge.tail=me+be,he=xe+be),ge.text=ge.tail+xe;var ve=E["x"===oe?"width":"height"];if("paper"===re&&(ge.head=y.constrain(ge.head,1,ve-1)),"pixel"===ie){var we=-u(ge.tail-3,ge.text),ke=d(ge.tail+3,ge.text)-ve;0<we?(ge.tail+=we,ge.text+=we):0<ke&&(ge.tail-=ke,ge.text-=ke)}ge.tail+=ue,ge.head+=ue}else xe=ce*a(fe,pe),he=xe,ge.text=me+xe;ge.text+=ue,xe+=ue,he+=ue,t["_"+oe+"padplus"]=ce/2+he,t["_"+oe+"padminus"]=ce/2-he,t["_"+oe+"size"]=ce,t["_"+oe+"shift"]=xe}if(Q)return void G.remove();var Te=0,Ae=0;if("left"!==t.align&&(Te=(O-z)*("center"===t.align?.5:1)),"top"!==t.valign&&(Ae=(q-D)*("middle"===t.valign?.5:1)),C)T.select("svg").attr({x:X+Te-1,y:X+Ae}).call(_.setClipUrl,K?B:null,e);else{var Se=X+Ae-L.top,Ce=X+Te-L.left;ee.call(v.positionText,Ce,Se).call(_.setClipUrl,K?B:null,e)}$.select("rect").call(_.setRect,X,X,O,q),Z.call(_.setRect,Y/2,Y/2,W-Y,J-Y),G.call(_.setTranslate,n(F.x.text-W/2),n(F.y.text-J/2)),U.attr({transform:"rotate("+N+","+F.x.text+","+F.y.text+")"});var Le=function(a,r){V.selectAll(".annotation-arrow-g").remove();var n=F.x.head,l=F.y.head,s=F.x.tail+a,d=F.y.tail+r,p=F.x.text+a,u=F.y.text+r,g=y.rotationXYMatrix(N,p,u),b=y.apply2DTransform(g),v=y.apply2DTransform2(g),w=+Z.attr("width"),T=+Z.attr("height"),S=p-.5*w,C=S+w,L=u-.5*T,E=L+T,z=[[S,L,S,E],[S,E,C,E],[C,E,C,L],[C,L,S,L]].map(v);if(!z.reduce(function(e,t){return e^!!y.segmentsIntersect(n,l,n+1e6,l+1e6,t[0],t[1],t[2],t[3])},!1)){z.forEach(function(e){var t=y.segmentsIntersect(s,d,n,l,e[0],e[1],e[2],e[3]);t&&(s=t.x,d=t.y)});var D=t.arrowwidth,O=t.arrowcolor,B=t.arrowside,H=V.append("g").style({opacity:x.opacity(O)}).classed("annotation-arrow-g",!0),q=H.append("path").attr("d","M"+s+","+d+"L"+n+","+l).style("stroke-width",D+"px").call(x.stroke,x.rgb(O));if(A(q,B,t),P.annotationPosition&&q.node().parentNode&&!o){var Y=n,W=l;if(t.standoff){var X=i(c(n-s,2)+c(l-d,2));Y+=t.standoff*(s-n)/X,W+=t.standoff*(d-l)/X}var K=H.append("path").classed("annotation-arrow",!0).classed("anndrag",!0).classed("cursor-move",!0).attr({d:"M3,3H-3V-3H3ZM0,0L"+(s-Y)+","+(d-W),transform:"translate("+Y+","+W+")"}).style("stroke-width",D+6+"px").call(x.stroke,"rgba(0,0,0,0)").call(x.fill,"rgba(0,0,0,0)"),$,J;k.init({element:K.node(),gd:e,prepFn:function(){var e=_.getTranslate(G);$=e.x,J=e.y,h&&h.autorange&&R(h._name+".autorange",!0),f&&f.autorange&&R(f._name+".autorange",!0)},moveFn:function(e,a){var o=b($,J),r=o[0]+e,i=o[1]+a;G.call(_.setTranslate,r,i),M("x",h?h.p2r(h.r2p(t.x)+e):t.x+e/I.w),M("y",f?f.p2r(f.r2p(t.y)+a):t.y-a/I.h),t.axref===t.xref&&M("ax",h.p2r(h.r2p(t.ax)+e)),t.ayref===t.yref&&M("ay",f.p2r(f.r2p(t.ay)+a)),H.attr("transform","translate("+e+","+a+")"),U.attr({transform:"rotate("+N+","+r+","+i+")"})},doneFn:function(){m.call("_guiRelayout",e,j());var t=document.querySelector(".js-notes-box-panel");t&&t.redraw(t.selectedObj)}})}}};if(t.showarrow&&Le(0,0),H){var Ee;k.init({element:G.node(),gd:e,prepFn:function(){Ee=U.attr("transform")},moveFn:function(e,a){var r="pointer";if(t.showarrow)t.axref===t.xref?M("ax",h.p2r(h.r2p(t.ax)+e)):M("ax",t.ax+e),t.ayref===t.yref?M("ay",f.p2r(f.r2p(t.ay)+a)):M("ay",t.ay+a),Le(e,a);else if(!o){var i,n;if(h)i=h.p2r(h.r2p(t.x)+e);else{var l=t._xsize/I.w,s=t.x+(t._xshift-t.xshift)/I.w-l/2;i=k.align(s+e/I.w,l,0,1,t.xanchor)}if(f)n=f.p2r(f.r2p(t.y)+a);else{var d=t._ysize/I.h,c=t.y-(t._yshift+t.yshift)/I.h-d/2;n=k.align(c-a/I.h,d,0,1,t.yanchor)}M("x",i),M("y",n),h&&f||(r=k.getCursor(h?.5:i,f?.5:n,t.xanchor,t.yanchor))}else return;U.attr({transform:"translate("+e+","+a+")"+Ee}),w(G,r)},clickFn:function(a,o){t.captureevents&&e.emit("plotly_clickannotation",S(o))},doneFn:function(){w(G),m.call("_guiRelayout",e,j());var t=document.querySelector(".js-notes-box-panel");t&&t.redraw(t.selectedObj)}})}}var E=e._fullLayout,I=e._fullLayout._size,P=e._context.edits,z,D;o?(z="annotation-"+o,D=o+".annotations"):(z="annotation",D="annotations");var O=T(e.layout,D,t),R=O.modifyBase,M=O.modifyItem,j=O.getUpdateObj;E._infolayer.selectAll("."+z+"[data-index=\""+a+"\"]").remove();var B="clip"+E._uid+"_ann"+a;if(!t._input||!1===t.visible)return void g.selectAll("#"+B).remove();var F={x:{},y:{}},N=+t.textangle||0,V=E._infolayer.append("g").classed(z,!0).attr("data-index",a+"").style("opacity",t.opacity),U=V.append("g").classed("annotation-text-g",!0),H=P[t.showarrow?"annotationTail":"annotationPosition"],q=t.captureevents||P.annotationText||H,G=U.append("g").style("pointer-events",q?"all":null).call(w,"pointer").on("click",function(){e._dragging=!1,e.emit("plotly_clickannotation",S(g.event))});t.hovertext&&G.on("mouseover",function(){var a=t.hoverlabel,o=a.font,r=this.getBoundingClientRect(),i=e.getBoundingClientRect();b.loneHover({x0:r.left-i.left,x1:r.right-i.left,y:(r.top+r.bottom)/2-i.top,text:t.hovertext,color:a.bgcolor,borderColor:a.bordercolor,fontFamily:o.family,fontSize:o.size,fontColor:o.color},{container:E._hoverlayer.node(),outerContainer:E._paper.node(),gd:e})}).on("mouseout",function(){b.loneUnhover(E._hoverlayer.node())});var Y=t.borderwidth,W=t.borderpad,X=Y+W,Z=G.append("rect").attr("class","bg").style("stroke-width",Y+"px").call(x.stroke,t.bordercolor).call(x.fill,t.bgcolor),K=t.width||t.height,$=E._topclips.selectAll("#"+B).data(K?[0]:[]);$.enter().append("clipPath").classed("annclip",!0).attr("id",B).append("rect"),$.exit().remove();var J=t.font,Q=E._meta?y.templateString(t.text,E._meta):t.text,ee=G.append("text").classed("annotation-text",!0).text(Q);P.annotationText?ee.call(v.makeEditable,{delegate:G,gd:e}).call(C).on("edit",function(a){t.text=a,this.call(C),M("text",a),h&&h.autorange&&R(h._name+".autorange",!0),f&&f.autorange&&R(f._name+".autorange",!0),m.call("_guiRelayout",e,j())}):ee.call(C)}var g=e("d3"),m=e("../../registry"),h=e("../../plots/plots"),y=e("../../lib"),f=e("../../plots/cartesian/axes"),x=e("../color"),_=e("../drawing"),b=e("../fx"),v=e("../../lib/svg_text_utils"),w=e("../../lib/setcursor"),k=e("../dragelement"),T=e("../../plot_api/plot_template").arrayEditor,A=e("./draw_arrow_head");t.exports={draw:function(e){var t=e._fullLayout;t._infolayer.selectAll(".annotation").remove();for(var o=0;o<t.annotations.length;o++)t.annotations[o].visible&&a(e,o);return h.previousPromises(e)},drawOne:a,drawRaw:o}},{"../../lib":657,"../../lib/setcursor":677,"../../lib/svg_text_utils":681,"../../plot_api/plot_template":695,"../../plots/cartesian/axes":705,"../../plots/plots":768,"../../registry":788,"../color":524,"../dragelement":543,"../drawing":546,"../fx":564,"./draw_arrow_head":514,d3:108}],514:[function(e,t){'use strict';var a=Math.atan2,o=Math.cos,r=Math.sqrt,i=Math.PI,n=Math.sin,l=Math.min,s=Math.max,d=e("d3"),c=e("../color"),p=e("./arrow_paths");t.exports=function(e,t,u){function g(){e.style("stroke-dasharray","0px,100px")}function m(t,a,o,r){t.path&&(t.noRotate&&(o=0),d.select(h.parentNode).append("path").attr({class:e.attr("class"),d:t.path,transform:"translate("+a.x+","+a.y+")"+(o?"rotate("+180*o/i+")":"")+"scale("+r+")"}).style({fill:c.rgb(u.arrowcolor),"stroke-width":0}))}var h=e.node(),y=p[u.arrowhead||0],f=p[u.startarrowhead||0],x=(u.arrowwidth||1)*(u.arrowsize||1),_=(u.arrowwidth||1)*(u.startarrowsize||1),b=0<=t.indexOf("start"),v=0<=t.indexOf("end"),w=y.backoff*x+u.standoff,k=f.backoff*_+u.startstandoff,T,A,S,C;if("line"===h.nodeName){T={x:+e.attr("x1"),y:+e.attr("y1")},A={x:+e.attr("x2"),y:+e.attr("y2")};var L=T.x-A.x,E=T.y-A.y;if(S=a(E,L),C=S+i,w&&k&&w+k>r(L*L+E*E))return void g();if(w){if(w*w>L*L+E*E)return void g();var I=w*o(S),P=w*n(S);A.x+=I,A.y+=P,e.attr({x2:A.x,y2:A.y})}if(k){if(k*k>L*L+E*E)return void g();var z=k*o(S),D=k*n(S);T.x-=z,T.y-=D,e.attr({x1:T.x,y1:T.y})}}else if("path"===h.nodeName){var O=h.getTotalLength(),R="";if(O<w+k)return void g();var M=h.getPointAtLength(0),j=h.getPointAtLength(.1);S=a(M.y-j.y,M.x-j.x),T=h.getPointAtLength(l(k,O)),R="0px,"+k+"px,";var B=h.getPointAtLength(O),F=h.getPointAtLength(O-.1);C=a(B.y-F.y,B.x-F.x),A=h.getPointAtLength(s(0,O-w));var N=R?k+w:w;R+=O-N+"px,"+O+"px",e.style("stroke-dasharray",R)}b&&m(f,T,S,_),v&&m(y,A,C,x)}},{"../color":524,"./arrow_paths":506,d3:108}],515:[function(e,t){'use strict';var a=e("./draw"),o=e("./click");t.exports={moduleType:"component",name:"annotations",layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),includeBasePlot:e("../../plots/cartesian/include_components")("annotations"),calcAutorange:e("./calc_autorange"),draw:a.draw,drawOne:a.drawOne,drawRaw:a.drawRaw,hasClickToShow:o.hasClickToShow,onClick:o.onClick,convertCoords:e("./convert_coords")}},{"../../plots/cartesian/include_components":717,"./attributes":507,"./calc_autorange":508,"./click":509,"./convert_coords":511,"./defaults":512,"./draw":513}],516:[function(e,t){'use strict';var a=e("../annotations/attributes"),o=e("../../plot_api/edit_types").overrideAll,r=e("../../plot_api/plot_template").templatedArray;t.exports=o(r("annotation",{visible:a.visible,x:{valType:"any"},y:{valType:"any"},z:{valType:"any"},ax:{valType:"number"},ay:{valType:"number"},xanchor:a.xanchor,xshift:a.xshift,yanchor:a.yanchor,yshift:a.yshift,text:a.text,textangle:a.textangle,font:a.font,width:a.width,height:a.height,opacity:a.opacity,align:a.align,valign:a.valign,bgcolor:a.bgcolor,bordercolor:a.bordercolor,borderpad:a.borderpad,borderwidth:a.borderwidth,showarrow:a.showarrow,arrowcolor:a.arrowcolor,arrowhead:a.arrowhead,startarrowhead:a.startarrowhead,arrowside:a.arrowside,arrowsize:a.arrowsize,startarrowsize:a.startarrowsize,arrowwidth:a.arrowwidth,standoff:a.standoff,startstandoff:a.startstandoff,hovertext:a.hovertext,hoverlabel:a.hoverlabel,captureevents:a.captureevents}),"calc","from-root")},{"../../plot_api/edit_types":688,"../../plot_api/plot_template":695,"../annotations/attributes":507}],517:[function(e,t){'use strict';function a(e,t){var a=t.fullSceneLayout,i=a.domain,n=t.fullLayout._size,l={pdata:null,type:"linear",autorange:!1,range:[-Infinity,1/0]};e._xa={},o.extendFlat(e._xa,l),r.setConvert(e._xa),e._xa._offset=n.l+i.x[0]*n.w,e._xa.l2p=function(){return .5*(1+e._pdata[0]/e._pdata[3])*n.w*(i.x[1]-i.x[0])},e._ya={},o.extendFlat(e._ya,l),r.setConvert(e._ya),e._ya._offset=n.t+(1-i.y[1])*n.h,e._ya.l2p=function(){return .5*(1-e._pdata[1]/e._pdata[3])*n.h*(i.y[1]-i.y[0])}}var o=e("../../lib"),r=e("../../plots/cartesian/axes");t.exports=function(e){for(var t=e.fullSceneLayout,o=t.annotations,r=0;r<o.length;r++)a(o[r],e);e.fullLayout._infolayer.selectAll(".annotation-"+e.id).remove()}},{"../../lib":657,"../../plots/cartesian/axes":705}],518:[function(e,t){'use strict';function a(e,t,a,i){function s(a,r){return o.coerce(e,t,l,a,r)}function d(e){var o=e+"axis",i={_fullLayout:{}};return i._fullLayout[o]=a[o],r.coercePosition(t,i,s,e,e,.5)}var c=s("visible");c&&(n(e,t,i.fullLayout,s),d("x"),d("y"),d("z"),o.noneOrAll(e,t,["x","y","z"]),t.xref="x",t.yref="y",t.zref="z",s("xanchor"),s("yanchor"),s("xshift"),s("yshift"),t.showarrow&&(t.axref="pixel",t.ayref="pixel",s("ax",-10),s("ay",-30),o.noneOrAll(e,t,["ax","ay"])))}var o=e("../../lib"),r=e("../../plots/cartesian/axes"),i=e("../../plots/array_container_defaults"),n=e("../annotations/common_defaults"),l=e("./attributes");t.exports=function(e,t,o){i(e,t,{name:"annotations",handleItemDefaults:a,fullLayout:o.fullLayout})}},{"../../lib":657,"../../plots/array_container_defaults":701,"../../plots/cartesian/axes":705,"../annotations/common_defaults":510,"./attributes":516}],519:[function(e,t){'use strict';var a=e("../annotations/draw").drawRaw,o=e("../../plots/gl3d/project"),r=["x","y","z"];t.exports=function(e){for(var t=e.fullSceneLayout,n=e.dataScale,l=t.annotations,s=0;s<l.length;s++){for(var d=l[s],c=!1,p=0;3>p;p++){var u=r[p],g=d[u],m=t[u+"axis"],h=m.r2fraction(g);if(0>h||1<h){c=!0;break}}c?e.fullLayout._infolayer.select(".annotation-"+e.id+"[data-index=\""+s+"\"]").remove():(d._pdata=o(e.glplot.cameraParams,[t.xaxis.r2l(d.x)*n[0],t.yaxis.r2l(d.y)*n[1],t.zaxis.r2l(d.z)*n[2]]),a(e.graphDiv,d,s,e.id,d._xa,d._ya))}}},{"../../plots/gl3d/project":756,"../annotations/draw":513}],520:[function(e,t){'use strict';var a=e("../../registry"),o=e("../../lib");t.exports={moduleType:"component",name:"annotations3d",schema:{subplots:{scene:{annotations:e("./attributes")}}},layoutAttributes:e("./attributes"),handleDefaults:e("./defaults"),includeBasePlot:function(e,t){var r=a.subplotsRegistry.gl3d;if(r)for(var n=r.attrRegex,l=Object.keys(e),s=0,d;s<l.length;s++)d=l[s],n.test(d)&&(e[d].annotations||[]).length&&(o.pushUnique(t._basePlotModules,r),o.pushUnique(t._subplots.gl3d,d))},convert:e("./convert"),draw:e("./draw")}},{"../../lib":657,"../../registry":788,"./attributes":516,"./convert":517,"./defaults":518,"./draw":519}],521:[function(e,t){'use strict';t.exports=e("world-calendars/dist/main"),e("world-calendars/dist/plus"),e("world-calendars/dist/calendars/chinese"),e("world-calendars/dist/calendars/coptic"),e("world-calendars/dist/calendars/discworld"),e("world-calendars/dist/calendars/ethiopian"),e("world-calendars/dist/calendars/hebrew"),e("world-calendars/dist/calendars/islamic"),e("world-calendars/dist/calendars/julian"),e("world-calendars/dist/calendars/mayan"),e("world-calendars/dist/calendars/nanakshahi"),e("world-calendars/dist/calendars/nepali"),e("world-calendars/dist/calendars/persian"),e("world-calendars/dist/calendars/taiwan"),e("world-calendars/dist/calendars/thai"),e("world-calendars/dist/calendars/ummalqura")},{"world-calendars/dist/calendars/chinese":1395,"world-calendars/dist/calendars/coptic":1396,"world-calendars/dist/calendars/discworld":1397,"world-calendars/dist/calendars/ethiopian":1398,"world-calendars/dist/calendars/hebrew":1399,"world-calendars/dist/calendars/islamic":1400,"world-calendars/dist/calendars/julian":1401,"world-calendars/dist/calendars/mayan":1402,"world-calendars/dist/calendars/nanakshahi":1403,"world-calendars/dist/calendars/nepali":1404,"world-calendars/dist/calendars/persian":1405,"world-calendars/dist/calendars/taiwan":1406,"world-calendars/dist/calendars/thai":1407,"world-calendars/dist/calendars/ummalqura":1408,"world-calendars/dist/main":1409,"world-calendars/dist/plus":1410}],522:[function(e,t){'use strict';var n=Math.floor;function a(e){var t=y[e];return t?t:(t=y[e]=l.instance(e),t)}function o(e){return s.extendFlat({},u,{description:e})}function r(e){return"Sets the calendar system to use with `"+e+"` date data."}var l=e("./calendars"),s=e("../../lib"),d=e("../../constants/numerical"),c=d.EPOCHJD,p=d.ONEDAY,u={valType:"enumerated",values:Object.keys(l.calendars),editType:"calc",dflt:"gregorian"},g=function(e,t,a,o){var r={};return r[a]=u,s.coerce(e,t,r,a,o)},m="##",h={d:{0:"dd","-":"d"},e:{0:"d","-":"d"},a:{0:"D","-":"D"},A:{0:"DD","-":"DD"},j:{0:"oo","-":"o"},W:{0:"ww","-":"w"},m:{0:"mm","-":"m"},b:{0:"M","-":"M"},B:{0:"MM","-":"MM"},y:{0:"yy","-":"yy"},Y:{0:"yyyy","-":"yyyy"},U:m,w:m,c:{0:"D M d %X yyyy","-":"D M d %X yyyy"},x:{0:"mm/dd/yyyy","-":"mm/dd/yyyy"}},y={},f={xcalendar:o(r("x"))},x=s.extendFlat({},f,{ycalendar:o(r("y"))}),_=s.extendFlat({},x,{zcalendar:o(r("z"))}),b=o("Sets the calendar system to use for `range` and `tick0` if this is a date axis. This does not set the calendar for interpreting data on this axis, that's specified in the trace or via the global `layout.calendar`");t.exports={moduleType:"component",name:"calendars",schema:{traces:{scatter:x,bar:x,box:x,heatmap:x,contour:x,histogram:x,histogram2d:x,histogram2dcontour:x,scatter3d:_,surface:_,mesh3d:_,scattergl:x,ohlc:f,candlestick:f},layout:{calendar:o("Sets the default calendar system to use for interpreting and displaying dates throughout the plot.")},subplots:{xaxis:{calendar:b},yaxis:{calendar:b},scene:{xaxis:{calendar:b},yaxis:{calendar:b},zaxis:{calendar:b}},polar:{radialaxis:{calendar:b}}},transforms:{filter:{valuecalendar:o("Sets the calendar system to use for `value`, if it is a date."),targetcalendar:o("Sets the calendar system to use for `target`, if it is an array of dates. If `target` is a string (eg *x*) we use the corresponding trace attribute (eg `xcalendar`) if it exists, even if `targetcalendar` is provided.")}}},layoutAttributes:u,handleDefaults:g,handleTraceDefaults:function(e,t,a,o){for(var r=0;r<a.length;r++)g(e,t,a[r]+"calendar",o.calendar)},CANONICAL_SUNDAY:{chinese:"2000-01-02",coptic:"2000-01-03",discworld:"2000-01-03",ethiopian:"2000-01-05",hebrew:"5000-01-01",islamic:"1000-01-02",julian:"2000-01-03",mayan:"5000-01-01",nanakshahi:"1000-01-05",nepali:"2000-01-05",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-04",thai:"2000-01-04",ummalqura:"1400-01-06"},CANONICAL_TICK:{chinese:"2000-01-01",coptic:"2000-01-01",discworld:"2000-01-01",ethiopian:"2000-01-01",hebrew:"5000-01-01",islamic:"1000-01-01",julian:"2000-01-01",mayan:"5000-01-01",nanakshahi:"1000-01-01",nepali:"2000-01-01",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-01",thai:"2000-01-01",ummalqura:"1400-01-01"},DFLTRANGE:{chinese:["2000-01-01","2001-01-01"],coptic:["1700-01-01","1701-01-01"],discworld:["1800-01-01","1801-01-01"],ethiopian:["2000-01-01","2001-01-01"],hebrew:["5700-01-01","5701-01-01"],islamic:["1400-01-01","1401-01-01"],julian:["2000-01-01","2001-01-01"],mayan:["5200-01-01","5201-01-01"],nanakshahi:["0500-01-01","0501-01-01"],nepali:["2000-01-01","2001-01-01"],persian:["1400-01-01","1401-01-01"],jalali:["1400-01-01","1401-01-01"],taiwan:["0100-01-01","0101-01-01"],thai:["2500-01-01","2501-01-01"],ummalqura:["1400-01-01","1401-01-01"]},getCal:a,worldCalFmt:function(e,t,o){for(var r=n((t+.05)/p)+c,l=a(o).fromJD(r),s=0,d,u,g,m,y;-1!==(s=e.indexOf("%",s));)d=e.charAt(s+1),"0"===d||"-"===d||"_"===d?(g=3,u=e.charAt(s+2),"_"===d&&(d="-")):(u=d,d="0",g=2),m=h[u],m?(y="##"===m?"##":l.formatDate(m[d]),e=e.substr(0,s)+y+e.substr(s+g),s+=y.length):s+=g;return e}}},{"../../constants/numerical":633,"../../lib":657,"./calendars":521}],523:[function(e,t,a){'use strict';a.defaults=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],a.defaultLine="#444",a.lightLine="#eee",a.background="#fff",a.borderLine="#BEC8D9",a.lightFraction=1000/11},{}],524:[function(e,t){'use strict';var o=Math.round;function a(e){if(n(e)||"string"!=typeof e)return e;var t=e.trim();if("rgb"!==t.substr(0,3))return e;var a=t.match(/^rgba?\s*\(([^()]*)\)$/);if(!a)return e;var r=a[1].trim().split(/\s*[\s,]\s*/),l="a"===t.charAt(3)&&4===r.length;if(!l&&3!==r.length)return e;for(var s=0;s<r.length;s++){if(!r[s].length)return e;if(r[s]=+r[s],!(0<=r[s]))return e;if(3==s)1<r[s]&&(r[s]=1);else if(1<=r[s])return e}var d=o(255*r[0])+", "+o(255*r[1])+", "+o(255*r[2]);return l?"rgba("+d+", "+r[3]+")":"rgb("+d+")"}var r=e("tinycolor2"),n=e("fast-isnumeric"),l=t.exports={},s=e("./attributes");l.defaults=s.defaults;var d=l.defaultLine=s.defaultLine;l.lightLine=s.lightLine;var c=l.background=s.background;l.tinyRGB=function(e){var t=e.toRgb();return"rgb("+o(t.r)+", "+o(t.g)+", "+o(t.b)+")"},l.rgb=function(e){return l.tinyRGB(r(e))},l.opacity=function(e){return e?r(e).getAlpha():0},l.addOpacity=function(e,t){var a=r(e).toRgb();return"rgba("+o(a.r)+", "+o(a.g)+", "+o(a.b)+", "+t+")"},l.combine=function(e,t){var a=r(e).toRgb();if(1===a.a)return r(e).toRgbString();var o=r(t||c).toRgb(),i=1===o.a?o:{r:255*(1-o.a)+o.r*o.a,g:255*(1-o.a)+o.g*o.a,b:255*(1-o.a)+o.b*o.a},n={r:i.r*(1-a.a)+a.r*a.a,g:i.g*(1-a.a)+a.g*a.a,b:i.b*(1-a.a)+a.b*a.a};return r(n).toRgbString()},l.contrast=function(e,t,a){var o=r(e);1!==o.getAlpha()&&(o=r(l.combine(e,c)));var i=o.isDark()?t?o.lighten(t):c:a?o.darken(a):d;return i.toString()},l.stroke=function(e,t){var a=r(t);e.style({stroke:l.tinyRGB(a),"stroke-opacity":a.getAlpha()})},l.fill=function(e,t){var a=r(t);e.style({fill:l.tinyRGB(a),"fill-opacity":a.getAlpha()})},l.clean=function(e){if(e&&"object"==typeof e){var t=Object.keys(e),o,r,n,s;for(o=0;o<t.length;o++)if(n=t[o],s=e[n],"color"===n.substr(n.length-5)){if(Array.isArray(s))for(r=0;r<s.length;r++)s[r]=a(s[r]);else e[n]=a(s);}else if("colorscale"===n.substr(n.length-10)&&Array.isArray(s))for(r=0;r<s.length;r++)Array.isArray(s[r])&&(s[r][1]=a(s[r][1]));else if(Array.isArray(s)){var d=s[0];if(!Array.isArray(d)&&d&&"object"==typeof d)for(r=0;r<s.length;r++)l.clean(s[r])}else s&&"object"==typeof s&&l.clean(s)}}},{"./attributes":523,"fast-isnumeric":201,tinycolor2:1309}],525:[function(e,t){'use strict';var a=e("../../plots/cartesian/layout_attributes"),o=e("../../plots/font_attributes"),r=e("../../lib/extend").extendFlat,i=e("../../plot_api/edit_types").overrideAll;t.exports=i({thicknessmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{valType:"number",min:0,dflt:30},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",dflt:1.02,min:-2,max:3},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},xpad:{valType:"number",min:0,dflt:10},y:{valType:"number",dflt:.5,min:-2,max:3},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle"},ypad:{valType:"number",min:0,dflt:10},outlinecolor:a.linecolor,outlinewidth:a.linewidth,bordercolor:a.linecolor,borderwidth:{valType:"number",min:0,dflt:0},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},tickmode:a.tickmode,nticks:a.nticks,tick0:a.tick0,dtick:a.dtick,tickvals:a.tickvals,ticktext:a.ticktext,ticks:r({},a.ticks,{dflt:""}),ticklen:a.ticklen,tickwidth:a.tickwidth,tickcolor:a.tickcolor,showticklabels:a.showticklabels,tickfont:o({}),tickangle:a.tickangle,tickformat:a.tickformat,tickformatstops:a.tickformatstops,tickprefix:a.tickprefix,showtickprefix:a.showtickprefix,ticksuffix:a.ticksuffix,showticksuffix:a.showticksuffix,separatethousands:a.separatethousands,exponentformat:a.exponentformat,showexponent:a.showexponent,title:{text:{valType:"string"},font:o({}),side:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}},_deprecated:{title:{valType:"string"},titlefont:o({}),titleside:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}}},"colorbars","from-root")},{"../../lib/extend":648,"../../plot_api/edit_types":688,"../../plots/cartesian/layout_attributes":719,"../../plots/font_attributes":733}],526:[function(e,t){'use strict';t.exports={cn:{colorbar:"colorbar",cbbg:"cbbg",cbfill:"cbfill",cbfills:"cbfills",cbline:"cbline",cblines:"cblines",cbaxis:"cbaxis",cbtitleunshift:"cbtitleunshift",cbtitle:"cbtitle",cboutline:"cboutline",crisp:"crisp",jsPlaceholder:"js-placeholder"}}},{}],527:[function(e,t){'use strict';var a=e("../../lib"),o=e("../../plot_api/plot_template"),r=e("../../plots/cartesian/tick_value_defaults"),i=e("../../plots/cartesian/tick_mark_defaults"),n=e("../../plots/cartesian/tick_label_defaults"),l=e("./attributes");t.exports=function(e,t,s){function d(e,t){return a.coerce(p,c,l,e,t)}var c=o.newContainer(t,"colorbar"),p=e.colorbar||{},u=d("thicknessmode");d("thickness","fraction"===u?30/(s.width-s.margin.l-s.margin.r):30);var g=d("lenmode");d("len","fraction"===g?1:s.height-s.margin.t-s.margin.b),d("x"),d("xanchor"),d("xpad"),d("y"),d("yanchor"),d("ypad"),a.noneOrAll(p,c,["x","y"]),d("outlinecolor"),d("outlinewidth"),d("bordercolor"),d("borderwidth"),d("bgcolor"),r(p,c,d,"linear");var m={outerTicks:!1,font:s.font};n(p,c,d,"linear",m),i(p,c,d,"linear",m),d("title.text",s._dfltTitle.colorbar),a.coerceFont(d,"title.font",s.font),d("title.side")}},{"../../lib":657,"../../plot_api/plot_template":695,"../../plots/cartesian/tick_label_defaults":726,"../../plots/cartesian/tick_mark_defaults":727,"../../plots/cartesian/tick_value_defaults":728,"./attributes":525}],528:[function(e,t){'use strict';var l=Math.LN10,s=Math.log,c=Math.round,p=Math.pow,u=Math.abs,m=Math.max,h=Math.floor;function a(e){function t(e){return w(e,{_fillcolor:null,_line:{color:null,width:null,dash:null},_levels:{start:null,end:null,size:null},_filllevels:null,_fillgradient:null,_zrange:null})}function a(){"function"==typeof p.calc?p.calc(e,c,s):(s._fillgradient=d.reversescale?L(d.colorscale):d.colorscale,s._zrange=[d[p.min],d[p.max]])}for(var o=e._fullLayout,r=e.calcdata,n=[],l=0,s,d,c,p,u;l<r.length;l++){u=r[l],c=u[0].trace;var g=c._module.colorbar;if(!0===c.visible&&g)for(var m=Array.isArray(g),h=m?g:[g],y=0;y<h.length;y++){p=h[y];var f=p.container;d=f?c[f]:c,d&&d.showscale&&(s=t(d.colorbar),s._id="cb"+c.uid+(m&&f?"-"+f:""),s._traceIndex=c.index,s._propPrefix=(f?f+".":"")+"colorbar.",s._meta=c._meta,a(),n.push(s))}}for(var x in o._colorAxes)if(d=o[x],d.showscale){var _=o._colorAxes[x];s=t(d.colorbar),s._id="cb"+x,s._propPrefix=x+".colorbar.",s._meta=o._meta,p={min:"cmin",max:"cmax"},"heatmap"!==_[0]&&(c=_[1],p.calc=c._module.colorbar.calc),a(),n.push(s)}return n}function o(e,t,a){function o(o,r){var i={propContainer:ee,propName:t._propPrefix+"title",traceIndex:t._traceIndex,_meta:t._meta,placeholder:b._dfltTitle.colorbar,containerGroup:e.select("."+M.cbtitle)},n="h"===o.charAt(0)?o.substr(1):"h"+o;e.selectAll("."+n+",."+n+"-math-group").remove(),S.draw(a,o,w(i,r||{}))}function r(){if(-1!==["top","bottom"].indexOf(I)){var o=e.select("."+M.cbtitle),r=o.select("text"),i=[-t.outlinewidth/2,t.outlinewidth/2],n=o.select(".h"+ee._id+"title-math-group").node(),l=15.6;if(r.node()&&(l=parseInt(r.node().style.fontSize,10)*D),n?(le=T.bBox(n).height,le>l&&(i[1]-=(le-l)/2)):r.node()&&!r.classed(M.jsPlaceholder)&&(le=T.bBox(r.node()).height),le){if(le+=5,"top"===I)ee.domain[1]-=le/k.h,i[1]*=-1;else{ee.domain[0]+=le/k.h;var s=C.lineCount(r);i[1]+=(1-s)*l}o.attr("transform","translate("+i+")"),ee.setScale()}}e.selectAll("."+M.cbfills+",."+M.cblines).attr("transform","translate(0,"+c(k.h*(1-ee.domain[1]))+")"),ne.attr("transform","translate(0,"+c(-k.t)+")");var d=e.select("."+M.cbfills).selectAll("rect."+M.cbfill).data(N);d.enter().append("rect").classed(M.cbfill,!0).style("stroke","none"),d.exit().remove();var p=P.map(ee.c2p).map(Math.round).sort(function(e,t){return e-t});d.each(function(e,o){var r=[0===o?P[0]:(N[o]+N[o-1])/2,o===N.length-1?P[1]:(N[o]+N[o+1])/2].map(ee.c2p).map(Math.round);r[1]=v.constrain(r[1]+(r[1]>r[0])?1:-1,p[0],p[1]);var i=f.select(this).attr({x:Z,width:m(U,2),y:f.min(r),height:m(f.max(r)-f.min(r),2)});if(t._fillgradient)T.gradient(i,a,t._id,"vertical",t._fillgradient,"fill");else{var n=j(e).replace("e-","");i.attr("fill",g(n).toHexString())}});var u=e.select("."+M.cblines).selectAll("path."+M.cbline).data(L.color&&L.width?V:[]);u.enter().append("path").classed(M.cbline,!0),u.exit().remove(),u.each(function(e){f.select(this).attr("d","M"+Z+","+(c(ee.c2p(e))+L.width/2%1)+"h"+U).call(T.lineGroupStyle,L.width,z(e),L.dash)}),ne.selectAll("g."+ee._id+"tick,path").remove();var h=Z+U+(t.outlinewidth||0)/2-("outside"===t.ticks?1:0),y=_.calcTicks(ee),x=_.makeTransFn(ee),b=_.getTickSigns(ee)[2];return _.drawTicks(a,ee,{vals:"inside"===ee.ticks?_.clipEnds(ee,y):y,layer:ne,path:_.makeTickPath(ee,h,b),transFn:x}),_.drawLabels(a,ee,{vals:y,layer:ne,transFn:x,labelFns:_.makeLabelFns(ee,h)})}function d(){var o=U+t.outlinewidth/2+T.bBox(ne.node()).width;if(se=ie.select("text"),se.node()&&!se.classed(M.jsPlaceholder)){var r=ie.select(".h"+ee._id+"title-math-group").node(),i;i=r&&-1!==["top","bottom"].indexOf(I)?T.bBox(r).width:T.bBox(ie.node()).right-Z-k.l,o=m(o,i)}var n=2*t.xpad+o+t.borderwidth+t.outlinewidth/2,l=J-Q;e.select("."+M.cbbg).attr({x:Z-t.xpad-(t.borderwidth+t.outlinewidth)/2,y:Q-W,width:m(n,2),height:m(l+2*W,2)}).call(A.fill,t.bgcolor).call(A.stroke,t.bordercolor).style("stroke-width",t.borderwidth),e.selectAll("."+M.cboutline).attr({x:Z,y:Q+t.ypad+("top"===I?le:0),width:m(U,2),height:m(l-2*t.ypad-le,2)}).call(A.stroke,t.outlinecolor).style({fill:"none","stroke-width":t.outlinewidth});var s=({center:.5,right:1}[t.xanchor]||0)*n;e.attr("transform","translate("+(k.l-s)+","+k.t+")");var d={},c=O[t.yanchor],p=R[t.yanchor];"pixels"===t.lenmode?(d.y=t.y,d.t=l*c,d.b=l*p):(d.t=d.b=0,d.yt=t.y+t.len*c,d.yb=t.y-t.len*p);var u=O[t.xanchor],g=R[t.xanchor];if("pixels"===t.thicknessmode)d.x=t.x,d.l=n*u,d.r=n*g;else{var h=n-U;d.l=h*u,d.r=h*g,d.xl=t.x-t.thickness*u,d.xr=t.x+t.thickness*g}y.autoMargin(a,t._id,d)}var b=a._fullLayout,k=b._size,x=t._fillcolor,L=t._line,E=t.title,I=E.side,P=t._zrange||f.extent(("function"==typeof x?x:L.color).domain()),z="function"==typeof L.color?L.color:function(){return L.color},j="function"==typeof x?x:function(){return x},B=t._levels,F=i(a,t,P),N=F.fill,V=F.line,U=c(t.thickness*("fraction"===t.thicknessmode?k.w:1)),H=U/k.w,q=c(t.len*("fraction"===t.lenmode?k.h:1)),G=q/k.h,Y=t.xpad/k.w,W=(t.borderwidth+t.outlinewidth)/2,X=t.ypad/k.h,Z=c(t.x*k.w+t.xpad),K=t.x-H*({middle:.5,right:1}[t.xanchor]||0),$=t.y+G*(({top:-.5,bottom:.5}[t.yanchor]||0)-.5),J=c(k.h*(1-$)),Q=J-q;t._lenFrac=G,t._thickFrac=H,t._xLeftFrac=K,t._yBottomFrac=$;var ee=t._axis=n(a,t,P);if(ee.position=t.x+Y+H,-1!==["top","bottom"].indexOf(I)&&(ee.title.side=I,ee.titlex=t.x+Y,ee.titley=$+("top"===E.side?G-X:X)),L.color&&"auto"===t.tickmode){ee.tickmode="linear",ee.tick0=B.start;var te=B.size,ae=v.constrain((J-Q)/50,4,15)+1,oe=(P[1]-P[0])/((t.nticks||ae)*te);if(1<oe){var re=p(10,h(s(oe)/l));te*=re*v.roundUp(oe/re,[2,5,10]),2e-6>(u(B.start)/B.size+1e-6)%1&&(ee.tick0=0)}ee.dtick=te}ee.domain=[$+X,$+G-X],ee.setScale(),e.attr("transform","translate("+c(k.l)+","+c(k.t)+")");var ie=e.select("."+M.cbtitleunshift).attr("transform","translate(-"+c(k.l)+",-"+c(k.t)+")"),ne=e.select("."+M.cbaxis),le=0,se;return v.syncOrAsync([y.previousPromises,function(){if(-1!==["top","bottom"].indexOf(I)){var e=k.l+(t.x+Y)*k.w,a=ee.title.font.size,r;r="top"===I?(1-($+G-X))*k.h+k.t+3+.75*a:(1-($+X))*k.h+k.t-3-.25*a,o(ee._id+"title",{attributes:{x:e,y:r,"text-anchor":"start"}})}},r,function(){if(-1===["top","bottom"].indexOf(I)){var e=ee.title.font.size,t=ee._offset+ee._length/2,r=k.l+(ee.position||0)*k.w+("right"===ee.side?10+e*(ee.showticklabels?1:.5):-10-e*(ee.showticklabels?.5:0));o("h"+ee._id+"title",{avoid:{selection:f.select(a).selectAll("g."+ee._id+"tick"),side:I,offsetLeft:k.l,offsetTop:0,maxShift:b.width},attributes:{x:r,y:t,"text-anchor":"middle"},transform:{rotate:"-90",offset:0}})}},y.previousPromises,d],a)}function r(e,t,a){var o=a._fullLayout,r=o._size,i,n,l;b.init({element:e.node(),gd:a,prepFn:function(){i=e.attr("transform"),k(e)},moveFn:function(a,o){e.attr("transform",i+" translate("+a+","+o+")"),n=b.align(t._xLeftFrac+a/r.w,t._thickFrac,0,1,t.xanchor),l=b.align(t._yBottomFrac-o/r.h,t._lenFrac,0,1,t.yanchor);var s=b.getCursor(n,l,t.xanchor,t.yanchor);k(e,s)},doneFn:function(){if(k(e),void 0!==n&&void 0!==l){var o={};o[t._propPrefix+"x"]=n,o[t._propPrefix+"y"]=l,void 0===t._traceIndex?x.call("_guiRelayout",a,o):x.call("_guiRestyle",a,o,t._traceIndex)}}})}function i(e,t,a){var o=t._levels,r=[],n=[],s=o.end+o.size/100,d=o.size,c=1.001*a[0]-.001*a[1],p=1.001*a[1]-.001*a[0],u,g;for(g=0;1e5>g&&(u=o.start+g*d,0<d?!(u>=s):!(u<=s));g++)u>c&&u<p&&r.push(u);if(t._fillgradient)n=[0];else if("function"==typeof t._fillcolor){var m=t._filllevels;if(m)for(s=m.end+m.size/100,d=m.size,g=0;1e5>g&&(u=m.start+g*d,0<d?!(u>=s):!(u<=s));g++)u>a[0]&&u<a[1]&&n.push(u);else n=r.map(function(e){return e-o.size/2}),n.push(n[n.length-1]+o.size)}else t._fillcolor&&"string"==typeof t._fillcolor&&(n=[0]);return 0>o.size&&(r.reverse(),n.reverse()),{line:r,fill:n}}function n(e,t,a){function o(e,t){return v.coerce(i,n,P,e,t)}var r=e._fullLayout,i={type:"linear",range:a,tickmode:t.tickmode,nticks:t.nticks,tick0:t.tick0,dtick:t.dtick,tickvals:t.tickvals,ticktext:t.ticktext,ticks:t.ticks,ticklen:t.ticklen,tickwidth:t.tickwidth,tickcolor:t.tickcolor,showticklabels:t.showticklabels,tickfont:t.tickfont,tickangle:t.tickangle,tickformat:t.tickformat,exponentformat:t.exponentformat,separatethousands:t.separatethousands,showexponent:t.showexponent,showtickprefix:t.showtickprefix,tickprefix:t.tickprefix,showticksuffix:t.showticksuffix,ticksuffix:t.ticksuffix,title:t.title,showline:!0,anchor:"free",side:"right",position:1},n={type:"linear",_id:"y"+t._id},l={letter:"y",font:r.font,noHover:!0,noTickson:!0,calendar:r.calendar};return E(i,n,o,l,r),I(i,n,o,l),n}var f=e("d3"),g=e("tinycolor2"),y=e("../../plots/plots"),x=e("../../registry"),_=e("../../plots/cartesian/axes"),b=e("../dragelement"),v=e("../../lib"),w=e("../../lib/extend").extendFlat,k=e("../../lib/setcursor"),T=e("../drawing"),A=e("../color"),S=e("../titles"),C=e("../../lib/svg_text_utils"),L=e("../colorscale/helpers").flipScale,E=e("../../plots/cartesian/axis_defaults"),I=e("../../plots/cartesian/position_defaults"),P=e("../../plots/cartesian/layout_attributes"),z=e("../../constants/alignment"),D=z.LINE_SPACING,O=z.FROM_TL,R=z.FROM_BR,M=e("./constants").cn;t.exports={draw:function(e){var t=e._fullLayout,i=t._infolayer.selectAll("g."+M.colorbar).data(a(e),function(e){return e._id});i.enter().append("g").attr("class",function(e){return e._id}).classed(M.colorbar,!0),i.each(function(t){var a=f.select(this);v.ensureSingle(a,"rect",M.cbbg),v.ensureSingle(a,"g",M.cbfills),v.ensureSingle(a,"g",M.cblines),v.ensureSingle(a,"g",M.cbaxis,function(e){e.classed(M.crisp,!0)}),v.ensureSingle(a,"g",M.cbtitleunshift,function(e){e.append("g").classed(M.cbtitle,!0)}),v.ensureSingle(a,"rect",M.cboutline);var i=o(a,t,e);i&&i.then&&(e._promises||[]).push(i),e._context.edits.colorbarPosition&&r(a,t,e)}),i.exit().each(function(t){y.autoMargin(e,t._id)}).remove(),i.order()}}},{"../../constants/alignment":626,"../../lib":657,"../../lib/extend":648,"../../lib/setcursor":677,"../../lib/svg_text_utils":681,"../../plots/cartesian/axes":705,"../../plots/cartesian/axis_defaults":707,"../../plots/cartesian/layout_attributes":719,"../../plots/cartesian/position_defaults":722,"../../plots/plots":768,"../../registry":788,"../color":524,"../colorscale/helpers":535,"../dragelement":543,"../drawing":546,"../titles":619,"./constants":526,d3:108,tinycolor2:1309}],529:[function(e,t){'use strict';var a=e("../../lib");t.exports=function(e){return a.isPlainObject(e.colorbar)}},{"../../lib":657}],530:[function(e,t){'use strict';t.exports={moduleType:"component",name:"colorbar",attributes:e("./attributes"),supplyDefaults:e("./defaults"),draw:e("./draw").draw,hasColorbar:e("./has_colorbar")}},{"./attributes":525,"./defaults":527,"./draw":528,"./has_colorbar":529}],531:[function(e,t){'use strict';function a(e){return"`"+e+"`"}var o=e("../colorbar/attributes"),r=e("../../lib/regex").counter,i=e("./scales.js").scales,n=Object.keys(i);t.exports=function(e,t){e=e||"",t=t||{};var n=t.cLetter||"c",l="onlyIfNumerical"in t?t.onlyIfNumerical:!!e,s="noScale"in t?t.noScale:"marker.line"===e,d="showScaleDflt"in t?t.showScaleDflt:"z"===n,c="string"==typeof t.colorscaleDflt?i[t.colorscaleDflt]:null,p=t.editTypeOverride||"",u=e?e+".":"",g,m;"colorAttr"in t?(g=t.colorAttr,m=t.colorAttr):(g={z:"z",c:"color"}[n],m="in "+a(u+g));var h=l?" Has an effect only if "+m+"is set to a numerical array.":"",y=n+"auto",f=n+"min",x=n+"max",_=a(u+y),b=a(u+f),v=a(u+x),w={};w[f]=w[x]=void 0;var k={};k[y]=!1;var T={};return"color"===g&&(T.color={valType:"color",arrayOk:!0,editType:p||"style"},t.anim&&(T.color.anim=!0)),T[y]={valType:"boolean",dflt:!0,editType:"calc",impliedEdits:w},T[f]={valType:"number",dflt:null,editType:p||"plot",impliedEdits:k},T[x]={valType:"number",dflt:null,editType:p||"plot",impliedEdits:k},T[n+"mid"]={valType:"number",dflt:null,editType:"calc",impliedEdits:w},T.colorscale={valType:"colorscale",editType:"calc",dflt:c,impliedEdits:{autocolorscale:!1}},T.autocolorscale={valType:"boolean",dflt:!1!==t.autoColorDflt,editType:"calc",impliedEdits:{colorscale:void 0}},T.reversescale={valType:"boolean",dflt:!1,editType:"plot"},s||(T.showscale={valType:"boolean",dflt:d,editType:"calc"},T.colorbar=o),t.noColorAxis||(T.coloraxis={valType:"subplotid",regex:r("coloraxis"),dflt:null,editType:"calc"}),T}},{"../../lib/regex":673,"../colorbar/attributes":525,"./scales.js":539}],532:[function(e,t){'use strict';var a=Math.min,o=Math.max,r=e("fast-isnumeric"),i=e("../../lib"),n=e("./helpers").extractOpts;t.exports=function(e,t,l){var s=e._fullLayout,d=l.vals,c=l.containerStr,p=c?i.nestedProperty(t,c).get():t,u=n(p),g=!1!==u.auto,m=u.min,h=u.max,y=u.mid,f=function(){return i.aggNums(Math.min,null,d)},x=function(){return i.aggNums(Math.max,null,d)};if(void 0===m?m=f():g&&(p._colorAx&&r(m)?m=a(m,f()):m=f()),void 0===h?h=x():g&&(p._colorAx&&r(h)?h=o(h,x()):h=x()),g&&void 0!==y&&(h-y>y-m?m=y-(h-y):h-y<y-m&&(h=y+(y-m))),m===h&&(m-=.5,h+=.5),u._sync("min",m),u._sync("max",h),u.autocolorscale){var _;_=0>m*h?s.colorscale.diverging:0<=m?s.colorscale.sequential:s.colorscale.sequentialminus,u._sync("colorscale",_)}}},{"../../lib":657,"./helpers":535,"fast-isnumeric":201}],533:[function(e,t){'use strict';var a=e("../../lib"),o=e("./helpers").hasColorscale,r=e("./helpers").extractOpts;t.exports=function(e,t){function n(e,t){var a=e["_"+t];a!==void 0&&(e[t]=a)}function l(e,o){var i=o.container?a.nestedProperty(e,o.container).get():e;if(i)if(i.coloraxis)i._colorAx=t[i.coloraxis];else{var l=r(i),s=l.auto;(s||void 0===l.min)&&n(i,o.min),(s||void 0===l.max)&&n(i,o.max),l.autocolorscale&&n(i,"colorscale")}}for(var s=0;s<e.length;s++){var d=e[s],c=d._module.colorbar;if(c)if(Array.isArray(c))for(var p=0;p<c.length;p++)l(d,c[p]);else l(d,c);o(d,"marker.line")&&l(d,{container:"marker.line",min:"cmin",max:"cmax"})}for(var u in t._colorAxes)l(t[u],{min:"cmin",max:"cmax"})}},{"../../lib":657,"./helpers":535}],534:[function(e,t){'use strict';function a(e,t){var a=t.slice(0,t.length-1);return t?r.nestedProperty(e,a).get()||{}:e}var o=e("fast-isnumeric"),r=e("../../lib"),i=e("../colorbar/has_colorbar"),n=e("../colorbar/defaults"),l=e("./scales").isValid,s=e("../../registry").traceIs;t.exports=function e(t,d,c,p,u){var g=u.prefix,m=u.cLetter,h=("_module"in d),y=a(t,g),f=a(d,g),x=a(d._template||{},g)||{},_=function(){return delete t.coloraxis,delete d.coloraxis,e(t,d,c,p,u)};if(h){var b=c._colorAxes||{},v=p(g+"coloraxis");if(v){var w=s(d,"contour")&&r.nestedProperty(d,"contours.coloring").get()||"heatmap",k=b[v];return void(k?(k[2].push(_),k[0]!==w&&(k[0]=!1,r.warn(["Ignoring coloraxis:",v,"setting","as it is linked to incompatible colorscales."].join(" ")))):b[v]=[w,d,[_]])}}var T=y[m+"min"],A=y[m+"max"],S=o(T)&&o(A)&&T<A,C=p(g+m+"auto",!S);C?p(g+m+"mid"):(p(g+m+"min"),p(g+m+"max"));var L=y.colorscale,E=x.colorscale,I;if(void 0!==L&&(I=!l(L)),void 0!==E&&(I=!l(E)),p(g+"autocolorscale",I),p(g+"colorscale"),p(g+"reversescale"),"marker.line."!==g){var P;g&&h&&(P=i(y));var z=p(g+"showscale",P);z&&(g&&x&&(f._template=x),n(y,f,c))}}},{"../../lib":657,"../../registry":788,"../colorbar/defaults":527,"../colorbar/has_colorbar":529,"./scales":539,"fast-isnumeric":201}],535:[function(e,t){'use strict';function a(e){var t=e._colorAx,a=t?t:e,o={},r,n,l;for(n=0;n<g.length;n++)l=g[n],o[l]=a[l];if(t)for(r="c",n=0;n<m.length;n++)l=m[n],o[l]=a["c"+l];else{var s;for(n=0;n<m.length;n++){if(l=m[n],s="c"+l,s in a){o[l]=a[s];continue}s="z"+l,s in a&&(o[l]=a[s])}r=s.charAt(0)}return o._sync=function(e,t){var o=-1===m.indexOf(e)?e:r+e;a[o]=a["_"+o]=t},o}function o(e){for(var t=a(e),o=t.min,n=t.max,l=t.reversescale?r(t.colorscale):t.colorscale,s=l.length,d=Array(s),c=Array(s),p=0,u;p<s;p++)u=l[p],d[p]=o+u[0]*(n-o),c[p]=u[1];return{domain:d,range:c}}function r(e){for(var t=e.length,a=Array(t),o=t-1,r=0,n;0<=o;o--,r++)n=e[o],a[r]=[1-n[0],n[1]];return a}function i(e,t){t=t||{};for(var a=e.domain,o=e.range,r=o.length,c=Array(r),u=0,g;u<r;u++)g=s(o[u]).toRgb(),c[u]=[g.r,g.g,g.b,g.a];var m=l.scale.linear().domain(a).range(c).clamp(!0),h=t.noNumericCheck,y=t.returnArray,f;return f=h&&y?m:h?function(e){return n(m(e))}:y?function(e){return d(e)?m(e):s(e).isValid()?e:p.defaultLine}:function(e){return d(e)?n(m(e)):s(e).isValid()?e:p.defaultLine},f.domain=m.domain,f.range=function(){return o},f}function n(e){var t={r:e[0],g:e[1],b:e[2],a:e[3]};return s(t).toRgbString()}var l=e("d3"),s=e("tinycolor2"),d=e("fast-isnumeric"),c=e("../../lib"),p=e("../color"),u=e("./scales").isValid,g=["showscale","autocolorscale","colorscale","reversescale","colorbar"],m=["min","max","mid","auto"];t.exports={hasColorscale:function(e,t,a){var o=t?c.nestedProperty(e,t).get()||{}:e,r=o[a||"color"],n=!1;if(c.isArrayOrTypedArray(r))for(var l=0;l<r.length;l++)if(d(r[l])){n=!0;break}return c.isPlainObject(o)&&(n||!0===o.showscale||d(o.cmin)&&d(o.cmax)||u(o.colorscale)||c.isPlainObject(o.colorbar))},extractOpts:a,extractScale:o,flipScale:r,makeColorScaleFunc:i,makeColorScaleFuncFromTrace:function(e,t){return i(o(e),t)}}},{"../../lib":657,"../color":524,"./scales":539,d3:108,"fast-isnumeric":201,tinycolor2:1309}],536:[function(e,t){'use strict';var a=e("./scales"),o=e("./helpers");t.exports={moduleType:"component",name:"colorscale",attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyLayoutDefaults:e("./layout_defaults"),handleDefaults:e("./defaults"),crossTraceDefaults:e("./cross_trace_defaults"),calc:e("./calc"),scales:a.scales,defaultScale:a.defaultScale,getScale:a.get,isValidScale:a.isValid,hasColorscale:o.hasColorscale,extractOpts:o.extractOpts,extractScale:o.extractScale,flipScale:o.flipScale,makeColorScaleFunc:o.makeColorScaleFunc,makeColorScaleFuncFromTrace:o.makeColorScaleFuncFromTrace}},{"./attributes":531,"./calc":532,"./cross_trace_defaults":533,"./defaults":534,"./helpers":535,"./layout_attributes":537,"./layout_defaults":538,"./scales":539}],537:[function(e,t){'use strict';var a=e("../../lib/extend").extendFlat,o=e("./attributes"),r=e("./scales").scales;t.exports={editType:"calc",colorscale:{editType:"calc",sequential:{valType:"colorscale",dflt:r.Reds,editType:"calc"},sequentialminus:{valType:"colorscale",dflt:r.Blues,editType:"calc"},diverging:{valType:"colorscale",dflt:r.RdBu,editType:"calc"}},coloraxis:a({_isSubplotObj:!0,editType:"calc"},o("",{colorAttr:"corresponding trace color array(s)",noColorAxis:!0,showScaleDflt:!0}))}},{"../../lib/extend":648,"./attributes":531,"./scales":539}],538:[function(e,t){'use strict';var a=e("../../lib"),o=e("../../plot_api/plot_template"),r=e("./layout_attributes"),n=e("./defaults");t.exports=function(e,t){function l(o,i){return a.coerce(e,t,r,o,i)}function s(e,t){return a.coerce(c,p,r.coloraxis,e,t)}l("colorscale.sequential"),l("colorscale.sequentialminus"),l("colorscale.diverging");var d=t._colorAxes,c,p;for(var u in d){var g=d[u];if(g[0])c=e[u]||{},p=o.newContainer(t,u,"coloraxis"),p._name=u,n(c,p,t,s,{prefix:"",cLetter:"c"});else{for(var m=0;m<g[2].length;m++)g[2][m]();delete t._colorAxes[u]}}}},{"../../lib":657,"../../plot_api/plot_template":695,"./defaults":534,"./layout_attributes":537}],539:[function(e,t){'use strict';function a(e){var t=0;if(!Array.isArray(e)||2>e.length)return!1;if(!e[0]||!e[e.length-1])return!1;if(0!=+e[0][0]||1!=+e[e.length-1][0])return!1;for(var a=0,r;a<e.length;a++){if(r=e[a],2!==r.length||+r[0]<t||!o(r[1]).isValid())return!1;t=+r[0]}return!0}var o=e("tinycolor2"),r={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YlGnBu:[[0,"rgb(8,29,88)"],[.125,"rgb(37,52,148)"],[.25,"rgb(34,94,168)"],[.375,"rgb(29,145,192)"],[.5,"rgb(65,182,196)"],[.625,"rgb(127,205,187)"],[.75,"rgb(199,233,180)"],[.875,"rgb(237,248,217)"],[1,"rgb(255,255,217)"]],Greens:[[0,"rgb(0,68,27)"],[.125,"rgb(0,109,44)"],[.25,"rgb(35,139,69)"],[.375,"rgb(65,171,93)"],[.5,"rgb(116,196,118)"],[.625,"rgb(161,217,155)"],[.75,"rgb(199,233,192)"],[.875,"rgb(229,245,224)"],[1,"rgb(247,252,245)"]],YlOrRd:[[0,"rgb(128,0,38)"],[.125,"rgb(189,0,38)"],[.25,"rgb(227,26,28)"],[.375,"rgb(252,78,42)"],[.5,"rgb(253,141,60)"],[.625,"rgb(254,178,76)"],[.75,"rgb(254,217,118)"],[.875,"rgb(255,237,160)"],[1,"rgb(255,255,204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5,10,172)"],[.35,"rgb(106,137,247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220,170,132)"],[.7,"rgb(230,145,90)"],[1,"rgb(178,10,28)"]],Reds:[[0,"rgb(220,220,220)"],[.2,"rgb(245,195,157)"],[.4,"rgb(245,160,105)"],[1,"rgb(178,10,28)"]],Blues:[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0,0,200)"],[.25,"rgb(0,25,255)"],[.375,"rgb(0,152,255)"],[.5,"rgb(44,255,150)"],[.625,"rgb(151,255,0)"],[.75,"rgb(255,234,0)"],[.875,"rgb(255,111,0)"],[1,"rgb(255,0,0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]],Viridis:[[0,"#440154"],[.06274509803921569,"#48186a"],[.12549019607843137,"#472d7b"],[.18823529411764706,"#424086"],[.25098039215686274,"#3b528b"],[.3137254901960784,"#33638d"],[.3764705882352941,"#2c728e"],[.4392156862745098,"#26828e"],[.5019607843137255,"#21918c"],[.5647058823529412,"#1fa088"],[.6274509803921569,"#28ae80"],[.6901960784313725,"#3fbc73"],[.7529411764705882,"#5ec962"],[.8156862745098039,"#84d44b"],[.8784313725490196,"#addc30"],[.9411764705882353,"#d8e219"],[1,"#fde725"]],Cividis:[[0,"rgb(0,32,76)"],[.058824,"rgb(0,42,102)"],[.117647,"rgb(0,52,110)"],[.176471,"rgb(39,63,108)"],[.235294,"rgb(60,74,107)"],[.294118,"rgb(76,85,107)"],[.352941,"rgb(91,95,109)"],[.411765,"rgb(104,106,112)"],[.470588,"rgb(117,117,117)"],[.529412,"rgb(131,129,120)"],[.588235,"rgb(146,140,120)"],[.647059,"rgb(161,152,118)"],[.705882,"rgb(176,165,114)"],[.764706,"rgb(192,177,109)"],[.823529,"rgb(209,191,102)"],[.882353,"rgb(225,204,92)"],[.941176,"rgb(243,219,79)"],[1,"rgb(255,233,69)"]]},i=r.RdBu;t.exports={scales:r,defaultScale:i,get:function(t,o){function n(){try{t=r[t]||JSON.parse(t)}catch(a){t=o}}return(o||(o=i),!t)?o:("string"==typeof t&&(n(),"string"==typeof t&&n()),a(t)?t:o)},isValid:function(e){return void 0!==r[e]||a(e)}}},{tinycolor2:1309}],540:[function(e,t){'use strict';t.exports=function(e,t,a,o,r){var i=(e-a)/(o-a),n=i+t/(o-a),l=(i+n)/2;return"left"===r||"bottom"===r?i:"center"===r||"middle"===r?l:"right"===r||"top"===r?n:i<2/3-l?i:n>4/3-l?n:l}},{}],541:[function(e,t){'use strict';var a=Math.floor,o=e("../../lib"),r=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]];t.exports=function(e,t,i,n){return e="left"===i?0:"center"===i?1:"right"===i?2:o.constrain(a(3*e),0,2),t="bottom"===n?0:"middle"===n?1:"top"===n?2:o.constrain(a(3*t),0,2),r[t][e]}},{"../../lib":657}],542:[function(e,t,a){'use strict';a.selectMode=function(e){return"lasso"===e||"select"===e},a.drawMode=function(e){return"drawclosedpath"===e||"drawopenpath"===e||"drawline"===e||"drawrect"===e||"drawcircle"===e},a.openMode=function(e){return"drawline"===e||"drawopenpath"===e},a.rectMode=function(e){return"select"===e||"drawline"===e||"drawrect"===e||"drawcircle"===e},a.freeMode=function(e){return"lasso"===e||"drawclosedpath"===e||"drawopenpath"===e},a.selectingOrDrawing=function(e){return a.freeMode(e)||a.rectMode(e)}},{}],543:[function(e,t){'use strict';var r=Math.abs,i=Math.max;function a(){var e=document.createElement("div");e.className="dragcover";var t=e.style;return t.position="fixed",t.left=0,t.right=0,t.top=0,t.bottom=0,t.zIndex=999999999,t.background="none",document.body.appendChild(e),e}function o(t){return n(t.changedTouches?t.changedTouches[0]:t,document.body)}var n=e("mouse-event-offset"),l=e("has-hover"),s=e("has-passive-events"),d=e("../../lib").removeElement,c=e("../../plots/cartesian/constants"),p=t.exports={};p.align=e("./align"),p.getCursor=e("./cursor");var u=e("./unhover");p.unhover=u.wrapped,p.unhoverRaw=u.raw,p.init=function(t){function n(r){m._dragged=!1,m._dragging=!0;var e=o(r);return x=e[0],_=e[1],T=r.target,k=r,A=2===r.buttons||r.ctrlKey,"undefined"==typeof r.clientX&&"undefined"==typeof r.clientY&&(r.clientX=x,r.clientY=_),b=new Date().getTime(),b-m._mouseDownTime<y?h+=1:(h=1,m._mouseDownTime=b),t.prepFn&&t.prepFn(r,x,_),l&&!A?(w=a(),w.style.cursor=window.getComputedStyle(f).cursor):!l&&(w=document,v=window.getComputedStyle(document.documentElement).cursor,document.documentElement.style.cursor=window.getComputedStyle(f).cursor),document.addEventListener("mouseup",g),document.addEventListener("touchend",g),void(!1!==t.dragmode&&(r.preventDefault(),document.addEventListener("mousemove",u),document.addEventListener("touchmove",u,{passive:!1})))}function u(a){a.preventDefault();var e=o(a),r=t.minDrag||c.MINDRAG,i=S(e[0]-x,e[1]-_,r),n=i[0],l=i[1];return(n||l)&&(m._dragged=!0,p.unhover(m)),void(m._dragged&&t.moveFn&&!A&&(m._dragdata={element:f,dx:n,dy:l},t.moveFn(n,l)))}function g(a){if(delete m._dragdata,!1!==t.dragmode&&(a.preventDefault(),document.removeEventListener("mousemove",u),document.removeEventListener("touchmove",u)),document.removeEventListener("mouseup",g),document.removeEventListener("touchend",g),l?d(w):v&&(w.documentElement.style.cursor=v,v=null),!m._dragging)return void(m._dragged=!1);if(m._dragging=!1,new Date().getTime()-m._mouseDownTime>y&&(h=i(h-1,1)),m._dragged)t.doneFn&&t.doneFn();else if(t.clickFn&&t.clickFn(h,k),!A){var e;try{e=new MouseEvent("click",a)}catch(t){var r=o(a);e=document.createEvent("MouseEvents"),e.initMouseEvent("click",a.bubbles,a.cancelable,a.view,a.detail,a.screenX,a.screenY,r[0],r[1],a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,a.relatedTarget)}T.dispatchEvent(e)}return m._dragging=!1,void(m._dragged=!1)}var m=t.gd,h=1,y=m._context.doubleClickDelay,f=t.element,x,_,b,v,w,k,T,A;m._mouseDownTime||(m._mouseDownTime=0),f.style.pointerEvents="all",f.onmousedown=n,s?(f._ontouchstart&&f.removeEventListener("touchstart",f._ontouchstart),f._ontouchstart=n,f.addEventListener("touchstart",n,{passive:!1})):f.ontouchstart=n;var S=t.clampFn||function(e,t,a){return r(e)<a&&(e=0),r(t)<a&&(t=0),[e,t]}},p.coverSlip=a},{"../../lib":657,"../../plots/cartesian/constants":711,"./align":540,"./cursor":541,"./unhover":544,"has-hover":379,"has-passive-events":380,"mouse-event-offset":411}],544:[function(e,t){'use strict';var a=e("../../lib/events"),o=e("../../lib/throttle"),r=e("../../lib/dom").getGraphDiv,i=e("../fx/constants"),n=t.exports={};n.wrapped=function(e,t,a){e=r(e),e._fullLayout&&o.clear(e._fullLayout._uid+i.HOVERID),n.raw(e,t,a)},n.raw=function(e,t){var o=e._fullLayout,r=e._hoverdata;t||(t={});t.target&&!1===a.triggerHandler(e,"plotly_beforehover",t)||(o._hoverlayer.selectAll("g").remove(),o._hoverlayer.selectAll("line").remove(),o._hoverlayer.selectAll("circle").remove(),e._hoverdata=void 0,t.target&&r&&e.emit("plotly_unhover",{event:t,points:r}))}},{"../../lib/dom":646,"../../lib/events":647,"../../lib/throttle":682,"../fx/constants":558}],545:[function(e,t,a){'use strict';a.dash={valType:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid",editType:"style"}},{}],546:[function(e,t){'use strict';var c=Math.pow,p=Math.max;function a(e,t){return C.symbolFuncs[e%100](t)+(200<=e?"M0,0.5L0.5,0L0,-0.5L-0.5,0Z":"")}function o(e,t,a,o){var i=u.select(e.node().parentNode),n=-1===t.indexOf("top")?-1===t.indexOf("bottom")?"middle":"bottom":"top",l=-1===t.indexOf("left")?-1===t.indexOf("right")?"middle":"start":"end",s=o?o/.8+1:0,r=(_.lineCount(e)-1)*w+1,d=O[l]*s,c=.75*a+O[n]*s+(O[n]-1)*r*a/2;e.attr("text-anchor",l),i.attr("transform","translate("+d+","+c+")")}function r(e,t){var a=e.ts||t.textfont.size;return i(a)&&0<a?a:0}function n(e,t,a,o){var r=e[0]-t[0],i=e[1]-t[1],n=a[0]-t[0],l=a[1]-t[1],s=c(r*r+i*i,R/2),d=c(n*n+l*l,R/2),p=(d*d*r-s*s*n)*o,g=(d*d*i-s*s*l)*o,m=3*d*(s+d),h=3*s*(s+d);return[[u.round(t[0]+(m&&p/m),2),u.round(t[1]+(m&&g/m),2)],[u.round(t[0]-(h&&p/h),2),u.round(t[1]-(h&&g/h),2)]]}function l(e){var t=e.getAttribute("data-unformatted");return null===t?void 0:t+e.getAttribute("data-math")+e.getAttribute("text-anchor")+e.getAttribute("style")}function d(e,t){if(!e)return null;var a=t._context,o=a._exportedPlot?"":a._baseUrl||"";return"url('"+o+"#"+e+"')"}var u=e("d3"),i=e("fast-isnumeric"),s=e("tinycolor2"),g=e("../../registry"),m=e("../color"),h=e("../colorscale"),f=e("../../lib"),_=e("../../lib/svg_text_utils"),b=e("../../constants/xmlns_namespaces"),v=e("../../constants/alignment"),w=v.LINE_SPACING,k=e("../../constants/interactions").DESELECTDIM,T=e("../../traces/scatter/subtypes"),A=e("../../traces/scatter/make_bubble_size_func"),S=e("../../components/fx/helpers").appendArrayPointValue,C=t.exports={};C.font=function(e,t,a,o){f.isPlainObject(t)&&(o=t.color,a=t.size,t=t.family),t&&e.style("font-family",t),a+1&&e.style("font-size",a+"px"),o&&e.call(m.fill,o)},C.setPosition=function(e,t,a){e.attr("x",t).attr("y",a)},C.setSize=function(e,t,a){e.attr("width",t).attr("height",a)},C.setRect=function(e,t,a,o,r){e.call(C.setPosition,t,a).call(C.setSize,o,r)},C.translatePoint=function(e,t,a,o){var r=a.c2p(e.x),n=o.c2p(e.y);if(i(r)&&i(n)&&t.node())"text"===t.node().nodeName?t.attr("x",r).attr("y",n):t.attr("transform","translate("+r+","+n+")");else return!1;return!0},C.translatePoints=function(e,t,a){e.each(function(e){var o=u.select(this);C.translatePoint(e,o,t,a)})},C.hideOutsideRangePoint=function(e,t,a,o,r,i){t.attr("display",a.isPtWithinRange(e,r)&&o.isPtWithinRange(e,i)?null:"none")},C.hideOutsideRangePoints=function(e,t){if(t._hasClipOnAxisFalse){var a=t.xaxis,o=t.yaxis;e.each(function(t){var r=t[0].trace,i=r.xcalendar,n=r.ycalendar,l=g.traceIs(r,"bar-like")?".bartext":".point,.textpoint";e.selectAll(l).each(function(e){C.hideOutsideRangePoint(e,u.select(this),a,o,i,n)})})}},C.crispRound=function(e,t,a){return t&&i(t)?e._context.staticPlot?t:1>t?1:Math.round(t):a||0},C.singleLineStyle=function(e,t,a,o,r){t.style("fill","none");var i=(((e||[])[0]||{}).trace||{}).line||{},n=a||i.width||0,l=r||i.dash||"";m.stroke(t,o||i.color),C.dashLine(t,l,n)},C.lineGroupStyle=function(e,t,a,o){e.style("fill","none").each(function(e){var r=(((e||[])[0]||{}).trace||{}).line||{},i=t||r.width||0,n=o||r.dash||"";u.select(this).call(m.stroke,a||r.color).call(C.dashLine,n,i)})},C.dashLine=function(e,t,a){a=+a||0,t=C.dashStyle(t,a),e.style({"stroke-dasharray":t,"stroke-width":a+"px"})},C.dashStyle=function(e,t){t=+t||1;var a=p(t,3);return"solid"===e?e="":"dot"===e?e=a+"px,"+a+"px":"dash"===e?e=3*a+"px,"+3*a+"px":"longdash"===e?e=5*a+"px,"+5*a+"px":"dashdot"===e?e=3*a+"px,"+a+"px,"+a+"px,"+a+"px":"longdashdot"==e&&(e=5*a+"px,"+2*a+"px,"+a+"px,"+2*a+"px"),e},C.singleFillStyle=function(e){var t=u.select(e.node()),a=t.data(),o=(((a[0]||[])[0]||{}).trace||{}).fillcolor;o&&e.call(m.fill,o)},C.fillGroupStyle=function(e){e.style("stroke-width",0).each(function(e){var t=u.select(this);e[0].trace&&t.call(m.fill,e[0].trace.fillcolor)})};var L=e("./symbol_defs");C.symbolNames=[],C.symbolFuncs=[],C.symbolNeedLines={},C.symbolNoDot={},C.symbolNoFill={},C.symbolList=[],Object.keys(L).forEach(function(e){var t=L[e],a=t.n;C.symbolList.push(a,e,a+100,e+"-open"),C.symbolNames[a]=e,C.symbolFuncs[a]=t.f,t.needLine&&(C.symbolNeedLines[a]=!0),t.noDot?C.symbolNoDot[a]=!0:C.symbolList.push(a+200,e+"-dot",a+300,e+"-open-dot"),t.noFill&&(C.symbolNoFill[a]=!0)});var E=C.symbolNames.length;C.symbolNumber=function(e){if("string"==typeof e){var t=0;0<e.indexOf("-open")&&(t=100,e=e.replace("-open","")),0<e.indexOf("-dot")&&(t+=200,e=e.replace("-dot","")),e=C.symbolNames.indexOf(e),0<=e&&(e+=t)}return e%100>=E||400<=e?0:Math.floor(p(e,0))};var I={x1:1,x2:0,y1:0,y2:0},P={x1:0,x2:0,y1:1,y2:0},z=u.format("~.1f"),D={radial:{node:"radialGradient"},radialreversed:{node:"radialGradient",reversed:!0},horizontal:{node:"linearGradient",attrs:I},horizontalreversed:{node:"linearGradient",attrs:I,reversed:!0},vertical:{node:"linearGradient",attrs:P},verticalreversed:{node:"linearGradient",attrs:P,reversed:!0}};C.gradient=function(e,t,a,o,r,n){for(var l=r.length,c=D[o],p=Array(l),g=0;g<l;g++)c.reversed?p[l-1-g]=[z(100*(1-r[g][0])),r[g][1]]:p[g]=[z(100*r[g][0]),r[g][1]];var h=t._fullLayout,y="g"+h._uid+"-"+a,x=h._defs.select(".gradients").selectAll("#"+y).data([o+p.join(";")],f.identity);x.exit().remove(),x.enter().append(c.node).each(function(){var e=u.select(this);c.attrs&&e.attr(c.attrs),e.attr("id",y);var t=e.selectAll("stop").data(p);t.exit().remove(),t.enter().append("stop"),t.each(function(e){var t=s(e[1]);u.select(this).attr({offset:e[0]+"%","stop-color":m.tinyRGB(t),"stop-opacity":t.getAlpha()})})}),e.style(n,d(y,t)).style(n+"-opacity",null);var _=function(e){return"."+e.attr("class").replace(/\s/g,".")},b=_(u.select(e.node().parentNode))+">"+_(e);h._gradientUrlQueryParts[b]=1},C.initGradients=function(e){var t=e._fullLayout,a=f.ensureSingle(t._defs,"g","gradients");a.selectAll("linearGradient,radialGradient").remove(),t._gradientUrlQueryParts={}},C.pointStyle=function(e,t,a){if(e.size()){var o=C.makePointStyleFns(t);e.each(function(e){C.singlePointStyle(e,u.select(this),t,o,a)})}},C.singlePointStyle=function(e,t,o,i,n){var l=o.marker,s=l.line;if(t.style("opacity",i.selectedOpacityFn?i.selectedOpacityFn(e):void 0===e.mo?l.opacity:e.mo),i.ms2mrc){var d;d="various"===e.ms||"various"===l.size?3:i.ms2mrc(e.ms),e.mrc=d,i.selectedSizeFn&&(d=e.mrc=i.selectedSizeFn(e));var c=C.symbolNumber(e.mx||l.symbol)||0;e.om=100<=c%200,t.attr("d",a(c,d))}var p=!1,u,g,h;if(e.so)h=s.outlierwidth,g=s.outliercolor,u=l.outliercolor;else{var y=(s||{}).width;h=(e.mlw+1||y+1||(e.trace?(e.trace.marker.line||{}).width:0)+1)-1||0,g="mlc"in e?e.mlcc=i.lineScale(e.mlc):f.isArrayOrTypedArray(s.color)?m.defaultLine:s.color,f.isArrayOrTypedArray(l.color)&&(u=m.defaultLine,p=!0),u="mc"in e?e.mcc=i.markerScale(e.mc):l.color||"rgba(0,0,0,0)",i.selectedColorFn&&(u=i.selectedColorFn(e))}if(e.om)t.call(m.stroke,u).style({"stroke-width":(h||1)+"px",fill:"none"});else{t.style("stroke-width",(e.isBlank?0:h)+"px");var x=l.gradient,_=e.mgt;if(_?p=!0:_=x&&x.type,Array.isArray(_)&&(_=_[0],!D[_]&&(_=0)),_&&"none"!==_){var b=e.mgc;b?p=!0:b=x.color;var v=o.uid;p&&(v+="-"+e.i),C.gradient(t,n,v,_,[[0,b],[1,u]],"fill")}else m.fill(t,u);h&&m.stroke(t,g)}},C.makePointStyleFns=function(e){var t={},a=e.marker;return t.markerScale=C.tryColorscale(a,""),t.lineScale=C.tryColorscale(a,"line"),g.traceIs(e,"symbols")&&(t.ms2mrc=T.isBubble(e)?A(e):function(){return(a.size||6)/2}),e.selectedpoints&&f.extendFlat(t,C.makeSelectedPointStyleFns(e)),t},C.makeSelectedPointStyleFns=function(e){var t={},a=e.selected||{},o=e.unselected||{},r=e.marker||{},i=a.marker||{},n=o.marker||{},l=r.opacity,s=i.opacity,c=n.opacity,p=void 0!==s,u=void 0!==c;(f.isArrayOrTypedArray(l)||p||u)&&(t.selectedOpacityFn=function(e){var t=void 0===e.mo?r.opacity:e.mo;return e.selected?p?s:t:u?c:k*t});var m=r.color,h=i.color,y=n.color;(h||y)&&(t.selectedColorFn=function(e){var t=e.mcc||m;return e.selected?h||t:y||t});var x=r.size,_=i.size,b=n.size,v=void 0!==_,w=void 0!==b;return g.traceIs(e,"symbols")&&(v||w)&&(t.selectedSizeFn=function(e){var t=e.mrc||x/2;return e.selected?v?_/2:t:w?b/2:t}),t},C.makeSelectedTextStyleFns=function(e){var t={},a=e.selected||{},o=e.unselected||{},r=e.textfont||{},i=a.textfont||{},n=o.textfont||{},l=r.color,s=i.color,c=n.color;return t.selectedTextColorFn=function(e){var t=e.tc||l;return e.selected?s||t:c?c:s?t:m.addOpacity(t,k)},t},C.selectedPointStyle=function(e,t){if(e.size()&&t.selectedpoints){var o=C.makeSelectedPointStyleFns(t),r=t.marker||{},n=[];o.selectedOpacityFn&&n.push(function(e,t){e.style("opacity",o.selectedOpacityFn(t))}),o.selectedColorFn&&n.push(function(e,t){m.fill(e,o.selectedColorFn(t))}),o.selectedSizeFn&&n.push(function(e,t){var i=t.mx||r.symbol||0,n=o.selectedSizeFn(t);e.attr("d",a(C.symbolNumber(i),n)),t.mrc2=n}),n.length&&e.each(function(e){for(var t=u.select(this),a=0;a<n.length;a++)n[a](t,e)})}},C.tryColorscale=function(e,t){var a=t?f.nestedProperty(e,t).get():e;if(a){var o=a.color;if((a.colorscale||a._colorAx)&&f.isArrayOrTypedArray(o))return h.makeColorScaleFuncFromTrace(a)}return f.identity};var O={start:1,end:-1,middle:0,bottom:1,top:-1};C.textPointStyle=function(e,t,a){if(e.size()){var i;if(t.selectedpoints){var n=C.makeSelectedTextStyleFns(t);i=n.selectedTextColorFn}var l=t.texttemplate,s=a._fullLayout;e.each(function(e){var n=u.select(this),d=l?f.extractOption(e,t,"txt","texttemplate"):f.extractOption(e,t,"tx","text");if(!d&&0!==d)return void n.remove();if(l){var c=t._module.formatLabels?t._module.formatLabels(e,t,s):{},p={};S(p,t,e.i);var g=t._meta||{};d=f.texttemplateString(d,c,s._d3locale,p,e,g)}var m=e.tp||t.textposition,h=r(e,t),y=i?i(e):e.tc||t.textfont.color;n.call(C.font,e.tf||t.textfont.family,h,y).text(d).call(_.convertToTspans,a).call(o,m,h,e.mrc)})}},C.selectedTextStyle=function(e,t){if(e.size()&&t.selectedpoints){var a=C.makeSelectedTextStyleFns(t);e.each(function(e){var i=u.select(this),n=a.selectedTextColorFn(e),l=e.tp||t.textposition,s=r(e,t);m.fill(i,n),o(i,l,s,e.mrc2||e.mrc)})}};var R=.5;C.smoothopen=function(e,t){if(3>e.length)return"M"+e.join("L");var a="M"+e[0],o=[],r;for(r=1;r<e.length-1;r++)o.push(n(e[r-1],e[r],e[r+1],t));for(a+="Q"+o[0][0]+" "+e[1],r=2;r<e.length-1;r++)a+="C"+o[r-2][1]+" "+o[r-1][0]+" "+e[r];return a+="Q"+o[e.length-3][1]+" "+e[e.length-1],a},C.smoothclosed=function(e,t){if(3>e.length)return"M"+e.join("L")+"Z";var a="M"+e[0],o=e.length-1,r=[n(e[o],e[0],e[1],t)],l;for(l=1;l<o;l++)r.push(n(e[l-1],e[l],e[l+1],t));for(r.push(n(e[o-1],e[o],e[0],t)),l=1;l<=o;l++)a+="C"+r[l-1][1]+" "+r[l][0]+" "+e[l];return a+="C"+r[o][1]+" "+r[0][0]+" "+e[0]+"Z",a};var M={hv:function(e,t){return"H"+u.round(t[0],2)+"V"+u.round(t[1],2)},vh:function(e,t){return"V"+u.round(t[1],2)+"H"+u.round(t[0],2)},hvh:function(e,t){return"H"+u.round((e[0]+t[0])/2,2)+"V"+u.round(t[1],2)+"H"+u.round(t[0],2)},vhv:function(e,t){return"V"+u.round((e[1]+t[1])/2,2)+"H"+u.round(t[0],2)+"V"+u.round(t[1],2)}},j=function(e,t){return"L"+u.round(t[0],2)+","+u.round(t[1],2)};C.steps=function(e){var t=M[e]||j;return function(e){for(var a="M"+u.round(e[0][0],2)+","+u.round(e[0][1],2),o=1;o<e.length;o++)a+=t(e[o-1],e[o]);return a}},C.makeTester=function(){var e=f.ensureSingleById(u.select("body"),"svg","js-plotly-tester",function(e){e.attr(b.svgAttrs).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px","z-index":"1"})}),t=f.ensureSingle(e,"path","js-reference-point",function(e){e.attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"})});C.tester=e,C.testref=t},C.savedBBoxes={};var B=0;C.bBox=function(e,t,a){a||(a=l(e));var o;if(a){if(o=C.savedBBoxes[a],o)return f.extendFlat({},o);}else if(1===e.childNodes.length){var r=e.childNodes[0];if(a=l(r),a){var i=+r.getAttribute("x")||0,n=+r.getAttribute("y")||0,s=r.getAttribute("transform");if(!s){var d=C.bBox(r,!1,a);return i&&(d.left+=i,d.right+=i),n&&(d.top+=n,d.bottom+=n),d}if(a+="~"+i+"~"+n+"~"+s,o=C.savedBBoxes[a],o)return f.extendFlat({},o)}}var c,p;t?c=e:(p=C.tester.node(),c=e.cloneNode(!0),p.appendChild(c)),u.select(c).attr("transform",null).call(_.positionText,0,0);var g=c.getBoundingClientRect(),m=C.testref.node().getBoundingClientRect();t||p.removeChild(c);var h={height:g.height,width:g.width,left:g.left-m.left,top:g.top-m.top,right:g.right-m.left,bottom:g.bottom-m.top};return B>=1e4&&(C.savedBBoxes={},B=0),a&&(C.savedBBoxes[a]=h),B++,f.extendFlat({},h)},C.setClipUrl=function(e,t,a){e.attr("clip-path",d(t,a))},C.getTranslate=function(e){var t=e.attr?"attr":"getAttribute",a=e[t]("transform")||"",o=a.replace(/.*\btranslate\((-?\d*\.?\d*)[^-\d]*(-?\d*\.?\d*)[^\d].*/,function(e,t,a){return[t,a].join(" ")}).split(" ");return{x:+o[0]||0,y:+o[1]||0}},C.setTranslate=function(e,t,a){var o=e.attr?"attr":"getAttribute",r=e.attr?"attr":"setAttribute",i=e[o]("transform")||"";return t=t||0,a=a||0,i=i.replace(/(\btranslate\(.*?\);?)/,"").trim(),i+=" translate("+t+", "+a+")",i=i.trim(),e[r]("transform",i),i},C.getScale=function(e){var t=e.attr?"attr":"getAttribute",a=e[t]("transform")||"",o=a.replace(/.*\bscale\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/,function(e,t,a){return[t,a].join(" ")}).split(" ");return{x:+o[0]||1,y:+o[1]||1}},C.setScale=function(e,t,a){var o=e.attr?"attr":"getAttribute",r=e.attr?"attr":"setAttribute",i=e[o]("transform")||"";return t=t||1,a=a||1,i=i.replace(/(\bscale\(.*?\);?)/,"").trim(),i+=" scale("+t+", "+a+")",i=i.trim(),e[r]("transform",i),i};C.setPointGroupScale=function(e,t,a){if(t=t||1,a=a||1,!!e){var o=1===t&&1===a?"":" scale("+t+","+a+")";e.each(function(){var e=(this.getAttribute("transform")||"").replace(/\s*sc.*/,"");e+=o,e=e.trim(),this.setAttribute("transform",e)})}};C.setTextPointsScale=function(e,t,a){e&&e.each(function(){var e=u.select(this),o=e.select("text"),r;if(o.node()){var i=parseFloat(o.attr("x")||0),n=parseFloat(o.attr("y")||0),l=(e.attr("transform")||"").match(/translate\([^)]*\)\s*$/);r=1===t&&1===a?[]:["translate("+i+","+n+")","scale("+t+","+a+")","translate("+-i+","+-n+")"],l&&r.push(l),e.attr("transform",r.join(" "))}})}},{"../../components/fx/helpers":560,"../../constants/alignment":626,"../../constants/interactions":632,"../../constants/xmlns_namespaces":634,"../../lib":657,"../../lib/svg_text_utils":681,"../../registry":788,"../../traces/scatter/make_bubble_size_func":1079,"../../traces/scatter/subtypes":1086,"../color":524,"../colorscale":536,"./symbol_defs":547,d3:108,"fast-isnumeric":201,tinycolor2:1309}],547:[function(e,t){'use strict';var a=Math.sqrt,o=e("d3");t.exports={circle:{n:0,f:function(e){var t=o.round(e,2);return"M"+t+",0A"+t+","+t+" 0 1,1 0,-"+t+"A"+t+","+t+" 0 0,1 "+t+",0Z"}},square:{n:1,f:function(e){var t=o.round(e,2);return"M"+t+","+t+"H-"+t+"V-"+t+"H"+t+"Z"}},diamond:{n:2,f:function(e){var t=o.round(1.3*e,2);return"M"+t+",0L0,"+t+"L-"+t+",0L0,-"+t+"Z"}},cross:{n:3,f:function(e){var t=o.round(.4*e,2),a=o.round(1.2*e,2);return"M"+a+","+t+"H"+t+"V"+a+"H-"+t+"V"+t+"H-"+a+"V-"+t+"H-"+t+"V-"+a+"H"+t+"V-"+t+"H"+a+"Z"}},x:{n:4,f:function(e){var t=o.round(.8*e/a(2),2),r="l"+t+","+t,i="l"+t+",-"+t,n="l-"+t+",-"+t,l="l-"+t+","+t;return"M0,"+t+r+i+n+i+n+l+n+l+r+l+r+"Z"}},"triangle-up":{n:5,f:function(e){var t=o.round(2*e/a(3),2),r=o.round(e/2,2),i=o.round(e,2);return"M-"+t+","+r+"H"+t+"L0,-"+i+"Z"}},"triangle-down":{n:6,f:function(e){var t=o.round(2*e/a(3),2),r=o.round(e/2,2),i=o.round(e,2);return"M-"+t+",-"+r+"H"+t+"L0,"+i+"Z"}},"triangle-left":{n:7,f:function(e){var t=o.round(2*e/a(3),2),r=o.round(e/2,2),i=o.round(e,2);return"M"+r+",-"+t+"V"+t+"L-"+i+",0Z"}},"triangle-right":{n:8,f:function(e){var t=o.round(2*e/a(3),2),r=o.round(e/2,2),i=o.round(e,2);return"M-"+r+",-"+t+"V"+t+"L"+i+",0Z"}},"triangle-ne":{n:9,f:function(e){var t=o.round(.6*e,2),a=o.round(1.2*e,2);return"M-"+a+",-"+t+"H"+t+"V"+a+"Z"}},"triangle-se":{n:10,f:function(e){var t=o.round(.6*e,2),a=o.round(1.2*e,2);return"M"+t+",-"+a+"V"+t+"H-"+a+"Z"}},"triangle-sw":{n:11,f:function(e){var t=o.round(.6*e,2),a=o.round(1.2*e,2);return"M"+a+","+t+"H-"+t+"V-"+a+"Z"}},"triangle-nw":{n:12,f:function(e){var t=o.round(.6*e,2),a=o.round(1.2*e,2);return"M-"+t+","+a+"V-"+t+"H"+a+"Z"}},pentagon:{n:13,f:function(e){var t=o.round(.951*e,2),a=o.round(.588*e,2),r=o.round(-e,2),i=o.round(-.309*e,2),n=o.round(.809*e,2);return"M"+t+","+i+"L"+a+","+n+"H-"+a+"L-"+t+","+i+"L0,"+r+"Z"}},hexagon:{n:14,f:function(e){var t=o.round(e,2),r=o.round(e/2,2),i=o.round(e*a(3)/2,2);return"M"+i+",-"+r+"V"+r+"L0,"+t+"L-"+i+","+r+"V-"+r+"L0,-"+t+"Z"}},hexagon2:{n:15,f:function(e){var t=o.round(e,2),r=o.round(e/2,2),i=o.round(e*a(3)/2,2);return"M-"+r+","+i+"H"+r+"L"+t+",0L"+r+",-"+i+"H-"+r+"L-"+t+",0Z"}},octagon:{n:16,f:function(e){var t=o.round(.924*e,2),a=o.round(.383*e,2);return"M-"+a+",-"+t+"H"+a+"L"+t+",-"+a+"V"+a+"L"+a+","+t+"H-"+a+"L-"+t+","+a+"V-"+a+"Z"}},star:{n:17,f:function(e){var t=1.4*e,a=o.round(.225*t,2),r=o.round(.951*t,2),i=o.round(.363*t,2),n=o.round(.588*t,2),l=o.round(-t,2),s=o.round(-.309*t,2),d=o.round(.118*t,2),c=o.round(.809*t,2),p=o.round(.382*t,2);return"M"+a+","+s+"H"+r+"L"+i+","+d+"L"+n+","+c+"L0,"+p+"L-"+n+","+c+"L-"+i+","+d+"L-"+r+","+s+"H-"+a+"L0,"+l+"Z"}},hexagram:{n:18,f:function(e){var t=o.round(.66*e,2),a=o.round(.38*e,2),r=o.round(.76*e,2);return"M-"+r+",0l-"+a+",-"+t+"h"+r+"l"+a+",-"+t+"l"+a+","+t+"h"+r+"l-"+a+","+t+"l"+a+","+t+"h-"+r+"l-"+a+","+t+"l-"+a+",-"+t+"h-"+r+"Z"}},"star-triangle-up":{n:19,f:function(e){var t=o.round(.8*(e*a(3)),2),r=o.round(.8*e,2),i=o.round(1.6*e,2),n=o.round(4*e,2),l="A "+n+","+n+" 0 0 1 ";return"M-"+t+","+r+l+t+","+r+l+"0,-"+i+l+"-"+t+","+r+"Z"}},"star-triangle-down":{n:20,f:function(e){var t=o.round(.8*(e*a(3)),2),r=o.round(.8*e,2),i=o.round(1.6*e,2),n=o.round(4*e,2),l="A "+n+","+n+" 0 0 1 ";return"M"+t+",-"+r+l+"-"+t+",-"+r+l+"0,"+i+l+t+",-"+r+"Z"}},"star-square":{n:21,f:function(e){var t=o.round(1.1*e,2),a=o.round(2*e,2),r="A "+a+","+a+" 0 0 1 ";return"M-"+t+",-"+t+r+"-"+t+","+t+r+t+","+t+r+t+",-"+t+r+"-"+t+",-"+t+"Z"}},"star-diamond":{n:22,f:function(e){var t=o.round(1.4*e,2),a=o.round(1.9*e,2),r="A "+a+","+a+" 0 0 1 ";return"M-"+t+",0"+r+"0,"+t+r+t+",0"+r+"0,-"+t+r+"-"+t+",0Z"}},"diamond-tall":{n:23,f:function(e){var t=o.round(.7*e,2),a=o.round(1.4*e,2);return"M0,"+a+"L"+t+",0L0,-"+a+"L-"+t+",0Z"}},"diamond-wide":{n:24,f:function(e){var t=o.round(1.4*e,2),a=o.round(.7*e,2);return"M0,"+a+"L"+t+",0L0,-"+a+"L-"+t+",0Z"}},hourglass:{n:25,f:function(e){var t=o.round(e,2);return"M"+t+","+t+"H-"+t+"L"+t+",-"+t+"H-"+t+"Z"},noDot:!0},bowtie:{n:26,f:function(e){var t=o.round(e,2);return"M"+t+","+t+"V-"+t+"L-"+t+","+t+"V-"+t+"Z"},noDot:!0},"circle-cross":{n:27,f:function(e){var t=o.round(e,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t+"M"+t+",0A"+t+","+t+" 0 1,1 0,-"+t+"A"+t+","+t+" 0 0,1 "+t+",0Z"},needLine:!0,noDot:!0},"circle-x":{n:28,f:function(e){var t=o.round(e,2),r=o.round(e/a(2),2);return"M"+r+","+r+"L-"+r+",-"+r+"M"+r+",-"+r+"L-"+r+","+r+"M"+t+",0A"+t+","+t+" 0 1,1 0,-"+t+"A"+t+","+t+" 0 0,1 "+t+",0Z"},needLine:!0,noDot:!0},"square-cross":{n:29,f:function(e){var t=o.round(e,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t+"M"+t+","+t+"H-"+t+"V-"+t+"H"+t+"Z"},needLine:!0,noDot:!0},"square-x":{n:30,f:function(e){var t=o.round(e,2);return"M"+t+","+t+"L-"+t+",-"+t+"M"+t+",-"+t+"L-"+t+","+t+"M"+t+","+t+"H-"+t+"V-"+t+"H"+t+"Z"},needLine:!0,noDot:!0},"diamond-cross":{n:31,f:function(e){var t=o.round(1.3*e,2);return"M"+t+",0L0,"+t+"L-"+t+",0L0,-"+t+"ZM0,-"+t+"V"+t+"M-"+t+",0H"+t},needLine:!0,noDot:!0},"diamond-x":{n:32,f:function(e){var t=o.round(1.3*e,2),a=o.round(.65*e,2);return"M"+t+",0L0,"+t+"L-"+t+",0L0,-"+t+"ZM-"+a+",-"+a+"L"+a+","+a+"M-"+a+","+a+"L"+a+",-"+a},needLine:!0,noDot:!0},"cross-thin":{n:33,f:function(e){var t=o.round(1.4*e,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t},needLine:!0,noDot:!0,noFill:!0},"x-thin":{n:34,f:function(e){var t=o.round(e,2);return"M"+t+","+t+"L-"+t+",-"+t+"M"+t+",-"+t+"L-"+t+","+t},needLine:!0,noDot:!0,noFill:!0},asterisk:{n:35,f:function(e){var t=o.round(1.2*e,2),a=o.round(.85*e,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t+"M"+a+","+a+"L-"+a+",-"+a+"M"+a+",-"+a+"L-"+a+","+a},needLine:!0,noDot:!0,noFill:!0},hash:{n:36,f:function(e){var t=o.round(e/2,2),a=o.round(e,2);return"M"+t+","+a+"V-"+a+"m-"+a+",0V"+a+"M"+a+","+t+"H-"+a+"m0,-"+a+"H"+a},needLine:!0,noFill:!0},"y-up":{n:37,f:function(e){var t=o.round(1.2*e,2),a=o.round(1.6*e,2),r=o.round(.8*e,2);return"M-"+t+","+r+"L0,0M"+t+","+r+"L0,0M0,-"+a+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-down":{n:38,f:function(e){var t=o.round(1.2*e,2),a=o.round(1.6*e,2),r=o.round(.8*e,2);return"M-"+t+",-"+r+"L0,0M"+t+",-"+r+"L0,0M0,"+a+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-left":{n:39,f:function(e){var t=o.round(1.2*e,2),a=o.round(1.6*e,2),r=o.round(.8*e,2);return"M"+r+","+t+"L0,0M"+r+",-"+t+"L0,0M-"+a+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-right":{n:40,f:function(e){var t=o.round(1.2*e,2),a=o.round(1.6*e,2),r=o.round(.8*e,2);return"M-"+r+","+t+"L0,0M-"+r+",-"+t+"L0,0M"+a+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"line-ew":{n:41,f:function(e){var t=o.round(1.4*e,2);return"M"+t+",0H-"+t},needLine:!0,noDot:!0,noFill:!0},"line-ns":{n:42,f:function(e){var t=o.round(1.4*e,2);return"M0,"+t+"V-"+t},needLine:!0,noDot:!0,noFill:!0},"line-ne":{n:43,f:function(e){var t=o.round(e,2);return"M"+t+",-"+t+"L-"+t+","+t},needLine:!0,noDot:!0,noFill:!0},"line-nw":{n:44,f:function(e){var t=o.round(e,2);return"M"+t+","+t+"L-"+t+",-"+t},needLine:!0,noDot:!0,noFill:!0}}},{d3:108}],548:[function(e,t){'use strict';t.exports={visible:{valType:"boolean",editType:"calc"},type:{valType:"enumerated",values:["percent","constant","sqrt","data"],editType:"calc"},symmetric:{valType:"boolean",editType:"calc"},array:{valType:"data_array",editType:"calc"},arrayminus:{valType:"data_array",editType:"calc"},value:{valType:"number",min:0,dflt:10,editType:"calc"},valueminus:{valType:"number",min:0,dflt:10,editType:"calc"},traceref:{valType:"integer",min:0,dflt:0,editType:"style"},tracerefminus:{valType:"integer",min:0,dflt:0,editType:"style"},copy_ystyle:{valType:"boolean",editType:"plot"},copy_zstyle:{valType:"boolean",editType:"style"},color:{valType:"color",editType:"style"},thickness:{valType:"number",min:0,dflt:2,editType:"style"},width:{valType:"number",min:0,editType:"plot"},editType:"calc",_deprecated:{opacity:{valType:"number",editType:"style"}}}},{}],549:[function(e,t){'use strict';function a(e,t,a,r){var d=t["error_"+r]||{},c=d.visible&&-1!==["linear","log"].indexOf(a.type),p=[];if(c){for(var u=s(d),g=0;g<e.length;g++){var m=e[g],h=m.i;if(void 0===h)h=g;else if(null===h)continue;var y=m[r];if(o(a.c2l(y))){var f=u(y,h);if(o(f[0])&&o(f[1])){var x=m[r+"s"]=y-f[0],_=m[r+"h"]=y+f[1];p.push(x,_)}}}var b=a._id,v=t._extremes[b],w=n.findExtremes(a,p,l.extendFlat({tozero:v.opts.tozero},{padded:!0}));v.min=v.min.concat(w.min),v.max=v.max.concat(w.max)}}var o=e("fast-isnumeric"),r=e("../../registry"),n=e("../../plots/cartesian/axes"),l=e("../../lib"),s=e("./compute_error");t.exports=function(e){for(var t=e.calcdata,o=0;o<t.length;o++){var l=t[o],s=l[0].trace;if(!0===s.visible&&r.traceIs(s,"errorBarsOK")){var d=n.getFromId(e,s.xaxis),c=n.getFromId(e,s.yaxis);a(l,s,d,"x"),a(l,s,c,"y")}}}},{"../../lib":657,"../../plots/cartesian/axes":705,"../../registry":788,"./compute_error":550,"fast-isnumeric":201}],550:[function(e,t){'use strict';var o=Math.sqrt,r=Math.abs;function a(e,t){return"percent"===e?function(e){return r(e*t/100)}:"constant"===e?function(){return r(t)}:"sqrt"===e?function(e){return o(r(e))}:void 0}t.exports=function(e){var t=e.type,o=e.symmetric;if("data"===t){var r=e.array||[];if(o)return function(e,t){var a=+r[t];return[a,a]};var i=e.arrayminus||[];return function(e,t){var a=+r[t],o=+i[t];return isNaN(a)&&isNaN(o)?[NaN,NaN]:[o||0,a||0]}}var n=a(t,e.value),l=a(t,e.valueminus);return o||void 0===e.valueminus?function(e){var t=n(e);return[t,t]}:function(e){return[l(e),n(e)]}}},{}],551:[function(e,t){'use strict';var a=e("fast-isnumeric"),o=e("../../registry"),r=e("../../lib"),i=e("../../plot_api/plot_template"),n=e("./attributes");t.exports=function(e,t,l,s){function d(e,t){return r.coerce(u,p,n,e,t)}var c="error_"+s.axis,p=i.newContainer(t,c),u=e[c]||{},g=u.array!==void 0||u.value!==void 0||"sqrt"===u.type,m=d("visible",g);if(!1!==m){var h=d("type","array"in u?"data":"percent"),y=!0;"sqrt"!==h&&(y=d("symmetric",!(("data"===h?"arrayminus":"valueminus")in u))),"data"===h?(d("array"),d("traceref"),!y&&(d("arrayminus"),d("tracerefminus"))):("percent"===h||"constant"===h)&&(d("value"),!y&&d("valueminus"));var f="copy_"+s.inherit+"style";if(s.inherit){var x=t["error_"+s.inherit];(x||{}).visible&&d(f,!(u.color||a(u.thickness)||a(u.width)))}s.inherit&&p[f]||(d("color",l),d("thickness"),d("width",o.traceIs(t,"gl3d")?0:4))}}},{"../../lib":657,"../../plot_api/plot_template":695,"../../registry":788,"./attributes":548,"fast-isnumeric":201}],552:[function(e,t){'use strict';var a=e("../../lib"),o=e("../../plot_api/edit_types").overrideAll,r=e("./attributes"),i={error_x:a.extendFlat({},r),error_y:a.extendFlat({},r)};delete i.error_x.copy_zstyle,delete i.error_y.copy_zstyle,delete i.error_y.copy_ystyle;var n={error_x:a.extendFlat({},r),error_y:a.extendFlat({},r),error_z:a.extendFlat({},r)};delete n.error_x.copy_ystyle,delete n.error_y.copy_ystyle,delete n.error_z.copy_ystyle,delete n.error_z.copy_zstyle,t.exports={moduleType:"component",name:"errorbars",schema:{traces:{scatter:i,bar:i,histogram:i,scatter3d:o(n,"calc","nested"),scattergl:o(i,"calc","nested")}},supplyDefaults:e("./defaults"),calc:e("./calc"),makeComputeError:e("./compute_error"),plot:e("./plot"),style:e("./style"),hoverInfo:function(e,t,a){(t.error_y||{}).visible&&(a.yerr=e.yh-e.y,!t.error_y.symmetric&&(a.yerrneg=e.y-e.ys)),(t.error_x||{}).visible&&(a.xerr=e.xh-e.x,!t.error_x.symmetric&&(a.xerrneg=e.x-e.xs))}}},{"../../lib":657,"../../plot_api/edit_types":688,"./attributes":548,"./calc":549,"./compute_error":550,"./defaults":551,"./plot":553,"./style":554}],553:[function(e,t){'use strict';function a(e,t,a){var o={x:t.c2p(e.x),y:a.c2p(e.y)};return void 0!==e.yh&&(o.yh=a.c2p(e.yh),o.ys=a.c2p(e.ys),!r(o.ys)&&(o.noYS=!0,o.ys=a.c2p(e.ys,!0))),void 0!==e.xh&&(o.xh=t.c2p(e.xh),o.xs=t.c2p(e.xs),!r(o.xs)&&(o.noXS=!0,o.xs=t.c2p(e.xs,!0))),o}var o=e("d3"),r=e("fast-isnumeric"),i=e("../drawing"),n=e("../../traces/scatter/subtypes");t.exports=function(e,t,l,s){var c=l.xaxis,p=l.yaxis,d=s&&0<s.duration,u;t.each(function(t){var g=t[0].trace,m=g.error_x||{},h=g.error_y||{},y;g.ids&&(y=function(e){return e.id});var f=n.hasMarkers(g)&&0<g.marker.maxdisplayed;h.visible||m.visible||(t=[]);var x=o.select(this).selectAll("g.errorbar").data(t,y);if(x.exit().remove(),!!t.length){m.visible||x.selectAll("path.xerror").remove(),h.visible||x.selectAll("path.yerror").remove(),x.style("opacity",1);var _=x.enter().append("g").classed("errorbar",!0);d&&_.style("opacity",0).transition().duration(s.duration).style("opacity",1),i.setClipUrl(x,l.layerClipId,e),x.each(function(e){var t=o.select(this),i=a(e,c,p);if(!f||e.vis){var n=t.select("path.yerror"),l;if(h.visible&&r(i.x)&&r(i.yh)&&r(i.ys)){var g=h.width;l="M"+(i.x-g)+","+i.yh+"h"+2*g+"m-"+g+",0V"+i.ys,i.noYS||(l+="m-"+g+",0h"+2*g),u=!n.size(),u?n=t.append("path").style("vector-effect","non-scaling-stroke").classed("yerror",!0):d&&(n=n.transition().duration(s.duration).ease(s.easing)),n.attr("d",l)}else n.remove();var y=t.select("path.xerror");if(m.visible&&r(i.y)&&r(i.xh)&&r(i.xs)){var x=(m.copy_ystyle?h:m).width;l="M"+i.xh+","+(i.y-x)+"v"+2*x+"m0,-"+x+"H"+i.xs,i.noXS||(l+="m0,-"+x+"v"+2*x),u=!y.size(),u?y=t.append("path").style("vector-effect","non-scaling-stroke").classed("xerror",!0):d&&(y=y.transition().duration(s.duration).ease(s.easing)),y.attr("d",l)}else y.remove()}})}})}},{"../../traces/scatter/subtypes":1086,"../drawing":546,d3:108,"fast-isnumeric":201}],554:[function(e,t){'use strict';var a=e("d3"),o=e("../color");t.exports=function(e){e.each(function(e){var t=e[0].trace,r=t.error_y||{},i=t.error_x||{},n=a.select(this);n.selectAll("path.yerror").style("stroke-width",r.thickness+"px").call(o.stroke,r.color),i.copy_ystyle&&(i=r),n.selectAll("path.xerror").style("stroke-width",i.thickness+"px").call(o.stroke,i.color)})}},{"../color":524,d3:108}],555:[function(e,t){'use strict';var a=e("../../plots/font_attributes"),o=e("./layout_attributes").hoverlabel,r=e("../../lib/extend").extendFlat;t.exports={hoverlabel:{bgcolor:r({},o.bgcolor,{arrayOk:!0}),bordercolor:r({},o.bordercolor,{arrayOk:!0}),font:a({arrayOk:!0,editType:"none"}),align:r({},o.align,{arrayOk:!0}),namelength:r({},o.namelength,{arrayOk:!0}),editType:"none"}}},{"../../lib/extend":648,"../../plots/font_attributes":733,"./layout_attributes":565}],556:[function(e,t){'use strict';function a(e,t,a,r){r=r||o.identity,Array.isArray(e)&&(t[0][a]=r(e))}var o=e("../../lib"),r=e("../../registry");t.exports=function(e){function t(e){return function(t){return o.coerceHoverinfo({hoverinfo:t},{_module:e._module},l)}}for(var n=e.calcdata,l=e._fullLayout,s=0;s<n.length;s++){var d=n[s],c=d[0].trace;if(!r.traceIs(c,"pie-like")){var p=r.traceIs(c,"2dMap")?a:o.fillArray;p(c.hoverinfo,d,"hi",t(c)),c.hovertemplate&&p(c.hovertemplate,d,"ht"),c.hoverlabel&&(p(c.hoverlabel.bgcolor,d,"hbg"),p(c.hoverlabel.bordercolor,d,"hbc"),p(c.hoverlabel.font.size,d,"hts"),p(c.hoverlabel.font.color,d,"htc"),p(c.hoverlabel.font.family,d,"htf"),p(c.hoverlabel.namelength,d,"hnl"),p(c.hoverlabel.align,d,"hta"))}}}},{"../../lib":657,"../../registry":788}],557:[function(e,t){'use strict';var a=e("../../registry"),o=e("./hover").hover;t.exports=function(e,t,r){function i(){e.emit("plotly_click",{points:e._hoverdata,event:t})}var n=a.getComponentMethod("annotations","onClick")(e,e._hoverdata);r!==void 0&&o(e,t,r,!0),e._hoverdata&&t&&t.target&&(n&&n.then?n.then(i):i(),t.stopImmediatePropagation&&t.stopImmediatePropagation())}},{"../../registry":788,"./hover":561}],558:[function(e,t){'use strict';t.exports={YANGLE:60,HOVERARROWSIZE:6,HOVERTEXTPAD:3,HOVERFONTSIZE:13,HOVERFONT:"Arial, sans-serif",HOVERMINTIME:50,HOVERID:"-hover"}},{}],559:[function(e,t){'use strict';var a=e("../../lib"),o=e("./attributes"),r=e("./hoverlabel_defaults");t.exports=function(e,t,i,n){var l=a.extendFlat({},n.hoverlabel);t.hovertemplate&&(l.namelength=-1),r(e,t,function(r,i){return a.coerce(e,t,o,r,i)},l)}},{"../../lib":657,"./attributes":555,"./hoverlabel_defaults":562}],560:[function(e,t,a){'use strict';function o(e){return n[e]||e}function r(e,t){if(!Array.isArray(t))return e[t];else if(Array.isArray(e)&&Array.isArray(e[t[0]]))return e[t[0]][t[1]]}var i=e("../../lib");a.getSubplot=function(e){return e.subplot||e.xaxis+e.yaxis||e.geo},a.isTraceInSubplots=function(e,t){if("splom"===e.type){for(var o=e.xaxes||[],r=e.yaxes||[],n=0;n<o.length;n++)for(var l=0;l<r.length;l++)if(-1!==t.indexOf(o[n]+r[l]))return!0;return!1}return-1!==t.indexOf(a.getSubplot(e))},a.flat=function(e,t){for(var a=Array(e.length),o=0;o<e.length;o++)a[o]=t;return a},a.p2c=function(e,t){for(var a=Array(e.length),o=0;o<e.length;o++)a[o]=e[o].p2c(t);return a},a.getDistanceFunction=function(e,t,o,r){return"closest"===e?r||a.quadrature(t,o):"x"===e.charAt(0)?t:o},a.getClosest=function(e,t,a){if(!1!==a.index)0<=a.index&&a.index<e.length?a.distance=0:a.index=!1;else for(var o=0,r;o<e.length;o++)r=t(e[o]),r<=a.distance&&(a.index=o,a.distance=r);return a},a.inbox=function(e,t,a){return 0>e*t||0===e?a:1/0},a.quadrature=function(e,t){return function(a){var o=e(a),r=t(a);return Math.sqrt(o*o+r*r)}},a.makeEventData=function(e,t,o){var r="index"in e?e.index:e.pointNumber,i={data:t._input,fullData:t,curveNumber:t.index,pointNumber:r};if(t._indexToPoints){var n=t._indexToPoints[r];1===n.length?i.pointIndex=n[0]:i.pointIndices=n}else i.pointIndex=r;return t._module.eventData?i=t._module.eventData(i,e,t,o,r):("xVal"in e?i.x=e.xVal:"x"in e&&(i.x=e.x),"yVal"in e?i.y=e.yVal:"y"in e&&(i.y=e.y),e.xa&&(i.xaxis=e.xa),e.ya&&(i.yaxis=e.ya),void 0!==e.zLabelVal&&(i.z=e.zLabelVal)),a.appendArrayPointValue(i,t,r),i},a.appendArrayPointValue=function(e,t,a){var n=t._arrayAttrs;if(n)for(var l=0;l<n.length;l++){var s=n[l],d=o(s);if(void 0===e[d]){var c=i.nestedProperty(t,s).get(),p=r(c,a);void 0!==p&&(e[d]=p)}}},a.appendArrayMultiPointValues=function(e,t,a){var n=t._arrayAttrs;if(n)for(var l=0;l<n.length;l++){var s=n[l],d=o(s);if(void 0===e[d]){for(var c=i.nestedProperty(t,s).get(),p=Array(a.length),u=0;u<a.length;u++)p[u]=r(c,a[u]);e[d]=p}}};var n={ids:"id",locations:"location",labels:"label",values:"value","marker.colors":"color",parents:"parent"},l={x:!0,y:!0},s={"x unified":!0,"y unified":!0};a.isUnifiedHover=function(e){return!("string"!=typeof e)&&!!s[e]},a.isXYhover=function(e){return!("string"!=typeof e)&&!!l[e]}},{"../../lib":657}],561:[function(e,t,a){'use strict';var h=Math.round,y=Math.sin,f=Math.min,x=Math.abs,_=Math.max;function o(e,t,a,o){function l(e,a){for(X=0;X<U.length;X++)if(Z=U[X],Z&&Z[0]&&Z[0].trace&&(K=Z[0].trace,!0===K.visible&&0!==K._length&&-1===["carpet","contourcarpet"].indexOf(K._module.name))){if("splom"===K.type?(J=0,$=y[J]):($=P.getSubplot(K),J=y.indexOf($)),Q=B,P.isUnifiedHover(Q)&&(Q=Q.charAt(0)),ae={cd:Z,trace:K,xa:z[J],ya:D[J],maxHoverDistance:F,maxSpikeDistance:N,index:!1,distance:f(se,F),spikeDistance:1/0,xSpike:void 0,ySpike:void 0,color:C.defaultLine,name:K.name,x0:void 0,x1:void 0,y0:void 0,y1:void 0,xLabelVal:void 0,yLabelVal:void 0,zLabelVal:void 0,text:void 0},x[$]&&(ae.subplot=x[$]._subplot),x._splomScenes&&x._splomScenes[K.uid]&&(ae.scene=x._splomScenes[K.uid]),oe=V.length,"array"===Q){var o=t[X];"pointNumber"in o?(ae.index=o.pointNumber,Q="closest"):(Q="","xval"in o&&(ee=o.xval,Q="x"),"yval"in o&&(te=o.yval,Q=Q?"closest":"y"))}else void 0!==e&&void 0!==a?(ee=e,te=a):(ee=G[J],te=Y[J]);if(0!==F)if(K._module&&K._module.hoverPoints){var r=K._module.hoverPoints(ae,ee,te,Q,x._hoverlayer);if(r)for(var n=0,l;n<r.length;n++)l=r[n],i(l.x0)&&i(l.y0)&&V.push(c(l,B))}else w.log("Unrecognized trace type in hover:",K);if("closest"===B&&V.length>oe&&(V.splice(0,oe),se=V[0].distance),T&&0!==N&&0===V.length){ae.distance=N,ae.index=!1;var s=K._module.hoverPoints(ae,ee,te,"closest",x._hoverlayer);if(s&&(s=s.filter(function(e){return e.spikeDistance<=N})),s&&s.length){var d=s.filter(function(e){return e.xa.showspikes&&"hovered data"!==e.xa.spikesnap}),p;if(d.length){var u=d[0];i(u.x0)&&i(u.y0)&&(p=h(u),(!H.vLinePoint||H.vLinePoint.spikeDistance>p.spikeDistance)&&(H.vLinePoint=p))}var g=s.filter(function(e){return e.ya.showspikes&&"hovered data"!==e.ya.spikesnap});if(g.length){var m=g[0];i(m.x0)&&i(m.y0)&&(p=h(m),(!H.hLinePoint||H.hLinePoint.spikeDistance>p.spikeDistance)&&(H.hLinePoint=p))}}}}}function m(e,t){for(var a=null,o=1/0,r=0,n;r<e.length;r++)n=e[r].spikeDistance,n<=o&&n<=t&&(a=e[r],o=n);return a}function h(e){return e?{xa:e.xa,ya:e.ya,x:void 0===e.xSpike?(e.x0+e.x1)/2:e.xSpike,y:void 0===e.ySpike?(e.y0+e.y1)/2:e.ySpike,distance:e.distance,spikeDistance:e.spikeDistance,curveNumber:e.trace.index,color:e.color,pointNumber:e.index}:null}a||(a="xy");var y=Array.isArray(a)?a:[a],x=e._fullLayout,_=x._plots||[],v=_[a],T=x._has("cartesian");if(v){var S=v.overlays.map(function(e){return e.id});y=y.concat(S)}for(var E=y.length,z=Array(E),D=Array(E),O=!1,R=0,M;R<E;R++)if(M=y[R],_[M])O=!0,z[R]=_[M].xaxis,D[R]=_[M].yaxis;else if(x[M]&&x[M]._subplot){var j=x[M]._subplot;z[R]=j.xaxis,D[R]=j.yaxis}else return void w.warn("Unrecognized subplot: "+M);var B=t.hovermode||x.hovermode;if(B&&!O&&(B="closest"),-1===["x","y","closest","x unified","y unified"].indexOf(B)||!e.calcdata||e.querySelector(".zoombox")||e._dragging)return L.unhoverRaw(e,t);var F=-1===x.hoverdistance?1/0:x.hoverdistance,N=-1===x.spikedistance?1/0:x.spikedistance,V=[],U=[],H={hLinePoint:null,vLinePoint:null},q=!1,G,Y,W,X,Z,K,$,J,Q,ee,te,ae,oe;if(Array.isArray(t))for(B="array",W=0;W<t.length;W++)Z=e.calcdata[t[W].curveNumber||0],Z&&(K=Z[0].trace,"skip"!==Z[0].trace.hoverinfo&&(U.push(Z),"h"===K.orientation&&(q=!0)));else{for(X=0;X<e.calcdata.length;X++)Z=e.calcdata[X],K=Z[0].trace,"skip"!==K.hoverinfo&&P.isTraceInSubplots(K,y)&&(U.push(Z),"h"===K.orientation&&(q=!0));var re=!t.target,ie,ne;if(re)ie="xpx"in t?t.xpx:z[0]._length/2,ne="ypx"in t?t.ypx:D[0]._length/2;else{if(!1===k.triggerHandler(e,"plotly_beforehover",t))return;var le=t.target.getBoundingClientRect();if(ie=t.clientX-le.left,ne=t.clientY-le.top,0>ie||ie>z[0]._length||0>ne||ne>D[0]._length)return L.unhoverRaw(e,t)}if(t.pointerX=ie+z[0]._offset,t.pointerY=ne+D[0]._offset,G="xval"in t?P.flat(y,t.xval):P.p2c(z,ie),Y="yval"in t?P.flat(y,t.yval):P.p2c(D,ne),!i(G[0])||!i(Y[0]))return w.warn("Fx.hover failed",t,e),L.unhoverRaw(e,t)}var se=1/0;l();var de={fullLayout:x,container:x._hoverlayer,outerContainer:x._paperdiv,event:t},ce=e._spikepoints,pe={vLinePoint:H.vLinePoint,hLinePoint:H.hLinePoint};if(e._spikepoints=pe,T&&0!==N&&0!==V.length){var ue=V.filter(function(e){return e.ya.showspikes}),ge=m(ue,N);H.hLinePoint=h(ge);var me=V.filter(function(e){return e.xa.showspikes}),he=m(me,N);H.vLinePoint=h(he)}if(0===V.length){var ye=L.unhoverRaw(e,t);return T&&(null!==H.hLinePoint||null!==H.vLinePoint)&&g(ce)&&p(e,H,de),ye}if(T&&g(ce)&&p(e,H,de),V.sort(function(e,t){return e.distance-t.distance}),P.isXYhover(Q)&&0!==V[0].length&&"splom"!==V[0].trace.type){var fe=V[0],xe=fe.cd[fe.index],_e="group"===x.boxmode||"group"===x.violinmode,be=fe.xVal,ve=fe.xa;"category"===ve.type&&(be=ve._categoriesMap[be]),"date"===ve.type&&(be=ve.d2c(be)),xe&&xe.t&&xe.t.posLetter===ve._id&&_e&&(be+=xe.t.dPos);var we=fe.yVal;ve=fe.ya,"category"===ve.type&&(we=ve._categoriesMap[we]),"date"===ve.type&&(we=ve.d2c(we)),xe&&xe.t&&xe.t.posLetter===ve._id&&_e&&(we+=xe.t.dPos),l(be,we);var ke={};V=V.filter(function(e){var t=r(e);if(!ke[t])return ke[t]=!0,ke[t]})}var Te=e._hoverdata,Ae=[];for(W=0;W<V.length;W++){var Se=V[W],Ce=P.makeEventData(Se,Se.trace,Se.cd);if(!1!==Se.hovertemplate){var Le=!1;Se.cd[Se.index]&&Se.cd[Se.index].ht&&(Le=Se.cd[Se.index].ht),Se.hovertemplate=Le||Se.trace.hovertemplate||!1}Se.eventData=[Ce],Ae.push(Ce)}e._hoverdata=Ae;var Ee="y"===B&&(1<U.length||1<V.length)||"closest"===B&&q&&1<V.length,Ie=C.combine(x.plot_bgcolor||C.background,x.paper_bgcolor),Pe={hovermode:B,rotateLabels:Ee,bgColor:Ie,container:x._hoverlayer,outerContainer:x._paperdiv,commonLabelOpts:x.hoverlabel,hoverdistance:x.hoverdistance},ze=n(V,Pe,e);if(P.isUnifiedHover(B)||(s(ze,Ee?"xa":"ya",x),d(ze,Ee)),t.target&&t.target.tagName){var De=I.getComponentMethod("annotations","hasClickToShow")(e,Ae);A(b.select(t.target),De?"pointer":"")}t.target&&!o&&u(e,t,Te)&&(Te&&e.emit("plotly_unhover",{event:t,points:Te}),e.emit("plotly_hover",{event:t,points:e._hoverdata,xaxes:z,yaxes:D,xvals:G,yvals:Y}))}function r(e){return[e.trace.index,e.index,e.x0,e.y0,e.name,e.attr,e.xa,e.ya||""].join(",")}function n(e,t,a){function o(e){return e.filter(function(e){return void 0!==e.zLabelVal||(e[A]||"").split(" ")[0]===E})}var n=a._fullLayout,s=t.hovermode,c=t.rotateLabels,p=t.bgColor,u=t.container,g=t.outerContainer,m=t.commonLabelOpts||{},y=t.fontFamily||z.HOVERFONT,f=t.fontSize||z.HOVERFONTSIZE,v=e[0],d=v.xa,k=v.ya,A="y"===s.charAt(0)?"yLabel":"xLabel",L=v[A],E=(L+""||"").split(" ")[0],I=g.node().getBoundingClientRect(),M=I.top,B=I.width,F=I.height,U=void 0!==L&&v.distance<=t.hoverdistance&&("x"===s||"y"===s);if(U){var H=!0,q,G;for(q=0;q<e.length;q++)if(H&&void 0===e[q].zLabel&&(H=!1),G=e[q].hoverinfo||e[q].trace.hoverinfo,G){var Y=Array.isArray(G)?G:G.split("+");if(-1===Y.indexOf("all")&&-1===Y.indexOf(s)){U=!1;break}}H&&(U=!1)}var W=u.selectAll("g.axistext").data(U?[0]:[]);if(W.enter().append("g").classed("axistext",!0),W.exit().remove(),W.each(function(){var t=b.select(this),r=w.ensureSingle(t,"path","",function(e){e.style({"stroke-width":"1px"})}),i=w.ensureSingle(t,"text","",function(e){e.attr("data-notex",1)}),l=m.bgcolor||C.defaultLine,c=m.bordercolor||C.contrast(l),p=C.contrast(l),u={family:m.font.family||y,size:m.font.size||f,color:m.font.color||p};r.style({fill:l,stroke:c}),i.text(L).call(S.font,u).call(T.positionText,0,0).call(T.convertToTspans,a),t.attr("transform","");var g=i.node().getBoundingClientRect(),x,_;if("x"===s){var A="top"===d.side?"-":"";i.attr("text-anchor","middle").call(T.positionText,0,"top"===d.side?M-g.bottom-N-V:M-g.top+N+V),x=d._offset+(v.x0+v.x1)/2,_=k._offset+("top"===d.side?0:k._length);var E=g.width/2+V;x<E?(x=E,r.attr("d","M-"+(E-N)+",0L-"+(E-2*N)+","+A+N+"H"+(V+g.width/2)+"v"+A+(2*V+g.height)+"H-"+E+"V"+A+N+"Z")):x>n.width-E?(x=n.width-E,r.attr("d","M"+(E-N)+",0L"+E+","+A+N+"v"+A+(2*V+g.height)+"H-"+E+"V"+A+N+"H"+(E-2*N)+"Z")):r.attr("d","M0,0L"+N+","+A+N+"H"+(V+g.width/2)+"v"+A+(2*V+g.height)+"H-"+(V+g.width/2)+"V"+A+N+"H-"+N+"Z")}else{var I,P,z;"right"===k.side?(I="start",P=1,z="",x=d._offset+d._length):(I="end",P=-1,z="-",x=d._offset),_=k._offset+(v.y0+v.y1)/2,i.attr("text-anchor",I),r.attr("d","M0,0L"+z+N+","+N+"V"+(V+g.height/2)+"h"+z+(2*V+g.width)+"V-"+(V+g.height/2)+"H"+z+N+"V-"+N+"Z");var D=g.height/2,O=M-g.top-D,R="clip"+n._uid+"commonlabel"+k._id,j;if(x<g.width+2*V+N){j="M-"+(N+V)+"-"+D+"h-"+(g.width-V)+"V"+D+"h"+(g.width-V)+"Z";var B=g.width-x+V;T.positionText(i,B,O),"end"===I&&i.selectAll("tspan").each(function(){var e=b.select(this),t=S.tester.append("text").text(e.text()).call(S.font,u),a=t.node().getBoundingClientRect();h(a.width)<h(g.width)&&e.attr("x",B-a.width),t.remove()})}else T.positionText(i,P*(V+N),O),j=null;var F=n._topclips.selectAll("#"+R).data(j?[0]:[]);F.enter().append("clipPath").attr("id",R).append("path"),F.exit().remove(),F.select("path").attr("d",j),S.setClipUrl(i,j?R:null,a)}t.attr("transform","translate("+x+","+_+")"),e=o(e)}),P.isUnifiedHover(s)){if(u.selectAll("g.hovertext").remove(),void 0!==L&&v.distance<=t.hoverdistance&&(e=o(e)),0===e.length)return;var X={showlegend:!0,legend:{title:{text:L,font:n.hoverlabel.font},font:n.hoverlabel.font,bgcolor:n.hoverlabel.bgcolor,bordercolor:n.hoverlabel.bordercolor,borderwidth:1,tracegroupgap:7,traceorder:n.legend?n.legend.traceorder:void 0,orientation:"v"}},Z={};D(X,Z,a._fullData);var K=Z.legend;K.entries=[];for(var $=0;$<e.length;$++){var J=l(e[$],!0,s,n,L),Q=J[0],ee=J[1],te=e[$];te.name=ee,te.text=""===ee?Q:ee+" : "+Q;var ae=te.cd[te.index];ae&&(ae.mc&&(te.mc=ae.mc),ae.mcc&&(te.mc=ae.mcc),ae.mlc&&(te.mlc=ae.mlc),ae.mlcc&&(te.mlc=ae.mlcc),ae.mlw&&(te.mlw=ae.mlw),ae.mrc&&(te.mrc=ae.mrc),ae.dir&&(te.dir=ae.dir)),te._distinct=!0,K.entries.push([te])}K.entries.sort(function(e,t){return e[0].trace.index-t[0].trace.index}),K.layer=u,O(a,K);var oe=w.mean(e.map(function(e){return(e.y0+e.y1)/2})),re=w.mean(e.map(function(e){return(e.x0+e.x1)/2})),ie=u.select("g.legend"),ne=ie.node().getBoundingClientRect();re+=d._offset,oe+=k._offset-ne.height/2;var le=ne.width+2*V,se=re+le<=B,de=0<=re-le;!se&&de?re-=le:re+=2*V;var ce=ne.height+2*V,pe=oe<=M,ue=oe+ce>=F;return ce<=F&&(pe?oe=k._offset+2*V:ue&&(oe=F-ce)),ie.attr("transform","translate("+re+","+oe+")"),ie}var ge=u.selectAll("g.hovertext").data(e,function(e){return r(e)});return ge.enter().append("g").classed("hovertext",!0).each(function(){var e=b.select(this);e.append("rect").call(C.fill,C.addOpacity(p,.8)),e.append("text").classed("name",!0),e.append("path").style("stroke-width","1px"),e.append("text").classed("nums",!0).call(S.font,y,f)}),ge.exit().remove(),ge.each(function(e){var t=b.select(this).attr("transform",""),o=e.bgcolor||e.color,r=C.combine(C.opacity(o)?o:C.defaultLine,p),i=C.combine(C.opacity(e.color)?e.color:C.defaultLine,p),d=e.borderColor||C.contrast(r),u=l(e,U,s,n,L,t),g=u[0],m=u[1],h=t.select("text.nums").call(S.font,e.fontFamily||y,e.fontSize||f,e.fontColor||d).text(g).attr("data-notex",1).call(T.positionText,0,0).call(T.convertToTspans,a),v=t.select("text.name"),w=0,k=0;if(m&&m!==g){v.call(S.font,e.fontFamily||y,e.fontSize||f,i).text(m).attr("data-notex",1).call(T.positionText,0,0).call(T.convertToTspans,a);var A=v.node().getBoundingClientRect();w=A.width+2*V,k=A.height+2*V}else v.remove(),t.select("rect").remove();t.select("path").style({fill:r,stroke:d});var E=h.node().getBoundingClientRect(),I=e.xa._offset+(e.x0+e.x1)/2,P=e.ya._offset+(e.y0+e.y1)/2,z=x(e.x1-e.x0),D=x(e.y1-e.y0),O=E.width+N+V+w,j,H;if(e.ty0=M-E.top,e.bx=E.width+2*V,e.by=_(E.height+2*V,k),e.anchor="start",e.txwidth=E.width,e.tx2width=w,e.offset=0,c)e.pos=I,j=P+D/2+O<=F,H=0<=P-D/2-O,("top"===e.idealAlign||!j)&&H?(P-=D/2,e.anchor="end"):j?(P+=D/2,e.anchor="start"):e.anchor="middle";else if(e.pos=P,j=I+z/2+O<=B,H=0<=I-z/2-O,("left"===e.idealAlign||!j)&&H)I-=z/2,e.anchor="end";else if(j)I+=z/2,e.anchor="start";else{e.anchor="middle";var q=O/2,G=I+q-B,Y=I-q;0<G&&(I-=G),0>Y&&(I+=-Y)}h.attr("text-anchor",e.anchor),w&&v.attr("text-anchor",e.anchor),t.attr("transform","translate("+I+","+P+")"+(c?"rotate("+R+")":""))}),ge}function l(e,t,a,o,r,i){var n="",l="";void 0!==e.nameOverride&&(e.name=e.nameOverride),e.name&&(e.trace._meta&&(e.name=w.templateString(e.name,e.trace._meta)),n=m(e.name,e.nameLength)),void 0===e.zLabel?t&&e[a.charAt(0)+"Label"]===r?l=e[("x"===a.charAt(0)?"y":"x")+"Label"]||"":void 0===e.xLabel?void 0!==e.yLabel&&"scattercarpet"!==e.trace.type&&(l=e.yLabel):void 0===e.yLabel?l=e.xLabel:l="("+e.xLabel+", "+e.yLabel+")":(void 0!==e.xLabel&&(l+="x: "+e.xLabel+"<br>"),void 0!==e.yLabel&&(l+="y: "+e.yLabel+"<br>"),"choropleth"!==e.trace.type&&"choroplethmapbox"!==e.trace.type&&(l+=(l?"z: ":"")+e.zLabel)),(e.text||0===e.text)&&!Array.isArray(e.text)&&(l+=(l?"<br>":"")+e.text),void 0!==e.extraText&&(l+=(l?"<br>":"")+e.extraText),i&&""===l&&!e.hovertemplate&&(""===n&&i.remove(),l=n);var s=o._d3locale,d=e.hovertemplate||!1,c=e.hovertemplateLabels||e,p=e.eventData[0]||{};return d&&(l=w.hovertemplateString(d,c,s,p,e.trace._meta),l=l.replace(U,function(t,a){return n=m(a,e.nameLength),""})),[l,n]}function s(e,t,a){function o(e){var t=e[0],a=e[e.length-1];if(p=t.pmin-t.pos-t.dp+t.size,u=a.pos+a.dp+a.size-t.pmax,.01<p){for(m=e.length-1;0<=m;m--)e[m].dp+=p;d=!1}if(!(.01>u)){if(-.01>p){for(m=e.length-1;0<=m;m--)e[m].dp-=u;d=!1}if(d){var o=0;for(g=0;g<e.length;g++)h=e[g],h.pos+h.dp+h.size>t.pmax&&o++;for(g=e.length-1;0<=g&&!(0>=o);g--)h=e[g],h.pos>t.pmax-1&&(h.del=!0,o--);for(g=0;g<e.length&&!(0>=o);g++)if(h=e[g],h.pos<t.pmin+1)for(h.del=!0,o--,u=2*h.size,m=e.length-1;0<=m;m--)e[m].dp-=u;for(g=e.length-1;0<=g&&!(0>=o);g--)h=e[g],h.pos+h.dp+h.size>t.pmax&&(h.del=!0,o--)}}}var r=0,n=1,l=e.size(),s=Array(l),c=0;e.each(function(e){var o=e[t],r="x"===o._id.charAt(0),i=o.range;0===c&&i&&i[0]>i[1]!==r&&(n=-1),s[c++]=[{datum:e,traceIndex:e.trace.index,dp:0,pos:e.pos,posref:e.posref,size:e.by*(r?j:1)/2,pmin:0,pmax:r?a.width:a.height}]}),s.sort(function(e,t){return e[0].posref-t[0].posref||n*(t[0].traceIndex-e[0].traceIndex)});for(var d,p,u,g,m,h,y;!d&&r<=l;){for(r++,d=!0,g=0;g<s.length-1;){var f=s[g],x=s[g+1],_=f[f.length-1],b=x[0];if(p=_.pos+_.dp+_.size-b.pos-b.dp+b.size,.01<p&&_.pmin===b.pmin&&_.pmax===b.pmax){for(m=x.length-1;0<=m;m--)x[m].dp+=p;for(f.push.apply(f,x),s.splice(g+1,1),y=0,m=f.length-1;0<=m;m--)y+=f[m].dp;for(u=y/f.length,m=f.length-1;0<=m;m--)f[m].dp-=u;d=!1}else g++}s.forEach(o)}for(g=s.length-1;0<=g;g--){var v=s[g];for(m=v.length-1;0<=m;m--){var w=v[m],T=w.datum;T.offset=w.dp,T.del=w.del}}}function d(e,t){e.each(function(e){var a=b.select(this);if(e.del)return a.remove();var o=a.select("text.nums"),r=e.anchor,i="end"===r?-1:1,n={start:1,end:-1,middle:0}[r],l=n*(N+V),s=l+n*(e.txwidth+V),d=0,c=e.offset;"middle"===r&&(l-=e.tx2width/2,s+=e.txwidth/2+V),t&&(c*=-F,d=e.offset*B),a.select("path").attr("d","middle"===r?"M-"+(e.bx/2+e.tx2width/2)+","+(c-e.by/2)+"h"+e.bx+"v"+e.by+"h-"+e.bx+"Z":"M0,0L"+(i*N+d)+","+(N+c)+"v"+(e.by/2-N)+"h"+i*e.bx+"v-"+e.by+"H"+(i*N+d)+"V"+(c-N)+"Z");var p=l+d,u=c+e.ty0-e.by/2+V,g=e.textAlign||"auto";"auto"!==g&&("left"===g&&"start"!==r?(o.attr("text-anchor","start"),p="middle"===r?-e.bx/2-e.tx2width/2+V:-e.bx-V):"right"===g&&"end"!==r&&(o.attr("text-anchor","end"),p="middle"===r?e.bx/2-e.tx2width/2-V:e.bx+V)),o.call(T.positionText,p,u),e.tx2width&&(a.select("text.name").call(T.positionText,s+n*V+d,c+e.ty0-e.by/2+V),a.select("rect").call(S.setRect,s+(n-1)*e.tx2width/2+d,c-e.by/2-1,e.tx2width,e.by+2))})}function c(e,t){function a(e){return e||i(e)&&0===e}function o(t,o,r){var i=d(o,r);a(i)&&(e[t]=i)}var r=e.index,n=e.trace||{},l=e.cd[0],s=e.cd[r]||{},d=Array.isArray(r)?function(e,t){var o=w.castOption(l,r,e);return a(o)?o:w.extractOption({},n,"",t)}:function(e,t){return w.extractOption(s,n,e,t)};if(o("hoverinfo","hi","hoverinfo"),o("bgcolor","hbg","hoverlabel.bgcolor"),o("borderColor","hbc","hoverlabel.bordercolor"),o("fontFamily","htf","hoverlabel.font.family"),o("fontSize","hts","hoverlabel.font.size"),o("fontColor","htc","hoverlabel.font.color"),o("nameLength","hnl","hoverlabel.namelength"),o("textAlign","hta","hoverlabel.align"),e.posref="y"===t||"closest"===t&&"h"===n.orientation?e.xa._offset+(e.x0+e.x1)/2:e.ya._offset+(e.y0+e.y1)/2,e.x0=w.constrain(e.x0,0,e.xa._length),e.x1=w.constrain(e.x1,0,e.xa._length),e.y0=w.constrain(e.y0,0,e.ya._length),e.y1=w.constrain(e.y1,0,e.ya._length),void 0!==e.xLabelVal&&(e.xLabel="xLabel"in e?e.xLabel:E.hoverLabelText(e.xa,e.xLabelVal),e.xVal=e.xa.c2d(e.xLabelVal)),void 0!==e.yLabelVal&&(e.yLabel="yLabel"in e?e.yLabel:E.hoverLabelText(e.ya,e.yLabelVal),e.yVal=e.ya.c2d(e.yLabelVal)),void 0!==e.zLabelVal&&void 0===e.zLabel&&(e.zLabel=e.zLabelVal+""),!isNaN(e.xerr)&&!("log"===e.xa.type&&0>=e.xerr)){var c=E.tickText(e.xa,e.xa.c2l(e.xerr),"hover").text;e.xLabel+=void 0===e.xerrneg?" \xB1 "+c:" +"+c+" / -"+E.tickText(e.xa,e.xa.c2l(e.xerrneg),"hover").text,"x"===t&&(e.distance+=1)}if(!isNaN(e.yerr)&&!("log"===e.ya.type&&0>=e.yerr)){var p=E.tickText(e.ya,e.ya.c2l(e.yerr),"hover").text;e.yLabel+=void 0===e.yerrneg?" \xB1 "+p:" +"+p+" / -"+E.tickText(e.ya,e.ya.c2l(e.yerrneg),"hover").text,"y"===t&&(e.distance+=1)}var u=e.hoverinfo||e.trace.hoverinfo;return u&&"all"!==u&&(u=Array.isArray(u)?u:u.split("+"),-1===u.indexOf("x")&&(e.xLabel=void 0),-1===u.indexOf("y")&&(e.yLabel=void 0),-1===u.indexOf("z")&&(e.zLabel=void 0),-1===u.indexOf("text")&&(e.text=void 0),-1===u.indexOf("name")&&(e.name=void 0)),e}function p(e,t,a){var o=a.container,r=a.fullLayout,i=r._size,n=a.event,l=!!t.hLinePoint,s=!!t.vLinePoint,d,c;if(o.selectAll(".spikeline").remove(),!!(s||l)){var p=C.combine(r.plot_bgcolor,r.paper_bgcolor);if(l){var u=t.hLinePoint,g,m;d=u&&u.xa,c=u&&u.ya;var h=c.spikesnap;"cursor"===h?(g=n.pointerX,m=n.pointerY):(g=d._offset+u.x,m=c._offset+u.y);var y=1.5>v.readability(u.color,p)?C.contrast(p):u.color,x=c.spikemode,b=c.spikethickness,w=c.spikecolor||y,k=E.getPxPosition(e,c),T,A;if(-1!==x.indexOf("toaxis")||-1!==x.indexOf("across")){if(-1!==x.indexOf("toaxis")&&(T=k,A=g),-1!==x.indexOf("across")){var L=c._counterDomainMin,I=c._counterDomainMax;"free"===c.anchor&&(L=f(L,c.position),I=_(I,c.position)),T=i.l+L*i.w,A=i.l+I*i.w}o.insert("line",":first-child").attr({x1:T,x2:A,y1:m,y2:m,"stroke-width":b,stroke:w,"stroke-dasharray":S.dashStyle(c.spikedash,b)}).classed("spikeline",!0).classed("crisp",!0),o.insert("line",":first-child").attr({x1:T,x2:A,y1:m,y2:m,"stroke-width":b+2,stroke:p}).classed("spikeline",!0).classed("crisp",!0)}-1!==x.indexOf("marker")&&o.insert("circle",":first-child").attr({cx:k+("right"===c.side?-b:b),cy:m,r:b,fill:w}).classed("spikeline",!0)}if(s){var P=t.vLinePoint,z,D;d=P&&P.xa,c=P&&P.ya;var O=d.spikesnap;"cursor"===O?(z=n.pointerX,D=n.pointerY):(z=d._offset+P.x,D=c._offset+P.y);var R=1.5>v.readability(P.color,p)?C.contrast(p):P.color,M=d.spikemode,j=d.spikethickness,B=d.spikecolor||R,F=E.getPxPosition(e,d),N,V;if(-1!==M.indexOf("toaxis")||-1!==M.indexOf("across")){if(-1!==M.indexOf("toaxis")&&(N=F,V=D),-1!==M.indexOf("across")){var U=d._counterDomainMin,H=d._counterDomainMax;"free"===d.anchor&&(U=f(U,d.position),H=_(H,d.position)),N=i.t+(1-H)*i.h,V=i.t+(1-U)*i.h}o.insert("line",":first-child").attr({x1:z,x2:z,y1:N,y2:V,"stroke-width":j,stroke:B,"stroke-dasharray":S.dashStyle(d.spikedash,j)}).classed("spikeline",!0).classed("crisp",!0),o.insert("line",":first-child").attr({x1:z,x2:z,y1:N,y2:V,"stroke-width":j+2,stroke:p}).classed("spikeline",!0).classed("crisp",!0)}-1!==M.indexOf("marker")&&o.insert("circle",":first-child").attr({cx:z,cy:F-("top"===d.side?-j:j),r:j,fill:B}).classed("spikeline",!0)}}}function u(e,t,a){if(!a||a.length!==e._hoverdata.length)return!0;for(var o=a.length-1;0<=o;o--){var r=a[o],n=e._hoverdata[o];if(r.curveNumber!==n.curveNumber||r.pointNumber+""!==n.pointNumber+""||r.pointNumbers+""!==n.pointNumbers+"")return!0}return!1}function g(e,t){return!t||!(t.vLinePoint===e._spikepoints.vLinePoint&&t.hLinePoint===e._spikepoints.hLinePoint)}function m(e,t){return T.plainText(e||"",{len:t,allowedTags:["br","sub","sup","b","i","em"]})}var b=e("d3"),i=e("fast-isnumeric"),v=e("tinycolor2"),w=e("../../lib"),k=e("../../lib/events"),T=e("../../lib/svg_text_utils"),A=e("../../lib/override_cursor"),S=e("../drawing"),C=e("../color"),L=e("../dragelement"),E=e("../../plots/cartesian/axes"),I=e("../../registry"),P=e("./helpers"),z=e("./constants"),D=e("../legend/defaults"),O=e("../legend/draw"),R=z.YANGLE,M=Math.PI*R/180,j=1/y(M),B=Math.cos(M),F=y(M),N=z.HOVERARROWSIZE,V=z.HOVERTEXTPAD;a.hover=function(e,t,a,r){e=w.getGraphDiv(e),w.throttle(e._fullLayout._uid+z.HOVERID,z.HOVERMINTIME,function(){o(e,t,a,r)})},a.loneHover=function(e,t){var a=!0;Array.isArray(e)||(a=!1,e=[e]);var o=e.map(function(e){return{color:e.color||C.defaultLine,x0:e.x0||e.x||0,x1:e.x1||e.x||0,y0:e.y0||e.y||0,y1:e.y1||e.y||0,xLabel:e.xLabel,yLabel:e.yLabel,zLabel:e.zLabel,text:e.text,name:e.name,idealAlign:e.idealAlign,borderColor:e.borderColor,fontFamily:e.fontFamily,fontSize:e.fontSize,fontColor:e.fontColor,nameLength:e.nameLength,textAlign:e.textAlign,trace:e.trace||{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0,hovertemplate:e.hovertemplate||!1,eventData:e.eventData||!1,hovertemplateLabels:e.hovertemplateLabels||!1}}),r=b.select(t.container),i=t.outerContainer?b.select(t.outerContainer):r,l={hovermode:"closest",rotateLabels:!1,bgColor:t.bgColor||C.background,container:r,outerContainer:i},s=n(o,l,t.gd),c=5,p=0,u=0;return s.sort(function(e,t){return e.y0-t.y0}).each(function(e,a){var o=e.y0-e.by/2;e.offset=o-c<p?p-o+c:0,p=o+e.by+e.offset,(a===t.anchorIndex||0)&&(u=e.offset)}).each(function(e){e.offset-=u}),d(s,l.rotateLabels),a?s:s.node()};var U=/<extra>([\s\S]*)<\/extra>/},{"../../lib":657,"../../lib/events":647,"../../lib/override_cursor":668,"../../lib/svg_text_utils":681,"../../plots/cartesian/axes":705,"../../registry":788,"../color":524,"../dragelement":543,"../drawing":546,"../legend/defaults":576,"../legend/draw":577,"./constants":558,"./helpers":560,d3:108,"fast-isnumeric":201,tinycolor2:1309}],562:[function(e,t){'use strict';var a=e("../../lib"),o=e("../color"),r=e("./helpers").isUnifiedHover;t.exports=function(e,t,i,n){function l(e){n.font[e]||(n.font[e]=t.legend?t.legend.font[e]:t.font[e])}n=n||{},t&&r(t.hovermode)&&(!n.font&&(n.font={}),l("size"),l("family"),l("color"),t.legend?(!n.bgcolor&&(n.bgcolor=o.combine(t.legend.bgcolor,t.paper_bgcolor)),!n.bordercolor&&(n.bordercolor=t.legend.bordercolor)):!n.bgcolor&&(n.bgcolor=t.paper_bgcolor)),i("hoverlabel.bgcolor",n.bgcolor),i("hoverlabel.bordercolor",n.bordercolor),i("hoverlabel.namelength",n.namelength),a.coerceFont(i,"hoverlabel.font",n.font),i("hoverlabel.align",n.align)}},{"../../lib":657,"../color":524,"./helpers":560}],563:[function(e,t){'use strict';function a(e,t){for(var a=t._scatterStackOpts||{},o=0;o<e.length;o++){var r=e[o],n=r.xaxis+r.yaxis,l=a[n]||{},s=l[r.stackgroup]||{};if("h"!==r.orientation&&"h"!==s.orientation)return!1}return!0}var o=e("../../lib"),r=e("./layout_attributes");t.exports=function(e,t,i){function n(a,i){return void 0===t[a]?o.coerce(e,t,r,a,i):t[a]}var l=n("clickmode"),s;return t._has("cartesian")?-1<l.indexOf("select")?s="closest":(t._isHoriz=a(i,t),s=t._isHoriz?"y":"x"):s="closest",n("hovermode",s)}},{"../../lib":657,"./layout_attributes":565}],564:[function(e,t){'use strict';var a=e("d3"),o=e("../../lib"),r=e("../dragelement"),i=e("./helpers"),n=e("./layout_attributes"),l=e("./hover");t.exports={moduleType:"component",name:"fx",constants:e("./constants"),schema:{layout:n},attributes:e("./attributes"),layoutAttributes:n,supplyLayoutGlobalDefaults:e("./layout_global_defaults"),supplyDefaults:e("./defaults"),supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc"),getDistanceFunction:i.getDistanceFunction,getClosest:i.getClosest,inbox:i.inbox,quadrature:i.quadrature,appendArrayPointValue:i.appendArrayPointValue,castHoverOption:function(e,t,a){return o.castOption(e,t,"hoverlabel."+a)},castHoverinfo:function(e,t,a){return o.castOption(e,a,"hoverinfo",function(a){return o.coerceHoverinfo({hoverinfo:a},{_module:e._module},t)})},hover:l.hover,unhover:r.unhover,loneHover:l.loneHover,loneUnhover:function(e){var t=o.isD3Selection(e)?e:a.select(e);t.selectAll("g.hovertext").remove(),t.selectAll(".spikeline").remove()},click:e("./click")}},{"../../lib":657,"../dragelement":543,"./attributes":555,"./calc":556,"./click":557,"./constants":558,"./defaults":559,"./helpers":560,"./hover":561,"./layout_attributes":565,"./layout_defaults":566,"./layout_global_defaults":567,d3:108}],565:[function(e,t){'use strict';var a=e("./constants"),o=e("../../plots/font_attributes")({editType:"none"});o.family.dflt=a.HOVERFONT,o.size.dflt=a.HOVERFONTSIZE,t.exports={clickmode:{valType:"flaglist",flags:["event","select"],dflt:"event",editType:"plot",extras:["none"]},dragmode:{valType:"enumerated",values:["zoom","pan","select","lasso","drawclosedpath","drawopenpath","drawline","drawrect","drawcircle","orbit","turntable",!1],dflt:"zoom",editType:"modebar"},hovermode:{valType:"enumerated",values:["x","y","closest",!1,"x unified","y unified"],editType:"modebar"},hoverdistance:{valType:"integer",min:-1,dflt:20,editType:"none"},spikedistance:{valType:"integer",min:-1,dflt:20,editType:"none"},hoverlabel:{bgcolor:{valType:"color",editType:"none"},bordercolor:{valType:"color",editType:"none"},font:o,align:{valType:"enumerated",values:["left","right","auto"],dflt:"auto",editType:"none"},namelength:{valType:"integer",min:-1,dflt:15,editType:"none"},editType:"none"},selectdirection:{valType:"enumerated",values:["h","v","d","any"],dflt:"any",editType:"none"}}},{"../../plots/font_attributes":733,"./constants":558}],566:[function(e,t){'use strict';var a=e("../../lib"),o=e("./helpers").isUnifiedHover,r=e("./layout_attributes"),i=e("./hovermode_defaults"),n=e("./hoverlabel_defaults");t.exports=function(e,t,l){function s(o,i){return a.coerce(e,t,r,o,i)}var d=i(e,t,l);d&&(s("hoverdistance"),s("spikedistance",o(d)?-1:void 0));var c=s("dragmode");"select"===c&&s("selectdirection");var p=t._has("mapbox"),u=t._has("geo"),g=t._basePlotModules.length;"zoom"===t.dragmode&&((p||u)&&1===g||p&&u&&2===g)&&(t.dragmode="pan"),n(e,t,s)}},{"../../lib":657,"./helpers":560,"./hoverlabel_defaults":562,"./hovermode_defaults":563,"./layout_attributes":565}],567:[function(e,t){'use strict';var a=e("../../lib"),o=e("./hoverlabel_defaults"),r=e("./layout_attributes");t.exports=function(e,t){o(e,t,function(o,i){return a.coerce(e,t,r,o,i)})}},{"../../lib":657,"./hoverlabel_defaults":562,"./layout_attributes":565}],568:[function(e,t){'use strict';function a(e,t,a){var o=t[a+"axes"],r=Object.keys((e._splomAxes||{})[a]||{});return Array.isArray(o)?o:r.length?r:void 0}function o(e,t,a,o,r,n){var l=t(e+"gap",a),s=t("domain."+e);t(e+"side",o);for(var d=Array(r),c=s[0],p=(s[1]-c)/(r-l),u=0,g;u<r;u++)g=c+p*u,d[n?r-1-u:u]=[g,g+p*(1-l)];return d}function r(e,t,a,o,r){function n(e,a){-1!==t.indexOf(a)&&o[a]===void 0?(l[e]=a,o[a]=e):l[e]=""}var l=Array(a),s;if(Array.isArray(e))for(s=0;s<a;s++)n(s,e[s]);else for(n(0,r),s=1;s<a;s++)n(s,r+(s+1));return l}var i=e("../../lib"),n=e("../../lib/regex").counter,l=e("../../plots/domain").attributes,s=e("../../plots/cartesian/constants").idRegex,d=e("../../plot_api/plot_template"),c={rows:{valType:"integer",min:1,editType:"plot"},roworder:{valType:"enumerated",values:["top to bottom","bottom to top"],dflt:"top to bottom",editType:"plot"},columns:{valType:"integer",min:1,editType:"plot"},subplots:{valType:"info_array",freeLength:!0,dimensions:2,items:{valType:"enumerated",values:[n("xy").toString(),""],editType:"plot"},editType:"plot"},xaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[s.x.toString(),""],editType:"plot"},editType:"plot"},yaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[s.y.toString(),""],editType:"plot"},editType:"plot"},pattern:{valType:"enumerated",values:["independent","coupled"],dflt:"coupled",editType:"plot"},xgap:{valType:"number",min:0,max:1,editType:"plot"},ygap:{valType:"number",min:0,max:1,editType:"plot"},domain:l({name:"grid",editType:"plot",noGridCell:!0},{}),xside:{valType:"enumerated",values:["bottom","bottom plot","top plot","top"],dflt:"bottom plot",editType:"plot"},yside:{valType:"enumerated",values:["left","left plot","right plot","right"],dflt:"left plot",editType:"plot"},editType:"plot"};t.exports={moduleType:"component",name:"grid",schema:{layout:{grid:c}},layoutAttributes:c,sizeDefaults:function(e,t){function r(e,t){return i.coerce(n,f,c,e,t)}var n=e.grid||{},l=a(t,n,"x"),s=a(t,n,"y");if(e.grid||l||s){var p=Array.isArray(n.subplots)&&Array.isArray(n.subplots[0]),u=Array.isArray(l),g=Array.isArray(s),m=u&&l!==n.xaxes&&g&&s!==n.yaxes,h,y;p?(h=n.subplots.length,y=n.subplots[0].length):(g&&(h=s.length),u&&(y=l.length));var f=d.newContainer(t,"grid"),x=r("rows",h),_=r("columns",y);if(!(1<x*_))return void delete t.grid;if(!p&&!u&&!g){var b="independent"===r("pattern");b&&(p=!0)}f._hasSubplotGrid=p;var v=r("roworder"),w=p?.2:.1,k=p?.3:.1,T,A;m&&t._splomGridDflt&&(T=t._splomGridDflt.xside,A=t._splomGridDflt.yside),f._domains={x:o("x",r,w,T,_),y:o("y",r,k,A,x,"top to bottom"===v)}}},contentDefaults:function(e,t){var o=t.grid;if(o&&o._domains){var n=e.grid||{},l=t._subplots,s=o._hasSubplotGrid,d=o.rows,c=o.columns,p="independent"===o.pattern,u=o._axisMap={},g,m,h,y,f,x,_;if(s){var b=n.subplots||[];x=o.subplots=Array(d);var v=1;for(g=0;g<d;g++){var w=x[g]=Array(c),k=b[g]||[];for(m=0;m<c;m++)if(p?(f=1===v?"xy":"x"+v+"y"+v,v++):f=k[m],w[m]="",-1!==l.cartesian.indexOf(f)){if(_=f.indexOf("y"),h=f.slice(0,_),y=f.slice(_),void 0!==u[h]&&u[h]!==m||void 0!==u[y]&&u[y]!==g)continue;w[m]=f,u[h]=m,u[y]=g}}}else{var T=a(t,n,"x"),A=a(t,n,"y");o.xaxes=r(T,l.xaxis,c,u,"x"),o.yaxes=r(A,l.yaxis,d,u,"y")}var S=o._anchors={},C="top to bottom"===o.roworder;for(var L in u){var E=L.charAt(0),I=o[E+"side"],P,z,D;if(8>I.length)S[L]="free";else if("x"===E){if("t"===I.charAt(0)===C?(P=0,z=1,D=d):(P=d-1,z=-1,D=-1),s){var O=u[L];for(g=P;g!==D;g+=z)if(f=x[g][O],f&&(_=f.indexOf("y"),f.slice(0,_)===L)){S[L]=f.slice(_);break}}else for(g=P;g!==D;g+=z)if(y=o.yaxes[g],-1!==l.cartesian.indexOf(L+y)){S[L]=y;break}}else if("l"===I.charAt(0)?(P=0,z=1,D=c):(P=c-1,z=-1,D=-1),s){var R=u[L];for(g=P;g!==D;g+=z)if(f=x[R][g],f&&(_=f.indexOf("y"),f.slice(_)===L)){S[L]=f.slice(0,_);break}}else for(g=P;g!==D;g+=z)if(h=o.xaxes[g],-1!==l.cartesian.indexOf(h+L)){S[L]=h;break}}}}}},{"../../lib":657,"../../lib/regex":673,"../../plot_api/plot_template":695,"../../plots/cartesian/constants":711,"../../plots/domain":732}],569:[function(e,t){'use strict';var a=e("../../plots/cartesian/constants"),o=e("../../plot_api/plot_template").templatedArray;t.exports=o("image",{visible:{valType:"boolean",dflt:!0,editType:"arraydraw"},source:{valType:"string",editType:"arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},sizex:{valType:"number",dflt:0,editType:"arraydraw"},sizey:{valType:"number",dflt:0,editType:"arraydraw"},sizing:{valType:"enumerated",values:["fill","contain","stretch"],dflt:"contain",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},x:{valType:"any",dflt:0,editType:"arraydraw"},y:{valType:"any",dflt:0,editType:"arraydraw"},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left",editType:"arraydraw"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"top",editType:"arraydraw"},xref:{valType:"enumerated",values:["paper",a.idRegex.x.toString()],dflt:"paper",editType:"arraydraw"},yref:{valType:"enumerated",values:["paper",a.idRegex.y.toString()],dflt:"paper",editType:"arraydraw"},editType:"arraydraw"})},{"../../plot_api/plot_template":695,"../../plots/cartesian/constants":711}],570:[function(e,t){'use strict';var a=Math.LN10,o=Math.log,r=Math.sqrt,i=Math.pow,n=e("fast-isnumeric"),l=e("../../lib/to_log_range");t.exports=function(e,t,s,d){t=t||{};var c="log"===s&&"linear"===t.type,p="linear"===s&&"log"===t.type;if(c||p)for(var u=e._fullLayout.images,g=t._id.charAt(0),m=0,h,y;m<u.length;m++)if(h=u[m],y="images["+m+"].",h[g+"ref"]===t._id){var f=h[g],x=h["size"+g],_=null,b=null;if(c){_=l(f,t.range);var v=x/i(10,_)/2;b=2*o(v+r(1+v*v))/a}else _=i(10,f),b=_*(i(10,x/2)-i(10,-x/2));n(_)?!n(b)&&(b=null):(_=null,b=null),d(y+g,_),d(y+"size"+g,b)}}},{"../../lib/to_log_range":683,"fast-isnumeric":201}],571:[function(e,t){'use strict';function a(e,t,a){function l(a,r){return o.coerce(e,t,n,a,r)}var s=l("source"),d=l("visible",!!s);if(!d)return t;l("layer"),l("xanchor"),l("yanchor"),l("sizex"),l("sizey"),l("sizing"),l("opacity");for(var c={_fullLayout:a},p=["x","y"],u=0;2>u;u++){var g=p[u],m=r.coerceRef(e,t,c,g,"paper");if("paper"!==m){var h=r.getFromId(c,m);h._imgIndices.push(t._index)}r.coercePosition(t,c,l,m,g,0)}return t}var o=e("../../lib"),r=e("../../plots/cartesian/axes"),i=e("../../plots/array_container_defaults"),n=e("./attributes");t.exports=function(e,t){i(e,t,{name:"images",handleItemDefaults:a})}},{"../../lib":657,"../../plots/array_container_defaults":701,"../../plots/cartesian/axes":705,"./attributes":569}],572:[function(e,t){'use strict';var a=Math.abs,o=e("d3"),r=e("../drawing"),i=e("../../plots/cartesian/axes"),n=e("../../constants/xmlns_namespaces");t.exports=function(e){function t(t){var a=o.select(this);if(this._imgSrc!==t.source)if(a.attr("xmlns",n.svg),t.source&&"data:"===t.source.slice(0,5))a.attr("xlink:href",t.source),this._imgSrc=t.source;else{var r=new Promise(function(e){function o(){a.remove(),e()}var r=new Image;this.img=r,r.setAttribute("crossOrigin","anonymous"),r.onerror=o,r.onload=function(){var t=document.createElement("canvas");t.width=this.width,t.height=this.height;var o=t.getContext("2d");o.drawImage(this,0,0);var r=t.toDataURL("image/png");a.attr("xlink:href",r),e()},a.on("error",o),r.src=t.source,this._imgSrc=t.source}.bind(this));e._promises.push(r)}}function l(t){var n=o.select(this),l=i.getFromId(e,t.xref),d=i.getFromId(e,t.yref),c=s._size,p=l?a(l.l2p(t.sizex)-l.l2p(0)):t.sizex*c.w,u=d?a(d.l2p(t.sizey)-d.l2p(0)):t.sizey*c.h,g=p*y.x[t.xanchor].offset,m=u*y.y[t.yanchor].offset,h=y.x[t.xanchor].sizing+y.y[t.yanchor].sizing,f=(l?l.r2p(t.x)+l._offset:t.x*c.w+c.l)+g,x=(d?d.r2p(t.y)+d._offset:c.h-t.y*c.h+c.t)+m;switch(t.sizing){case"fill":h+=" slice";break;case"stretch":h="none";}n.attr({x:f,y:x,width:p,height:u,preserveAspectRatio:h,opacity:t.opacity});var _=l?l._id:"",b=d?d._id:"",v=_+b;r.setClipUrl(n,v?"clip"+s._uid+v:null,e)}var s=e._fullLayout,d=[],c={},p=[],u,g;for(g=0;g<s.images.length;g++){var m=s.images[g];if(m.visible)if("below"===m.layer&&"paper"!==m.xref&&"paper"!==m.yref){u=m.xref+m.yref;var h=s._plots[u];if(!h){p.push(m);continue}h.mainplot&&(u=h.mainplot.id),c[u]||(c[u]=[]),c[u].push(m)}else"above"===m.layer?d.push(m):p.push(m)}var y={x:{left:{sizing:"xMin",offset:0},center:{sizing:"xMid",offset:-1/2},right:{sizing:"xMax",offset:-1}},y:{top:{sizing:"YMin",offset:0},middle:{sizing:"YMid",offset:-1/2},bottom:{sizing:"YMax",offset:-1}}},f=s._imageLowerLayer.selectAll("image").data(p),x=s._imageUpperLayer.selectAll("image").data(d);f.enter().append("image"),x.enter().append("image"),f.exit().remove(),x.exit().remove(),f.each(function(e){t.bind(this)(e),l.bind(this)(e)}),x.each(function(e){t.bind(this)(e),l.bind(this)(e)});var _=Object.keys(s._plots);for(g=0;g<_.length;g++){u=_[g];var b=s._plots[u];if(b.imagelayer){var v=b.imagelayer.selectAll("image").data(c[u]||[]);v.enter().append("image"),v.exit().remove(),v.each(function(e){t.bind(this)(e),l.bind(this)(e)})}}}},{"../../constants/xmlns_namespaces":634,"../../plots/cartesian/axes":705,"../drawing":546,d3:108}],573:[function(e,t){'use strict';t.exports={moduleType:"component",name:"images",layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),includeBasePlot:e("../../plots/cartesian/include_components")("images"),draw:e("./draw"),convertCoords:e("./convert_coords")}},{"../../plots/cartesian/include_components":717,"./attributes":569,"./convert_coords":570,"./defaults":571,"./draw":572}],574:[function(e,t){'use strict';var a=e("../../plots/font_attributes"),o=e("../color/attributes");t.exports={bgcolor:{valType:"color",editType:"legend"},bordercolor:{valType:"color",dflt:o.defaultLine,editType:"legend"},borderwidth:{valType:"number",min:0,dflt:0,editType:"legend"},font:a({editType:"legend"}),orientation:{valType:"enumerated",values:["v","h"],dflt:"v",editType:"legend"},traceorder:{valType:"flaglist",flags:["reversed","grouped"],extras:["normal"],editType:"legend"},tracegroupgap:{valType:"number",min:0,dflt:10,editType:"legend"},itemsizing:{valType:"enumerated",values:["trace","constant"],dflt:"trace",editType:"legend"},itemclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggle",editType:"legend"},itemdoubleclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggleothers",editType:"legend"},x:{valType:"number",min:-2,max:3,editType:"legend"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"legend"},y:{valType:"number",min:-2,max:3,editType:"legend"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],editType:"legend"},uirevision:{valType:"any",editType:"none"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"legend"},title:{text:{valType:"string",dflt:"",editType:"legend"},font:a({editType:"legend"}),side:{valType:"enumerated",values:["top","left","top left"],editType:"legend"},editType:"legend"},editType:"legend"}},{"../../plots/font_attributes":733,"../color/attributes":523}],575:[function(e,t){'use strict';t.exports={scrollBarWidth:6,scrollBarMinHeight:20,scrollBarColor:"#808BA4",scrollBarMargin:4,scrollBarEnterAttrs:{rx:20,ry:3,width:0,height:0},titlePad:2,textGap:40,itemGap:5}},{}],576:[function(e,t){'use strict';var a=e("../../registry"),o=e("../../lib"),r=e("../../plot_api/plot_template"),i=e("./attributes"),n=e("../../plots/layout_attributes"),l=e("./helpers");t.exports=function(e,t,s){function d(e,t){return o.coerce(c,f,i,e,t)}for(var c=e.legend||{},p=0,u=!1,g="normal",m=0,h;m<s.length;m++)h=s[m],h.visible&&((h.showlegend||h._dfltShowLegend&&!(h._module&&h._module.attributes&&h._module.attributes.showlegend&&!1===h._module.attributes.showlegend.dflt))&&(p++,h.showlegend&&(u=!0,(a.traceIs(h,"pie-like")||!0===h._input.showlegend)&&p++)),(a.traceIs(h,"bar")&&"stack"===t.barmode||-1!==["tonextx","tonexty"].indexOf(h.fill))&&(g=l.isGrouped({traceorder:g})?"grouped+reversed":"reversed"),void 0!==h.legendgroup&&""!==h.legendgroup&&(g=l.isReversed({traceorder:g})?"reversed+grouped":"grouped"));var y=o.coerce(e,t,n,"showlegend",u&&1<p);if(!1!==y||c.uirevision){var f=r.newContainer(t,"legend");if(d("uirevision",t.uirevision),!1!==y){d("bgcolor",t.paper_bgcolor),d("bordercolor"),d("borderwidth"),o.coerceFont(d,"font",t.font);var x=d("orientation"),_,b,v;"h"===x?(_=0,a.getComponentMethod("rangeslider","isVisible")(e.xaxis)?(b=1.1,v="bottom"):(b=-.1,v="top")):(_=1.02,b=1,v="auto"),d("traceorder",g),l.isGrouped(t.legend)&&d("tracegroupgap"),d("itemsizing"),d("itemclick"),d("itemdoubleclick"),d("x",_),d("xanchor"),d("y",b),d("yanchor",v),d("valign"),o.noneOrAll(c,f,["x","y"]);var w=d("title.text");w&&(d("title.side","h"===x?"left":"top"),o.coerceFont(d,"title.font",t.font))}}}},{"../../lib":657,"../../plot_api/plot_template":695,"../../plots/layout_attributes":759,"../../registry":788,"./attributes":574,"./helpers":580}],577:[function(e,t){'use strict';var g=Math.ceil,m=Math.min,y=Math.max;function a(e,t,a,o,r){var i=a.data()[0][0].trace,n={event:r,node:a.node(),curveNumber:i.index,expandedIndex:i._expandedIndex,data:e.data,layout:e.layout,frames:e._transitionData._frames,config:e._context,fullData:e._fullData,fullLayout:e._fullLayout};i._group&&(n.group=i._group),_.traceIs(i,"pie-like")&&(n.label=a.datum()[0].label);var l=b.triggerHandler(e,"plotly_legendclick",n);if(!1!==l)if(1===o)t._clickTimeout=setTimeout(function(){S(a,e,o)},e._context.doubleClickDelay);else if(2===o){t._clickTimeout&&clearTimeout(t._clickTimeout),e._legendMouseDownTime=0;var s=b.triggerHandler(e,"plotly_legenddoubleclick",n);!1!==s&&S(a,e,o)}}function o(e,t,a){var o=e.data()[0][0],i=o.trace,l=_.traceIs(i,"pie-like"),s=i.index,d=a._main&&t._context.edits.legendText&&!l,c=a._maxNameLength,p;a.entries?p=o.text:(p=l?o.label:i.name,i._meta&&(p=h.templateString(p,i._meta)));var u=h.ensureSingle(e,"text","legendtext");u.attr("text-anchor","start").classed("user-select-none",!0).call(k.font,a.font).text(d?r(p,c):p),A.positionText(u,C.textGap,0),d?u.call(A.makeEditable,{gd:t,text:p}).call(n,e,t,a).on("edit",function(i){this.text(r(i,c)).call(n,e,t,a);var l=o.trace._fullInput||{},d={};if(_.hasTransform(l,"groupby")){var p=_.getTransformIndices(l,"groupby"),u=p[p.length-1],g=h.keyedContainer(l,"transforms["+u+"].styles","target","value.name");g.set(o.trace._group,i),d=g.constructUpdate()}else d.name=i;return _.call("_guiRestyle",t,d,s)}):n(u,e,t,a)}function r(e,t){var a=y(4,t);if(e&&e.trim().length>=a/2)return e;e=e||"";for(var o=a-e.length;0<o;o--)e+=" ";return e}function i(e,t){var o=t._context.doubleClickDelay,r=1,i=h.ensureSingle(e,"rect","legendtoggle",function(e){e.style("cursor","pointer").attr("pointer-events","all").call(T.fill,"rgba(0,0,0,0)")}),n;i.on("mousedown",function(){n=new Date().getTime(),n-t._legendMouseDownTime<o?r+=1:(r=1,t._legendMouseDownTime=n)}),i.on("mouseup",function(){if(!(t._dragged||t._editing)){var i=t._fullLayout.legend;new Date().getTime()-t._legendMouseDownTime>o&&(r=y(r-1,1)),a(t,i,e,r,f.event)}})}function n(e,t,a,o){o._main||e.attr("data-notex",!0),A.convertToTspans(e,a,function(){l(t,a,o)})}function l(e,t,a){var o=e.data()[0][0];if(a._main&&o&&!o.trace.showlegend)return void e.remove();var r=e.select("g[class*=math-group]"),i=r.node();a||(a=t._fullLayout.legend);var n=a.borderwidth,l=(o?a:a.title).font.size*E,s,d;if(i){var c=k.bBox(i);s=c.height,d=c.width,o?k.setTranslate(r,0,.25*s):k.setTranslate(r,n,.75*s+n)}else{var p=e.select(o?".legendtext":".legendtitletext"),u=A.lineCount(p),g=p.node();s=l*u,d=g?k.bBox(g).width:0;o?A.positionText(p,C.textGap,-(l*((u-1)/2-.3))):A.positionText(p,C.titlePad+n,l+n)}o?(o.lineHeight=l,o.height=y(s,16)+3,o.width=d):(a._titleWidth=d,a._titleHeight=s)}function s(e){var t=0,a=0,o=e.title.side;return o&&(-1!==o.indexOf("left")&&(t=e._titleWidth),-1!==o.indexOf("top")&&(a=e._titleHeight)),[t,a]}function d(e,t,a,o){var r=e._fullLayout;o||(o=r.legend);var i=r._size,n=O.isVertical(o),l=O.isGrouped(o),c=o.borderwidth,d=2*c,x=C.textGap,_=C.itemGap,b=2*(c+_),v=u(o),w=0>o.y||0===o.y&&"top"===v,T=1<o.y||1===o.y&&"bottom"===v;o._maxHeight=y(w||T?r.height/2:i.h,30);var A=0;o._width=0,o._height=0;var S=s(o);if(n)a.each(function(e){var t=e[0].height;k.setTranslate(this,c+S[0],c+S[1]+o._height+t/2+_),o._height+=t,o._width=y(o._width,e[0].width)}),A=x+o._width,o._width+=_+x+d,o._height+=b,l&&(t.each(function(e,t){k.setTranslate(this,0,t*o.tracegroupgap)}),o._height+=(o._lgroupsLength-1)*o.tracegroupgap);else{var L=p(o),E=0>o.x||0===o.x&&"right"===L,I=1<o.x||1===o.x&&"left"===L,P=T||w,z=r.width/2;o._maxWidth=y(E?P&&"left"===L?i.l+i.w:z:I?P&&"right"===L?i.r+i.w:z:i.w,2*x);var D=0,R=0;a.each(function(e){var t=e[0].width+x;D=y(D,t),R+=t}),A=null;var M=0;if(l){var j=0,B=0,F=0;t.each(function(){var e=0,t=0;f.select(this).selectAll("g.traces").each(function(a){var o=a[0].height;k.setTranslate(this,S[0],S[1]+c+_+o/2+t),t+=o,e=y(e,x+a[0].width)}),j=y(j,t);var a=e+_;a+c+B>o._maxWidth&&(M=y(M,B),B=0,F+=j+o.tracegroupgap,j=t),k.setTranslate(this,B,F),B+=a}),o._width=y(M,B)+c,o._height=F+j+b}else{var N=a.size(),V=R+d+(N-1)*_<o._maxWidth,U=0,H=0,q=0,G=0;a.each(function(e){var t=e[0].height,a=x+e[0].width,r=(V?a:D)+_;r+c+H>o._maxWidth&&(M=y(M,G),H=0,q+=U,o._height+=U,U=0),k.setTranslate(this,S[0]+c+H,S[1]+c+q+t/2+_),G=H+a+_,H+=r,U=y(U,t)}),V?(o._width=H+d,o._height=U+b):(o._width=y(M,G)+d,o._height+=U+b)}}o._width=g(y(o._width+S[0],o._titleWidth+2*(c+C.titlePad))),o._height=g(y(o._height+S[1],o._titleHeight+2*(c+C.itemGap))),o._effHeight=m(o._height,o._maxHeight);var Y=e._context.edits,W=Y.legendText||Y.legendPosition;a.each(function(e){var t=f.select(this).select(".legendtoggle"),a=e[0].height,o=W?x:A||x+e[0].width;n||(o+=_/2),k.setRect(t,0,-a/2,o,a)})}function c(e){var t=e._fullLayout,a=t.legend,o=p(a),r=u(a);return x.autoMargin(e,"legend",{x:a.x,y:a.y,l:a._width*I[o],r:a._width*P[o],b:a._effHeight*P[r],t:a._effHeight*I[r]})}function p(e){return h.isRightAnchor(e)?"right":h.isCenterAnchor(e)?"center":"left"}function u(e){return h.isBottomAnchor(e)?"bottom":h.isMiddleAnchor(e)?"middle":"top"}var f=e("d3"),h=e("../../lib"),x=e("../../plots/plots"),_=e("../../registry"),b=e("../../lib/events"),v=e("../dragelement"),k=e("../drawing"),T=e("../color"),A=e("../../lib/svg_text_utils"),S=e("./handle_click"),C=e("./constants"),L=e("../../constants/alignment"),E=L.LINE_SPACING,I=L.FROM_TL,P=L.FROM_BR,z=e("./get_legend_data"),D=e("./style"),O=e("./helpers");t.exports=function(t,e){var r=t._fullLayout,l="legend"+r._uid,s;if(e?(s=e.layer,l+="-hover"):(e=r.legend||{},e._main=!0,s=r._infolayer),!!s){t._legendMouseDownTime||(t._legendMouseDownTime=0);var g;if(e._main){if(!t.calcdata)return;g=r.showlegend&&z(t.calcdata,e)}else{if(!e.entries)return;g=z(e.entries,e)}var b=r.hiddenlabels||[];if(e._main&&(!r.showlegend||!g.length))return s.selectAll(".legend").remove(),r._topdefs.select("#"+l).remove(),x.autoMargin(t,"legend");var w=h.ensureSingle(s,"g","legend",function(t){e._main&&t.attr("pointer-events","all")}),A=h.ensureSingleById(r._topdefs,"clipPath",l,function(e){e.append("rect")}),S=h.ensureSingle(w,"rect","bg",function(e){e.attr("shape-rendering","crispEdges")});S.call(T.stroke,e.bordercolor).call(T.fill,e.bgcolor).style("stroke-width",e.borderwidth+"px");var L=h.ensureSingle(w,"g","scrollbox"),E=e.title;if(e._titleWidth=0,e._titleHeight=0,E.text){var P=h.ensureSingle(L,"text","legendtitletext");P.attr("text-anchor","start").classed("user-select-none",!0).call(k.font,E.font).text(E.text),n(P,L,t,e)}var O=h.ensureSingle(w,"rect","scrollbar",function(e){e.attr(C.scrollBarEnterAttrs).call(T.fill,C.scrollBarColor)}),R=L.selectAll("g.groups").data(g);R.enter().append("g").attr("class","groups"),R.exit().remove();var M=R.selectAll("g.traces").data(h.identity);M.enter().append("g").attr("class","traces"),M.exit().remove(),M.style("opacity",function(e){var t=e[0].trace;return _.traceIs(t,"pie-like")?-1===b.indexOf(e[0].label)?1:.5:"legendonly"===t.visible?.5:1}).each(function(){f.select(this).call(o,t,e)}).call(D,t,e).each(function(){e._main&&f.select(this).call(i,t)}),h.syncOrAsync([x.previousPromises,function(){return d(t,R,M,e)},function(){function o(a,o,r){e._scrollY=t._fullLayout.legend._scrollY=a,k.setTranslate(L,0,-a),k.setRect(O,e._width,C.scrollBarMargin+a*r,C.scrollBarWidth,o),A.select("rect").attr("y",n+a)}if(!(e._main&&c(t))){var i=r._size,n=e.borderwidth,d=i.l+i.w*e.x-I[p(e)]*e._width,g=i.t+i.h*(1-e.y)-I[u(e)]*e._effHeight;if(e._main&&r.margin.autoexpand){var x=d,b=g;d=h.constrain(d,0,r.width-e._width),g=h.constrain(g,0,r.height-e._effHeight),d!==x&&h.log("Constrain legend.x to make legend fit inside graph"),g!==b&&h.log("Constrain legend.y to make legend fit inside graph")}if(e._main&&k.setTranslate(w,d,g),O.on(".drag",null),w.on("wheel",null),!e._main||e._height<=e._maxHeight||t._context.staticPlot){var T=e._effHeight;e._main||(T=e._height),S.attr({width:e._width-n,height:T-n,x:n/2,y:n/2}),k.setTranslate(L,0,0),A.select("rect").attr({width:e._width-2*n,height:T-2*n,x:n,y:n}),k.setClipUrl(L,l,t),k.setRect(O,0,0,0,0),delete e._scrollY}else{var E=y(C.scrollBarMinHeight,e._effHeight*e._effHeight/e._height),P=e._effHeight-E-2*C.scrollBarMargin,z=e._height-e._effHeight,D=P/z,R=m(e._scrollY||0,z);S.attr({width:e._width-2*n+C.scrollBarWidth+C.scrollBarMargin,height:e._effHeight-n,x:n/2,y:n/2}),A.select("rect").attr({width:e._width-2*n+C.scrollBarWidth+C.scrollBarMargin,height:e._effHeight-2*n,x:n,y:n+R}),k.setClipUrl(L,l,t),o(R,E,D),w.on("wheel",function(){R=h.constrain(e._scrollY+f.event.deltaY/P*z,0,z),o(R,E,D),0!==R&&R!==z&&f.event.preventDefault()});var M=function(e,t,a){return h.constrain((a-t)/D+e,0,z)},j=function(e,t,a){return h.constrain((t-a)/D+e,0,z)},B=f.behavior.drag().on("dragstart",function(){var t=f.event.sourceEvent;F="touchstart"===t.type?t.changedTouches[0].clientY:t.clientY,V=R}).on("drag",function(){var t=f.event.sourceEvent;2===t.buttons||t.ctrlKey||(N="touchmove"===t.type?t.changedTouches[0].clientY:t.clientY,R=M(V,F,N),o(R,E,D))}),F,N,V;O.call(B);var U=f.behavior.drag().on("dragstart",function(){var t=f.event.sourceEvent;"touchstart"===t.type&&(F=t.changedTouches[0].clientY,V=R)}).on("drag",function(){var t=f.event.sourceEvent;"touchmove"===t.type&&(N=t.changedTouches[0].clientY,R=j(V,F,N),o(R,E,D))});L.call(U)}if(t._context.edits.legendPosition){var H,q,G,Y;w.classed("cursor-move",!0),v.init({element:w.node(),gd:t,prepFn:function(){var e=k.getTranslate(w);G=e.x,Y=e.y},moveFn:function(t,a){var o=G+t,r=Y+a;k.setTranslate(w,o,r),H=v.align(o,0,i.l,i.l+i.w,e.xanchor),q=v.align(r,0,i.t+i.h,i.t,e.yanchor)},doneFn:function(){void 0!==H&&void 0!==q&&_.call("_guiRelayout",t,{"legend.x":H,"legend.y":q})},clickFn:function(o,r){var e=s.selectAll("g.traces").filter(function(){var e=this.getBoundingClientRect();return r.clientX>=e.left&&r.clientX<=e.right&&r.clientY>=e.top&&r.clientY<=e.bottom});0<e.size()&&a(t,w,e,o,r)}})}}}],t)}}},{"../../constants/alignment":626,"../../lib":657,"../../lib/events":647,"../../lib/svg_text_utils":681,"../../plots/plots":768,"../../registry":788,"../color":524,"../dragelement":543,"../drawing":546,"./constants":575,"./get_legend_data":578,"./handle_click":579,"./helpers":580,"./style":582,d3:108}],578:[function(e,t){'use strict';var a=Math.max,o=e("../../registry"),r=e("./helpers");t.exports=function(e,t){function n(e,a){if(""===e||!r.isGrouped(t)){var o="~~i"+p;s.push(o),l[o]=[[a]],p++}else-1===s.indexOf(e)?(s.push(e),d=!0,l[e]=[[a]]):l[e].push([a])}var l={},s=[],d=!1,c={},p=0,u=0,g=t._main,m,h;for(m=0;m<e.length;m++){var y=e[m],f=y[0],x=f.trace,_=x.legendgroup;if(!g||x.visible&&x.showlegend)if(o.traceIs(x,"pie-like"))for(c[_]||(c[_]={}),h=0;h<y.length;h++){var b=y[h].label;c[_][b]||(n(_,{label:b,color:y[h].color,i:y[h].i,trace:x,pts:y[h].pts}),c[_][b]=!0,u=a(u,(b||"").length))}else n(_,f),u=a(u,(x.name||"").length)}if(!s.length)return[];var v=s.length,w,k;if(d&&r.isGrouped(t))for(k=Array(v),m=0;m<v;m++)w=l[s[m]],k[m]=r.isReversed(t)?w.reverse():w;else{for(k=[Array(v)],m=0;m<v;m++)w=l[s[m]][0],k[0][r.isReversed(t)?v-m-1:m]=w;v=1}return t._lgroupsLength=v,t._maxNameLength=u,k}},{"../../registry":788,"./helpers":580}],579:[function(e,t){'use strict';var a=e("../../lib"),o=e("../../registry"),r=!0;t.exports=function(e,t,n){function l(e,t,a){var o=_.indexOf(e),r=x[t];return r||(r=x[t]=[]),-1===_.indexOf(e)&&(_.push(e),o=_.length-1),r[o]=a,o}function s(e,t){var r=e._fullInput;if(o.hasTransform(r,"groupby")){var i=b[r.index];if(!i){var n=o.getTransformIndices(r,"groupby"),s=n[n.length-1];i=a.keyedContainer(r,"transforms["+s+"].styles","target","value.visible"),b[r.index]=i}var d=i.get(e._group);void 0===d&&(d=!0),!1!==d&&i.set(e._group,t),v[r.index]=l(r.index,"visible",!1!==r.visible)}else{var c=!1!==r.visible&&t;l(r.index,"visible",c)}}var d=t._fullLayout;if(!(t._dragged||t._editing)){var c=d.legend.itemclick,p=d.legend.itemdoubleclick;1===n&&"toggle"===c&&"toggleothers"===p&&r&&t.data&&t._context.showTips?(a.notifier(a._(t,"Double-click on legend to isolate one trace"),"long"),r=!1):r=!1;var u;if(1===n?u=c:2==n&&(u=p),!!u){var g=d.hiddenlabels?d.hiddenlabels.slice():[],m=e.data()[0][0],h=t._fullData,y=m.trace,f=y.legendgroup,x={},_=[],b=[],v=[],w,k,T,A,S,C;if(o.traceIs(y,"pie-like")){var L=m.label,E=g.indexOf(L);"toggle"===u?-1===E?g.push(L):g.splice(E,1):"toggleothers"===u&&(g=[],t.calcdata[0].forEach(function(e){L!==e.label&&g.push(e.label)}),t._fullLayout.hiddenlabels&&t._fullLayout.hiddenlabels.length===g.length&&-1===E&&(g=[])),o.call("_guiRelayout",t,"hiddenlabels",g)}else{var I=f&&f.length,P=[],z;if(I)for(w=0;w<h.length;w++)z=h[w],z.visible&&z.legendgroup===f&&P.push(w);if("toggle"===u){var D;switch(y.visible){case!0:D="legendonly";break;case!1:D=!1;break;case"legendonly":D=!0;}if(I)for(w=0;w<h.length;w++)!1!==h[w].visible&&h[w].legendgroup===f&&s(h[w],D);else s(y,D)}else if("toggleothers"===u){var O=!0,R,M,B,F;for(w=0;w<h.length;w++)if(R=h[w]===y,B=!0!==h[w].showlegend,!(R||B)&&(M=I&&h[w].legendgroup===f,!M&&!0===h[w].visible&&!o.traceIs(h[w],"notLegendIsolatable"))){O=!1;break}for(w=0;w<h.length;w++)if(!1!==h[w].visible){if(o.traceIs(h[w],"notLegendIsolatable"))continue;switch(y.visible){case"legendonly":s(h[w],!0);break;case!0:F=!!O||"legendonly",R=h[w]===y,B=!0!==h[w].showlegend&&!h[w].legendgroup,M=R||I&&h[w].legendgroup===f,s(h[w],!!(M||B)||F);}}}for(w=0;w<b.length;w++)if(T=b[w],T){var N=T.constructUpdate(),V=Object.keys(N);for(k=0;k<V.length;k++)A=V[k],C=x[A]=x[A]||[],C[v[w]]=N[A]}for(S=Object.keys(x),w=0;w<S.length;w++)for(A=S[w],k=0;k<_.length;k++)x[A].hasOwnProperty(k)||(x[A][k]=void 0);o.call("_guiRestyle",t,x,_)}}}}},{"../../lib":657,"../../registry":788}],580:[function(e,t,a){'use strict';a.isGrouped=function(e){return-1!==(e.traceorder||"").indexOf("grouped")},a.isVertical=function(e){return"h"!==e.orientation},a.isReversed=function(e){return-1!==(e.traceorder||"").indexOf("reversed")}},{}],581:[function(e,t){'use strict';t.exports={moduleType:"component",name:"legend",layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),draw:e("./draw"),style:e("./style")}},{"./attributes":574,"./defaults":576,"./draw":577,"./style":582}],582:[function(e,t){'use strict';var o=Math.floor;function a(e,t){var a=t?"radial":"horizontal";return a+(e?"":"reversed")}var r=e("d3"),i=e("../../registry"),n=e("../../lib"),l=e("../drawing"),s=e("../color"),c=e("../colorscale/helpers").extractOpts,p=e("../../traces/scatter/subtypes"),u=e("../../traces/pie/style_one"),g=e("../../traces/pie/helpers").castOption,m=12,h=5,y=2,f=5;t.exports=function(e,t,x){function _(e,t,a){var o=e[0].trace,n=o.marker||{},l=n.line||{},d=a?o.visible&&o.type===a:i.traceIs(o,"bar"),c=r.select(t).select("g.legendpoints").selectAll("path.legend"+a).data(d?[e]:[]);c.enter().append("path").classed("legend"+a,!0).attr("d","M6,6H-6V-6H6Z").attr("transform","translate(20,0)"),c.exit().remove(),c.each(function(e){var t=r.select(this),a=e[0],o=k(a.mlw,n.line,f,y);t.style("stroke-width",o+"px").call(s.fill,a.mc||n.color),o&&s.stroke(t,a.mlc||l.color)})}function b(e,t,a){var o=e[0],l=o.trace,s=a?l.visible&&l.type===a:i.traceIs(l,a),d=r.select(t).select("g.legendpoints").selectAll("path.legend"+a).data(s?[e]:[]);if(d.enter().append("path").classed("legend"+a,!0).attr("d","M6,6H-6V-6H6Z").attr("transform","translate(20,0)"),d.exit().remove(),d.size()){var c=(l.marker||{}).line,p=k(g(c.width,o.pts),c,f,y),m=n.minExtend(l,{marker:{line:{width:p}}});m.marker.line.color=c.color;var h=n.minExtend(o,{trace:m});u(d,h,m)}}var v=t._fullLayout;x||(x=v.legend);var w="constant"===x.itemsizing,k=function(e,t,a,o){var r;if(e+1)r=e;else if(t&&0<t.width)r=t.width;else return 0;return w?o:Math.min(r,a)};e.each(function(e){var t=r.select(this),a=n.ensureSingle(t,"g","layers");a.style("opacity",e[0].trace.opacity);var o=x.valign,i=e[0].lineHeight,l=e[0].height;if("middle"===o||!i||!l)a.attr("transform",null);else{var s={top:1,bottom:-1}[o];a.attr("transform","translate(0,"+s*(.5*(i-l+3))+")")}var d=a.selectAll("g.legendfill").data([e]);d.enter().append("g").classed("legendfill",!0);var c=a.selectAll("g.legendlines").data([e]);c.enter().append("g").classed("legendlines",!0);var p=a.selectAll("g.legendsymbols").data([e]);p.enter().append("g").classed("legendsymbols",!0),p.selectAll("g.legendpoints").data([e]).enter().append("g").classed("legendpoints",!0)}).each(function(e){var d=e[0].trace,p=[],u;if(d.visible)switch(d.type){case"histogram2d":case"heatmap":p=[["M-15,-2V4H15V-2Z"]],u=!0;break;case"choropleth":case"choroplethmapbox":p=[["M-6,-6V6H6V-6Z"]],u=!0;break;case"densitymapbox":p=[["M-6,0 a6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"]],u="radial";break;case"cone":p=[["M-6,2 A2,2 0 0,0 -6,6 V6L6,4Z"],["M-6,-6 A2,2 0 0,0 -6,-2 L6,-4Z"],["M-6,-2 A2,2 0 0,0 -6,2 L6,0Z"]],u=!1;break;case"streamtube":p=[["M-6,2 A2,2 0 0,0 -6,6 H6 A2,2 0 0,1 6,2 Z"],["M-6,-6 A2,2 0 0,0 -6,-2 H6 A2,2 0 0,1 6,-6 Z"],["M-6,-2 A2,2 0 0,0 -6,2 H6 A2,2 0 0,1 6,-2 Z"]],u=!1;break;case"surface":p=[["M-6,-6 A2,3 0 0,0 -6,0 H6 A2,3 0 0,1 6,-6 Z"],["M-6,1 A2,3 0 0,1 -6,6 H6 A2,3 0 0,0 6,0 Z"]],u=!0;break;case"mesh3d":p=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],u=!1;break;case"volume":p=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],u=!0;break;case"isosurface":p=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6 A12,24 0 0,0 6,-6 L0,6Z"]],u=!1;}var g=r.select(this).select("g.legendpoints").selectAll("path.legend3dandfriends").data(p);g.enter().append("path").classed("legend3dandfriends",!0).attr("transform","translate(20,0)").style("stroke-miterlimit",1),g.exit().remove(),g.each(function(e,p){var i=r.select(this),g=c(d),m=g.colorscale,h=g.reversescale,y=function(e){if(e.size()){var o="legendfill-"+d.uid;l.gradient(e,t,o,a(h,"radial"===u),m,"fill")}},f;if(!m){var x=d.vertexcolor||d.facecolor||d.color;f=n.isArrayOrTypedArray(x)?x[p]||x[0]:x}else if(!u){var _=m.length;f=0===p?m[h?_-1:0][1]:1===p?m[h?0:_-1][1]:m[o((_-1)/2)][1]}i.attr("d",e[0]),f?i.call(s.fill,f):i.call(y)})}).each(function(e){var t=e[0].trace,a="waterfall"===t.type;if(e[0]._distinct&&a){var o=e[0].trace[e[0].dir].marker;return e[0].mc=o.color,e[0].mlw=o.line.width,e[0].mlc=o.line.color,_(e,this,"waterfall")}var i=[];t.visible&&a&&(i=e[0].hasTotals?[["increasing","M-6,-6V6H0Z"],["totals","M6,6H0L-6,-6H-0Z"],["decreasing","M6,6V-6H0Z"]]:[["increasing","M-6,-6V6H6Z"],["decreasing","M6,6V-6H-6Z"]]);var n=r.select(this).select("g.legendpoints").selectAll("path.legendwaterfall").data(i);n.enter().append("path").classed("legendwaterfall",!0).attr("transform","translate(20,0)").style("stroke-miterlimit",1),n.exit().remove(),n.each(function(e){var a=r.select(this),o=t[e[0]].marker,i=k(void 0,o.line,f,y);a.attr("d",e[1]).style("stroke-width",i+"px").call(s.fill,o.color),i&&a.call(s.stroke,o.line.color)})}).each(function(e){_(e,this,"funnel")}).each(function(e){_(e,this)}).each(function(e){var a=e[0].trace,o=r.select(this).select("g.legendpoints").selectAll("path.legendbox").data(a.visible&&i.traceIs(a,"box-violin")?[e]:[]);o.enter().append("path").classed("legendbox",!0).attr("d","M6,6H-6V-6H6Z").attr("transform","translate(20,0)"),o.exit().remove(),o.each(function(){var e=r.select(this);if(("all"===a.boxpoints||"all"===a.points)&&0===s.opacity(a.fillcolor)&&0===s.opacity((a.line||{}).color)){var i=n.minExtend(a,{marker:{size:w?m:n.constrain(a.marker.size,2,16),sizeref:1,sizemin:1,sizemode:"diameter"}});o.call(l.pointStyle,i,t)}else{var d=k(void 0,a.line,f,y);e.style("stroke-width",d+"px").call(s.fill,a.fillcolor),d&&s.stroke(e,a.line.color)}})}).each(function(e){b(e,this,"funnelarea")}).each(function(e){b(e,this,"pie")}).each(function(e){var o=e[0],i=o.trace,s=i.visible&&i.fill&&"none"!==i.fill,d=p.hasLines(i),u=i.contours,g=!1,m=!1,y=c(i),f=y.colorscale,x=y.reversescale,_,b;if(u){var v=u.coloring;"lines"===v?g=!0:d="none"===v||"heatmap"===v||u.showlines,"constraint"===u.type?s="="!==u._operation:("fill"===v||"heatmap"===v)&&(m=!0)}var w=p.hasMarkers(i)||p.hasText(i),T=s||m,A=d||g,S=w||!T?"M5,0":A?"M5,-2":"M5,-3",C=r.select(this),L=C.select(".legendfill").selectAll("path").data(s||m?[e]:[]);if(L.enter().append("path").classed("js-fill",!0),L.exit().remove(),L.attr("d",S+"h30v6h-30z").call(s?l.fillGroupStyle:function(e){if(e.size()){var o="legendfill-"+i.uid;l.gradient(e,t,o,a(x),f,"fill")}}),d||g){var E=k(void 0,i.line,10,h);b=n.minExtend(i,{line:{width:E}}),_=[n.minExtend(o,{trace:b})]}var I=C.select(".legendlines").selectAll("path").data(d||g?[_]:[]);I.enter().append("path").classed("js-line",!0),I.exit().remove(),I.attr("d",S+(g?"l30,0.0001":"h30")).call(d?l.lineGroupStyle:function(e){if(e.size()){var o="legendline-"+i.uid;l.lineGroupStyle(e),l.gradient(e,t,o,a(x),f,"stroke")}})}).each(function(e){function a(e,t,a,o){var r=n.nestedProperty(s,e).get(),i=n.isArrayOrTypedArray(r)&&t?t(r):r;if(w&&i&&void 0!==o&&(i=o),a){if(i<a[0])return a[0];if(i>a[1])return a[1]}return i}function o(e){return i._distinct&&i.index&&e[i.index]?e[i.index]:e[0]}var i=e[0],s=i.trace,d=p.hasMarkers(s),c=p.hasText(s),u=p.hasLines(s),g,f;if(d||c||u){var x={},_={};if(d){x.mc=a("marker.color",o),x.mx=a("marker.symbol",o),x.mo=a("marker.opacity",n.mean,[.2,1]),x.mlc=a("marker.line.color",o),x.mlw=a("marker.line.width",n.mean,[0,5],y),_.marker={sizeref:1,sizemin:1,sizemode:"diameter"};var b=a("marker.size",n.mean,[2,16],m);x.ms=b,_.marker.size=b}u&&(_.line={width:a("line.width",o,[0,10],h)}),c&&(x.tx="Aa",x.tp=a("textposition",o),x.ts=10,x.tc=a("textfont.color",o),x.tf=a("textfont.family",o)),g=[n.minExtend(i,x)],f=n.minExtend(s,_),f.selectedpoints=null,f.texttemplate=null}var v=r.select(this).select("g.legendpoints"),k=v.selectAll("path.scatterpts").data(d?g:[]);k.enter().insert("path",":first-child").classed("scatterpts",!0).attr("transform","translate(20,0)"),k.exit().remove(),k.call(l.pointStyle,f,t),d&&(g[0].mrc=3);var T=v.selectAll("g.pointtext").data(c?g:[]);T.enter().append("g").classed("pointtext",!0).append("text").attr("transform","translate(20,0)"),T.exit().remove(),T.selectAll("text").call(l.textPointStyle,f,t)}).each(function(e){var t=e[0].trace,a=r.select(this).select("g.legendpoints").selectAll("path.legendcandle").data(t.visible&&"candlestick"===t.type?[e,e]:[]);a.enter().append("path").classed("legendcandle",!0).attr("d",function(e,t){return t?"M-15,0H-8M-8,6V-6H8Z":"M15,0H8M8,-6V6H-8Z"}).attr("transform","translate(20,0)").style("stroke-miterlimit",1),a.exit().remove(),a.each(function(e,a){var o=r.select(this),i=t[a?"increasing":"decreasing"],n=k(void 0,i.line,f,y);o.style("stroke-width",n+"px").call(s.fill,i.fillcolor),n&&s.stroke(o,i.line.color)})}).each(function(e){var t=e[0].trace,a=r.select(this).select("g.legendpoints").selectAll("path.legendohlc").data(t.visible&&"ohlc"===t.type?[e,e]:[]);a.enter().append("path").classed("legendohlc",!0).attr("d",function(e,t){return t?"M-15,0H0M-8,-6V0":"M15,0H0M8,6V0"}).attr("transform","translate(20,0)").style("stroke-miterlimit",1),a.exit().remove(),a.each(function(e,a){var o=r.select(this),i=t[a?"increasing":"decreasing"],n=k(void 0,i.line,f,y);o.style("fill","none").call(l.dashLine,i.line.dash,n),n&&s.stroke(o,i.line.color)})})}},{"../../lib":657,"../../registry":788,"../../traces/pie/helpers":1041,"../../traces/pie/style_one":1047,"../../traces/scatter/subtypes":1086,"../color":524,"../colorscale/helpers":535,"../drawing":546,d3:108}],583:[function(e,t){'use strict';function a(e,t){var a=t.currentTarget,o=a.getAttribute("data-attr"),r=a.getAttribute("data-val")||!0,n=e._fullLayout,l={},s=m.list(e,null,!0),d=n._cartesianSpikesEnabled,c,p;if("zoom"===o){var g="in"===r?.5:2,h=(1+g)/2,y=(1-g)/2,f;for(p=0;p<s.length;p++)if(c=s[p],!c.fixedrange)if(f=c._name,"auto"===r)l[f+".autorange"]=!0;else if("reset"===r){if(void 0===c._rangeInitial)l[f+".autorange"]=!0;else{var x=c._rangeInitial.slice();l[f+".range[0]"]=x[0],l[f+".range[1]"]=x[1]}void 0!==c._showSpikeInitial&&(l[f+".showspikes"]=c._showSpikeInitial,"on"===d&&!c._showSpikeInitial&&(d="off"))}else{var _=[c.r2l(c.range[0]),c.r2l(c.range[1])],b=[h*_[0]+y*_[1],h*_[1]+y*_[0]];l[f+".range[0]"]=c.l2r(b[0]),l[f+".range[1]"]=c.l2r(b[1])}}else"hovermode"===o&&("x"===r||"y"===r)&&(r=n._isHoriz?"y":"x",a.setAttribute("data-val",r)),l[o]=r;n._cartesianSpikesEnabled=d,u.call("_guiRelayout",e,l)}function o(e,t){for(var a=t.currentTarget,o=a.getAttribute("data-attr"),r=a.getAttribute("data-val")||!0,n=e._fullLayout._subplots.gl3d||[],l={},s=o.split("."),d=0;d<n.length;d++)l[n[d]+"."+s[1]]=r;var c="pan"===r?r:"zoom";l.dragmode=c,u.call("_guiRelayout",e,l)}function r(e,t){for(var a=t.currentTarget,o=a.getAttribute("data-attr"),r=e._fullLayout,n=r._subplots.gl3d||[],l={},s=0;s<n.length;s++){var d=n[s],c=d+".camera",p=d+".aspectratio",g=r[d]._scene,m;"resetLastSave"===o?(l[c+".up"]=g.viewInitial.up,l[c+".eye"]=g.viewInitial.eye,l[c+".center"]=g.viewInitial.center,m=!0):"resetDefault"===o&&(l[c+".up"]=null,l[c+".eye"]=null,l[c+".center"]=null,m=!0),m&&(l[p+".x"]=g.viewInitial.aspectratio.x,l[p+".y"]=g.viewInitial.aspectratio.y,l[p+".z"]=g.viewInitial.aspectratio.z,l[d+".aspectmode"]=g.viewInitial.aspectmode)}u.call("_guiRelayout",e,l)}function i(e,t){var a=t.currentTarget,o=a._previousVal,r=e._fullLayout,n=r._subplots.gl3d||[],l=["xaxis","yaxis","zaxis"],s={},d={};if(o)d=o,a._previousVal=null;else{for(var c=0;c<n.length;c++){var p=n[c],u=r[p],g=p+".hovermode";s[g]=u.hovermode,d[g]=!1;for(var m=0;3>m;m++){var h=l[m],y=p+"."+h+".showspikes";d[y]=!1,s[y]=u[h].showspikes}}a._previousVal=s}return d}function n(e,t){for(var a=t.currentTarget,o=a.getAttribute("data-attr"),r=a.getAttribute("data-val")||!0,n=e._fullLayout,l=n._subplots.geo||[],s=0;s<l.length;s++){var d=l[s],c=n[d];if("zoom"===o){var g=c.projection.scale,m="in"===r?2*g:.5*g;u.call("_guiRelayout",e,d+".projection.scale",m)}}"reset"===o&&p(e,"geo")}function l(e){var t=e._fullLayout;return!t.hovermode&&(t._has("cartesian")?t._isHoriz?"y":"x":"closest")}function s(e){var t=l(e);u.call("_guiRelayout",e,"hovermode",t)}function d(e){for(var t=e._fullLayout,a="on"===t._cartesianSpikesEnabled,o=m.list(e,null,!0),r={},n=0,l;n<o.length;n++)l=o[n],r[l._name+".showspikes"]=!!a||l._showSpikeInitial;return r}function c(e,t){for(var a=t.currentTarget,o=a.getAttribute("data-val"),r=e._fullLayout,n=r._subplots.mapbox||[],l=1.05,s={},d=0;d<n.length;d++){var c=n[d],p=r[c].zoom,g="in"===o?l*p:p/l;s[c+".zoom"]=g}u.call("_guiRelayout",e,s)}function p(e,t){for(var a=e._fullLayout,o=a._subplots[t]||[],r={},n=0;n<o.length;n++)for(var l=o[n],s=a[l]._subplot,d=s.viewInitial,c=Object.keys(d),p=0,g;p<c.length;p++)g=c[p],r[l+"."+g]=d[g];u.call("_guiRelayout",e,r)}var u=e("../../registry"),g=e("../../plots/plots"),m=e("../../plots/cartesian/axis_ids"),h=e("../../fonts/ploticon"),y=e("../shapes/draw").eraseActiveShape,f=e("../../lib"),x=f._,_=t.exports={};_.toImage={name:"toImage",title:function(e){var t=e._context.toImageButtonOptions||{},a=t.format||"png";return"png"===a?x(e,"Download plot as a png"):x(e,"Download plot")},icon:h.camera,click:function(e){var t=e._context.toImageButtonOptions,a={format:t.format||"png"};f.notifier(x(e,"Taking snapshot - this may take a few seconds"),"long"),"svg"!==a.format&&f.isIE()&&(f.notifier(x(e,"IE only supports svg.  Changing format to svg."),"long"),a.format="svg"),["filename","width","height","scale"].forEach(function(e){e in t&&(a[e]=t[e])}),u.call("downloadImage",e,a).then(function(t){f.notifier(x(e,"Snapshot succeeded")+" - "+t,"long")}).catch(function(){f.notifier(x(e,"Sorry, there was a problem downloading your snapshot!"),"long")})}},_.sendDataToCloud={name:"sendDataToCloud",title:function(e){return x(e,"Edit in Chart Studio")},icon:h.disk,click:function(e){g.sendDataToCloud(e)}},_.editInChartStudio={name:"editInChartStudio",title:function(e){return x(e,"Edit in Chart Studio")},icon:h.pencil,click:function(e){g.sendDataToCloud(e)}},_.zoom2d={name:"zoom2d",title:function(e){return x(e,"Zoom")},attr:"dragmode",val:"zoom",icon:h.zoombox,click:a},_.pan2d={name:"pan2d",title:function(e){return x(e,"Pan")},attr:"dragmode",val:"pan",icon:h.pan,click:a},_.select2d={name:"select2d",title:function(e){return x(e,"Box Select")},attr:"dragmode",val:"select",icon:h.selectbox,click:a},_.lasso2d={name:"lasso2d",title:function(e){return x(e,"Lasso Select")},attr:"dragmode",val:"lasso",icon:h.lasso,click:a},_.drawclosedpath={name:"drawclosedpath",title:function(e){return x(e,"Draw closed freeform")},attr:"dragmode",val:"drawclosedpath",icon:h.drawclosedpath,click:a},_.drawopenpath={name:"drawopenpath",title:function(e){return x(e,"Draw open freeform")},attr:"dragmode",val:"drawopenpath",icon:h.drawopenpath,click:a},_.drawline={name:"drawline",title:function(e){return x(e,"Draw line")},attr:"dragmode",val:"drawline",icon:h.drawline,click:a},_.drawrect={name:"drawrect",title:function(e){return x(e,"Draw rectangle")},attr:"dragmode",val:"drawrect",icon:h.drawrect,click:a},_.drawcircle={name:"drawcircle",title:function(e){return x(e,"Draw circle")},attr:"dragmode",val:"drawcircle",icon:h.drawcircle,click:a},_.eraseshape={name:"eraseshape",title:function(e){return x(e,"Erase active shape")},icon:h.eraseshape,click:y},_.zoomIn2d={name:"zoomIn2d",title:function(e){return x(e,"Zoom in")},attr:"zoom",val:"in",icon:h.zoom_plus,click:a},_.zoomOut2d={name:"zoomOut2d",title:function(e){return x(e,"Zoom out")},attr:"zoom",val:"out",icon:h.zoom_minus,click:a},_.autoScale2d={name:"autoScale2d",title:function(e){return x(e,"Autoscale")},attr:"zoom",val:"auto",icon:h.autoscale,click:a},_.resetScale2d={name:"resetScale2d",title:function(e){return x(e,"Reset axes")},attr:"zoom",val:"reset",icon:h.home,click:a},_.hoverClosestCartesian={name:"hoverClosestCartesian",title:function(e){return x(e,"Show closest data on hover")},attr:"hovermode",val:"closest",icon:h.tooltip_basic,gravity:"ne",click:a},_.hoverCompareCartesian={name:"hoverCompareCartesian",title:function(e){return x(e,"Compare data on hover")},attr:"hovermode",val:function(e){return e._fullLayout._isHoriz?"y":"x"},icon:h.tooltip_compare,gravity:"ne",click:a},_.zoom3d={name:"zoom3d",title:function(e){return x(e,"Zoom")},attr:"scene.dragmode",val:"zoom",icon:h.zoombox,click:o},_.pan3d={name:"pan3d",title:function(e){return x(e,"Pan")},attr:"scene.dragmode",val:"pan",icon:h.pan,click:o},_.orbitRotation={name:"orbitRotation",title:function(e){return x(e,"Orbital rotation")},attr:"scene.dragmode",val:"orbit",icon:h["3d_rotate"],click:o},_.tableRotation={name:"tableRotation",title:function(e){return x(e,"Turntable rotation")},attr:"scene.dragmode",val:"turntable",icon:h["z-axis"],click:o},_.resetCameraDefault3d={name:"resetCameraDefault3d",title:function(e){return x(e,"Reset camera to default")},attr:"resetDefault",icon:h.home,click:r},_.resetCameraLastSave3d={name:"resetCameraLastSave3d",title:function(e){return x(e,"Reset camera to last save")},attr:"resetLastSave",icon:h.movie,click:r},_.hoverClosest3d={name:"hoverClosest3d",title:function(e){return x(e,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:h.tooltip_basic,gravity:"ne",click:function(e,t){var a=i(e,t);u.call("_guiRelayout",e,a)}},_.zoomInGeo={name:"zoomInGeo",title:function(e){return x(e,"Zoom in")},attr:"zoom",val:"in",icon:h.zoom_plus,click:n},_.zoomOutGeo={name:"zoomOutGeo",title:function(e){return x(e,"Zoom out")},attr:"zoom",val:"out",icon:h.zoom_minus,click:n},_.resetGeo={name:"resetGeo",title:function(e){return x(e,"Reset")},attr:"reset",val:null,icon:h.autoscale,click:n},_.hoverClosestGeo={name:"hoverClosestGeo",title:function(e){return x(e,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:h.tooltip_basic,gravity:"ne",click:s},_.hoverClosestGl2d={name:"hoverClosestGl2d",title:function(e){return x(e,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:h.tooltip_basic,gravity:"ne",click:s},_.hoverClosestPie={name:"hoverClosestPie",title:function(e){return x(e,"Toggle show closest data on hover")},attr:"hovermode",val:"closest",icon:h.tooltip_basic,gravity:"ne",click:s},_.resetViewSankey={name:"resetSankeyGroup",title:function(e){return x(e,"Reset view")},icon:h.home,click:function(e){for(var t={"node.groups":[],"node.x":[],"node.y":[]},a=0,o;a<e._fullData.length;a++)o=e._fullData[a]._viewInitial,t["node.groups"].push(o.node.groups.slice()),t["node.x"].push(o.node.x.slice()),t["node.y"].push(o.node.y.slice());u.call("restyle",e,t)}},_.toggleHover={name:"toggleHover",title:function(e){return x(e,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:h.tooltip_basic,gravity:"ne",click:function(e,t){var a=i(e,t);a.hovermode=l(e),u.call("_guiRelayout",e,a)}},_.resetViews={name:"resetViews",title:function(e){return x(e,"Reset views")},icon:h.home,click:function(e,t){var o=t.currentTarget;o.setAttribute("data-attr","zoom"),o.setAttribute("data-val","reset"),a(e,t),o.setAttribute("data-attr","resetLastSave"),r(e,t),p(e,"geo"),p(e,"mapbox")}},_.toggleSpikelines={name:"toggleSpikelines",title:function(e){return x(e,"Toggle Spike Lines")},icon:h.spikeline,attr:"_cartesianSpikesEnabled",val:"on",click:function(e){var t=e._fullLayout,a=t._cartesianSpikesEnabled;t._cartesianSpikesEnabled="on"===a?"off":"on",u.call("_guiRelayout",e,d(e))}},_.resetViewMapbox={name:"resetViewMapbox",title:function(e){return x(e,"Reset view")},attr:"reset",icon:h.home,click:function(e){p(e,"mapbox")}},_.zoomInMapbox={name:"zoomInMapbox",title:function(e){return x(e,"Zoom in")},attr:"zoom",val:"in",icon:h.zoom_plus,click:c},_.zoomOutMapbox={name:"zoomOutMapbox",title:function(e){return x(e,"Zoom out")},attr:"zoom",val:"out",icon:h.zoom_minus,click:c}},{"../../fonts/ploticon":637,"../../lib":657,"../../plots/cartesian/axis_ids":708,"../../plots/plots":768,"../../registry":788,"../shapes/draw":605}],584:[function(e,t,a){'use strict';a.manage=e("./manage")},{"./manage":585}],585:[function(e,t){'use strict';function a(e){function t(e){if(e.length){for(var t=[],a=0,o;a<e.length;a++)o=e[a],-1===c.indexOf(o)&&t.push(m[o]);L.push(t)}}var a=e._fullLayout,s=e._fullData,d=e._context,c=d.modeBarButtonsToRemove,p=d.modeBarButtonsToAdd,g=a._has("cartesian"),y=a._has("gl3d"),f=a._has("geo"),x=a._has("pie"),_=a._has("funnelarea"),v=a._has("gl2d"),w=a._has("ternary"),k=a._has("mapbox"),T=a._has("polar"),A=a._has("sankey"),S=o(a),C=u(a.hovermode),L=[],E=["toImage"];d.showEditInChartStudio?E.push("editInChartStudio"):d.showSendToCloud&&E.push("sendDataToCloud"),t(E);var I=[],P=[],z=[],D=[];if(1<(g||v||x||_||w)+f+y+k+T?(P=["toggleHover"],z=["resetViews"]):f?(I=["zoomInGeo","zoomOutGeo"],P=["hoverClosestGeo"],z=["resetGeo"]):y?(P=["hoverClosest3d"],z=["resetCameraDefault3d","resetCameraLastSave3d"]):k?(I=["zoomInMapbox","zoomOutMapbox"],P=["toggleHover"],z=["resetViewMapbox"]):v?P=["hoverClosestGl2d"]:x?P=["hoverClosestPie"]:A?(P=["hoverClosestCartesian","hoverCompareCartesian"],z=["resetViewSankey"]):P=["toggleHover"],g&&(P=["toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]),(n(s)||C)&&(P=[]),(g||v)&&!S&&(I=["zoomIn2d","zoomOut2d","autoScale2d"],"resetViews"!==z[0]&&(z=["resetScale2d"])),y?D=["zoom3d","pan3d","orbitRotation","tableRotation"]:(g||v)&&!S||w?D=["zoom2d","pan2d"]:k||f?D=["pan2d"]:T&&(D=["zoom2d"]),r(s)&&D.push("select2d","lasso2d"),Array.isArray(p)){for(var O=[],R=0,M;R<p.length;R++)M=p[R],"string"==typeof M?-1!==h.indexOf(M)&&(a._has("mapbox")||a._has("cartesian"))&&D.push(M):O.push(M);p=O}return t(D),t(I.concat(z)),t(P),l(L,p)}function o(e){for(var t=d.list({_fullLayout:e},null,!0),a=0;a<t.length;a++)if(!t[a].fixedrange)return!1;return!0}function r(e){for(var t=!1,a=0;a<e.length&&!t;a++){var o=e[a];!o._module||!o._module.selectPoints||(p.traceIs(o,"scatter-like")?(c.hasMarkers(o)||c.hasText(o))&&(t=!0):p.traceIs(o,"box-violin")?("all"===o.boxpoints||"all"===o.points)&&(t=!0):t=!0)}return t}function n(e){for(var t=0;t<e.length;t++)if(!p.traceIs(e[t],"noHover"))return!1;return!0}function l(e,t){if(t.length)if(Array.isArray(t[0]))for(var a=0;a<t.length;a++)e.push(t[a]);else e.push(t);return e}function s(e){for(var t=0,a;t<e.length;t++){a=e[t];for(var o=0,r;o<a.length;o++)if(r=a[o],"string"==typeof r)if(void 0!==m[r])e[t][o]=m[r];else throw new Error("*modeBarButtons* configuration options invalid button name")}return e}var d=e("../../plots/cartesian/axis_ids"),c=e("../../traces/scatter/subtypes"),p=e("../../registry"),u=e("../fx/helpers").isUnifiedHover,g=e("./modebar"),m=e("./buttons");t.exports=function(e){var t=e._fullLayout,o=e._context,r=t._modeBar;if(!o.displayModeBar&&!o.watermark)return void(r&&(r.destroy(),delete t._modeBar));if(!Array.isArray(o.modeBarButtonsToRemove))throw new Error("*modeBarButtonsToRemove* configuration options must be an array.");if(!Array.isArray(o.modeBarButtonsToAdd))throw new Error("*modeBarButtonsToAdd* configuration options must be an array.");var i=o.modeBarButtons,n;n=Array.isArray(i)&&i.length?s(i):!o.displayModeBar&&o.watermark?[]:a(e),r?r.update(e,n):t._modeBar=g(e,n)};var h=["drawline","drawopenpath","drawclosedpath","drawcircle","drawrect","eraseshape"]},{"../../plots/cartesian/axis_ids":708,"../../registry":788,"../../traces/scatter/subtypes":1086,"../fx/helpers":560,"./buttons":583,"./modebar":586}],586:[function(e,t){'use strict';function a(e){this.container=e.container,this.element=document.createElement("div"),this.update(e.graphInfo,e.buttons),this.container.appendChild(this.element)}var o=e("d3"),r=e("fast-isnumeric"),i=e("../../lib"),n=e("../../fonts/ploticon"),l=new DOMParser,s=a.prototype;s.update=function(e,t){this.graphInfo=e;var a=this.graphInfo._context,o=this.graphInfo._fullLayout,r="modebar-"+o._uid;this.element.setAttribute("id",r),this._uid=r,this.element.className="modebar","hover"===a.displayModeBar&&(this.element.className+=" modebar--hover ease-bg"),"v"===o.modebar.orientation&&(this.element.className+=" vertical",t=t.reverse());var n=o.modebar,l="hover"===a.displayModeBar?".js-plotly-plot .plotly:hover ":"";i.deleteRelatedStyleRule(r),i.addRelatedStyleRule(r,l+"#"+r+" .modebar-group","background-color: "+n.bgcolor),i.addRelatedStyleRule(r,"#"+r+" .modebar-btn .icon path","fill: "+n.color),i.addRelatedStyleRule(r,"#"+r+" .modebar-btn:hover .icon path","fill: "+n.activecolor),i.addRelatedStyleRule(r,"#"+r+" .modebar-btn.active .icon path","fill: "+n.activecolor);var s=!this.hasButtons(t),d=this.hasLogo!==a.displaylogo,c=this.locale!==a.locale;if(this.locale=a.locale,(s||d||c)&&(this.removeAllButtons(),this.updateButtons(t),a.watermark||a.displaylogo)){var p=this.getLogo();a.watermark&&(p.className+=" watermark"),"v"===o.modebar.orientation?this.element.insertBefore(p,this.element.childNodes[0]):this.element.appendChild(p),this.hasLogo=!0}this.updateActiveButton()},s.updateButtons=function(e){var t=this;this.buttons=e,this.buttonElements=[],this.buttonsNames=[],this.buttons.forEach(function(e){var a=t.createGroup();e.forEach(function(e){var o=e.name;if(!o)throw new Error("must provide button 'name' in button config");if(-1!==t.buttonsNames.indexOf(o))throw new Error("button name '"+o+"' is taken");t.buttonsNames.push(o);var r=t.createButton(e);t.buttonElements.push(r),a.appendChild(r)}),t.element.appendChild(a)})},s.createGroup=function(){var e=document.createElement("div");return e.className="modebar-group",e},s.createButton=function(e){var t=this,a=document.createElement("a");a.setAttribute("rel","tooltip"),a.className="modebar-btn";var r=e.title;void 0===r?r=e.name:"function"==typeof r&&(r=r(this.graphInfo)),(r||0===r)&&a.setAttribute("data-title",r),void 0!==e.attr&&a.setAttribute("data-attr",e.attr);var i=e.val;void 0!==i&&("function"==typeof i&&(i=i(this.graphInfo)),a.setAttribute("data-val",i));var l=e.click;if("function"!=typeof l)throw new Error("must provide button 'click' function in button config");else a.addEventListener("click",function(a){e.click(t.graphInfo,a),t.updateActiveButton(a.currentTarget)});a.setAttribute("data-toggle",e.toggle||!1),e.toggle&&o.select(a).classed("active",!0);var s=e.icon;return"function"==typeof s?a.appendChild(s()):a.appendChild(this.createIcon(s||n.question)),a.setAttribute("data-gravity",e.gravity||"n"),a},s.createIcon=function(e){var t=r(e.height)?+e.height:e.ascent-e.descent,a="http://www.w3.org/2000/svg",o;if(e.path){o=document.createElementNS(a,"svg"),o.setAttribute("viewBox",[0,0,e.width,t].join(" ")),o.setAttribute("class","icon");var i=document.createElementNS(a,"path");i.setAttribute("d",e.path),e.transform?i.setAttribute("transform",e.transform):void 0!==e.ascent&&i.setAttribute("transform","matrix(1 0 0 -1 0 "+e.ascent+")"),o.appendChild(i)}if(e.svg){var n=l.parseFromString(e.svg,"application/xml");o=n.childNodes[0]}return o.setAttribute("height","1em"),o.setAttribute("width","1em"),o},s.updateActiveButton=function(e){var t=this.graphInfo._fullLayout,a=e===void 0?null:e.getAttribute("data-attr");this.buttonElements.forEach(function(e){var r=e.getAttribute("data-val")||!0,n=e.getAttribute("data-attr"),l="true"===e.getAttribute("data-toggle"),s=o.select(e);if(l)n===a&&s.classed("active",!s.classed("active"));else{var d=null===n?n:i.nestedProperty(t,n).get();s.classed("active",d===r)}})},s.hasButtons=function(e){var t=this.buttons;if(!t)return!1;if(e.length!==t.length)return!1;for(var a=0;a<e.length;++a){if(e[a].length!==t[a].length)return!1;for(var o=0;o<e[a].length;o++)if(e[a][o].name!==t[a][o].name)return!1}return!0},s.getLogo=function(){var e=this.createGroup(),t=document.createElement("a");return t.href="https://plotly.com/",t.target="_blank",t.setAttribute("data-title",i._(this.graphInfo,"Produced with Plotly")),t.className="modebar-btn plotlyjsicon modebar-btn--logo",t.appendChild(this.createIcon(n.newplotlylogo)),e.appendChild(t),e},s.removeAllButtons=function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.hasLogo=!1},s.destroy=function(){i.removeElement(this.container.querySelector(".modebar")),i.deleteRelatedStyleRule(this._uid)},t.exports=function(e,t){var r=e._fullLayout,i=new a({graphInfo:e,container:r._modebardiv.node(),buttons:t});return r._privateplot&&o.select(i.element).append("span").classed("badge-private float--left",!0).text("PRIVATE"),i}},{"../../fonts/ploticon":637,"../../lib":657,d3:108,"fast-isnumeric":201}],587:[function(e,t){'use strict';var a=e("../../plots/font_attributes"),o=e("../color/attributes"),r=e("../../plot_api/plot_template").templatedArray,i=r("button",{visible:{valType:"boolean",dflt:!0,editType:"plot"},step:{valType:"enumerated",values:["month","year","day","hour","minute","second","all"],dflt:"month",editType:"plot"},stepmode:{valType:"enumerated",values:["backward","todate"],dflt:"backward",editType:"plot"},count:{valType:"number",min:0,dflt:1,editType:"plot"},label:{valType:"string",editType:"plot"},editType:"plot"});t.exports={visible:{valType:"boolean",editType:"plot"},buttons:i,x:{valType:"number",min:-2,max:3,editType:"plot"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"plot"},y:{valType:"number",min:-2,max:3,editType:"plot"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"bottom",editType:"plot"},font:a({editType:"plot"}),bgcolor:{valType:"color",dflt:o.lightLine,editType:"plot"},activecolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:o.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"}},{"../../plot_api/plot_template":695,"../../plots/font_attributes":733,"../color/attributes":523}],588:[function(e,t){'use strict';t.exports={yPad:.02,minButtonWidth:30,rx:3,ry:3,lightAmount:25,darkAmount:10}},{}],589:[function(e,t){'use strict';var r=Math.max;function a(e,t,a,o){function r(a,o){return i.coerce(e,t,d.buttons,a,o)}var n=o.calendar,l=r("visible");if(l){var s=r("step");"all"!==s&&(n&&"gregorian"!==n&&("month"===s||"year"===s)?t.stepmode="backward":r("stepmode"),r("count")),r("label")}}function o(e,t,a){for(var o=a.filter(function(a){return t[a].anchor===e._id}),n=0,l=0,s;l<o.length;l++)s=t[o[l]].domain,s&&(n=r(s[1],n));return[e.domain[0],n+c.yPad]}var i=e("../../lib"),n=e("../color"),l=e("../../plot_api/plot_template"),s=e("../../plots/array_container_defaults"),d=e("./attributes"),c=e("./constants");t.exports=function(e,t,r,p,u){function g(e,t){return i.coerce(m,h,d,e,t)}var m=e.rangeselector||{},h=l.newContainer(t,"rangeselector"),y=s(m,h,{name:"buttons",handleItemDefaults:a,calendar:u}),f=g("visible",0<y.length);if(f){var x=o(t,r,p);g("x",x[0]),g("y",x[1]),i.noneOrAll(e,t,["x","y"]),g("xanchor"),g("yanchor"),i.coerceFont(g,"font",r.font);var _=g("bgcolor");g("activecolor",n.contrast(_,c.lightAmount,c.darkAmount)),g("bordercolor"),g("borderwidth")}}},{"../../lib":657,"../../plot_api/plot_template":695,"../../plots/array_container_defaults":701,"../color":524,"./attributes":587,"./constants":588}],590:[function(e,t){'use strict';var p=Math.ceil,u=Math.round,g=Math.max;function a(e){for(var t=b.list(e,"x",!0),a=[],o=0,r;o<t.length;o++)r=t[o],r.rangeselector&&r.rangeselector.visible&&a.push(r);return a}function o(e){return e._id}function r(e,t,a){if("all"===t.step)return!0===e.autorange;var o=Object.keys(a);return e.range[0]===a[o[0]]&&e.range[1]===a[o[1]]}function i(e,t,a){var o=x.ensureSingle(e,"rect","selector-rect",function(e){e.attr("shape-rendering","crispEdges")});o.attr({rx:A.rx,ry:A.ry}),o.call(y.stroke,t.bordercolor).call(y.fill,n(t,a)).style("stroke-width",t.borderwidth+"px")}function n(e,t){return t._isActive||t._isHovered?e.activecolor:e.bgcolor}function l(e,t,a,o){var r=x.ensureSingle(e,"text","selector-text",function(e){e.classed("user-select-none",!0).attr("text-anchor","middle")});r.call(f.font,t.font).text(s(a,o._fullLayout._meta)).call(function(e){_.convertToTspans(e,o)})}function s(e,t){return e.label?t?x.templateString(e.label,t):e.label:"all"===e.step?"all":e.count+e.step.charAt(0)}function c(e,t,a,o,r){var i=0,n=0,l=a.borderwidth;t.each(function(){var e=m.select(this),t=e.select(".selector-text"),o=a.font.size*w,r=g(o*_.lineCount(t),16)+3;n=g(n,r)}),t.each(function(){var e=m.select(this),t=e.select(".selector-rect"),o=e.select(".selector-text"),r=o.node()&&f.bBox(o.node()).width,s=a.font.size*w,d=_.lineCount(o),c=g(r+10,A.minButtonWidth);e.attr("transform","translate("+(l+i)+","+l+")"),t.attr({x:0,y:0,width:c,height:n}),_.positionText(o,c/2,n/2-(d-1)*s/2+3),i+=c+5});var s=e._fullLayout._size,d=s.l+s.w*a.x,c=s.t+s.h*(1-a.y),y="left";x.isRightAnchor(a)&&(d-=i,y="right"),x.isCenterAnchor(a)&&(d-=i/2,y="center");var b="top";x.isBottomAnchor(a)&&(c-=n,b="bottom"),x.isMiddleAnchor(a)&&(c-=n/2,b="middle"),i=p(i),n=p(n),d=u(d),c=u(c),h.autoMargin(e,o+"-range-selector",{x:a.x,y:a.y,l:i*k[y],r:i*T[y],b:n*T[b],t:n*k[b]}),r.attr("transform","translate("+d+","+c+")")}var m=e("d3"),d=e("../../registry"),h=e("../../plots/plots"),y=e("../color"),f=e("../drawing"),x=e("../../lib"),_=e("../../lib/svg_text_utils"),b=e("../../plots/cartesian/axis_ids"),v=e("../../constants/alignment"),w=v.LINE_SPACING,k=v.FROM_TL,T=v.FROM_BR,A=e("./constants"),S=e("./get_update_object");t.exports=function(e){var t=e._fullLayout,n=t._infolayer.selectAll(".rangeselector").data(a(e),o);n.enter().append("g").classed("rangeselector",!0),n.exit().remove(),n.style({cursor:"pointer","pointer-events":"all"}),n.each(function(t){var a=m.select(this),o=t,n=o.rangeselector,s=a.selectAll("g.button").data(x.filterVisible(n.buttons));s.enter().append("g").classed("button",!0),s.exit().remove(),s.each(function(t){var a=m.select(this),s=S(o,t);t._isActive=r(o,t,s),a.call(i,n,t),a.call(l,n,t,e),a.on("click",function(){e._dragged||d.call("_guiRelayout",e,s)}),a.on("mouseover",function(){t._isHovered=!0,a.call(i,n,t)}),a.on("mouseout",function(){t._isHovered=!1,a.call(i,n,t)})}),c(e,s,n,o._name,a)})}},{"../../constants/alignment":626,"../../lib":657,"../../lib/svg_text_utils":681,"../../plots/cartesian/axis_ids":708,"../../plots/plots":768,"../../registry":788,"../color":524,"../drawing":546,"./constants":588,"./get_update_object":591,d3:108}],591:[function(e,t){'use strict';function a(e,t){var a=e.range,r=new Date(e.r2l(a[1])),i=t.step,n=t.count,l;switch(t.stepmode){case"backward":l=e.l2r(+o.time[i].utc.offset(r,-n));break;case"todate":var s=o.time[i].utc.offset(r,-n);l=e.l2r(+o.time[i].utc.ceil(s));}var d=a[1];return[l,d]}var o=e("d3");t.exports=function(e,t){var o=e._name,r={};if("all"===t.step)r[o+".autorange"]=!0;else{var i=a(e,t);r[o+".range[0]"]=i[0],r[o+".range[1]"]=i[1]}return r}},{d3:108}],592:[function(e,t){'use strict';t.exports={moduleType:"component",name:"rangeselector",schema:{subplots:{xaxis:{rangeselector:e("./attributes")}}},layoutAttributes:e("./attributes"),handleDefaults:e("./defaults"),draw:e("./draw")}},{"./attributes":587,"./defaults":589,"./draw":590}],593:[function(e,t){'use strict';var a=e("../color/attributes");t.exports={bgcolor:{valType:"color",dflt:a.background,editType:"plot"},bordercolor:{valType:"color",dflt:a.defaultLine,editType:"plot"},borderwidth:{valType:"integer",dflt:0,min:0,editType:"plot"},autorange:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},range:{valType:"info_array",items:[{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}}],editType:"calc",impliedEdits:{autorange:!1}},thickness:{valType:"number",dflt:.15,min:0,max:1,editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"}},{"../color/attributes":523}],594:[function(e,t){'use strict';var a=e("../../plots/cartesian/axis_ids").list,o=e("../../plots/cartesian/autorange").getAutoRange,r=e("./constants");t.exports=function(e){for(var t=a(e,"x",!0),n=0;n<t.length;n++){var l=t[n],s=l[r.name];s&&s.visible&&s.autorange&&(s._input.autorange=!0,s._input.range=s.range=o(e,l))}}},{"../../plots/cartesian/autorange":704,"../../plots/cartesian/axis_ids":708,"./constants":595}],595:[function(e,t){'use strict';t.exports={name:"rangeslider",containerClassName:"rangeslider-container",bgClassName:"rangeslider-bg",rangePlotClassName:"rangeslider-rangeplot",maskMinClassName:"rangeslider-mask-min",maskMaxClassName:"rangeslider-mask-max",slideBoxClassName:"rangeslider-slidebox",grabberMinClassName:"rangeslider-grabber-min",grabAreaMinClassName:"rangeslider-grabarea-min",handleMinClassName:"rangeslider-handle-min",grabberMaxClassName:"rangeslider-grabber-max",grabAreaMaxClassName:"rangeslider-grabarea-max",handleMaxClassName:"rangeslider-handle-max",maskMinOppAxisClassName:"rangeslider-mask-min-opp-axis",maskMaxOppAxisClassName:"rangeslider-mask-max-opp-axis",maskColor:"rgba(0,0,0,0.4)",maskOppAxisColor:"rgba(0,0,0,0.2)",slideBoxFill:"transparent",slideBoxCursor:"ew-resize",grabAreaFill:"transparent",grabAreaCursor:"col-resize",grabAreaWidth:10,handleWidth:4,handleRadius:1,handleStrokeWidth:1,extraPad:15}},{}],596:[function(e,t){'use strict';var a=e("../../lib"),o=e("../../plot_api/plot_template"),r=e("../../plots/cartesian/axis_ids"),i=e("./attributes"),n=e("./oppaxis_attributes");t.exports=function(e,t,l){function s(e,t){return a.coerce(u,g,i,e,t)}function d(e,t){return a.coerce(h,y,n,e,t)}var c=e[l],p=t[l];if(c.rangeslider||t._requestRangeslider[p._id]){a.isPlainObject(c.rangeslider)||(c.rangeslider={});var u=c.rangeslider,g=o.newContainer(p,"rangeslider"),m=s("visible"),h,y;if(m){s("bgcolor",t.plot_bgcolor),s("bordercolor"),s("borderwidth"),s("thickness"),s("autorange",!p.isValidRange(u.range)),s("range");var f=t._subplots;if(f)for(var x=f.cartesian.filter(function(e){return e.substr(0,e.indexOf("y"))===r.name2id(l)}).map(function(e){return e.substr(e.indexOf("y"),e.length)}),_=a.simpleMap(x,r.id2name),b=0,v;b<_.length;b++){v=_[b],h=u[v]||{},y=o.newContainer(g,v,"yaxis");var w=t[v],k;h.range&&w.isValidRange(h.range)&&(k="fixed");var T=d("rangemode",k);"match"!==T&&d("range",w.range.slice())}g._input=u}}}},{"../../lib":657,"../../plot_api/plot_template":695,"../../plots/cartesian/axis_ids":708,"./attributes":593,"./oppaxis_attributes":600}],597:[function(e,t){'use strict';var u=Math.round,g=Math.min,m=Math.max;function a(t,a,r,i){var n=t.select("rect."+C.slideBoxClassName).node(),l=t.select("rect."+C.grabAreaMinClassName).node(),s=t.select("rect."+C.grabAreaMaxClassName).node();t.on("mousedown",function(){function e(d){var e=+d.clientX-u,c,x,_;switch(p){case n:_="ew-resize",c=m+e,x=y+e;break;case l:_="col-resize",c=m+e,x=y;break;case s:_="col-resize",c=m,x=y+e;break;default:_="ew-resize",c=g,x=g+e;}if(x<c){var b=x;x=c,c=b}i._pixelMin=c,i._pixelMax=x,S(h.select(f),_),o(t,a,r,i)}function d(){f.removeEventListener("mousemove",e),f.removeEventListener("mouseup",d),_.removeElement(f)}var c=h.event,p=c.target,u=c.clientX,g=u-t.node().getBoundingClientRect().left,m=i.d2p(r._rl[0]),y=i.d2p(r._rl[1]),f=A.coverSlip();f.addEventListener("mousemove",e),f.addEventListener("mouseup",d)})}function o(e,t,a,o){function r(e){return a.l2r(_.constrain(e,o._rl[0],o._rl[1]))}var i=r(o.p2d(o._pixelMin)),n=r(o.p2d(o._pixelMax));window.requestAnimationFrame(function(){y.call("_guiRelayout",t,a._name+".range",[i,n])})}function r(e,t,a,o,r,i){function n(e){return _.constrain(e,0,o._width)}function l(e){return _.constrain(e,0,o._height)}function s(e){return _.constrain(e,-d,o._width+d)}var d=C.handleWidth/2,c=n(o.d2p(a._rl[0])),p=n(o.d2p(a._rl[1]));if(e.select("rect."+C.slideBoxClassName).attr("x",c).attr("width",p-c),e.select("rect."+C.maskMinClassName).attr("width",c),e.select("rect."+C.maskMaxClassName).attr("x",p).attr("width",o._width-p),"match"!==i.rangemode){var g=o._height-l(o.d2pOppAxis(r._rl[1])),m=o._height-l(o.d2pOppAxis(r._rl[0]));e.select("rect."+C.maskMinOppAxisClassName).attr("x",c).attr("height",g).attr("width",p-c),e.select("rect."+C.maskMaxOppAxisClassName).attr("x",c).attr("y",m).attr("height",o._height-m).attr("width",p-c),e.select("rect."+C.slideBoxClassName).attr("y",g).attr("height",m-g)}var h=.5,y=u(s(c-d))-h,f=u(s(p-d))+h;e.select("g."+C.grabberMinClassName).attr("transform","translate("+y+","+h+")"),e.select("g."+C.grabberMaxClassName).attr("transform","translate("+f+","+h+")")}function i(e,t,a,o){var r=_.ensureSingle(e,"rect",C.bgClassName,function(e){e.attr({x:0,y:0,"shape-rendering":"crispEdges"})}),i=0==o.borderwidth%2?o.borderwidth:o.borderwidth-1,n=-o._offsetShift,l=b.crispRound(t,o.borderwidth);r.attr({width:o._width+i,height:o._height+i,transform:"translate("+n+","+n+")",fill:o.bgcolor,stroke:o.bordercolor,"stroke-width":l})}function n(e,t,a,o){var r=t._fullLayout,i=_.ensureSingleById(r._topdefs,"clipPath",o._clipId,function(e){e.append("rect").attr({x:0,y:0})});i.select("rect").attr({width:o._width,height:o._height})}function l(e,t,a,o){var r=t.calcdata,i=e.selectAll("g."+C.rangePlotClassName).data(a._subplotsWith,_.identity);i.enter().append("g").attr("class",function(e){return C.rangePlotClassName+" "+e}).call(b.setClipUrl,o._clipId,t),i.order(),i.exit().remove();var n;i.each(function(e,l){var i=h.select(this),d=T.getFromId(t,e,"y"),c=d._name,p=o[c],u={data:[],layout:{xaxis:{type:a.type,domain:[0,1],range:o.range.slice(),calendar:a.calendar},width:o._width,height:o._height,margin:{t:0,b:0,l:0,r:0}},_context:t._context};a.rangebreaks&&(u.layout.xaxis.rangebreaks=a.rangebreaks),u.layout[c]={type:d.type,domain:[0,1],range:"match"===p.rangemode?d.range.slice():p.range.slice(),calendar:d.calendar},d.rangebreaks&&(u.layout[c].rangebreaks=d.rangebreaks),f.supplyDefaults(u);var g=u._fullLayout.xaxis,m=u._fullLayout[c];g.clearCalc(),g.setScale(),m.clearCalc(),m.setScale();var y={id:e,plotgroup:i,xaxis:g,yaxis:m,isRangePlot:!0};0===l?n=y:(y.mainplot="xy",y.mainplotinfo=n),k.rangePlot(t,y,s(r,e))})}function s(e,t){for(var a=[],o=0;o<e.length;o++){var r=e[o],n=r[0].trace;n.xaxis+n.yaxis===t&&a.push(r)}return a}function d(e,t,a,o,r){var i=_.ensureSingle(e,"rect",C.maskMinClassName,function(e){e.attr({x:0,y:0,"shape-rendering":"crispEdges"})});i.attr("height",o._height).call(v.fill,C.maskColor);var n=_.ensureSingle(e,"rect",C.maskMaxClassName,function(e){e.attr({y:0,"shape-rendering":"crispEdges"})});if(n.attr("height",o._height).call(v.fill,C.maskColor),"match"!==r.rangemode){var l=_.ensureSingle(e,"rect",C.maskMinOppAxisClassName,function(e){e.attr({y:0,"shape-rendering":"crispEdges"})});l.attr("width",o._width).call(v.fill,C.maskOppAxisColor);var s=_.ensureSingle(e,"rect",C.maskMaxOppAxisClassName,function(e){e.attr({y:0,"shape-rendering":"crispEdges"})});s.attr("width",o._width).style("border-top",C.maskOppBorder).call(v.fill,C.maskOppAxisColor)}}function c(e,t,a,o){if(!t._context.staticPlot){var r=_.ensureSingle(e,"rect",C.slideBoxClassName,function(e){e.attr({y:0,cursor:C.slideBoxCursor,"shape-rendering":"crispEdges"})});r.attr({height:o._height,fill:C.slideBoxFill})}}function p(e,t,a,o){var r=_.ensureSingle(e,"g",C.grabberMinClassName),i=_.ensureSingle(e,"g",C.grabberMaxClassName),n={x:0,width:C.handleWidth,rx:C.handleRadius,fill:v.background,stroke:v.defaultLine,"stroke-width":C.handleStrokeWidth,"shape-rendering":"crispEdges"},l={y:u(o._height/4),height:u(o._height/2)},s=_.ensureSingle(r,"rect",C.handleMinClassName,function(e){e.attr(n)});s.attr(l);var d=_.ensureSingle(i,"rect",C.handleMaxClassName,function(e){e.attr(n)});if(d.attr(l),!t._context.staticPlot){var c={width:C.grabAreaWidth,x:0,y:0,fill:C.grabAreaFill,cursor:C.grabAreaCursor},p=_.ensureSingle(r,"rect",C.grabAreaMinClassName,function(e){e.attr(c)});p.attr("height",o._height);var g=_.ensureSingle(i,"rect",C.grabAreaMaxClassName,function(e){e.attr(c)});g.attr("height",o._height)}}var h=e("d3"),y=e("../../registry"),f=e("../../plots/plots"),_=e("../../lib"),b=e("../drawing"),v=e("../color"),w=e("../titles"),k=e("../../plots/cartesian"),T=e("../../plots/cartesian/axis_ids"),A=e("../dragelement"),S=e("../../lib/setcursor"),C=e("./constants");t.exports=function(e){for(var t=e._fullLayout,o=t._rangeSliderData,s=0,y;s<o.length;s++)y=o[s][C.name],y._clipId=y._id+"-"+t._uid;var f=t._infolayer.selectAll("g."+C.containerClassName).data(o,function(e){return e._name});f.exit().each(function(e){var a=e[C.name];t._topdefs.select("#"+a._clipId).remove()}).remove();0===o.length||(f.enter().append("g").classed(C.containerClassName,!0).attr("pointer-events","all"),f.each(function(o){var s=h.select(this),f=o[C.name],b=t[T.id2name(o.anchor)],v=f[T.id2name(o.anchor)];if(f.range){var k=_.simpleMap(f.range,o.r2l),A=_.simpleMap(o.range,o.r2l),S;S=A[0]<A[1]?[g(k[0],A[0]),m(k[1],A[1])]:[m(k[0],A[0]),g(k[1],A[1])],f.range=f._input.range=_.simpleMap(S,o.l2r)}o.cleanRange("rangeslider.range");var L=t._size,E=o.domain;f._width=L.w*(E[1]-E[0]);var I=u(L.l+L.w*E[0]),x=u(L.t+L.h*(1-o._counterDomainMin)+("bottom"===o.side?o._depth:0)+f._offsetShift+C.extraPad);s.attr("transform","translate("+I+","+x+")"),f._rl=_.simpleMap(f.range,o.r2l);var y=f._rl[0],P=f._rl[1],z=P-y;if(f.p2d=function(e){return e/f._width*z+y},f.d2p=function(e){return(e-y)/z*f._width},o.rangebreaks){var D=o.locateBreaks(y,P);if(D.length){var O=0,R,M;for(R=0;R<D.length;R++)M=D[R],O+=M.max-M.min;var B=f._width/(P-y-O),F=[-B*y];for(R=0;R<D.length;R++)M=D[R],F.push(F[F.length-1]-B*(M.max-M.min));for(f.d2p=function(e){for(var t=F[0],a=0,o;a<D.length;a++)if(o=D[a],e>=o.max)t=F[a+1];else if(e<o.min)break;return t+B*e},R=0;R<D.length;R++)M=D[R],M.pmin=f.d2p(M.min),M.pmax=f.d2p(M.max);f.p2d=function(e){for(var t=F[0],a=0,o;a<D.length;a++)if(o=D[a],e>=o.pmax)t=F[a+1];else if(e<o.pmin)break;return(e-t)/B}}}if("match"!==v.rangemode){var N=b.r2l(v.range[0]),V=b.r2l(v.range[1]);f.d2pOppAxis=function(e){return(e-N)/(V-N)*f._height}}s.call(i,e,o,f).call(n,e,o,f).call(l,e,o,f).call(d,e,o,f,v).call(c,e,o,f).call(p,e,o,f),a(s,e,o,f),r(s,e,o,f,b,v),"bottom"===o.side&&w.draw(e,o._id+"title",{propContainer:o,propName:o._name+".title",placeholder:t._dfltTitle.x,attributes:{x:o._offset+o._length/2,y:x+f._height+f._offsetShift+10+1.5*o.title.font.size,"text-anchor":"middle"}})}))}},{"../../lib":657,"../../lib/setcursor":677,"../../plots/cartesian":718,"../../plots/cartesian/axis_ids":708,"../../plots/plots":768,"../../registry":788,"../color":524,"../dragelement":543,"../drawing":546,"../titles":619,"./constants":595,d3:108}],598:[function(e,t,a){'use strict';var r=Math.floor;function o(e){var t=e&&e[c];return t&&t.visible}var n=e("../../plots/cartesian/axis_ids"),l=e("../../lib/svg_text_utils"),s=e("./constants"),d=e("../../constants/alignment").LINE_SPACING,c=s.name;a.isVisible=o,a.makeData=function(e){var t=n.list({_fullLayout:e},"x",!0),a=e.margin,l=[];if(!e._has("gl2d"))for(var s=0,d;s<t.length;s++)if(d=t[s],o(d)){l.push(d);var p=d[c];p._id=c+d._id,p._height=(e.height-a.b-a.t)*p.thickness,p._offsetShift=r(p.borderwidth/2)}e._rangeSliderData=l},a.autoMarginOpts=function(e,t){var a=e._fullLayout,o=t[c],r=t._id.charAt(0),i=0,n=0;if("bottom"===t.side&&(i=t._depth,t.title.text!==a._dfltTitle[r])){n=1.5*t.title.font.size+10+o._offsetShift;var p=(t.title.text.match(l.BR_TAG_ALL)||[]).length;n+=p*t.title.font.size*d}return{x:0,y:t._counterDomainMin,l:0,r:0,t:0,b:o._height+i+Math.max(a.margin.b,n),pad:s.extraPad+2*o._offsetShift}}},{"../../constants/alignment":626,"../../lib/svg_text_utils":681,"../../plots/cartesian/axis_ids":708,"./constants":595}],599:[function(e,t){'use strict';var a=e("../../lib"),o=e("./attributes"),r=e("./oppaxis_attributes"),i=e("./helpers");t.exports={moduleType:"component",name:"rangeslider",schema:{subplots:{xaxis:{rangeslider:a.extendFlat({},o,{yaxis:r})}}},layoutAttributes:e("./attributes"),handleDefaults:e("./defaults"),calcAutorange:e("./calc_autorange"),draw:e("./draw"),isVisible:i.isVisible,makeData:i.makeData,autoMarginOpts:i.autoMarginOpts}},{"../../lib":657,"./attributes":593,"./calc_autorange":594,"./defaults":596,"./draw":597,"./helpers":598,"./oppaxis_attributes":600}],600:[function(e,t){'use strict';t.exports={_isSubplotObj:!0,rangemode:{valType:"enumerated",values:["auto","fixed","match"],dflt:"match",editType:"calc"},range:{valType:"info_array",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},editType:"calc"}},{}],601:[function(e,t){'use strict';var a=e("../annotations/attributes"),o=e("../../traces/scatter/attributes").line,r=e("../drawing/attributes").dash,i=e("../../lib/extend").extendFlat,n=e("../../plot_api/plot_template").templatedArray;t.exports=n("shape",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},type:{valType:"enumerated",values:["circle","rect","path","line"],editType:"calc+arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},xref:i({},a.xref,{}),xsizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},xanchor:{valType:"any",editType:"calc+arraydraw"},x0:{valType:"any",editType:"calc+arraydraw"},x1:{valType:"any",editType:"calc+arraydraw"},yref:i({},a.yref,{}),ysizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},yanchor:{valType:"any",editType:"calc+arraydraw"},y0:{valType:"any",editType:"calc+arraydraw"},y1:{valType:"any",editType:"calc+arraydraw"},path:{valType:"string",editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},line:{color:i({},o.color,{editType:"arraydraw"}),width:i({},o.width,{editType:"calc+arraydraw"}),dash:i({},r,{editType:"arraydraw"}),editType:"calc+arraydraw"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"arraydraw"},editable:{valType:"boolean",dflt:!1,editType:"calc+arraydraw"},editType:"arraydraw"})},{"../../lib/extend":648,"../../plot_api/plot_template":695,"../../traces/scatter/attributes":1062,"../annotations/attributes":507,"../drawing/attributes":545}],602:[function(e,t){'use strict';function a(e){return r(e.line.width,e.xsizemode,e.x0,e.x1,e.path,!1)}function o(e){return r(e.line.width,e.ysizemode,e.y0,e.y1,e.path,!0)}function r(e,t,a,o,r,i){var l=e/2,c=i;if("pixel"===t){var p=r?d.extractPathCoords(r,i?s.paramIsY:s.paramIsX):[a,o],u=n.aggNums(Math.max,null,p),g=n.aggNums(Math.min,null,p),m=0>g?Math.abs(g)+l:l,h=0<u?u+l:l;return{ppad:l,ppadplus:c?m:h,ppadminus:c?h:m}}return{ppad:l}}function i(e,t,a,o,r){var n="category"===e.type||"multicategory"===e.type?e.r2c:e.d2c;if(t!==void 0)return[n(t),n(a)];if(o){var l=1/0,c=-Infinity,p=o.match(s.segmentRE),u,g,m,h,y;for("date"===e.type&&(n=d.decodeDate(n)),u=0;u<p.length;u++)g=p[u],m=r[g.charAt(0)].drawn,void 0===m||(h=p[u].substr(1).match(s.paramRE),h&&!(h.length<m)&&(y=n(h[m]),y<l&&(l=y),y>c&&(c=y)));if(c>=l)return[l,c]}}var n=e("../../lib"),l=e("../../plots/cartesian/axes"),s=e("./constants"),d=e("./helpers");t.exports=function(e){var t=e._fullLayout,r=n.filterVisible(t.shapes);if(r.length&&e._fullData.length)for(var d=0,c;d<r.length;d++){c=r[d],c._extremes={};var p,u;if("paper"!==c.xref){var g="pixel"===c.xsizemode?c.xanchor:c.x0,m="pixel"===c.xsizemode?c.xanchor:c.x1;p=l.getFromId(e,c.xref),u=i(p,g,m,c.path,s.paramIsX),u&&(c._extremes[p._id]=l.findExtremes(p,u,a(c)))}if("paper"!==c.yref){var h="pixel"===c.ysizemode?c.yanchor:c.y0,y="pixel"===c.ysizemode?c.yanchor:c.y1;p=l.getFromId(e,c.yref),u=i(p,h,y,c.path,s.paramIsY),u&&(c._extremes[p._id]=l.findExtremes(p,u,o(c)))}}}},{"../../lib":657,"../../plots/cartesian/axes":705,"./constants":603,"./helpers":612}],603:[function(e,t){'use strict';t.exports={segmentRE:/[MLHVQCTSZ][^MLHVQCTSZ]*/g,paramRE:/[^\s,]+/g,paramIsX:{M:{0:!0,drawn:0},L:{0:!0,drawn:0},H:{0:!0,drawn:0},V:{},Q:{0:!0,2:!0,drawn:2},C:{0:!0,2:!0,4:!0,drawn:4},T:{0:!0,drawn:0},S:{0:!0,2:!0,drawn:2},Z:{}},paramIsY:{M:{1:!0,drawn:1},L:{1:!0,drawn:1},H:{},V:{0:!0,drawn:0},Q:{1:!0,3:!0,drawn:3},C:{1:!0,3:!0,5:!0,drawn:5},T:{1:!0,drawn:1},S:{1:!0,3:!0,drawn:5},Z:{}},numParams:{M:2,L:2,H:1,V:1,Q:4,C:6,T:2,S:4,Z:0}}},{}],604:[function(e,t){'use strict';function a(e,t,a){function s(a,r){return o.coerce(e,t,n,a,r)}var d=s("visible");if(d){var c=s("path"),p=c?"path":"rect",u=s("type",p);"path"!==t.type&&delete t.path,s("editable"),s("layer"),s("opacity"),s("fillcolor"),s("fillrule");var g=s("line.width");g&&(s("line.color"),s("line.dash"));for(var m=s("xsizemode"),h=s("ysizemode"),y=["x","y"],f=0;2>f;f++){var x=y[f],_=x+"anchor",b="x"===x?m:h,v={_fullLayout:a},w=r.coerceRef(e,t,v,x,"","paper"),k,T,A;if("paper"===w?T=A=o.identity:(k=r.getFromId(v,w),k._shapeIndices.push(t._index),A=l.rangeToShapePosition(k),T=l.shapePositionToRange(k)),"path"!==u){var S=x+"0",C=x+"1",L=e[S],E=e[C];e[S]=T(e[S],!0),e[C]=T(e[C],!0),"pixel"===b?(s(S,0),s(C,10)):(r.coercePosition(t,v,s,w,S,.25),r.coercePosition(t,v,s,w,C,.75)),t[S]=A(t[S]),t[C]=A(t[C]),e[S]=L,e[C]=E}if("pixel"===b){var I=e[_];e[_]=T(e[_],!0),r.coercePosition(t,v,s,w,_,.25),t[_]=A(t[_]),e[_]=I}}"path"===u?s("path"):o.noneOrAll(e,t,["x0","x1","y0","y1"])}}var o=e("../../lib"),r=e("../../plots/cartesian/axes"),i=e("../../plots/array_container_defaults"),n=e("./attributes"),l=e("./helpers");t.exports=function(e,t){i(e,t,{name:"shapes",handleItemDefaults:a})}},{"../../lib":657,"../../plots/array_container_defaults":701,"../../plots/cartesian/axes":705,"./attributes":601,"./helpers":612}],605:[function(e,t){'use strict';var h=Math.abs,y=Math.max;function a(e){var t=e._fullLayout;for(var a in t._shapeUpperLayer.selectAll("path").remove(),t._shapeLowerLayer.selectAll("path").remove(),t._plots){var o=t._plots[a].shapelayer;o&&o.selectAll("path").remove()}for(var r=0;r<t.shapes.length;r++)t.shapes[r].visible&&n(e,r)}function o(e){return!!e._fullLayout._drawing}function r(e){return!e._context.edits.shapePosition}function n(e,t){function a(a){var i=c(e,o),d={"data-index":t,"fill-rule":o.fillrule,d:i},p=o.opacity,u=o.fillcolor,m=o.line.width?o.line.color:"rgba(0,0,0,0)",h=o.line.width,y=o.line.dash,f="Z"!==i[i.length-1],x=r(e)&&o.editable&&e._fullLayout._activeShapeIndex===t;x&&(u=f?"rgba(0,0,0,0)":e._fullLayout.activeshape.fillcolor,p=e._fullLayout.activeshape.opacity);var _=a.append("path").attr(d).style("opacity",p).call(k.stroke,m).call(k.fill,u).call(T.dashLine,y,h);l(_,e,o);var w;if((x||e._context.edits.shapePosition)&&(w=A(e.layout,"shapes",o)),x){_.style({cursor:"move"});var S={element:_.node(),plotinfo:n,gd:e,editHelpers:w,isActiveShape:!0},C=b(i,e);v(C,_,S)}else e._context.edits.shapePosition&&s(e,_,o,t,a,w),_.style("pointer-events",!r(e)||2>h||!f&&.5<k.opacity(u)*p?"all":"stroke");_.node().addEventListener("click",function(){return g(e,_)})}e._fullLayout._paperdiv.selectAll(".shapelayer [data-index=\""+t+"\"]").remove();var i=E.makeOptionsAndPlotinfo(e,t),o=i.options,n=i.plotinfo;if(o._input&&!1!==o.visible)if("below"!==o.layer)a(e._fullLayout._shapeUpperLayer);else if("paper"===o.xref||"paper"===o.yref)a(e._fullLayout._shapeLowerLayer);else if(n._hadPlotinfo){var d=n.mainplotinfo||n;a(d.shapelayer)}else a(e._fullLayout._shapeLowerLayer)}function l(e,t,a){var o=(a.xref+a.yref).replace(/paper/g,"");T.setClipUrl(e,o?"clip"+t._fullLayout._uid+o:null,t)}function s(e,t,a,r,i,n){function s(){var e=y(a.line.width,10),o=i.append("g").attr("data-index",r);o.append("path").attr("d",t.attr("d")).style({cursor:"move","stroke-width":e,"stroke-opacity":"0"});var n={"fill-opacity":"0"},l=y(e/2,10);return o.append("circle").attr({"data-line-point":"start-point",cx:w?O(a.xanchor)+a.x0:O(a.x0),cy:k?R(a.yanchor)-a.y0:R(a.y0),r:l}).style(n).classed("cursor-grab",!0),o.append("circle").attr({"data-line-point":"end-point",cx:w?O(a.xanchor)+a.x1:O(a.x1),cy:k?R(a.yanchor)-a.y1:R(a.y1),r:l}).style(n).classed("cursor-grab",!0),o}function d(a){if(o(e))return void(te=null);if(A)te="path"===a.target.tagName?"move":"start-point"===a.target.attributes["data-line-point"].value?"resize-over-start-point":"resize-over-end-point";else{var r=F.element.getBoundingClientRect(),i=r.right-r.left,n=r.bottom-r.top,l=a.clientX-r.left,s=a.clientY-r.top,d=!I&&10<i&&10<n&&!a.shiftKey?S.getCursor(l/i,1-s/n):"move";C(t,d),te=d.split("-")[0]}}function p(r){o(e)||(w&&(q=O(a.xanchor)),k&&(G=R(a.yanchor)),"path"===a.type?ee=a.path:(N=w?a.x0:O(a.x0),V=k?a.y0:R(a.y0),U=w?a.x1:O(a.x1),H=k?a.y1:R(a.y1)),N<U?(X=N,J="x0",Z=U,Q="x1"):(X=U,J="x1",Z=N,Q="x0"),!k&&V<H||k&&V>H?(Y=V,K="y0",W=H,$="y1"):(Y=H,K="y1",W=V,$="y0"),d(r),h(i,a),v(t,a,e),F.moveFn="move"===te?g:m,F.altKey=r.altKey)}function g(o,r){if("path"===a.type){var n=function(e){return e},l=n,s=n;w?P("xanchor",a.xanchor=M(q+o)):(l=function(e){return M(O(e)+o)},z&&"date"===z.type&&(l=E.encodeDate(l))),k?P("yanchor",a.yanchor=j(G+r)):(s=function(e){return j(R(e)+r)},D&&"date"===D.type&&(s=E.encodeDate(s))),P("path",a.path=u(ee,l,s))}else w?P("xanchor",a.xanchor=M(q+o)):(P("x0",a.x0=M(N+o)),P("x1",a.x1=M(U+o))),k?P("yanchor",a.yanchor=j(G+r)):(P("y0",a.y0=j(V+r)),P("y1",a.y1=j(H+r)));t.attr("d",c(e,a)),h(i,a)}function m(o,r){if(I){var n=function(e){return e},l=n,s=n;w?P("xanchor",a.xanchor=M(q+o)):(l=function(e){return M(O(e)+o)},z&&"date"===z.type&&(l=E.encodeDate(l))),k?P("yanchor",a.yanchor=j(G+r)):(s=function(e){return j(R(e)+r)},D&&"date"===D.type&&(s=E.encodeDate(s))),P("path",a.path=u(ee,l,s))}else if(!A){var d=function(e){return-1!==te.indexOf(e)},p=d("n"),g=d("s"),m=d("w"),y=d("e"),f=p?Y+r:Y,x=g?W+r:W,_=m?X+o:X,b=y?Z+o:Z;k&&(p&&(f=Y-r),g&&(x=W-r)),(!k&&x-f>10||k&&f-x>10)&&(P(K,a[K]=k?f:j(f)),P($,a[$]=k?x:j(x))),b-_>10&&(P(J,a[J]=w?_:M(_)),P(Q,a[Q]=w?b:M(b)))}else if("resize-over-start-point"===te){var v=N+o,T=k?V-r:V+r;P("x0",a.x0=w?v:M(v)),P("y0",a.y0=k?T:j(T))}else if("resize-over-end-point"===te){var S=U+o,C=k?H-r:H+r;P("x1",a.x1=w?S:M(S)),P("y1",a.y1=k?C:j(C))}t.attr("d",c(e,a)),h(i,a)}function h(e,t){(w||k)&&function(){var a="path"!==t.type,o=e.selectAll(".visual-cue").data([0]),r=1;o.enter().append("path").attr({fill:"#fff","fill-rule":"evenodd",stroke:"#000","stroke-width":r}).classed("visual-cue",!0);var i=O(w?t.xanchor:x.midRange(a?[t.x0,t.x1]:E.extractPathCoords(t.path,L.paramIsX))),n=R(k?t.yanchor:x.midRange(a?[t.y0,t.y1]:E.extractPathCoords(t.path,L.paramIsY)));if(i=E.roundPositionForSharpStrokeRendering(i,r),n=E.roundPositionForSharpStrokeRendering(n,r),w&&k){var l="M"+(i-1-r)+","+(n-1-r)+"h-8v2h8 v8h2v-8 h8v-2h-8 v-8h-2 Z";o.attr("d",l)}else if(w){var s="M"+(i-1-r)+","+(n-9-r)+"v18 h2 v-18 Z";o.attr("d",s)}else{var d="M"+(i-9-r)+","+(n-1-r)+"h18 v2 h-18 Z";o.attr("d",d)}}()}function b(e){e.selectAll(".visual-cue").remove()}function v(e,t,a){var o=t.xref,r=t.yref,i=_.getFromId(a,o),n=_.getFromId(a,r),l="";"paper"===o||i.autorange||(l+=o),"paper"===r||n.autorange||(l+=r),T.setClipUrl(e,l?"clip"+a._fullLayout._uid+l:null,a)}var w="pixel"===a.xsizemode,k="pixel"===a.ysizemode,A="line"===a.type,I="path"===a.type,P=n.modifyItem,z=_.getFromId(e,a.xref),D=_.getFromId(e,a.yref),O=E.getDataToPixel(e,z),R=E.getDataToPixel(e,D,!0),M=E.getPixelToData(e,z),j=E.getPixelToData(e,D,!0),B=function(){return A?s():t}(),F={element:B.node(),gd:e,prepFn:p,doneFn:function(){o(e)||(C(t),b(i),l(t,e,a),f.call("_guiRelayout",e,n.getUpdateObj()))},clickFn:function(){o(e)||b(i)}},N,V,U,H,q,G,Y,W,X,Z,K,$,J,Q,ee,te;S.init(F),B.node().onmousemove=d}function c(e,t){var a=t.type,o=_.getFromId(e,t.xref),r=_.getFromId(e,t.yref),i=e._fullLayout._size,n,l,s,d,c,u,g,m;if(o?(n=E.shapePositionToRange(o),l=function(e){return o._offset+o.r2p(n(e,!0))}):l=function(e){return i.l+i.w*e},r?(s=E.shapePositionToRange(r),d=function(e){return r._offset+r.r2p(s(e,!0))}):d=function(e){return i.t+i.h*(1-e)},"path"===a)return o&&"date"===o.type&&(l=E.decodeDate(l)),r&&"date"===r.type&&(d=E.decodeDate(d)),p(t,l,d);if("pixel"===t.xsizemode){var y=l(t.xanchor);c=y+t.x0,u=y+t.x1}else c=l(t.x0),u=l(t.x1);if("pixel"===t.ysizemode){var f=d(t.yanchor);g=f-t.y0,m=f-t.y1}else g=d(t.y0),m=d(t.y1);if("line"===a)return"M"+c+","+g+"L"+u+","+m;if("rect"===a)return"M"+c+","+g+"H"+u+"V"+m+"H"+c+"Z";var x=(c+u)/2,b=(g+m)/2,v=h(x-c),w=h(b-g),k="A"+v+","+w,T=x+v+","+b;return"M"+T+k+" 0 1,1 "+(x+","+(b-w))+k+" 0 0,1 "+T+"Z"}function p(e,t,a){var o=e.path,r=e.xsizemode,i=e.ysizemode,n=e.xanchor,l=e.yanchor;return o.replace(L.segmentRE,function(e){var o=0,s=e.charAt(0),d=L.paramIsX[s],c=L.paramIsY[s],p=L.numParams[s],u=e.substr(1).replace(L.paramRE,function(e){return d[o]?"pixel"===r?e=t(n)+ +e:e=t(e):c[o]&&("pixel"===i?e=a(l)-+e:e=a(e)),o++,o>p&&(e="X"),e});return o>p&&(u=u.replace(/[\s,]*X.*/,""),x.log("Ignoring extra params in segment "+e)),s+u})}function u(e,t,a){return e.replace(L.segmentRE,function(e){var o=0,r=e.charAt(0),i=L.paramIsX[r],n=L.paramIsY[r],l=L.numParams[r],s=e.substr(1).replace(L.paramRE,function(e){return o>=l?e:(i[o]?e=t(e):n[o]&&(e=a(e)),o++,e)});return r+s})}function g(e,t){if(r(e)){var o=t.node(),i=+o.getAttribute("data-index");if(0<=i){if(i===e._fullLayout._activeShapeIndex)return void m(e);e._fullLayout._activeShapeIndex=i,e._fullLayout._deactivateShape=m,a(e)}}}function m(e){if(r(e)){var t=e._fullLayout._activeShapeIndex;0<=t&&(w(e),delete e._fullLayout._activeShapeIndex,a(e))}}var f=e("../../registry"),x=e("../../lib"),_=e("../../plots/cartesian/axes"),b=e("./draw_newshape/helpers").readPaths,v=e("./draw_newshape/display_outlines"),w=e("../../plots/cartesian/handle_outline").clearOutlineControllers,k=e("../color"),T=e("../drawing"),A=e("../../plot_api/plot_template").arrayEditor,S=e("../dragelement"),C=e("../../lib/setcursor"),L=e("./constants"),E=e("./helpers");t.exports={draw:a,drawOne:n,eraseActiveShape:function(e){if(r(e)){w(e);var t=e._fullLayout._activeShapeIndex,a=(e.layout||{}).shapes||[];if(t<a.length){for(var o=[],i=0;i<a.length;i++)i!==t&&o.push(a[i]);delete e._fullLayout._activeShapeIndex,f.call("_guiRelayout",e,{shapes:o})}}}}},{"../../lib":657,"../../lib/setcursor":677,"../../plot_api/plot_template":695,"../../plots/cartesian/axes":705,"../../plots/cartesian/handle_outline":715,"../../registry":788,"../color":524,"../dragelement":543,"../drawing":546,"./constants":603,"./draw_newshape/display_outlines":609,"./draw_newshape/helpers":610,"./helpers":612}],606:[function(e,t){'use strict';var a=e("../../drawing/attributes").dash,o=e("../../../lib/extend").extendFlat;t.exports={newshape:{line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:0,dflt:4,editType:"none"},dash:o({},a,{dflt:"solid",editType:"none"}),editType:"none"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"none"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"none"},drawdirection:{valType:"enumerated",values:["ortho","horizontal","vertical","diagonal"],dflt:"diagonal",editType:"none"},editType:"none"},activeshape:{fillcolor:{valType:"color",dflt:"rgb(255,0,255)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":648,"../../drawing/attributes":545}],607:[function(e,t){'use strict';var a=Math.PI;t.exports={CIRCLE_SIDES:32,i000:0,i090:8,i180:16,i270:24,cos45:Math.cos(a/4),sin45:Math.sin(a/4),SQRT2:Math.sqrt(2)}},{}],608:[function(e,t){'use strict';var a=e("../../color");t.exports=function(e,t,o){o("newshape.drawdirection"),o("newshape.layer"),o("newshape.fillcolor"),o("newshape.fillrule"),o("newshape.opacity");var r=o("newshape.line.width");if(r){var i=(e||{}).plot_bgcolor||"#FFF";o("newshape.line.color",a.contrast(i)),o("newshape.line.dash")}o("activeshape.fillcolor"),o("activeshape.opacity")}},{"../../color":524}],609:[function(e,t){'use strict';function a(e,t){for(var a=0,o;a<t.length;a++){o=t[a],e[a]=[];for(var r=0;r<o.length;r++){e[a][r]=[];for(var n=0;n<o[r].length;n++)e[a][r][n]=o[r][n]}}return e}var o=e("../../dragelement"),r=e("../../dragelement/helpers"),i=r.drawMode,n=e("../../../registry"),l=e("./constants"),s=l.i000,d=l.i090,c=l.i180,p=l.i270,u=e("../../../plots/cartesian/handle_outline"),m=u.clearOutlineControllers,h=e("./helpers"),f=h.pointsShapeRectangle,_=h.pointsShapeEllipse,b=h.writePaths,v=e("./newshapes");t.exports=function e(t,r,l,u){function h(){e(t,r,l,u++),_(t[0])&&y({redrawing:!0})}function y(e){l.isActiveShape=!1;var t=v(r,l);Object.keys(t).length&&n.call((e||{}).redrawing?"relayout":"_guiRelayout",D,t)}function w(e){N=+e.srcElement.getAttribute("data-i"),V=+e.srcElement.getAttribute("data-j"),B[N][V].moveFn=k}function k(e,a){if(t.length){var o=U[N][V][1],r=U[N][V][2],i=t[N],n=i.length;if(f(i)){for(var l=0;l<n;l++)if(l!==V){var s=i[l];s[1]===i[V][1]&&(s[1]=o+e),s[2]===i[V][2]&&(s[2]=r+a)}if(i[V][1]=o+e,i[V][2]=r+a,!f(i))for(var d=0;d<n;d++)for(var c=0;c<i[d].length;c++)i[d][c]=U[N][d][c]}else i[V][1]=o+e,i[V][2]=r+a;h()}}function T(){y()}function A(){if(t.length&&t[N]&&t[N].length){for(var e=[],a=0;a<t[N].length;a++)a!==V&&e.push(t[N][a]);1<e.length&&(2!==e.length||"Z"!==e[1][0])&&(0===V&&(e[0][0]="M"),t[N]=e,h(),y())}}function S(e,a){if(2===e){N=+a.srcElement.getAttribute("data-i"),V=+a.srcElement.getAttribute("data-j");var o=t[N];f(o)||_(o)||A()}}function C(e){B=[];for(var a=0;a<t.length;a++){var r=t[a],n=f(r),l=!n&&_(r);B[a]=[];for(var u=0;u<r.length;u++)if("Z"!==r[u][0]){if(l&&u!==s&&u!==d&&u!==c&&u!==p)continue;var g=r[u][1],m=r[u][2],h=e.append("circle").classed("cursor-grab",!0).attr("data-i",a).attr("data-j",u).attr("cx",g).attr("cy",m).attr("r",4).style({"mix-blend-mode":"luminosity",fill:"black",stroke:"white","stroke-width":1});B[a][u]={element:h.node(),gd:D,prepFn:w,doneFn:T,clickFn:S},o.init(B[a][u])}}}function L(e,a){if(t.length)for(var o=0;o<t.length;o++)for(var r=0;r<t[o].length;r++)for(var n=0;n+2<t[o][r].length;n+=2)t[o][r][n+1]=U[o][r][n+1]+e,t[o][r][n+2]=U[o][r][n+2]+a}function E(e,t){L(e,t),h()}function I(e){N=+e.srcElement.getAttribute("data-i"),N||(N=0),F[N].moveFn=E}function P(){y()}function z(){if(F=[],!!t.length){F[0]={element:r[0][0],gd:D,prepFn:I,doneFn:P},o.init(F[0])}}u||(u=0);var D=l.gd,x=l.isActiveShape,O=D._fullLayout,R=O._zoomlayer,M=l.dragmode,j=i(M);j?D._fullLayout._drawing=!0:0<=D._fullLayout._activeShapeIndex&&m(D),r.attr("d",b(t));var B,F,N,V,U;if(x&&!u){U=a([],t);var H=R.append("g").attr("class","outline-controllers");C(H),z()}}},{"../../../plots/cartesian/handle_outline":715,"../../../registry":788,"../../dragelement":543,"../../dragelement/helpers":542,"./constants":607,"./helpers":610,"./newshapes":611}],610:[function(e,t,a){'use strict';var n=Math.cos,l=Math.PI,s=Math.sin;function o(e,t){return 1e-6>=Math.abs(e-t)}function r(e,t){var a=t[1]-e[1],o=t[2]-e[2];return Math.sqrt(a*a+o*o)}var d=e("parse-svg-path"),c=e("./constants"),p=c.CIRCLE_SIDES,u=c.SQRT2,g=e("../../../plots/cartesian/helpers"),m=g.p2r,h=g.r2p,y=[0,3,4,5,6,1,2],f=[0,3,4,1,2];a.writePaths=function(e){var t=e.length;if(!t)return"M0,0Z";for(var a="",o=0,r;o<t;o++){r=e[o].length;for(var n=0,l;n<r;n++)if(l=e[o][n][0],"Z"===l)a+="Z";else for(var s=e[o][n].length,d=0,c;d<s;d++)c=d,"Q"===l||"S"===l?c=f[d]:"C"===l&&(c=y[d]),a+=e[o][n][c],0<d&&d<s-1&&(a+=",")}return a},a.readPaths=function(e,a,o,r){var u=d(e),g=[],f=-1,_=function(){f++,g[f]=[]},b=0,v=0,T=function(){S=b,C=v},A,S,C;T();for(var L=0;L<u.length;L++){var E=[],I=u[L][0],c=I,P,z,D,O;switch(I){case"M":_(),b=+u[L][1],v=+u[L][2],E.push([c,b,v]),T();break;case"Q":case"S":P=+u[L][1],D=+u[L][2],b=+u[L][3],v=+u[L][4],E.push([c,b,v,P,D]);break;case"C":P=+u[L][1],D=+u[L][2],z=+u[L][3],O=+u[L][4],b=+u[L][5],v=+u[L][6],E.push([c,b,v,P,D,z,O]);break;case"T":case"L":b=+u[L][1],v=+u[L][2],E.push([c,b,v]);break;case"H":c="L",b=+u[L][1],E.push([c,b,v]);break;case"V":c="L",v=+u[L][1],E.push([c,b,v]);break;case"A":c="L";var R=+u[L][1],M=+u[L][2];+u[L][4]||(R=-R,M=-M);var B=b-R,F=v;for(A=1;A<=p/2;A++){var N=2*l*A/p;E.push([c,B+R*n(N),F+M*s(N)])}break;case"Z":(b!==S||v!==C)&&(b=S,v=C,E.push([c,b,v]));}for(var t=(o||{}).domain,V=a._fullLayout._size,U=o&&"pixel"===o.xsizemode,H=o&&"pixel"===o.ysizemode,q=!1===r,G=0;G<E.length;G++){for(A=0;7>A+2;A+=2){var Y=E[G][A+1],W=E[G][A+2];Y===void 0||W===void 0||(b=Y,v=W,o&&(o.xaxis&&o.xaxis.p2r?(q&&(Y-=o.xaxis._offset),Y=U?h(o.xaxis,o.xanchor)+Y:m(o.xaxis,Y)):(q&&(Y-=V.l),t?Y=t.x[0]+Y/V.w:Y/=V.w),o.yaxis&&o.yaxis.p2r?(q&&(W-=o.yaxis._offset),W=H?h(o.yaxis,o.yanchor)-W:m(o.yaxis,W)):(q&&(W-=V.t),W=t?t.y[1]-W/V.h:1-W/V.h)),E[G][A+1]=Y,E[G][A+2]=W)}g[f].push(E[G].slice())}}return g},a.pointsShapeRectangle=function(e){var t=e.length;if(5!==t)return!1;for(var a=1;3>a;a++){var i=e[0][a]-e[1][a],n=e[3][a]-e[2][a];if(!o(i,n))return!1;var l=e[0][a]-e[3][a],s=e[1][a]-e[2][a];if(!o(l,s))return!1}return!!(o(e[0][1],e[1][1])||o(e[0][1],e[3][1]))&&!!(r(e[0],e[1])*r(e[0],e[3]))},a.pointsShapeEllipse=function(e){var t=e.length;if(t!==p+1)return!1;t=p;for(var a=0;a<t;a++){var n=(2*t-a)%t,l=(t/2+n)%t,s=(t/2+a)%t;if(!o(r(e[a],e[s]),r(e[n],e[l])))return!1}return!0},a.handleEllipse=function(e,o,r){if(!e)return[o,r];var d=a.ellipseOver({x0:o[0],y0:o[1],x1:r[0],y1:r[1]}),c=(d.x1+d.x0)/2,g=(d.y1+d.y0)/2,m=(d.x1-d.x0)/2,h=(d.y1-d.y0)/2;m||(m=h/=u),h||(h=m/=u);for(var y=[],f=0,x;f<p;f++)x=2*f*l/p,y.push([c+m*n(x),g+h*s(x)]);return y},a.ellipseOver=function(e){var t=e.x0,a=e.y0,o=e.x1,r=e.y1,i=o-t,n=r-a;t-=i,a-=n;var l=(t+o)/2,s=(a+r)/2,d=u;return i*=d,n*=d,{x0:l-i,y0:s-n,x1:l+i,y1:s+n}}},{"../../../plots/cartesian/helpers":716,"./constants":607,"parse-svg-path":444}],611:[function(e,t){'use strict';function a(e,t,a){var o="date"===t.type,r="date"===a.type;if(!o&&!r)return e;for(var n=0;n<e.length;n++)for(var l=0;l<e[n].length;l++)for(var s=0;s+2<e[n][l].length;s+=2)o&&(e[n][l][s+1]=e[n][l][s+1].replace(" ","_")),r&&(e[n][l][s+2]=e[n][l][s+2].replace(" ","_"));return e}var o=e("../../dragelement/helpers"),r=o.drawMode,i=o.openMode,n=e("./constants"),l=n.i000,s=n.i090,d=n.i180,c=n.i270,p=n.cos45,u=n.sin45,g=e("../../../plots/cartesian/helpers"),m=g.p2r,h=g.r2p,y=e("../../../plots/cartesian/handle_outline"),f=y.clearSelect,x=e("./helpers"),_=x.readPaths,b=x.writePaths,v=x.ellipseOver;t.exports=function(t,o){if(t.length){var n=t[0][0];if(n){var e=n.getAttribute("d"),g=o.gd,y=g._fullLayout.newshape,x=o.plotinfo,w=x.xaxis,k=x.yaxis,T=!!x.domain||!x.xaxis,A=!!x.domain||!x.yaxis,S=o.isActiveShape,C=o.dragmode,L=(g.layout||{}).shapes||[];if(!r(C)&&void 0!==S){var E=g._fullLayout._activeShapeIndex;if(E<L.length)switch(g._fullLayout.shapes[E].type){case"rect":C="drawrect";break;case"circle":C="drawcircle";break;case"line":C="drawline";break;case"path":var I=L[E].path||"";C="Z"===I[I.length-1]?"drawclosedpath":"drawopenpath";}}var P=i(C),z=_(e,g,x,S),D={editable:!0,xref:T?"paper":w._id,yref:A?"paper":k._id,layer:y.layer,opacity:y.opacity,line:{color:y.line.color,width:y.line.width,dash:y.line.dash}};P||(D.fillcolor=y.fillcolor,D.fillrule=y.fillrule);var O;if(1===z.length&&(O=z[0]),O&&"drawrect"===C)D.type="rect",D.x0=O[0][1],D.y0=O[0][2],D.x1=O[2][1],D.y1=O[2][2];else if(O&&"drawline"===C)D.type="line",D.x0=O[0][1],D.y0=O[0][2],D.x1=O[1][1],D.y1=O[1][2];else if(O&&"drawcircle"===C){D.type="circle";var R=O[l][1],M=O[s][1],j=O[d][1],B=O[c][1],F=O[l][2],N=O[s][2],V=O[d][2],U=O[c][2],H=x.xaxis&&("date"===x.xaxis.type||"log"===x.xaxis.type),G=x.yaxis&&("date"===x.yaxis.type||"log"===x.yaxis.type);H&&(R=h(x.xaxis,R),M=h(x.xaxis,M),j=h(x.xaxis,j),B=h(x.xaxis,B)),G&&(F=h(x.yaxis,F),N=h(x.yaxis,N),V=h(x.yaxis,V),U=h(x.yaxis,U));var Y=(M+B)/2,W=(F+V)/2,X=(B-M+j-R)/2,Z=(U-N+V-F)/2,K=v({x0:Y,y0:W,x1:Y+X*p,y1:W+Z*u});H&&(K.x0=m(x.xaxis,K.x0),K.x1=m(x.xaxis,K.x1)),G&&(K.y0=m(x.yaxis,K.y0),K.y1=m(x.yaxis,K.y1)),D.x0=K.x0,D.y0=K.y0,D.x1=K.x1,D.y1=K.y1}else D.type="path",w&&k&&a(z,w,k),D.path=b(z),O=null;f(g);for(var $=o.editHelpers,J=($||{}).modifyItem,Q=[],ee=0,te;ee<L.length;ee++)if(te=g._fullLayout.shapes[ee],Q[ee]=te._input,void 0!==S&&ee===g._fullLayout._activeShapeIndex){var ae=D;switch(te.type){case"line":case"rect":case"circle":J("x0",ae.x0),J("x1",ae.x1),J("y0",ae.y0),J("y1",ae.y1);break;case"path":J("path",ae.path);}}return void 0===S?(Q.push(D),Q):$?$.getUpdateObj():{}}}}},{"../../../plots/cartesian/handle_outline":715,"../../../plots/cartesian/helpers":716,"../../dragelement/helpers":542,"./constants":607,"./helpers":610}],612:[function(e,t,a){'use strict';var o=Math.round,r=e("./constants"),i=e("../../lib");a.rangeToShapePosition=function(e){return"log"===e.type?e.r2d:function(e){return e}},a.shapePositionToRange=function(e){return"log"===e.type?e.d2r:function(e){return e}},a.decodeDate=function(e){return function(t){return t.replace&&(t=t.replace("_"," ")),e(t)}},a.encodeDate=function(e){return function(t){return e(t).replace(" ","_")}},a.extractPathCoords=function(e,t){var a=[],o=e.match(r.segmentRE);return o.forEach(function(e){var o=t[e.charAt(0)].drawn;if(void 0!==o){var n=e.substr(1).match(r.paramRE);!n||n.length<o||a.push(i.cleanNumber(n[o]))}}),a},a.getDataToPixel=function(e,t,o){var r=e._fullLayout._size,i;if(t){var n=a.shapePositionToRange(t);i=function(e){return t._offset+t.r2p(n(e,!0))},"date"===t.type&&(i=a.decodeDate(i))}else i=o?function(e){return r.t+r.h*(1-e)}:function(e){return r.l+r.w*e};return i},a.getPixelToData=function(e,t,o){var r=e._fullLayout._size,i;if(t){var n=a.rangeToShapePosition(t);i=function(e){return n(t.p2r(e-t._offset))}}else i=o?function(e){return 1-(e-r.t)/r.h}:function(e){return(e-r.l)/r.w};return i},a.roundPositionForSharpStrokeRendering=function(e,t){var a=1===o(t%2),r=o(e);return a?r+.5:r},a.makeOptionsAndPlotinfo=function(e,t){var a=e._fullLayout.shapes[t]||{},o=e._fullLayout._plots[a.xref+a.yref],r=!!o;return r?o._hadPlotinfo=!0:(o={},a.xref&&"paper"!==a.xref&&(o.xaxis=e._fullLayout[a.xref+"axis"]),a.yref&&"paper"!==a.yref&&(o.yaxis=e._fullLayout[a.yref+"axis"])),o.xsizemode=a.xsizemode,o.ysizemode=a.ysizemode,o.xanchor=a.xanchor,o.yanchor=a.yanchor,{options:a,plotinfo:o}}},{"../../lib":657,"./constants":603}],613:[function(e,t){'use strict';var a=e("./draw");t.exports={moduleType:"component",name:"shapes",layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),supplyDrawNewShapeDefaults:e("./draw_newshape/defaults"),includeBasePlot:e("../../plots/cartesian/include_components")("shapes"),calcAutorange:e("./calc_autorange"),draw:a.draw,drawOne:a.drawOne}},{"../../plots/cartesian/include_components":717,"./attributes":601,"./calc_autorange":602,"./defaults":604,"./draw":605,"./draw_newshape/defaults":608}],614:[function(e,t){'use strict';var a=e("../../plots/font_attributes"),o=e("../../plots/pad_attributes"),r=e("../../lib/extend").extendDeepAll,i=e("../../plot_api/edit_types").overrideAll,n=e("../../plots/animation_attributes"),l=e("../../plot_api/plot_template").templatedArray,s=e("./constants"),d=l("step",{visible:{valType:"boolean",dflt:!0},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string"},value:{valType:"string"},execute:{valType:"boolean",dflt:!0}});t.exports=i(l("slider",{visible:{valType:"boolean",dflt:!0},active:{valType:"number",min:0,dflt:0},steps:d,lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3,dflt:0},pad:r(o({editType:"arraydraw"}),{},{t:{dflt:20}}),xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:0},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},transition:{duration:{valType:"number",min:0,dflt:150},easing:{valType:"enumerated",values:n.transition.easing.values,dflt:"cubic-in-out"}},currentvalue:{visible:{valType:"boolean",dflt:!0},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},offset:{valType:"number",dflt:10},prefix:{valType:"string"},suffix:{valType:"string"},font:a({})},font:a({}),activebgcolor:{valType:"color",dflt:s.gripBgActiveColor},bgcolor:{valType:"color",dflt:s.railBgColor},bordercolor:{valType:"color",dflt:s.railBorderColor},borderwidth:{valType:"number",min:0,dflt:s.railBorderWidth},ticklen:{valType:"number",min:0,dflt:s.tickLength},tickcolor:{valType:"color",dflt:s.tickColor},tickwidth:{valType:"number",min:0,dflt:1},minorticklen:{valType:"number",min:0,dflt:s.minorTickLength}}),"arraydraw","from-root")},{"../../lib/extend":648,"../../plot_api/edit_types":688,"../../plot_api/plot_template":695,"../../plots/animation_attributes":700,"../../plots/font_attributes":733,"../../plots/pad_attributes":767,"./constants":615}],615:[function(e,t){'use strict';t.exports={name:"sliders",containerClassName:"slider-container",groupClassName:"slider-group",inputAreaClass:"slider-input-area",railRectClass:"slider-rail-rect",railTouchRectClass:"slider-rail-touch-rect",gripRectClass:"slider-grip-rect",tickRectClass:"slider-tick-rect",inputProxyClass:"slider-input-proxy",labelsClass:"slider-labels",labelGroupClass:"slider-label-group",labelClass:"slider-label",currentValueClass:"slider-current-value",railHeight:5,menuIndexAttrName:"slider-active-index",autoMarginIdRoot:"slider-",minWidth:30,minHeight:30,textPadX:40,arrowOffsetX:4,railRadius:2,railWidth:5,railBorder:4,railBorderWidth:1,railBorderColor:"#bec8d9",railBgColor:"#f8fafc",railInset:8,stepInset:10,gripRadius:10,gripWidth:20,gripHeight:20,gripBorder:20,gripBorderWidth:1,gripBorderColor:"#bec8d9",gripBgColor:"#f6f8fa",gripBgActiveColor:"#dbdde0",labelPadding:8,labelOffset:0,tickWidth:1,tickColor:"#333",tickOffset:25,tickLength:7,minorTickOffset:25,minorTickColor:"#333",minorTickLength:4,currentValuePadding:8,currentValueInset:0}},{}],616:[function(e,t){'use strict';function a(e,t,a){function s(a,o){return r.coerce(e,t,l,a,o)}for(var d=n(e,t,{name:"steps",handleItemDefaults:o}),c=0,p=0;p<d.length;p++)d[p].visible&&c++;var u;if(u=2>c?t.visible=!1:s("visible"),!!u){t._stepCount=c;var g=t._visibleSteps=r.filterVisible(d),m=s("active");(d[m]||{}).visible||(t.active=g[0]._index),s("x"),s("y"),r.noneOrAll(e,t,["x","y"]),s("xanchor"),s("yanchor"),s("len"),s("lenmode"),s("pad.t"),s("pad.r"),s("pad.b"),s("pad.l"),r.coerceFont(s,"font",a.font);var h=s("currentvalue.visible");h&&(s("currentvalue.xanchor"),s("currentvalue.prefix"),s("currentvalue.suffix"),s("currentvalue.offset"),r.coerceFont(s,"currentvalue.font",t.font)),s("transition.duration"),s("transition.easing"),s("bgcolor"),s("activebgcolor"),s("bordercolor"),s("borderwidth"),s("ticklen"),s("tickwidth"),s("tickcolor"),s("minorticklen")}}function o(e,t){function a(a,o){return r.coerce(e,t,c,a,o)}var o;if(o="skip"===e.method||Array.isArray(e.args)?a("visible"):t.visible=!1,o){a("method"),a("args");var i=a("label","step-"+t._index);a("value",i),a("execute")}}var r=e("../../lib"),n=e("../../plots/array_container_defaults"),l=e("./attributes"),s=e("./constants"),d=s.name,c=l.steps;t.exports=function(e,t){n(e,t,{name:d,handleItemDefaults:a})}},{"../../lib":657,"../../plots/array_container_defaults":701,"./attributes":614,"./constants":615}],617:[function(e,t){'use strict';var k=Math.ceil,T=Math.round,A=Math.min,S=Math.max;function a(e){return z.autoMarginIdRoot+e._index}function o(e,t){for(var a=e[z.name],o=[],r=0,n;r<a.length;r++)n=a[r],n.visible&&(n._gd=t,o.push(n));return o}function r(e){return e._index}function n(e,t){var o=L.tester.selectAll("g."+z.labelGroupClass).data(t._visibleSteps);o.enter().append("g").classed(z.labelGroupClass,!0);var r=0,n=0;o.each(function(e){var a=C.select(this),o=c(a,{step:e},t),i=o.node();if(i){var l=L.bBox(i);n=S(n,l.height),r=S(r,l.width)}}),o.remove();var l=t._dims={};l.inputAreaWidth=S(z.railWidth,z.gripHeight);var d=e._fullLayout._size;l.lx=d.l+d.w*t.x,l.ly=d.t+d.h*(1-t.y),l.outerLength="fraction"===t.lenmode?T(d.w*t.len):t.len,l.inputAreaStart=0,l.inputAreaLength=T(l.outerLength-t.pad.l-t.pad.r);var p=l.inputAreaLength-2*z.stepInset,u=p/(t._stepCount-1),g=r+z.labelPadding;if(l.labelStride=S(1,k(g/u)),l.labelHeight=n,l.currentValueMaxWidth=0,l.currentValueHeight=0,l.currentValueTotalHeight=0,l.currentValueMaxLines=1,t.currentvalue.visible){var m=L.tester.append("g");o.each(function(e){var a=s(m,t,e.label),o=a.node()&&L.bBox(a.node())||{width:0,height:0},r=I.lineCount(a);l.currentValueMaxWidth=S(l.currentValueMaxWidth,k(o.width)),l.currentValueHeight=S(l.currentValueHeight,k(o.height)),l.currentValueMaxLines=S(l.currentValueMaxLines,r)}),l.currentValueTotalHeight=l.currentValueHeight+t.currentvalue.offset,m.remove()}l.height=l.currentValueTotalHeight+z.tickOffset+t.ticklen+z.labelOffset+l.labelHeight+t.pad.t+t.pad.b;var h="left";E.isRightAnchor(t)&&(l.lx-=l.outerLength,h="right"),E.isCenterAnchor(t)&&(l.lx-=l.outerLength/2,h="center");var y="top";E.isBottomAnchor(t)&&(l.ly-=l.height,y="bottom"),E.isMiddleAnchor(t)&&(l.ly-=l.height/2,y="middle"),l.outerLength=k(l.outerLength),l.height=k(l.height),l.lx=T(l.lx),l.ly=T(l.ly);var f={y:t.y,b:l.height*M[y],t:l.height*R[y]};"fraction"===t.lenmode?(f.l=0,f.xl=t.x-t.len*R[h],f.r=0,f.xr=t.x+t.len*M[h]):(f.x=t.x,f.l=l.outerLength*R[h],f.r=l.outerLength*M[h]),i.autoMargin(e,a(t),f)}function l(e,t,a){(a.steps[a.active]||{}).visible||(a.active=a._visibleSteps[0]._index),t.call(s,a).call(w,a).call(p,a).call(h,a).call(v,e,a).call(d,e,a);var o=a._dims;L.setTranslate(t,o.lx+a.pad.l,o.ly+a.pad.t),t.call(f,a,!1),t.call(s,a)}function s(e,t,a){if(t.currentvalue.visible){var o=t._dims,r,i;switch(t.currentvalue.xanchor){case"right":r=o.inputAreaLength-z.currentValueInset-o.currentValueMaxWidth,i="left";break;case"center":r=.5*o.inputAreaLength,i="middle";break;default:r=z.currentValueInset,i="left";}var n=E.ensureSingle(e,"text",z.labelClass,function(e){e.classed("user-select-none",!0).attr({"text-anchor":i,"data-notex":1})}),l=t.currentvalue.prefix?t.currentvalue.prefix:"";if("string"==typeof a)l+=a;else{var s=t.steps[t.active].label,d=t._gd._fullLayout._meta;d&&(s=E.templateString(s,d)),l+=s}t.currentvalue.suffix&&(l+=t.currentvalue.suffix),n.call(L.font,t.currentvalue.font).text(l).call(I.convertToTspans,t._gd);var c=I.lineCount(n),p=(o.currentValueMaxLines+1-c)*t.currentvalue.font.size*O;return I.positionText(n,r,p),n}}function d(e,t,a){var o=E.ensureSingle(e,"rect",z.gripRectClass,function(o){o.call(m,t,e,a).style("pointer-events","all")});o.attr({width:z.gripWidth,height:z.gripHeight,rx:z.gripRadius,ry:z.gripRadius}).call(x.stroke,a.bordercolor).call(x.fill,a.bgcolor).style("stroke-width",a.borderwidth+"px")}function c(e,t,a){var o=E.ensureSingle(e,"text",z.labelClass,function(e){e.classed("user-select-none",!0).attr({"text-anchor":"middle","data-notex":1})}),r=t.step.label,i=a._gd._fullLayout._meta;return i&&(r=E.templateString(r,i)),o.call(L.font,a.font).text(r).call(I.convertToTspans,a._gd),o}function p(e,t){var a=E.ensureSingle(e,"g",z.labelsClass),o=t._dims,r=a.selectAll("g."+z.labelGroupClass).data(o.labelSteps);r.enter().append("g").classed(z.labelGroupClass,!0),r.exit().remove(),r.each(function(e){var a=C.select(this);a.call(c,e,t),L.setTranslate(a,_(t,e.fraction),z.tickOffset+t.ticklen+t.font.size*O+z.labelOffset+o.currentValueTotalHeight)})}function u(e,t,a,o,r){var i=T(o*(a._stepCount-1)),n=a._visibleSteps[i]._index;n!==a.active&&g(e,t,a,n,!0,r)}function g(e,t,a,o,r,n){var l=a.active;a.active=o,P(e.layout,z.name,a).applyUpdate("active",o);var d=a.steps[a.active];t.call(f,a,n),t.call(s,a),e.emit("plotly_sliderchange",{slider:a,step:a.steps[a.active],interaction:r,previousActive:l}),d&&d.method&&r&&(t._nextMethod?(t._nextMethod.step=d,t._nextMethod.doCallback=r,t._nextMethod.doTransition=n):(t._nextMethod={step:d,doCallback:r,doTransition:n},t._nextMethodRaf=window.requestAnimationFrame(function(){var a=t._nextMethod.step;a.method&&(a.execute&&i.executeAPICommand(e,a.method,a.args),t._nextMethod=null,t._nextMethodRaf=null)})))}function m(e,t,a){function o(){return a.data()[0]}var r=a.node(),i=C.select(t);e.on("mousedown",function(){var e=o();t.emit("plotly_sliderstart",{slider:e});var n=a.select("."+z.gripRectClass);C.event.stopPropagation(),C.event.preventDefault(),n.call(x.fill,e.activebgcolor);var l=b(e,C.mouse(r)[0]);u(t,a,e,l,!0),e._dragging=!0,i.on("mousemove",function(){var e=o(),i=b(e,C.mouse(r)[0]);u(t,a,e,i,!1)}),i.on("mouseup",function(){var e=o();e._dragging=!1,n.call(x.fill,e.bgcolor),i.on("mouseup",null),i.on("mousemove",null),t.emit("plotly_sliderend",{slider:e,step:e.steps[e.active]})})})}function h(e,t){var a=e.selectAll("rect."+z.tickRectClass).data(t._visibleSteps),o=t._dims;a.enter().append("rect").classed(z.tickRectClass,!0),a.exit().remove(),a.attr({width:t.tickwidth+"px","shape-rendering":"crispEdges"}),a.each(function(e,a){var r=0==a%o.labelStride,i=C.select(this);i.attr({height:r?t.ticklen:t.minorticklen}).call(x.fill,r?t.tickcolor:t.tickcolor),L.setTranslate(i,_(t,a/(t._stepCount-1))-.5*t.tickwidth,(r?z.tickOffset:z.minorTickOffset)+o.currentValueTotalHeight)})}function y(e){var t=e._dims;t.labelSteps=[];for(var a=e._stepCount,o=0;o<a;o+=t.labelStride)t.labelSteps.push({fraction:o/(a-1),step:e._visibleSteps[o]})}function f(e,t,a){for(var o=e.select("rect."+z.gripRectClass),r=0,n=0;n<t._stepCount;n++)if(t._visibleSteps[n]._index===t.active){r=n;break}var l=_(t,r/(t._stepCount-1));if(!t._invokingCommand){var s=o;a&&0<t.transition.duration&&(s=s.transition().duration(t.transition.duration).ease(t.transition.easing)),s.attr("transform","translate("+(l-.5*z.gripWidth)+","+t._dims.currentValueTotalHeight+")")}}function _(e,t){var a=e._dims;return a.inputAreaStart+z.stepInset+(a.inputAreaLength-2*z.stepInset)*A(1,S(0,t))}function b(e,t){var a=e._dims;return A(1,S(0,(t-z.stepInset-a.inputAreaStart)/(a.inputAreaLength-2*z.stepInset-2*a.inputAreaStart)))}function v(e,t,a){var o=a._dims,r=E.ensureSingle(e,"rect",z.railTouchRectClass,function(o){o.call(m,t,e,a).style("pointer-events","all")});r.attr({width:o.inputAreaLength,height:S(o.inputAreaWidth,z.tickOffset+a.ticklen+o.labelHeight)}).call(x.fill,a.bgcolor).attr("opacity",0),L.setTranslate(r,0,o.currentValueTotalHeight)}function w(e,t){var a=t._dims,o=a.inputAreaLength-2*z.railInset,r=E.ensureSingle(e,"rect",z.railRectClass);r.attr({width:o,height:z.railWidth,rx:z.railRadius,ry:z.railRadius,"shape-rendering":"crispEdges"}).call(x.stroke,t.bordercolor).call(x.fill,t.bgcolor).style("stroke-width",t.borderwidth+"px"),L.setTranslate(r,z.railInset,.5*(a.inputAreaWidth-z.railWidth)+a.currentValueTotalHeight)}var C=e("d3"),i=e("../../plots/plots"),x=e("../color"),L=e("../drawing"),E=e("../../lib"),I=e("../../lib/svg_text_utils"),P=e("../../plot_api/plot_template").arrayEditor,z=e("./constants"),D=e("../../constants/alignment"),O=D.LINE_SPACING,R=D.FROM_TL,M=D.FROM_BR;t.exports=function(e){function t(t){t._commandObserver&&(t._commandObserver.remove(),delete t._commandObserver),i.autoMargin(e,a(t))}var s=e._fullLayout,d=o(s,e),c=s._infolayer.selectAll("g."+z.containerClassName).data(0<d.length?[0]:[]);if(c.enter().append("g").classed(z.containerClassName,!0).style("cursor","ew-resize"),c.exit().each(function(){C.select(this).selectAll("g."+z.groupClassName).each(t)}).remove(),0!==d.length){var p=c.selectAll("g."+z.groupClassName).data(d,r);p.enter().append("g").classed(z.groupClassName,!0),p.exit().each(t).remove();for(var u=0,m;u<d.length;u++)m=d[u],n(e,m);p.each(function(t){var a=C.select(this);y(t),i.manageCommandObserver(e,t,t._visibleSteps,function(t){var o=a.data()[0];o.active===t.index||o._dragging||g(e,a,o,t.index,!1,!0)}),l(e,C.select(this),t)})}}},{"../../constants/alignment":626,"../../lib":657,"../../lib/svg_text_utils":681,"../../plot_api/plot_template":695,"../../plots/plots":768,"../color":524,"../drawing":546,"./constants":615,d3:108}],618:[function(e,t){'use strict';var a=e("./constants");t.exports={moduleType:"component",name:a.name,layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),draw:e("./draw")}},{"./attributes":614,"./constants":615,"./defaults":616,"./draw":617}],619:[function(e,t){'use strict';var a=Math.min,o=Math.max,r=e("d3"),i=e("fast-isnumeric"),n=e("../../plots/plots"),l=e("../../registry"),s=e("../../lib"),d=e("../drawing"),c=e("../color"),p=e("../../lib/svg_text_utils"),u=e("../../constants/interactions"),g=e("../../constants/alignment").OPPOSITE_SIDE,m=/ [XY][0-9]* /;t.exports={draw:function(e,t,h){function y(e){s.syncOrAsync([f,x],e)}function f(t){var a;return A?(a="",A.rotate&&(a+="rotate("+[A.rotate,T.x,T.y]+")"),A.offset&&(a+="translate(0, "+A.offset+")")):a=null,t.attr("transform",a),t.style({"font-family":D,"font-size":r.round(O,2)+"px",fill:c.rgb(R),opacity:L*c.opacity(R),"font-weight":n.fontWeight}).attr(T).call(p.convertToTspans,e),n.previousPromises(e)}function x(e){var t=r.select(e.node().parentNode);if(k&&k.selection&&k.side&&P){t.attr("transform",null);var n=g[k.side],l="left"===k.side||"top"===k.side?-1:1,c=i(k.pad)?k.pad:2,p=d.bBox(t.node()),u={left:0,top:0,right:C.width,bottom:C.height},m=k.maxShift||l*(u[k.side]-p[k.side]),h=0;if(0>m)h=m;else{var y=k.offsetLeft||0,f=k.offsetTop||0;p.left-=y,p.right-=y,p.top-=f,p.bottom-=f,k.selection.each(function(){var e=d.bBox(this);s.bBoxIntersect(p,e,c)&&(h=o(h,l*(e[k.side]-p[n])+c))}),h=a(m,h)}if(0<h||0>m){var x={left:[-h,0],right:[h,0],top:[0,-h],bottom:[0,h]}[k.side];t.attr("transform","translate("+x+")")}}}var _=h.propContainer,b=h.propName,v=h.placeholder,w=h.traceIndex,k=h.avoid||{},T=h.attributes,A=h.transform,S=h.containerGroup,C=e._fullLayout,L=1,E=!1,I=_.title,P=(I&&I.text?I.text:"").trim(),z=I&&I.font?I.font:{},D=z.family,O=z.size,R=z.color,M;"title.text"===b?M="titleText":-1===b.indexOf("axis")?b.indexOf(!0)&&(M="colorbarTitleText"):M="axisTitleText";var j=e._context.edits[M];""===P?L=0:P.replace(m," % ")===v.replace(m," % ")&&(L=.2,E=!0,!j&&(P="")),h._meta?P=s.templateString(P,h._meta):C._meta&&(P=s.templateString(P,C._meta));var B=P||j;S||(S=s.ensureSingle(C._infolayer,"g","g-"+t));var F=S.selectAll("text").data(B?[0]:[]);return(F.enter().append("text"),F.text(P).attr("class",t),F.exit().remove(),!B)?S:(F.call(y),j&&(P?F.on(".opacity",null):function(){L=0,E=!0,F.text(v).on("mouseover.opacity",function(){r.select(this).transition().duration(u.SHOW_PLACEHOLDER).style("opacity",1)}).on("mouseout.opacity",function(){r.select(this).transition().duration(u.HIDE_PLACEHOLDER).style("opacity",0)})}(),F.call(p.makeEditable,{gd:e}).on("edit",function(t){void 0===w?l.call("_guiRelayout",e,b,t):l.call("_guiRestyle",e,b,t,w)}).on("cancel",function(){this.text(this.attr("data-unformatted")).call(y)}).on("input",function(e){this.text(e||" ").call(p.positionText,T.x,T.y)})),F.classed("js-placeholder",E),S)}}},{"../../constants/alignment":626,"../../constants/interactions":632,"../../lib":657,"../../lib/svg_text_utils":681,"../../plots/plots":768,"../../registry":788,"../color":524,"../drawing":546,d3:108,"fast-isnumeric":201}],620:[function(e,t){'use strict';var a=e("../../plots/font_attributes"),o=e("../color/attributes"),r=e("../../lib/extend").extendFlat,i=e("../../plot_api/edit_types").overrideAll,n=e("../../plots/pad_attributes"),l=e("../../plot_api/plot_template").templatedArray,s=l("button",{visible:{valType:"boolean"},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},args2:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string",dflt:""},execute:{valType:"boolean",dflt:!0}});t.exports=i(l("updatemenu",{_arrayAttrRegexps:[/^updatemenus\[(0|[1-9][0-9]+)\]\.buttons/],visible:{valType:"boolean"},type:{valType:"enumerated",values:["dropdown","buttons"],dflt:"dropdown"},direction:{valType:"enumerated",values:["left","right","up","down"],dflt:"down"},active:{valType:"integer",min:-1,dflt:0},showactive:{valType:"boolean",dflt:!0},buttons:s,x:{valType:"number",min:-2,max:3,dflt:-.05},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"right"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},pad:r(n({editType:"arraydraw"}),{}),font:a({}),bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:o.borderLine},borderwidth:{valType:"number",min:0,dflt:1,editType:"arraydraw"}}),"arraydraw","from-root")},{"../../lib/extend":648,"../../plot_api/edit_types":688,"../../plot_api/plot_template":695,"../../plots/font_attributes":733,"../../plots/pad_attributes":767,"../color/attributes":523}],621:[function(e,t){'use strict';t.exports={name:"updatemenus",containerClassName:"updatemenu-container",headerGroupClassName:"updatemenu-header-group",headerClassName:"updatemenu-header",headerArrowClassName:"updatemenu-header-arrow",dropdownButtonGroupClassName:"updatemenu-dropdown-button-group",dropdownButtonClassName:"updatemenu-dropdown-button",buttonClassName:"updatemenu-button",itemRectClassName:"updatemenu-item-rect",itemTextClassName:"updatemenu-item-text",menuIndexAttrName:"updatemenu-active-index",autoMarginIdRoot:"updatemenu-",blankHeaderOpts:{label:"  "},minWidth:30,minHeight:30,textPadX:24,arrowPadX:16,rx:2,ry:2,textOffsetX:12,textOffsetY:3,arrowOffsetX:4,gapButtonHeader:5,gapButton:2,activeColor:"#F4FAFF",hoverColor:"#F4FAFF",arrowSymbol:{left:"\u25C4",right:"\u25BA",up:"\u25B2",down:"\u25BC"}}},{}],622:[function(e,t){'use strict';function a(e,t,a){function l(a,o){return r.coerce(e,t,n,a,o)}var s=i(e,t,{name:"buttons",handleItemDefaults:o}),d=l("visible",0<s.length);d&&(l("active"),l("direction"),l("type"),l("showactive"),l("x"),l("y"),r.noneOrAll(e,t,["x","y"]),l("xanchor"),l("yanchor"),l("pad.t"),l("pad.r"),l("pad.b"),l("pad.l"),r.coerceFont(l,"font",a.font),l("bgcolor",a.paper_bgcolor),l("bordercolor"),l("borderwidth"))}function o(e,t){function a(a,o){return r.coerce(e,t,d,a,o)}var o=a("visible","skip"===e.method||Array.isArray(e.args));o&&(a("method"),a("args"),a("args2"),a("label"),a("execute"))}var r=e("../../lib"),i=e("../../plots/array_container_defaults"),n=e("./attributes"),l=e("./constants"),s=l.name,d=n.buttons;t.exports=function(e,t){i(e,t,{name:s,handleItemDefaults:a})}},{"../../lib":657,"../../plots/array_container_defaults":701,"./attributes":620,"./constants":621}],623:[function(e,t){'use strict';var b=Math.ceil,v=Math.round,w=Math.max;function a(e){return e._index}function o(e){return-1==+e.attr(P.menuIndexAttrName)}function r(e,t){return+e.attr(P.menuIndexAttrName)===t._index}function i(e,t,a,o,r,i,s,d){t.active=s,E(e.layout,P.name,t).applyUpdate("active",s),"buttons"===t.type?l(e,o,null,null,t):"dropdown"===t.type&&(r.attr(P.menuIndexAttrName,"-1"),n(e,o,r,i,t),!d&&l(e,o,r,i,t))}function n(e,t,a,o,i){var n=C.ensureSingle(t,"g",P.headerClassName,function(e){e.style("pointer-events","all")}),s=i._dims,d=i.active,p=i.buttons[d]||P.blankHeaderOpts,u={y:i.pad.t,yPad:0,x:i.pad.l,xPad:0,index:0},g={width:s.headerWidth,height:s.headerHeight};n.call(c,i,p,e).call(x,i,u,g);var y=C.ensureSingle(t,"text",P.headerArrowClassName,function(e){e.classed("user-select-none",!0).attr("text-anchor","end").call(S.font,i.font).text(P.arrowSymbol[i.direction])});y.attr({x:s.headerWidth-P.arrowOffsetX+i.pad.l,y:s.headerHeight/2+P.textOffsetY+i.pad.t}),n.on("click",function(){a.call(_,(r(a,i)?-1:i._index)+""),l(e,t,a,o,i)}),n.on("mouseover",function(){n.call(m)}),n.on("mouseout",function(){n.call(h,i)}),S.setTranslate(t,s.lx,s.ly)}function l(e,t,a,r,n){a||(a=t,a.attr("pointer-events","all"));var l=o(a)&&"buttons"!==n.type?[]:n.buttons,p="dropdown"===n.type?P.dropdownButtonClassName:P.buttonClassName,u=a.selectAll("g."+p).data(C.filterVisible(l)),y=u.enter().append("g").classed(p,!0),f=u.exit();"dropdown"===n.type?(y.attr("opacity","0").transition().attr("opacity","1"),f.transition().attr("opacity","0").remove()):f.remove();var _=0,b=0,v=n._dims,A=-1!==["up","down"].indexOf(n.direction);"dropdown"===n.type&&(A?b=v.headerHeight+P.gapButtonHeader:_=v.headerWidth+P.gapButtonHeader),"dropdown"===n.type&&"up"===n.direction&&(b=-P.gapButtonHeader+P.gapButton-v.openHeight),"dropdown"===n.type&&"left"===n.direction&&(_=-P.gapButtonHeader+P.gapButton-v.openWidth);var S={x:v.lx+_+n.pad.l,y:v.ly+b+n.pad.t,yPad:P.gapButton,xPad:P.gapButton,index:0},L={l:S.x+n.borderwidth,t:S.y+n.borderwidth};u.each(function(o,l){var s=k.select(this);s.call(c,n,o,e).call(x,n,S),s.on("click",function(){k.event.defaultPrevented||(o.execute&&(o.args2&&n.active===l?(i(e,n,o,t,a,r,-1),T.executeAPICommand(e,o.method,o.args2)):(i(e,n,o,t,a,r,l),T.executeAPICommand(e,o.method,o.args))),e.emit("plotly_buttonclicked",{menu:n,button:o,active:n.active}))}),s.on("mouseover",function(){s.call(m)}),s.on("mouseout",function(){s.call(h,n),u.call(g,n)})}),u.call(g,n),A?(L.w=w(v.openWidth,v.headerWidth),L.h=S.y-L.t):(L.w=S.x-L.l,L.h=w(v.openHeight,v.headerHeight)),L.direction=n.direction,r&&(u.size()?s(e,t,a,r,n,L):d(r))}function s(e,t,a,o,r,n){var l=r.direction,s=r._dims,d=r.active,c,p,u;if("up"===l||"down"===l)for(p=0,u=0;u<d;u++)p+=s.heights[u]+P.gapButton;else for(c=0,u=0;u<d;u++)c+=s.widths[u]+P.gapButton;o.enable(n,c,p),o.hbar&&o.hbar.attr("opacity","0").transition().attr("opacity","1"),o.vbar&&o.vbar.attr("opacity","0").transition().attr("opacity","1")}function d(e){var t=!!e.hbar,a=!!e.vbar;t&&e.hbar.transition().attr("opacity","0").each("end",function(){t=!1,a||e.disable()}),a&&e.vbar.transition().attr("opacity","0").each("end",function(){a=!1,t||e.disable()})}function c(e,t,a,o){e.call(p,t).call(u,t,a,o)}function p(e,t){var a=C.ensureSingle(e,"rect",P.itemRectClassName,function(e){e.attr({rx:P.rx,ry:P.ry,"shape-rendering":"crispEdges"})});a.call(A.stroke,t.bordercolor).call(A.fill,t.bgcolor).style("stroke-width",t.borderwidth+"px")}function u(e,t,a,o){var r=C.ensureSingle(e,"text",P.itemTextClassName,function(e){e.classed("user-select-none",!0).attr({"text-anchor":"start","data-notex":1})}),i=a.label,n=o._fullLayout._meta;n&&(i=C.templateString(i,n)),r.call(S.font,t.font).text(i).call(L.convertToTspans,o)}function g(e,t){var a=t.active;e.each(function(e,o){var r=k.select(this);o===a&&t.showactive&&r.select("rect."+P.itemRectClassName).call(A.fill,P.activeColor)})}function m(e){e.select("rect."+P.itemRectClassName).call(A.fill,P.hoverColor)}function h(e,t){e.select("rect."+P.itemRectClassName).call(A.fill,t.bgcolor)}function y(e,t){var a=t._dims={width1:0,height1:0,heights:[],widths:[],totalWidth:0,totalHeight:0,openWidth:0,openHeight:0,lx:0,ly:0},o=S.tester.selectAll("g."+P.dropdownButtonClassName).data(C.filterVisible(t.buttons));o.enter().append("g").classed(P.dropdownButtonClassName,!0);var r=-1!==["up","down"].indexOf(t.direction);o.each(function(o,n){var i=k.select(this);i.call(c,t,o,e);var l=i.select("."+P.itemTextClassName),s=l.node()&&S.bBox(l.node()).width,d=w(s+P.textPadX,P.minWidth),p=t.font.size*I,u=L.lineCount(l),g=w(p*u,P.minHeight)+P.textOffsetY;g=b(g),d=b(d),a.widths[n]=d,a.heights[n]=g,a.height1=w(a.height1,g),a.width1=w(a.width1,d),r?(a.totalWidth=w(a.totalWidth,d),a.openWidth=a.totalWidth,a.totalHeight+=g+P.gapButton,a.openHeight+=g+P.gapButton):(a.totalWidth+=d+P.gapButton,a.openWidth+=d+P.gapButton,a.totalHeight=w(a.totalHeight,g),a.openHeight=a.totalHeight)}),r?a.totalHeight-=P.gapButton:a.totalWidth-=P.gapButton,a.headerWidth=a.width1+P.arrowPadX,a.headerHeight=a.height1,"dropdown"===t.type&&(r?(a.width1+=P.arrowPadX,a.totalHeight=a.height1):a.totalWidth=a.width1,a.totalWidth+=P.arrowPadX),o.remove();var i=a.totalWidth+t.pad.l+t.pad.r,n=a.totalHeight+t.pad.t+t.pad.b,l=e._fullLayout._size;a.lx=l.l+l.w*t.x,a.ly=l.t+l.h*(1-t.y);var s="left";C.isRightAnchor(t)&&(a.lx-=i,s="right"),C.isCenterAnchor(t)&&(a.lx-=i/2,s="center");var d="top";C.isBottomAnchor(t)&&(a.ly-=n,d="bottom"),C.isMiddleAnchor(t)&&(a.ly-=n/2,d="middle"),a.totalWidth=b(a.totalWidth),a.totalHeight=b(a.totalHeight),a.lx=v(a.lx),a.ly=v(a.ly),T.autoMargin(e,f(t),{x:t.x,y:t.y,l:i*({right:1,center:.5}[s]||0),r:i*({left:1,center:.5}[s]||0),b:n*({top:1,middle:.5}[d]||0),t:n*({bottom:1,middle:.5}[d]||0)})}function f(e){return P.autoMarginIdRoot+e._index}function x(e,t,a,o){o=o||{};var r=e.select("."+P.itemRectClassName),i=e.select("."+P.itemTextClassName),n=t.borderwidth,l=a.index,s=t._dims;S.setTranslate(e,n+a.x,n+a.y);var d=-1!==["up","down"].indexOf(t.direction),c=o.height||(d?s.heights[l]:s.height1);r.attr({x:0,y:0,width:o.width||(d?s.width1:s.widths[l]),height:c});var p=t.font.size*I,u=L.lineCount(i);L.positionText(i,P.textOffsetX,c/2-(u-1)*p/2+P.textOffsetY),d?a.y+=s.heights[l]+a.yPad:a.x+=s.widths[l]+a.xPad,a.index++}function _(e,t){e.attr(P.menuIndexAttrName,t||"-1").selectAll("g."+P.dropdownButtonClassName).remove()}var k=e("d3"),T=e("../../plots/plots"),A=e("../color"),S=e("../drawing"),C=e("../../lib"),L=e("../../lib/svg_text_utils"),E=e("../../plot_api/plot_template").arrayEditor,I=e("../../constants/alignment").LINE_SPACING,P=e("./constants"),z=e("./scrollbox");t.exports=function(e){function t(t){T.autoMargin(e,f(t))}var o=e._fullLayout,s=C.filterVisible(o[P.name]),d=o._menulayer.selectAll("g."+P.containerClassName).data(0<s.length?[0]:[]);if(d.enter().append("g").classed(P.containerClassName,!0).style("cursor","pointer"),d.exit().each(function(){k.select(this).selectAll("g."+P.headerGroupClassName).each(t)}).remove(),0!==s.length){var c=d.selectAll("g."+P.headerGroupClassName).data(s,a);c.enter().append("g").classed(P.headerGroupClassName,!0);for(var p=C.ensureSingle(d,"g",P.dropdownButtonGroupClassName,function(e){e.style("pointer-events","all")}),u=0,g;u<s.length;u++)g=s[u],y(e,g);var m="updatemenus"+o._uid,h=new z(e,p,m);c.enter().size()&&(p.node().parentNode.appendChild(p.node()),p.call(_)),c.exit().each(function(e){p.call(_),t(e)}).remove(),c.each(function(t){var a=k.select(this),o="dropdown"===t.type?p:null;T.manageCommandObserver(e,t,t.buttons,function(r){i(e,t,t.buttons[r.index],a,o,h,r.index,!0)}),"dropdown"===t.type?(n(e,a,p,h,t),r(p,t)&&l(e,a,p,h,t)):l(e,a,null,null,t)})}}},{"../../constants/alignment":626,"../../lib":657,"../../lib/svg_text_utils":681,"../../plot_api/plot_template":695,"../../plots/plots":768,"../color":524,"../drawing":546,"./constants":621,"./scrollbox":625,d3:108}],624:[function(e,t,a){arguments[4][618][0].apply(a,arguments)},{"./attributes":620,"./constants":621,"./defaults":622,"./draw":623,dup:618}],625:[function(e,t){'use strict';var o=Math.ceil,r=Math.min,i=Math.max,n=Math.floor;function a(e,t,a){this.gd=e,this.container=t,this.id=a,this.position=null,this.translateX=null,this.translateY=null,this.hbar=null,this.vbar=null,this.bg=this.container.selectAll("rect.scrollbox-bg").data([0]),this.bg.exit().on(".drag",null).on("wheel",null).remove(),this.bg.enter().append("rect").classed("scrollbox-bg",!0).style("pointer-events","all").attr({opacity:0,x:0,y:0,width:0,height:0})}t.exports=a;var l=e("d3"),s=e("../color"),d=e("../drawing"),c=e("../../lib");a.barWidth=2,a.barLength=20,a.barRadius=2,a.barPad=1,a.barColor="#808BA4",a.prototype.enable=function(e,c,p){var u=this.gd._fullLayout,g=u.width,m=u.height;this.position=e;var y=this.position.l,f=this.position.w,x=this.position.t,t=this.position.h,h=this.position.direction,_="down"===h,b="left"===h,v="up"===h,w=f,k=t,T,A,S,C;_||b||"right"===h||v||(this.position.direction="down",_=!0);var L=_||v;L?(T=y,A=T+w,_?(S=x,C=r(S+k,m),k=C-S):(C=x+k,S=i(C-k,0),k=C-S)):(S=x,C=S+k,b?(A=y+w,T=i(A-w,0),w=A-T):(T=y,A=r(T+w,g),w=A-T)),this._box={l:T,t:S,w:w,h:k};var E=f>w,I=a.barLength+2*a.barPad,P=a.barWidth+2*a.barPad,z=y,D=x+t;D+P>m&&(D=m-P);var O=this.container.selectAll("rect.scrollbar-horizontal").data(E?[0]:[]);O.exit().on(".drag",null).remove(),O.enter().append("rect").classed("scrollbar-horizontal",!0).call(s.fill,a.barColor),E?(this.hbar=O.attr({rx:a.barRadius,ry:a.barRadius,x:z,y:D,width:I,height:P}),this._hbarXMin=z+I/2,this._hbarTranslateMax=w-I):(delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax);var R=t>k,M=a.barWidth+2*a.barPad,j=a.barLength+2*a.barPad,B=y+f,F=x;B+M>g&&(B=g-M);var N=this.container.selectAll("rect.scrollbar-vertical").data(R?[0]:[]);N.exit().on(".drag",null).remove(),N.enter().append("rect").classed("scrollbar-vertical",!0).call(s.fill,a.barColor),R?(this.vbar=N.attr({rx:a.barRadius,ry:a.barRadius,x:B,y:F,width:M,height:j}),this._vbarYMin=F+j/2,this._vbarTranslateMax=k-j):(delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax);var V=this.id,U=T-.5,H=R?A+M+.5:A+.5,q=S-.5,G=E?C+P+.5:C+.5,Y=u._topdefs.selectAll("#"+V).data(E||R?[0]:[]);if(Y.exit().remove(),Y.enter().append("clipPath").attr("id",V).append("rect"),E||R?(this._clipRect=Y.select("rect").attr({x:n(U),y:n(q),width:o(H)-n(U),height:o(G)-n(q)}),this.container.call(d.setClipUrl,V,this.gd),this.bg.attr({x:y,y:x,width:f,height:t})):(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(d.setClipUrl,null),delete this._clipRect),E||R){var W=l.behavior.drag().on("dragstart",function(){l.event.sourceEvent.preventDefault()}).on("drag",this._onBoxDrag.bind(this));this.container.on("wheel",null).on("wheel",this._onBoxWheel.bind(this)).on(".drag",null).call(W);var X=l.behavior.drag().on("dragstart",function(){l.event.sourceEvent.preventDefault(),l.event.sourceEvent.stopPropagation()}).on("drag",this._onBarDrag.bind(this));E&&this.hbar.on(".drag",null).call(X),R&&this.vbar.on(".drag",null).call(X)}this.setTranslate(c,p)},a.prototype.disable=function(){(this.hbar||this.vbar)&&(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(d.setClipUrl,null),delete this._clipRect),this.hbar&&(this.hbar.on(".drag",null),this.hbar.remove(),delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax),this.vbar&&(this.vbar.on(".drag",null),this.vbar.remove(),delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax)},a.prototype._onBoxDrag=function(){var e=this.translateX,t=this.translateY;this.hbar&&(e-=l.event.dx),this.vbar&&(t-=l.event.dy),this.setTranslate(e,t)},a.prototype._onBoxWheel=function(){var e=this.translateX,t=this.translateY;this.hbar&&(e+=l.event.deltaY),this.vbar&&(t+=l.event.deltaY),this.setTranslate(e,t)},a.prototype._onBarDrag=function(){var e=this.translateX,t=this.translateY;if(this.hbar){var a=e+this._hbarXMin,o=a+this._hbarTranslateMax,r=c.constrain(l.event.x,a,o),i=this.position.w-this._box.w;e=(r-a)/(o-a)*i}if(this.vbar){var n=t+this._vbarYMin,s=n+this._vbarTranslateMax,d=c.constrain(l.event.y,n,s),p=this.position.h-this._box.h;t=(d-n)/(s-n)*p}this.setTranslate(e,t)},a.prototype.setTranslate=function(e,t){var a=this.position.w-this._box.w,o=this.position.h-this._box.h;if(e=c.constrain(e||0,0,a),t=c.constrain(t||0,0,o),this.translateX=e,this.translateY=t,this.container.call(d.setTranslate,this._box.l-this.position.l-e,this._box.t-this.position.t-t),this._clipRect&&this._clipRect.attr({x:n(this.position.l+e-.5),y:n(this.position.t+t-.5)}),this.hbar){var r=e/a;this.hbar.call(d.setTranslate,e+r*this._hbarTranslateMax,t)}if(this.vbar){var i=t/o;this.vbar.call(d.setTranslate,e,t+i*this._vbarTranslateMax)}}},{"../../lib":657,"../color":524,"../drawing":546,d3:108}],626:[function(e,t){'use strict';t.exports={FROM_BL:{left:0,center:.5,right:1,bottom:0,middle:.5,top:1},FROM_TL:{left:0,center:.5,right:1,bottom:1,middle:.5,top:0},FROM_BR:{left:1,center:.5,right:0,bottom:0,middle:.5,top:1},LINE_SPACING:1.3,CAP_SHIFT:.7,MID_SHIFT:.35,OPPOSITE_SIDE:{left:"right",right:"left",top:"bottom",bottom:"top"}}},{}],627:[function(e,t){'use strict';t.exports={INCREASING:{COLOR:"#3D9970",SYMBOL:"\u25B2"},DECREASING:{COLOR:"#FF4136",SYMBOL:"\u25BC"}}},{}],628:[function(e,t){'use strict';t.exports={FORMAT_LINK:"https://github.com/d3/d3-3.x-api-reference/blob/master/Formatting.md#d3_format",DATE_FORMAT_LINK:"https://github.com/d3/d3-3.x-api-reference/blob/master/Time-Formatting.md#format"}},{}],629:[function(e,t){'use strict';t.exports={COMPARISON_OPS:["=","!=","<",">=",">","<="],COMPARISON_OPS2:["=","<",">=",">","<="],INTERVAL_OPS:["[]","()","[)","(]","][",")(","](",")["],SET_OPS:["{}","}{"],CONSTRAINT_REDUCTION:{"=":"=","<":"<","<=":"<",">":">",">=":">","[]":"[]","()":"[]","[)":"[]","(]":"[]","][":"][",")(":"][","](":"][",")[":"]["}}},{}],630:[function(e,t){'use strict';t.exports={solid:[[],0],dot:[[.5,1],200],dash:[[.5,1],50],longdash:[[.5,1],10],dashdot:[[.5,.625,.875,1],50],longdashdot:[[.5,.7,.8,1],10]}},{}],631:[function(e,t){'use strict';t.exports={circle:"\u25CF","circle-open":"\u25CB",square:"\u25A0","square-open":"\u25A1",diamond:"\u25C6","diamond-open":"\u25C7",cross:"+",x:"\u274C"}},{}],632:[function(e,t){'use strict';t.exports={SHOW_PLACEHOLDER:100,HIDE_PLACEHOLDER:1e3,DESELECTDIM:.2}},{}],633:[function(e,t){'use strict';t.exports={BADNUM:void 0,FP_SAFE:Number.MAX_VALUE/1e4,ONEAVGYEAR:315576e5,ONEAVGMONTH:26298e5,ONEDAY:864e5,ONEHOUR:36e5,ONEMIN:6e4,ONESEC:1e3,EPOCHJD:2440587.5,ALMOST_EQUAL:1-1e-6,LOG_CLIP:10,MINUS_SIGN:"\u2212"}},{}],634:[function(e,t,a){'use strict';a.xmlns="http://www.w3.org/2000/xmlns/",a.svg="http://www.w3.org/2000/svg",a.xlink="http://www.w3.org/1999/xlink",a.svgAttrs={xmlns:a.svg,"xmlns:xlink":a.xlink}},{}],635:[function(e,t,a){'use strict';a.version=e("./version").version,e("es6-promise").polyfill(),e("../build/plotcss"),e("./fonts/mathjax_config")();for(var o=e("./registry"),r=a.register=o.register,n=e("./plot_api"),l=Object.keys(n),s=0,d;s<l.length;s++)d=l[s],"_"!==d.charAt(0)&&(a[d]=n[d]),r({moduleType:"apiMethod",name:d,fn:n[d]});r(e("./traces/scatter")),r([e("./components/legend"),e("./components/fx"),e("./components/annotations"),e("./components/annotations3d"),e("./components/shapes"),e("./components/images"),e("./components/updatemenus"),e("./components/sliders"),e("./components/rangeslider"),e("./components/rangeselector"),e("./components/grid"),e("./components/errorbars"),e("./components/colorscale"),e("./components/colorbar")]),r([e("./locale-en"),e("./locale-en-us")]),window.PlotlyLocales&&Array.isArray(window.PlotlyLocales)&&(r(window.PlotlyLocales),delete window.PlotlyLocales),a.Icons=e("./fonts/ploticon"),a.Plots=e("./plots/plots"),a.Fx=e("./components/fx"),a.Snapshot=e("./snapshot"),a.PlotSchema=e("./plot_api/plot_schema"),a.Queue=e("./lib/queue"),a.d3=e("d3")},{"../build/plotcss":453,"./components/annotations":515,"./components/annotations3d":520,"./components/colorbar":530,"./components/colorscale":536,"./components/errorbars":552,"./components/fx":564,"./components/grid":568,"./components/images":573,"./components/legend":581,"./components/rangeselector":592,"./components/rangeslider":599,"./components/shapes":613,"./components/sliders":618,"./components/updatemenus":624,"./fonts/mathjax_config":636,"./fonts/ploticon":637,"./lib/queue":672,"./locale-en":686,"./locale-en-us":685,"./plot_api":690,"./plot_api/plot_schema":694,"./plots/plots":768,"./registry":788,"./snapshot":793,"./traces/scatter":1074,"./version":1244,d3:108,"es6-promise":183}],636:[function(e,t){'use strict';t.exports=function(){if("undefined"!=typeof MathJax){var e="local"!==(window.PlotlyConfig||{}).MathJaxConfig;e&&(MathJax.Hub.Config({messageStyle:"none",skipStartupTypeset:!0,displayAlign:"left",tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]}}),MathJax.Hub.Configured())}}},{}],637:[function(e,t){'use strict';t.exports={undo:{width:857.1,height:1e3,path:"m857 350q0-87-34-166t-91-137-137-92-166-34q-96 0-183 41t-147 114q-4 6-4 13t5 11l76 77q6 5 14 5 9-1 13-7 41-53 100-82t126-29q58 0 110 23t92 61 61 91 22 111-22 111-61 91-92 61-110 23q-55 0-105-20t-90-57l77-77q17-16 8-38-10-23-33-23h-250q-15 0-25 11t-11 25v250q0 24 22 33 22 10 39-8l72-72q60 57 137 88t159 31q87 0 166-34t137-92 91-137 34-166z",transform:"matrix(1 0 0 -1 0 850)"},home:{width:928.6,height:1e3,path:"m786 296v-267q0-15-11-26t-25-10h-214v214h-143v-214h-214q-15 0-25 10t-11 26v267q0 1 0 2t0 2l321 264 321-264q1-1 1-4z m124 39l-34-41q-5-5-12-6h-2q-7 0-12 3l-386 322-386-322q-7-4-13-4-7 2-12 7l-35 41q-4 5-3 13t6 12l401 334q18 15 42 15t43-15l136-114v109q0 8 5 13t13 5h107q8 0 13-5t5-13v-227l122-102q5-5 6-12t-4-13z",transform:"matrix(1 0 0 -1 0 850)"},"camera-retro":{width:1e3,height:1e3,path:"m518 386q0 8-5 13t-13 5q-37 0-63-27t-26-63q0-8 5-13t13-5 12 5 5 13q0 23 16 38t38 16q8 0 13 5t5 13z m125-73q0-59-42-101t-101-42-101 42-42 101 42 101 101 42 101-42 42-101z m-572-320h858v71h-858v-71z m643 320q0 89-62 152t-152 62-151-62-63-152 63-151 151-63 152 63 62 151z m-571 358h214v72h-214v-72z m-72-107h858v143h-462l-36-71h-360v-72z m929 143v-714q0-30-21-51t-50-21h-858q-29 0-50 21t-21 51v714q0 30 21 51t50 21h858q29 0 50-21t21-51z",transform:"matrix(1 0 0 -1 0 850)"},zoombox:{width:1e3,height:1e3,path:"m1000-25l-250 251c40 63 63 138 63 218 0 224-182 406-407 406-224 0-406-182-406-406s183-406 407-406c80 0 155 22 218 62l250-250 125 125z m-812 250l0 438 437 0 0-438-437 0z m62 375l313 0 0-312-313 0 0 312z",transform:"matrix(1 0 0 -1 0 850)"},pan:{width:1e3,height:1e3,path:"m1000 350l-187 188 0-125-250 0 0 250 125 0-188 187-187-187 125 0 0-250-250 0 0 125-188-188 186-187 0 125 252 0 0-250-125 0 187-188 188 188-125 0 0 250 250 0 0-126 187 188z",transform:"matrix(1 0 0 -1 0 850)"},zoom_plus:{width:875,height:1e3,path:"m1 787l0-875 875 0 0 875-875 0z m687-500l-187 0 0-187-125 0 0 187-188 0 0 125 188 0 0 187 125 0 0-187 187 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},zoom_minus:{width:875,height:1e3,path:"m0 788l0-876 875 0 0 876-875 0z m688-500l-500 0 0 125 500 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},autoscale:{width:1e3,height:1e3,path:"m250 850l-187 0-63 0 0-62 0-188 63 0 0 188 187 0 0 62z m688 0l-188 0 0-62 188 0 0-188 62 0 0 188 0 62-62 0z m-875-938l0 188-63 0 0-188 0-62 63 0 187 0 0 62-187 0z m875 188l0-188-188 0 0-62 188 0 62 0 0 62 0 188-62 0z m-125 188l-1 0-93-94-156 156 156 156 92-93 2 0 0 250-250 0 0-2 93-92-156-156-156 156 94 92 0 2-250 0 0-250 0 0 93 93 157-156-157-156-93 94 0 0 0-250 250 0 0 0-94 93 156 157 156-157-93-93 0 0 250 0 0 250z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_basic:{width:1500,height:1e3,path:"m375 725l0 0-375-375 375-374 0-1 1125 0 0 750-1125 0z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_compare:{width:1125,height:1e3,path:"m187 786l0 2-187-188 188-187 0 0 937 0 0 373-938 0z m0-499l0 1-187-188 188-188 0 0 937 0 0 376-938-1z",transform:"matrix(1 0 0 -1 0 850)"},plotlylogo:{width:1542,height:1e3,path:"m0-10h182v-140h-182v140z m228 146h183v-286h-183v286z m225 714h182v-1000h-182v1000z m225-285h182v-715h-182v715z m225 142h183v-857h-183v857z m231-428h182v-429h-182v429z m225-291h183v-138h-183v138z",transform:"matrix(1 0 0 -1 0 850)"},"z-axis":{width:1e3,height:1e3,path:"m833 5l-17 108v41l-130-65 130-66c0 0 0 38 0 39 0-1 36-14 39-25 4-15-6-22-16-30-15-12-39-16-56-20-90-22-187-23-279-23-261 0-341 34-353 59 3 60 228 110 228 110-140-8-351-35-351-116 0-120 293-142 474-142 155 0 477 22 477 142 0 50-74 79-163 96z m-374 94c-58-5-99-21-99-40 0-24 65-43 144-43 79 0 143 19 143 43 0 19-42 34-98 40v216h87l-132 135-133-135h88v-216z m167 515h-136v1c16 16 31 34 46 52l84 109v54h-230v-71h124v-1c-16-17-28-32-44-51l-89-114v-51h245v72z",transform:"matrix(1 0 0 -1 0 850)"},"3d_rotate":{width:1e3,height:1e3,path:"m922 660c-5 4-9 7-14 11-359 263-580-31-580-31l-102 28 58-400c0 1 1 1 2 2 118 108 351 249 351 249s-62 27-100 42c88 83 222 183 347 122 16-8 30-17 44-27-2 1-4 2-6 4z m36-329c0 0 64 229-88 296-62 27-124 14-175-11 157-78 225-208 249-266 8-19 11-31 11-31 2 5 6 15 11 32-5-13-8-20-8-20z m-775-239c70-31 117-50 198-32-121 80-199 346-199 346l-96-15-58-12c0 0 55-226 155-287z m603 133l-317-139c0 0 4-4 19-14 7-5 24-15 24-15s-177-147-389 4c235-287 536-112 536-112l31-22 100 299-4-1z m-298-153c6-4 14-9 24-15 0 0-17 10-24 15z",transform:"matrix(1 0 0 -1 0 850)"},camera:{width:1e3,height:1e3,path:"m500 450c-83 0-150-67-150-150 0-83 67-150 150-150 83 0 150 67 150 150 0 83-67 150-150 150z m400 150h-120c-16 0-34 13-39 29l-31 93c-6 15-23 28-40 28h-340c-16 0-34-13-39-28l-31-94c-6-15-23-28-40-28h-120c-55 0-100-45-100-100v-450c0-55 45-100 100-100h800c55 0 100 45 100 100v450c0 55-45 100-100 100z m-400-550c-138 0-250 112-250 250 0 138 112 250 250 250 138 0 250-112 250-250 0-138-112-250-250-250z m365 380c-19 0-35 16-35 35 0 19 16 35 35 35 19 0 35-16 35-35 0-19-16-35-35-35z",transform:"matrix(1 0 0 -1 0 850)"},movie:{width:1e3,height:1e3,path:"m938 413l-188-125c0 37-17 71-44 94 64 38 107 107 107 187 0 121-98 219-219 219-121 0-219-98-219-219 0-61 25-117 66-156h-115c30 33 49 76 49 125 0 103-84 187-187 187s-188-84-188-187c0-57 26-107 65-141-38-22-65-62-65-109v-250c0-70 56-126 125-126h500c69 0 125 56 125 126l188-126c34 0 62 28 62 63v375c0 35-28 63-62 63z m-750 0c-69 0-125 56-125 125s56 125 125 125 125-56 125-125-56-125-125-125z m406-1c-87 0-157 70-157 157 0 86 70 156 157 156s156-70 156-156-70-157-156-157z",transform:"matrix(1 0 0 -1 0 850)"},question:{width:857.1,height:1e3,path:"m500 82v107q0 8-5 13t-13 5h-107q-8 0-13-5t-5-13v-107q0-8 5-13t13-5h107q8 0 13 5t5 13z m143 375q0 49-31 91t-77 65-95 23q-136 0-207-119-9-14 4-24l74-55q4-4 10-4 9 0 14 7 30 38 48 51 19 14 48 14 27 0 48-15t21-33q0-21-11-34t-38-25q-35-16-65-48t-29-70v-20q0-8 5-13t13-5h107q8 0 13 5t5 13q0 10 12 27t30 28q18 10 28 16t25 19 25 27 16 34 7 45z m214-107q0-117-57-215t-156-156-215-58-216 58-155 156-58 215 58 215 155 156 216 58 215-58 156-156 57-215z",transform:"matrix(1 0 0 -1 0 850)"},disk:{width:857.1,height:1e3,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",transform:"matrix(1 0 0 -1 0 850)"},drawopenpath:{width:70,height:70,path:"M33.21,85.65a7.31,7.31,0,0,1-2.59-.48c-8.16-3.11-9.27-19.8-9.88-41.3-.1-3.58-.19-6.68-.35-9-.15-2.1-.67-3.48-1.43-3.79-2.13-.88-7.91,2.32-12,5.86L3,32.38c1.87-1.64,11.55-9.66,18.27-6.9,2.13.87,4.75,3.14,5.17,9,.17,2.43.26,5.59.36,9.25a224.17,224.17,0,0,0,1.5,23.4c1.54,10.76,4,12.22,4.48,12.4.84.32,2.79-.46,5.76-3.59L43,80.07C41.53,81.57,37.68,85.64,33.21,85.65ZM74.81,69a11.34,11.34,0,0,0,6.09-6.72L87.26,44.5,74.72,32,56.9,38.35c-2.37.86-5.57,3.42-6.61,6L38.65,72.14l8.42,8.43ZM55,46.27a7.91,7.91,0,0,1,3.64-3.17l14.8-5.3,8,8L76.11,60.6l-.06.19a6.37,6.37,0,0,1-3,3.43L48.25,74.59,44.62,71Zm16.57,7.82A6.9,6.9,0,1,0,64.64,61,6.91,6.91,0,0,0,71.54,54.09Zm-4.05,0a2.85,2.85,0,1,1-2.85-2.85A2.86,2.86,0,0,1,67.49,54.09Zm-4.13,5.22L60.5,56.45,44.26,72.7l2.86,2.86ZM97.83,35.67,84.14,22l-8.57,8.57L89.26,44.24Zm-13.69-8,8,8-2.85,2.85-8-8Z",transform:"matrix(1 0 0 1 -15 -15)"},drawclosedpath:{width:90,height:90,path:"M88.41,21.12a26.56,26.56,0,0,0-36.18,0l-2.07,2-2.07-2a26.57,26.57,0,0,0-36.18,0,23.74,23.74,0,0,0,0,34.8L48,90.12a3.22,3.22,0,0,0,4.42,0l36-34.21a23.73,23.73,0,0,0,0-34.79ZM84,51.24,50.16,83.35,16.35,51.25a17.28,17.28,0,0,1,0-25.47,20,20,0,0,1,27.3,0l4.29,4.07a3.23,3.23,0,0,0,4.44,0l4.29-4.07a20,20,0,0,1,27.3,0,17.27,17.27,0,0,1,0,25.46ZM66.76,47.68h-33v6.91h33ZM53.35,35H46.44V68h6.91Z",transform:"matrix(1 0 0 1 -5 -5)"},lasso:{width:1031,height:1e3,path:"m1018 538c-36 207-290 336-568 286-277-48-473-256-436-463 10-57 36-108 76-151-13-66 11-137 68-183 34-28 75-41 114-42l-55-70 0 0c-2-1-3-2-4-3-10-14-8-34 5-45 14-11 34-8 45 4 1 1 2 3 2 5l0 0 113 140c16 11 31 24 45 40 4 3 6 7 8 11 48-3 100 0 151 9 278 48 473 255 436 462z m-624-379c-80 14-149 48-197 96 42 42 109 47 156 9 33-26 47-66 41-105z m-187-74c-19 16-33 37-39 60 50-32 109-55 174-68-42-25-95-24-135 8z m360 75c-34-7-69-9-102-8 8 62-16 128-68 170-73 59-175 54-244-5-9 20-16 40-20 61-28 159 121 317 333 354s407-60 434-217c28-159-121-318-333-355z",transform:"matrix(1 0 0 -1 0 850)"},selectbox:{width:1e3,height:1e3,path:"m0 850l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-285l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z",transform:"matrix(1 0 0 -1 0 850)"},drawline:{width:70,height:70,path:"M60.64,62.3a11.29,11.29,0,0,0,6.09-6.72l6.35-17.72L60.54,25.31l-17.82,6.4c-2.36.86-5.57,3.41-6.6,6L24.48,65.5l8.42,8.42ZM40.79,39.63a7.89,7.89,0,0,1,3.65-3.17l14.79-5.31,8,8L61.94,54l-.06.19a6.44,6.44,0,0,1-3,3.43L34.07,68l-3.62-3.63Zm16.57,7.81a6.9,6.9,0,1,0-6.89,6.9A6.9,6.9,0,0,0,57.36,47.44Zm-4,0a2.86,2.86,0,1,1-2.85-2.85A2.86,2.86,0,0,1,53.32,47.44Zm-4.13,5.22L46.33,49.8,30.08,66.05l2.86,2.86ZM83.65,29,70,15.34,61.4,23.9,75.09,37.59ZM70,21.06l8,8-2.84,2.85-8-8ZM87,80.49H10.67V87H87Z",transform:"matrix(1 0 0 1 -15 -15)"},drawrect:{width:80,height:80,path:"M78,22V79H21V22H78m9-9H12V88H87V13ZM68,46.22H31V54H68ZM53,32H45.22V69H53Z",transform:"matrix(1 0 0 1 -10 -10)"},drawcircle:{width:80,height:80,path:"M50,84.72C26.84,84.72,8,69.28,8,50.3S26.84,15.87,50,15.87,92,31.31,92,50.3,73.16,84.72,50,84.72Zm0-60.59c-18.6,0-33.74,11.74-33.74,26.17S31.4,76.46,50,76.46,83.74,64.72,83.74,50.3,68.6,24.13,50,24.13Zm17.15,22h-34v7.11h34Zm-13.8-13H46.24v34h7.11Z",transform:"matrix(1 0 0 1 -10 -10)"},eraseshape:{width:80,height:80,path:"M82.77,78H31.85L6,49.57,31.85,21.14H82.77a8.72,8.72,0,0,1,8.65,8.77V69.24A8.72,8.72,0,0,1,82.77,78ZM35.46,69.84H82.77a.57.57,0,0,0,.49-.6V29.91a.57.57,0,0,0-.49-.61H35.46L17,49.57Zm32.68-34.7-24,24,5,5,24-24Zm-19,.53-5,5,24,24,5-5Z",transform:"matrix(1 0 0 1 -10 -10)"},spikeline:{width:1e3,height:1e3,path:"M512 409c0-57-46-104-103-104-57 0-104 47-104 104 0 57 47 103 104 103 57 0 103-46 103-103z m-327-39l92 0 0 92-92 0z m-185 0l92 0 0 92-92 0z m370-186l92 0 0 93-92 0z m0-184l92 0 0 92-92 0z",transform:"matrix(1.5 0 0 -1.5 0 850)"},pencil:{width:1792,height:1792,path:"M491 1536l91-91-235-235-91 91v107h128v128h107zm523-928q0-22-22-22-10 0-17 7l-542 542q-7 7-7 17 0 22 22 22 10 0 17-7l542-542q7-7 7-17zm-54-192l416 416-832 832h-416v-416zm683 96q0 53-37 90l-166 166-416-416 166-165q36-38 90-38 53 0 91 38l235 234q37 39 37 91z",transform:"matrix(1 0 0 1 0 1)"},newplotlylogo:{name:"newplotlylogo",svg:"<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 132 132'><defs><style>.cls-1 {fill: #3f4f75;} .cls-2 {fill: #80cfbe;} .cls-3 {fill: #fff;}</style></defs><title>plotly-logomark</title><g id='symbol'><rect class='cls-1' width='132' height='132' rx='6' ry='6'/><circle class='cls-2' cx='78' cy='54' r='6'/><circle class='cls-2' cx='102' cy='30' r='6'/><circle class='cls-2' cx='78' cy='30' r='6'/><circle class='cls-2' cx='54' cy='30' r='6'/><circle class='cls-2' cx='30' cy='30' r='6'/><circle class='cls-2' cx='30' cy='54' r='6'/><path class='cls-3' d='M30,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,30,72Z'/><path class='cls-3' d='M78,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,78,72Z'/><path class='cls-3' d='M54,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,54,48Z'/><path class='cls-3' d='M102,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,102,48Z'/></g></svg>"}}},{}],638:[function(e,t,a){'use strict';a.isLeftAnchor=function(e){return"left"===e.xanchor||"auto"===e.xanchor&&e.x<=1/3},a.isCenterAnchor=function(e){return"center"===e.xanchor||"auto"===e.xanchor&&e.x>1/3&&e.x<2/3},a.isRightAnchor=function(e){return"right"===e.xanchor||"auto"===e.xanchor&&e.x>=2/3},a.isTopAnchor=function(e){return"top"===e.yanchor||"auto"===e.yanchor&&e.y>=2/3},a.isMiddleAnchor=function(e){return"middle"===e.yanchor||"auto"===e.yanchor&&e.y>1/3&&e.y<2/3},a.isBottomAnchor=function(e){return"bottom"===e.yanchor||"auto"===e.yanchor&&e.y<=1/3}},{}],639:[function(e,t){'use strict';var l=Math.cos,s=Math.sin,d=Math.abs;function o(e){return d(e[1]-e[0])>m-1e-14}function r(e,t){return u(t-e,m)}function i(e,t){if(o(t))return!0;var a,r;t[0]<t[1]?(a=t[0],r=t[1]):(a=t[1],r=t[0]),a=p(a,m),r=p(r,m),a>r&&(r+=m);var i=p(e,m),n=i+m;return i>=a&&i<=r||n>=a&&n<=r}function n(e,t,a,r,i,n,c){function u(e,t){return[e*l(t)+i,n-e*s(t)]}function h(e,t,a){return"A"+[e,e]+" "+[0,w,a]+" "+u(e,t)}i=i||0,n=n||0;var y=o([a,r]),f,x,_,b,v;y?(f=0,x=g,_=m):a<r?(f=a,_=r):(f=r,_=a),e<t?(b=e,v=t):(b=t,v=e);var w=d(_-f)<=g?0:1,k;return y?null===b?k="M"+u(v,f)+h(v,x,0)+h(v,_,0)+"Z":k="M"+u(b,f)+h(b,x,0)+h(b,_,0)+"ZM"+u(v,f)+h(v,x,1)+h(v,_,1)+"Z":null===b?(k="M"+u(v,f)+h(v,_,0),c&&(k+="L0,0Z")):k="M"+u(b,f)+"L"+u(v,f)+h(v,_,0)+"L"+u(b,_)+h(b,f,1)+"Z",k}var c=e("./mod"),p=c.mod,u=c.modHalf,g=Math.PI,m=2*g;t.exports={deg2rad:function(e){return e/180*g},rad2deg:function(e){return 180*(e/g)},angleDelta:r,angleDist:function(e,t){return d(r(e,t))},isFullCircle:o,isAngleInsideSector:i,isPtInsideSector:function(e,t,a,o){if(!i(t,o))return!1;var r,n;return a[0]<a[1]?(r=a[0],n=a[1]):(r=a[1],n=a[0]),e>=r&&e<=n},pathArc:function(e,t,a,o,r){return n(null,e,t,a,o,r,0)},pathSector:function(e,t,a,o,r){return n(null,e,t,a,o,r,1)},pathAnnulus:function(e,t,a,o,r,i){return n(e,t,a,o,r,i,1)}}},{"./mod":664}],640:[function(e,t,a){'use strict';function o(e){return s.isView(e)&&!(e instanceof n)}function r(e){return l(e)||o(e)}function i(e,t,a){if(r(e)){if(r(e[0])){for(var o=a,n=0;n<e.length;n++)o=t(o,e[n].length);return o}return e.length}return 0}var l=Array.isArray,s="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer:{isView:function(){return!1}},n="undefined"==typeof DataView?function(){}:DataView;a.isTypedArray=o,a.isArrayOrTypedArray=r,a.isArray1D=function(e){return!r(e[0])},a.ensureArray=function(e,t){return l(e)||(e=[]),e.length=t,e},a.concat=function(){var e=[],t=!0,a=0,o,r,n,s,d,c,p,u;for(n=0;n<arguments.length;n++)s=arguments[n],c=s.length,c&&(r?e.push(s):(r=s,d=c),l(s)?o=!1:(t=!1,a?o!==s.constructor&&(o=!1):o=s.constructor),a+=c);if(!a)return[];if(!e.length)return r;if(t)return r.concat.apply(r,e);if(o){for(p=new o(a),p.set(r),n=0;n<e.length;n++)s=e[n],p.set(s,d),d+=s.length;return p}for(p=Array(a),u=0;u<r.length;u++)p[u]=r[u];for(n=0;n<e.length;n++){for(s=e[n],u=0;u<s.length;u++)p[d+u]=s[u];d+=u}return p},a.maxRowLength=function(e){return i(e,Math.max,0)},a.minRowLength=function(e){return i(e,Math.min,1/0)}},{}],641:[function(e,t){'use strict';var a=e("fast-isnumeric"),o=e("../constants/numerical").BADNUM;t.exports=function(e){return"string"==typeof e&&(e=e.replace(/^['"%,$#\s']+|[, ]|['"%,$#\s']+$/g,"")),a(e)?+e:o}},{"../constants/numerical":633,"fast-isnumeric":201}],642:[function(e,t){'use strict';t.exports=function(e){var t=e._fullLayout;t._glcanvas&&t._glcanvas.size()&&t._glcanvas.each(function(e){e.regl&&e.regl.clear({color:!0,depth:!0})})}},{}],643:[function(e,t){'use strict';t.exports=function(e){e._responsiveChartHandler&&(window.removeEventListener("resize",e._responsiveChartHandler),delete e._responsiveChartHandler)}},{}],644:[function(e,t,a){'use strict';function o(e,t){var o=a.valObjectMeta[t.valType];if(t.arrayOk&&u(e))return!0;if(o.validateFunction)return o.validateFunction(e,t);var r={},i=r;return o.coerceFunction(e,{set:function(e){i=e}},r,t),i!==r}var r=e("fast-isnumeric"),i=e("tinycolor2"),n=e("../plots/attributes"),l=e("../components/colorscale/scales"),s=e("../constants/interactions").DESELECTDIM,d=e("./nested_property"),c=e("./regex").counter,p=e("./mod").modHalf,u=e("./array").isArrayOrTypedArray;a.valObjectMeta={data_array:{coerceFunction:function(e,t,a){u(e)?t.set(e):a!==void 0&&t.set(a)}},enumerated:{coerceFunction:function(e,t,a,o){o.coerceNumber&&(e=+e),-1===o.values.indexOf(e)?t.set(a):t.set(e)},validateFunction:function(e,t){t.coerceNumber&&(e=+e);for(var a=t.values,o=0,r;o<a.length;o++)if(r=a[o]+"","/"===r.charAt(0)&&"/"===r.charAt(r.length-1)){var n=new RegExp(r.substr(1,r.length-2));if(n.test(e))return!0}else if(e===a[o])return!0;return!1}},boolean:{coerceFunction:function(e,t,a){!0===e||!1===e?t.set(e):t.set(a)}},number:{coerceFunction:function(e,t,a,o){!r(e)||o.min!==void 0&&e<o.min||o.max!==void 0&&e>o.max?t.set(a):t.set(+e)}},integer:{coerceFunction:function(e,t,a,o){e%1||!r(e)||o.min!==void 0&&e<o.min||o.max!==void 0&&e>o.max?t.set(a):t.set(+e)}},string:{coerceFunction:function(e,t,a,o){if("string"!=typeof e){!0!==o.strict&&"number"==typeof e?t.set(e+""):t.set(a)}else o.noBlank&&!e?t.set(a):t.set(e)}},color:{coerceFunction:function(e,t,a){i(e).isValid()?t.set(e):t.set(a)}},colorlist:{coerceFunction:function(e,t,a){Array.isArray(e)&&e.length?e.every(function(e){return i(e).isValid()})?t.set(e):t.set(a):t.set(a)}},colorscale:{coerceFunction:function(e,t,a){t.set(l.get(e,a))}},angle:{coerceFunction:function(e,t,a){"auto"===e?t.set("auto"):r(e)?t.set(p(+e,360)):t.set(a)}},subplotid:{coerceFunction:function(e,t,a,o){var r=o.regex||c(a);return"string"==typeof e&&r.test(e)?void t.set(e):void t.set(a)},validateFunction:function(e,t){var a=t.dflt;return!(e!==a)||!("string"!=typeof e)&&!!c(a).test(e)}},flaglist:{coerceFunction:function(e,t,a,o){if("string"!=typeof e)return void t.set(a);if(-1!==(o.extras||[]).indexOf(e))return void t.set(e);for(var r=e.split("+"),n=0;n<r.length;){var l=r[n];-1===o.flags.indexOf(l)||r.indexOf(l)<n?r.splice(n,1):n++}r.length?t.set(r.join("+")):t.set(a)}},any:{coerceFunction:function(e,t,a){e===void 0?t.set(a):t.set(e)}},info_array:{coerceFunction:function(e,t,o,r){function n(e,t,o){var r;return void 0===o&&(o=t.dflt),a.valObjectMeta[t.valType].coerceFunction(e,{set:function(e){r=e}},o,t),r}var l=2===r.dimensions||"1-2"===r.dimensions&&Array.isArray(e)&&Array.isArray(e[0]);if(!Array.isArray(e))return void t.set(o);var s=r.items,d=[],c=Array.isArray(s),p=c&&l&&Array.isArray(s[0]),u=l&&c&&!p,g=c&&!u?s.length:e.length,m,h,y,f,x,_;if(o=Array.isArray(o)?o:[],l)for(m=0;m<g;m++)for(d[m]=[],y=Array.isArray(e[m])?e[m]:[],x=u?s.length:c?s[m].length:y.length,h=0;h<x;h++)f=u?s[h]:c?s[m][h]:s,_=n(y[h],f,(o[m]||[])[h]),void 0!==_&&(d[m][h]=_);else for(m=0;m<g;m++)_=n(e[m],c?s[m]:s,o[m]),void 0!==_&&(d[m]=_);t.set(d)},validateFunction:function(e,t){if(!Array.isArray(e))return!1;var a=t.items,r=Array.isArray(a),n=2===t.dimensions;if(!t.freeLength&&e.length!==a.length)return!1;for(var l=0;l<e.length;l++)if(n){if(!Array.isArray(e[l])||!t.freeLength&&e[l].length!==a[l].length)return!1;for(var s=0;s<e[l].length;s++)if(!o(e[l][s],r?a[l][s]:a))return!1}else if(!o(e[l],r?a[l]:a))return!1;return!0}}},a.coerce=function(e,t,r,i,n){var l=d(r,i).get(),s=d(e,i),c=d(t,i),p=s.get(),g=t._template;if(void 0===p&&g&&(p=d(g,i).get(),g=0),void 0===n&&(n=l.dflt),l.arrayOk&&u(p))return c.set(p),p;var m=a.valObjectMeta[l.valType].coerceFunction;m(p,c,n,l);var h=c.get();return g&&h===n&&!o(p,l)&&(p=d(g,i).get(),m(p,c,n,l),h=c.get()),h},a.coerce2=function(e,t,o,r,i){var n=d(e,r),l=a.coerce(e,t,o,r,i),s=n.get();return!(s===void 0||null===s)&&l},a.coerceFont=function(e,t,a){var o={};return a=a||{},o.family=e(t+".family",a.family),o.size=e(t+".size",a.size),o.color=e(t+".color",a.color),o},a.coerceHoverinfo=function(e,t,o){var r=t._module.attributes,i=r.hoverinfo?r:n,l=i.hoverinfo,s;if(1===o._dataLength){var d="all"===l.dflt?l.flags.slice():l.dflt.split("+");d.splice(d.indexOf("name"),1),s=d.join("+")}return a.coerce(e,t,i,"hoverinfo",s)},a.coerceSelectionMarkerOpacity=function(e,t){if(e.marker){var a=e.marker.opacity;if(void 0!==a){var o,r;u(a)||e.selected||e.unselected||(o=a,r=s*a),t("selected.marker.opacity",o),t("unselected.marker.opacity",r)}}},a.validate=o},{"../components/colorscale/scales":539,"../constants/interactions":632,"../plots/attributes":702,"./array":640,"./mod":664,"./nested_property":665,"./regex":673,"fast-isnumeric":201,tinycolor2:1309}],645:[function(e,t,a){'use strict';var c=Math.round,p=Math.min,u=Math.floor;function o(e){return e&&A.componentsRegistry.calendars&&"string"==typeof e&&"gregorian"!==e}function r(e,t){return(e+Math.pow(10,t)+"").substr(1)}function i(e,t,a,o,i){if((t||a||o||i)&&(e+=" "+r(t,2)+":"+r(a,2),(o||i)&&(e+=":"+r(o,2),i))){for(var n=4;0==i%10;)n-=1,i/=10;e+="."+r(i,n)}return e}function n(e,t,a,r){e=e.replace(D,function(e){var a=p(+e.charAt(1)||6,6),o=(t/1e3%1+2).toFixed(a).substr(2).replace(/0+$/,"")||"0";return o});var i=new Date(u(t+.05));if(o(r))try{e=A.getComponentMethod("calendars","worldCalFmt")(e,t,r)}catch(t){return"Invalid"}return a(e)(i)}function l(e,t){var a=f(e+.05,b),o=r(u(a/v),2)+":"+r(f(u(a/w),60),2);if("M"!==t){s(t)||(t=0);var i=p(f(e/k,60),O[t]),n=(100+i).toFixed(t).substr(1);0<t&&(n=n.replace(/0+$/,"").replace(/[\.]$/,"")),o+=":"+n}return o}var g=e("d3"),s=e("fast-isnumeric"),d=e("./loggers"),f=e("./mod").mod,x=e("../constants/numerical"),_=x.BADNUM,b=x.ONEDAY,v=x.ONEHOUR,w=x.ONEMIN,k=x.ONESEC,T=x.EPOCHJD,A=e("../registry"),S=g.time.format.utc,C=new Date().getFullYear()-70;a.dateTick0=function(e,t){return o(e)?t?A.getComponentMethod("calendars","CANONICAL_SUNDAY")[e]:A.getComponentMethod("calendars","CANONICAL_TICK")[e]:t?"2000-01-02":"2000-01-01"},a.dfltRange=function(e){return o(e)?A.getComponentMethod("calendars","DFLTRANGE")[e]:["2000-01-01","2001-01-01"]},a.isJSDate=function(e){return"object"==typeof e&&null!==e&&"function"==typeof e.getTime};var L,E;a.dateTime2ms=function(e,t){if(a.isJSDate(e)){var r=e.getTimezoneOffset()*w,i=(e.getUTCMinutes()-e.getMinutes())*w+(e.getUTCSeconds()-e.getSeconds())*k+(e.getUTCMilliseconds()-e.getMilliseconds());if(i){var n=3*w;r=r-n/2+f(i-r+n/2,n)}return e=+e-r,e>=L&&e<=E?e:_}if("string"!=typeof e&&"number"!=typeof e)return _;e+="";var l=o(t),c=e.charAt(0);l&&("G"===c||"g"===c)&&(e=e.substr(1),t="");var p=l&&"chinese"===t.substr(0,7),u=e.match(p?/^\s*(-?\d\d\d\d|\d\d)(-(\d?\di?)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d:?\d\d)?)?)?)?)?\s*$/m:/^\s*(-?\d\d\d\d|\d\d)(-(\d?\d)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d:?\d\d)?)?)?)?)?\s*$/m);if(!u)return _;var g=u[1],h=u[3]||"1",x=+(u[5]||1),d=+(u[7]||0),I=+(u[9]||0),P=+(u[11]||0);if(l){if(2===g.length)return _;g=+g;var S;try{var z=A.getComponentMethod("calendars","getCal")(t);if(p){var D="i"===h.charAt(h.length-1);h=parseInt(h,10),S=z.newDate(g,z.toMonthIndex(g,h,D),x)}else S=z.newDate(g,+h,x)}catch(t){return _}return S?(S.toJD()-T)*b+d*v+I*w+P*k:_}g=2===g.length?(+g+2e3-C)%100+C:+g,h-=1;var O=new Date(Date.UTC(2e3,h,x,d,I));return O.setUTCFullYear(g),O.getUTCMonth()===h?O.getUTCDate()===x?O.getTime()+P*k:_:_},L=a.MIN_MS=a.dateTime2ms("-9999"),E=a.MAX_MS=a.dateTime2ms("9999-12-31 23:59:59.9999"),a.isDateTime=function(e,t){return a.dateTime2ms(e,t)!==_};var I=90*b,P=3*v,z=5*w;a.ms2DateTime=function(e,t,a){if("number"!=typeof e||!(e>=L&&e<=E))return _;t||(t=0);var n=u(10*f(e+.05,1)),l=c(e-n/10),p,g,y,x,C,D;if(o(a)){var O=u(l/b)+T,R=u(f(e,b));try{p=A.getComponentMethod("calendars","getCal")(a).fromJD(O).formatDate("yyyy-mm-dd")}catch(t){p=S("G%Y-%m-%d")(new Date(l))}if("-"===p.charAt(0))for(;11>p.length;)p="-0"+p.substr(1);else for(;10>p.length;)p="0"+p;g=t<I?u(R/v):0,y=t<I?u(R%v/w):0,x=t<P?u(R%w/k):0,C=t<z?10*(R%k)+n:0}else D=new Date(l),p=S("%Y-%m-%d")(D),g=t<I?D.getUTCHours():0,y=t<I?D.getUTCMinutes():0,x=t<P?D.getUTCSeconds():0,C=t<z?10*D.getUTCMilliseconds()+n:0;return i(p,g,y,x,C)},a.ms2DateTimeLocal=function(e){if(!(e>=L+b&&e<=E-b))return _;var t=u(10*f(e+.05,1)),a=new Date(c(e-t/10)),o=g.time.format("%Y-%m-%d")(a),r=a.getHours(),n=a.getMinutes(),l=a.getSeconds(),s=10*a.getUTCMilliseconds()+t;return i(o,r,n,l,s)},a.cleanDate=function(e,t,r){if(e===_)return t;if(a.isJSDate(e)||"number"==typeof e&&isFinite(e)){if(o(r))return d.error("JS Dates and milliseconds are incompatible with world calendars",e),t;if(e=a.ms2DateTimeLocal(+e),!e&&void 0!==t)return t}else if(!a.isDateTime(e,r))return d.error("unrecognized date",e),t;return e};var D=/%\d?f/g,O=[59,59.9,59.99,59.999,59.9999];a.formatDate=function(e,t,a,r,i,s){if(i=o(i)&&i,!t)if("y"===a)t=s.year;else if("m"===a)t=s.month;else if("d"===a)t=s.dayMonth+"\n"+s.year;else return l(e,a)+"\n"+n(s.dayMonthYear,e,r,i);return n(t,e,r,i)};var R=3*b;a.incrementMonth=function(t,e,a){a=o(a)&&a;var r=f(t,b);if(t=c(t-r),a)try{var i=c(t/b)+T,n=A.getComponentMethod("calendars","getCal")(a),l=n.fromJD(i);return e%12?n.add(l,e,"m"):n.add(l,e/12,"y"),(l.toJD()-T)*b+r}catch(o){d.error("invalid ms "+t+" in calendar "+a)}var s=new Date(t+R);return s.setUTCMonth(s.getUTCMonth()+e)+r-R},a.findExactDates=function(e,t){for(var a=0,r=0,n=0,l=0,c=o(t)&&A.getComponentMethod("calendars","getCal")(t),p=0,u,g;p<e.length;p++){if(g=e[p],!s(g)){l++;continue}if(!(g%b))if(c)try{u=c.fromJD(g/b+T),1===u.day()?1===u.month()?a++:r++:n++}catch(t){}else u=new Date(g),1===u.getUTCDate()?0===u.getUTCMonth()?a++:r++:n++}r+=a,n+=r;var m=e.length-l;return{exactYears:a/m,exactMonths:r/m,exactDays:n/m}}},{"../constants/numerical":633,"../registry":788,"./loggers":661,"./mod":664,d3:108,"fast-isnumeric":201}],646:[function(e,t){'use strict';function a(e){var t=e&&e.parentNode;t&&t.removeChild(e)}function o(e,t,a){var o="plotly.js-style-"+e,r=document.getElementById(o);r||(r=document.createElement("style"),r.setAttribute("id",o),r.appendChild(document.createTextNode("")),document.head.appendChild(r));var n=r.sheet;n.insertRule?n.insertRule(t+"{"+a+"}",0):n.addRule?n.addRule(t,a,0):i.warn("addStyleRule failed")}var r=e("d3"),i=e("./loggers");t.exports={getGraphDiv:function(e){var t;if("string"==typeof e){if(t=document.getElementById(e),null===t)throw new Error("No DOM element with id '"+e+"' exists on the page.");return t}if(null===e||void 0===e)throw new Error("DOM element provided is null or undefined");return e},isPlotDiv:function(e){var t=r.select(e);return t.node()instanceof HTMLElement&&t.size()&&t.classed("js-plotly-plot")},removeElement:a,addStyleRule:function(e,t){o("global",e,t)},addRelatedStyleRule:o,deleteRelatedStyleRule:function(e){var t=document.getElementById("plotly.js-style-"+e);t&&a(t)}}},{"./loggers":661,d3:108}],647:[function(e,t){'use strict';var a=e("events").EventEmitter;t.exports={init:function(e){if(e._ev instanceof a)return e;var t=new a,o=new a;return e._ev=t,e._internalEv=o,e.on=t.on.bind(t),e.once=t.once.bind(t),e.removeListener=t.removeListener.bind(t),e.removeAllListeners=t.removeAllListeners.bind(t),e._internalOn=o.on.bind(o),e._internalOnce=o.once.bind(o),e._removeInternalListener=o.removeListener.bind(o),e._removeAllInternalListeners=o.removeAllListeners.bind(o),e.emit=function(a,r){"undefined"!=typeof jQuery&&jQuery(e).trigger(a,r),t.emit(a,r),o.emit(a,r)},e},triggerHandler:function(e,t,a){function o(e){return e.listener?(l.removeListener(t,e.listener),!e.fired)?(e.fired=!0,e.listener.apply(l,[a])):void 0:e.apply(l,[a])}var r,n;"undefined"!=typeof jQuery&&(r=jQuery(e).triggerHandler(t,a));var l=e._ev;if(!l)return r;var s=l._events[t];if(!s)return r;s=Array.isArray(s)?s:[s];var d;for(d=0;d<s.length-1;d++)o(s[d]);return n=o(s[d]),void 0===r?n:r},purge:function(e){return delete e._ev,delete e.on,delete e.once,delete e.removeListener,delete e.removeAllListeners,delete e.emit,delete e._ev,delete e._internalEv,delete e._internalOn,delete e._internalOnce,delete e._removeInternalListener,delete e._removeAllInternalListeners,e}}},{events:1421}],648:[function(e,t,a){'use strict';function o(e,t){var a,o;for(a=0;a<e.length;a++){if(o=e[a],null!==o&&"object"==typeof o)return!1;void 0!==o&&(t[a]=o)}return!0}function r(e,t,a,s){var d=e[0],c=e.length,p,u,g,m,h,y,f;if(2===c&&l(d)&&l(e[1])&&0===d.length){if(f=o(e[1],d),f)return d;d.splice(0,d.length)}for(var x=1;x<c;x++)for(u in p=e[x],p)g=d[u],m=p[u],s&&l(m)?d[u]=m:t&&m&&(n(m)||(h=l(m)))?(h?(h=!1,y=g&&l(g)?g:[]):y=g&&n(g)?g:{},d[u]=r([y,m],t,a,s)):("undefined"!=typeof m||a)&&(d[u]=m);return d}var n=e("./is_plain_object.js"),l=Array.isArray;a.extendFlat=function(){return r(arguments,!1,!1,!1)},a.extendDeep=function(){return r(arguments,!0,!1,!1)},a.extendDeepAll=function(){return r(arguments,!0,!0,!1)},a.extendDeepNoArrays=function(){return r(arguments,!0,!1,!0)}},{"./is_plain_object.js":658}],649:[function(e,t){'use strict';t.exports=function(e){for(var t={},a=[],o=0,r=0,n;r<e.length;r++)n=e[r],1!==t[n]&&(t[n]=1,a[o++]=n);return a}},{}],650:[function(e,t){'use strict';function a(e){return!0===e.visible}function o(e){var t=e[0].trace;return!0===t.visible&&0!==t._length}function r(e){return Array.isArray(e)&&Array.isArray(e[0])&&e[0][0]&&e[0][0].trace}t.exports=function(e){for(var t=r(e)?o:a,n=[],l=0,s;l<e.length;l++)s=e[l],t(s)&&n.push(s);return n}},{}],651:[function(e,t){'use strict';function a(e){var t=e.geojson,a=window.PlotlyGeoAssets||{},o="string"==typeof t?a[t]:t;return m(o)?o:(u.error("Oops ... something went wrong when fetching "+t),!1)}function o(e){var t=e.geometry,a;if("MultiPolygon"===t.type)for(var o=t.coordinates,r=0,n=0;n<o.length;n++){var d={type:"Polygon",coordinates:o[n]},c=l.default(d);c>r&&(r=c,a=d)}else a=t;return s.default(a).geometry.coordinates}var r=e("d3"),n=e("country-regex"),l=e("@turf/area"),s=e("@turf/centroid"),c=e("@turf/bbox"),p=e("./identity"),u=e("./loggers"),m=e("./is_plain_object"),h=e("./nested_property"),y=e("./polygon"),f=Object.keys(n),x={"ISO-3":p,"USA-states":p,"country names":function(e){for(var t=0;t<f.length;t++){var a=f[t],o=new RegExp(n[a]);if(o.test(e.trim().toLowerCase()))return a}return u.log("Unrecognized country name: "+e+"."),!1}};t.exports={locationToFeature:function(e,t,a){if(!t||"string"!=typeof t)return!1;var o=x[e](t),r,n,l;if(o){if("USA-states"===e)for(r=[],l=0;l<a.length;l++)n=a[l],n.properties&&n.properties.gu&&"USA"===n.properties.gu&&r.push(n);else r=a;for(l=0;l<r.length;l++)if(n=r[l],n.id===o)return n;u.log(["Location with id",o,"does not have a matching topojson feature at this resolution."].join(" "))}return!1},feature2polygons:function(e){function t(e){for(var t=0;t<e.length-1;t++)if(0<e[t][0]&&0>e[t+1][0])return t;return null}var a=e.geometry,o=a.coordinates,r=e.id,i=[],n,l,s,d;switch(n="RUS"===r||"FJI"===r?function(e){var a;if(null===t(e))a=e;else for(a=Array(e.length),d=0;d<e.length;d++)a[d]=[0>e[d][0]?e[d][0]+360:e[d][0],e[d][1]];i.push(y.tester(a))}:"ATA"===r?function(e){var a=t(e);if(null===a)return i.push(y.tester(e));var o=Array(e.length+1),r=0;for(d=0;d<e.length;d++)d>a?o[r++]=[e[d][0]+360,e[d][1]]:d===a?(o[r++]=e[d],o[r++]=[e[d][0],-90]):o[r++]=e[d];var n=y.tester(o);n.pts.pop(),i.push(n)}:function(e){i.push(y.tester(e))},a.type){case"MultiPolygon":for(l=0;l<o.length;l++)for(s=0;s<o[l].length;s++)n(o[l][s]);break;case"Polygon":for(l=0;l<o.length;l++)n(o[l]);}return i},getTraceGeojson:a,extractTraceFeature:function(e){function t(e){var t=h(e,r.featureidkey||"id").get(),a=l[t];if(a){var i=e.geometry;if("Polygon"===i.type||"MultiPolygon"===i.type){var n={type:"Feature",id:t,geometry:i,properties:{}};n.properties.ct=o(n),a.fIn=e,a.fOut=n,s.push(n)}else u.log(["Location",a.loc,"does not have a valid GeoJSON geometry.","Traces with locationmode *geojson-id* only support","*Polygon* and *MultiPolygon* geometries."].join(" "))}delete l[t]}var r=e[0].trace,n=a(r);if(!n)return!1;var l={},s=[],d;for(d=0;d<r._length;d++){var c=e[d];(c.loc||0===c.loc)&&(l[c.loc]=c)}switch(n.type){case"FeatureCollection":var p=n.features;for(d=0;d<p.length;d++)t(p[d]);break;case"Feature":t(n);break;default:return u.warn(["Invalid GeoJSON type",(n.type||"none")+".","Traces with locationmode *geojson-id* only support","*FeatureCollection* and *Feature* types."].join(" ")),!1;}for(var g in l)u.log(["Location *"+g+"*","does not have a matching feature with id-key","*"+r.featureidkey+"*."].join(" "));return s},fetchTraceGeoData:function(e){function t(e){return new Promise(function(t,a){r.json(e,function(r,i){if(r){delete o[e];var n=404===r.status?"GeoJSON at URL \""+e+"\" does not exist.":"Unexpected error while fetching from "+e;return a(new Error(n))}return o[e]=i,t(i)})})}function a(e){return new Promise(function(t,a){var r=0,i=setInterval(function(){return o[e]&&"pending"!==o[e]?(clearInterval(i),t(o[e])):100<r?(clearInterval(i),a("Unexpected error while fetching from "+e)):void r++},50)})}for(var o=window.PlotlyGeoAssets||{},n=[],l=0;l<e.length;l++){var s=e[l][0].trace,d=s.geojson;"string"==typeof d&&(o[d]?"pending"===o[d]&&n.push(a(d)):(o[d]="pending",n.push(t(d))))}return n},computeBbox:function(e){return c.default(e)}}},{"./identity":656,"./is_plain_object":658,"./loggers":661,"./nested_property":665,"./polygon":669,"@turf/area":9,"@turf/bbox":10,"@turf/centroid":11,"country-regex":81,d3:108}],652:[function(e,t,a){'use strict';var o=e("../constants/numerical").BADNUM;a.calcTraceToLineCoords=function(e){for(var t=e[0].trace,a=t.connectgaps,r=[],n=[],l=0;l<e.length;l++){var s=e[l],d=s.lonlat;d[0]===o?!a&&0<n.length&&(r.push(n),n=[]):n.push(d)}return 0<n.length&&r.push(n),r},a.makeLine=function(e){return 1===e.length?{type:"LineString",coordinates:e[0]}:{type:"MultiLineString",coordinates:e}},a.makePolygon=function(e){if(1===e.length)return{type:"Polygon",coordinates:e};for(var t=Array(e.length),a=0;a<e.length;a++)t[a]=[e[a]];return{type:"MultiPolygon",coordinates:t}},a.makeBlank=function(){return{type:"Point",coordinates:[]}}},{"../constants/numerical":633}],653:[function(e,t,a){'use strict';var i=Math.sqrt,n=Math.atan,l=Math.abs;function o(o,r,i,n,l,s,p,g){var m=i-o,a=l-o,h=p-l,c=n-r,d=s-r,e=g-s,y=m*e-h*c;if(0===y)return null;var f=(a*e-h*d)/y,t=(a*c-m*d)/y;return 0>t||1<t||0>f||1<f?null:{x:o+m*f,y:r+c*f}}function r(e,t,a,o,r){var i=o*e+r*t;if(0>i)return o*o+r*r;if(i>a){var n=o-e,l=r-t;return n*n+l*l}var s=o*t-r*e;return s*s/a}var s=e("./mod").mod;a.segmentsIntersect=o,a.segmentDistance=function(e,t,a,n,l,s,d,c){if(o(e,t,a,n,l,s,d,c))return 0;var p=a-e,u=n-t,g=d-l,m=c-s,h=p*p+u*u,y=g*g+m*m,f=Math.min(r(p,u,h,l-e,s-t),r(p,u,h,d-e,c-t),r(g,m,y,e-l,t-s),r(g,m,y,a-l,n-s));return i(f)};var d,c,p;a.getTextLocation=function(e,t,a,o){if((e!==c||o!==p)&&(d={},c=e,p=o),d[a])return d[a];var r=e.getPointAtLength(s(a-o/2,t)),i=e.getPointAtLength(s(a+o/2,t)),l=n((i.y-r.y)/(i.x-r.x)),u=e.getPointAtLength(s(a,t)),g=(4*u.x+r.x+i.x)/6,m=(4*u.y+r.y+i.y)/6,h={x:g,y:m,theta:l};return d[a]=h,h},a.clearLocationCache=function(){c=null},a.getVisibleSegment=function(e,t,a){function o(t){var a=e.getPointAtLength(t);0===t?m=a:t===p&&(h=a);var o=a.x<r?r-a.x:a.x>n?a.x-n:0,l=a.y<s?s-a.y:a.y>d?a.y-d:0;return i(o*o+l*l)}for(var r=t.left,n=t.right,s=t.top,d=t.bottom,c=0,p=e.getTotalLength(),u=p,g=o(c),m,h;g;){if(c+=g+a,c>u)return;g=o(c)}for(g=o(u);g;){if(u-=g+a,c>u)return;g=o(u)}return{min:c,max:u,len:u-c,total:p,isClosed:0===c&&u===p&&.1>l(m.x-h.x)&&.1>l(m.y-h.y)}},a.findPointOnPath=function(e,t,a,o){o=o||{};for(var r=o.pathLength||e.getTotalLength(),n=o.tolerance||1e-3,s=o.iterationLimit||30,d=e.getPointAtLength(0)[a]>e.getPointAtLength(r)[a]?-1:1,c=0,p=0,u=r,g,m,h;c<s;){if(g=(p+u)/2,m=e.getPointAtLength(g),h=m[a]-t,l(h)<n)return m;0<d*h?u=g:p=g,c++}return m}},{"./mod":664}],654:[function(e,t){'use strict';function a(e,t){var a=e;return a[3]*=t,a}function o(e){if(i(e))return p;var t=l(e);return t.length?t:p}function r(e){return i(e)?e:1}var i=e("fast-isnumeric"),n=e("tinycolor2"),l=e("color-normalize"),s=e("../components/colorscale"),d=e("../components/color/attributes").defaultLine,c=e("./array").isArrayOrTypedArray,p=l(d);t.exports={formatColor:function(e,t,n){var d=e.color,u=c(d),g=c(t),m=s.extractOpts(e),h=[],y,f,x,_,b;if(y=void 0===m.colorscale?o:s.makeColorScaleFuncFromTrace(e),f=u?function(e,t){return void 0===e[t]?p:l(y(e[t]))}:o,x=g?function(e,t){return void 0===e[t]?1:r(e[t])}:r,u||g)for(var v=0;v<n;v++)_=f(d,v),b=x(t,v),h[v]=a(_,b);else h=a(l(d),t);return h},parseColorScale:function(e,t){t===void 0&&(t=1);var a=s.extractOpts(e),o=a.reversescale?s.flipScale(a.colorscale):a.colorscale;return o.map(function(e){var a=e[0],o=n(e[1]),r=o.toRgb();return{index:a,rgb:[r.r,r.g,r.b,t]}})}}},{"../components/color/attributes":523,"../components/colorscale":536,"./array":640,"color-normalize":67,"fast-isnumeric":201,tinycolor2:1309}],655:[function(e,t){'use strict';function a(e){return[e]}var o=e("./identity");t.exports={keyFun:function(e){return e.key},repeat:a,descend:o,wrap:a,unwrap:function(e){return e[0]}}},{"./identity":656}],656:[function(e,t){'use strict';t.exports=function(e){return e}},{}],657:[function(e,t){'use strict';var r=Math.log,n=Math.cos,l=Math.round,s=Math.PI,d=Math.min,c=Math.pow,p=Math.abs,u=Math.max,g=Math.floor;function a(e){var t={};for(var a in e)for(var o=e[a],r=0;r<o.length;r++)t[o[r]]=+a;return t}function o(e,t,a){var o=this,r=arguments;t||(t={});var i={};return e.replace(_.TEMPLATE_STRING_REGEX,function(e,n,l){var s,d,c;for(c=3;c<r.length;c++)if(s=r[c],s){if(s.hasOwnProperty(n)){d=s[n];break}if(R.test(n)||(d=i[n]||_.nestedProperty(s,n).get(),d&&(i[n]=d)),void 0!==d)break}if(void 0===d&&o)return o.count<o.max&&(_.warn("Variable '"+n+"' in "+o.name+" could not be found!"),d=e),o.count===o.max&&_.warn("Too many "+o.name+" warnings - additional warnings will be suppressed"),o.count++,e;if(l){var p;if(":"===l[0]&&(p=a?a.numberFormat:m.format,d=p(l.replace(B,""))(d)),"|"===l[0]){p=a?a.timeFormat.utc:m.time.format.utc;var u=_.dateTime2ms(d);d=_.formatDate(u,l.replace(B,""),!1,p)}}else t.hasOwnProperty(n+"Label")&&(d=t[n+"Label"]);return d})}var m=e("d3"),i=e("fast-isnumeric"),h=e("../constants/numerical"),y=h.FP_SAFE,f=h.BADNUM,_=t.exports={};_.nestedProperty=e("./nested_property"),_.keyedContainer=e("./keyed_container"),_.relativeAttr=e("./relative_attr"),_.isPlainObject=e("./is_plain_object"),_.toLogRange=e("./to_log_range"),_.relinkPrivateKeys=e("./relink_private");var b=e("./array");_.isTypedArray=b.isTypedArray,_.isArrayOrTypedArray=b.isArrayOrTypedArray,_.isArray1D=b.isArray1D,_.ensureArray=b.ensureArray,_.concat=b.concat,_.maxRowLength=b.maxRowLength,_.minRowLength=b.minRowLength;var v=e("./mod");_.mod=v.mod,_.modHalf=v.modHalf;var w=e("./coerce");_.valObjectMeta=w.valObjectMeta,_.coerce=w.coerce,_.coerce2=w.coerce2,_.coerceFont=w.coerceFont,_.coerceHoverinfo=w.coerceHoverinfo,_.coerceSelectionMarkerOpacity=w.coerceSelectionMarkerOpacity,_.validate=w.validate;var k=e("./dates");_.dateTime2ms=k.dateTime2ms,_.isDateTime=k.isDateTime,_.ms2DateTime=k.ms2DateTime,_.ms2DateTimeLocal=k.ms2DateTimeLocal,_.cleanDate=k.cleanDate,_.isJSDate=k.isJSDate,_.formatDate=k.formatDate,_.incrementMonth=k.incrementMonth,_.dateTick0=k.dateTick0,_.dfltRange=k.dfltRange,_.findExactDates=k.findExactDates,_.MIN_MS=k.MIN_MS,_.MAX_MS=k.MAX_MS;var T=e("./search");_.findBin=T.findBin,_.sorterAsc=T.sorterAsc,_.sorterDes=T.sorterDes,_.distinctVals=T.distinctVals,_.roundUp=T.roundUp,_.sort=T.sort,_.findIndexOfMin=T.findIndexOfMin;var A=e("./stats");_.aggNums=A.aggNums,_.len=A.len,_.mean=A.mean,_.median=A.median,_.midRange=A.midRange,_.variance=A.variance,_.stdev=A.stdev,_.interp=A.interp;var S=e("./matrix");_.init2dArray=S.init2dArray,_.transposeRagged=S.transposeRagged,_.dot=S.dot,_.translationMatrix=S.translationMatrix,_.rotationMatrix=S.rotationMatrix,_.rotationXYMatrix=S.rotationXYMatrix,_.apply2DTransform=S.apply2DTransform,_.apply2DTransform2=S.apply2DTransform2;var C=e("./angles");_.deg2rad=C.deg2rad,_.rad2deg=C.rad2deg,_.angleDelta=C.angleDelta,_.angleDist=C.angleDist,_.isFullCircle=C.isFullCircle,_.isAngleInsideSector=C.isAngleInsideSector,_.isPtInsideSector=C.isPtInsideSector,_.pathArc=C.pathArc,_.pathSector=C.pathSector,_.pathAnnulus=C.pathAnnulus;var L=e("./anchor_utils");_.isLeftAnchor=L.isLeftAnchor,_.isCenterAnchor=L.isCenterAnchor,_.isRightAnchor=L.isRightAnchor,_.isTopAnchor=L.isTopAnchor,_.isMiddleAnchor=L.isMiddleAnchor,_.isBottomAnchor=L.isBottomAnchor;var E=e("./geometry2d");_.segmentsIntersect=E.segmentsIntersect,_.segmentDistance=E.segmentDistance,_.getTextLocation=E.getTextLocation,_.clearLocationCache=E.clearLocationCache,_.getVisibleSegment=E.getVisibleSegment,_.findPointOnPath=E.findPointOnPath;var I=e("./extend");_.extendFlat=I.extendFlat,_.extendDeep=I.extendDeep,_.extendDeepAll=I.extendDeepAll,_.extendDeepNoArrays=I.extendDeepNoArrays;var P=e("./loggers");_.log=P.log,_.warn=P.warn,_.error=P.error;var z=e("./regex");_.counterRegex=z.counter;var D=e("./throttle");_.throttle=D.throttle,_.throttleDone=D.done,_.clearThrottle=D.clear;var O=e("./dom");_.getGraphDiv=O.getGraphDiv,_.isPlotDiv=O.isPlotDiv,_.removeElement=O.removeElement,_.addStyleRule=O.addStyleRule,_.addRelatedStyleRule=O.addRelatedStyleRule,_.deleteRelatedStyleRule=O.deleteRelatedStyleRule,_.clearResponsive=e("./clear_responsive"),_.makeTraceGroups=e("./make_trace_groups"),_._=e("./localize"),_.notifier=e("./notifier"),_.filterUnique=e("./filter_unique"),_.filterVisible=e("./filter_visible"),_.pushUnique=e("./push_unique"),_.cleanNumber=e("./clean_number"),_.ensureNumber=function(e){return i(e)?(e=+e,e<-y||e>y?f:i(e)?+e:f):f},_.isIndex=function(e,t){return!(void 0!==t&&e>=t)&&i(e)&&0<=e&&0==e%1},_.noop=e("./noop"),_.identity=e("./identity"),_.repeat=function(e,t){for(var a=Array(t),o=0;o<t;o++)a[o]=e;return a},_.swapAttrs=function(e,t,a,o){a||(a="x"),o||(o="y");for(var r=0;r<t.length;r++){var n=t[r],l=_.nestedProperty(e,n.replace("?",a)),s=_.nestedProperty(e,n.replace("?",o)),d=l.get();l.set(s.get()),s.set(d)}},_.raiseToTop=function(e){e.parentNode.appendChild(e)},_.cancelTransition=function(e){return e.transition().duration(0)},_.constrain=function(e,t,a){return t>a?u(a,d(t,e)):u(t,d(a,e))},_.bBoxIntersect=function(e,t,a){return a=a||0,e.left<=t.right+a&&t.left<=e.right+a&&e.top<=t.bottom+a&&t.top<=e.bottom+a},_.simpleMap=function(e,t,a,o){for(var r=e.length,n=Array(r),l=0;l<r;l++)n[l]=t(e[l],a,o);return n},_.randstr=function e(t,a,o,n){if(o||(o=16),void 0===a&&(a=24),0>=a)return"0";var l=r(c(2,a))/r(o),s="",d,p,u;for(d=2;l==1/0;d*=2)l=r(c(2,a/d))/r(o)*d;var m=l-g(l);for(d=0;d<g(l);d++)u=g(Math.random()*o).toString(o),s=u+s;m&&(p=c(o,m),u=g(Math.random()*p).toString(o),s=u+s);var h=parseInt(s,o);return t&&t[s]||h!==1/0&&h>=c(2,a)?10<n?(_.warn("randstr failed uniqueness"),s):e(t,a,o,(n||0)+1):s},_.OptionControl=function(e,t){e||(e={}),t||(t="opt");var a={};return a.optionList=[],a._newoption=function(o){o[t]=e,a[o.name]=o,a.optionList.push(o)},a["_"+t]=e,a},_.smooth=function(e,t){if(t=l(t)||0,2>t)return e;var a=e.length,o=2*a,r=2*t-1,d=Array(r),c=Array(a),p,u,m,h;for(p=0;p<r;p++)d[p]=(1-n(s*(p+1)/t))/(2*t);for(p=0;p<a;p++){for(h=0,u=0;u<r;u++)m=p+u+1-t,m<-a?m-=o*l(m/o):m>=o&&(m-=o*g(m/o)),0>m?m=-1-m:m>=a&&(m=o-1-m),h+=e[m]*d[u];c[p]=h}return c},_.syncOrAsync=function(e,t,a){function o(){return _.syncOrAsync(e,t,a)}for(var r,i;e.length;)if(i=e.splice(0,1)[0],r=i(t),r&&r.then)return r.then(o).then(void 0,_.promiseError);return a&&a(t)},_.stripTrailingSlash=function(e){return"/"===e.substr(-1)?e.substr(0,e.length-1):e},_.noneOrAll=function(e,t,a){if(e){var o=!1,r=!0,n,l;for(n=0;n<a.length;n++)l=e[a[n]],void 0!==l&&null!==l?o=!0:r=!1;if(o&&!r)for(n=0;n<a.length;n++)e[a[n]]=t[a[n]]}},_.mergeArray=function(e,t,a,o){if(_.isArrayOrTypedArray(e))for(var r=d(e.length,t.length),n=0,l;n<r;n++)l=e[n],t[n][a]="function"==typeof o?o(l):l},_.mergeArrayCastPositive=function(e,t,a){return _.mergeArray(e,t,a,function(e){var t=+e;return isFinite(t)?0<t?t:0:0})},_.fillArray=function(e,t,a,o){if(o=o||_.identity,_.isArrayOrTypedArray(e))for(var r=0;r<t.length;r++)t[r][a]=o(e[r])},_.castOption=function(e,t,a,o){o=o||_.identity;var r=_.nestedProperty(e,a).get();return _.isArrayOrTypedArray(r)?Array.isArray(t)&&_.isArrayOrTypedArray(r[t[0]])?o(r[t[0]][t[1]]):o(r[t]):r},_.extractOption=function(e,t,a,o){if(a in e)return e[a];var r=_.nestedProperty(t,o).get();if(!Array.isArray(r))return r},_.tagSelected=function(e,t,o){function r(t){return t!==void 0&&t<e.length}var n=t.selectedpoints,l=t._indexToPoints,s;l&&(s=a(l));for(var d=0,c;d<n.length;d++)if(c=n[d],_.isIndex(c)||_.isArrayOrTypedArray(c)&&_.isIndex(c[0])&&_.isIndex(c[1])){var p=s?s[c]:c,u=o?o[p]:p;r(u)&&(e[u].selected=1)}},_.selIndices2selPoints=function(e){var t=e.selectedpoints,o=e._indexToPoints;if(o){for(var r=a(o),n=[],l=0,s;l<t.length;l++)if(s=t[l],_.isIndex(s)){var d=r[s];_.isIndex(d)&&n.push(d)}return n}return t},_.getTargetArray=function(e,t){var a=t.target;if("string"==typeof a&&a){var o=_.nestedProperty(e,a).get();return!!Array.isArray(o)&&o}return!!Array.isArray(a)&&a},_.minExtend=function(e,t){var a={};"object"!=typeof t&&(t={});var o=Object.keys(e),r,n,l;for(r=0;r<o.length;r++)if(n=o[r],l=e[n],"_"===n.charAt(0)||"function"==typeof l)continue;else a[n]="module"===n?l:Array.isArray(l)?"colorscale"===n?l.slice():l.slice(0,3):_.isTypedArray(l)?l.subarray(0,3):l&&"object"==typeof l?_.minExtend(e[n],t[n]):l;for(o=Object.keys(t),r=0;r<o.length;r++)n=o[r],l=t[n],"object"==typeof l&&n in a&&"object"==typeof a[n]||(a[n]=l);return a},_.titleCase=function(e){return e.charAt(0).toUpperCase()+e.substr(1)},_.containsAny=function(e,t){for(var a=0;a<t.length;a++)if(-1!==e.indexOf(t[a]))return!0;return!1},_.isIE=function(){return"undefined"!=typeof window.navigator.msSaveBlob};_.isIE9orBelow=function(){return _.isIE()&&/MSIE [1-9]\./.test(window.navigator.userAgent)};_.isSafari=function(){return /Version\/[\d\.]+.*Safari/.test(window.navigator.userAgent)},_.isD3Selection=function(e){return e&&"function"==typeof e.classed},_.ensureSingle=function(e,t,a,o){var r=e.select(t+(a?"."+a:""));if(r.size())return r;var i=e.append(t);return a&&i.classed(a,!0),o&&i.call(o),i},_.ensureSingleById=function(e,t,a,o){var r=e.select(t+"#"+a);if(r.size())return r;var i=e.append(t).attr("id",a);return o&&i.call(o),i},_.objectFromPath=function(e,t){for(var a=e.split("."),o=n={},r=0,n;r<a.length;r++){var l=a[r],s=null,d=a[r].match(/(.*)\[([0-9]+)\]/);d?(l=d[1],s=d[2],n=n[l]=[],n[s]=r===a.length-1?t:{},n=n[s]):(n[l]=r===a.length-1?t:{},n=n[l])}return o};_.expandObjectPaths=function(e){var t,a,o,r,i,n,l;if("object"==typeof e&&!Array.isArray(e))for(a in e)e.hasOwnProperty(a)&&((t=a.match(/^([^\[\.]+)\.(.+)?/))?(r=e[a],o=t[1],delete e[a],e[o]=_.extendDeepNoArrays(e[o]||{},_.objectFromPath(a,_.expandObjectPaths(r))[o])):(t=a.match(/^([^\.]+)\[([0-9]+)\](\.)?(.+)?/))?(r=e[a],o=t[1],i=parseInt(t[2]),delete e[a],e[o]=e[o]||[],"."===t[3]?(l=t[4],n=e[o][i]=e[o][i]||{},_.extendDeepNoArrays(n,_.objectFromPath(l,_.expandObjectPaths(r)))):e[o][i]=_.expandObjectPaths(r)):e[a]=_.expandObjectPaths(e[a]));return e},_.numSeparate=function(e,t,a){if(a||(a=!1),"string"!=typeof t||0===t.length)throw new Error("Separator string required for formatting!");"number"==typeof e&&(e+="");var o=/(\d+)(\d{3})/,r=t.charAt(0),i=t.charAt(1),n=e.split("."),l=n[0],s=1<n.length?r+n[1]:"";if(i&&(1<n.length||4<l.length||a))for(;o.test(l);)l=l.replace(o,"$1"+i+"$2");return l+s},_.TEMPLATE_STRING_REGEX=/%{([^\s%{}:]*)([:|\|][^}]*)?}/g;var R=/^\w*$/;_.templateString=function(e,t){var a={};return e.replace(_.TEMPLATE_STRING_REGEX,function(e,o){var r;return R.test(o)?r=t[o]:(a[o]=a[o]||_.nestedProperty(t,o).get,r=a[o]()),_.isValidTextValue(r)?r:""})};var M={max:10,count:0,name:"hovertemplate"};_.hovertemplateString=function(){return o.apply(M,arguments)};var j={max:10,count:0,name:"texttemplate"};_.texttemplateString=function(){return o.apply(j,arguments)};var B=/^[:|\|]/,F=48,N=57;_.subplotSort=function(e,t){for(var a=d(e.length,t.length)+1,o=0,r=0,n=0;n<a;n++){var l=e.charCodeAt(n)||0,s=t.charCodeAt(n)||0,c=l>=F&&l<=N,p=s>=F&&s<=N;if(c&&(o=10*o+l-F),p&&(r=10*r+s-F),!c||!p){if(o!==r)return o-r;if(l!==s)return l-s}}return r-o};var V=2e9;_.seedPseudoRandom=function(){V=2e9},_.pseudoRandom=function(){var e=V;return V=(69069*V+1)%4294967296,429496729>p(V-e)?_.pseudoRandom():V/4294967296},_.fillText=function(e,t,a){var o=Array.isArray(a)?function(e){a.push(e)}:function(e){a.text=e},r=_.extractOption(e,t,"htx","hovertext");if(_.isValidTextValue(r))return o(r);var i=_.extractOption(e,t,"tx","text");if(_.isValidTextValue(i))return o(i)},_.isValidTextValue=function(e){return e||0===e},_.formatPercent=function(e,t){t=t||0;for(var a=(l(100*e*c(10,t))*c(.1,t)).toFixed(t)+"%",o=0;o<t;o++)-1!==a.indexOf(".")&&(a=a.replace("0%","%"),a=a.replace(".%","%"));return a},_.isHidden=function(e){var t=window.getComputedStyle(e).display;return!t||"none"===t},_.getTextTransform=function(e){var t=e.noCenter,a=e.textX,o=e.textY,r=e.targetX,i=e.targetY,n=e.anchorX||0,l=e.anchorY||0,s=e.rotate,d=e.scale;return d?1<d&&(d=1):d=0,"translate("+(r-d*(a+n))+","+(i-d*(o+l))+")"+(1>d?"scale("+d+")":"")+(s?"rotate("+s+(t?"":" "+a+" "+o)+")":"")},_.ensureUniformFontSize=function(e,t){var a=_.extendFlat({},t);return a.size=u(t.size,e._fullLayout.uniformtext.minsize||0),a}},{"../constants/numerical":633,"./anchor_utils":638,"./angles":639,"./array":640,"./clean_number":641,"./clear_responsive":643,"./coerce":644,"./dates":645,"./dom":646,"./extend":648,"./filter_unique":649,"./filter_visible":650,"./geometry2d":653,"./identity":656,"./is_plain_object":658,"./keyed_container":659,"./localize":660,"./loggers":661,"./make_trace_groups":662,"./matrix":663,"./mod":664,"./nested_property":665,"./noop":666,"./notifier":667,"./push_unique":671,"./regex":673,"./relative_attr":674,"./relink_private":675,"./search":676,"./stats":679,"./throttle":682,"./to_log_range":683,d3:108,"fast-isnumeric":201}],658:[function(e,t){'use strict';t.exports=function(e){return window&&window.process&&window.process.versions?"[object Object]"===Object.prototype.toString.call(e):"[object Object]"===Object.prototype.toString.call(e)&&Object.getPrototypeOf(e)===Object.prototype}},{}],659:[function(e,t){'use strict';var a=e("./nested_property"),o=1,r=2,n=3,l=4;t.exports=function(e,t,s,d){s=s||"name",d=d||"value";var c={},p,u,g;t&&t.length?(g=a(e,t),u=g.get()):u=e,t=t||"";var m={};if(u)for(p=0;p<u.length;p++)m[u[p][s]]=p;var h=/^\w*$/.test(d),y={set:function(e,t){var o=null===t?l:0;if(!u){if(!g||o===l)return;u=[],g.set(u)}var i=m[e];if(void 0===i){if(o===l)return;o|=n,i=u.length,m[e]=i}else t!==(h?u[i][d]:a(u[i],d).get())&&(o|=r);var p=u[i]=u[i]||{};return p[s]=e,h?p[d]=t:a(p,d).set(t),null!==t&&(o&=~l),c[i]|=o,y},get:function(e){if(u){var t=m[e];return void 0===t?void 0:h?u[t][d]:a(u[t],d).get()}},rename:function(e,t){var a=m[e];return void 0===a?y:(c[a]|=o,m[t]=a,delete m[e],u[a][s]=t,y)},remove:function(e){var t=m[e];if(t===void 0)return y;var o=u[t];if(2<Object.keys(o).length)return c[t]|=r,y.set(e,null);if(h){for(p=t;p<u.length;p++)c[p]|=n;for(p=t;p<u.length;p++)m[u[p][s]]--;u.splice(t,1),delete m[e]}else a(o,d).set(null),c[t]=c[t]|r|l;return y},constructUpdate:function(){for(var e={},n=Object.keys(c),p=0,g,m;p<n.length;p++)m=n[p],g=t+"["+m+"]",u[m]?(c[m]&o&&(e[g+"."+s]=u[m][s]),c[m]&r&&(h?e[g+"."+d]=c[m]&l?null:u[m][d]:e[g+"."+d]=c[m]&l?null:a(u[m],d).get())):e[g]=null;return e}};return y}},{"./nested_property":665}],660:[function(e,t){'use strict';var a=e("../registry");t.exports=function(e,t){for(var o=e._context.locale,r=0,n;2>r;r++){n=e._context.locales;for(var l=0,s;2>l;l++){if(s=(n[o]||{}).dictionary,s){var d=s[t];if(d)return d}n=a.localeRegistry}var c=o.split("-")[0];if(c===o)break;o=c}return t}},{"../registry":788}],661:[function(e,t){'use strict';function a(e,t){if(e&&e.apply)try{return void e.apply(console,t)}catch(t){}for(var a=0;a<t.length;a++)try{e(t[a])}catch(o){console.log(t[a])}}var o=e("../plot_api/plot_config").dfltConfig,r=e("./notifier"),i=t.exports={};i.log=function(){var e;if(1<o.logging){var t=["LOG:"];for(e=0;e<arguments.length;e++)t.push(arguments[e]);a(console.trace||console.log,t)}if(1<o.notifyOnLogging){var n=[];for(e=0;e<arguments.length;e++)n.push(arguments[e]);r(n.join("<br>"),"long")}},i.warn=function(){var e;if(0<o.logging){var t=["WARN:"];for(e=0;e<arguments.length;e++)t.push(arguments[e]);a(console.trace||console.log,t)}if(0<o.notifyOnLogging){var n=[];for(e=0;e<arguments.length;e++)n.push(arguments[e]);r(n.join("<br>"),"stick")}},i.error=function(){var e;if(0<o.logging){var t=["ERROR:"];for(e=0;e<arguments.length;e++)t.push(arguments[e]);a(console.error,t)}if(0<o.notifyOnLogging){var n=[];for(e=0;e<arguments.length;e++)n.push(arguments[e]);r(n.join("<br>"),"stick")}}},{"../plot_api/plot_config":693,"./notifier":667}],662:[function(e,t){'use strict';var a=e("d3");t.exports=function(e,t,o){var r=e.selectAll("g."+o.replace(/\s/g,".")).data(t,function(e){return e[0].trace.uid});r.exit().remove(),r.enter().append("g").attr("class",o),r.order();var i=e.classed("rangeplot")?"nodeRangePlot3":"node3";return r.each(function(e){e[0][i]=a.select(this)}),r}},{d3:108}],663:[function(e,t,o){'use strict';var r=Math.cos,i=Math.sin;o.init2dArray=function(e,t){for(var a=Array(e),o=0;o<e;o++)a[o]=Array(t);return a},o.transposeRagged=function(e){var a=0,o=e.length,r,n;for(r=0;r<o;r++)a=Math.max(a,e[r].length);var l=Array(a);for(r=0;r<a;r++)for(l[r]=Array(o),n=0;n<o;n++)l[r][n]=e[n][r];return l},o.dot=function(e,t){if(!(e.length&&t.length)||e.length!==t.length)return null;var a=e.length,r,n;if(e[0].length)for(r=Array(a),n=0;n<a;n++)r[n]=o.dot(e[n],t);else if(t[0].length){var l=o.transposeRagged(t);for(r=Array(l.length),n=0;n<l.length;n++)r[n]=o.dot(e,l[n])}else for(r=0,n=0;n<a;n++)r+=e[n]*t[n];return r},o.translationMatrix=function(e,t){return[[1,0,e],[0,1,t],[0,0,1]]},o.rotationMatrix=function(e){var t=e*Math.PI/180;return[[r(t),-i(t),0],[i(t),r(t),0],[0,0,1]]},o.rotationXYMatrix=function(e,t,a){return o.dot(o.dot(o.translationMatrix(t,a),o.rotationMatrix(e)),o.translationMatrix(-t,-a))},o.apply2DTransform=function(e){return function(){var t=arguments;3===t.length&&(t=t[0]);var a=1===arguments.length?t[0]:[t[0],t[1]];return o.dot(e,[a[0],a[1],1]).slice(0,2)}},o.apply2DTransform2=function(e){var t=o.apply2DTransform(e);return function(e){return t(e.slice(0,2)).concat(t(e.slice(2,4)))}}},{}],664:[function(e,t){'use strict';t.exports={mod:function(e,t){var a=e%t;return 0>a?a+t:a},modHalf:function(e,t){return Math.abs(e)>t/2?e-Math.round(e/t)*t:e}}},{}],665:[function(e,t){'use strict';function a(e,t){return function(){var o=e,r,n,l,s,d;for(s=0;s<t.length-1;s++){if(r=t[s],-1===r){for(n=!0,l=[],d=0;d<o.length;d++)l[d]=a(o[d],t.slice(s+1))(),l[d]!==l[0]&&(n=!1);return n?l[0]:l}if("number"==typeof r&&!p(o))return;if(o=o[r],"object"!=typeof o||null===o)return}if("object"==typeof o&&null!==o)return l=o[t[s]],null===l?void 0:l}}function o(e,t){return e===void 0||null===e&&!t.match(u)}function r(e,t,a){return function(r){var d=e,c="",u=[[e,c]],g=o(r,a),m,h;for(h=0;h<t.length-1;h++){if(m=t[h],"number"==typeof m&&!p(d))throw"array index but container is not an array";if(-1===m)if(g=!l(d,t.slice(h+1),r,a),g)break;else return;if(!s(d,m,t[h+1],g))break;if(d=d[m],"object"!=typeof d||null===d)throw"container is not an object";c=n(c,m),u.push([d,c])}if(!g)d[t[h]]=r;else if(h===t.length-1&&(delete d[t[h]],Array.isArray(d)&&+t[h]==d.length-1))for(;d.length&&void 0===d[d.length-1];)d.pop()}}function n(e,t){var a=t;return c(t)?a="["+t+"]":e&&(a="."+t),e+a}function l(e,t,a,n){var l=p(a),d=!0,c=a,u=n.replace("-1",0),g=!l&&o(a,u),m=t[0],h;for(h=0;h<e.length;h++)(u=n.replace("-1",h),l&&(c=a[h%a.length],g=o(c,u)),g&&(d=!1),!!s(e,h,m,g))&&r(e[h],t,n.replace("-1",h))(c);return d}function s(e,t,a,o){if(e[t]===void 0){if(o)return!1;e[t]="number"==typeof a?[]:{}}return!0}function d(e,t,a){return{set:function(){throw"bad container"},get:function(){},astr:t,parts:a,obj:e}}var c=e("fast-isnumeric"),p=e("./array").isArrayOrTypedArray;t.exports=function(e,t){if(c(t))t=t+"";else if("string"!=typeof t||"[-1]"===t.substr(t.length-4))throw"bad property string";for(var o=0,n=t.split("."),l,s,p;o<n.length;){if(l=(n[o]+"").match(/^([^\[\]]*)((\[\-?[0-9]*\])+)$/),l){if(l[1])n[o]=l[1];else if(0===o)n.splice(0,1);else throw"bad property string";for(s=l[2].substr(1,l[2].length-2).split("]["),p=0;p<s.length;p++)o++,n.splice(o,0,+s[p])}o++}return"object"==typeof e?{set:r(e,n,t),get:a(e,n),astr:t,parts:n,obj:e}:d(e,t,n)};var u=/(^|\.)args\[/},{"./array":640,"fast-isnumeric":201}],666:[function(e,t){'use strict';t.exports=function(){}},{}],667:[function(e,t){'use strict';var a=e("d3"),o=e("fast-isnumeric"),r=[];t.exports=function(e,t){function n(e){e.duration(700).style("opacity",0).each("end",function(e){var t=r.indexOf(e);-1!==t&&r.splice(t,1),a.select(this).remove()})}if(-1===r.indexOf(e)){r.push(e);var l=1e3;o(t)?l=t:"long"===t&&(l=3e3);var i=a.select("body").selectAll(".plotly-notifier").data([0]);i.enter().append("div").classed("plotly-notifier",!0);var s=i.selectAll(".notifier-note").data(r);s.enter().append("div").classed("notifier-note",!0).style("opacity",0).each(function(e){var o=a.select(this);o.append("button").classed("notifier-close",!0).html("&times;").on("click",function(){o.transition().call(n)});for(var r=o.append("p"),s=e.split(/<br\s*\/?>/g),d=0;d<s.length;d++)d&&r.append("br"),r.append("span").text(s[d]);"stick"===t?o.transition().duration(350).style("opacity",1):o.transition().duration(700).style("opacity",1).transition().delay(l).call(n)})}}},{d3:108,"fast-isnumeric":201}],668:[function(e,t){'use strict';var a=e("./setcursor"),o="data-savedcursor",r="!!";t.exports=function(e,t){var n=e.attr(o);if(t){if(!n){for(var l=(e.attr("class")||"").split(" "),s=0,d;s<l.length;s++)d=l[s],0===d.indexOf("cursor-")&&e.attr(o,d.substr(7)).classed(d,!1);e.attr(o)||e.attr(o,r)}a(e,t)}else n&&(e.attr(o,null),n===r?a(e):a(e,n))}},{"./setcursor":677}],669:[function(e,t){'use strict';var a=Math.min,o=Math.abs,r=Math.max,n=e("./matrix").dot,l=e("../constants/numerical").BADNUM,s=t.exports={};s.tester=function(e){function t(e,t){var a=e[0],o=e[1];return!(a===l||a<s||a>d||o===l||o<c||o>p)&&!(t&&m(e))}function o(e,t){var o=e[0],u=e[1];if(o===l||o<s||o>d||u===l||u<c||u>p)return!1;var g=n.length,m=n[0][0],h=n[0][1],y=0,f,x,_,b,v;for(f=1;f<g;f++)if(x=m,_=h,m=n[f][0],h=n[f][1],b=a(x,m),o<b||o>r(x,m)||u>r(_,h))continue;else if(u<a(_,h))o!==b&&y++;else{if(v=m===x?u:_+(o-x)*(h-_)/(m-x),u===v)return!(1===f&&t);u<=v&&o!==b&&y++}return 1==y%2}var n=e.slice(),s=n[0][0],d=s,c=n[0][1],p=c,u;for(n.push(n[0]),u=1;u<n.length;u++)s=a(s,n[u][0]),d=r(d,n[u][0]),c=a(c,n[u][1]),p=r(p,n[u][1]);var g=!1,m;5===n.length&&(n[0][0]===n[1][0]?n[2][0]===n[3][0]&&n[0][1]===n[3][1]&&n[1][1]===n[2][1]&&(g=!0,m=function(e){return e[0]===n[0][0]}):n[0][1]===n[1][1]&&n[2][1]===n[3][1]&&n[0][0]===n[3][0]&&n[1][0]===n[2][0]&&(g=!0,m=function(e){return e[1]===n[0][1]}));var h=!0,y=n[0];for(u=1;u<n.length;u++)if(y[0]!==n[u][0]||y[1]!==n[u][1]){h=!1;break}return{xmin:s,xmax:d,ymin:c,ymax:p,pts:n,contains:g?t:o,isRect:g,degenerate:h}},s.isSegmentBent=function(e,t,a,r){var l=e[t],s=[e[a][0]-l[0],e[a][1]-l[1]],d=n(s,s),c=Math.sqrt(d),p=[-s[1]/c,s[0]/c],u,g,m;for(u=t+1;u<a;u++)if(g=[e[u][0]-l[0],e[u][1]-l[1]],m=n(g,s),0>m||m>d||o(n(g,p))>r)return!0;return!1},s.filter=function(e,t){function a(a){e.push(a);var l=o.length,d=r;o.splice(n+1);for(var c=d+1;c<e.length;c++)(c===e.length-1||s.isSegmentBent(e,d,c+1,t))&&(o.push(e[c]),o.length<l-2&&(r=c,n=o.length-1),d=c)}var o=[e[0]],r=0,n=0;if(1<e.length){var l=e.pop();a(l)}return{addPt:a,raw:e,filtered:o}}},{"../constants/numerical":633,"./matrix":663}],670:[function(e,t){(function(a){'use strict';var o=e("./show_no_webgl_msg"),r=e("regl");t.exports=function(e,t){var i=e._fullLayout,n=!0;return i._glcanvas.each(function(o){if(!o.regl&&(!o.pick||i._has("parcoords"))){try{o.regl=r({canvas:this,attributes:{antialias:!o.pick,preserveDrawingBuffer:!0},pixelRatio:e._context.plotGlPixelRatio||a.devicePixelRatio,extensions:t||[]})}catch(t){n=!1}o.regl||(n=!1),n&&this.addEventListener("webglcontextlost",function(t){e&&e.emit&&e.emit("plotly_webglcontextlost",{event:t,layer:o.key})},!1)}}),n||o({container:i._glcontainer.node()}),n}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"./show_no_webgl_msg":678,regl:1269}],671:[function(e,t){'use strict';t.exports=function(e,t){if(t instanceof RegExp){for(var a=t.toString(),o=0;o<e.length;o++)if(e[o]instanceof RegExp&&e[o].toString()===a)return e;e.push(t)}else(t||0===t)&&-1===e.indexOf(t)&&e.push(t);return e}},{}],672:[function(e,t){'use strict';function a(e,t){for(var a=[],r=0,n;r<t.length;r++)n=t[r],a[r]=n===e?n:"object"==typeof n?Array.isArray(n)?o.extendDeep([],n):o.extendDeepAll({},n):n;return a}var o=e("../lib"),r=e("../plot_api/plot_config").dfltConfig,n={};n.add=function(e,t,a,o,i){var n,l;return e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:!1},l=e.undoQueue.index,e.autoplay?void(e.undoQueue.inSequence||(e.autoplay=!1)):void(!e.undoQueue.sequence||e.undoQueue.beginSequence?(n={undo:{calls:[],args:[]},redo:{calls:[],args:[]}},e.undoQueue.queue.splice(l,e.undoQueue.queue.length-l,n),e.undoQueue.index+=1):n=e.undoQueue.queue[l-1],e.undoQueue.beginSequence=!1,n&&(n.undo.calls.unshift(t),n.undo.args.unshift(a),n.redo.calls.push(o),n.redo.args.push(i)),e.undoQueue.queue.length>r.queueLength&&(e.undoQueue.queue.shift(),e.undoQueue.index--))},n.startSequence=function(e){e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:!1},e.undoQueue.sequence=!0,e.undoQueue.beginSequence=!0},n.stopSequence=function(e){e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:!1},e.undoQueue.sequence=!1,e.undoQueue.beginSequence=!1},n.undo=function(e){var t,a;if(e.framework&&e.framework.isPolar)return void e.framework.undo();if(!(void 0===e.undoQueue||isNaN(e.undoQueue.index)||0>=e.undoQueue.index)){for(e.undoQueue.index--,t=e.undoQueue.queue[e.undoQueue.index],e.undoQueue.inSequence=!0,a=0;a<t.undo.calls.length;a++)n.plotDo(e,t.undo.calls[a],t.undo.args[a]);e.undoQueue.inSequence=!1,e.autoplay=!1}},n.redo=function(e){var t,a;if(e.framework&&e.framework.isPolar)return void e.framework.redo();if(!(void 0===e.undoQueue||isNaN(e.undoQueue.index)||e.undoQueue.index>=e.undoQueue.queue.length)){for(t=e.undoQueue.queue[e.undoQueue.index],e.undoQueue.inSequence=!0,a=0;a<t.redo.calls.length;a++)n.plotDo(e,t.redo.calls[a],t.redo.args[a]);e.undoQueue.inSequence=!1,e.autoplay=!1,e.undoQueue.index++}},n.plotDo=function(e,t,o){e.autoplay=!0,o=a(e,o),t.apply(null,o)},t.exports=n},{"../lib":657,"../plot_api/plot_config":693}],673:[function(e,t,a){'use strict';a.counter=function(e,t,a,o){var r=(t||"")+(a?"":"$"),i=!1===o?"":"^";return"xy"===e?new RegExp(i+"x([2-9]|[1-9][0-9]+)?y([2-9]|[1-9][0-9]+)?"+r):new RegExp(i+e+"([2-9]|[1-9][0-9]+)?"+r)}},{}],674:[function(e,t){'use strict';t.exports=function(e,t){for(;t;){var a=e.match(/^(.*)(\.[^\.\[\]]+|\[\d\])$/);if(a)e=a[1];else if(e.match(/^[^\.\[\]]+$/))e="";else throw new Error("bad relativeAttr call:"+[e,t]);if("^"===t.charAt(0))t=t.slice(1);else break}return e&&"["!==t.charAt(0)?e+"."+t:e+t}},{}],675:[function(e,t){'use strict';var a=Math.min,o=e("./array").isArrayOrTypedArray,r=e("./is_plain_object");t.exports=function e(t,i){for(var n in i){var l=i[n],s=t[n];if(s!==l)if("_"===n.charAt(0)||"function"==typeof l){if(n in t)continue;t[n]=l}else if(o(l)&&o(s)&&r(l[0])){if("customdata"===n||"ids"===n)continue;for(var d=a(l.length,s.length),c=0;c<d;c++)s[c]!==l[c]&&r(l[c])&&r(s[c])&&e(s[c],l[c])}else r(l)&&r(s)&&(e(s,l),Object.keys(s).length||delete t[n])}}},{"./array":640,"./is_plain_object":658}],676:[function(e,t,a){'use strict';var s=Math.ceil,d=Math.min,p=Math.floor;function o(e,t){return e<t}function r(e,t){return e<=t}function i(e,t){return e>t}function l(e,t){return e>=t}var u=e("fast-isnumeric"),g=e("./loggers"),m=e("./identity"),h=1e-9;a.findBin=function(e,t,a){if(u(t.start))return a?s((e-t.start)/t.size-h)-1:p((e-t.start)/t.size+h);var d=0,m=t.length,y=0,f=1<m?(t[m-1]-t[0])/(m-1):1,x,_;for(_=0<=f?a?o:r:a?l:i,e+=f*h*(a?-1:1)*(0<=f?1:-1);d<m&&100>y++;)x=p((d+m)/2),_(t[x],e)?d=x+1:m=x;return 90<y&&g.log("Long binary search..."),d-1},a.sorterAsc=function(e,t){return e-t},a.sorterDes=function(e,t){return t-e},a.distinctVals=function(e){var t=e.slice();t.sort(a.sorterAsc);for(var o=t.length-1,r=t[o]-t[0]||1,n=r/(o||1)/1e4,l=[t[0]],s=0;s<o;s++)t[s+1]>t[s]+n&&(r=d(r,t[s+1]-t[s]),l.push(t[s+1]));return{vals:l,minDiff:r}},a.roundUp=function(e,t,a){for(var o=0,r=t.length-1,i=0,n=a?0:1,l=a?1:0,d=a?s:p,u;o<r&&100>i++;)u=d((o+r)/2),t[u]<=e?o=u+n:r=u-l;return t[o]},a.sort=function(e,t){for(var a=0,o=0,r=1,n;r<e.length;r++)if(n=t(e[r],e[r-1]),0>n?a=1:0<n&&(o=1),a&&o)return e.sort(t);return o?e:e.reverse()},a.findIndexOfMin=function(e,t){t=t||m;for(var a=1/0,o=0,r,n;o<e.length;o++)n=t(e[o]),n<a&&(a=n,r=o);return r}},{"./identity":656,"./loggers":661,"fast-isnumeric":201}],677:[function(e,t){'use strict';t.exports=function(e,t){(e.attr("class")||"").split(" ").forEach(function(t){0===t.indexOf("cursor-")&&e.classed(t,!1)}),t&&e.classed("cursor-"+t,!0)}},{}],678:[function(e,t){'use strict';var a=e("../components/color"),o=function(){};t.exports=function(e){for(var t in e)"function"==typeof e[t]&&(e[t]=o);e.destroy=function(){e.container.parentNode.removeChild(e.container)};var r=document.createElement("div");r.className="no-webgl",r.style.cursor="pointer",r.style.fontSize="24px",r.style.color=a.defaults[0],r.style.position="absolute",r.style.left=r.style.top="0px",r.style.width=r.style.height="100%",r.style["background-color"]=a.lightLine,r.style["z-index"]=30;var i=document.createElement("p");return i.textContent="WebGL is not supported by your browser - visit https://get.webgl.org for more info",i.style.position="relative",i.style.top="50%",i.style.left="50%",i.style.height="30%",i.style.width="50%",i.style.margin="-15% 0 0 -25%",r.appendChild(i),e.container.appendChild(r),e.container.style.background="#FFFFFF",e.container.onclick=function(){window.open("https://get.webgl.org")},!1}},{"../components/color":524}],679:[function(e,t,o){'use strict';var r=Math.ceil,i=Math.pow,l=Math.floor,s=e("fast-isnumeric"),d=e("./array").isArrayOrTypedArray;o.aggNums=function(e,t,r,n){var l,c;if((!n||n>r.length)&&(n=r.length),s(t)||(t=!1),d(r[0])){for(c=Array(n),l=0;l<n;l++)c[l]=o.aggNums(e,t,r[l]);r=c}for(l=0;l<n;l++)s(t)?s(r[l])&&(t=e(+t,+r[l])):t=r[l];return t},o.len=function(e){return o.aggNums(function(e){return e+1},0,e)},o.mean=function(e,t){return t||(t=o.len(e)),o.aggNums(function(e,t){return e+t},0,e)/t},o.midRange=function(e){return void 0===e||0===e.length?void 0:(o.aggNums(Math.max,null,e)+o.aggNums(Math.min,null,e))/2},o.variance=function(e,t,r){return t||(t=o.len(e)),s(r)||(r=o.mean(e,t)),o.aggNums(function(e,t){return e+i(t-r,2)},0,e)/t},o.stdev=function(e,t,a){return Math.sqrt(o.variance(e,t,a))},o.median=function(e){var t=e.slice().sort();return o.interp(t,.5)},o.interp=function(e,t){if(!s(t))throw"n should be a finite number";if(t=t*e.length-.5,0>t)return e[0];if(t>e.length-1)return e[e.length-1];var a=t%1;return a*e[r(t)]+(1-a)*e[l(t)]}},{"./array":640,"fast-isnumeric":201}],680:[function(e,t){'use strict';var a=e("color-normalize");t.exports=function(e){return e?a(e):[0,0,0,1]}},{"color-normalize":67}],681:[function(e,t,a){'use strict';var p=String.fromCharCode;function o(e,t){return e.node().getBoundingClientRect()[t]}function r(e){return e.replace(y,"\\lt ").replace(f,"\\gt ")}function i(e,t,a){var o,i,n,l;MathJax.Hub.Queue(function(){return i=g.extendDeepAll({},MathJax.Hub.config),n=MathJax.Hub.processSectionDelay,void 0!==MathJax.Hub.processSectionDelay&&(MathJax.Hub.processSectionDelay=0),MathJax.Hub.Config({messageStyle:"none",tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]},displayAlign:"left"})},function(){if(o=MathJax.Hub.config.menuSettings.renderer,"SVG"!==o)return MathJax.Hub.setRenderer("SVG")},function(){var a="math-output-"+g.randstr({},64);return l=u.select("body").append("div").attr({id:a}).style({visibility:"hidden",position:"absolute"}).style({"font-size":t.fontSize+"px"}).text(r(e)),MathJax.Hub.Typeset(l.node())},function(){var t=u.select("body").select("#MathJax_SVG_glyphs");if(l.select(".MathJax_SVG").empty()||!l.select("svg").node())g.log("There was an error in the tex syntax.",e),a();else{var r=l.select("svg").node().getBoundingClientRect();a(l.select(".MathJax_SVG"),t,r)}return(l.remove(),"SVG"!==o)?MathJax.Hub.setRenderer(o):void 0},function(){return void 0!==n&&(MathJax.Hub.processSectionDelay=n),MathJax.Hub.Config(i)})}function n(e,t){if(!e)return null;var a=e.match(t),o=a&&(a[3]||a[4]);return o&&l(o)}function l(e){return e.replace(z,function(e,t){var a;return a="#"===t.charAt(0)?s("x"===t.charAt(1)?parseInt(t.substr(2),16):parseInt(t.substr(1),10)):P[t],a||e})}function s(e){var t=String.fromCodePoint;if(!(1114111<e)){var a=t;if(a)return a(e);var o=p;return 65535>=e?o(e):o((e>>10)+55232,e%1024+56320)}}function d(e,t){function a(){p++;var t=document.createElementNS(m.svg,"tspan");u.select(t).attr({class:"line",dy:p*h+"em"}),e.appendChild(t),f=t;var a=c;if(c=[{node:t}],1<a.length)for(var r=1;r<a.length;r++)o(a[r])}function o(e){var t=e.type,a={},o;if("a"===t){o="a";var i=e.target,n=e.href,l=e.popup;n&&(a={"xlink:xlink:show":"_blank"===i||"_"!==i.charAt(0)?"new":"replace",target:i,"xlink:xlink:href":n},l&&(a.onclick="window.open(this.href.baseVal,this.target.baseVal,\""+l+"\");return false;"))}else o="tspan";e.style&&(a.style=e.style);var s=document.createElementNS(m.svg,o);if("sup"===t||"sub"===t){r(f,"\u200B"),f.appendChild(s);var d=document.createElementNS(m.svg,"tspan");r(d,"\u200B"),u.select(d).attr("dy",b[t]),a.dy=_[t],f.appendChild(s),f.appendChild(d)}else f.appendChild(s);u.select(s).attr(a),f=e.node=s,c.push(e)}function r(e,t){e.appendChild(document.createTextNode(t))}function s(e){if(1===c.length)return void g.log("Ignoring unexpected end tag </"+e+">.",t);var a=c.pop();e!==a.type&&g.log("Start tag <"+a.type+"> doesnt match end tag <"+e+">. Pretending it did match.",t),f=c[c.length-1].node}t=t.replace(w," ");var d=!1,c=[],p=-1,y=A.test(t),f;y?a():(f=e,c=[{node:e}]);for(var P=t.split(k),z=0;z<P.length;z++){var D=P[z],O=D.match(T),R=O&&O[2].toLowerCase(),M=x[R];if("br"===R)a();else if(M===void 0)r(f,l(D));else if(O[1])s(R);else{var j=O[4],B={type:R},F=n(j,S);if(F?(F=F.replace(I,"$1 fill:"),M&&(F+=";"+M)):M&&(F=M),F&&(B.style=F),"a"===R){d=!0;var N=n(j,C);if(N){var V=document.createElement("a");V.href=N,-1!==v.indexOf(V.protocol)&&(B.href=encodeURI(decodeURI(N)),B.target=n(j,L)||"_blank",B.popup=n(j,E))}}o(B)}}return d}function c(e,t,a){var o=a.horizontalAlign,r=a.verticalAlign||"top",i=e.node().getBoundingClientRect(),n=t.node().getBoundingClientRect(),l,s,d;return s="bottom"===r?function(){return i.bottom-l.height}:"middle"===r?function(){return i.top+(i.height-l.height)/2}:function(){return i.top},d="right"===o?function(){return i.right-l.width}:"center"===o?function(){return i.left+(i.width-l.width)/2}:function(){return i.left},function(){return l=this.node().getBoundingClientRect(),this.style({top:s()-n.top+"px",left:d()-n.left+"px","z-index":1e3}),this}}var u=e("d3"),g=e("../lib"),m=e("../constants/xmlns_namespaces"),h=e("../constants/alignment").LINE_SPACING;a.convertToTspans=function(e,t,r){function n(){c.empty()||(p=e.attr("class")+"-math",c.select("svg."+p).remove()),e.text("").style("white-space","pre");var t=d(e.node(),l);t&&e.style("pointer-events","all"),a.positionText(e),r&&r.call(e)}var l=e.text(),s=!e.attr("data-notex")&&"undefined"!=typeof MathJax&&l.match(/([^$]*)([$]+[^$]*[$]+)([^$]*)/),c=u.select(e.node().parentNode);if(!c.empty()){var p=e.attr("class")?e.attr("class").split(" ")[0]:"text";return p+="-math",c.selectAll("svg."+p).remove(),c.selectAll("g."+p+"-group").remove(),e.style("display",null).attr({"data-unformatted":l,"data-math":"N"}),s?(t&&t._promises||[]).push(new Promise(function(t){e.style("display","none");var a=parseInt(e.node().style.fontSize,10);i(s[2],{fontSize:a},function(i,s,d){c.selectAll("svg."+p).remove(),c.selectAll("g."+p+"-group").remove();var u=i&&i.select("svg");if(!u||!u.node())return n(),void t();var m=c.append("g").classed(p+"-group",!0).attr({"pointer-events":"none","data-unformatted":l,"data-math":"Y"});m.node().appendChild(u.node()),s&&s.node()&&u.node().insertBefore(s.node().cloneNode(!0),u.node().firstChild),u.attr({class:p,height:d.height,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});var h=e.node().style.fill||"black",y=u.select("g");y.attr({fill:h,stroke:h});var g=o(y,"width"),f=o(y,"height"),x=+e.attr("x")-g*{start:0,middle:.5,end:1}[e.attr("text-anchor")||"start"],_=a||o(e,"height"),b=-_/4;"y"===p[0]?(m.attr({transform:"rotate("+[-90,+e.attr("x"),+e.attr("y")]+") translate("+[-g/2,b-f/2]+")"}),u.attr({x:+e.attr("x"),y:+e.attr("y")})):"l"===p[0]?u.attr({x:e.attr("x"),y:b-f/2}):"a"===p[0]&&0!==p.indexOf("atitle")?u.attr({x:0,y:b}):u.attr({x:x,y:+e.attr("y")+b-f/2}),r&&r.call(e,m),t(m)})})):n(),e}};var y=/(<|&lt;|&#60;)/g,f=/(>|&gt;|&#62;)/g,x={sup:"font-size:70%",sub:"font-size:70%",b:"font-weight:bold",i:"font-style:italic",a:"cursor:pointer",span:"",em:"font-style:italic;font-weight:bold"},_={sub:"0.3em",sup:"-0.6em"},b={sub:"-0.21em",sup:"0.42em"},v=["http:","https:","mailto:","",void 0,":"],w=a.NEWLINES=/(\r\n?|\n)/g,k=/(<[^<>]*>)/,T=/<(\/?)([^ >]*)(\s+(.*))?>/i,A=/<br(\s+.*)?>/i;a.BR_TAG_ALL=/<br(\s+.*)?>/gi;var S=/(^|[\s"'])style\s*=\s*("([^"]*);?"|'([^']*);?')/i,C=/(^|[\s"'])href\s*=\s*("([^"]*)"|'([^']*)')/i,L=/(^|[\s"'])target\s*=\s*("([^"\s]*)"|'([^'\s]*)')/i,E=/(^|[\s"'])popup\s*=\s*("([\w=,]*)"|'([\w=,]*)')/i,I=/(^|;)\s*color:/;a.plainText=function(e,t){t=t||{};for(var a=t.len!==void 0&&-1!==t.len?t.len:1/0,o=t.allowedTags===void 0?["br"]:t.allowedTags,r="...",n=r.length,s=e.split(k),d=[],c="",u=0,g=0;g<s.length;g++){var m=s[g],p=m.match(T),h=p&&p[2].toLowerCase();if(h)-1!==o.indexOf(h)&&(d.push(m),c=h);else{var y=m.length;if(u+y<a)d.push(m),u+=y;else if(u<a){var f=a-u;c&&("br"!==c||f<=n||y<=n)&&d.pop(),a>n?d.push(m.substr(0,f-n)+r):d.push(m.substr(0,f));break}c=""}}return d.join("")};var P={mu:"\u03BC",amp:"&",lt:"<",gt:">",nbsp:"\xA0",times:"\xD7",plusmn:"\xB1",deg:"\xB0"},z=/&(#\d+|#x[\da-fA-F]+|[a-z]+);/g;a.convertEntities=l,a.sanitizeHTML=function(e){e=e.replace(w," ");for(var t=document.createElement("p"),a=t,o=[],r=e.split(k),s=0;s<r.length;s++){var d=r[s],c=d.match(T),p=c&&c[2].toLowerCase();if(!(p in x))a.appendChild(document.createTextNode(l(d)));else if(c[1])o.length&&(a=o.pop());else{var g=c[4],m=n(g,S),h=m?{style:m}:{};if("a"===p){var y=n(g,C);if(y){var f=document.createElement("a");if(f.href=y,-1!==v.indexOf(f.protocol)){h.href=encodeURI(decodeURI(y));var _=n(g,L);_&&(h.target=_)}}}var b=document.createElement(p);a.appendChild(b),u.select(b).attr(h),a=b,o.push(b)}}return t.innerHTML},a.lineCount=function(e){return e.selectAll("tspan.line").size()||1},a.positionText=function(e,t,a){return e.each(function(){function e(e,t){return void 0===t?(t=o.attr(e),null===t&&(o.attr(e,0),t=0)):o.attr(e,t),t}var o=u.select(this),r=e("x",t),i=e("y",a);"text"===this.nodeName&&o.selectAll("tspan.line").attr({x:r,y:i})})},a.makeEditable=function(e,t){function a(){r(),e.style({opacity:0});var t=s.attr("class"),a;a=t?"."+t.split(" ")[0]+"-math-group":"[class*=-math-group]",a&&u.select(e.node().parentNode).select(a).style({opacity:0})}function o(e){var t=e.node(),a=document.createRange();a.selectNodeContents(t);var o=window.getSelection();o.removeAllRanges(),o.addRange(a),t.focus()}function r(){var a=u.select(i),r=a.select(".svg-container"),n=r.append("div"),s=e.node().style,d=parseFloat(s.fontSize||12),p=t.text;void 0===p&&(p=e.attr("data-unformatted")),n.classed("plugin-editable editable",!0).style({position:"absolute","font-family":s.fontFamily||"Arial","font-size":d,color:t.fill||s.fill||"black",opacity:1,"background-color":t.background||"transparent",outline:"#ffffff33 1px solid",margin:[-d/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:!0}).text(p).call(c(e,r,t)).on("blur",function(){i._editing=!1,e.text(this.textContent).style({opacity:1});var t=u.select(this).attr("class"),a;a=t?"."+t.split(" ")[0]+"-math-group":"[class*=-math-group]",a&&u.select(e.node().parentNode).select(a).style({opacity:0});var o=this.textContent;u.select(this).transition().duration(0).remove(),u.select(document).on("mouseup",null),l.edit.call(e,o)}).on("focus",function(){var e=this;i._editing=!0,u.select(document).on("mouseup",function(){return u.event.target!==e&&void(document.activeElement===n.node()&&n.node().blur())})}).on("keyup",function(){27===u.event.which?(i._editing=!1,e.style({opacity:1}),u.select(this).style({opacity:0}).on("blur",function(){return!1}).transition().remove(),l.cancel.call(e,this.textContent)):(l.input.call(e,this.textContent),u.select(this).call(c(e,r,t)))}).on("keydown",function(){13===u.event.which&&this.blur()}).call(o)}var i=t.gd,n=t.delegate,l=u.dispatch("edit","input","cancel"),s=n||e;if(e.style({"pointer-events":n?"none":"all"}),1!==e.size())throw new Error("boo");return t.immediate?a():s.on("click",a),u.rebind(e,l,"on")}},{"../constants/alignment":626,"../constants/xmlns_namespaces":634,"../lib":657,d3:108}],682:[function(e,t,a){'use strict';function o(e){e&&null!==e.timer&&(clearTimeout(e.timer),e.timer=null)}var r={};a.throttle=function(e,t,a){function i(){a(),n.ts=Date.now(),n.onDone&&(n.onDone(),n.onDone=null)}var n=r[e],l=Date.now();if(!n){for(var s in r)r[s].ts<l-6e4&&delete r[s];n=r[e]={ts:0,timer:null}}return o(n),l>n.ts+t?void i():void(n.timer=setTimeout(function(){i(),n.timer=null},t))},a.done=function(e){var t=r[e];return t&&t.timer?new Promise(function(e){var a=t.onDone;t.onDone=function(){a&&a(),e(),t.onDone=null}}):Promise.resolve()},a.clear=function(e){if(e)o(r[e]),delete r[e];else for(var t in r)a.clear(t)}},{}],683:[function(e,t){'use strict';var a=Math.LN10,o=Math.log,r=Math.min,i=Math.max,n=e("fast-isnumeric");t.exports=function(e,t){if(0<e)return o(e)/a;var l=o(r(t[0],t[1]))/a;return n(l)||(l=o(i(t[0],t[1]))/a-6),l}},{"fast-isnumeric":201}],684:[function(e,t){'use strict';var a=t.exports={},o=e("../plots/geo/constants").locationmodeToLayer,r=e("topojson-client").feature;a.getTopojsonName=function(e){return[e.scope.replace(/ /g,"-"),"_",e.resolution.toString(),"m"].join("")},a.getTopojsonPath=function(e,t){return e+t+".json"},a.getTopojsonFeatures=function(e,t){var a=o[e.locationmode],i=t.objects[a];return r(t,i).features}},{"../plots/geo/constants":735,"topojson-client":1312}],685:[function(e,t){'use strict';t.exports={moduleType:"locale",name:"en-US",dictionary:{"Click to enter Colorscale title":"Click to enter Colorscale title"},format:{date:"%m/%d/%Y"}}},{}],686:[function(e,t){'use strict';t.exports={moduleType:"locale",name:"en",dictionary:{"Click to enter Colorscale title":"Click to enter Colourscale title"},format:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],periods:["AM","PM"],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",decimal:".",thousands:",",grouping:[3],currency:["$",""],year:"%Y",month:"%b %Y",dayMonth:"%b %-d",dayMonthYear:"%b %-d, %Y"}}},{}],687:[function(e,t){'use strict';var a=e("../registry");t.exports=function(e){for(var t=a.layoutArrayContainers,o=a.layoutArrayRegexes,r=e.split("[")[0],n=0,l,s;n<o.length;n++)if(s=e.match(o[n]),s&&0===s.index){l=s[0];break}if(l||(l=t[t.indexOf(r)]),!l)return!1;var d=e.substr(l.length);return d?(s=d.match(/^\[(0|[1-9][0-9]*)\](\.(.+))?$/),!!s&&{array:l,index:+s[1],property:s[3]||""}):{array:l,index:"",property:""}}},{"../registry":788}],688:[function(e,t){'use strict';function a(e){for(var t={},a=0;a<e.length;a++)t[e[a]]=!1;return t}function o(e,t,a){var o=n({},e);for(var i in o){var s=o[i];l(s)&&(o[i]=r(s,t,a,i))}return"from-root"===a&&(o.editType=t),o}function r(e,t,a,l){if(e.valType){var s=n({},e);if(s.editType=t,Array.isArray(e.items)){s.items=Array(e.items.length);for(var d=0;d<e.items.length;d++)s.items[d]=r(e.items[d],t,"from-root")}return s}return o(e,t,"_"===l.charAt(0)?"nested":"from-root")}var i=e("../lib"),n=i.extendFlat,l=i.isPlainObject,s={valType:"flaglist",extras:["none"],flags:["calc","clearAxisTypes","plot","style","markerSize","colorbars"]},d={valType:"flaglist",extras:["none"],flags:["calc","plot","legend","ticks","axrange","layoutstyle","modebar","camera","arraydraw","colorbars"]},c=s.flags.slice().concat(["fullReplot"]),p=d.flags.slice().concat("layoutReplot");t.exports={traces:s,layout:d,traceFlags:function(){return a(c)},layoutFlags:function(){return a(p)},update:function(e,t){var a=t.editType;if(a&&"none"!==a)for(var o=a.split("+"),r=0;r<o.length;r++)e[o[r]]=!0},overrideAll:o}},{"../lib":657}],689:[function(e,t,a){'use strict';function o(e,t){var a=e[t],o=t.charAt(0);a&&"paper"!==a&&(e[t]=f(a,o))}function r(e){function t(t,a){var o=e[t],r=e.title&&e.title[a];o&&!r&&(!e.title&&(e.title={}),e.title[a]=e[t],delete e[t])}e&&(("string"==typeof e.title||"number"==typeof e.title)&&(e.title={text:e.title}),t("titlefont","font"),t("titleposition","position"),t("titleside","side"),t("titleoffset","offset"))}function i(e){if(!g.isPlainObject(e))return!1;var t=e.name;return delete e.name,delete e.showlegend,("string"==typeof t||"number"==typeof t)&&t+""}function n(e,t,a,o){if(a&&!o)return e;if(o&&!a)return t;if(!e.trim())return t;if(!t.trim())return e;var r=Math.min(e.length,t.length),n;for(n=0;n<r&&!(e.charAt(n)!==t.charAt(n));n++);var l=e.substr(0,n);return l.trim()}function l(e){var t="middle",a="center";return"string"==typeof e&&(-1===e.indexOf("top")?-1!==e.indexOf("bottom")&&(t="bottom"):t="top",-1===e.indexOf("left")?-1!==e.indexOf("right")&&(a="right"):a="left"),t+" "+a}function s(e,t){return t in e&&"object"==typeof e[t]&&0===Object.keys(e[t]).length}function d(e){var t=e.search(b);if(0<t)return e.substr(0,t)}var c=e("fast-isnumeric"),p=e("gl-mat4/fromQuat"),u=e("../registry"),g=e("../lib"),m=e("../plots/plots"),h=e("../plots/cartesian/axis_ids"),y=e("../components/color"),f=h.cleanId,x=h.getFromTrace,_=u.traceIs;a.clearPromiseQueue=function(e){Array.isArray(e._promises)&&0<e._promises.length&&g.log("Clearing previous rejected promises from queue."),e._promises=[]},a.cleanLayout=function(e){var t,n;e||(e={}),e.xaxis1&&(!e.xaxis&&(e.xaxis=e.xaxis1),delete e.xaxis1),e.yaxis1&&(!e.yaxis&&(e.yaxis=e.yaxis1),delete e.yaxis1),e.scene1&&(!e.scene&&(e.scene=e.scene1),delete e.scene1);var l=(m.subplotsRegistry.cartesian||{}).attrRegex,d=(m.subplotsRegistry.polar||{}).attrRegex,c=(m.subplotsRegistry.ternary||{}).attrRegex,u=(m.subplotsRegistry.gl3d||{}).attrRegex,h=Object.keys(e);for(t=0;t<h.length;t++){var x=h[t];if(l&&l.test(x)){var _=e[x];_.anchor&&"free"!==_.anchor&&(_.anchor=f(_.anchor)),_.overlaying&&(_.overlaying=f(_.overlaying)),_.type||(_.isdate?_.type="date":_.islog?_.type="log":!1===_.isdate&&!1===_.islog&&(_.type="linear")),("withzero"===_.autorange||"tozero"===_.autorange)&&(_.autorange=!0,_.rangemode="tozero"),delete _.islog,delete _.isdate,delete _.categories,s(_,"domain")&&delete _.domain,void 0!==_.autotick&&(void 0===_.tickmode&&(_.tickmode=_.autotick?"auto":"linear"),delete _.autotick),r(_)}else if(d&&d.test(x)){var b=e[x];r(b.radialaxis)}else if(c&&c.test(x)){var v=e[x];r(v.aaxis),r(v.baxis),r(v.caxis)}else if(u&&u.test(x)){var w=e[x],k=w.cameraposition;if(Array.isArray(k)&&4===k[0].length){var T=k[0],A=k[1],S=k[2],C=p([],T),L=[];for(n=0;3>n;++n)L[n]=A[n]+S*C[2+4*n];w.camera={eye:{x:L[0],y:L[1],z:L[2]},center:{x:A[0],y:A[1],z:A[2]},up:{x:0,y:0,z:1}},delete w.cameraposition}r(w.xaxis),r(w.yaxis),r(w.zaxis)}}var E=Array.isArray(e.annotations)?e.annotations.length:0;for(t=0;t<E;t++){var I=e.annotations[t];g.isPlainObject(I)&&(I.ref&&("paper"===I.ref?(I.xref="paper",I.yref="paper"):"data"===I.ref&&(I.xref="x",I.yref="y"),delete I.ref),o(I,"xref"),o(I,"yref"))}var P=Array.isArray(e.shapes)?e.shapes.length:0;for(t=0;t<P;t++){var z=e.shapes[t];g.isPlainObject(z)&&(o(z,"xref"),o(z,"yref"))}var D=e.legend;return D&&(3<D.x?(D.x=1.02,D.xanchor="left"):-2>D.x&&(D.x=-.02,D.xanchor="right"),3<D.y?(D.y=1.02,D.yanchor="bottom"):-2>D.y&&(D.y=-.02,D.yanchor="top")),r(e),"rotate"===e.dragmode&&(e.dragmode="orbit"),y.clean(e),e.template&&e.template.layout&&a.cleanLayout(e.template.layout),e},a.cleanData=function(e){for(var t=0;t<e.length;t++){var o=e[t],d;if("histogramy"===o.type&&"xbins"in o&&!("ybins"in o)&&(o.ybins=o.xbins,delete o.xbins),o.error_y&&"opacity"in o.error_y){var c=y.defaults,p=o.error_y.color||(_(o,"bar")?y.defaultLine:c[t%c.length]);o.error_y.color=y.addOpacity(y.rgb(p),y.opacity(p)*o.error_y.opacity),delete o.error_y.opacity}if("bardir"in o&&("h"===o.bardir&&(_(o,"bar")||"histogram"===o.type.substr(0,9))&&(o.orientation="h",a.swapXYData(o)),delete o.bardir),"histogramy"===o.type&&a.swapXYData(o),("histogramx"===o.type||"histogramy"===o.type)&&(o.type="histogram"),"scl"in o&&!("colorscale"in o)&&(o.colorscale=o.scl,delete o.scl),"reversescl"in o&&!("reversescale"in o)&&(o.reversescale=o.reversescl,delete o.reversescl),o.xaxis&&(o.xaxis=f(o.xaxis,"x")),o.yaxis&&(o.yaxis=f(o.yaxis,"y")),_(o,"gl3d")&&o.scene&&(o.scene=m.subplotsRegistry.gl3d.cleanId(o.scene)),!_(o,"pie-like")&&!_(o,"bar-like"))if(Array.isArray(o.textposition))for(d=0;d<o.textposition.length;d++)o.textposition[d]=l(o.textposition[d]);else o.textposition&&(o.textposition=l(o.textposition));var h=u.getModule(o);if(h&&h.colorbar){var x=h.colorbar.container,b=x?o[x]:o;b&&b.colorscale&&("YIGnBu"===b.colorscale&&(b.colorscale="YlGnBu"),"YIOrRd"===b.colorscale&&(b.colorscale="YlOrRd"))}if("surface"===o.type&&g.isPlainObject(o.contours)){var v=["x","y","z"];for(d=0;d<v.length;d++){var w=o.contours[v[d]];g.isPlainObject(w)&&(w.highlightColor&&(w.highlightcolor=w.highlightColor,delete w.highlightColor),w.highlightWidth&&(w.highlightwidth=w.highlightWidth,delete w.highlightWidth))}}if("candlestick"===o.type||"ohlc"===o.type){var k=!1!==(o.increasing||{}).showlegend,T=!1!==(o.decreasing||{}).showlegend,A=i(o.increasing),S=i(o.decreasing);if(!1!==A&&!1!==S){var C=n(A,S,k,T);C&&(o.name=C)}else(A||S)&&!o.name&&(o.name=A||S)}if(Array.isArray(o.transforms)){var L=o.transforms;for(d=0;d<L.length;d++){var E=L[d];if(g.isPlainObject(E))switch(E.type){case"filter":E.filtersrc&&(E.target=E.filtersrc,delete E.filtersrc),E.calendar&&(!E.valuecalendar&&(E.valuecalendar=E.calendar),delete E.calendar);break;case"groupby":if(E.styles=E.styles||E.style,E.styles&&!Array.isArray(E.styles)){var I=E.styles,P=Object.keys(I);E.styles=[];for(var z=0;z<P.length;z++)E.styles.push({target:P[z],value:I[P[z]]})}}}}s(o,"line")&&delete o.line,"marker"in o&&(s(o.marker,"line")&&delete o.marker.line,s(o,"marker")&&delete o.marker),y.clean(o),o.autobinx&&(delete o.autobinx,delete o.xbins),o.autobiny&&(delete o.autobiny,delete o.ybins),r(o),o.colorbar&&r(o.colorbar),o.marker&&o.marker.colorbar&&r(o.marker.colorbar),o.line&&o.line.colorbar&&r(o.line.colorbar),o.aaxis&&r(o.aaxis),o.baxis&&r(o.baxis)}},a.swapXYData=function(e){var t;if(g.swapAttrs(e,["?","?0","d?","?bins","nbins?","autobin?","?src","error_?"]),Array.isArray(e.z)&&Array.isArray(e.z[0])&&(e.transpose?delete e.transpose:e.transpose=!0),e.error_x&&e.error_y){var a=e.error_y,o="copy_ystyle"in a?a.copy_ystyle:!(a.color||a.thickness||a.width);g.swapAttrs(e,["error_?.copy_ystyle"]),o&&g.swapAttrs(e,["error_?.color","error_?.thickness","error_?.width"])}if("string"==typeof e.hoverinfo){var r=e.hoverinfo.split("+");for(t=0;t<r.length;t++)"x"===r[t]?r[t]="y":"y"===r[t]&&(r[t]="x");e.hoverinfo=r.join("+")}},a.coerceTraceIndices=function(e,t){if(c(t))return[t];if(!Array.isArray(t)||!t.length)return e.data.map(function(e,t){return t});if(Array.isArray(t)){for(var a=[],o=0;o<t.length;o++)g.isIndex(t[o],e.data.length)?a.push(t[o]):g.warn("trace index (",t[o],") is not a number or is out of bounds");return a}return t},a.manageArrayContainers=function(e,t,a){var o=e.obj,r=e.parts,i=r.length,n=r[i-1],l=c(n);if(l&&null===t){var s=r.slice(0,i-1).join("."),d=g.nestedProperty(o,s).get();d.splice(n,1)}else l&&void 0===e.get()?(void 0===e.get()&&(a[e.astr]=null),e.set(t)):e.set(t)};var b=/(\.[^\[\]\.]+|\[[^\[\]\.]+\])$/;a.hasParent=function(e,t){for(var a=d(t);a;){if(a in e)return!0;a=d(a)}return!1};var v=["x","y","z"];a.clearAxisTypes=function(e,t,a){for(var o=0,r;o<t.length;o++){r=e._fullData[o];for(var n=0,l;3>n;n++)if(l=x(e,r,v[n]),l&&"log"!==l.type){var s=l._name,d=l._id.substr(1);if("scene"===d.substr(0,5)){if(void 0!==a[d])continue;s=d+"."+s}var c=s+".type";void 0===a[s]&&void 0===a[c]&&g.nestedProperty(e.layout,c).set(null)}}}},{"../components/color":524,"../lib":657,"../plots/cartesian/axis_ids":708,"../plots/plots":768,"../registry":788,"fast-isnumeric":201,"gl-mat4/fromQuat":239}],690:[function(e,t,a){'use strict';var o=e("./plot_api");a.plot=o.plot,a.newPlot=o.newPlot,a.restyle=o.restyle,a.relayout=o.relayout,a.redraw=o.redraw,a.update=o.update,a._guiRestyle=o._guiRestyle,a._guiRelayout=o._guiRelayout,a._guiUpdate=o._guiUpdate,a._storeDirectGUIEdit=o._storeDirectGUIEdit,a.react=o.react,a.extendTraces=o.extendTraces,a.prependTraces=o.prependTraces,a.addTraces=o.addTraces,a.deleteTraces=o.deleteTraces,a.moveTraces=o.moveTraces,a.purge=o.purge,a.addFrames=o.addFrames,a.deleteFrames=o.deleteFrames,a.animate=o.animate,a.setPlotConfig=o.setPlotConfig,a.toImage=e("./to_image"),a.validate=e("./validate"),a.downloadImage=e("../snapshot/download");var r=e("./template_api");a.makeTemplate=r.makeTemplate,a.validateTemplate=r.validateTemplate},{"../snapshot/download":790,"./plot_api":692,"./template_api":697,"./to_image":698,"./validate":699}],691:[function(e,t,a){'use strict';var o=Math.max,r=e("../lib/is_plain_object"),n=e("../lib/noop"),l=e("../lib/loggers"),s=e("../lib/search").sorterAsc,d=e("../registry");a.containerArrayMatch=e("./container_array_match");var c=a.isAddVal=function(e){return"add"===e||r(e)},p=a.isRemoveVal=function(e){return null===e||"remove"===e};a.applyContainerArrayChanges=function(e,t,a,r,u){var g=t.astr,m=d.getComponentMethod(g,"supplyLayoutDefaults"),h=d.getComponentMethod(g,"draw"),y=d.getComponentMethod(g,"drawOne"),f=r.replot||r.recalc||m===n||h===n,x=e.layout,_=e._fullLayout;if(a[""]){1<Object.keys(a).length&&l.warn("Full array edits are incompatible with other edits",g);var b=a[""][""];if(p(b))t.set(null);else if(Array.isArray(b))t.set(b);else return l.warn("Unrecognized full array edit value",g,b),!0;return!f&&(m(x,_),h(e),!0)}var v=Object.keys(a).map(Number).sort(s),w=t.get(),k=w||[],T=u(_,g).get(),A=[],S=-1,C=k.length,L,E,I,P,z,D,O,R;for(L=0;L<v.length;L++){if(I=v[L],P=a[I],z=Object.keys(P),D=P[""],O=c(D),0>I||I>k.length-(O?0:1)){l.warn("index out of range",g,I);continue}if(void 0!==D)1<z.length&&l.warn("Insertion & removal are incompatible with edits to the same index.",g,I),p(D)?A.push(I):O?("add"===D&&(D={}),k.splice(I,0,D),T&&T.splice(I,0,{})):l.warn("Unrecognized full object edit value",g,I,D),-1===S&&(S=I);else for(E=0;E<z.length;E++)R=g+"["+I+"].",u(k[I],z[E],R).set(P[z[E]])}for(L=A.length-1;0<=L;L--)k.splice(A[L],1),T&&T.splice(A[L],1);if(k.length?!w&&t.set(k):t.set(null),f)return!1;if(m(x,_),y!==n){var M;if(-1===S)M=v;else{for(C=o(k.length,C),M=[],L=0;L<v.length&&(I=v[L],!(I>=S));L++)M.push(I);for(L=S;L<C;L++)M.push(L)}for(L=0;L<M.length;L++)y(e,M[L])}else h(e);return!0}},{"../lib/is_plain_object":658,"../lib/loggers":661,"../lib/noop":666,"../lib/search":676,"../registry":788,"./container_array_match":687}],692:[function(e,t,a){'use strict';var W=Math.LN10,X=Math.log,Z=Math.min,K=Math.pow,$=Math.max,J=Math.floor;function o(e){var t=e._fullLayout;t._redrawFromAutoMarginCount?t._redrawFromAutoMarginCount--:e.emit("plotly_afterplot")}function r(e,t){try{e._fullLayout._paper.style("background",t)}catch(t){te.error(t)}}function n(e,t){var a=pe.combine(t,"white");r(e,a)}function l(e,t){if(!e._context){e._context=te.extendDeep({},ye);var a=Q.select("base");e._context._baseUrl=a.size()&&a.attr("href")?window.location.href.split("#")[0]:""}var o=e._context,l,s,d;if(t){for(s=Object.keys(t),l=0;l<s.length;l++)d=s[l],"editable"!==d&&"edits"!==d&&d in o&&("setBackground"===d&&"opaque"===t[d]?o[d]=n:o[d]=t[d]);t.plot3dPixelRatio&&!o.plotGlPixelRatio&&(o.plotGlPixelRatio=o.plot3dPixelRatio);var c=t.editable;if(c!==void 0)for(o.editable=c,s=Object.keys(o.edits),l=0;l<s.length;l++)o.edits[s[l]]=c;if(t.edits)for(s=Object.keys(t.edits),l=0;l<s.length;l++)d=s[l],d in o.edits&&(o.edits[d]=t.edits[d]);o._exportedPlot=t._exportedPlot}o.staticPlot&&(o.editable=!1,o.edits={},o.autosizable=!1,o.scrollZoom=!1,o.doubleClick=!1,o.showTips=!1,o.showLink=!1,o.displayModeBar=!1),"hover"!==o.displayModeBar||ee||(o.displayModeBar=!0),("transparent"===o.setBackground||"function"!=typeof o.setBackground)&&(o.setBackground=r),o._hasZeroHeight=o._hasZeroHeight||0===e.clientHeight,o._hasZeroWidth=o._hasZeroWidth||0===e.clientWidth;var p=o.scrollZoom,u=o._scrollZoom={};if(!0===p)u.cartesian=1,u.gl3d=1,u.geo=1,u.mapbox=1;else if("string"==typeof p){var g=p.split("+");for(l=0;l<g.length;l++)u[g[l]]=1}else!1!==p&&(u.gl3d=1,u.geo=1,u.mapbox=1)}function s(e,t,a){var o=Q.select(e).selectAll(".plot-container").data([0]);o.enter().insert("div",":first-child").classed("plot-container plotly",!0);var r=o.selectAll(".svg-container").data([0]);r.enter().append("div").classed("svg-container",!0).style("position","relative"),r.html(""),t&&(e.data=t),a&&(e.layout=a),se.manager.fillLayout(e),r.style({width:e._fullLayout.width+"px",height:e._fullLayout.height+"px"}),e.framework=se.manager.framework(e),e.framework({data:e.data,layout:e.layout},r.node()),e.framework.setUndoPoint();var i=e.framework.svg(),n=1,l=e._fullLayout.title?e._fullLayout.title.text:"";""!==l&&l||(n=0);var s=function(){this.call(me.convertToTspans,e)},d=i.select(".title-group text").call(s);if(e._context.edits.titleText){var c=te._(e,"Click to enter Plot title");l&&l!==c||(n=.2,d.attr({"data-unformatted":c}).text(c).style({opacity:n}).on("mouseover.opacity",function(){Q.select(this).transition().duration(100).style("opacity",1)}).on("mouseout.opacity",function(){Q.select(this).transition().duration(1e3).style("opacity",0)}));var p=function(){this.call(me.makeEditable,{gd:e}).on("edit",function(t){e.framework({layout:{title:{text:t}}}),this.text(t).call(s),this.call(p)}).on("cancel",function(){var e=this.attr("data-unformatted");this.text(e).call(s)})};d.call(p)}return e._context.setBackground(e,e._fullLayout.paper_bgcolor),le.addLinks(e),Promise.resolve()}function d(e,t){var a=[],o,r;for(o=0;o<e.length;o++)r=e[o],0>r?a.push(t+1+r):a.push(r);return a}function c(e,t,a){var o,r;for(o=0;o<t.length;o++){if(r=t[o],r!==parseInt(r,10))throw new Error("all values in "+a+" must be integers");if(r>=e.data.length||r<-e.data.length)throw new Error(a+" must be valid indices for gd.data.");if(-1<t.indexOf(r,o+1)||0<=r&&-1<t.indexOf(-e.data.length+r)||0>r&&-1<t.indexOf(e.data.length+r))throw new Error("each index in "+a+" must be unique.")}}function p(e,t,a){if(!Array.isArray(e.data))throw new Error("gd.data must be an array.");if("undefined"==typeof t)throw new Error("currentIndices is a required argument.");else Array.isArray(t)||(t=[t]);if(c(e,t,"currentIndices"),"undefined"==typeof a||Array.isArray(a)||(a=[a]),"undefined"!=typeof a&&c(e,a,"newIndices"),"undefined"!=typeof a&&t.length!==a.length)throw new Error("current and new indices must be of equal length.")}function u(e,t,a){var o,r;if(!Array.isArray(e.data))throw new Error("gd.data must be an array.");if("undefined"==typeof t)throw new Error("traces must be defined.");for(Array.isArray(t)||(t=[t]),o=0;o<t.length;o++)if(r=t[o],"object"!=typeof r||Array.isArray(r)||null===r)throw new Error("all values in traces array must be non-array objects");if("undefined"==typeof a||Array.isArray(a)||(a=[a]),"undefined"!=typeof a&&a.length!==t.length)throw new Error("if indices is specified, traces.length must equal indices.length")}function g(e,t,a,o){var r=te.isPlainObject(o);if(!Array.isArray(e.data))throw new Error("gd.data must be an array");if(!te.isPlainObject(t))throw new Error("update must be a key:value object");if("undefined"==typeof a)throw new Error("indices must be an integer or array of integers");for(var i in c(e,a,"indices"),t){if(!Array.isArray(t[i])||t[i].length!==a.length)throw new Error("attribute "+i+" must be an array of length equal to indices array length");if(r&&(!(i in o)||!Array.isArray(o[i])||o[i].length!==t[i].length))throw new Error("when maxPoints is set as a key:value object it must contain a 1:1 corrispondence with the keys and number of traces in the update object")}}function m(e,t,a,o){var r=te.isPlainObject(o),n=[],l,s,c,p,u;for(var g in Array.isArray(a)||(a=[a]),a=d(a,e.data.length-1),t)for(var m=0;m<a.length;m++){if(l=e.data[a[m]],c=ae(l,g),s=c.get(),p=t[g][m],!te.isArrayOrTypedArray(p))throw new Error("attribute: "+g+" index: "+m+" must be an array");if(!te.isArrayOrTypedArray(s))throw new Error("cannot extend missing or non-array attribute: "+g);if(s.constructor!==p.constructor)throw new Error("cannot extend array with an array of a different type: "+g);u=r?o[g][m]:o,i(u)||(u=-1),n.push({prop:c,target:s,insert:p,maxp:J(u)})}return n}function h(e,t,a,o,r){g(e,t,a,o);for(var n=m(e,t,a,o),l={},s={},d=0;d<n.length;d++){var c=n[d].prop,p=n[d].maxp,u=r(n[d].target,n[d].insert,p);c.set(u[0]),Array.isArray(l[c.astr])||(l[c.astr]=[]),l[c.astr].push(u[1]),Array.isArray(s[c.astr])||(s[c.astr]=[]),s[c.astr].push(n[d].target.length)}return{update:l,maxPoints:s}}function y(e,t){var a=new e.constructor(e.length+t.length);return a.set(e),a.set(t,e.length),a}function f(e,t,o,r){e=te.getGraphDiv(e);var i=h(e,t,o,r,function(e,t,a){var o,r;if(!te.isTypedArray(e))o=e.concat(t),r=0<=a&&a<o.length?o.splice(0,o.length-a):[];else if(0>a){var i=new e.constructor(0),n=y(e,t);0>a?(o=n,r=i):(o=i,r=n)}else if(o=new e.constructor(a),r=new e.constructor(e.length+t.length-a),a===t.length)o.set(t),r.set(e);else if(a<t.length){var l=t.length-a;o.set(t.subarray(l)),r.set(e),r.set(t.subarray(0,l),e.length)}else{var s=a-t.length,d=e.length-s;o.set(e.subarray(d)),o.set(t,s),r.set(e.subarray(0,d))}return[o,r]}),n=a.redraw(e),l=[e,i.update,o,i.maxPoints];return re.add(e,a.prependTraces,l,f,arguments),n}function x(e,t,o,r){e=te.getGraphDiv(e);var i=h(e,t,o,r,function(e,t,a){var o,r;if(!te.isTypedArray(e))o=t.concat(e),r=0<=a&&a<o.length?o.splice(a,o.length):[];else if(0>=a){var i=new e.constructor(0),n=y(t,e);0>a?(o=n,r=i):(o=i,r=n)}else if(o=new e.constructor(a),r=new e.constructor(e.length+t.length-a),a===t.length)o.set(t),r.set(e);else if(a<t.length){var l=t.length-a;o.set(t.subarray(0,l)),r.set(t.subarray(l)),r.set(e,l)}else{var s=a-t.length;o.set(t),o.set(e.subarray(0,s),t.length),r.set(e.subarray(s))}return[o,r]}),n=a.redraw(e),l=[e,i.update,o,i.maxPoints];return re.add(e,a.extendTraces,l,x,arguments),n}function _(e,t,o){e=te.getGraphDiv(e);var r=[],n=a.deleteTraces,l=_,s=[e,r],d=[e,t],c,g;for(u(e,t,o),Array.isArray(t)||(t=[t]),t=t.map(function(e){return te.extendFlat({},e)}),xe.cleanData(t),c=0;c<t.length;c++)e.data.push(t[c]);for(c=0;c<t.length;c++)r.push(-t.length+c);if("undefined"==typeof o)return g=a.redraw(e),re.add(e,n,s,l,d),g;Array.isArray(o)||(o=[o]);try{p(e,r,o)}catch(a){throw e.data.splice(e.data.length-t.length,t.length),a}return re.startSequence(e),re.add(e,n,s,l,d),g=a.moveTraces(e,r,o),re.stopSequence(e),g}function b(e,t){e=te.getGraphDiv(e);var o=[],r=a.addTraces,n=[e,o,t],l=[e,t],s,p;if("undefined"==typeof t)throw new Error("indices must be an integer or array of integers.");else Array.isArray(t)||(t=[t]);for(c(e,t,"indices"),t=d(t,e.data.length-1),t.sort(te.sorterDes),s=0;s<t.length;s+=1)p=e.data.splice(t[s],1)[0],o.push(p);var u=a.redraw(e);return re.add(e,r,n,b,l),u}function v(e,t,o){e=te.getGraphDiv(e);var r=[],n=[],l=[e,o,t],s=[e,t,o],c;if(p(e,t,o),t=Array.isArray(t)?t:[t],"undefined"==typeof o)for(o=[],c=0;c<t.length;c++)o.push(-t.length+c);for(o=Array.isArray(o)?o:[o],t=d(t,e.data.length-1),o=d(o,e.data.length-1),c=0;c<e.data.length;c++)-1===t.indexOf(c)&&r.push(e.data[c]);for(c=0;c<t.length;c++)n.push({newIndex:o[c],trace:e.data[t[c]]});for(n.sort(function(e,t){return e.newIndex-t.newIndex}),c=0;c<n.length;c+=1)r.splice(n[c].newIndex,0,n[c].trace);e.data=r;var u=a.redraw(e);return re.add(e,v,l,v,s),u}function w(e,t,r,i){e=te.getGraphDiv(e),xe.clearPromiseQueue(e);var n={};if("string"==typeof t)n[t]=r;else if(te.isPlainObject(t))n=te.extendFlat({},t),void 0===i&&(i=r);else return te.warn("Restyle fail.",t,r,i),Promise.reject();Object.keys(n).length&&(e.changed=!0);var l=xe.coerceTraceIndices(e,i),s=S(e,n,l),d=s.flags;d.calc&&(e.calcdata=void 0),d.clearAxisTypes&&xe.clearAxisTypes(e,l,{});var c=[];d.fullReplot?c.push(a.plot):(c.push(le.previousPromises),le.supplyDefaults(e),d.markerSize&&(le.doCalcdata(e),I(c)),d.style&&c.push(_e.doTraceStyle),d.colorbars&&c.push(_e.doColorBars),c.push(o)),c.push(le.rehover,le.redrag),re.add(e,w,[e,s.undoit,s.traces],w,[e,s.redoit,s.traces]);var p=te.syncOrAsync(c,e);return p&&p.then||(p=Promise.resolve()),p.then(function(){return e.emit("plotly_restyle",s.eventData),e})}function k(e){return void 0===e?null:e}function T(e,t){return t?function(t,a,o){var r=ae(t,a),i=r.set;return r.set=function(t){A((o||"")+a,r.get(),t,e),i(t)},r}:ae}function A(e,t,a,o){if(Array.isArray(t)||Array.isArray(a))for(var r=Array.isArray(t)?t:[],n=Array.isArray(a)?a:[],l=$(r.length,n.length),s=0;s<l;s++)A(e+"["+s+"]",r[s],n[s],o);else if(te.isPlainObject(t)||te.isPlainObject(a)){var d=te.isPlainObject(t)?t:{},c=te.isPlainObject(a)?a:{},p=te.extendFlat({},d,c);for(var u in p)A(e+"."+u,d[u],c[u],o)}else void 0===o[e]&&(o[e]=k(t))}function S(e,t,a){function o(){return a.map(function(){})}function r(e){var t=de.id2name(e);-1===w.indexOf(t)&&w.push(t)}function n(e){return"LAYOUT"+e+".autorange"}function l(e){return"LAYOUT"+e+".range"}function s(e){for(var t=e;t<g.length;t++)if(g[t]._input===m[e])return g[t]}function d(r,n,l){if(Array.isArray(r))return void r.forEach(function(e){d(e,n,l)});if(!(r in t||xe.hasParent(t,r))){var i;if("LAYOUT"===r.substr(0,6))i=y(e.layout,r.replace("LAYOUT",""));else{var c=a[l],p=u._tracePreGUI[s(c)._fullInput.uid];i=T(p,h)(m[c],r)}r in v||(v[r]=o()),void 0===v[r][l]&&(v[r][l]=k(i.get())),void 0!==n&&i.set(n)}}function c(e){return function(t){return g[t][e]}}function p(e){return function(t,o){return!1===t?g[a[o]][e]:null}}var u=e._fullLayout,g=e._fullData,m=e.data,h=u._guiEditing,y=T(u._preGUI,h),f=te.extendDeepAll({},t),x;C(t);var _=be.traceFlags(),b={},v={},w;for(var A in t){if(xe.hasParent(t,A))throw new Error("cannot set "+A+" and a parent attribute simultaneously");var S=t[A],L,E,I,P,z,D;if(("autobinx"==A||"autobiny"===A)&&(A=A.charAt(A.length-1)+"bins",S=Array.isArray(S)?S.map(p(A)):!1===S?a.map(c(A)):null),b[A]=S,"LAYOUT"===A.substr(0,6)){I=y(e.layout,A.replace("LAYOUT","")),v[A]=[k(I.get())],I.set(Array.isArray(S)?S[0]:S),_.calc=!0;continue}for(v[A]=o(),x=0;x<a.length;x++){L=m[a[x]],E=s(a[x]);var O=u._tracePreGUI[E._fullInput.uid];if(I=T(O,h)(L,A),P=I.get(),z=Array.isArray(S)?S[x%S.length]:S,void 0!==z){var R=I.parts[I.parts.length-1],M=A.substr(0,A.length-R.length-1),j=M?M+".":"",B=M?ae(E,M).get():E;if(D=ne.getTraceValObject(E,I.parts),D&&D.impliedEdits&&null!==z)for(var F in D.impliedEdits)d(te.relativeAttr(A,F),D.impliedEdits[F],x);else if(("thicknessmode"===R||"lenmode"===R)&&P!==z&&("fraction"===z||"pixels"===z)&&B){var N=u._size,V=B.orient,U="top"===V||"bottom"===V;if("thicknessmode"===R){var H=U?N.h:N.w;d(j+"thickness",B.thickness*("fraction"===z?1/H:H),x)}else{var q=U?N.w:N.h;d(j+"len",B.len*("fraction"===z?1/q:q),x)}}else if("type"===A&&("pie"===z!=("pie"===P)||"funnelarea"===z!=("funnelarea"===P))){var G="x",Y="y";("bar"===z||"bar"===P)&&"h"===L.orientation&&(G="y",Y="x"),te.swapAttrs(L,["?","?src"],"labels",G),te.swapAttrs(L,["d?","?0"],"label",G),te.swapAttrs(L,["?","?src"],"values",Y),"pie"===P||"funnelarea"===P?(ae(L,"marker.color").set(ae(L,"marker.colors").get()),u._pielayer.selectAll("g.trace").remove()):ie.traceIs(L,"cartesian")&&ae(L,"marker.colors").set(ae(L,"marker.color").get())}v[A][x]=k(P);if(-1!==["swapxy","swapxyaxes","orientation","orientationaxes"].indexOf(A)){if("orientation"===A){I.set(z);var W=L.x&&!L.y?"h":"v";if((I.get()||W)===E.orientation)continue}else"orientationaxes"===A&&(L.orientation={v:"h",h:"v"}[E.orientation]);xe.swapXYData(L),_.calc=_.clearAxisTypes=!0}else-1===le.dataArrayContainers.indexOf(I.parts[0])?(D?D.arrayOk&&!ie.traceIs(E,"regl")&&(te.isArrayOrTypedArray(z)||te.isArrayOrTypedArray(P))?_.calc=!0:be.update(_,D):_.calc=!0,I.set(z)):(xe.manageArrayContainers(I,z,v),_.calc=!0)}}if(-1!==["swapxyaxes","orientationaxes"].indexOf(A)&&de.swap(e,a),"orientationaxes"==A){var X=ae(e.layout,"hovermode");"x"===X.get()?X.set("y"):"y"===X.get()?X.set("x"):"x unified"===X.get()?X.set("y unified"):"y unified"===X.get()&&X.set("x unified")}if(-1!==["orientation","type"].indexOf(A)){for(w=[],x=0;x<a.length;x++){var Z=m[a[x]];ie.traceIs(Z,"cartesian")&&(r(Z.xaxis||"x"),r(Z.yaxis||"y"))}d(w.map(n),!0,0),d(w.map(l),[0,1],0)}}return(_.calc||_.plot)&&(_.fullReplot=!0),{flags:_,undoit:v,redoit:b,traces:a,eventData:te.extendDeepNoArrays([],[f,a])}}function C(e){function t(t,a){e[a]=e[t],delete e[t]}var a=te.counterRegex("axis",".title",!1,!1),o=Object.keys(e),r,n,l;for(r=0;r<o.length;r++)n=o[r],l=e[n],("title"===n||a.test(n)||/colorbar\.title$/.test(n))&&("string"==typeof l||"number"==typeof l)?t(n,n.replace("title","title.text")):-1<n.indexOf("titlefont")?t(n,n.replace("titlefont","title.font")):-1<n.indexOf("titleposition")?t(n,n.replace("titleposition","title.position")):-1<n.indexOf("titleside")?t(n,n.replace("titleside","title.side")):-1<n.indexOf("titleoffset")&&t(n,n.replace("titleoffset","title.offset"))}function L(e,t,a){if(e=te.getGraphDiv(e),xe.clearPromiseQueue(e),e.framework&&e.framework.isPolar)return Promise.resolve(e);var r={};if("string"==typeof t)r[t]=a;else if(te.isPlainObject(t))r=te.extendFlat({},t);else return te.warn("Relayout fail.",t,a),Promise.reject();Object.keys(r).length&&(e.changed=!0);var i=P(e,r),n=i.flags;n.calc&&(e.calcdata=void 0);var l=[le.previousPromises];n.layoutReplot?l.push(_e.layoutReplot):Object.keys(r).length&&(E(e,n,i)||le.supplyDefaults(e),n.legend&&l.push(_e.doLegend),n.layoutstyle&&l.push(_e.layoutStyles),n.axrange&&I(l,i.rangesAltered),n.ticks&&l.push(_e.doTicksRelayout),n.modebar&&l.push(_e.doModeBar),n.camera&&l.push(_e.doCamera),n.colorbars&&l.push(_e.doColorBars),l.push(o)),l.push(le.rehover,le.redrag),re.add(e,L,[e,i.undoit],L,[e,i.redoit]);var s=te.syncOrAsync(l,e);return s&&s.then||(s=Promise.resolve(e)),s.then(function(){return e.emit("plotly_relayout",i.eventData),e})}function E(e,t,a){var o=e._fullLayout;if(!t.axrange)return!1;for(var r in t)if("axrange"!=r&&t[r])return!1;for(var i in a.rangesAltered){var n=de.id2name(i),l=e.layout[n],s=o[n];if(s.autorange=l.autorange,s.range=l.range.slice(),s.cleanRange(),s._matchGroup)for(var d in s._matchGroup)if(d!==i){var c=o[de.id2name(d)];c.autorange=s.autorange,c.range=s.range.slice(),c._input.range=s.range.slice()}}return!0}function I(e,t){var a=t?function(e){var a=[],o=!0;for(var r in t){var i=de.getFromId(e,r);if(a.push(r),i._matchGroup)for(var n in i._matchGroup)t[n]||a.push(n);i.automargin&&(o=!1)}return de.draw(e,a,{skipTitle:o})}:function(e){return de.draw(e,"redraw")};e.push(he,_e.doAutoRangeAndConstraints,a,_e.drawData,_e.finalDraw)}function P(e,t){function o(e,r){if(Array.isArray(e))return void e.forEach(function(e){o(e,r)});if(!(e in t||xe.hasParent(t,e))){var i=d(n,e);e in w||(w[e]=k(i.get())),void 0!==r&&i.set(r)}}function r(e){var t=de.name2id(e.split(".")[0]);return A[t]=1,t}var n=e.layout,l=e._fullLayout,s=l._guiEditing,d=T(l._preGUI,s),c=Object.keys(t),u=de.list(e),g=te.extendDeepAll({},t),m={},h,y,a;for(C(t),c=Object.keys(t),y=0;y<c.length;y++)if(0===c[y].indexOf("allaxes")){for(a=0;a<u.length;a++){var f=u[a]._id.substr(1),x=-1===f.indexOf("scene")?"":f+".",_=c[y].replace("allaxes",x+u[a]._name);t[_]||(t[_]=t[c[y]])}delete t[c[y]]}var b=be.layoutFlags(),v={},w={},A={},S;for(var L in t){if(xe.hasParent(t,L))throw new Error("cannot set "+L+" and a parent attribute simultaneously");for(var E=d(n,L),p=t[L],I=E.parts.length,P=I-1;0<P&&"string"!=typeof E.parts[P];)P--;var D=E.parts[P],O=E.parts[P-1]+"."+D,R=E.parts.slice(0,P).join("."),M=ae(e.layout,R).get(),B=ae(l,R).get(),F=E.get();if(void 0!==p){v[L]=p,w[L]="reverse"===D?p:k(F);var N=ne.getLayoutValObject(l,E.parts);if(N&&N.impliedEdits&&null!==p)for(var V in N.impliedEdits)o(te.relativeAttr(L,V),N.impliedEdits[V]);if(-1!==["width","height"].indexOf(L)){if(p){o("autosize",null);var U="height"===L?"width":"height";o(U,l[U])}else l[L]=e._initialAutoSize[L];}else if("autosize"===L)o("width",p?null:l.width),o("height",p?null:l.height);else if(O.match(ke))r(O),ae(l,R+"._inputRange").set(null);else if(O.match(Te)){r(O),ae(l,R+"._inputRange").set(null);var H=ae(l,R).get();H._inputDomain&&(H._input.domain=H._inputDomain.slice())}else O.match(Ae)&&ae(l,R+"._inputDomain").set(null);if("type"===D){var q=M,G="linear"===B.type&&"log"===p,Y="log"===B.type&&"linear"===p;if(G||Y){if(!q||!q.range)o(R+".autorange",!0);else if(!B.autorange){var Z=q.range[0],$=q.range[1];G?(0>=Z&&0>=$&&o(R+".autorange",!0),0>=Z?Z=$/1e6:0>=$&&($=Z/1e6),o(R+".range[0]",X(Z)/W),o(R+".range[1]",X($)/W)):(o(R+".range[0]",K(10,Z)),o(R+".range[1]",K(10,$)))}else G&&(q.range=q.range[1]>q.range[0]?[1,2]:[2,1]);Array.isArray(l._subplots.polar)&&l._subplots.polar.length&&l[E.parts[0]]&&"radialaxis"===E.parts[1]&&delete l[E.parts[0]]._subplot.viewInitial["radialaxis.range"],ie.getComponentMethod("annotations","convertCoords")(e,B,p,o),ie.getComponentMethod("images","convertCoords")(e,B,p,o)}else o(R+".autorange",!0),o(R+".range",null);ae(l,R+"._inputRange").set(null)}else if(D.match(ve)){var J=ae(l,L).get(),Q=(p||{}).type;Q&&"-"!==Q||(Q="linear"),ie.getComponentMethod("annotations","convertCoords")(e,J,Q,o),ie.getComponentMethod("images","convertCoords")(e,J,Q,o)}var ee=fe.containerArrayMatch(L);if(ee){h=ee.array,y=ee.index;var oe=ee.property;""!==y&&""===oe&&(fe.isAddVal(p)?w[L]=null:fe.isRemoveVal(p)?w[L]=(ae(n,h).get()||[])[y]:te.warn("unrecognized full object value",t)),be.update(b,N||{editType:"calc"}),m[h]||(m[h]={});var re=m[h][y];re||(re=m[h][y]={}),re[oe]=p,delete t[L]}else"reverse"===D?(M.range?M.range.reverse():(o(R+".autorange",!0),M.range=[1,0]),B.autorange?b.calc=!0:b.plot=!0):(l._has("scatter-like")&&l._has("regl")&&"dragmode"===L&&("lasso"===p||"select"===p)&&"lasso"!==F&&"select"!==F?b.plot=!0:l._has("gl2d")?b.plot=!0:N?be.update(b,N):b.calc=!0,E.set(p))}}for(h in m){var le=fe.applyContainerArrayChanges(e,d(n,h),m[h],b,d);le||(b.plot=!0)}var se=l._axisConstraintGroups||[];for(S in A)for(y=0;y<se.length;y++){var ce=se[y];if(ce[S])for(var pe in b.calc=!0,ce)A[pe]||(de.getFromId(e,pe)._constraintShrinkable=!0)}return(z(e)||t.height||t.width)&&(b.plot=!0),(b.plot||b.calc)&&(b.layoutReplot=!0),{flags:b,rangesAltered:A,undoit:w,redoit:v,eventData:g}}function z(e){var t=e._fullLayout,a=t.width,o=t.height;return e.layout.autosize&&le.plotAutoSize(e,e.layout,t),t.width!==a||t.height!==o}function D(e,t,r,i){if(e=te.getGraphDiv(e),xe.clearPromiseQueue(e),e.framework&&e.framework.isPolar)return Promise.resolve(e);te.isPlainObject(t)||(t={}),te.isPlainObject(r)||(r={}),Object.keys(t).length&&(e.changed=!0),Object.keys(r).length&&(e.changed=!0);var n=xe.coerceTraceIndices(e,i),l=S(e,te.extendFlat({},t),n),s=l.flags,d=P(e,te.extendFlat({},r)),c=d.flags;(s.calc||c.calc)&&(e.calcdata=void 0),s.clearAxisTypes&&xe.clearAxisTypes(e,n,r);var p=[];c.layoutReplot?p.push(_e.layoutReplot):s.fullReplot?p.push(a.plot):(p.push(le.previousPromises),E(e,c,d)||le.supplyDefaults(e),s.style&&p.push(_e.doTraceStyle),(s.colorbars||c.colorbars)&&p.push(_e.doColorBars),c.legend&&p.push(_e.doLegend),c.layoutstyle&&p.push(_e.layoutStyles),c.axrange&&I(p,d.rangesAltered),c.ticks&&p.push(_e.doTicksRelayout),c.modebar&&p.push(_e.doModeBar),c.camera&&p.push(_e.doCamera),p.push(o)),p.push(le.rehover,le.redrag),re.add(e,D,[e,l.undoit,d.undoit,l.traces],D,[e,l.redoit,d.redoit,l.traces]);var u=te.syncOrAsync(p,e);return u&&u.then||(u=Promise.resolve(e)),u.then(function(){return e.emit("plotly_update",{data:l.eventData,layout:d.eventData}),e})}function O(e){return function(t){t._fullLayout._guiEditing=!0;var a=e.apply(null,arguments);return t._fullLayout._guiEditing=!1,a}}function R(e,t){for(var a=0;a<t.length;a++){var o=t[a],r=e.match(o.pattern);if(r)return{head:r[1],attr:o.attr}}}function M(e,t){var a=ae(t,e).get();if(a!==void 0)return a;var o=e.split(".");for(o.pop();1<o.length;)if(o.pop(),a=ae(t,o.join(".")+".uirevision").get(),void 0!==a)return a;return t.uirevision}function j(e,t){for(var a=0;a<t.length;a++)if(t[a]._fullInput.uid===e)return a;return-1}function B(e,t,a){for(var o=0;o<t.length;o++)if(t[o].uid===e)return o;return!t[a]||t[a].uid?-1:a}function F(e,t){var a=te.isPlainObject(e),o=Array.isArray(e);return a||o?(a&&te.isPlainObject(t)||o&&Array.isArray(t))&&JSON.stringify(e)===JSON.stringify(t):e===t}function N(e,t,a,o){var r=o._preGUI,n=[],l={},s,d,c,p,u,g,m,h;for(s in r){if(u=R(s,Se),!u)te.warn("unrecognized GUI edit: "+s);else if(d=u.attr||u.head+".uirevision",c=ae(o,d).get(),p=c&&M(d,t),p&&p===c&&(g=r[s],null===g&&(g=void 0),m=ae(t,s),h=m.get(),F(h,g))){void 0===h&&"autorange"===s.substr(s.length-9)&&n.push(s.substr(0,s.length-10)),m.set(k(ae(o,s).get()));continue}delete r[s],"range["===s.substr(s.length-8,6)&&(l[s.substr(0,s.length-9)]=1)}for(var y=0,f;y<n.length;y++)if(f=n[y],l[f]){var x=ae(t,f).get();x&&delete x.autorange}var _=o._tracePreGUI;for(var b in _){var v=_[b],w=null,T;for(s in v){if(!w){var A=j(b,a);if(0>A){delete _[b];break}var S=a[A];T=S._fullInput;var C=B(b,e,T.index);if(0>C){delete _[b];break}w=e[C]}if(u=R(s,Ce),!u)te.warn("unrecognized GUI edit: "+s+" in trace uid "+b);else if(u.attr?(c=ae(o,u.attr).get(),p=c&&M(u.attr,t)):(c=T.uirevision,p=w.uirevision,void 0===p&&(p=t.uirevision)),p&&p===c&&(g=v[s],null===g&&(g=void 0),m=ae(w,s),h=m.get(),F(h,g))){m.set(k(ae(T,s).get()));continue}delete v[s]}}}function V(e,t,a,o,r,n){function l(e){var t=ne.getTraceValObject(g,e);return!g._module.animatable&&t.anim&&(t.anim=!1),t}var s=t.length===a.length;if(!r&&!s)return{fullReplot:!0,calc:!0};var d=be.traceFlags();d.arrays={},d.nChanges=0,d.nChangesAnim=0;var c={getValObject:l,flags:d,immutable:o,transition:r,newDataRevision:n,gd:e},p={},u,g;for(u=0;u<t.length;u++)if(a[u]){if(g=a[u]._fullInput,le.hasMakesDataTransform(g)&&(g=a[u]),p[g.uid])continue;p[g.uid]=1,H(t[u]._fullInput,g,[],c)}return(d.calc||d.plot)&&(d.fullReplot=!0),r&&d.nChanges&&d.nChangesAnim&&(d.anim=d.nChanges===d.nChangesAnim&&s?"all":"some"),d}function U(e,t,a,o,r){var i=be.layoutFlags();i.arrays={},i.rangesAltered={},i.nChanges=0,i.nChangesAnim=0;return H(t,a,[],{getValObject:function(e){return ne.getLayoutValObject(a,e)},flags:i,immutable:o,transition:r,gd:e}),(i.plot||i.calc)&&(i.layoutReplot=!0),r&&i.nChanges&&i.nChangesAnim&&(i.anim=i.nChanges===i.nChangesAnim?"all":"some"),i}function H(e,t,a,o){function r(){var e=u.editType;return c&&-1!==e.indexOf("arraydraw")?void te.pushUnique(s.arrays[c],p):void(be.update(s,u),"none"!==e&&s.nChanges++,o.transition&&u.anim&&s.nChangesAnim++,(ke.test(m)||Te.test(m))&&(s.rangesAltered[a[0]]=1),Ae.test(m)&&ae(t,"_inputDomain").set(null),"datarevision"===g&&(s.newDataRevision=1))}function n(e){return"data_array"===e.valType||e.arrayOk}var l=o.getValObject,s=o.flags,d=o.immutable,c=o.inArray,p=o.arrayIndex,u,g,m;for(g in e){if(s.calc&&!o.transition)return;var h=e[g],y=t[g],f=a.concat(g);if(m=f.join("."),"_"!==g.charAt(0)&&"function"!=typeof h&&h!==y){if(("tick0"===g||"dtick"===g)&&"geo"!==a[0]){var x=t.tickmode;if("auto"===x||"array"===x||!x)continue}if(!("range"===g&&t.autorange)&&("zmin"!==g&&"zmax"!==g||"contourcarpet"!==t.type)&&(u=l(f),u&&!(u._compareAsJSON&&JSON.stringify(h)===JSON.stringify(y)))){var _=u.valType,b=n(u),v=Array.isArray(h),w=Array.isArray(y),k;if(v&&w){var T="_input_"+g,A=e[T],S=t[T];if(Array.isArray(A)&&A===S)continue}if(void 0===y)b&&v?s.calc=!0:r();else if(u._isLinkedToArray){var C=[],L=!1;c||(s.arrays[g]=C);var E=Z(h.length,y.length),I=$(h.length,y.length);if(E!==I)if("arraydraw"===u.editType)L=!0;else{r();continue}for(k=0;k<E;k++)H(h[k],y[k],f.concat(k),te.extendFlat({inArray:g,arrayIndex:k},o));if(L)for(k=E;k<I;k++)C.push(k)}else!_&&te.isPlainObject(h)?H(h,y,f,o):b?v&&w?(d&&(s.calc=!0),(d||o.newDataRevision)&&r()):v===w?r():s.calc=!0:v&&w?(h.length!==y.length||h+""!==y+"")&&r():r()}}}for(g in t)if(!(g in e||"_"===g.charAt(0)||"function"==typeof t[g])){if(u=l(a.concat(g)),n(u)&&Array.isArray(t[g]))return void(s.calc=!0);r()}}function q(e,t){for(var a in e)if("_"!==a.charAt(0)){var o=e[a],r=t[a];if(o!==r)if(te.isPlainObject(o)&&te.isPlainObject(r)){if(q(o,r))return!0;}else if(Array.isArray(o)&&Array.isArray(r)){if(o.length!==r.length)return!0;for(var n=0;n<o.length;n++)if(o[n]!==r[n]){if(!(te.isPlainObject(o[n])&&te.isPlainObject(r[n])))return!0;if(q(o[n],r[n]))return!0}}else return!0}}function G(e,t,a){if(e=te.getGraphDiv(e),null===t||void 0===t)return Promise.resolve();if(!te.isPlotDiv(e))throw new Error("This element is not a Plotly plot: "+e+". It's likely that you've failed to create a plot before adding frames. For more details, see https://plotly.com/javascript/animations/");var o=e._transitionData._frames,r=e._transitionData._frameHash,n,l,s,d;if(!Array.isArray(t))throw new Error("addFrames failure: frameList must be an Array of frame definitions"+t);var c=o.length+2*t.length,p=[],u={};for(n=t.length-1;0<=n;n--)if(te.isPlainObject(t[n])){var g=t[n].name,m=(r[g]||u[g]||{}).name,h=t[n].name,y=r[m]||u[m];m&&h&&"number"==typeof h&&y&&5>we&&(we++,te.warn("addFrames: overwriting frame \""+(r[m]||u[m]).name+"\" with a frame whose name of type \"number\" also equates to \""+m+"\". This is valid but may potentially lead to unexpected behavior since all plotly.js frame names are stored internally as strings."),5===we&&te.warn("addFrames: This API call has yielded too many of these warnings. For the rest of this call, further warnings about numeric frame names will be suppressed.")),u[g]={name:g},p.push({frame:le.supplyFrameDefaults(t[n]),index:a&&void 0!==a[n]&&null!==a[n]?a[n]:c+n})}p.sort(function(e,t){return e.index>t.index?-1:e.index<t.index?1:0});var f=[],x=[],_=o.length;for(n=p.length-1;0<=n;n--){if(l=p[n].frame,"number"==typeof l.name&&te.warn("Warning: addFrames accepts frames with numeric names, but the numbers areimplicitly cast to strings"),!l.name)for(;r[l.name="frame "+e._transitionData._counter++];);if(r[l.name]){for(s=0;s<o.length&&(o[s]||{}).name!==l.name;s++);f.push({type:"replace",index:s,value:l}),x.unshift({type:"replace",index:s,value:o[s]})}else d=$(0,Z(p[n].index,_)),f.push({type:"insert",index:d,value:l}),x.unshift({type:"delete",index:d}),_++}var b=le.modifyFrames,v=le.modifyFrames,w=[e,x],k=[e,f];return re&&re.add(e,b,w,v,k),le.modifyFrames(e,f)}function Y(e){var t=Q.select(e),a=e._fullLayout;if(a._container=t.selectAll(".plot-container").data([0]),a._container.enter().insert("div",":first-child").classed("plot-container",!0).classed("plotly",!0),a._paperdiv=a._container.selectAll(".svg-container").data([0]),a._paperdiv.enter().append("div").classed("svg-container",!0).style("position","relative"),a._glcontainer=a._paperdiv.selectAll(".gl-container").data([{}]),a._glcontainer.enter().append("div").classed("gl-container",!0),a._paperdiv.selectAll(".main-svg").remove(),a._paperdiv.select(".modebar-container").remove(),a._paper=a._paperdiv.insert("svg",":first-child").classed("main-svg",!0),a._toppaper=a._paperdiv.append("svg").classed("main-svg",!0),a._modebardiv=a._paperdiv.append("div"),a._hoverpaper=a._paperdiv.append("svg").classed("main-svg",!0),!a._uid){var o={};Q.selectAll("defs").each(function(){this.id&&(o[this.id.split("-")[1]]=1)}),a._uid=te.randstr(o)}a._paperdiv.selectAll(".main-svg").attr(ge.svgAttrs),a._defs=a._paper.append("defs").attr("id","defs-"+a._uid),a._clips=a._defs.append("g").classed("clips",!0),a._topdefs=a._toppaper.append("defs").attr("id","topdefs-"+a._uid),a._topclips=a._topdefs.append("g").classed("clips",!0),a._bgLayer=a._paper.append("g").classed("bglayer",!0),a._draggers=a._paper.append("g").classed("draglayer",!0);var r=a._paper.append("g").classed("layer-below",!0);a._imageLowerLayer=r.append("g").classed("imagelayer",!0),a._shapeLowerLayer=r.append("g").classed("shapelayer",!0),a._cartesianlayer=a._paper.append("g").classed("cartesianlayer",!0),a._polarlayer=a._paper.append("g").classed("polarlayer",!0),a._ternarylayer=a._paper.append("g").classed("ternarylayer",!0),a._geolayer=a._paper.append("g").classed("geolayer",!0),a._funnelarealayer=a._paper.append("g").classed("funnelarealayer",!0),a._pielayer=a._paper.append("g").classed("pielayer",!0),a._treemaplayer=a._paper.append("g").classed("treemaplayer",!0),a._sunburstlayer=a._paper.append("g").classed("sunburstlayer",!0),a._indicatorlayer=a._toppaper.append("g").classed("indicatorlayer",!0),a._glimages=a._paper.append("g").classed("glimages",!0);var i=a._toppaper.append("g").classed("layer-above",!0);a._imageUpperLayer=i.append("g").classed("imagelayer",!0),a._shapeUpperLayer=i.append("g").classed("shapelayer",!0),a._infolayer=a._toppaper.append("g").classed("infolayer",!0),a._menulayer=a._toppaper.append("g").classed("menulayer",!0),a._zoomlayer=a._toppaper.append("g").classed("zoomlayer",!0),a._hoverlayer=a._hoverpaper.append("g").classed("hoverlayer",!0),a._modebardiv.classed("modebar-container",!0).style("position","absolute").style("top","0px").style("right","0px"),e.emit("plotly_framework")}var Q=e("d3"),i=e("fast-isnumeric"),ee=e("has-hover"),te=e("../lib"),ae=te.nestedProperty,oe=e("../lib/events"),re=e("../lib/queue"),ie=e("../registry"),ne=e("./plot_schema"),le=e("../plots/plots"),se=e("../plots/polar/legacy"),de=e("../plots/cartesian/axes"),ce=e("../components/drawing"),pe=e("../components/color"),ue=e("../plots/cartesian/graph_interact").initInteractions,ge=e("../constants/xmlns_namespaces"),me=e("../lib/svg_text_utils"),he=e("../plots/cartesian/select").clearSelect,ye=e("./plot_config").dfltConfig,fe=e("./manage_arrays"),xe=e("./helpers"),_e=e("./subroutines"),be=e("./edit_types"),ve=e("../plots/cartesian/constants").AX_NAME_PATTERN,we=0,ke=/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/,Te=/^[xyz]axis[0-9]*\.autorange$/,Ae=/^[xyz]axis[0-9]*\.domain(\[[0|1]\])?$/,Se=[{pattern:/^hiddenlabels/,attr:"legend.uirevision"},{pattern:/^((x|y)axis\d*)\.((auto)?range|title\.text)/},{pattern:/axis\d*\.showspikes$/,attr:"modebar.uirevision"},{pattern:/(hover|drag)mode$/,attr:"modebar.uirevision"},{pattern:/^(scene\d*)\.camera/},{pattern:/^(geo\d*)\.(projection|center|fitbounds)/},{pattern:/^(ternary\d*\.[abc]axis)\.(min|title\.text)$/},{pattern:/^(polar\d*\.radialaxis)\.((auto)?range|angle|title\.text)/},{pattern:/^(polar\d*\.angularaxis)\.rotation/},{pattern:/^(mapbox\d*)\.(center|zoom|bearing|pitch)/},{pattern:/^legend\.(x|y)$/,attr:"editrevision"},{pattern:/^(shapes|annotations)/,attr:"editrevision"},{pattern:/^title\.text$/,attr:"editrevision"}],Ce=[{pattern:/^selectedpoints$/,attr:"selectionrevision"},{pattern:/(^|value\.)visible$/,attr:"legend.uirevision"},{pattern:/^dimensions\[\d+\]\.constraintrange/},{pattern:/^node\.(x|y|groups)/},{pattern:/^level$/},{pattern:/(^|value\.)name$/},{pattern:/colorbar\.title\.text$/},{pattern:/colorbar\.(x|y)$/,attr:"editrevision"}];a.animate=function(e,t,a){function o(e){return Array.isArray(s)?e>=s.length?s[0]:s[e]:s}function r(e){return Array.isArray(d)?e>=d.length?d[0]:d[e]:d}function n(e,t){var a=0;return function(){if(e&&++a===t)return e()}}if(e=te.getGraphDiv(e),!te.isPlotDiv(e))throw new Error("This element is not a Plotly plot: "+e+". It's likely that you've failed to create a plot before animating it. For more details, see https://plotly.com/javascript/animations/");var l=e._transitionData;l._frameQueue||(l._frameQueue=[]),a=le.supplyAnimationDefaults(a);var s=a.transition,d=a.frame;return void 0===l._frameWaitingCnt&&(l._frameWaitingCnt=0),new Promise(function(d,c){function p(){if(0!==l._frameQueue.length){for(;l._frameQueue.length;){var t=l._frameQueue.pop();t.onInterrupt&&t.onInterrupt()}e.emit("plotly_animationinterrupted",[])}}function u(t){if(0!==t.length){for(var s=0;s<t.length;s++){var p="byname"===t[s].type?le.computeFrame(e,t[s].name):t[s].data;var u=r(s),g=o(s);g.duration=Z(g.duration,u.duration);var m={frame:p,name:t[s].name,frameOpts:u,transitionOpts:g};s==t.length-1&&(m.onComplete=n(d,2),m.onInterrupt=c),l._frameQueue.push(m)}"immediate"===a.mode&&(l._lastFrameAt=-Infinity),l._animationRaf||h()}}function g(){e.emit("plotly_animated"),window.cancelAnimationFrame(l._animationRaf),l._animationRaf=null}function m(){l._currentFrame&&l._currentFrame.onComplete&&l._currentFrame.onComplete();var t=l._currentFrame=l._frameQueue.shift();if(t){var a=t.name?t.name.toString():null;e._fullLayout._currentFrame=a,l._lastFrameAt=Date.now(),l._timeToNext=t.frameOpts.duration,le.transition(e,t.frame.data,t.frame.layout,xe.coerceTraceIndices(e,t.frame.traces),t.frameOpts,t.transitionOpts).then(function(){t.onComplete&&t.onComplete()}),e.emit("plotly_animatingframe",{name:a,frame:t.frame,animation:{frame:t.frameOpts,transition:t.transitionOpts}})}else g()}function h(){e.emit("plotly_animating"),l._lastFrameAt=-Infinity,l._timeToNext=0,l._runningTransitions=0,l._currentFrame=null;var t=function(){l._animationRaf=window.requestAnimationFrame(t),Date.now()-l._lastFrameAt>l._timeToNext&&m()};t()}function y(e){return e.transitionOpts=Array.isArray(s)?f>=s.length?s[f]:s[0]:s,f++,e}var f=0,x=[],_=void 0===t||null===t,b=Array.isArray(t),v=!_&&!b&&te.isPlainObject(t),w,k;if(v)x.push({type:"object",data:y(te.extendFlat({},t))});else if(_||-1!==["string","number"].indexOf(typeof t))for(w=0;w<l._frames.length;w++)k=l._frames[w],k&&(_||k.group+""===t+"")&&x.push({type:"byname",name:k.name+"",data:y({name:k.name})});else if(b)for(w=0;w<t.length;w++){var T=t[w];-1===["number","string"].indexOf(typeof T)?te.isPlainObject(T)&&x.push({type:"object",data:y(te.extendFlat({},T))}):(T+="",x.push({type:"byname",name:T,data:y({name:T})}))}for(w=0;w<x.length;w++)if(k=x[w],"byname"===k.type&&!l._frameHash[k.data.name])return te.warn("animate failure: frame not found: \""+k.data.name+"\""),void c();-1!==["next","immediate"].indexOf(a.mode)&&p(),"reverse"===a.direction&&x.reverse();var A=e._fullLayout._currentFrame;if(A&&a.fromcurrent){var S=-1;for(w=0;w<x.length;w++)if(k=x[w],"byname"===k.type&&k.name===A){S=w;break}if(0<S&&S<x.length-1){var C=[];for(w=0;w<x.length;w++)k=x[w],("byname"!==x[w].type||w>S)&&C.push(k);x=C}}0<x.length?u(x):(e.emit("plotly_animated"),d())})},a.addFrames=G,a.deleteFrames=function(e,t){if(e=te.getGraphDiv(e),!te.isPlotDiv(e))throw new Error("This element is not a Plotly plot: "+e);var a=e._transitionData._frames,o=[],r=[],n,l;if(!t)for(t=[],n=0;n<a.length;n++)t.push(n);for(t=t.slice(),t.sort(),n=t.length-1;0<=n;n--)l=t[n],o.push({type:"delete",index:l}),r.unshift({type:"insert",index:l,value:a[l]});var s=le.modifyFrames,d=le.modifyFrames,c=[e,r],p=[e,o];return re&&re.add(e,s,c,d,p),le.modifyFrames(e,o)},a.addTraces=_,a.deleteTraces=b,a.extendTraces=f,a.moveTraces=v,a.prependTraces=x,a.newPlot=function(e,t,o,r){return e=te.getGraphDiv(e),le.cleanPlot([],{},e._fullData||[],e._fullLayout||{}),le.purge(e),a.plot(e,t,o,r)},a.plot=function(e,t,r,n){function d(){if(y)return a.addFrames(e,y)}function c(){for(var t=b._basePlotModules,a=0;a<t.length;a++)t[a].drawFramework&&t[a].drawFramework(e);if(!b._glcanvas&&b._has("gl")&&(b._glcanvas=b._glcontainer.selectAll(".gl-canvas").data([{key:"contextLayer",context:!0,pick:!1},{key:"focusLayer",context:!1,pick:!1},{key:"pickLayer",context:!1,pick:!0}],function(e){return e.key}),b._glcanvas.enter().append("canvas").attr("class",function(e){return"gl-canvas gl-canvas-"+e.key.replace("Layer","")}).style({position:"absolute",top:0,left:0,overflow:"visible","pointer-events":"none"})),b._glcanvas){b._glcanvas.attr("width",b.width).attr("height",b.height);var o=b._glcanvas.data()[0].regl;if(o&&(J(b.width)!==o._gl.drawingBufferWidth||J(b.height)!==o._gl.drawingBufferHeight)){if(A)te.error("WebGL context buffer and canvas dimensions do not match due to browser/WebGL bug.");else return te.log("WebGL context buffer and canvas dimensions do not match due to browser/WebGL bug. Clearing graph and plotting again."),le.cleanPlot([],{},e._fullData,b),le.supplyDefaults(e),b=e._fullLayout,le.doCalcdata(e),A++,c()}}return"h"===b.modebar.orientation?b._modebardiv.style("height",null).style("width","100%"):b._modebardiv.style("width",null).style("height",b.height+"px"),le.previousPromises(e)}function p(){if(le.clearAutoMarginIds(e),_e.drawMarginPushers(e),de.allowAutoMargin(e),b._has("pie"))for(var t=e._fullData,a=0,o;a<t.length;a++)o=t[a],"pie"===o.type&&o.automargin&&le.allowAutoMargin(e,"pie."+o.uid+".automargin");return le.doAutoMargin(e),le.previousPromises(e)}function u(){return le.didMarginChange(T,b._size)?te.syncOrAsync([p,_e.layoutStyles],e):void 0}function g(){return w?te.syncOrAsync([ie.getComponentMethod("shapes","calcAutorange"),ie.getComponentMethod("annotations","calcAutorange"),m],e):void m()}function m(){e._transitioning||(_e.doAutoRangeAndConstraints(e),_&&de.saveRangeInitial(e),ie.getComponentMethod("rangeslider","calcAutorange")(e))}function h(){return de.draw(e,_?"":"redraw")}var y;if(e=te.getGraphDiv(e),oe.init(e),te.isPlainObject(t)){var f=t;t=f.data,r=f.layout,n=f.config,y=f.frames}var x=oe.triggerHandler(e,"plotly_beforeplot",[t,r,n]);if(!1===x)return Promise.reject();t||r||te.isPlotDiv(e)||te.warn("Calling Plotly.plot as if redrawing but this container doesn't yet have a plot.",e),l(e,n),r||(r={}),Q.select(e).classed("js-plotly-plot",!0),ce.makeTester(),Array.isArray(e._promises)||(e._promises=[]);var _=0===(e.data||[]).length&&Array.isArray(t);Array.isArray(t)&&(xe.cleanData(t),_?e.data=t:e.data.push.apply(e.data,t),e.empty=!1),(!e.layout||_)&&(e.layout=xe.cleanLayout(r)),le.supplyDefaults(e);var b=e._fullLayout,v=b._has("cartesian");if(!b._has("polar")&&t&&t[0]&&t[0].r)return te.log("Legacy polar charts are deprecated!"),s(e,t,r);b._replotting=!0,_&&Y(e),e.framework!==Y&&(e.framework=Y,Y(e)),ce.initGradients(e),_&&de.saveShowSpikeInitial(e);var w=!e.calcdata||e.calcdata.length!==(e._fullData||[]).length;w&&le.doCalcdata(e);for(var k=0;k<e.calcdata.length;k++)e.calcdata[k][0].trace=e._fullData[k];e._context.responsive?!e._responsiveChartHandler&&(e._responsiveChartHandler=function(){te.isHidden(e)||le.resize(e)},window.addEventListener("resize",e._responsiveChartHandler)):te.clearResponsive(e);var T=te.extendFlat({},b._size),A=0,S=[le.previousPromises,d,c,p,u];v&&S.push(g),S.push(_e.layoutStyles),v&&S.push(h),S.push(_e.drawData,_e.finalDraw,ue,le.addLinks,le.rehover,le.redrag,le.doAutoMargin,le.previousPromises);var C=te.syncOrAsync(S,e);return C&&C.then||(C=Promise.resolve()),C.then(function(){return o(e),e})},a.purge=function(e){e=te.getGraphDiv(e);var t=e._fullLayout||{},a=e._fullData||[];return le.cleanPlot([],{},a,t),le.purge(e),oe.purge(e),t._container&&t._container.remove(),delete e._context,e},a.react=function(e,t,r,n){function s(){return a.addFrames(e,d)}var d,c;e=te.getGraphDiv(e),xe.clearPromiseQueue(e);var p=e._fullData,u=e._fullLayout;if(!te.isPlotDiv(e)||!p||!u)c=a.newPlot(e,t,r,n);else{if(te.isPlainObject(t)){var g=t;t=g.data,r=g.layout,n=g.config,d=g.frames}var m=!1;if(n){var h=te.extendDeep({},e._context);e._context=void 0,l(e,n),m=q(h,e._context)}e.data=t||[],xe.cleanData(e.data),e.layout=r||{},xe.cleanLayout(e.layout),N(e.data,e.layout,p,u),le.supplyDefaults(e,{skipUpdateCalc:!0});var y=e._fullData,f=e._fullLayout,x=void 0===f.datarevision,_=f.transition,b=U(e,u,f,x,_),v=b.newDataRevision,w=V(e,p,y,x,_,v);z(e)&&(b.layoutReplot=!0),w.calc||b.calc?e.calcdata=void 0:le.supplyDefaultsUpdateCalc(e.calcdata,y);var k=[];if(d&&(e._transitionData={},le.createTransitionData(e),k.push(s)),f.transition&&!m&&(w.anim||b.anim))le.doCalcdata(e),_e.doAutoRangeAndConstraints(e),k.push(function(){return le.transitionFromReact(e,w,b,u)});else if(w.fullReplot||b.layoutReplot||m)e._fullLayout._skipDefaults=!0,k.push(a.plot);else{for(var T in b.arrays){var A=b.arrays[T];if(A.length){var S=ie.getComponentMethod(T,"drawOne");if(S!==te.noop)for(var C=0;C<A.length;C++)S(e,A[C]);else{var L=ie.getComponentMethod(T,"draw");if(L===te.noop)throw new Error("cannot draw components: "+T);L(e)}}}k.push(le.previousPromises),w.style&&k.push(_e.doTraceStyle),(w.colorbars||b.colorbars)&&k.push(_e.doColorBars),b.legend&&k.push(_e.doLegend),b.layoutstyle&&k.push(_e.layoutStyles),b.axrange&&I(k),b.ticks&&k.push(_e.doTicksRelayout),b.modebar&&k.push(_e.doModeBar),b.camera&&k.push(_e.doCamera),k.push(o)}k.push(le.rehover,le.redrag),c=te.syncOrAsync(k,e),c&&c.then||(c=Promise.resolve(e))}return c.then(function(){return e.emit("plotly_react",{data:t,layout:r}),e})},a.redraw=function(e){if(e=te.getGraphDiv(e),!te.isPlotDiv(e))throw new Error("This element is not a Plotly plot: "+e);return xe.cleanData(e.data),xe.cleanLayout(e.layout),e.calcdata=void 0,a.plot(e).then(function(){return e.emit("plotly_redraw"),e})},a.relayout=L,a.restyle=w,a.setPlotConfig=function(e){return te.extendFlat(ye,e)},a.update=D,a._guiRelayout=O(L),a._guiRestyle=O(w),a._guiUpdate=O(D),a._storeDirectGUIEdit=function(e,t,a){for(var o in a){var r=ae(e,o);A(o,r.get(),a[o],t)}}},{"../components/color":524,"../components/drawing":546,"../constants/xmlns_namespaces":634,"../lib":657,"../lib/events":647,"../lib/queue":672,"../lib/svg_text_utils":681,"../plots/cartesian/axes":705,"../plots/cartesian/constants":711,"../plots/cartesian/graph_interact":714,"../plots/cartesian/select":724,"../plots/plots":768,"../plots/polar/legacy":776,"../registry":788,"./edit_types":688,"./helpers":689,"./manage_arrays":691,"./plot_config":693,"./plot_schema":694,"./subroutines":696,d3:108,"fast-isnumeric":201,"has-hover":379}],693:[function(e,t){'use strict';function a(e,t){for(var o in e){var r=e[o];r.valType?t[o]=r.dflt:(!t[o]&&(t[o]={}),a(r,t[o]))}}var o={staticPlot:{valType:"boolean",dflt:!1},plotlyServerURL:{valType:"string",dflt:""},editable:{valType:"boolean",dflt:!1},edits:{annotationPosition:{valType:"boolean",dflt:!1},annotationTail:{valType:"boolean",dflt:!1},annotationText:{valType:"boolean",dflt:!1},axisTitleText:{valType:"boolean",dflt:!1},colorbarPosition:{valType:"boolean",dflt:!1},colorbarTitleText:{valType:"boolean",dflt:!1},legendPosition:{valType:"boolean",dflt:!1},legendText:{valType:"boolean",dflt:!1},shapePosition:{valType:"boolean",dflt:!1},titleText:{valType:"boolean",dflt:!1}},autosizable:{valType:"boolean",dflt:!1},responsive:{valType:"boolean",dflt:!1},fillFrame:{valType:"boolean",dflt:!1},frameMargins:{valType:"number",dflt:0,min:0,max:.5},scrollZoom:{valType:"flaglist",flags:["cartesian","gl3d","geo","mapbox"],extras:[!0,!1],dflt:"gl3d+geo+mapbox"},doubleClick:{valType:"enumerated",values:[!1,"reset","autosize","reset+autosize"],dflt:"reset+autosize"},doubleClickDelay:{valType:"number",dflt:300,min:0},showAxisDragHandles:{valType:"boolean",dflt:!0},showAxisRangeEntryBoxes:{valType:"boolean",dflt:!0},showTips:{valType:"boolean",dflt:!0},showLink:{valType:"boolean",dflt:!1},linkText:{valType:"string",dflt:"Edit chart",noBlank:!0},sendData:{valType:"boolean",dflt:!0},showSources:{valType:"any",dflt:!1},displayModeBar:{valType:"enumerated",values:["hover",!0,!1],dflt:"hover"},showSendToCloud:{valType:"boolean",dflt:!1},showEditInChartStudio:{valType:"boolean",dflt:!1},modeBarButtonsToRemove:{valType:"any",dflt:[]},modeBarButtonsToAdd:{valType:"any",dflt:[]},modeBarButtons:{valType:"any",dflt:!1},toImageButtonOptions:{valType:"any",dflt:{}},displaylogo:{valType:"boolean",dflt:!0},watermark:{valType:"boolean",dflt:!1},plotGlPixelRatio:{valType:"number",dflt:2,min:1,max:4},setBackground:{valType:"any",dflt:"transparent"},topojsonURL:{valType:"string",noBlank:!0,dflt:"https://cdn.plot.ly/"},mapboxAccessToken:{valType:"string",dflt:null},logging:{valType:"integer",min:0,max:2,dflt:1},notifyOnLogging:{valType:"integer",min:0,max:2,dflt:0},queueLength:{valType:"integer",min:0,dflt:0},globalTransforms:{valType:"any",dflt:[]},locale:{valType:"string",dflt:"en-US"},locales:{valType:"any",dflt:{}}},r={};a(o,r),t.exports={configAttributes:o,dfltConfig:r}},{}],694:[function(e,t,a){'use strict';function o(e,t){var a=e._basePlotModules,o,r,n,l;if(a){var s;for(o=0;o<a.length;o++){if(n=a[o],n.attrRegex&&n.attrRegex.test(t)){if(n.layoutAttrOverrides)return n.layoutAttrOverrides;!s&&n.layoutAttributes&&(s=n.layoutAttributes)}var d=n.baseLayoutAttrOverrides;if(d&&t in d)return d[t]}if(s)return s}var c=e._modules;if(c)for(o=0;o<c.length;o++)if(l=c[o].layoutAttributes,l&&t in l)return l[t];for(r in x.componentsRegistry){if(n=x.componentsRegistry[r],"colorscale"===n.name&&0===t.indexOf("coloraxis"))return n.layoutAttributes[t];if(!n.schema&&t===n.name)return n.layoutAttributes}return t in v?v[t]:"radialaxis"===t||"angularaxis"===t?S[t]:S.layout[t]||!1}function r(e,t,a){if(!e)return!1;if(e._isLinkedToArray)if(n(t[a]))a++;else if(a<t.length)return!1;for(;a<t.length;a++){var o=e[t[a]];if(I(o))e=o;else break;if(a===t.length-1)break;if(e._isLinkedToArray){if(a++,!n(t[a]))return!1;}else if("info_array"===e.valType){a++;var r=t[a];if(!n(r))return!1;var l=e.items;if(Array.isArray(l)){if(r>=l.length)return!1;if(2===e.dimensions){if(a++,t.length===a)return e;var s=t[a];if(!n(s))return!1;e=l[r][s]}else e=l[r]}else e=l}}return e}function n(e){return e===Math.round(e)&&0<=e}function l(e){var t,o;"area"===e?(t={attributes:A},o={}):(t=x.modules[e]._module,o=t.basePlotModule);var r={type:null},i=E({},b),n=E({},t.attributes);a.crawl(n,function(e,t,a,o,r){z(i,r).set(void 0),void 0===e&&z(n,r).set(void 0)}),E(r,i),x.traceIs(e,"noOpacity")&&delete r.opacity,x.traceIs(e,"showLegend")||(delete r.showlegend,delete r.legendgroup),x.traceIs(e,"noHover")&&(delete r.hoverinfo,delete r.hoverlabel),t.selectPoints||delete r.selectedpoints,E(r,n),o.attributes&&E(r,o.attributes),r.type=e;var l={meta:t.meta||{},categories:t.categories||{},animatable:!!t.animatable,type:e,attributes:p(r)};if(t.layoutAttributes){var s={};E(s,t.layoutAttributes),l.layoutAttributes=p(s)}return t.animatable||a.crawl(l,function(e){a.isValObject(e)&&"anim"in e&&delete e.anim}),l}function s(){var e={},t,a;for(t in E(e,v),x.subplotsRegistry)if(a=x.subplotsRegistry[t],a.layoutAttributes)if(Array.isArray(a.attr))for(var o=0;o<a.attr.length;o++)y(e,a,a.attr[o]);else{var r="subplot"===a.attr?a.name:a.attr;y(e,a,r)}for(t in e=h(e),x.componentsRegistry){a=x.componentsRegistry[t];var n=a.schema;if(n&&(n.subplots||n.layout)){var l=n.subplots;if(l&&l.xaxis&&!l.yaxis)for(var s in l.xaxis)delete e.yaxis[s]}else"colorscale"===a.name?E(e,a.layoutAttributes):a.layoutAttributes&&f(e,a.layoutAttributes,a.name)}return{layoutAttributes:p(e)}}function d(e){var t=x.transformsRegistry[e],a=E({},t.attributes);return Object.keys(x.componentsRegistry).forEach(function(t){var o=x.componentsRegistry[t];o.schema&&o.schema.transforms&&o.schema.transforms[e]&&Object.keys(o.schema.transforms[e]).forEach(function(t){f(a,o.schema.transforms[e][t],t)})}),{attributes:p(a)}}function c(){var e={frames:E({},w)};return p(e),e.frames}function p(e){return u(e),g(e),m(e),e}function u(e){function t(){return{valType:"string",editType:"none"}}a.crawl(e,function(e,o,r){a.isValObject(e)?"data_array"===e.valType?(e.role="data",r[o+"src"]=t(o)):!0===e.arrayOk&&(r[o+"src"]=t(o)):I(e)&&(e.role="object")})}function g(e){a.crawl(e,function(e,t,a){if(e){var o=e._isLinkedToArray;o&&(delete e._isLinkedToArray,a[t]={items:{}},a[t].items[o]=e,a[t].role="object")}})}function m(e){function t(e){for(var a in e)if(I(e[a]))t(e[a]);else if(Array.isArray(e[a]))for(var o=0;o<e[a].length;o++)t(e[a][o]);else e[a]instanceof RegExp&&(e[a]=e[a].toString())}t(e)}function h(e){return L(e,{radialaxis:S.radialaxis,angularaxis:S.angularaxis}),L(e,S.layout),e}function y(e,t,a){var o=z(e,a),r=E({},t.layoutAttributes);r._isSubplotObj=!0,o.set(r)}function f(e,t,a){var o=z(e,a);o.set(E(o.get()||{},t))}var x=e("../registry"),_=e("../lib"),b=e("../plots/attributes"),v=e("../plots/layout_attributes"),w=e("../plots/frame_attributes"),k=e("../plots/animation_attributes"),T=e("./plot_config").configAttributes,A=e("../plots/polar/legacy/area_attributes"),S=e("../plots/polar/legacy/axis_attributes"),C=e("./edit_types"),L=_.extendFlat,E=_.extendDeepAll,I=_.isPlainObject,P=_.isArrayOrTypedArray,z=_.nestedProperty,D=_.valObjectMeta,O="_isSubplotObj",R="_isLinkedToArray",M="_deprecated",j=[O,R,"_arrayAttrRegexps",M];a.IS_SUBPLOT_OBJ=O,a.IS_LINKED_TO_ARRAY=R,a.DEPRECATED=M,a.UNDERSCORE_ATTRS=j,a.get=function(){var e={};x.allTypes.concat("area").forEach(function(t){e[t]=l(t)});var t={};return Object.keys(x.transformsRegistry).forEach(function(e){t[e]=d(e)}),{defs:{valObjects:D,metaKeys:j.concat(["description","role","editType","impliedEdits"]),editType:{traces:C.traces,layout:C.layout},impliedEdits:{}},traces:e,layout:s(),transforms:t,frames:c(),animation:p(k),config:p(T)}},a.crawl=function(e,t,o,r){var i=o||0;r=r||"",Object.keys(e).forEach(function(o){var n=e[o];if(-1===j.indexOf(o)){var l=(r?r+".":"")+o;t(n,o,e,i,l),a.isValObject(n)||I(n)&&"impliedEdits"!==o&&a.crawl(n,t,i+1,l)}})},a.isValObject=function(e){return e&&e.valType!==void 0},a.findArrayAttributes=function(e){function t(e,t,a,r){n=n.slice(0,r).concat([t]),l=l.slice(0,r).concat([e&&e._isLinkedToArray]);var i=e&&("data_array"===e.valType||!0===e.arrayOk)&&("colorbar"!==n[r-1]||"ticktext"!==t&&"tickvals"!==t);i&&o(s,0,"")}function o(e,t,a){var i=e[n[t]],s=a+n[t];if(t===n.length-1)P(i)&&r.push(d+s);else if(!l[t])I(i)&&o(i,t+1,s+".");else if(Array.isArray(i))for(var c=0;c<i.length;c++)I(i[c])&&o(i[c],t+1,s+"["+c+"].")}var r=[],n=[],l=[],s,d;s=e,d="",a.crawl(b,t),e._module&&e._module.attributes&&a.crawl(e._module.attributes,t);var c=e.transforms;if(c)for(var p=0;p<c.length;p++){var u=c[p],g=u._module;g&&(d="transforms["+p+"].",s=u,a.crawl(g.attributes,t))}return r},a.getTraceValObject=function(e,t){var a=t[0],o=1,l,s;if("transforms"===a){if(1===t.length)return b.transforms;var d=e.transforms;if(!Array.isArray(d)||!d.length)return!1;var c=t[1];if(!n(c)||c>=d.length)return!1;l=(x.transformsRegistry[d[c].type]||{}).attributes,s=l&&l[t[2]],o=3}else if("area"===e.type)s=A[a];else{var p=e._module;if(p||(p=(x.modules[e.type||b.type.dflt]||{})._module),!p)return!1;if(l=p.attributes,s=l&&l[a],!s){var u=p.basePlotModule;u&&u.attributes&&(s=u.attributes[a])}s||(s=b[a])}return r(s,t,o)},a.getLayoutValObject=function(e,t){var a=o(e,t[0]);return r(a,t,1)}},{"../lib":657,"../plots/animation_attributes":700,"../plots/attributes":702,"../plots/frame_attributes":734,"../plots/layout_attributes":759,"../plots/polar/legacy/area_attributes":774,"../plots/polar/legacy/axis_attributes":775,"../registry":788,"./edit_types":688,"./plot_config":693}],695:[function(e,t,a){'use strict';function o(e){return e&&"string"==typeof e}function r(e){var t=e.length-1;return"s"!==e.charAt(t)&&i.warn("bad argument to arrayDefaultKey: "+e),e.substr(0,e.length-1)+"defaults"}var i=e("../lib"),n=e("../plots/attributes"),l="templateitemname",s={name:{valType:"string",editType:"none"}};s[l]={valType:"string",editType:"calc"},a.templatedArray=function(e,t){return t._isLinkedToArray=e,t.name=s.name,t[l]=s[l],t},a.traceTemplater=function(e){function t(t){o=i.coerce(t,{},n,"type");var l={type:o,_template:null};if(o in a){r=e[o];var s=a[o]%r.length;a[o]++,l._template=r[s]}else;return l}var a={},o,r;for(o in e)r=e[o],Array.isArray(r)&&r.length&&(a[o]=0);return{newTrace:t}},a.newContainer=function(e,t,a){var o=e._template,r=o&&(o[t]||a&&o[a]);i.isPlainObject(r)||(r=null);var n=e[t]={_template:r};return n},a.arrayTemplater=function(e,t,a){function i(e){var t={name:e.name,_input:e},r=t[l]=e[l];if(!o(r))return t._template=d,t;for(var n=0,s;n<c.length;n++)if(s=c[n],s.name===r)return p[r]=1,t._template=s,t;return t[a]=e[a]||!1,t._template=!1,t}function n(){for(var e=[],t=0;t<c.length;t++){var a=c[t],r=a.name;if(o(r)&&!p[r]){var n={_template:a,name:r,_input:{_templateitemname:r}};n[l]=a[l],e.push(n),p[r]=1}}return e}var s=e._template,d=s&&s[r(t)],c=s&&s[t];Array.isArray(c)&&c.length||(c=[]);var p={};return{newItem:i,defaultItems:n}},a.arrayDefaultKey=r,a.arrayEditor=function(e,t,a){function o(){g={},p&&(g[u]={},g[u][l]=p)}function r(e,t){g[e]=t}function n(e,t){p?i.nestedProperty(g[u],e).set(t):g[u+"."+e]=t}function s(){var e=g;return o(),e}var d=(i.nestedProperty(e,t).get()||[]).length,c=a._index,p=c>=d&&(a._input||{})._templateitemname;p&&(c=d);var u=t+"["+c+"]",g;return o(),{modifyBase:r,modifyItem:n,getUpdateObj:s,applyUpdate:function(t,a){t&&n(t,a);var o=s();for(var r in o)i.nestedProperty(e,r).set(o[r])}}}},{"../lib":657,"../plots/attributes":702}],696:[function(e,t,a){'use strict';var u=Math.min,g=Math.max;function o(e,t,a){for(var o=0;o<a.length;o++){var r=a[o][0],n=a[o][1];if(!(r[0]>=e[1]||r[1]<=e[0])&&n[0]<t[1]&&n[1]>t[0])return!0}return!1}function r(e){function t(e,t,a){var o=e._lw/2;return"x"===e._id.charAt(0)?t?"top"===a?t._offset-g-o:t._offset+t._length+g+o:u.t+u.h*(1-(e.position||0))+o%1:t?"right"===a?t._offset+t._length+g+o:t._offset-g-o:u.l+u.w*(e.position||0)+o%1}function r(e){return"M"+q+","+e+"H"+G}function n(e){return"M"+C._offset+","+e+"h"+C._length}function s(e){return"M"+e+","+$+"V"+K}function d(e){return"M"+e+","+L._offset+"v"+L._length}function c(e,t,a){if(!e.showline||v!==e._mainSubplot)return"";if(!e._anchorAxis)return a(e._mainLinePosition);var o=t(e._mainLinePosition);return e.mirror&&(o+=t(e._mainMirrorPosition)),o}var p=e._fullLayout,u=p._size,g=u.p,h=k.list(e,"",!0),x,v,A,S,C,L;if(p._paperdiv.style({width:e._context.responsive&&p.autosize&&!e._context._hasZeroWidth&&!e.layout.width?"100%":p.width+"px",height:e._context.responsive&&p.autosize&&!e._context._hasZeroHeight&&!e.layout.height?"100%":p.height+"px"}).selectAll(".main-svg").call(b.setSize,p.width,p.height),e._context.setBackground(e,p.paper_bgcolor),a.drawMainTitle(e),w.manage(e),!p._has("cartesian"))return y.previousPromises(e);for(x=0;x<h.length;x++){S=h[x];var E=S._anchorAxis;S._linepositions={},S._lw=b.crispRound(e,S.linewidth,1),S._mainLinePosition=t(S,E,S.side),S._mainMirrorPosition=S.mirror&&E?t(S,E,T.OPPOSITE_SIDE[S.side]):null}var I=[],P=[],z=[],D=1===_.opacity(p.paper_bgcolor)&&1===_.opacity(p.plot_bgcolor)&&p.paper_bgcolor===p.plot_bgcolor;for(v in p._plots)if(A=p._plots[v],A.mainplot)A.bg&&A.bg.remove(),A.bg=void 0;else{var O=A.xaxis.domain,R=A.yaxis.domain,M=A.plotgroup;if(o(O,R,z)){var j=M.node(),B=A.bg=f.ensureSingle(M,"rect","bg");j.insertBefore(B.node(),j.childNodes[0]),P.push(v)}else M.select("rect.bg").remove(),z.push([O,R]),D||(I.push(v),P.push(v))}var F=p._bgLayer.selectAll(".bg").data(I);for(F.enter().append("rect").classed("bg",!0),F.exit().remove(),F.each(function(e){p._plots[e].bg=m.select(this)}),x=0;x<P.length;x++)A=p._plots[P[x]],C=A.xaxis,L=A.yaxis,A.bg&&A.bg.call(b.setRect,C._offset-g,L._offset-g,C._length+2*g,L._length+2*g).call(_.fill,p.plot_bgcolor).style("stroke-width",0);if(!p._hasOnlyLargeSploms)for(v in p._plots){A=p._plots[v],C=A.xaxis,L=A.yaxis;var N=A.clipId="clip"+p._uid+v+"plot",V=f.ensureSingleById(p._clips,"clipPath",N,function(e){e.classed("plotclip",!0).append("rect")});A.clipRect=V.select("rect").attr({width:C._length,height:L._length}),b.setTranslate(A.plot,C._offset,L._offset);var U,H;A._hasClipOnAxisFalse?(U=null,H=N):(U=N,H=null),b.setClipUrl(A.plot,U,e),A.layerClipId=H}var q,G,Y,W,X,Z,K,$,J,Q,ee,te,ae;for(v in p._plots){A=p._plots[v],C=A.xaxis,L=A.yaxis;var oe="M0,0";i(C,v)&&(X=l(C,"left",L,h),q=C._offset-(X?g+X:0),Z=l(C,"right",L,h),G=C._offset+C._length+(Z?g+Z:0),Y=t(C,L,"bottom"),W=t(C,L,"top"),ae=!C._anchorAxis||v!==C._mainSubplot,ae&&("allticks"===C.mirror||"all"===C.mirror)&&(C._linepositions[v]=[Y,W]),oe=c(C,r,n),ae&&C.showline&&("all"===C.mirror||"allticks"===C.mirror)&&(oe+=r(Y)+r(W)),A.xlines.style("stroke-width",C._lw+"px").call(_.stroke,C.showline?C.linecolor:"rgba(0,0,0,0)")),A.xlines.attr("d",oe);var re="M0,0";i(L,v)&&(ee=l(L,"bottom",C,h),K=L._offset+L._length+(ee?g:0),te=l(L,"top",C,h),$=L._offset-(te?g:0),J=t(L,C,"left"),Q=t(L,C,"right"),ae=!L._anchorAxis||v!==L._mainSubplot,ae&&("allticks"===L.mirror||"all"===L.mirror)&&(L._linepositions[v]=[J,Q]),re=c(L,s,d),ae&&L.showline&&("all"===L.mirror||"allticks"===L.mirror)&&(re+=s(J)+s(Q)),A.ylines.style("stroke-width",L._lw+"px").call(_.stroke,L.showline?L.linecolor:"rgba(0,0,0,0)")),A.ylines.attr("d",re)}return k.makeClipPaths(e),y.previousPromises(e)}function i(e,t){return(e.ticks||e.showline)&&(t===e._mainSubplot||"all"===e.mirror||"allticks"===e.mirror)}function n(e,t,a){if(!a.showline||!a._lw)return!1;if("all"===a.mirror||"allticks"===a.mirror)return!0;var o=a._anchorAxis;if(!o)return!1;var r=T.FROM_BL[t];return a.side===t?o.domain[r]===e.domain[r]:a.mirror&&o.domain[1-r]===e.domain[1-r]}function l(e,t,a,o){if(n(e,t,a))return a._lw;for(var r=0,l;r<o.length;r++)if(l=o[r],l._mainAxis===a._mainAxis&&n(e,t,l))return l._lw;return 0}function s(e,t){var a=e.title,o=e._size,r=0;switch("start"===t?r=a.pad.l:"end"===t&&(r=-a.pad.r),a.xref){case"paper":return o.l+o.w*a.x+r;case"container":default:return e.width*a.x+r;}}function d(e,t){var a=e.title,o=e._size,r=0;if("0em"!==t&&t?t===T.CAP_SHIFT+"em"&&(r=a.pad.t):r=-a.pad.b,"auto"===a.y)return o.t/2;switch(a.yref){case"paper":return o.t+o.h-o.h*a.y+r;case"container":default:return e.height-e.height*a.y+r;}}function c(e){var t=e.title,a="middle";return f.isRightAnchor(t)?a="end":f.isLeftAnchor(t)&&(a="start"),a}function p(e){var t=e.title,a="0em";return f.isTopAnchor(t)?a=T.CAP_SHIFT+"em":f.isMiddleAnchor(t)&&(a=T.MID_SHIFT+"em"),a}var m=e("d3"),h=e("../registry"),y=e("../plots/plots"),f=e("../lib"),x=e("../lib/clear_gl_canvases"),_=e("../components/color"),b=e("../components/drawing"),v=e("../components/titles"),w=e("../components/modebar"),k=e("../plots/cartesian/axes"),T=e("../constants/alignment"),A=e("../plots/cartesian/constraints"),S=A.enforce,C=A.clean,L=e("../plots/cartesian/autorange").doAutoRange;a.layoutStyles=function(e){return f.syncOrAsync([y.doAutoMargin,r],e)},a.drawMainTitle=function(e){var t=e._fullLayout,a=c(t),o=p(t);v.draw(e,"gtitle",{propContainer:t,propName:"title.text",placeholder:t._dfltTitle.plot,attributes:{x:s(t,a),y:d(t,o),"text-anchor":a,dy:o}})},a.doTraceStyle=function(e){var t=e.calcdata,o=[],r;for(r=0;r<t.length;r++){var n=t[r],l=n[0]||{},s=l.trace||{},d=s._module||{},c=d.arraysToCalcdata;c&&c(n,s);var p=d.editStyle;p&&o.push({fn:p,cd0:l})}if(o.length){for(r=0;r<o.length;r++){var u=o[r];u.fn(e,u.cd0)}x(e),a.redrawReglTraces(e)}return y.style(e),h.getComponentMethod("legend","draw")(e),y.previousPromises(e)},a.doColorBars=function(e){return h.getComponentMethod("colorbar","draw")(e),y.previousPromises(e)},a.layoutReplot=function(e){var t=e.layout;return e.layout=void 0,h.call("plot",e,"",t)},a.doLegend=function(e){return h.getComponentMethod("legend","draw")(e),y.previousPromises(e)},a.doTicksRelayout=function(e){return k.draw(e,"redraw"),e._fullLayout._hasOnlyLargeSploms&&(h.subplotsRegistry.splom.updateGrid(e),x(e),a.redrawReglTraces(e)),a.drawMainTitle(e),y.previousPromises(e)},a.doModeBar=function(e){var t=e._fullLayout;w.manage(e);for(var a=0,o;a<t._basePlotModules.length;a++)o=t._basePlotModules[a].updateFx,o&&o(e);return y.previousPromises(e)},a.doCamera=function(e){for(var t=e._fullLayout,a=t._subplots.gl3d,o=0;o<a.length;o++){var r=t[a[o]],n=r._scene;n.setViewport(r)}},a.drawData=function(e){var t=e._fullLayout;x(e);for(var o=t._basePlotModules,r=0;r<o.length;r++)o[r].plot(e);return a.redrawReglTraces(e),y.style(e),h.getComponentMethod("shapes","draw")(e),h.getComponentMethod("annotations","draw")(e),h.getComponentMethod("images","draw")(e),t._replotting=!1,y.previousPromises(e)},a.redrawReglTraces=function(e){var t=e._fullLayout;if(t._has("regl")){var a=e._fullData,o=[],r=[],n,l;for(t._hasOnlyLargeSploms&&t._splomGrid.draw(),n=0;n<a.length;n++){var s=a[n];!0===s.visible&&0!==s._length&&("splom"===s.type?t._splomScenes[s.uid].draw():"scattergl"===s.type?f.pushUnique(o,s.xaxis+s.yaxis):"scatterpolargl"===s.type&&f.pushUnique(r,s.subplot))}for(n=0;n<o.length;n++)l=t._plots[o[n]],l._scene&&l._scene.draw();for(n=0;n<r.length;n++)l=t[r[n]]._subplot,l._scene&&l._scene.draw()}},a.doAutoRangeAndConstraints=function(e){for(var t=e._fullLayout,a=k.list(e,"",!0),o=t._axisMatchGroups||[],r={},n=0,l,s;n<a.length;n++)l=a[n],C(e,l),L(e,l),r[l._id]=1;S(e);groupLoop:for(var d=0;d<o.length;d++){var c=o[d],p=null,m;for(m in c)if(l=k.getFromId(e,m),r[l._id]){if(!1===l.autorange)continue groupLoop;s=f.simpleMap(l.range,l.r2l),p?p[0]<p[1]?(p[0]=u(p[0],s[0]),p[1]=g(p[1],s[1])):(p[0]=g(p[0],s[0]),p[1]=u(p[1],s[1])):p=s}for(m in c)l=k.getFromId(e,m),l.range=f.simpleMap(p,l.l2r),l._input.range=l.range.slice(),l.setScale()}},a.finalDraw=function(e){h.getComponentMethod("rangeslider","draw")(e),h.getComponentMethod("rangeselector","draw")(e)},a.drawMarginPushers=function(e){h.getComponentMethod("legend","draw")(e),h.getComponentMethod("rangeselector","draw")(e),h.getComponentMethod("sliders","draw")(e),h.getComponentMethod("updatemenus","draw")(e),h.getComponentMethod("colorbar","draw")(e)}},{"../components/color":524,"../components/drawing":546,"../components/modebar":584,"../components/titles":619,"../constants/alignment":626,"../lib":657,"../lib/clear_gl_canvases":642,"../plots/cartesian/autorange":704,"../plots/cartesian/axes":705,"../plots/cartesian/constraints":712,"../plots/plots":768,"../registry":788,d3:108}],697:[function(e,t,a){'use strict';function o(e,t){function a(t,a,r){if(g(a)&&g(t))o(t,a);else if(Array.isArray(a)&&Array.isArray(t)){var i=f.arrayTemplater({_template:e},r);for(s=0;s<a.length;s++){var n=a[s],l=i.newItem(n)._template;l&&o(l,n)}var d=i.defaultItems();for(s=0;s<d.length;s++)a.push(d[s]._template);for(s=0;s<a.length;s++)delete a[s].templateitemname}}e=u.extendDeep({},e);var n=Object.keys(e).sort(),l,s;for(l=0;l<n.length;l++){var d=n[l],c=e[d];if(d in t?a(c,t[d],d):t[d]=c,r(d)===d)for(var p in t){var m=r(p);p===m||m!==d||p in e||a(c,t[p],d)}}}function r(e){return e.replace(/[0-9]+$/,"")}function n(e,t,a,o,l){var s=l&&a(l);for(var c in e){var p=e[c],m=d(e,c,o),h=d(e,c,l),y=a(h);if(!y){var x=r(c);x!==c&&(h=d(e,x,l),y=a(h))}if(!(s&&s===y)){if(!y||y._noTemplating||"data_array"===y.valType||y.arrayOk&&Array.isArray(p))continue;if(!y.valType&&g(p))n(p,t,a,m,h);else if(y._isLinkedToArray&&Array.isArray(p)){for(var _=!1,b=0,v={},w=0,k;w<p.length;w++)if(k=p[w],g(k)){var T=k.name;if(T)v[T]||(n(k,t,a,d(p,b,m),d(p,b,h)),b++,v[T]=1);else if(!_){var A=f.arrayDefaultKey(c),S=d(e,A,o),C=d(p,b,m);n(k,t,a,C,d(p,b,h));var L=u.nestedProperty(t,C),E=u.nestedProperty(t,S);E.set(L.get()),L.set(null),_=!0}}}else{var I=u.nestedProperty(t,m);I.set(p)}}}}function l(e,t){return m.getLayoutValObject(e,u.nestedProperty({},t).parts)}function s(e,t){return m.getTraceValObject(e,u.nestedProperty({},t).parts)}function d(e,t,a){var o;return o=a?Array.isArray(e)?a+"["+t+"]":a+"."+t:t,o}function c(e){for(var t=0;t<e.length;t++)if(g(e[t]))return!0}function p(e){var t;switch(e.code){case"data":t="The template has no key data.";break;case"layout":t="The template has no key layout.";break;case"missing":t=e.path?"There are no templates for item "+e.path+" with name "+e.templateitemname:"There are no templates for trace "+e.index+", of type "+e.traceType+".";break;case"unused":t=e.path?"The template item at "+e.path+" was not used in constructing the plot.":e.dataCount?"Some of the templates of type "+e.traceType+" were not used. The template has "+e.templateCount+" traces, the data only has "+e.dataCount+" of this type.":"The template has "+e.templateCount+" traces of type "+e.traceType+" but there are none in the data.";break;case"reused":t="Some of the templates of type "+e.traceType+" were used more than once. The template has "+e.templateCount+" traces, the data has "+e.dataCount+" of this type.";}return e.msg=t,e}var u=e("../lib"),g=u.isPlainObject,m=e("./plot_schema"),h=e("../plots/plots"),y=e("../plots/attributes"),f=e("./plot_template"),x=e("./plot_config").dfltConfig;a.makeTemplate=function(e){e=u.isPlainObject(e)?e:u.getGraphDiv(e),e=u.extendDeep({_context:x},{data:e.data,layout:e.layout}),h.supplyDefaults(e);var t=e.data||[],a=e.layout||{};a._basePlotModules=e._fullLayout._basePlotModules,a._modules=e._fullLayout._modules;var r={data:{},layout:{}};t.forEach(function(e){var t={};n(e,t,s.bind(null,e));var a=u.coerce(e,{},y,"type"),o=r.data[a];o||(o=r.data[a]=[]),o.push(t)}),n(a,r.layout,l.bind(null,a)),delete r.layout.template;var d=a.template;if(g(d)){var c=d.layout,p,m,f,_,b,v;g(c)&&o(c,r.layout);var w=d.data;if(g(w)){for(m in r.data)if(f=w[m],Array.isArray(f)){for(b=r.data[m],v=b.length,_=f.length,p=0;p<v;p++)o(f[p%_],b[p]);for(p=v;p<_;p++)b.push(u.extendDeep({},f[p]))}for(m in w)m in r.data||(r.data[m]=u.extendDeep([],w[m]))}}return r},a.validateTemplate=function(e,t){function a(e,t){for(var o in e)if("_"!==o.charAt(0)&&g(e[o])){var n=r(o),l=[],s;for(s=0;s<t.length;s++)l.push(d(e,o,t[s])),n!==o&&l.push(d(e,n,t[s]));for(s=0;s<l.length;s++)v[l[s]]=1;a(e[o],l)}}function o(e,t){for(var a in e)if(-1===a.indexOf("defaults")&&g(e[a])){var r=d(e,a,t);v[r]?o(e[a],r):f.push({code:"unused",path:r})}}function n(e,t){for(var a in e)if("_"!==a.charAt(0)){var o=e[a],r=d(e,a,t);g(o)?(Array.isArray(e)&&!1===o._template&&o.templateitemname&&f.push({code:"missing",path:r,templateitemname:o.templateitemname}),n(o,r)):Array.isArray(o)&&c(o)&&n(o,r)}}var l=u.extendDeep({},{_context:x,data:e.data,layout:e.layout}),s=l.layout||{};g(t)||(t=s.template||{});var m=t.layout,y=t.data,f=[];l.layout=s,l.layout.template=t,h.supplyDefaults(l);var _=l._fullLayout,b=l._fullData,v={};if(g(m)?(a(_,["layout"]),o(m,"layout")):f.push({code:"layout"}),!g(y))f.push({code:"data"});else{for(var w={},k=0,T,A;k<b.length;k++)A=b[k],T=A.type,w[T]=(w[T]||0)+1,A._fullInput._template||f.push({code:"missing",index:A._fullInput.index,traceType:T});for(T in y){var S=y[T].length,C=w[T]||0;S>C?f.push({code:"unused",traceType:T,templateCount:S,dataCount:C}):C>S&&f.push({code:"reused",traceType:T,templateCount:S,dataCount:C})}}return(n({data:b,layout:_},""),f.length)?f.map(p):void 0}},{"../lib":657,"../plots/attributes":702,"../plots/plots":768,"./plot_config":693,"./plot_schema":694,"./plot_template":695}],698:[function(e,t){'use strict';var a=e("fast-isnumeric"),o=e("./plot_api"),r=e("../plots/plots"),i=e("../lib"),n=e("../snapshot/helpers"),l=e("../snapshot/tosvg"),s=e("../snapshot/svgtoimg"),d=e("../version").version,c={format:{valType:"enumerated",values:["png","jpeg","webp","svg","full-json"],dflt:"png"},width:{valType:"number",min:1},height:{valType:"number",min:1},scale:{valType:"number",min:0,dflt:1},setBackground:{valType:"any",dflt:!1},imageDataOnly:{valType:"boolean",dflt:!1}};t.exports=function(e,t){function p(e){return!(e in t)||i.validate(t[e],c[e])}function u(e,a){return i.coerce(t,b,c,e,a)}function g(){return new Promise(function(e){setTimeout(e,n.getDelay(C._fullLayout))})}function m(){return new Promise(function(e,t){function a(){o.purge(C),document.body.removeChild(C)}var c=l(C,v,T),p=C._fullLayout.width,u=C._fullLayout.height;if("full-json"===v){var g=r.graphJson(C,!1,"keepdata","object",!0,!0);return g.version=d,g=JSON.stringify(g),a(),S?e(g):e(n.encodeJSON(g))}if(a(),"svg"===v)return S?e(c):e(n.encodeSVG(c));var m=document.createElement("canvas");m.id=i.randstr(),s({format:v,width:p,height:u,scale:T,canvas:m,svg:c,promise:!0}).then(e).catch(t)})}function h(e){return S?e.replace(n.IMAGE_URL_PREFIX,""):e}t=t||{};var y,f,x,_;if(i.isPlainObject(e)?(y=e.data||[],f=e.layout||{},x=e.config||{},_={}):(e=i.getGraphDiv(e),y=i.extendDeep([],e.data),f=i.extendDeep({},e.layout),x=e._context,_=e._fullLayout||{}),!p("width")&&null!==t.width||!p("height")&&null!==t.height)throw new Error("Height and width should be pixel values.");if(!p("format"))throw new Error("Image format is not jpeg, png, svg or webp.");var b={},v=u("format"),w=u("width"),k=u("height"),T=u("scale"),A=u("setBackground"),S=u("imageDataOnly"),C=document.createElement("div");C.style.position="absolute",C.style.left="-5000px",document.body.appendChild(C);var L=i.extendFlat({},f);w?L.width=w:null===t.width&&a(_.width)&&(L.width=_.width),k?L.height=k:null===t.height&&a(_.height)&&(L.height=_.height);var E=i.extendFlat({},x,{_exportedPlot:!0,staticPlot:!0,setBackground:A}),I=n.getRedrawFunc(C);return new Promise(function(e,t){o.plot(C,y,L,E).then(I).then(g).then(m).then(function(t){e(h(t))}).catch(function(e){t(e)})})}},{"../lib":657,"../plots/plots":768,"../snapshot/helpers":792,"../snapshot/svgtoimg":794,"../snapshot/tosvg":796,"../version":1244,"./plot_api":692,"fast-isnumeric":201}],699:[function(e,t){'use strict';var u=Math.min;function a(e,t,o,r,c,h){h=h||[];for(var y=Object.keys(e),b=0,v;b<y.length;b++)if(v=y[b],"transforms"!==v){var w=h.slice();w.push(v);var p=e[v],T=t[v],A=d(o,v),S=(A||{}).valType,C="info_array"===S,L=(A||{}).items;if(!s(o,v))r.push(l("schema",c,w));else if(f(p)&&f(T)&&"any"!==S)a(p,T,A,r,c,w);else if(C&&x(p)){p.length>T.length&&r.push(l("unused",c,w.concat(T.length)));var E=T.length,I=Array.isArray(L);I&&(E=u(E,L.length));var P,z,D,O,R;if(2===A.dimensions){for(z=0;z<E;z++)if(x(p[z])){p[z].length>T[z].length&&r.push(l("unused",c,w.concat(z,T[z].length)));var M=T[z].length;for(P=0;P<(I?u(M,L[z].length):M);P++)D=I?L[z][P]:L,O=p[z][P],R=T[z][P],g.validate(O,D)?R!==O&&R!==+O&&r.push(l("dynamic",c,w.concat(z,P),O,R)):r.push(l("value",c,w.concat(z,P),O))}else r.push(l("array",c,w.concat(z),p[z]));}else for(z=0;z<E;z++)D=I?L[z]:L,O=p[z],R=T[z],g.validate(O,D)?R!==O&&R!==+O&&r.push(l("dynamic",c,w.concat(z),O,R)):r.push(l("value",c,w.concat(z),O))}else if(A.items&&!C&&x(p)){var B=L[Object.keys(L)[0]],F=[],N,V;for(N=0;N<T.length;N++){var U=T[N]._index||N;if(V=w.slice(),V.push(U),f(p[U])&&f(T[N])){F.push(U);var H=p[U],q=T[N];f(H)&&!1!==H.visible&&!1===q.visible?r.push(l("invisible",c,V)):a(H,q,B,r,c,V)}}for(N=0;N<p.length;N++)V=w.slice(),V.push(N),f(p[N])?-1===F.indexOf(N)&&r.push(l("unused",c,V)):r.push(l("object",c,V,p[N]))}else!f(p)&&f(T)?r.push(l("object",c,w,p)):_(p)||!_(T)||C||"colorscale"===S?v in t?g.validate(p,A)?"enumerated"===A.valType&&(A.coerceNumber&&p!==+T||p!==T)&&r.push(l("dynamic",c,w,p,T)):r.push(l("value",c,w,p)):r.push(l("unused",c,w,p)):r.push(l("array",c,w,p))}return r}function o(e,t){for(var a=e.layout.layoutAttributes,o=0;o<t.length;o++){var r=t[o],n=e.traces[r.type],l=n.layoutAttributes;l&&(r.subplot?g.extendFlat(a[n.attributes.subplot.dflt],l):g.extendFlat(a,l))}return a}function r(e){return x(e)?"In data trace "+e[1]+", ":"In "+e+", "}function l(e,t,a,o,r){a=a||"";var i,n;x(t)?(i=t[0],n=t[1]):(i=t,n=null);var l=p(a),s=b[e](t,l,o,r);return g.log(s),{code:e,container:i,trace:n,path:a,astr:l,msg:s}}function s(e,t){var a=c(t),o=a.keyMinusId,r=a.id;return!!(o in e&&e[o]._isSubplotObj&&r)||t in e}function d(e,t){if(t in e)return e[t];var a=c(t);return e[a.keyMinusId]}function c(e){var t=e.match(v);return{keyMinusId:t&&t[1],id:t&&t[2]}}function p(e){if(!x(e))return e+"";for(var t="",a=0,o;a<e.length;a++)o=e[a],"number"==typeof o?t=t.substr(0,t.length-1)+"["+o+"]":t+=o,a<e.length-1&&(t+=".");return t}var g=e("../lib"),m=e("../plots/plots"),h=e("./plot_schema"),y=e("./plot_config").dfltConfig,f=g.isPlainObject,x=Array.isArray,_=g.isArrayOrTypedArray;t.exports=function(e,t){var r=h.get(),n=[],s={_context:g.extendFlat({},y)},d,c;x(e)?(s.data=g.extendDeep([],e),d=e):(s.data=[],d=[],n.push(l("array","data"))),f(t)?(s.layout=g.extendDeep({},t),c=t):(s.layout={},c={},1<arguments.length&&n.push(l("object","layout"))),m.supplyDefaults(s);for(var p=s._fullData,u=d.length,_=0;_<u;_++){var b=d[_],v=["data",_];if(!f(b)){n.push(l("object",v));continue}var w=p[_],k=w.type,T=r.traces[k].attributes;T.type={valType:"enumerated",values:[k]},!1===w.visible&&!1!==b.visible&&n.push(l("invisible",v)),a(b,w,T,n,v);var A=b.transforms,S=w.transforms;if(A){x(A)||n.push(l("array",v,["transforms"])),v.push("transforms");for(var C=0;C<A.length;C++){var L=["transforms",C],E=A[C].type;if(!f(A[C])){n.push(l("object",v,L));continue}var I=r.transforms[E]?r.transforms[E].attributes:{};I.type={valType:"enumerated",values:Object.keys(r.transforms)},a(A[C],S[C],I,n,v,L)}}}var P=s._fullLayout,z=o(r,p);return a(c,P,z,n,"layout"),0===n.length?void 0:n};var b={object:function(e,t){var a;return a="layout"===e&&""===t?"The layout argument":"data"===e[0]&&""===t?"Trace "+e[1]+" in the data argument":r(e)+"key "+t,a+" must be linked to an object container"},array:function(e,t){var a;return a="data"===e?"The data argument":r(e)+"key "+t,a+" must be linked to an array container"},schema:function(e,t){return r(e)+"key "+t+" is not part of the schema"},unused:function(e,t,a){var o=f(a)?"container":"key";return r(e)+o+" "+t+" did not get coerced"},dynamic:function(e,t,a,o){return[r(e)+"key",t,"(set to '"+a+"')","got reset to","'"+o+"'","during defaults."].join(" ")},invisible:function(e,t){return(t?r(e)+"item "+t:"Trace "+e[1])+" got defaulted to be not visible"},value:function(e,t,a){return[r(e)+"key "+t,"is set to an invalid value ("+a+")"].join(" ")}},v=g.counterRegex("([a-z]+)")},{"../lib":657,"../plots/plots":768,"./plot_config":693,"./plot_schema":694}],700:[function(e,t){'use strict';t.exports={mode:{valType:"enumerated",dflt:"afterall",values:["immediate","next","afterall"]},direction:{valType:"enumerated",values:["forward","reverse"],dflt:"forward"},fromcurrent:{valType:"boolean",dflt:!1},frame:{duration:{valType:"number",min:0,dflt:500},redraw:{valType:"boolean",dflt:!0}},transition:{duration:{valType:"number",min:0,dflt:500,editType:"none"},easing:{valType:"enumerated",dflt:"cubic-in-out",values:["linear","quad","cubic","sin","exp","circle","elastic","back","bounce","linear-in","quad-in","cubic-in","sin-in","exp-in","circle-in","elastic-in","back-in","bounce-in","linear-out","quad-out","cubic-out","sin-out","exp-out","circle-out","elastic-out","back-out","bounce-out","linear-in-out","quad-in-out","cubic-in-out","sin-in-out","exp-in-out","circle-in-out","elastic-in-out","back-in-out","bounce-in-out"],editType:"none"},ordering:{valType:"enumerated",values:["layout first","traces first"],dflt:"layout first",editType:"none"}}}},{}],701:[function(e,t){'use strict';var a=e("../lib"),o=e("../plot_api/plot_template");t.exports=function(e,t,r){var n=r.name,l=r.inclusionAttr||"visible",s=t[n],d=a.isArrayOrTypedArray(e[n])?e[n]:[],c=t[n]=[],p=o.arrayTemplater(t,n,l),u,g;for(u=0;u<d.length;u++){var m=d[u];a.isPlainObject(m)?g=p.newItem(m):(g=p.newItem({}),g[l]=!1),g._index=u,!1!==g[l]&&r.handleItemDefaults(m,g,t,r),c.push(g)}var h=p.defaultItems();for(u=0;u<h.length;u++)g=h[u],g._index=c.length,r.handleItemDefaults({},g,t,r,{}),c.push(g);if(a.isArrayOrTypedArray(s)){var y=Math.min(s.length,c.length);for(u=0;u<y;u++)a.relinkPrivateKeys(c[u],s[u])}return c}},{"../lib":657,"../plot_api/plot_template":695}],702:[function(e,t){'use strict';var a=e("../components/fx/attributes");t.exports={type:{valType:"enumerated",values:[],dflt:"scatter",editType:"calc+clearAxisTypes",_noTemplating:!0},visible:{valType:"enumerated",values:[!0,!1,"legendonly"],dflt:!0,editType:"calc"},showlegend:{valType:"boolean",dflt:!0,editType:"style"},legendgroup:{valType:"string",dflt:"",editType:"style"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"style"},name:{valType:"string",editType:"style"},uid:{valType:"string",editType:"plot",anim:!0},ids:{valType:"data_array",editType:"calc",anim:!0},customdata:{valType:"data_array",editType:"calc"},meta:{valType:"any",arrayOk:!0,editType:"plot"},selectedpoints:{valType:"any",editType:"calc"},hoverinfo:{valType:"flaglist",flags:["x","y","z","text","name"],extras:["all","none","skip"],arrayOk:!0,dflt:"all",editType:"none"},hoverlabel:a.hoverlabel,stream:{token:{valType:"string",noBlank:!0,strict:!0,editType:"calc"},maxpoints:{valType:"number",min:0,max:1e4,dflt:500,editType:"calc"},editType:"calc"},transforms:{_isLinkedToArray:"transform",editType:"calc"},uirevision:{valType:"any",editType:"none"}}},{"../components/fx/attributes":555}],703:[function(e,t){'use strict';t.exports={xaxis:{valType:"subplotid",dflt:"x",editType:"calc+clearAxisTypes"},yaxis:{valType:"subplotid",dflt:"y",editType:"calc+clearAxisTypes"}}},{}],704:[function(e,t){'use strict';var u=Math.min,g=Math.max;function a(e,t){function a(e,t){return g(e,l(t))}var n=[],l=o(t),s=r(e,t),d=s.min,c=s.max,p,m;if(0===d.length||0===c.length)return h.simpleMap(t.range,t.r2l);var y=d[0].val,f=c[0].val;for(p=1;p<d.length&&y===f;p++)y=u(y,d[p].val);for(p=1;p<c.length&&y===f;p++)f=g(f,c[p].val);var x=!1;if(t.range){var _=h.simpleMap(t.range,t.r2l);x=_[1]<_[0]}"reversed"===t.autorange&&(x=!0,t.autorange=!0);var b=t.rangemode,v="tozero"===b,w="nonnegative"===b,k=t._length,T=function(e,a){var o=0;if(t.rangebreaks)for(var r=t.locateBreaks(e,a),n=0,l;n<r.length;n++)l=r[n],o+=l.max-l.min;return o},A=0,S,C,L,E,I,P;for(p=0;p<d.length;p++)for(S=d[p],m=0;m<c.length;m++)C=c[m],P=C.val-S.val-T(S.val,C.val),0<P&&(I=k-l(S)-l(C),I>k/10?P/I>A&&(L=S,E=C,A=P/I):P/k>A&&(L={val:S.val,pad:0},E={val:C.val,pad:0},A=P/k));if(y===f){var z=y-1,D=y+1;if(!v)n=w?[g(0,z),g(1,D)]:[z,D];else if(0===y)n=[0,1];else{var O=(0<y?c:d).reduce(a,0),R=y/(1-u(.5,O/k));n=0<y?[0,R]:[R,0]}}else v?(0<=L.val&&(L={val:0,pad:0}),0>=E.val&&(E={val:0,pad:0})):w&&(0>L.val-A*l(L)&&(L={val:0,pad:0}),0>=E.val&&(E={val:1,pad:0})),A=(E.val-L.val-T(S.val,C.val))/(k-l(L)-l(E)),n=[L.val-A*l(L),E.val+A*l(E)];return x&&n.reverse(),h.simpleMap(n,t.l2r||Number)}function o(e){var t=e._length/20;return"domain"===e.constrain&&e._inputDomain&&(t*=(e._inputDomain[1]-e._inputDomain[0])/(e.domain[1]-e.domain[0])),function(e){return e.pad+(e.extrapad?t:0)}}function r(e,t){function a(e,t){for(u=0;u<t.length;u++){var a=e[t[u]],r=(a._extremes||{})[o];if(!0===a.visible&&r){for(g=0;g<r.min.length;g++)m=r.min[g],n(c,m.val,m.pad,{extrapad:m.extrapad});for(g=0;g<r.max.length;g++)m=r.max[g],l(p,m.val,m.pad,{extrapad:m.extrapad})}}}var o=t._id,r=e._fullData,s=e._fullLayout,c=[],p=[],u,g,m;return a(r,t._traceIndices),a(s.annotations||[],t._annIndices||[]),a(s.shapes||[],t._shapeIndices||[]),{min:c,max:p}}function n(e,t,a,o){s(e,t,a,o,c)}function l(e,t,a,o){s(e,t,a,o,p)}function s(e,t,a,o,r){for(var i=o.tozero,n=o.extrapad,l=!0,s=0,d;s<e.length&&l;s++)if(d=e[s],r(d.val,t)&&d.pad>=a&&(d.extrapad||!n)){l=!1;break}else r(t,d.val)&&d.pad<=a&&(n||!d.extrapad)&&(e.splice(s,1),s--);if(l){var c=i&&0===t;e.push({val:t,pad:c?0:a,extrapad:!c&&n})}}function d(e){return m(e)&&Math.abs(e)<y}function c(e,t){return e<=t}function p(e,t){return e>=t}var m=e("fast-isnumeric"),h=e("../../lib"),y=e("../../constants/numerical").FP_SAFE,f=e("../../registry");t.exports={getAutoRange:a,makePadFn:o,doAutoRange:function(e,t){if(t.setScale(),t.autorange){t.range=a(e,t),t._r=t.range.slice(),t._rl=h.simpleMap(t._r,t.r2l);var o=t._input,r={};r[t._attr+".range"]=t.range,r[t._attr+".autorange"]=t.autorange,f.call("_storeDirectGUIEdit",e.layout,e._fullLayout._preGUI,r),o.range=t.range.slice(),o.autorange=t.autorange}var i=t._anchorAxis;if(i&&i.rangeslider){var n=i.rangeslider[t._name];n&&"auto"===n.rangemode&&(n.range=a(e,t)),i._input.rangeslider[t._name]=h.extendFlat({},n)}},findExtremes:function(e,t,a){function o(e){if(Array.isArray(e))return _=!0,function(t){return g(+(e[t]||0),0)};var t=g(+(e||0),0);return function(){return t}}function r(a){L=t[a];m(L)&&(P=w(a),z=k(a),b?(E=e.c2l(L)-A(a),I=e.c2l(L)+T(a)):(D=L-A(a),O=L+T(a),x&&D<O/10&&(D=O/10),E=e.c2l(D),I=e.c2l(O)),f&&(E=u(0,E),I=g(0,I)),d(E)&&n(s,E,z,R),d(I)&&l(c,I,P,R))}a||(a={}),e._m||e.setScale();var s=[],c=[],p=t.length,h=a.padded||!1,f=a.tozero&&("linear"===e.type||"-"===e.type),x="log"===e.type,_=!1,b=a.vpadLinearized||!1,w=o((0<e._m?a.ppadplus:a.ppadminus)||a.ppad||0),k=o((0<e._m?a.ppadminus:a.ppadplus)||a.ppad||0),T=o(a.vpadplus||a.vpad),A=o(a.vpadminus||a.vpad),S,C,L,E,I,P,z,D,O;if(!_){if(D=1/0,O=-Infinity,x)for(S=0;S<p;S++)C=t[S],C<D&&0<C&&(D=C),C>O&&C<y&&(O=C);else for(S=0;S<p;S++)C=t[S],C<D&&C>-y&&(D=C),C>O&&C<y&&(O=C);t=[D,O],p=2}var R={tozero:f,extrapad:h},M=u(6,p);for(S=0;S<M;S++)r(S);for(S=p-1;S>=M;S--)r(S);return{min:s,max:c,opts:a}},concatExtremes:r}},{"../../constants/numerical":633,"../../lib":657,"../../registry":788,"fast-isnumeric":201}],705:[function(e,t){'use strict';var U=Math.LN10,H=Math.log,q=Math.cos,G=Math.ceil,Y=Math.round,W=Math.sin,X=Math.min,Z=Math.pow,K=Math.abs,$=Math.max,J=Math.floor;function a(e){return+e}function o(e){return e+""}function r(e,t,a,o,r){function n(t){return 2>(1+100*(t-e)/a.dtick)%100}for(var l=0,s=0,d=0,c=0,p=0;p<t.length;p++)0==t[p]%1?d++:!j(t[p])&&c++,n(t[p])&&l++,n(t[p]+a.dtick/2)&&s++;var u=t.length-c;if(d===u&&"date"!==a.type)1>a.dtick?e=o-.5*a.dtick:(e-=.5,e+a.dtick<o&&(e+=a.dtick));else if(s<.1*u&&(l>.3*u||n(o)||n(r))){var g=a.dtick/2;e+=e+g<o?g:-g}return e}function i(e,t,a,o,r){var i=ae.findExactDates(t,r),n=.8;if(i.exactDays>n){var l=+a.substr(1);i.exactYears>n&&0==l%12?e=ke.tickIncrement(e,"M6","reverse")+1.5*ue:i.exactMonths>n?e=ke.tickIncrement(e,"M1","reverse")+15.5*ue:e-=ue/2;var s=ke.tickIncrement(e,a);if(s<=o)return s}return e}function n(e){var t=e.tickvals,a=e.ticktext,o=Array(t.length),r=ae.simpleMap(e.range,e.r2l),n=1.0001*r[0]-1e-4*r[1],l=1.0001*r[1]-1e-4*r[0],s=X(n,l),c=$(n,l),p=0;Array.isArray(a)||(a=[]);var u="category"===e.type?e.d2l_noadd:e.d2l;"log"===e.type&&"L"!==(e.dtick+"").charAt(0)&&(e.dtick="L"+Z(10,J(X(e.range[0],e.range[1]))-1));for(var g=0,m;g<t.length;g++)m=u(t[g]),m>s&&m<c&&(o[p]=void 0===a[g]?ke.tickText(e,m):d(e,m,a[g]+""),p++);return p<t.length&&o.splice(p,t.length-p),e.rangebreaks&&(o=o.filter(function(t){return e.maskBreaks(t.x)!==fe})),o}function l(e,t,a){return t*ae.roundUp(e/t,a)}function s(e){var t=e.dtick;if(e._tickexponent=0,j(t)||"string"==typeof t||(t=1),("category"===e.type||"multicategory"===e.type)&&(e._tickround=null),"date"===e.type){var a=e.r2l(e.tick0),o=e.l2r(a).replace(/(^-|i)/g,""),r=o.length;if("M"===(t+"").charAt(0))e._tickround=10<r||"01-01"!==o.substr(5)?"d":0==+t.substr(1)%12?"y":"m";else if(t>=ue&&10>=r||t>=15*ue)e._tickround="d";else if(t>=me&&16>=r||t>=ge)e._tickround="M";else if(t>=he&&19>=r||t>=me)e._tickround="S";else{var i=e.l2r(a+t).replace(/^-/,"").length;e._tickround=$(r,i)-20,0>e._tickround&&(e._tickround=4)}}else if(j(t)||"L"===t.charAt(0)){var n=e.range.map(e.r2d||Number);j(t)||(t=+t.substr(1)),e._tickround=2-J(H(t)/U+.01);var l=$(K(n[0]),K(n[1])),s=J(H(l)/U+.01);3<K(s)&&(f(e.exponentformat)&&!_(s)?e._tickexponent=3*Y((s-1)/3):e._tickexponent=s)}else e._tickround=null}function d(e,t,a){var o=e.tickfont||{};return{x:t,dx:0,dy:0,text:a||"",fontSize:o.size,font:o.family,fontColor:o.color}}function c(e,t,a,o){var r=e._tickround,i=a&&e.hoverformat||ke.getTickFormat(e);o&&(j(r)?r=4:r={y:"m",m:"d",d:"M",M:"S",S:4}[r]);var n=ae.formatDate(t.x,i,r,e._dateFormat,e.calendar,e._extraFormat),l=n.indexOf("\n"),s;-1!==l&&(s=n.substr(l+1),n=n.substr(0,l)),o&&("00:00:00"===n||"00:00"===n?(n=s,s=""):8===n.length&&(n=n.replace(/:00$/,""))),s&&(a?"d"===r?n+=", "+s:n=s+(n?", "+n:""):(!e._inCalcTicks||s!==e._prevDateHead)&&(n+="<br>"+s,e._prevDateHead=s)),t.text=n}function p(e,t,a,o,r){var i=e.dtick,n=t.x,l=e.tickformat,s="string"==typeof i&&i.charAt(0);if("never"===r&&(r=""),o&&"L"!==s&&(i="L3",s="L"),l||"L"===s)t.text=b(Z(10,n),e,r,o);else if(j(i)||"D"===s&&.1>ae.mod(n+.01,1)){var d=Y(n),c=K(d),p=e.exponentformat;"power"===p||f(p)&&_(d)?(t.text=0===d?1:1===d?"10":"10<sup>"+(1<d?"":ye)+c+"</sup>",t.fontSize*=1.25):("e"===p||"E"===p)&&2<c?t.text="1"+p+(0<d?"+":ye)+c:(t.text=b(Z(10,n),e,"","fakehover"),"D1"===i&&"y"===e._id.charAt(0)&&(t.dy-=t.fontSize/6))}else if("D"===s)t.text=Y(Z(10,ae.mod(n,1)))+"",t.fontSize*=.75;else throw"unrecognized dtick "+(i+"");if("D1"===e.dtick){var u=(t.text+"").charAt(0);("0"===u||"1"===u)&&("y"===e._id.charAt(0)?t.dx-=t.fontSize/4:(t.dy+=t.fontSize/2,t.dx+=(e.range[1]>e.range[0]?1:-1)*t.fontSize*(0>n?.5:.25)))}}function u(e,t){var a=e._categories[Y(t.x)];a===void 0&&(a=""),t.text=a+""}function g(e,t,a){var o=Y(t.x),r=e._categories[o]||[],i=r[1]===void 0?"":r[1]+"",n=r[0]===void 0?"":r[0]+"";a?t.text=n+" - "+i:(t.text=i,t.text2=n)}function m(e,t,a,o,r){"never"===r?r="":"all"===e.showexponent&&1e-6>K(t.x/e.dtick)&&(r="hide"),t.text=b(t.x,e,r,o)}function h(e,t,a,o,r){if("radians"===e.thetaunit&&!a){var i=t.x/180;if(0==i)t.text="0";else{var n=y(i);if(100<=n[1])t.text=b(ae.deg2rad(t.x),e,r,o);else{var l=0>t.x;t.text=1===n[1]?1===n[0]?"\u03C0":n[0]+"\u03C0":["<sup>",n[0],"</sup>","\u2044","<sub>",n[1],"</sub>","\u03C0"].join(""),l&&(t.text=ye+t.text)}}}else t.text=b(t.x,e,r,o)}function y(e){function t(e,t){return 1e-6>=K(e-t)}function o(e,a){return t(a,0)?e:o(a,e%a)}var r=function(a){for(var o=1;!t(Y(a*o)/o,a);)o*=10;return o}(e),i=e*r,n=K(o(i,r));return[Y(i/n),Y(r/n)]}function f(e){return"SI"===e||"B"===e}function _(e){return 14<e||-15>e}function b(t,a,o,r){var n=0>t,l=a._tickround,d=o||a.exponentformat||"B",c=a._tickexponent,p=ke.getTickFormat(a),u=a.separatethousands;if(r){var g={exponentformat:d,dtick:"none"===a.showexponent?a.dtick:j(t)?K(t)||1:1,range:"none"===a.showexponent?a.range.map(a.r2d):[0,t||1]};s(g),l=(+g._tickround||0)+4,c=g._tickexponent,a.hoverformat&&(p=a.hoverformat)}if(p)return a._numFormat(p)(t).replace(/-/g,ye);var m=Z(10,-l)/2;if("none"===d&&(c=0),t=K(t),t<m)t="0",n=!1;else{if(t+=m,c&&(t*=Z(10,-c),l+=c),0===l)t=J(t)+"";else if(0>l){t=Y(t)+"",t=t.substr(0,t.length+l);for(var e=l;0>e;e++)t+="0"}else{t+="";var h=t.indexOf(".")+1;h&&(t=t.substr(0,h+l).replace(/\.?0+$/,""))}t=ae.numSeparate(t,a._separators,u)}if(c&&"hide"!==d){f(d)&&_(c)&&(d="power");var y;y=0>c?ye+-c:"power"===d?c+"":"+"+c,"e"===d||"E"===d?t+=d+y:"power"===d?t+="\xD710<sup>"+y+"</sup>":"B"===d&&9===c?t+="B":f(d)&&(t+=Re[c/3+5])}return n?ye+t:t}function v(e,t){var a=[],o=function(e,t){var o=e.xbnd[t];null!==o&&a.push(ae.extendFlat({},e,{x:o}))},r;if(t.length){for(r=0;r<t.length;r++)o(t[r],0);o(t[r-1],1)}return a}function w(e,t){for(var a=[],o={},r=0,n;r<t.length;r++)n=t[r],o[n.text2]?o[n.text2].push(n.x):o[n.text2]=[n.x];for(var l in o)a.push(d(e,ae.interp(o[l],.5),l));return a}function k(e,t){var a=[],o=function(e,t){var o=e.xbnd[t];null!==o&&a.push(ae.extendFlat({},e,{x:o}))},r,n;if(e.showdividers&&t.length){for(r=0;r<t.length;r++){var l=t[r];l.text2!==n&&o(l,0),n=l.text2}o(t[r-1],1)}return a}function T(e,t){var a,o,r,i;return e._selections[t].size()?(a=1/0,o=-Infinity,r=1/0,i=-Infinity,e._selections[t].each(function(){var e=z(this),t=ne.bBox(e.node().parentNode);a=X(a,t.top),o=$(o,t.bottom),r=X(r,t.left),i=$(i,t.right)})):(a=0,o=0,r=0,i=0),{top:a,bottom:o,left:r,right:i,height:o-a,width:i-r}}function A(e){return[e.text,e.x,e.axInfo,e.font,e.fontSize,e.fontColor].join("_")}function S(e,t,a){var o=t._id+"divider",r=a.vals,i=a.layer.selectAll("path."+o).data(r,A);i.exit().remove(),i.enter().insert("path",":first-child").classed(o,1).classed("crisp",1).call(ie.stroke,t.dividercolor).style("stroke-width",ne.crispRound(e,t.dividerwidth,1)+"px"),i.attr("transform",a.transFn).attr("d",a.path)}function C(e){var t=e.title.font.size,a=(e.title.text.match(oe.BR_TAG_ALL)||[]).length;return e.title.hasOwnProperty("standoff")?a?t*(be+a*ve):t*be:a?t*(a+1)*ve:t}function L(e,t){var a=e._fullLayout,o=t._id,r=o.charAt(0),i=t.title.font.size,n;if(t.title.hasOwnProperty("standoff"))n=t._depth+t.title.standoff+C(t);else{if("multicategory"===t.type)n=t._depth;else{n=10+i*1.5+(t.linewidth?t.linewidth-1:0)}n+="x"===r?"top"===t.side?i*(t.showticklabels?1:0):i*(t.showticklabels?1.5:.5):"right"===t.side?i*(t.showticklabels?1:.5):i*(t.showticklabels?.5:0)}var l=ke.getPxPosition(e,t),s,d,c;"x"===r?(d=t._offset+t._length/2,c="top"===t.side?l-n:l+n):(c=t._offset+t._length/2,d="right"===t.side?l+n:l-n,s={rotate:"-90",offset:0});var p;if("multicategory"!==t.type){var u=t._selections[t._id+"tick"];if(p={selection:u,side:t.side},u&&u.node()&&u.node().parentNode){var g=ne.getTranslate(u.node().parentNode);p.offsetLeft=g.x,p.offsetTop=g.y}t.title.hasOwnProperty("standoff")&&(p.pad=0)}return re.draw(e,o+"title",{propContainer:t,propName:t._name+".title.text",placeholder:a._dfltTitle[r],avoid:p,transform:s,attributes:{x:d,y:c,"text-anchor":"middle"}})}function E(e,t){var a=e.l2p(t);return 1<a&&a<e._length-1}function I(e,t,a,o){function r(e){function a(e){return"number"==typeof e&&K(e-c)<o}if(!e.showline||!e.linewidth)return!1;var o=$((e.linewidth+t.zerolinewidth)/2,1);if(a(e._mainLinePosition)||a(e._mainMirrorPosition))return!0;var r=e._linepositions||{};for(var i in r)if(a(r[i][0])||a(r[i][1]))return!0}var n=a._mainAxis;if(n){var l=e._fullLayout,s=t._id.charAt(0),d=ke.counterLetter(t._id),c=t._offset+(K(o[0])<K(o[1])==("x"===s)?0:t._length),p=l._plots[a._mainSubplot];if(!(p.mainplotinfo||p).overlays.length)return r(a,c);for(var u=ke.list(e,d),g=0,m;g<u.length;g++)if(m=u[g],m._mainAxis===n&&r(m,c))return!0}}function P(e,t){for(var a=e._fullData,o=t._mainSubplot,r=t._id.charAt(0),n=0,l;n<a.length;n++)if(l=a[n],!0===l.visible&&l.xaxis+l.yaxis===o){if(te.traceIs(l,"bar-like")&&l.orientation==={x:"h",y:"v"}[r])return!0;if(l.fill&&l.fill.charAt(l.fill.length-1)===r)return!0}return!1}function z(e){var t=Q.select(e),a=t.select(".text-math-group");return a.empty()?t.select("text"):a}function D(e){return e._id+".automargin"}function O(e){return D(e)+".mirror"}function R(e){return e._id+".rangeslider"}function M(e,t){var a=[],o,r;for(o=0;o<t.length;o++){var n=[],l=e._fullData[t[o]].xaxis,s=e._fullData[t[o]].yaxis;if(l&&s){for(r=0;r<a.length;r++)(-1!==a[r].x.indexOf(l)||-1!==a[r].y.indexOf(s))&&n.push(r);if(!n.length){a.push({x:[l],y:[s]});continue}var d=a[n[0]],c;if(1<n.length)for(r=1;r<n.length;r++)c=a[n[r]],B(d.x,c.x),B(d.y,c.y);B(d.x,[l]),B(d.y,[s])}}return a}function B(e,t){for(var a=0;a<t.length;a++)-1===e.indexOf(t[a])&&e.push(t[a])}function F(e,t,a){var o=[],r=[],n=e.layout,l,s;for(l=0;l<t.length;l++)o.push(ke.getFromId(e,t[l]));for(l=0;l<a.length;l++)r.push(ke.getFromId(e,a[l]));var d=Object.keys(le),c=["anchor","domain","overlaying","position","side","tickangle","editType"],p=["linear","log"];for(l=0;l<d.length;l++){var u=d[l],g=o[0][u],m=r[0][u],h=!0,y=!1,f=!1;if("_"!==u.charAt(0)&&"function"!=typeof g&&-1===c.indexOf(u)){for(s=1;s<o.length&&h;s++){var x=o[s][u];"type"===u&&-1!==p.indexOf(g)&&-1!==p.indexOf(x)&&g!==x?y=!0:x!==g&&(h=!1)}for(s=1;s<r.length&&h;s++){var _=r[s][u];"type"===u&&-1!==p.indexOf(m)&&-1!==p.indexOf(_)&&m!==_?f=!0:r[s][u]!==m&&(h=!1)}h&&(y&&(n[o[0]._name].type="linear"),f&&(n[r[0]._name].type="linear"),N(n,u,o,r,e._fullLayout._dfltTitle))}}for(l=0;l<e._fullLayout.annotations.length;l++){var b=e._fullLayout.annotations[l];-1!==t.indexOf(b.xref)&&-1!==a.indexOf(b.yref)&&ae.swapAttrs(n.annotations[l],["?"])}}function N(e,t,a,o,r){var n=ae.nestedProperty,l=n(e[a[0]._name],t).get(),s=n(e[o[0]._name],t).get(),d;for("title"===t&&(l&&l.text===r.x&&(l.text=r.y),s&&s.text===r.y&&(s.text=r.x)),d=0;d<a.length;d++)n(e,a[d]._name+"."+t).set(s);for(d=0;d<o.length;d++)n(e,o[d]._name+"."+t).set(l)}function V(e){return"angularaxis"===e._id}var Q=e("d3"),j=e("fast-isnumeric"),ee=e("../../plots/plots"),te=e("../../registry"),ae=e("../../lib"),oe=e("../../lib/svg_text_utils"),re=e("../../components/titles"),ie=e("../../components/color"),ne=e("../../components/drawing"),le=e("./layout_attributes"),se=e("./clean_ticks"),de=e("../../constants/numerical"),ce=de.ONEAVGYEAR,pe=de.ONEAVGMONTH,ue=de.ONEDAY,ge=de.ONEHOUR,me=de.ONEMIN,he=de.ONESEC,ye=de.MINUS_SIGN,fe=de.BADNUM,xe=e("../../constants/alignment"),_e=xe.MID_SHIFT,be=xe.CAP_SHIFT,ve=xe.LINE_SPACING,we=xe.OPPOSITE_SIDE,ke=t.exports={};ke.setConvert=e("./set_convert");var Te=e("./axis_autotype"),Ae=e("./axis_ids");ke.id2name=Ae.id2name,ke.name2id=Ae.name2id,ke.cleanId=Ae.cleanId,ke.list=Ae.list,ke.listIds=Ae.listIds,ke.getFromId=Ae.getFromId,ke.getFromTrace=Ae.getFromTrace;var Se=e("./autorange");ke.getAutoRange=Se.getAutoRange,ke.findExtremes=Se.findExtremes,ke.coerceRef=function(e,t,a,o,r,i){var n=o.charAt(o.length-1),l=a._fullLayout._subplots[n+"axis"],s=o+"ref",d={};return r||(r=l[0]||i),i||(i=r),d[s]={valType:"enumerated",values:l.concat(i?[i]:[]),dflt:r},ae.coerce(e,t,d,s)},ke.coercePosition=function(e,t,a,o,r,i){var n,l;if("paper"===o||"pixel"===o)n=ae.ensureNumber,l=a(r,i);else{var s=ke.getFromId(t,o);i=s.fraction2r(i),l=a(r,i),n=s.cleanPos}e[r]=n(l)},ke.cleanPosition=function(e,t,a){var o="paper"===a||"pixel"===a?ae.ensureNumber:ke.getFromId(t,a).cleanPos;return o(e)},ke.redrawComponents=function(e,t){function a(a,r,n,l){for(var s=te.getComponentMethod(a,r),d={},c=0;c<t.length;c++)for(var p=o[ke.id2name(t[c])],u=p[n],g=0,m;g<u.length;g++)if(m=u[g],!d[m]&&(s(e,m),d[m]=1,l))return}t=t?t:ke.listIds(e);var o=e._fullLayout;a("annotations","drawOne","_annIndices"),a("shapes","drawOne","_shapeIndices"),a("images","draw","_imgIndices",!0)};var Ce=ke.getDataConversions=function(e,t,r,n){var l="x"===r||"y"===r||"z"===r?r:n,s;if(!Array.isArray(l))s=ke.getFromTrace(e,t,l);else if(s={type:Te(n),_categories:[]},ke.setConvert(s),"category"===s.type)for(var d=0;d<n.length;d++)s.d2c(n[d]);return s?{d2c:s.d2c,c2d:s.c2d}:"ids"===l?{d2c:o,c2d:o}:{d2c:a,c2d:a}};ke.getDataToCoordFunc=function(e,t,a,o){return Ce(e,t,a,o).d2c},ke.counterLetter=function(e){var t=e.charAt(0);return"x"===t?"y":"y"===t?"x":void 0},ke.minDtick=function(e,t,a,o){-1===["log","category","multicategory"].indexOf(e.type)&&o?e._minDtick===void 0?(e._minDtick=t,e._forceTick0=a):e._minDtick&&(2e-6>(e._minDtick/t+1e-6)%1&&2e-6>((a-e._forceTick0)/t%1+1.000001)%1?(e._minDtick=t,e._forceTick0=a):(2e-6<(t/e._minDtick+1e-6)%1||2e-6<((a-e._forceTick0)/e._minDtick%1+1.000001)%1)&&(e._minDtick=0)):e._minDtick=0},ke.saveRangeInitial=function(e,t){for(var a=ke.list(e,"",!0),o=!1,r=0;r<a.length;r++){var n=a[r],l=n._rangeInitial===void 0,s=l||n.range[0]!==n._rangeInitial[0]||n.range[1]!==n._rangeInitial[1];(l&&!1===n.autorange||t&&s)&&(n._rangeInitial=n.range.slice(),o=!0)}return o},ke.saveShowSpikeInitial=function(e,t){for(var a=ke.list(e,"",!0),o=!1,r="on",n=0;n<a.length;n++){var l=a[n],s=void 0===l._showSpikeInitial,d=s||l.showspikes!==l._showspikes;(s||t&&d)&&(l._showSpikeInitial=l.showspikes,o=!0),"on"!==r||l.showspikes||(r="off")}return e._fullLayout._cartesianSpikesEnabled=r,o},ke.autoBin=function(e,t,a,o,n,l){var s=ae.aggNums(Math.min,null,e),d=ae.aggNums(Math.max,null,e);if("category"===t.type||"multicategory"===t.type)return{start:s-.5,end:d+.5,size:$(1,Y(l)||1),_dataSpan:d-s};n||(n=t.calendar);var c;if(c="log"===t.type?{type:"linear",range:[s,d]}:{type:t.type,range:ae.simpleMap([s,d],t.c2r,0,n),calendar:n},ke.setConvert(c),l=l&&se.dtick(l,c.type),l)c.dtick=l,c.tick0=se.tick0(void 0,c.type,n);else{var p;if(a)p=(d-s)/a;else{var u=ae.distinctVals(e),g=Z(10,J(H(u.minDiff)/U)),m=g*ae.roundUp(u.minDiff/g,[.9,1.9,4.9,9.9],!0);p=$(m,2*ae.stdev(e)/Z(e.length,o?.25:.4)),j(p)||(p=1)}ke.autoTicks(c,p)}var h=c.dtick,y=ke.tickIncrement(ke.tickFirst(c),h,"reverse",n),f,x;if("number"==typeof h)y=r(y,e,c,s,d),x=1+J((d-y)/h),f=y+x*h;else for("M"===c.dtick.charAt(0)&&(y=i(y,e,h,s,n)),f=y,x=0;f<=d;)f=ke.tickIncrement(f,h,!1,n),x++;return{start:t.c2r(y,0,n),end:t.c2r(f,0,n),size:h,_dataSpan:d-s}},ke.prepTicks=function(e){var t=ae.simpleMap(e.range,e.r2l);if("auto"===e.tickmode||!e.dtick){var a=e.nticks,o;a||("category"===e.type||"multicategory"===e.type?(o=e.tickfont?1.2*(e.tickfont.size||12):15,a=e._length/o):(o="y"===e._id.charAt(0)?40:80,a=ae.constrain(e._length/o,4,9)+1),"radialaxis"===e._name&&(a*=2)),"array"===e.tickmode&&(a*=100),e._roughDTick=(K(t[1]-t[0])-(e._lBreaks||0))/a,ke.autoTicks(e,e._roughDTick),0<e._minDtick&&e.dtick<2*e._minDtick&&(e.dtick=e._minDtick,e.tick0=e.l2r(e._forceTick0))}e.tick0||(e.tick0="date"===e.type?"2000-01-01":0),"date"===e.type&&.1>e.dtick&&(e.dtick=.1),s(e)},ke.calcTicks=function(e){function a(){var t=null,a=$(1e3,e._length||0);c=[];for(var o=e._tmin;(s?o>=l:o<=l)&&!(c.length>a||o===t);o=ke.tickIncrement(o,e.dtick,s,e.calendar)){t=o;var r=!1;d&&o!==(0|o)&&(r=!0),c.push({minor:r,value:o})}}ke.prepTicks(e);var o=ae.simpleMap(e.range,e.r2l);if("array"===e.tickmode)return n(e);e._tmin=ke.tickFirst(e);var r=1.0001*o[0]-1e-4*o[1],l=1.0001*o[1]-1e-4*o[0],s=o[1]<o[0];if(e._tmin<r!==s)return[];("category"===e.type||"multicategory"===e.type)&&(l=s?$(-.5,l):X(e._categories.length-.5,l));var d="log"===e.type&&!(j(e.dtick)||"L"===e.dtick.charAt(0)),c;if(a(),e.rangebreaks){if("auto"===e.tickmode)for(var p=0,u;p<c.length;p++)if(u=c[p].value,e.maskBreaks(u)===fe)for(var g=0,m;g<e._rangebreaks.length;g++)if(m=e._rangebreaks[g],u>=m.min&&u<m.max){c[p].value=m.max;break}var h=c.length;if(2<h){for(var y=2*(e.tickfont?e.tickfont.size:12),f=[],x=s?1:-1,_=s?0:h-1,b=s?h-1:0,v=_,w,T;x*v<=x*b;v+=x)T=e.c2p(c[v].value),(void 0===w||K(T-w)>y)&&(w=T,f.push(c[v]));c=f.reverse()}}V(e)&&360===K(o[1]-o[0])&&c.pop(),e._tmax=(c[c.length-1]||{}).value,e._prevDateHead="",e._inCalcTicks=!0;for(var A=Array(c.length),S=0;S<c.length;S++){var C=c[S].minor,L=c[S].value;A[S]=ke.tickText(e,L,!1,C)}return e._inCalcTicks=!1,A};var Le=[2,5,10],Ee=[1,2,3,6,12],Ie=[1,2,5,10,15,30],Pe=[1,2,3,7,14],ze=[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1],De=[-.301,0,.301,.699,1],Oe=[15,30,45,90,180];ke.autoTicks=function(e,t){function a(e){return Z(e,J(H(t)/U))}var o;if("date"===e.type){e.tick0=ae.dateTick0(e.calendar);var r=2*t;r>ce?(t/=ce,o=a(10),e.dtick="M"+12*l(t,o,Le)):r>pe?(t/=pe,e.dtick="M"+l(t,1,Ee)):r>ue?(e.dtick=l(t,ue,e._hasDayOfWeekBreaks?[1,7,14]:Pe),e.tick0=ae.dateTick0(e.calendar,!0)):r>ge?e.dtick=l(t,ge,Ee):r>me?e.dtick=l(t,me,Ie):r>he?e.dtick=l(t,he,Ie):(o=a(10),e.dtick=l(t,o,Le))}else if("log"===e.type){e.tick0=0;var i=ae.simpleMap(e.range,e.r2l);if(.7<t)e.dtick=G(t);else if(1>K(i[1]-i[0])){var n=1.5*K((i[1]-i[0])/t);t=K(Z(10,i[1])-Z(10,i[0]))/n,o=a(10),e.dtick="L"+l(t,o,Le)}else e.dtick=.3<t?"D2":"D1"}else"category"===e.type||"multicategory"===e.type?(e.tick0=0,e.dtick=G($(t,1))):V(e)?(e.tick0=0,o=1,e.dtick=l(t,o,Oe)):(e.tick0=0,o=a(10),e.dtick=l(t,o,Le));if(0===e.dtick&&(e.dtick=1),!j(e.dtick)&&"string"!=typeof e.dtick){var s=e.dtick;throw e.dtick=1,"ax.dtick error: "+(s+"")}},ke.tickIncrement=function(e,t,a,o){var r=a?-1:1;if(j(t))return e+r*t;var i=t.charAt(0),n=r*+t.substr(1);if("M"===i)return ae.incrementMonth(e,n,o);if("L"===i)return H(Z(10,e)+n)/U;if("D"===i){var l="D2"===t?De:ze,s=e+.01*r,d=ae.roundUp(ae.mod(s,1),l,a);return J(s)+H(Q.round(Z(10,d),1))/U}throw"unrecognized dtick "+(t+"")},ke.tickFirst=function(e){var t=e.r2l||Number,a=ae.simpleMap(e.range,t),o=a[1]<a[0],r=o?J:G,i=1.0001*a[0]-1e-4*a[1],n=e.dtick,l=t(e.tick0);if(j(n)){var s=r((i-l)/n)*n+l;return("category"===e.type||"multicategory"===e.type)&&(s=ae.constrain(s,0,e._categories.length-1)),s}var d=n.charAt(0),c=+n.substr(1);if("M"===d){for(var p=0,u=l,g,m,h;10>p;){if(g=ke.tickIncrement(u,n,o,e.calendar),0>=(g-i)*(u-i))return o?X(u,g):$(u,g);m=(i-(u+g)/2)/(g-u),h=d+(K(Y(m))||1)*c,u=ke.tickIncrement(u,h,0>m?!o:o,e.calendar),p++}return ae.error("tickFirst did not converge",e),u}if("L"===d)return H(r((Z(10,i)-l)/c)*c+l)/U;if("D"===d){var y="D2"===n?De:ze,f=ae.roundUp(ae.mod(i,1),y,o);return J(i)+H(Q.round(Z(10,f),1))/U}throw"unrecognized dtick "+(n+"")},ke.tickText=function(e,t,a,o){function r(o){if(void 0===o)return!0;if(a)return"none"===o;var r={first:e._tmin,last:e._tmax}[o];return"all"!==o&&t!==r}var n=d(e,t),l="array"===e.tickmode,s=a||l,y=e.type,f="category"===y?e.d2l_noadd:e.d2l,x;if(l&&Array.isArray(e.ticktext)){var _=ae.simpleMap(e.range,e.r2l),b=(K(_[1]-_[0])-(e._lBreaks||0))/1e4;for(x=0;x<e.ticktext.length&&!(K(t-f(e.tickvals[x]))<b);x++);if(x<e.ticktext.length)return n.text=e.ticktext[x]+"",n}var v=a?"never":"none"!==e.exponentformat&&r(e.showexponent)?"hide":"";if("date"===y?c(e,n,a,s):"log"===y?p(e,n,a,s,v):"category"===y?u(e,n):"multicategory"===y?g(e,n,a):V(e)?h(e,n,a,s,v):m(e,n,a,s,v),o||(e.tickprefix&&!r(e.showtickprefix)&&(n.text=e.tickprefix+n.text),e.ticksuffix&&!r(e.showticksuffix)&&(n.text+=e.ticksuffix)),"boundaries"===e.tickson||e.showdividers){var w=function(t){var a=e.l2p(t);return 0<=a&&a<=e._length?t:null};n.xbnd=[w(n.x-.5),w(n.x+e.dtick-.5)]}return n},ke.hoverLabelText=function(e,t,a){if(a!==fe&&a!==t)return ke.hoverLabelText(e,t)+" - "+ke.hoverLabelText(e,a);var o="log"===e.type&&0>=t,r=ke.tickText(e,e.c2l(o?-t:t),"hover").text;return o?0===t?"0":ye+r:r};var Re=["f","p","n","\u03BC","m","","k","M","G","T"];ke.getTickFormat=function(e){function t(e){return"string"==typeof e?+e.replace("M","")*pe:e}function a(e,t){var a=["L","D"];if(typeof e==typeof t){if("number"==typeof e)return e-t;var o=a.indexOf(e.charAt(0)),r=a.indexOf(t.charAt(0));return o===r?+e.replace(/(L|D)/g,"")-+t.replace(/(L|D)/g,""):o-r}return"number"==typeof e?1:-1}function o(e,t,a){var o=a||function(e){return e},r=t[0],i=t[1];return(!r&&"number"!=typeof r||o(r)<=o(e))&&(!i&&"number"!=typeof i||o(i)>=o(e))}function r(e,t){var o=null===t[0],r=null===t[1],i=0<=a(e,t[0]),n=0>=a(e,t[1]);return(o||i)&&(r||n)}var n,l,s;if(e.tickformatstops&&0<e.tickformatstops.length)switch(e.type){case"date":case"linear":{for(n=0;n<e.tickformatstops.length;n++)if(s=e.tickformatstops[n],s.enabled&&o(e.dtick,s.dtickrange,t)){l=s;break}break}case"log":{for(n=0;n<e.tickformatstops.length;n++)if(s=e.tickformatstops[n],s.enabled&&r(e.dtick,s.dtickrange)){l=s;break}break}default:}return l?l.value:e.tickformat},ke.getSubplots=function(e,t){var a=e._fullLayout._subplots,o=a.cartesian.concat(a.gl2d||[]),r=t?ke.findSubplotsWithAxis(o,t):o;return r.sort(function(e,t){var a=e.substr(1).split("y"),o=t.substr(1).split("y");return a[0]===o[0]?+a[1]-+o[1]:+a[0]-+o[0]}),r},ke.findSubplotsWithAxis=function(e,t){for(var a=new RegExp("x"===t._id.charAt(0)?"^"+t._id+"y":t._id+"$"),o=[],r=0,n;r<e.length;r++)n=e[r],a.test(n)&&o.push(n);return o},ke.makeClipPaths=function(e){var t=e._fullLayout;if(!t._hasOnlyLargeSploms){var a={_offset:0,_length:t.width,_id:""},o={_offset:0,_length:t.height,_id:""},r=ke.list(e,"x",!0),n=ke.list(e,"y",!0),l=[],s,d;for(s=0;s<r.length;s++)for(l.push({x:r[s],y:o}),d=0;d<n.length;d++)0===s&&l.push({x:a,y:n[d]}),l.push({x:r[s],y:n[d]});var c=t._clips.selectAll(".axesclip").data(l,function(e){return e.x._id+e.y._id});c.enter().append("clipPath").classed("axesclip",!0).attr("id",function(e){return"clip"+t._uid+e.x._id+e.y._id}).append("rect"),c.exit().remove(),c.each(function(e){Q.select(this).select("rect").attr({x:e.x._offset||0,y:e.y._offset||0,width:e.x._length||1,height:e.y._length||1})})}},ke.draw=function(e,t,a){var o=e._fullLayout;"redraw"===t&&o._paper.selectAll("g.subplot").each(function(e){var t=e[0],a=o._plots[t],r=a.xaxis,i=a.yaxis;a.xaxislayer.selectAll("."+r._id+"tick").remove(),a.yaxislayer.selectAll("."+i._id+"tick").remove(),a.xaxislayer.selectAll("."+r._id+"tick2").remove(),a.yaxislayer.selectAll("."+i._id+"tick2").remove(),a.xaxislayer.selectAll("."+r._id+"divider").remove(),a.yaxislayer.selectAll("."+i._id+"divider").remove(),a.gridlayer&&a.gridlayer.selectAll("path").remove(),a.zerolinelayer&&a.zerolinelayer.selectAll("path").remove(),o._infolayer.select(".g-"+r._id+"title").remove(),o._infolayer.select(".g-"+i._id+"title").remove()});var r=t&&"redraw"!==t?t:ke.listIds(e);return ae.syncOrAsync(r.map(function(t){return function(){if(t){var o=ke.getFromId(e,t),r=ke.drawOne(e,o,a);return o._r=o.range.slice(),o._rl=ae.simpleMap(o._r,o.r2l),r}}}))},ke.drawOne=function(e,t,a){function o(e){var a=c+(e||"tick");return _[a]||(_[a]=T(t,a)),_[a]}a=a||{};var r,n,l;t.setScale();var d=e._fullLayout,c=t._id,p=c.charAt(0),u=ke.counterLetter(c),g=d._plots[t._mainSubplot];if(g){var m=g[p+"axislayer"],h=t._mainLinePosition,y=t._mainMirrorPosition,f=t._vals=ke.calcTicks(t),x=[t.mirror,h,y].join("_");for(r=0;r<f.length;r++)f[r].axInfo=x;t._selections={},t._tickAngles&&(t._prevTickAngles=t._tickAngles),t._tickAngles={},t._depth=null;var _={};if(t.visible){var b=ke.makeTransFn(t),A,E;if("boundaries"===t.tickson){var I=v(t,f);E=ke.clipEnds(t,I),A="inside"===t.ticks?E:I}else E=ke.clipEnds(t,f),A="inside"===t.ticks?E:f;var P=t._gridVals=E,z=k(t,f);if(!d._hasOnlyLargeSploms){var M=t._subplotsWith,j={};for(r=0;r<M.length;r++){n=M[r],l=d._plots[n];var B=l[u+"axis"],F=B._mainAxis._id;if(!j[F]){j[F]=1;var N="x"===p?"M0,"+B._offset+"v"+B._length:"M"+B._offset+",0h"+B._length;ke.drawGrid(e,t,{vals:P,counterAxis:B,layer:l.gridlayer.select("."+c),path:N,transFn:b}),ke.drawZeroLine(e,t,{counterAxis:B,layer:l.zerolinelayer,path:N,transFn:b})}}}var V=ke.getTickSigns(t),U=[];if(t.ticks){var H=ke.makeTickPath(t,h,V[2]),q,G;t._anchorAxis&&t.mirror&&!0!==t.mirror?(q=ke.makeTickPath(t,y,V[3]),G=H+q):(q="",G=H);var Y;if(t.showdividers&&"outside"===t.ticks&&"boundaries"===t.tickson){var W={};for(r=0;r<z.length;r++)W[z[r].x]=1;Y=function(e){return W[e.x]?q:G}}else Y=G;ke.drawTicks(e,t,{vals:A,layer:m,path:Y,transFn:b}),"allticks"===t.mirror&&(U=Object.keys(t._linepositions||{}))}for(r=0;r<U.length;r++){n=U[r],l=d._plots[n];var X=t._linepositions[n]||[],Z=ke.makeTickPath(t,X[0],V[0])+ke.makeTickPath(t,X[1],V[1]);ke.drawTicks(e,t,{vals:A,layer:l[p+"axislayer"],path:Z,transFn:b})}var K=[function(){return ke.drawLabels(e,t,{vals:f,layer:m,transFn:b,labelFns:ke.makeLabelFns(t,h)})}];if("multicategory"===t.type){var J={x:2,y:10}[p];K.push(function(){var a={x:"height",y:"width"}[p],r=o()[a]+J+(t._tickAngles[c+"tick"]?t.tickfont.size*ve:0);return ke.drawLabels(e,t,{vals:w(t,f),layer:m,cls:c+"tick2",repositionOnUpdate:!0,secondary:!0,transFn:b,labelFns:ke.makeLabelFns(t,h+r*V[4])})}),K.push(function(){return t._depth=V[4]*(o("tick2")[t.side]-h),S(e,t,{vals:z,layer:m,path:ke.makeTickPath(t,h,V[4],t._depth),transFn:b})})}else t.title.hasOwnProperty("standoff")&&K.push(function(){t._depth=V[4]*(o()[t.side]-h)});var Q=te.getComponentMethod("rangeslider","isVisible")(t);return K.push(function(){var a=t.side.charAt(0),r=we[t.side].charAt(0),i=ke.getPxPosition(e,t),n="outside"===t.ticks?t.ticklen:0,l,s,c,g;if((t.automargin||Q)&&("multicategory"===t.type?l=o("tick2"):(l=o(),"x"===p&&"b"===a&&(t._depth=$(0<l.width?l.bottom-i:0,n)))),t.automargin){s={x:0,y:0,r:0,l:0,t:0,b:0};var m=[0,1];if("x"===p){if("b"===a?s[a]=t._depth:(s[a]=t._depth=$(0<l.width?i-l.top:0,n),m.reverse()),0<l.width){var h=l.right-(t._offset+t._length);0<h&&(s.xr=1,s.r=h);var y=t._offset-l.left;0<y&&(s.xl=0,s.l=y)}}else if("l"===a?s[a]=t._depth=$(0<l.height?i-l.left:0,n):(s[a]=t._depth=$(0<l.height?l.right-i:0,n),m.reverse()),0<l.height){var f=l.bottom-(t._offset+t._length);0<f&&(s.yb=0,s.b=f);var x=t._offset-l.top;0<x&&(s.yt=1,s.t=x)}s[u]="free"===t.anchor?t.position:t._anchorAxis.domain[m[0]],t.title.text!==d._dfltTitle[p]&&(s[a]+=C(t)+(t.title.standoff||0)),t.mirror&&"free"!==t.anchor&&(c={x:0,y:0,r:0,l:0,t:0,b:0},c[r]=t.linewidth,t.mirror&&!0!==t.mirror&&(c[r]+=n),!0===t.mirror||"ticks"===t.mirror?c[u]=t._anchorAxis.domain[m[1]]:("all"===t.mirror||"allticks"===t.mirror)&&(c[u]=[t._counterDomainMin,t._counterDomainMax][m[1]]))}Q&&(g=te.getComponentMethod("rangeslider","autoMarginOpts")(e,t)),ee.autoMargin(e,D(t),s),ee.autoMargin(e,O(t),c),ee.autoMargin(e,R(t),g)}),a.skipTitle||Q&&"bottom"===t.side||K.push(function(){return L(e,t)}),ae.syncOrAsync(K)}}},ke.getTickSigns=function(e){var t=e._id.charAt(0),a={x:"top",y:"right"}[t],o=e.side===a?1:-1,r=[-1,1,o,-o];return"inside"!==e.ticks==("x"===t)&&(r=r.map(function(e){return-e})),e.side&&r.push({l:-1,t:-1,r:1,b:1}[e.side.charAt(0)]),r},ke.makeTransFn=function(e){var t=e._id.charAt(0),a=e._offset;return"x"===t?function(t){return"translate("+(a+e.l2p(t.x))+",0)"}:function(t){return"translate(0,"+(a+e.l2p(t.x))+")"}},ke.makeTickPath=function(e,t,a,o){o=o===void 0?e.ticklen:o;var r=e._id.charAt(0),i=(e.linewidth||1)/2;return"x"===r?"M0,"+(t+i*a)+"v"+o*a:"M"+(t+i*a)+",0h"+o*a},ke.makeLabelFns=function(e,t,a){var o=e._id.charAt(0),r="boundaries"!==e.tickson&&"outside"===e.ticks,i=0,n=0;if(r&&(i+=e.ticklen),a&&"outside"===e.ticks){var l=ae.deg2rad(a);i=e.ticklen*q(l)+1,n=e.ticklen*W(l)}e.showticklabels&&(r||e.showline)&&(i+=.2*e.tickfont.size),i+=(e.linewidth||1)/2;var s={labelStandoff:i,labelShift:n},c,p,u,g;return"x"===o?(g="bottom"===e.side?1:-1,c=n*g,p=t+i*g,u="bottom"===e.side?1:-.2,s.xFn=function(e){return e.dx+c},s.yFn=function(e){return e.dy+p+e.fontSize*u},s.anchorFn=function(e,t){return j(t)&&0!==t&&180!==t?0>t*g?"end":"start":"middle"},s.heightFn=function(t,o,a){return-60>o||60<o?-.5*a:"top"===e.side?-a:0}):"y"===o&&(g="right"===e.side?1:-1,c=i,p=-n*g,u=90===K(e.tickangle)?.5:0,s.xFn=function(e){return e.dx+t+(c+e.fontSize*u)*g},s.yFn=function(e){return e.dy+p+e.fontSize*_e},s.anchorFn=function(t,o){return j(o)&&90===K(o)?"middle":"right"===e.side?"start":"end"},s.heightFn=function(t,o,r){return o*="left"===e.side?1:-1,-30>o?-r:30>o?-.5*r:0}),s},ke.drawTicks=function(e,t,a){a=a||{};var o=t._id+"tick",r=a.layer.selectAll("path."+o).data(t.ticks?a.vals:[],A);r.exit().remove(),r.enter().append("path").classed(o,1).classed("ticks",1).classed("crisp",!1!==a.crisp).call(ie.stroke,t.tickcolor).style("stroke-width",ne.crispRound(e,t.tickwidth,1)+"px").attr("d",a.path),r.attr("transform",a.transFn)},ke.drawGrid=function(e,t,a){a=a||{};var o=t._id+"grid",r=a.vals,n=a.counterAxis;if(!1===t.showgrid)r=[];else if(n&&ke.shouldShowZeroLine(e,t,n))for(var l="array"===t.tickmode,s=0,d;s<r.length;s++)if(d=r[s].x,l?!d:K(d)<t.dtick/100)if(r=r.slice(0,s).concat(r.slice(s+1)),l)s--;else break;var c=a.layer.selectAll("path."+o).data(r,A);c.exit().remove(),c.enter().append("path").classed(o,1).classed("crisp",!1!==a.crisp),t._gw=ne.crispRound(e,t.gridwidth,1),c.attr("transform",a.transFn).attr("d",a.path).call(ie.stroke,t.gridcolor||"#ddd").style("stroke-width",t._gw+"px"),"function"==typeof a.path&&c.attr("d",a.path)},ke.drawZeroLine=function(e,t,a){a=a||a;var o=t._id+"zl",r=ke.shouldShowZeroLine(e,t,a.counterAxis),i=a.layer.selectAll("path."+o).data(r?[{x:0,id:t._id}]:[]);i.exit().remove(),i.enter().append("path").classed(o,1).classed("zl",1).classed("crisp",!1!==a.crisp).each(function(){a.layer.selectAll("path").sort(function(e,t){return Ae.idSort(e.id,t.id)})}),i.attr("transform",a.transFn).attr("d",a.path).call(ie.stroke,t.zerolinecolor||ie.defaultLine).style("stroke-width",ne.crispRound(e,t.zerolinewidth,t._gw||1)+"px")},ke.drawLabels=function(e,t,a){function o(e,t){e.each(function(e){var o=Q.select(this),r=o.select(".text-math-group"),i=c.anchorFn(e,t),n=a.transFn.call(o.node(),e)+(j(t)&&0!=+t?" rotate("+t+","+c.xFn(e)+","+(c.yFn(e)-e.fontSize/2)+")":""),l=oe.lineCount(o),s=ve*e.fontSize,d=c.heightFn(e,j(t)?+t:0,(l-1)*s);if(d&&(n+=" translate(0, "+d+")"),r.empty())o.select("text").attr({transform:n,"text-anchor":i});else{var p=ne.bBox(r.node()).width,u=p*{end:-.5,start:.5}[i];r.attr("transform",n+(u?"translate("+u+",0)":""))}})}function r(){if(o(g,p),d.length&&"x"===l&&!j(p)&&("log"!==t.type||"D"!==(t.dtick+"").charAt(0))){h=0;var e=0,r=[],n;if(g.each(function(a){e=$(e,a.fontSize);var o=t.l2p(a.x),i=z(this),n=ne.bBox(i.node());r.push({top:0,bottom:10,height:10,left:o-n.width/2,right:o+n.width/2+2,width:n.width+2})}),("boundaries"===t.tickson||t.showdividers)&&!a.secondary){var s=2;for(t.ticks&&(s+=t.tickwidth/2),n=0;n<r.length;n++){var c=d[n].xbnd,u=r[n];if(null!==c[0]&&u.left-t.l2p(c[0])<s||null!==c[1]&&t.l2p(c[1])-u.right<s){h=90;break}}}else{var m=d.length,y=K((d[m-1].x-d[0].x)*t._m)/(m-1),f=y<2.5*e||"multicategory"===t.type;for(n=0;n<r.length-1;n++)if(ae.bBoxIntersect(r[n],r[n+1])){h=f?90:30;break}}h&&o(g,h)}}a=a||{};var i=e._fullLayout,n=t._id,l=n.charAt(0),s=a.cls||n+"tick",d=a.vals,c=a.labelFns,p=a.secondary?0:t.tickangle,u=(t._prevTickAngles||{})[s],g=a.layer.selectAll("g."+s).data(t.showticklabels?d:[],A),m=[];g.enter().append("g").classed(s,1).append("text").attr("text-anchor","middle").each(function(t){var a=Q.select(this),r=e._promises.length;a.call(oe.positionText,c.xFn(t),c.yFn(t)).call(ne.font,t.font,t.fontSize,t.fontColor).text(t.text).call(oe.convertToTspans,e),e._promises[r]?m.push(e._promises.pop().then(function(){o(a,p)})):o(a,p)}),g.exit().remove(),a.repositionOnUpdate&&g.each(function(e){Q.select(this).select("text").call(oe.positionText,c.xFn(e),c.yFn(e))}),o(g,u+1?u:p);var h=null;t._selections&&(t._selections[s]=g);var y=[function(){return m.length&&Promise.all(m)}];t.automargin&&i._redrawFromAutoMarginCount&&90===u?(h=90,y.push(function(){o(g,u)})):y.push(r),t._tickAngles&&y.push(function(){t._tickAngles[s]=null===h?j(p)?p:0:h});var f=ae.syncOrAsync(y);return f&&f.then&&e._promises.push(f),f},ke.getPxPosition=function(e,t){var a=e._fullLayout._size,o=t._id.charAt(0),r=t.side,i;return("free"===t.anchor?"x"===o?i={_offset:a.t+(1-(t.position||0))*a.h,_length:0}:"y"===o&&(i={_offset:a.l+(t.position||0)*a.w,_length:0}):i=t._anchorAxis,"top"===r||"left"===r)?i._offset:"bottom"===r||"right"===r?i._offset+i._length:void 0},ke.shouldShowZeroLine=function(e,t,a){var o=ae.simpleMap(t.range,t.r2l);return 0>=o[0]*o[1]&&t.zeroline&&("linear"===t.type||"-"===t.type)&&!(t.rangebreaks&&t.maskBreaks(0)===fe)&&(E(t,0)||!I(e,t,a,o)||P(e,t))},ke.clipEnds=function(e,t){return t.filter(function(t){return E(e,t.x)})},ke.allowAutoMargin=function(e){for(var t=ke.list(e,"",!0),a=0,o;a<t.length;a++)o=t[a],o.automargin&&(ee.allowAutoMargin(e,D(o)),o.mirror&&ee.allowAutoMargin(e,O(o))),te.getComponentMethod("rangeslider","isVisible")(o)&&ee.allowAutoMargin(e,R(o))},ke.swap=function(e,t){for(var a=M(e,t),o=0;o<a.length;o++)F(e,a[o].x,a[o].y)}},{"../../components/color":524,"../../components/drawing":546,"../../components/titles":619,"../../constants/alignment":626,"../../constants/numerical":633,"../../lib":657,"../../lib/svg_text_utils":681,"../../plots/plots":768,"../../registry":788,"./autorange":704,"./axis_autotype":706,"./axis_ids":708,"./clean_ticks":710,"./layout_attributes":719,"./set_convert":725,d3:108,"fast-isnumeric":201}],706:[function(e,t){'use strict';var n=Math.round,l=Math.max;function a(e){if(!e)return!1;for(var t=0;t<e.length;t++)if(s(e[t]))return!0;return!1}function o(e,t){for(var a=l(1,(e.length-1)/1e3),o=0,r=0,c={},p=0;p<e.length;p+=a){var u=e[n(p)],g=u+"";c[g]||(c[g]=1,d.isDateTime(u,t)&&(o+=1),s(u)&&(r+=1))}return o>2*r}function r(e){for(var t=l(1,(e.length-1)/1e3),a=0,o=0,r={},s=0;s<e.length;s+=t){var p=e[n(s)],u=p+"";r[u]||(r[u]=1,"boolean"==typeof p?o++:d.cleanNumber(p)===c?"string"==typeof p&&o++:a++)}return o>2*a}function i(e){return d.isArrayOrTypedArray(e[0])&&d.isArrayOrTypedArray(e[1])}var s=e("fast-isnumeric"),d=e("../../lib"),c=e("../../constants/numerical").BADNUM;t.exports=function(e,t,n){return n=n||{},!n.noMultiCategory&&i(e)?"multicategory":o(e,t)?"date":r(e)?"category":a(e)?"linear":"-"}},{"../../constants/numerical":633,"../../lib":657,"fast-isnumeric":201}],707:[function(e,t){'use strict';var r=Math.round,n=Math.floor;function a(e,t,a){function r(a,o){return d.coerce(e,t,p.rangebreaks,a,o)}var s=r("enabled");if(s){var c=r("bounds");if(c&&2<=c.length){var u="",g,m;if(2===c.length)for(g=0;2>g;g++)if(m=o(c[g]),m){u=x;break}var h=r("pattern",u);if(h===x)for(g=0;2>g;g++)m=o(c[g]),m&&(t.bounds[g]=c[g]=m-1);if(h)for(g=0;2>g;g++)switch(m=c[g],h){case x:if(!l(m))return void(t.enabled=!1);if(m=+m,m!==n(m)||0>m||7<=m)return void(t.enabled=!1);t.bounds[g]=c[g]=m;break;case _:if(!l(m))return void(t.enabled=!1);if(m=+m,0>m||24<m)return void(t.enabled=!1);t.bounds[g]=c[g]=m;}if(!1===a.autorange){var y=a.range;if(y[0]<y[1]){if(c[0]<y[0]&&c[1]>y[1])return void(t.enabled=!1);}else if(c[0]>y[0]&&c[1]<y[1])return void(t.enabled=!1)}}else{var f=r("values");if(f&&f.length)r("dvalue");else return void(t.enabled=!1)}}}function o(e){return"string"==typeof e?b[e.substr(0,3).toLowerCase()]:void 0}var l=e("fast-isnumeric"),s=e("../../registry"),d=e("../../lib"),c=e("../array_container_defaults"),p=e("./layout_attributes"),u=e("./tick_value_defaults"),g=e("./tick_mark_defaults"),m=e("./tick_label_defaults"),h=e("./category_order_defaults"),y=e("./line_grid_defaults"),f=e("./set_convert"),x=e("./constants").WEEKDAY_PATTERN,_=e("./constants").HOUR_PATTERN;t.exports=function(e,t,o,n,l){var _=n.letter,b=n.font||{},v=n.splomStash||{},w=o("visible",!n.visibleDflt),T=t._template||{},A=t.type||T.type||"-";if("date"===A){var S=s.getComponentMethod("calendars","handleDefaults");S(e,t,"calendar",n.calendar)}f(t,l);var C=!t.isValidRange(e.range);C&&n.reverseDflt&&(C="reversed");var L=o("autorange",C);L&&("linear"===A||"-"===A)&&o("rangemode"),o("range"),t.cleanRange(),h(e,t,o,n),"category"===A||n.noHover||o("hoverformat");var E=o("color"),I=E===p.color.dflt?b.color:E,P=v.label||l._dfltTitle[_];if(m(e,t,o,A,n,{pass:1}),!w)return t;o("title.text",P),d.coerceFont(o,"title.font",{family:b.family,size:r(1.2*b.size),color:I}),u(e,t,o,A),m(e,t,o,A,n,{pass:2}),g(e,t,o,n),y(e,t,o,{dfltColor:E,bgColor:n.bgColor,showGrid:n.showGrid,attributes:p}),(t.showline||t.ticks)&&o("mirror"),n.automargin&&o("automargin");var z="multicategory"===A;if(!n.noTickson&&("category"===A||z)&&(t.ticks||t.showgrid)){var D;z&&(D="boundaries"),o("tickson",D)}if(z){var O=o("showdividers");O&&(o("dividercolor"),o("dividerwidth"))}if("date"===A)if(c(e,t,{name:"rangebreaks",inclusionAttr:"enabled",handleItemDefaults:a}),!t.rangebreaks.length)delete t.rangebreaks;else{for(var R=0;R<t.rangebreaks.length;R++)if(t.rangebreaks[R].pattern===x){t._hasDayOfWeekBreaks=!0;break}if(f(t,l),l._has("scattergl")||l._has("splom"))for(var M=0,j;M<n.data.length;M++)j=n.data[M],("scattergl"===j.type||"splom"===j.type)&&(j.visible=!1,d.warn(j.type+" traces do not work on axes with rangebreaks. Setting trace "+j.index+" to `visible: false`."))}return t};var b={sun:1,mon:2,tue:3,wed:4,thu:5,fri:6,sat:7}},{"../../lib":657,"../../registry":788,"../array_container_defaults":701,"./category_order_defaults":709,"./constants":711,"./layout_attributes":719,"./line_grid_defaults":721,"./set_convert":725,"./tick_label_defaults":726,"./tick_mark_defaults":727,"./tick_value_defaults":728,"fast-isnumeric":201}],708:[function(e,t,a){'use strict';var o=e("../../registry"),r=e("./constants");a.id2name=function(e){if("string"==typeof e&&e.match(r.AX_ID_PATTERN)){var t=e.substr(1);return"1"===t&&(t=""),e.charAt(0)+"axis"+t}},a.name2id=function(e){if(e.match(r.AX_NAME_PATTERN)){var t=e.substr(5);return"1"===t&&(t=""),e.charAt(0)+t}},a.cleanId=function(e,t){if(e.match(r.AX_ID_PATTERN)&&!(t&&e.charAt(0)!==t)){var a=e.substr(1).replace(/^0+/,"");return"1"===a&&(a=""),e.charAt(0)+a}},a.list=function(e,t,o){var r=e._fullLayout;if(!r)return[];var n=a.listIds(e,t),l=Array(n.length),s;for(s=0;s<n.length;s++){var d=n[s];l[s]=r[d.charAt(0)+"axis"+d.substr(1)]}if(!o){var c=r._subplots.gl3d||[];for(s=0;s<c.length;s++){var p=r[c[s]];t?l.push(p[t+"axis"]):l.push(p.xaxis,p.yaxis,p.zaxis)}}return l},a.listIds=function(e,t){var a=e._fullLayout;if(!a)return[];var o=a._subplots;return t?o[t+"axis"]:o.xaxis.concat(o.yaxis)},a.getFromId=function(e,t,o){var r=e._fullLayout;return"x"===o?t=t.replace(/y[0-9]*/,""):"y"==o&&(t=t.replace(/x[0-9]*/,"")),r[a.id2name(t)]},a.getFromTrace=function(e,t,r){var i=e._fullLayout,n=null;if(o.traceIs(t,"gl3d")){var l=t.scene;"scene"===l.substr(0,5)&&(n=i[l][r+"axis"])}else n=a.getFromId(e,t[r+"axis"]||r);return n},a.idSort=function(e,t){var a=e.charAt(0),o=t.charAt(0);return a===o?+(e.substr(1)||1)-+(t.substr(1)||1):a>o?1:-1},a.getAxisGroup=function(e,t){for(var a=e._axisMatchGroups,o=0,r;o<a.length;o++)if(r=a[o],r[t])return"g"+o;return t}},{"../../registry":788,"./constants":711}],709:[function(e,t){'use strict';function a(e,t){var a=t.dataAttr||e._id.charAt(0),o={},r,n,l;if(t.axData)r=t.axData;else for(r=[],n=0;n<t.data.length;n++){var s=t.data[n];s[a+"axis"]===e._id&&r.push(s)}for(n=0;n<r.length;n++){var d=r[n][a];for(l=0;l<d.length;l++){var c=d[l];null!==c&&c!==void 0&&(o[c]=1)}}return Object.keys(o)}t.exports=function(e,t,o,r){if("category"===t.type){var i=e.categoryarray,n=Array.isArray(i)&&0<i.length,l;n&&(l="array");var s=o("categoryorder",l),d;"array"===s&&(d=o("categoryarray")),n||"array"!==s||(s=t.categoryorder="trace"),"trace"===s?t._initialCategories=[]:"array"===s?t._initialCategories=d.slice():(d=a(t,r).sort(),"category ascending"===s?t._initialCategories=d:"category descending"==s&&(t._initialCategories=d.reverse()))}}},{}],710:[function(e,t,a){'use strict';var o=Math.round,r=Math.max,i=e("fast-isnumeric"),n=e("../../lib"),l=e("../../constants/numerical").ONEDAY;a.dtick=function(e,t){var a="log"===t,n="date"===t,s=n?l:1;if(!e)return s;if(i(e))return e=+e,0>=e?s:"category"===t?r(1,o(e)):n?r(.1,e):e;if("string"!=typeof e||!(n||a))return s;var d=e.charAt(0),c=e.substr(1);return c=i(c)?+c:0,0>=c||!(n&&"M"===d&&c===o(c)||a&&"L"===d||a&&"D"===d&&(1===c||2===c))?s:e},a.tick0=function(e,t,a,o){return"date"===t?n.cleanDate(e,n.dateTick0(a)):"D1"===o||"D2"===o?void 0:i(e)?+e:0}},{"../../constants/numerical":633,"../../lib":657,"fast-isnumeric":201}],711:[function(e,t){'use strict';var a=e("../../lib/regex").counter;t.exports={idRegex:{x:a("x"),y:a("y")},attrRegex:a("[xy]axis"),xAxisMatch:a("xaxis"),yAxisMatch:a("yaxis"),AX_ID_PATTERN:/^[xyz][0-9]*$/,AX_NAME_PATTERN:/^[xyz]axis[0-9]*$/,SUBPLOT_PATTERN:/^x([0-9]*)y([0-9]*)$/,HOUR_PATTERN:"hour",WEEKDAY_PATTERN:"day of week",MINDRAG:8,MINSELECT:12,MINZOOM:20,DRAGGERSIZE:20,BENDPX:1.5,REDRAWDELAY:50,SELECTDELAY:100,SELECTID:"-select",DFLTRANGEX:[-1,6],DFLTRANGEY:[-1,4],traceLayerClasses:["imagelayer","heatmaplayer","contourcarpetlayer","contourlayer","funnellayer","waterfalllayer","barlayer","carpetlayer","violinlayer","boxlayer","ohlclayer","scattercarpetlayer","scatterlayer"],clipOnAxisFalseQuery:[".scatterlayer",".barlayer",".funnellayer",".waterfalllayer"],layerValue2layerClass:{"above traces":"above","below traces":"below"}}},{"../../lib/regex":673}],712:[function(e,t,a){'use strict';var n=Math.min,l=Math.abs,s=Math.max;function o(e,t,a,o,r){var n=o[c(t)].type,l=[],s,d,p,u;for(d=0;d<a.length;d++)if(p=a[d],p!==t&&(u=o[c(p)],u.type===n))if(!u.fixedrange)l.push(p);else if("range"!==r&&u.anchor){var g=o[c(u.anchor)];g.fixedrange&&l.push(p)}for(s=0;s<e.length;s++)if(e[s][t]){var m=e[s],h=[];for(d=0;d<l.length;d++)p=l[d],m[p]||h.push(p);return{linkableAxes:h,thisGroup:m}}return{linkableAxes:l,thisGroup:null}}function r(e,t,a,o,r){var n,l,s,d,c;null===t?(t={},t[a]=1,c=e.length,e.push(t)):c=e.indexOf(t);var p=Object.keys(t);for(n=0;n<e.length;n++)if(s=e[n],n!==c&&s[o]){var u=s[o];for(l=0;l<p.length;l++)d=p[l],s[d]=u*r*t[d];return void e.splice(c,1)}if(1!==r)for(l=0;l<p.length;l++)t[p[l]]*=r;t[o]=1}function i(e,t){var a=e._inputDomain,o=y[e.constraintoward],r=a[0]+(a[1]-a[0])*o;e.domain=e._input.domain=[r+(a[0]-r)/t,r+(a[1]-r)/t],e.setScale()}var d=e("../../lib"),c=e("./axis_ids").id2name,p=e("./scale_zoom"),u=e("./autorange").makePadFn,g=e("./autorange").concatExtremes,h=e("../../constants/numerical").ALMOST_EQUAL,y=e("../../constants/alignment").FROM_BL;a.handleConstraintDefaults=function(e,t,a,i){var n=i.allAxisIds,l=i.layoutOut,s=i.scaleanchorDflt,c=i.constrainDflt,p=l._axisConstraintGroups,u=l._axisMatchGroups,g=t._id,m=g.charAt(0),h=((l._splomAxes||{})[m]||{})[g]||{},y=t._id,f=y.charAt(0),x=a("constrain",c);d.coerce(e,t,{constraintoward:{valType:"enumerated",values:"x"===f?["left","center","right"]:["bottom","middle","top"],dflt:"x"===f?"center":"middle"}},"constraintoward");var _,b;(e.matches||h.matches)&&!t.fixedrange&&(b=o(u,y,n,l),_=d.coerce(e,t,{matches:{valType:"enumerated",values:b.linkableAxes||[],dflt:h.matches}},"matches"));var v,w;if(!_&&!(t.fixedrange&&"domain"!==x)&&(e.scaleanchor||s)&&(w=o(p,y,n,l,x),v=d.coerce(e,t,{scaleanchor:{valType:"enumerated",values:w.linkableAxes||[]}},"scaleanchor",s)),_?(delete t.constrain,r(u,b.thisGroup,y,_,1)):-1!==n.indexOf(e.matches)&&d.warn("ignored "+t._name+".matches: \""+e.matches+"\" to avoid either an infinite loop or because the target axis has fixed range."),v){var k=a("scaleratio");k||(k=t.scaleratio=1),r(p,w.thisGroup,y,v,k)}else-1!==n.indexOf(e.scaleanchor)&&d.warn("ignored "+t._name+".scaleanchor: \""+e.scaleanchor+"\" to avoid either an infinite loop and possibly inconsistent scaleratios, or because the target axis has fixed range or this axis declares a *matches* constraint.")},a.enforce=function(e){var t=e._fullLayout,a=t._axisConstraintGroups||[],o,r,d,y,f,x,_;for(o=0;o<a.length;o++){var b=a[o],v=Object.keys(b),w=1/0,T=0,A=1/0,S={},C={},L=!1;for(r=0;r<v.length;r++)d=v[r],C[d]=y=t[c(d)],y._inputDomain?y.domain=y._inputDomain.slice():y._inputDomain=y.domain.slice(),y._inputRange||(y._inputRange=y.range.slice()),y.setScale(),S[d]=f=l(y._m)/b[d],w=n(w,f),"domain"!==y.constrain&&y._constraintShrinkable||(A=n(A,f)),delete y._constraintShrinkable,T=s(T,f),"domain"===y.constrain&&(L=!0);if(!(w>h*T)||L)for(r=0;r<v.length;r++)if(d=v[r],f=S[d],y=C[d],x=y.constrain,f!==A||"domain"===x)if(_=f/A,"range"===x)p(y,_);else{var E=y._inputDomain,I=(y.domain[1]-y.domain[0])/(E[1]-E[0]),P=(y.r2l(y.range[1])-y.r2l(y.range[0]))/(y.r2l(y._inputRange[1])-y.r2l(y._inputRange[0]));if(_/=I,1>_*P){y.domain=y._input.domain=E.slice(),p(y,_);continue}if(1>P&&(y.range=y._input.range=y._inputRange.slice(),_*=P),y.autorange){var z=y.r2l(y.range[0]),D=y.r2l(y.range[1]),O=(z+D)/2,R=O,M=O,B=l(D-O),F=O-1.0001*(B*_),N=O+1.0001*(B*_),V=u(y);i(y,_);var U=l(y._m),m=g(e,y),H=m.min,q=m.max,G,Y;for(Y=0;Y<H.length;Y++)G=H[Y].val-V(H[Y])/U,G>F&&G<R&&(R=G);for(Y=0;Y<q.length;Y++)G=q[Y].val+V(q[Y])/U,G<N&&G>M&&(M=G);var W=(M-R)/(2*B);_/=W,R=y.l2r(R),M=y.l2r(M),y.range=y._input.range=z<D?[R,M]:[M,R]}i(y,_)}}},a.clean=function(e,t){if(t._inputDomain){for(var a=!1,o=t._id,r=e._fullLayout._axisConstraintGroups,i=0;i<r.length;i++)if(r[i][o]){a=!0;break}a&&"domain"===t.constrain||(t._input.domain=t.domain=t._inputDomain,delete t._inputDomain)}}},{"../../constants/alignment":626,"../../constants/numerical":633,"../../lib":657,"./autorange":704,"./axis_ids":708,"./scale_zoom":723}],713:[function(e,t){'use strict';var w=Math.exp,k=Math.LN10,T=Math.log,A=Math.ceil,S=Math.min,C=Math.pow,L=Math.abs,E=Math.max,I=Math.floor;function a(e,t,a,o){var r=R.ensureSingle(e.draglayer,t,a,function(t){t.classed("drag",!0).style({fill:"transparent","stroke-width":0}).attr("data-subplot",e.id)});return r.call(V,o),r.node()}function o(e,t,o,r,i,n,l){var s=a(e,"rect",t,o);return P.select(s).call(B.setRect,r,i,n,l),s}function r(e,t){for(var a=0;a<e.length;a++)if(!e[a].fixedrange)return t;return""}function i(e,t){var a=e.range[t],o=L(a-e.range[1-t]),r;return"date"===e.type?a:"log"===e.type?(r=A(E(0,-T(o)/k))+3,P.format("."+r+"g")(C(10,a))):(r=I(T(L(a))/k)-I(T(o)/k)+4,P.format("."+(r+"g"))(a))}function n(e,t,a,o,r){for(var l=0,s;l<e.length;l++)if(s=e[l],!s.fixedrange)if(s.rangebreaks){var d="y"===s._id.charAt(0),c=d?1-t:t,p=d?1-a:a;o[s._name+".range[0]"]=s.l2r(s.p2l(c*s._length)),o[s._name+".range[1]"]=s.l2r(s.p2l(p*s._length))}else{var u=s._rl[0],g=s._rl[1]-u;o[s._name+".range[0]"]=s.l2r(u+g*t),o[s._name+".range[1]"]=s.l2r(u+g*a)}if(r&&r.length){var m=(t+(1-a))/2;n(r,m,1-m,o,[])}}function l(e,t){for(var a=0,o;a<e.length;a++)if(o=e[a],!o.fixedrange)if(o.rangebreaks){var r=o._length,n=o.p2l(0+t)-o.p2l(0),l=o.p2l(r+t)-o.p2l(r),s=(n+l)/2;o.range=[o.l2r(o._rl[0]-s),o.l2r(o._rl[1]-s)]}else o.range=[o.l2r(o._rl[0]-t/o._m),o.l2r(o._rl[1]-t/o._m)]}function s(e){return 1-(0<=e?S(e,.9):1/(1/E(e,-.3)+3.222))}function d(e,t,a){return e?"nsew"===e?a?"":"pan"===t?"move":"crosshair":e.toLowerCase()+"-resize":"pointer"}function c(e,t,a,o,r){return e.append("path").attr("class","zoombox").style({fill:.2<t?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("transform","translate("+a+", "+o+")").attr("d",r+"Z")}function p(e,t,a){return e.append("path").attr("class","zoombox-corners").style({fill:j.background,stroke:j.defaultLine,"stroke-width":1,opacity:0}).attr("transform","translate("+t+", "+a+")").attr("d","M0,0Z")}function u(e,t,a,o,r,i){e.attr("d",o+"M"+a.l+","+a.t+"v"+a.h+"h"+a.w+"v-"+a.h+"h-"+a.w+"Z"),g(e,t,r,i)}function g(e,t,a,o){a||(e.transition().style("fill",.2<o?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),t.transition().style("opacity",1).duration(200))}function m(e){P.select(e).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}function h(e){re&&e.data&&e._context.showTips&&(R.notifier(R._(e,"Double-click to zoom back out"),"long"),re=!1)}function y(e,t){return"M"+(e.l-.5)+","+(t-oe-.5)+"h-3v"+(2*oe+1)+"h3ZM"+(e.r+.5)+","+(t-oe-.5)+"h3v"+(2*oe+1)+"h-3Z"}function f(e,t){return"M"+(t-oe-.5)+","+(e.t-.5)+"v-3h"+(2*oe+1)+"v3ZM"+(t-oe-.5)+","+(e.b+.5)+"v3h"+(2*oe+1)+"v-3Z"}function x(e){var t=I(S(e.b-e.t,e.r-e.l,oe)/2);return"M"+(e.l-3.5)+","+(e.t-.5+t)+"h3v"+-t+"h"+t+"v-3h-"+(t+3)+"ZM"+(e.r+3.5)+","+(e.t-.5+t)+"h-3v"+-t+"h"+-t+"v-3h"+(t+3)+"ZM"+(e.r+3.5)+","+(e.b+.5-t)+"h-3v"+t+"h"+-t+"v3h"+(t+3)+"ZM"+(e.l-3.5)+","+(e.b+.5-t)+"h3v"+t+"h"+t+"v3h-"+(t+3)+"Z"}function _(e,t,a,o){for(var r=!1,n={},l={},s=0,d,c,p,u,g;s<t.length;s++){for(d in g=t[s],a)if(g[d]){for(p in g)("x"===p.charAt(0)?a:o)[p]||(n[p]=d);for(c in o)g[c]&&(r=!0)}for(c in o)if(g[c])for(u in g)("x"===u.charAt(0)?a:o)[u]||(l[u]=c)}r&&(R.extendFlat(n,l),l={});var m={},h=[];for(p in n){var y=K(e,p);h.push(y),m[y._id]=y}var f={},x=[];for(u in l){var _=K(e,u);x.push(_),f[_._id]=_}return{xaHash:m,yaHash:f,xaxes:h,yaxes:x,xLinks:n,yLinks:l,isSubplotConstrained:r}}function b(e,t){if(!D)void 0===e.onwheel?void 0!==e.onmousewheel&&(e.onmousewheel=t):e.onwheel=t;else{var a=e.onwheel===void 0?"mousewheel":"wheel";e._onwheel&&e.removeEventListener(a,e._onwheel),e._onwheel=t,e.addEventListener(a,t,{passive:!1})}}function v(e){var t=[];for(var a in e)t.push(e[a]);return t}var P=e("d3"),z=e("tinycolor2"),D=e("has-passive-events"),O=e("../../registry"),R=e("../../lib"),M=e("../../lib/svg_text_utils"),j=e("../../components/color"),B=e("../../components/drawing"),F=e("../../components/fx"),N=e("./axes"),V=e("../../lib/setcursor"),U=e("../../components/dragelement"),H=e("../../components/dragelement/helpers"),q=H.selectingOrDrawing,G=H.freeMode,Y=e("../../constants/alignment").FROM_TL,W=e("../../lib/clear_gl_canvases"),X=e("../../plot_api/subroutines").redrawReglTraces,Z=e("../plots"),K=e("./axis_ids").getFromId,$=e("./select").prepSelect,J=e("./select").clearSelect,Q=e("./select").selectOnClick,ee=e("./scale_zoom"),te=e("./constants"),ae=te.MINDRAG,oe=te.MINZOOM,re=!0;t.exports={makeDragBox:function(t,e,a,g,k,T,A,C){function I(){if(_e=e.xaxis,be=e.yaxis,Ce=_e._length,Le=be._length,Ae=_e._offset,Se=be._offset,ve={},ve[_e._id]=_e,we={},we[be._id]=be,A&&C)for(var a=e.overlays,o=0,n;o<a.length;o++){n=a[o].xaxis,ve[n._id]=n;var l=a[o].yaxis;we[l._id]=l}ke=v(ve),Te=v(we),Pe=r(ke,C),ze=r(Te,A),De=!ze&&!Pe,Ee=_(t,t._fullLayout._axisConstraintGroups,ve,we),Ie=_(t,t._fullLayout._axisMatchGroups,ve,we),Oe=C||Ee.isSubplotConstrained||Ie.isSubplotConstrained,Re=A||Ee.isSubplotConstrained||Ie.isSubplotConstrained;var s=t._fullLayout;Me=s._has("scattergl"),je=s._has("splom"),Be=s._has("svg")}function D(){Ue.plotinfo.selection=!1,J(t)}function j(t,a){var o=Ue.gd;if(0<=o._fullLayout._activeShapeIndex)return void o._fullLayout._deactivateShape(o);var r=o._fullLayout.clickmode;if(m(o),2!==t||xe||ce(),fe)-1<r.indexOf("select")&&Q(a,o,ke,Te,e.id,Ue),-1<r.indexOf("event")&&F.click(o,a,e.id);else if(1===t&&xe){var n=A?be:_e,l="s"===A||"w"===C?0:1,s=n._name+".range["+l+"]",d=i(n,l),c="left",p="middle";if(n.fixedrange)return;A?(p="n"===A?"top":"bottom","right"===n.side&&(c="right")):"e"===C&&(c="right"),o._context.showAxisRangeEntryBoxes&&P.select(Ve).call(M.makeEditable,{gd:o,immediate:!0,background:o._fullLayout.paper_bgcolor,text:d+"",fill:n.tickfont?n.tickfont.color:"#444",horizontalAlign:c,verticalAlign:p}).on("edit",function(e){var t=n.d2r(e);void 0!==t&&O.call("_guiRelayout",o,s,t)})}}function V(a,e,o){var r=Ve.getBoundingClientRect();We=e-r.left,Xe=o-r.top,Ze={l:We,r:We,w:0,t:Xe,b:Xe,h:0},Ke=t._hmpixcount?t._hmlumcount/t._hmpixcount:z(t._fullLayout.plot_bgcolor).getLuminance(),$e="M0,0H"+Ce+"V"+Le+"H0V0",Je=!1,Qe="xy",at=!1,et=c(ye,Ke,Ae,Se,$e),tt=p(ye,Ae,Se)}function H(e,a){function o(){Qe="",Ze.r=Ze.l,Ze.t=Ze.b,tt.attr("d","M0,0Z")}if(t._transitioningWithDuration)return!1;var r=E(0,S(Ce,e+We)),i=E(0,S(Le,a+Xe)),n=L(r-We),l=L(i-Xe);if(Ze.l=S(We,r),Ze.r=E(We,r),Ze.t=S(Xe,i),Ze.b=E(Xe,i),Ee.isSubplotConstrained)n>oe||l>oe?(Qe="xy",n/Ce>l/Le?(l=n*Le/Ce,Xe>i?Ze.t=Xe-l:Ze.b=Xe+l):(n=l*Ce/Le,We>r?Ze.l=We-n:Ze.r=We+n),tt.attr("d",x(Ze))):o();else if(!Ie.isSubplotConstrained)!ze||l<S(E(.6*n,ae),oe)?n<ae||!Pe?o():(Ze.t=0,Ze.b=Le,Qe="x",tt.attr("d",y(Ze,Xe))):!Pe||n<S(.6*l,oe)?(Ze.l=0,Ze.r=Ce,Qe="y",tt.attr("d",f(Ze,We))):(Qe="xy",tt.attr("d",x(Ze)));else if(n>oe||l>oe){Qe="xy";var s=S(Ze.l/Ce,(Le-Ze.b)/Le),d=E(Ze.r/Ce,(Le-Ze.t)/Le);Ze.l=s*Ce,Ze.r=d*Ce,Ze.b=(1-s)*Le,Ze.t=(1-d)*Le,tt.attr("d",x(Ze))}else o();Ze.w=Ze.r-Ze.l,Ze.h=Ze.b-Ze.t,Qe&&(at=!0),t._dragged=at,u(et,tt,Ze,$e,Je,Ke),re(),t.emit("plotly_relayouting",Fe),Je=!0}function re(){Fe={},("xy"===Qe||"x"===Qe)&&(n(ke,Ze.l/Ce,Ze.r/Ce,Fe,Ee.xaxes),se("x",Fe)),("xy"===Qe||"y"===Qe)&&(n(Te,(Le-Ze.b)/Le,(Le-Ze.t)/Le,Fe,Ee.yaxes),se("y",Fe))}function ie(){re(),m(t),pe(),h(t)}function ne(a){function e(e,t,a){function o(t){return e.l2r(i+(t-i)*a)}if(!e.fixedrange){var r=R.simpleMap(e.range,e.r2l),i=r[0]+(r[1]-r[0])*t;e.range=r.map(o)}}if(t._context._scrollZoom.cartesian||t._fullLayout._enablescrollzoom){if(D(),t._transitioningWithDuration)return a.preventDefault(),void a.stopPropagation();I(),clearTimeout(qe);var o=-a.deltaY;if(isFinite(o)||(o=a.wheelDelta/10),!isFinite(o))return void R.log("Did not find wheel motion attributes: ",a);var r=w(-S(E(o,-20),20)/200),n=Ye.draglayer.select(".nsewdrag").node().getBoundingClientRect(),l=(a.clientX-n.left)/n.width,s=(n.bottom-a.clientY)/n.height,d;if(Oe){for(C||(l=.5),d=0;d<ke.length;d++)e(ke[d],l,r);se("x"),He[2]*=r,He[0]+=He[2]*l*(1/r-1)}if(Re){for(A||(s=.5),d=0;d<Te.length;d++)e(Te[d],s,r);se("y"),He[3]*=r,He[1]+=He[3]*(1-s)*(1/r-1)}return ue(He),de(),t.emit("plotly_relayouting",Fe),qe=setTimeout(function(){He=[0,0,Ce,Le],pe()},Ge),void a.preventDefault()}}function le(e,a){function o(e,t,a){for(var o=1-t,r=0,n,l,d;r<e.length;r++)if(d=e[r],!d.fixedrange){n=d,l=d._rl[o]+(d._rl[t]-d._rl[o])/s(a/d._length);var c=d.l2r(l);!1!==c&&void 0!==c&&(d.range[t]=c)}return n._length*(n._rl[t]-l)/(n._rl[t]-n._rl[o])}if(!t._transitioningWithDuration){if(t._fullLayout._replotting=!0,"ew"===Pe||"ns"===ze)return Pe&&(l(ke,e),se("x")),ze&&(l(Te,a),se("y")),ue([Pe?-e:0,ze?-a:0,Ce,Le]),de(),void t.emit("plotly_relayouting",Fe);if(Ee.isSubplotConstrained&&Pe&&ze){var r="w"===Pe==("n"===ze)?1:-1,n=(e/Ce+r*a/Le)/2;e=n*Ce,a=r*n*Le}"w"===Pe?e=o(ke,0,e):"e"===Pe?e=o(ke,1,-e):!Pe&&(e=0),"n"===ze?a=o(Te,1,a):"s"===ze?a=o(Te,0,-a):!ze&&(a=0);var d="w"===Pe?e:0,c="n"===ze?a:0;if(Ee.isSubplotConstrained){var p;if(!Pe&&1===ze.length){for(p=0;p<ke.length;p++)ke[p].range=ke[p]._r.slice(),ee(ke[p],1-a/Le);e=a*Ce/Le,d=e/2}if(!ze&&1===Pe.length){for(p=0;p<Te.length;p++)Te[p].range=Te[p]._r.slice(),ee(Te[p],1-e/Ce);a=e*Le/Ce,c=a/2}}se("x"),se("y"),ue([d,c,Ce-e,Le-a]),de(),t.emit("plotly_relayouting",Fe)}}function se(e,t){for(var a=Ie.isSubplotConstrained?{x:Te,y:ke}[e]:Ie[e+"axes"],o=Ie.isSubplotConstrained?{x:ke,y:Te}[e]:[],r=0;r<a.length;r++){var n=a[r],l=n._id,s=Ie.xLinks[l]||Ie.yLinks[l],d=o[0]||ve[s]||we[s];d&&(t?(t[n._name+".range[0]"]=t[d._name+".range[0]"],t[n._name+".range[1]"]=t[d._name+".range[1]"]):n.range=d.range.slice())}}function de(){function e(e){for(o=0;o<e.length;o++)e[o].fixedrange||a.push(e[o]._id)}var a=[],o;for(Oe&&(e(ke),e(Ee.xaxes),e(Ie.xaxes)),Re&&(e(Te),e(Ee.yaxes),e(Ie.yaxes)),Fe={},o=0;o<a.length;o++){var r=a[o],n=K(t,r);N.drawOne(t,n,{skipTitle:!0}),Fe[n._name+".range[0]"]=n.range[0],Fe[n._name+".range[1]"]=n.range[1]}N.redrawComponents(t,a)}function ce(){if(!t._transitioningWithDuration){var e=t._context.doubleClick,a=[];Pe&&(a=a.concat(ke)),ze&&(a=a.concat(Te)),Ie.xaxes&&(a=a.concat(Ie.xaxes)),Ie.yaxes&&(a=a.concat(Ie.yaxes));var o={},r,n,l;if("reset+autosize"===e)for(e="autosize",n=0;n<a.length;n++)if(r=a[n],r._rangeInitial&&(r.range[0]!==r._rangeInitial[0]||r.range[1]!==r._rangeInitial[1])||!r._rangeInitial&&!r.autorange){e="reset";break}if("autosize"===e)for(n=0;n<a.length;n++)r=a[n],r.fixedrange||(o[r._name+".autorange"]=!0);else if("reset"===e)for((Pe||Ee.isSubplotConstrained)&&(a=a.concat(Ee.xaxes)),ze&&!Ee.isSubplotConstrained&&(a=a.concat(Ee.yaxes)),Ee.isSubplotConstrained&&(Pe?!ze&&(a=a.concat(Te)):a=a.concat(ke)),n=0;n<a.length;n++)r=a[n],r.fixedrange||(r._rangeInitial?(l=r._rangeInitial,o[r._name+".range[0]"]=l[0],o[r._name+".range[1]"]=l[1]):o[r._name+".autorange"]=!0);t.emit("plotly_doubleclick",null),O.call("_guiRelayout",t,o)}}function pe(){ue([0,0,Ce,Le]),R.syncOrAsync([Z.previousPromises,function(){t._fullLayout._replotting=!1,O.call("_guiRelayout",t,Fe)}],t)}function ue(e){var a=t._fullLayout,o=a._plots,r=a._subplots.cartesian,n,l,s,d;if(je&&O.subplotsRegistry.splom.drag(t),Me)for(n=0;n<r.length;n++)if(l=o[r[n]],s=l.xaxis,d=l.yaxis,l._scene){var c=R.simpleMap(s.range,s.r2l),p=R.simpleMap(d.range,d.r2l);l._scene.update({range:[c[0],p[0],c[1],p[1]]})}if((je||Me)&&(W(t),X(t)),Be){var u=e[2]/_e._length,g=e[3]/be._length;for(n=0;n<r.length;n++){l=o[r[n]],s=l.xaxis,d=l.yaxis;var m=Oe&&!s.fixedrange&&ve[s._id],h=Re&&!d.fixedrange&&we[d._id],y,f,x,_;if(m?(y=u,x=C?e[0]:he(s,y)):Ie.xaHash[s._id]?(y=u,x=e[0]*s._length/_e._length):Ie.yaHash[s._id]?(y=g,x="ns"===ze?-e[1]*s._length/be._length:he(s,y,{n:"top",s:"bottom"}[ze])):(y=ge(s,u,g),x=me(s,y)),h?(f=g,_=A?e[1]:he(d,f)):Ie.yaHash[d._id]?(f=g,_=e[1]*d._length/be._length):Ie.xaHash[d._id]?(f=u,_="ew"===Pe?-e[0]*d._length/_e._length:he(d,f,{e:"right",w:"left"}[Pe])):(f=ge(d,u,g),_=me(d,f)),y||f){y||(y=1),f||(f=1);var b=s._offset-x/y,v=d._offset-_/f;l.clipRect.call(B.setTranslate,x,_).call(B.setScale,y,f),l.plot.call(B.setTranslate,b,v).call(B.setScale,1/y,1/f),(y!==l.xScaleFactor||f!==l.yScaleFactor)&&(B.setPointGroupScale(l.zoomScalePts,y,f),B.setTextPointsScale(l.zoomScaleTxt,y,f)),B.hideOutsideRangePoints(l.clipOnAxisFalseTraces,l),l.xScaleFactor=y,l.yScaleFactor=f}}}}function ge(e,t,a){return e.fixedrange?0:Oe&&Ee.xaHash[e._id]?t:Re&&(Ee.isSubplotConstrained?Ee.xaHash:Ee.yaHash)[e._id]?a:0}function me(e,t){return t?(e.range=e._r.slice(),ee(e,t),he(e,t)):0}function he(e,t,a){return e._length*(1-t)*Y[a||e.constraintoward||"middle"]}var ye=t._fullLayout._zoomlayer,fe="nsew"===A+C,xe=1===(A+C).length,_e,be,ve,we,ke,Te,Ae,Se,Ce,Le,Ee,Ie,Pe,ze,De,Oe,Re,Me,je,Be,Fe;I();var Ne=d(ze+Pe,t._fullLayout.dragmode,fe),Ve=o(e,A+C+"drag",Ne,a,g,k,T);if(De&&!fe)return Ve.onmousedown=null,Ve.style.pointerEvents="none",Ve;var Ue={element:Ve,gd:t,plotinfo:e};Ue.prepFn=function(a,e,o){var r=Ue.dragmode,i=t._fullLayout.dragmode;i!==r&&(Ue.dragmode=i),I(),De||(fe?a.shiftKey?"pan"===i?i="zoom":!q(i)&&(i="pan"):a.ctrlKey&&(i="pan"):i="pan"),Ue.minDrag=G(i)?1:void 0,q(i)?(Ue.xaxes=ke,Ue.yaxes=Te,$(a,e,o,Ue,i)):(Ue.clickFn=j,q(r)&&D(),!De&&("zoom"===i?(Ue.moveFn=H,Ue.doneFn=ie,Ue.minDrag=1,V(a,e,o)):"pan"===i&&(Ue.moveFn=le,Ue.doneFn=pe))),t._fullLayout._redrag=function(){var e=t._dragdata;if(e&&e.element===Ve){var a=t._fullLayout.dragmode;q(a)||(I(),ue([0,0,Ce,Le]),Ue.moveFn(e.dx,e.dy))}}},U.init(Ue);var He=[0,0,Ce,Le],qe=null,Ge=te.REDRAWDELAY,Ye=e.mainplot?t._fullLayout._plots[e.mainplot]:e,We,Xe,Ze,Ke,$e,Je,Qe,et,tt,at;return 1!=A.length*C.length&&b(Ve,ne),Ve},makeDragger:a,makeRectDragger:o,makeZoombox:c,makeCorners:p,updateZoombox:u,xyCorners:x,transitionZoombox:g,removeZoombox:m,showDoubleClickNotifier:h,attachWheelEventHandler:b}},{"../../components/color":524,"../../components/dragelement":543,"../../components/dragelement/helpers":542,"../../components/drawing":546,"../../components/fx":564,"../../constants/alignment":626,"../../lib":657,"../../lib/clear_gl_canvases":642,"../../lib/setcursor":677,"../../lib/svg_text_utils":681,"../../plot_api/subroutines":696,"../../registry":788,"../plots":768,"./axes":705,"./axis_ids":708,"./constants":711,"./scale_zoom":723,"./select":724,d3:108,"has-passive-events":380,tinycolor2:1309}],714:[function(e,t,a){'use strict';var o=e("d3"),r=e("../../components/fx"),i=e("../../components/dragelement"),n=e("../../lib/setcursor"),l=e("./dragbox").makeDragBox,s=e("./constants").DRAGGERSIZE;a.initInteractions=function(e){var t=e._fullLayout;if(e._context.staticPlot)return void o.select(e).selectAll(".drag").remove();if(t._has("cartesian")||t._has("splom")){var n=Object.keys(t._plots||{}).sort(function(e,a){if((t._plots[e].mainplot&&!0)===(t._plots[a].mainplot&&!0)){var o=e.split("y"),r=a.split("y");return o[0]===r[0]?+(o[1]||1)-+(r[1]||1):+(o[0]||1)-+(r[0]||1)}return t._plots[e].mainplot?1:-1});n.forEach(function(a){var o=t._plots[a],n=o.xaxis,d=o.yaxis;if(!o.mainplot){var c=l(e,o,n._offset,d._offset,n._length,d._length,"ns","ew");c.onmousemove=function(t){e._fullLayout._rehover=function(){e._fullLayout._hoversubplot===a&&e._fullLayout._plots[a]&&r.hover(e,t,a)},r.hover(e,t,a),e._fullLayout._lasthover=c,e._fullLayout._hoversubplot=a},c.onmouseout=function(t){e._dragging||(e._fullLayout._hoversubplot=null,i.unhover(e,t))},e._context.showAxisDragHandles&&(l(e,o,n._offset-s,d._offset-s,s,s,"n","w"),l(e,o,n._offset+n._length,d._offset-s,s,s,"n","e"),l(e,o,n._offset-s,d._offset+d._length,s,s,"s","w"),l(e,o,n._offset+n._length,d._offset+d._length,s,s,"s","e"))}if(e._context.showAxisDragHandles){if(a===n._mainSubplot){var p=n._mainLinePosition;"top"===n.side&&(p-=s),l(e,o,n._offset+.1*n._length,p,.8*n._length,s,"","ew"),l(e,o,n._offset,p,.1*n._length,s,"","w"),l(e,o,n._offset+.9*n._length,p,.1*n._length,s,"","e")}if(a===d._mainSubplot){var u=d._mainLinePosition;"right"!==d.side&&(u-=s),l(e,o,u,d._offset+.1*d._length,s,.8*d._length,"ns",""),l(e,o,u,d._offset+.9*d._length,s,.1*d._length,"s",""),l(e,o,u,d._offset,s,.1*d._length,"n","")}}});var d=t._hoverlayer.node();d.onmousemove=function(a){a.target=e._fullLayout._lasthover,r.hover(e,a,t._hoversubplot)},d.onclick=function(t){t.target=e._fullLayout._lasthover,r.click(e,t)},d.onmousedown=function(t){e._fullLayout._lasthover.onmousedown(t)},a.updateFx(e)}},a.updateFx=function(e){var t=e._fullLayout,a="pan"===t.dragmode?"move":"crosshair";n(t._draggers,a)}},{"../../components/dragelement":543,"../../components/fx":564,"../../lib/setcursor":677,"./constants":711,"./dragbox":713,d3:108}],715:[function(e,t){'use strict';t.exports={clearOutlineControllers:function(e){var t=e._fullLayout._zoomlayer;t&&t.selectAll(".outline-controllers").remove()},clearSelect:function(e){var t=e._fullLayout._zoomlayer;t&&t.selectAll(".select-outline").remove(),e._fullLayout._drawing=!1}}},{}],716:[function(e,t){'use strict';function a(e,t){switch(e.type){case"log":return e.p2d(t);case"date":return e.p2r(t,0,e.calendar);default:return e.p2r(t);}}t.exports={p2r:a,r2p:function(e,t){switch(e.type){case"log":return e.d2p(t);case"date":return e.r2p(t,0,e.calendar);default:return e.r2p(t);}},axValue:function(e){var t="y"===e._id.charAt(0)?1:0;return function(o){return a(e,o[t])}},getTransform:function(e){return"translate("+e.xaxis._offset+","+e.yaxis._offset+")"}}},{}],717:[function(e,t){'use strict';var a=e("../../registry"),o=e("../../lib");t.exports=function(e){return function(t,r){var n=t[e];if(Array.isArray(n))for(var l=a.subplotsRegistry.cartesian,s=l.idRegex,d=r._subplots,c=d.xaxis,p=d.yaxis,u=d.cartesian,g=r._has("cartesian")||r._has("gl2d"),m=0,h;m<n.length;m++)if(h=n[m],o.isPlainObject(h)){var y=h.xref,f=h.yref,x=s.x.test(y),_=s.y.test(f);if(x||_){g||o.pushUnique(r._basePlotModules,l);var b=!1;x&&-1===c.indexOf(y)&&(c.push(y),b=!0),_&&-1===p.indexOf(f)&&(p.push(f),b=!0),b&&x&&_&&u.push(y+f)}}}}},{"../../lib":657,"../../registry":788}],718:[function(e,t,a){'use strict';function o(e,t,a){return p.ensureSingle(e,t,a,function(e){e.datum(a)})}function r(e,t,a,o,r){for(var n=y.traceLayerClasses,l=e._fullLayout,s=l._modules,p=[],u=[],h=0,f,x,_;h<s.length;h++){f=s[h];var b=f.name,v=d.modules[b].categories;if(v.svg){var w=f.layerName||b+"layer",k=f.plot;x=m(a,k),_=x[0],a=x[1],_.length&&p.push({i:n.indexOf(w),className:w,plotMethod:k,cdModule:_}),v.zoomScale&&u.push("."+w)}}p.sort(function(e,t){return e.i-t.i});var T=t.plot.selectAll("g.mlayer").data(p,function(e){return e.className});if(T.enter().append("g").attr("class",function(e){return e.className}).classed("mlayer",!0).classed("rangeplot",t.isRangePlot),T.exit().remove(),T.order(),T.each(function(a){var i=c.select(this),n=a.className;a.plotMethod(e,t,a.cdModule,i,o,r),-1===y.clipOnAxisFalseQuery.indexOf("."+n)&&g.setClipUrl(i,t.layerClipId,e)}),l._has("scattergl")&&(f=d.getModule("scattergl"),_=m(a,f)[0],f.plot(e,t,_)),!e._context.staticPlot&&(t._hasClipOnAxisFalse&&(t.clipOnAxisFalseTraces=t.plot.selectAll(y.clipOnAxisFalseQuery.join(",")).selectAll(".trace")),u.length)){var A=t.plot.selectAll(u.join(",")).selectAll(".trace");t.zoomScalePts=A.selectAll("path.point"),t.zoomScaleTxt=A.selectAll(".textpoint")}}function i(e){var t=e._fullLayout,a=t._subplots.cartesian,o=a.length,r=[],n=[],l,s,c,p,u,g;for(l=0;l<o;l++){c=a[l],p=t._plots[c],u=p.xaxis,g=p.yaxis;var m=u._mainAxis,h=g._mainAxis,y=m._id+h._id,f=t._plots[y];p.overlays=[],y!==c&&f?(p.mainplot=y,p.mainplotinfo=f,n.push(c)):(p.mainplot=void 0,p.mainPlotinfo=void 0,r.push(c))}for(l=0;l<n.length;l++)c=n[l],p=t._plots[c],p.mainplotinfo.overlays.push(p);var x=r.concat(n),_=Array(o);for(l=0;l<o;l++){c=x[l],p=t._plots[c],u=p.xaxis,g=p.yaxis;var b=[c,u.layer,g.layer,u.overlaying||"",g.overlaying||""];for(s=0;s<p.overlays.length;s++)b.push(p.overlays[s].id);_[l]=b}return _}function n(e,t){var a=t.plotgroup,r=t.id,i=y.layerValue2layerClass[t.xaxis.layer],n=y.layerValue2layerClass[t.yaxis.layer],l=e._fullLayout._hasOnlyLargeSploms;if(!!t.mainplot){var s=t.mainplotinfo,d=s.plotgroup,c=r+"-x",p=r+"-y";t.gridlayer=s.gridlayer,t.zerolinelayer=s.zerolinelayer,x(s.overlinesBelow,"path",c),x(s.overlinesBelow,"path",p),x(s.overaxesBelow,"g",c),x(s.overaxesBelow,"g",p),t.plot=x(s.overplot,"g",r),x(s.overlinesAbove,"path",c),x(s.overlinesAbove,"path",p),x(s.overaxesAbove,"g",c),x(s.overaxesAbove,"g",p),t.xlines=d.select(".overlines-"+i).select("."+c),t.ylines=d.select(".overlines-"+n).select("."+p),t.xaxislayer=d.select(".overaxes-"+i).select("."+c),t.yaxislayer=d.select(".overaxes-"+n).select("."+p)}else if(l)t.xlines=x(a,"path","xlines-above"),t.ylines=x(a,"path","ylines-above"),t.xaxislayer=x(a,"g","xaxislayer-above"),t.yaxislayer=x(a,"g","yaxislayer-above");else{var u=x(a,"g","layer-subplot");t.shapelayer=x(u,"g","shapelayer"),t.imagelayer=x(u,"g","imagelayer"),t.gridlayer=x(a,"g","gridlayer"),t.zerolinelayer=x(a,"g","zerolinelayer"),x(a,"path","xlines-below"),x(a,"path","ylines-below"),t.overlinesBelow=x(a,"g","overlines-below"),x(a,"g","xaxislayer-below"),x(a,"g","yaxislayer-below"),t.overaxesBelow=x(a,"g","overaxes-below"),t.plot=x(a,"g","plot"),t.overplot=x(a,"g","overplot"),t.xlines=x(a,"path","xlines-above"),t.ylines=x(a,"path","ylines-above"),t.overlinesAbove=x(a,"g","overlines-above"),x(a,"g","xaxislayer-above"),x(a,"g","yaxislayer-above"),t.overaxesAbove=x(a,"g","overaxes-above"),t.xlines=a.select(".xlines-"+i),t.ylines=a.select(".ylines-"+n),t.xaxislayer=a.select(".xaxislayer-"+i),t.yaxislayer=a.select(".yaxislayer-"+n)}l||(o(t.gridlayer,"g",t.xaxis._id),o(t.gridlayer,"g",t.yaxis._id),t.gridlayer.selectAll("g").map(function(e){return e[0]}).sort(h.idSort)),t.xlines.style("fill","none").classed("crisp",!0),t.ylines.style("fill","none").classed("crisp",!0)}function l(e,t){if(e){var a={};for(var o in e.each(function(e){var o=e[0],r=c.select(this);r.remove(),s(o,t),a[o]=!0}),t._plots)for(var r=t._plots[o],i=r.overlays||[],n=0,l;n<i.length;n++)l=i[n],a[l.id]&&l.plot.selectAll(".trace").remove()}}function s(e,t){t._draggers.selectAll("g."+e).remove(),t._defs.select("#clip"+t._uid+e+"plot").remove()}var c=e("d3"),d=e("../../registry"),p=e("../../lib"),u=e("../plots"),g=e("../../components/drawing"),m=e("../get_data").getModuleCalcData,h=e("./axis_ids"),y=e("./constants"),f=e("../../constants/xmlns_namespaces"),x=p.ensureSingle;a.name="cartesian",a.attr=["xaxis","yaxis"],a.idRoot=["x","y"],a.idRegex=y.idRegex,a.attrRegex=y.attrRegex,a.attributes=e("./attributes"),a.layoutAttributes=e("./layout_attributes"),a.supplyLayoutDefaults=e("./layout_defaults"),a.transitionAxes=e("./transition_axes"),a.finalizeSubplots=function(e,t){var a=t._subplots,o=a.xaxis,r=a.yaxis,n=a.cartesian,l=n.concat(a.gl2d||[]),s={},d={},c,u,g;for(c=0;c<l.length;c++){var m=l[c].split("y");s[m[0]]=1,d["y"+m[1]]=1}for(c=0;c<o.length;c++)u=o[c],s[u]||(g=(e[h.id2name(u)]||{}).anchor,!y.idRegex.y.test(g)&&(g="y"),n.push(u+g),l.push(u+g),!d[g]&&(d[g]=1,p.pushUnique(r,g)));for(c=0;c<r.length;c++)g=r[c],d[g]||(u=(e[h.id2name(g)]||{}).anchor,!y.idRegex.x.test(u)&&(u="x"),n.push(u+g),l.push(u+g),!s[u]&&(s[u]=1,p.pushUnique(o,u)));if(!l.length){for(var f in u="",g="",e)if(y.attrRegex.test(f)){var x=f.charAt(0);"x"===x?(!u||+f.substr(5)<+u.substr(5))&&(u=f):(!g||+f.substr(5)<+g.substr(5))&&(g=f)}u=u?h.name2id(u):"x",g=g?h.name2id(g):"y",o.push(u),r.push(g),n.push(u+g)}},a.plot=function(e,t,a,o){var n=e._fullLayout,l=n._subplots.cartesian,s=e.calcdata,d;if(!Array.isArray(t))for(t=[],d=0;d<s.length;d++)t.push(d);for(d=0;d<l.length;d++){for(var c=l[d],p=n._plots[c],u=[],g=0,m;g<s.length;g++){var h=s[g],y=h[0].trace;y.xaxis+y.yaxis===c&&((-1!==t.indexOf(y.index)||y.carpet)&&(m&&m[0].trace.xaxis+m[0].trace.yaxis===c&&-1!==["tonextx","tonexty","tonext"].indexOf(y.fill)&&-1===u.indexOf(m)&&u.push(m),u.push(h)),m=h)}r(e,p,u,a,o)}},a.clean=function(e,t,a,o){var r=o._plots||{},n=t._plots||{},d=o._subplots||{},c,p,u;if(o._hasOnlyLargeSploms&&!t._hasOnlyLargeSploms)for(u in r)c=r[u],c.plotgroup&&c.plotgroup.remove();var g=o._has&&o._has("gl"),m=t._has&&t._has("gl");if(g&&!m)for(u in r)c=r[u],c._scene&&c._scene.destroy();if(d.xaxis&&d.yaxis){var y=h.listIds({_fullLayout:o});for(p=0;p<y.length;p++){var f=y[p];t[h.id2name(f)]||o._infolayer.selectAll(".g-"+f+"title").remove()}}var x=o._has&&o._has("cartesian"),_=t._has&&t._has("cartesian");if(x&&!_)l(o._cartesianlayer.selectAll(".subplot"),o),o._defs.selectAll(".axesclip").remove(),delete o._axisConstraintGroups;else if(d.cartesian)for(p=0;p<d.cartesian.length;p++){var b=d.cartesian[p];if(!n[b]){o._cartesianlayer.selectAll("."+b+",."+b+"-x,."+b+"-y").remove(),s(b,o)}}},a.drawFramework=function(e){var t=e._fullLayout,a=i(e),o=t._cartesianlayer.selectAll(".subplot").data(a,String);o.enter().append("g").attr("class",function(e){return"subplot "+e[0]}),o.order(),o.exit().call(l,t),o.each(function(a){var o=a[0],r=t._plots[o];r.plotgroup=c.select(this),n(e,r),r.draglayer=x(t._draggers,"g",o)})},a.rangePlot=function(e,t,a){n(e,t),r(e,t,a),u.style(e)},a.toSVG=function(e){var t=e._fullLayout._glimages,a=c.select(e).selectAll(".svg-container"),o=a.filter(function(e,t){return t===a.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus");o.each(function(){var e=this,a=e.toDataURL("image/png"),o=t.append("svg:image");o.attr({xmlns:f.svg,"xlink:href":a,preserveAspectRatio:"none",x:0,y:0,width:e.width,height:e.height})})},a.updateFx=e("./graph_interact").updateFx},{"../../components/drawing":546,"../../constants/xmlns_namespaces":634,"../../lib":657,"../../registry":788,"../get_data":742,"../plots":768,"./attributes":703,"./axis_ids":708,"./constants":711,"./graph_interact":714,"./layout_attributes":719,"./layout_defaults":720,"./transition_axes":729,d3:108}],719:[function(e,t){'use strict';var a=e("../font_attributes"),o=e("../../components/color/attributes"),r=e("../../components/drawing/attributes").dash,i=e("../../lib/extend").extendFlat,n=e("../../plot_api/plot_template").templatedArray,l=e("../../constants/docs").FORMAT_LINK,s=e("../../constants/docs").DATE_FORMAT_LINK,d=e("../../constants/numerical").ONEDAY,c=e("./constants"),p=c.HOUR_PATTERN,u=c.WEEKDAY_PATTERN;t.exports={visible:{valType:"boolean",editType:"plot"},color:{valType:"color",dflt:o.defaultLine,editType:"ticks"},title:{text:{valType:"string",editType:"ticks"},font:a({editType:"ticks"}),standoff:{valType:"number",min:0,editType:"ticks"},editType:"ticks"},type:{valType:"enumerated",values:["-","linear","log","date","category","multicategory"],dflt:"-",editType:"calc",_noTemplating:!0},autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"axrange",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"plot"},range:{valType:"info_array",items:[{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0},{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0}],editType:"axrange",impliedEdits:{autorange:!1},anim:!0},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},scaleanchor:{valType:"enumerated",values:[c.idRegex.x.toString(),c.idRegex.y.toString()],editType:"plot"},scaleratio:{valType:"number",min:0,dflt:1,editType:"plot"},constrain:{valType:"enumerated",values:["range","domain"],dflt:"range",editType:"plot"},constraintoward:{valType:"enumerated",values:["left","center","right","top","middle","bottom"],editType:"plot"},matches:{valType:"enumerated",values:[c.idRegex.x.toString(),c.idRegex.y.toString()],editType:"calc"},rangebreaks:n("rangebreak",{enabled:{valType:"boolean",dflt:!0,editType:"calc"},bounds:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},pattern:{valType:"enumerated",values:[u,p,""],editType:"calc"},values:{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"any",editType:"calc"}},dvalue:{valType:"number",editType:"calc",min:0,dflt:d},editType:"calc"}),tickmode:{valType:"enumerated",values:["auto","linear","array"],editType:"ticks",impliedEdits:{tick0:void 0,dtick:void 0}},nticks:{valType:"integer",min:0,dflt:0,editType:"ticks"},tick0:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},dtick:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},tickvals:{valType:"data_array",editType:"ticks"},ticktext:{valType:"data_array",editType:"ticks"},ticks:{valType:"enumerated",values:["outside","inside",""],editType:"ticks"},tickson:{valType:"enumerated",values:["labels","boundaries"],dflt:"labels",editType:"ticks"},mirror:{valType:"enumerated",values:[!0,"ticks",!1,"all","allticks"],dflt:!1,editType:"ticks+layoutstyle"},ticklen:{valType:"number",min:0,dflt:5,editType:"ticks"},tickwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},tickcolor:{valType:"color",dflt:o.defaultLine,editType:"ticks"},showticklabels:{valType:"boolean",dflt:!0,editType:"ticks"},automargin:{valType:"boolean",dflt:!1,editType:"ticks"},showspikes:{valType:"boolean",dflt:!1,editType:"modebar"},spikecolor:{valType:"color",dflt:null,editType:"none"},spikethickness:{valType:"number",dflt:3,editType:"none"},spikedash:i({},r,{dflt:"dash",editType:"none"}),spikemode:{valType:"flaglist",flags:["toaxis","across","marker"],dflt:"toaxis",editType:"none"},spikesnap:{valType:"enumerated",values:["data","cursor","hovered data"],dflt:"data",editType:"none"},tickfont:a({editType:"ticks"}),tickangle:{valType:"angle",dflt:"auto",editType:"ticks"},tickprefix:{valType:"string",dflt:"",editType:"ticks"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},ticksuffix:{valType:"string",dflt:"",editType:"ticks"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"ticks"},separatethousands:{valType:"boolean",dflt:!1,editType:"ticks"},tickformat:{valType:"string",dflt:"",editType:"ticks"},tickformatstops:n("tickformatstop",{enabled:{valType:"boolean",dflt:!0,editType:"ticks"},dtickrange:{valType:"info_array",items:[{valType:"any",editType:"ticks"},{valType:"any",editType:"ticks"}],editType:"ticks"},value:{valType:"string",dflt:"",editType:"ticks"},editType:"ticks"}),hoverformat:{valType:"string",dflt:"",editType:"none"},showline:{valType:"boolean",dflt:!1,editType:"ticks+layoutstyle"},linecolor:{valType:"color",dflt:o.defaultLine,editType:"layoutstyle"},linewidth:{valType:"number",min:0,dflt:1,editType:"ticks+layoutstyle"},showgrid:{valType:"boolean",editType:"ticks"},gridcolor:{valType:"color",dflt:o.lightLine,editType:"ticks"},gridwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},zeroline:{valType:"boolean",editType:"ticks"},zerolinecolor:{valType:"color",dflt:o.defaultLine,editType:"ticks"},zerolinewidth:{valType:"number",dflt:1,editType:"ticks"},showdividers:{valType:"boolean",dflt:!0,editType:"ticks"},dividercolor:{valType:"color",dflt:o.defaultLine,editType:"ticks"},dividerwidth:{valType:"number",dflt:1,editType:"ticks"},anchor:{valType:"enumerated",values:["free",c.idRegex.x.toString(),c.idRegex.y.toString()],editType:"plot"},side:{valType:"enumerated",values:["top","bottom","left","right"],editType:"plot"},overlaying:{valType:"enumerated",values:["free",c.idRegex.x.toString(),c.idRegex.y.toString()],editType:"plot"},layer:{valType:"enumerated",values:["above traces","below traces"],dflt:"above traces",editType:"plot"},domain:{valType:"info_array",items:[{valType:"number",min:0,max:1,editType:"plot"},{valType:"number",min:0,max:1,editType:"plot"}],dflt:[0,1],editType:"plot"},position:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array","total ascending","total descending","min ascending","min descending","max ascending","max descending","sum ascending","sum descending","mean ascending","mean descending","median ascending","median descending"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{autotick:{valType:"boolean",editType:"ticks"},title:{valType:"string",editType:"ticks"},titlefont:a({editType:"ticks"})}}},{"../../components/color/attributes":523,"../../components/drawing/attributes":545,"../../constants/docs":628,"../../constants/numerical":633,"../../lib/extend":648,"../../plot_api/plot_template":695,"../font_attributes":733,"./constants":711}],720:[function(e,t){'use strict';function a(e,t,a){Array.isArray(e[t])?e[t].push(a):e[t]=[a]}var o=e("../../lib"),r=e("../../components/color"),n=e("../../components/fx/helpers").isUnifiedHover,l=e("../../components/fx/hovermode_defaults"),s=e("../../plot_api/plot_template"),d=e("../layout_attributes"),c=e("./layout_attributes"),p=e("./type_defaults"),u=e("./axis_defaults"),g=e("./constraints").handleConstraintDefaults,m=e("./position_defaults"),h=e("./axis_ids"),y=h.id2name,f=h.name2id,x=e("./constants").AX_ID_PATTERN,_=e("../../registry"),b=_.traceIs,v=_.getComponentMethod;t.exports=function(e,t,h){function _(){var e=C[re]||[];se._traceIndices=e.map(function(e){return e._expandedIndex}),se._annIndices=[],se._shapeIndices=[],se._imgIndices=[],se._subplotsWith=[],se._counterAxes=[],se._name=se._attr=re,se._id=ie}function w(e,t){return o.coerce(le,se,c,e,t)}function k(e,t){return o.coerce2(le,se,c,e,t)}function T(e){return"x"===e?Y:G}function A(t,a){for(var o="x"===t?W:X,r=[],i=0,n;i<o.length;i++)n=o[i],n===a||(e[n]||{}).overlaying||r.push(f(n));return r}function S(){var e=le.matches;x.test(e)&&-1===Q.indexOf(e)&&(ee[e]=le.type,te=Object.keys(ee))}var C={},L={},E={},I={},P={},z={},D={},O={},R={},M={},B,F;for(B=0;B<h.length;B++){var N=h[B];if(b(N,"cartesian")||b(N,"gl2d")){var V;if(N.xaxis)V=y(N.xaxis),a(C,V,N);else if(N.xaxes)for(F=0;F<N.xaxes.length;F++)a(C,y(N.xaxes[F]),N);var U;if(N.yaxis)U=y(N.yaxis),a(C,U,N);else if(N.yaxes)for(F=0;F<N.yaxes.length;F++)a(C,y(N.yaxes[F]),N);if("funnel"===N.type?"h"===N.orientation?(V&&(L[V]=!0),U&&(D[U]=!0)):U&&(E[U]=!0):"image"===N.type?(U&&(O[U]=!0),V&&(O[V]=!0)):(U&&(P[U]=!0,z[U]=!0),(!b(N,"carpet")||"carpet"===N.type&&!N._cheater)&&V&&(I[V]=!0)),"carpet"===N.type&&N._cheater&&V&&(L[V]=!0),b(N,"2dMap")&&(R[V]=!0,R[U]=!0),b(N,"oriented")){var H="h"===N.orientation?U:V;M[H]=!0}}}var q=t._subplots,G=q.xaxis,Y=q.yaxis,W=o.simpleMap(G,y),X=o.simpleMap(Y,y),Z=W.concat(X),K=r.background;G.length&&Y.length&&(K=o.coerce(e,t,d,"plot_bgcolor"));var $=r.combine(K,t.paper_bgcolor),J={x:T("x"),y:T("y")},Q=J.x.concat(J.y),ee={},te=[],ae=l(e,t,h),oe=n(ae),re,ie,ne,le,se;for(B=0;B<Z.length;B++){re=Z[B],ie=f(re),ne=re.charAt(0),o.isPlainObject(e[re])||(e[re]={}),le=e[re],se=s.newContainer(t,re,ne+"axis"),_();var de="x"===ne&&!I[re]&&L[re]||"y"===ne&&!P[re]&&E[re],ce="y"===ne&&(!z[re]&&D[re]||O[re]),pe={letter:ne,font:t.font,outerTicks:R[re],showGrid:!M[re],data:C[re]||[],bgColor:$,calendar:t.calendar,automargin:!0,visibleDflt:de,reverseDflt:ce,splomStash:((t._splomAxes||{})[ne]||{})[ie]};w("uirevision",t.uirevision),p(le,se,w,pe),u(le,se,w,pe,t);var ue=oe&&ne===ae.charAt(0),ge=k("spikecolor",oe?se.color:void 0),me=k("spikethickness",oe?1.5:void 0),he=k("spikedash",oe?"dot":void 0),ye=k("spikemode",oe?"across":void 0),fe=k("spikesnap",oe?"hovered data":void 0),xe=w("showspikes",!!ue||!!ge||!!me||!!he||!!ye||!!fe);xe||(delete se.spikecolor,delete se.spikethickness,delete se.spikedash,delete se.spikemode,delete se.spikesnap),m(le,se,w,{letter:ne,counterAxes:J[ne],overlayableAxes:A(ne,re),grid:t.grid}),w("title.standoff"),S(),se._input=le}for(B=0;B<te.length;){ie=te[B++],re=y(ie),ne=re.charAt(0),o.isPlainObject(e[re])||(e[re]={}),le=e[re],se=s.newContainer(t,re,ne+"axis"),_();var _e={letter:ne,font:t.font,outerTicks:R[re],showGrid:!M[re],data:[],bgColor:$,calendar:t.calendar,automargin:!0,visibleDflt:!1,reverseDflt:!1,splomStash:((t._splomAxes||{})[ne]||{})[ie]};w("uirevision",t.uirevision),se.type=ee[ie]||"linear",u(le,se,w,_e,t),m(le,se,w,{letter:ne,counterAxes:J[ne],overlayableAxes:A(ne,re),grid:t.grid}),w("fixedrange"),S(),se._input=le}var be=v("rangeslider","handleDefaults"),ve=v("rangeselector","handleDefaults");for(B=0;B<W.length;B++)re=W[B],le=e[re],se=t[re],be(e,t,re),"date"===se.type&&ve(le,se,t,X,se.calendar),w("fixedrange");for(B=0;B<X.length;B++){re=X[B],le=e[re],se=t[re];var we=t[y(se.anchor)],ke=v("rangeslider","isVisible")(we);w("fixedrange",ke)}var Te=t._axisConstraintGroups=[],Ae=t._axisMatchGroups=[],Se=Q.concat(te),Ce=Z.concat(o.simpleMap(te,y));for(B=0;B<Ce.length;B++){re=Ce[B],ne=re.charAt(0),le=e[re],se=t[re];var Le="y"===ne&&!le.hasOwnProperty("scaleanchor")&&O[re]?se.anchor:void 0;var Ee;Ee=!le.hasOwnProperty("constrain")&&O[re]?"domain":void 0,g(le,se,w,{allAxisIds:Se,layoutOut:t,scaleanchorDflt:Le,constrainDflt:Ee})}for(B=0;B<Ae.length;B++){var Ie=Ae[B],Pe=null,ze=null;for(ie in Ie)se=t[y(ie)],se.matches||(Pe=se.range,ze=se.autorange);if(null===Pe||null===ze)for(ie in Ie){se=t[y(ie)],Pe=se.range,ze=se.autorange;break}for(ie in Ie)se=t[y(ie)],se.matches&&(se.range=Pe.slice(),se.autorange=ze),se._matchGroup=Ie;if(Te.length)for(ie in Ie)for(F=0;F<Te.length;F++){var De=Te[F];for(var Oe in De)ie===Oe&&(o.warn("Axis "+Oe+" is set with both a *scaleanchor* and *matches* constraint; ignoring the scale constraint."),delete De[Oe],2>Object.keys(De).length&&Te.splice(F,1))}}}},{"../../components/color":524,"../../components/fx/helpers":560,"../../components/fx/hovermode_defaults":563,"../../lib":657,"../../plot_api/plot_template":695,"../../registry":788,"../layout_attributes":759,"./axis_defaults":707,"./axis_ids":708,"./constants":711,"./constraints":712,"./layout_attributes":719,"./position_defaults":722,"./type_defaults":730}],721:[function(e,t){'use strict';var a=e("tinycolor2").mix,o=e("../../components/color/attributes").lightFraction,r=e("../../lib");t.exports=function(e,t,i,n){function l(a,o){return r.coerce2(e,t,n.attributes,a,o)}n=n||{};var s=n.dfltColor,d=l("linecolor",s),c=l("linewidth"),p=i("showline",n.showLine||!!d||!!c);p||(delete t.linecolor,delete t.linewidth);var u=a(s,n.bgColor,n.blend||o).toRgbString(),g=l("gridcolor",u),m=l("gridwidth"),h=i("showgrid",n.showGrid||!!g||!!m);if(h||(delete t.gridcolor,delete t.gridwidth),!n.noZeroLine){var y=l("zerolinecolor",s),f=l("zerolinewidth"),x=i("zeroline",n.showGrid||!!y||!!f);x||(delete t.zerolinecolor,delete t.zerolinewidth)}}},{"../../components/color/attributes":523,"../../lib":657,tinycolor2:1309}],722:[function(e,t){'use strict';var a=e("fast-isnumeric"),o=e("../../lib");t.exports=function(e,t,r,i){var n=i.counterAxes||[],l=i.overlayableAxes||[],s=i.letter,d=i.grid,c,p,u,g;d&&(p=d._domains[s][d._axisMap[t._id]],c=d._anchors[t._id],p&&(u=d[s+"side"].split(" ")[0],g=d.domain[s]["right"===u||"top"===u?1:0])),p=p||[0,1],c=c||(a(e.position)?"free":n[0]||"free"),u=u||("x"===s?"bottom":"left"),g=g||0;var m=o.coerce(e,t,{anchor:{valType:"enumerated",values:["free"].concat(n),dflt:c}},"anchor");"free"===m&&r("position",g),o.coerce(e,t,{side:{valType:"enumerated",values:"x"===s?["bottom","top"]:["left","right"],dflt:u}},"side");var h=!1;if(l.length&&(h=o.coerce(e,t,{overlaying:{valType:"enumerated",values:[!1].concat(l),dflt:!1}},"overlaying")),!h){var y=r("domain",p);y[0]>y[1]-1/4096&&(t.domain=p),o.noneOrAll(e.domain,t.domain,p)}return r("layer"),t}},{"../../lib":657,"fast-isnumeric":201}],723:[function(e,t){'use strict';var a=e("../../constants/alignment").FROM_BL;t.exports=function(e,t,o){o===void 0&&(o=a[e.constraintoward||"center"]);var r=[e.r2l(e.range[0]),e.r2l(e.range[1])],i=r[0]+(r[1]-r[0])*o;e.range=e._input.range=[e.l2r(i+(r[0]-i)*t),e.l2r(i+(r[1]-i)*t)]}},{"../../constants/alignment":626}],724:[function(e,t){'use strict';var b=Math.min,v=Math.abs,w=Math.max;function a(e,t,a,r,n,f,b){var v=t._hoverdata,w=t._fullLayout,k=w.clickmode,T=-1<k.indexOf("event"),A=[],S,C,L,E,I,P,z,O,M,B;if(p(v)){s(e,t,f),S=c(t,a,r,n);var F=u(v,S),N=0<F.pointNumbers.length;if(N?m(S,F):h(S)&&(z=g(F))){for(b&&b.remove(),B=0;B<S.length;B++)C=S[B],C._module.selectPoints(C,!1);y(t,S),d(f),T&&t.emit("plotly_deselect",null)}else{O=e.shiftKey&&(void 0===z?g(F):z),L=o(F.pointNumber,F.searchInfo,O);var V=f.selectionDefs.concat([L]);for(E=l(V),B=0;B<S.length;B++)if(I=S[B]._module.selectPoints(S[B],E),P=x(I,S[B]),A.length)for(var U=0;U<P.length;U++)A.push(P[U]);else A=P;if(M={points:A},y(t,S,M),L&&f&&f.selectionDefs.push(L),b){var H=f.mergedPolygons,q=D(f.dragmode);R(_(H,q),b,f)}T&&t.emit("plotly_selected",M)}}}function o(e,t,a){return{pointNumber:e,searchInfo:t,subtract:a}}function r(e){return"pointNumber"in e&&"searchInfo"in e}function n(e){return{xmin:0,xmax:0,ymin:0,ymax:0,pts:[],contains:function(t,a,o,r){var i=e.searchInfo.cd[0].trace._expandedIndex,n=r.cd[0].trace._expandedIndex;return n===i&&o===e.pointNumber},isRect:!1,degenerate:!1,subtract:e.subtract}}function l(e){function t(e,t,o,r){for(var n=!1,l=0;l<a.length;l++)a[l].contains(e,t,o,r)&&(n=!1===a[l].subtract);return n}for(var a=[],o=r(e[0])?0:e[0][0][0],l=o,s=r(e[0])?0:e[0][0][1],d=s,c=0;c<e.length;c++)if(r(e[c]))a.push(n(e[c]));else{var p=F.tester(e[c]);p.subtract=e[c].subtract,a.push(p),o=b(o,p.xmin),l=w(l,p.xmax),s=b(s,p.ymin),d=w(d,p.ymax)}return{xmin:o,xmax:l,ymin:s,ymax:d,pts:[],contains:t,isRect:!1,degenerate:!1}}function s(e,t,a){t._fullLayout._drawing=!1;var o=t._fullLayout,r=a.plotinfo,i=a.dragmode,n=o._lastSelectedSubplot&&o._lastSelectedSubplot===r.id,l=(e.shiftKey||e.altKey)&&!(z(i)&&D(i));n&&l&&r.selection&&r.selection.selectionDefs&&!a.selectionDefs?(a.selectionDefs=r.selection.selectionDefs,a.mergedPolygons=r.selection.mergedPolygons):(!l||!r.selection)&&d(a),n||(Z(t),o._lastSelectedSubplot=r.id)}function d(e){var t=e.dragmode,a=e.plotinfo,o=e.gd;if(0<=o._fullLayout._activeShapeIndex&&o._fullLayout._deactivateShape(o),z(t)){var r=o._fullLayout,i=r._zoomlayer,n=i.selectAll(".select-outline-"+a.id);if(n&&o._fullLayout._drawing){var l=j(n,e);l&&T.call("_guiRelayout",o,{shapes:l}),o._fullLayout._drawing=!1}}a.selection={},a.selection.selectionDefs=e.selectionDefs=[],a.selection.mergedPolygons=e.mergedPolygons=[]}function c(e,t,a,o){function r(e,t,a,o){return{_module:e,cd:t,xaxis:a,yaxis:o}}var n=[],l=t.map(function(e){return e._id}),s=a.map(function(e){return e._id}),d,c,p;for(p=0;p<e.calcdata.length;p++)if(d=e.calcdata[p],c=d[0].trace,!0===c.visible&&c._module&&c._module.selectPoints)if(o&&(c.subplot===o||c.geo===o))n.push(r(c._module,d,t[0],a[0]));else if("splom"===c.type&&c._xaxes[l[0]]&&c._yaxes[s[0]]){var u=r(c._module,d,t[0],a[0]);u.scene=e._fullLayout._splomScenes[c.uid],n.push(u)}else if("sankey"===c.type){var g=r(c._module,d,t[0],a[0]);n.push(g)}else{if(-1===l.indexOf(c.xaxis))continue;if(-1===s.indexOf(c.yaxis))continue;n.push(r(c._module,d,V(e,c.xaxis),V(e,c.yaxis)))}return n}function p(e){return e&&Array.isArray(e)&&!0!==e[0].hoverOnBox}function u(e,t){var a=e[0],o=-1,r=[],n,l;for(l=0;l<t.length;l++)if(n=t[l],a.fullData._expandedIndex===n.cd[0].trace._expandedIndex){if(!0===a.hoverOnBox)break;void 0===a.pointNumber?void 0!==a.binNumber&&(o=a.binNumber,r=a.pointNumbers):o=a.pointNumber;break}return{pointNumber:o,pointNumbers:r,searchInfo:n}}function g(e){var t=e.searchInfo.cd[0].trace,a=e.pointNumber,o=e.pointNumbers,r=0<o.length,i=r?o[0]:a;return!!t.selectedpoints&&-1<t.selectedpoints.indexOf(i)}function m(e,t){var a=[],o,r,n,l;for(l=0;l<e.length;l++)o=e[l],o.cd[0].trace.selectedpoints&&0<o.cd[0].trace.selectedpoints.length&&a.push(o);if(1===a.length&&(n=a[0]===t.searchInfo,n&&(r=t.searchInfo.cd[0].trace,r.selectedpoints.length===t.pointNumbers.length))){for(l=0;l<t.pointNumbers.length;l++)if(0>r.selectedpoints.indexOf(t.pointNumbers[l]))return!1;return!0}return!1}function h(e){var t=0,a,o,r;for(r=0;r<e.length;r++)if(a=e[r],o=a.cd[0].trace,o.selectedpoints){if(1<o.selectedpoints.length)return!1;if(t+=o.selectedpoints.length,1<t)return!1}return 1===t}function y(e,t,a){var o,r,n,l;for(o=0;o<t.length;o++){var s=t[o].cd[0].trace._fullInput,d=e._fullLayout._tracePreGUI[s.uid]||{};d.selectedpoints===void 0&&(d.selectedpoints=s._input.selectedpoints||null)}if(a){var c=a.points||[];for(o=0;o<t.length;o++)l=t[o].cd[0].trace,l._input.selectedpoints=l._fullInput.selectedpoints=[],l._fullInput!==l&&(l.selectedpoints=[]);for(o=0;o<c.length;o++){var p=c[o],u=p.data,g=p.fullData;p.pointIndices?([].push.apply(u.selectedpoints,p.pointIndices),l._fullInput!==l&&[].push.apply(g.selectedpoints,p.pointIndices)):(u.selectedpoints.push(p.pointIndex),l._fullInput!==l&&g.selectedpoints.push(p.pointIndex))}}else for(o=0;o<t.length;o++)l=t[o].cd[0].trace,delete l.selectedpoints,delete l._input.selectedpoints,l._fullInput!==l&&delete l._fullInput.selectedpoints;var m=!1;for(o=0;o<t.length;o++){r=t[o],n=r.cd,l=n[0].trace,T.traceIs(l,"regl")&&(m=!0);var h=r._module,y=h.styleOnSelect||h.style;y&&(y(e,n,n[0].node3),n[0].nodeRangePlot3&&y(e,n,n[0].nodeRangePlot3))}m&&(U(e),H(e))}function f(e,t,a){var o;return a?(o=k.difference({regions:e,inverted:!1},{regions:[t],inverted:!1}),o.regions):(o=k.union({regions:e,inverted:!1},{regions:[t],inverted:!1}),o.regions)}function x(e,t){if(Array.isArray(e))for(var a=t.cd,o=t.cd[0].trace,r=0;r<e.length;r++)e[r]=L(e[r],o,a);return e}function _(e,t){for(var a=[],o=0;o<e.length;o++){a[o]=[];for(var r=0;r<e[o].length;r++){a[o][r]=[],a[o][r][0]=r?"L":"M";for(var n=0;n<e[o][r].length;n++)a[o][r].push(e[o][r][n])}t||a[o].push(["Z",a[o][0][1],a[o][0][2]])}return a}var k=e("polybooljs"),T=e("../../registry"),A=e("../../components/drawing").dashStyle,S=e("../../components/color"),C=e("../../components/fx"),L=e("../../components/fx/helpers").makeEventData,E=e("../../components/dragelement/helpers"),I=E.freeMode,P=E.rectMode,z=E.drawMode,D=E.openMode,O=E.selectMode,R=e("../../components/shapes/draw_newshape/display_outlines"),M=e("../../components/shapes/draw_newshape/helpers").handleEllipse,j=e("../../components/shapes/draw_newshape/newshapes"),B=e("../../lib"),F=e("../../lib/polygon"),N=e("../../lib/throttle"),V=e("./axis_ids").getFromId,U=e("../../lib/clear_gl_canvases"),H=e("../../plot_api/subroutines").redrawReglTraces,G=e("./constants"),Y=G.MINSELECT,W=F.filter,X=F.tester,Z=e("./handle_outline").clearSelect,K=e("./helpers"),$=K.p2r,J=K.axValue,Q=K.getTransform;t.exports={prepSelect:function(t,e,o,r,n){function p(e,t){return e-t}var u=I(n),g=P(n),m=D(n),h=z(n),k=O(n),T="drawcircle"===n,L="drawline"===n||T,E=r.gd,j=E._fullLayout,F=j._zoomlayer,V=r.element.getBoundingClientRect(),U=r.plotinfo,H=Q(U),Z=e-V.left,K=o-V.top,ee=Z,te=K,ae=r.xaxes[0]._length,oe=r.yaxes[0]._length,q=r.xaxes.concat(r.yaxes),re=t.altKey&&!(z(n)&&m),ie,ne,le,se,de,ce,pe;s(t,E,r),u&&(ie=W([[Z,K]],G.BENDPX));var ue=F.selectAll("path.select-outline-"+U.id).data(h?[0]:[1,2]),ge=j.newshape;ue.enter().append("path").attr("class",function(e){return"select-outline select-outline-"+e+" select-outline-"+U.id}).style(h?{opacity:ge.opacity/2,fill:m?void 0:ge.fillcolor,stroke:ge.line.color,"stroke-dasharray":A(ge.line.dash,ge.line.width),"stroke-width":ge.line.width+"px"}:{}).attr("fill-rule",ge.fillrule).classed("cursor-move",!!h).attr("transform",H).attr("d","M"+Z+","+K+"Z");var me=F.append("path").attr("class","zoombox-corners").style({fill:S.background,stroke:S.defaultLine,"stroke-width":1}).attr("transform",H).attr("d","M0,0Z"),he=j._uid+G.SELECTID,ye=[],fe=c(E,r.xaxes,r.yaxes,r.subplot),xe;xe=U.fillRangeItems?U.fillRangeItems:g?function(e,t){var a=e.range={};for(de=0;de<q.length;de++){var o=q[de],r=o._id.charAt(0);a[o._id]=[$(o,t[r+"min"]),$(o,t[r+"max"])].sort(p)}}:function(e,t,a){var o=e.lassoPoints={};for(de=0;de<q.length;de++){var r=q[de];o[r._id]=a.filtered.map(J(r))}},r.moveFn=function(e,t){ee=w(0,b(ae,e+Z)),te=w(0,b(oe,t+K));var a=v(ee-Z),o=v(te-K);if(g){var i,n,s;if(k){var d=j.selectdirection;i="any"===d?o<b(.6*a,Y)?"h":a<b(.6*o,Y)?"v":"d":d;"h"===i?(n=T?oe/2:0,s=oe):"v"===i?(n=T?ae/2:0,s=ae):void 0}if(h)switch(j.newshape.drawdirection){case"vertical":i="h",n=T?oe/2:0,s=oe;break;case"horizontal":i="v",n=T?ae/2:0,s=ae;break;case"ortho":a<o?(i="h",n=K,s=te):(i="v",n=Z,s=ee);break;default:i="d";}"h"===i?(se=L?M(T,[ee,n],[ee,s]):[[Z,n],[Z,s],[ee,s],[ee,n]],se.xmin=L?ee:b(Z,ee),se.xmax=L?ee:w(Z,ee),se.ymin=b(n,s),se.ymax=w(n,s),me.attr("d","M"+se.xmin+","+(K-Y)+"h-4v"+2*Y+"h4ZM"+(se.xmax-1)+","+(K-Y)+"h4v"+2*Y+"h-4Z")):"v"===i?(se=L?M(T,[n,te],[s,te]):[[n,K],[n,te],[s,te],[s,K]],se.xmin=b(n,s),se.xmax=w(n,s),se.ymin=L?te:b(K,te),se.ymax=L?te:w(K,te),me.attr("d","M"+(Z-Y)+","+se.ymin+"v-4h"+2*Y+"v4ZM"+(Z-Y)+","+(se.ymax-1)+"v4h"+2*Y+"v-4Z")):"d"===i&&(se=L?M(T,[Z,K],[ee,te]):[[Z,K],[Z,te],[ee,te],[ee,K]],se.xmin=b(Z,ee),se.xmax=w(Z,ee),se.ymin=b(K,te),se.ymax=w(K,te),me.attr("d","M0,0Z"))}else u&&(ie.addPt([ee,te]),se=ie.filtered);r.selectionDefs&&r.selectionDefs.length?(le=f(r.mergedPolygons,se,re),se.subtract=re,ne=l(r.selectionDefs.concat([se]))):(le=[se],ne=X(se)),R(_(le,m),ue,r),k&&N.throttle(he,G.SELECTDELAY,function(){ye=[];var e=[],t,a;for(de=0;de<fe.length;de++)if(ce=fe[de],a=ce._module.selectPoints(ce,ne),e.push(a),t=x(a,ce),ye.length)for(var o=0;o<t.length;o++)ye.push(t[o]);else ye=t;pe={points:ye},y(E,fe,pe),xe(pe,se,ie),r.gd.emit("plotly_selecting",pe)})},r.clickFn=function(e,t){if(me.remove(),0<=E._fullLayout._activeShapeIndex)return void E._fullLayout._deactivateShape(E);if(!h){var o=j.clickmode;N.done(he).then(function(){if(N.clear(he),2===e){for(ue.remove(),de=0;de<fe.length;de++)ce=fe[de],ce._module.selectPoints(ce,!1);y(E,fe),d(r),E.emit("plotly_deselect",null)}else-1<o.indexOf("select")&&a(t,E,r.xaxes,r.yaxes,r.subplot,r,ue),"event"===o&&E.emit("plotly_selected",void 0);C.click(E,t)}).catch(B.error)}},r.doneFn=function(){me.remove(),N.done(he).then(function(){N.clear(he),r.gd.emit("plotly_selected",pe),se&&r.selectionDefs&&(se.subtract=re,r.selectionDefs.push(se),r.mergedPolygons.length=0,[].push.apply(r.mergedPolygons,le)),r.doneFnCompleted&&r.doneFnCompleted(ye)}).catch(B.error),h&&d(r)}},clearSelect:Z,clearSelectionsCache:d,selectOnClick:a}},{"../../components/color":524,"../../components/dragelement/helpers":542,"../../components/drawing":546,"../../components/fx":564,"../../components/fx/helpers":560,"../../components/shapes/draw_newshape/display_outlines":609,"../../components/shapes/draw_newshape/helpers":610,"../../components/shapes/draw_newshape/newshapes":611,"../../lib":657,"../../lib/clear_gl_canvases":642,"../../lib/polygon":669,"../../lib/throttle":682,"../../plot_api/subroutines":696,"../../registry":788,"./axis_ids":708,"./constants":711,"./handle_outline":715,"./helpers":716,polybooljs:1249}],725:[function(e,t){'use strict';var r=Math.round,n=Math.min,l=Math.abs,s=Math.max,d=Math.floor;function a(e){return Math.pow(10,e)}function o(e){return null!==e&&e!==void 0}var c=e("d3"),p=e("fast-isnumeric"),u=e("../../lib"),g=u.cleanNumber,m=u.ms2DateTime,h=u.dateTime2ms,y=u.ensureNumber,f=u.isArrayOrTypedArray,x=e("../../constants/numerical"),_=x.FP_SAFE,b=x.BADNUM,v=x.LOG_CLIP,w=x.ONEDAY,k=x.ONEHOUR,T=x.ONEMIN,A=x.ONESEC,S=e("./axis_ids"),C=e("./constants"),L=C.HOUR_PATTERN,E=C.WEEKDAY_PATTERN;t.exports=function(e,t){function i(t,a){if(0<t)return Math.log(t)/Math.LN10;if(0>=t&&a&&e.range&&2===e.range.length){var o=e.range[0],r=e.range[1];return .5*(o+r-2*v*l(o-r))}return b}function x(t,a,o){var i=h(t,o||e.calendar);if(i===b)if(p(t)){t=+t;var n=d(10*u.mod(t+.05,1)),l=r(t-n/10);i=h(new Date(l))+n/10}else return b;return i}function I(t,a,o){return m(t,a,o||e.calendar)}function P(t){return e._categories[r(t)]}function z(t){if(o(t)){if(void 0===e._categoriesMap&&(e._categoriesMap={}),void 0!==e._categoriesMap[t])return e._categoriesMap[t];e._categories.push("number"==typeof t?t+"":t);var a=e._categories.length-1;return e._categoriesMap[t]=a,a}return b}function D(e,t){for(var a=Array(t),o=0;o<t;o++){var r=(e[0]||[])[o],n=(e[1]||[])[o];a[o]=O([r,n])}return a}function O(t){if(e._categoriesMap)return e._categoriesMap[t]}function R(e){var t=O(e);return void 0===t?p(e)?+e:void 0:t}function M(e,t,a){return c.round(a+t*e,2)}function j(e,t,a){return(e-a)/t}t=t||{};var B=e._id||"x",F=B.charAt(0),N=function(t){return p(t)?M(t,e._m,e._b):b},V=function(t){return j(t,e._m,e._b)};if(e.rangebreaks){N=function(t){if(!p(t))return b;var a=e._rangebreaks.length;if(!a)return M(t,e._m,e._b);var o="y"===F;e.range[0]>e.range[1]&&(o=!o);for(var r=o?-1:1,n=r*t,l=0,s=0;s<a;s++){var d=r*e._rangebreaks[s].min,c=r*e._rangebreaks[s].max;if(n<d)break;if(n>c)l=s+1;else{l=n<(d+c)/2?s:s+1;break}}var u=e._B[l]||0;return isFinite(u)?M(t,e._m2,u):0},V=function(t){var a=e._rangebreaks.length;if(!a)return j(t,e._m,e._b);for(var o=0,r=0;r<a&&!(t<e._rangebreaks[r].pmin);r++)t>e._rangebreaks[r].pmax&&(o=r+1);return j(t,e._m2,e._B[o])}}e.c2l="log"===e.type?i:y,e.l2c="log"===e.type?a:y,e.l2p=N,e.p2l=V,e.c2p="log"===e.type?function(e,t){return N(i(e,t))}:N,e.p2c="log"===e.type?function(e){return a(V(e))}:V,-1===["linear","-"].indexOf(e.type)?"log"===e.type?(e.d2r=e.d2l=function(e,t){return i(g(e),t)},e.r2d=e.r2c=function(e){return a(g(e))},e.d2c=e.r2l=g,e.c2d=e.l2r=y,e.c2r=i,e.l2d=a,e.d2p=function(t,a){return e.l2p(e.d2r(t,a))},e.p2d=function(e){return a(V(e))},e.r2p=function(t){return e.l2p(g(t))},e.p2r=V,e.cleanPos=y):"date"===e.type?(e.d2r=e.r2d=u.identity,e.d2c=e.r2c=e.d2l=e.r2l=x,e.c2d=e.c2r=e.l2d=e.l2r=I,e.d2p=e.r2p=function(t,a,o){return e.l2p(x(t,0,o))},e.p2d=e.p2r=function(e,t,a){return I(V(e),t,a)},e.cleanPos=function(t){return u.cleanDate(t,b,e.calendar)}):"category"===e.type?(e.d2c=e.d2l=z,e.r2d=e.c2d=e.l2d=P,e.d2r=e.d2l_noadd=R,e.r2c=function(t){var a=R(t);return a===void 0?e.fraction2r(.5):a},e.l2r=e.c2r=y,e.r2l=R,e.d2p=function(t){return e.l2p(e.r2c(t))},e.p2d=function(e){return P(V(e))},e.r2p=e.d2p,e.p2r=V,e.cleanPos=function(e){return"string"==typeof e&&""!==e?e:y(e)}):"multicategory"===e.type&&(e.r2d=e.c2d=e.l2d=P,e.d2r=e.d2l_noadd=R,e.r2c=function(t){var a=R(t);return a===void 0?e.fraction2r(.5):a},e.r2c_just_indices=O,e.l2r=e.c2r=y,e.r2l=R,e.d2p=function(t){return e.l2p(e.r2c(t))},e.p2d=function(e){return P(V(e))},e.r2p=e.d2p,e.p2r=V,e.cleanPos=function(e){return Array.isArray(e)||"string"==typeof e&&""!==e?e:y(e)},e.setupMultiCategory=function(a){var r=e._traceIndices,n=t._axisMatchGroups,l,s;if(n&&n.length&&0===e._categories.length)for(l=0;l<n.length;l++){var d=n[l];if(d[B])for(var c in d)if(c!==B){var p=t[S.id2name(c)];r=r.concat(p._traceIndices)}}var g=[[0,{}],[0,{}]],m=[];for(l=0;l<r.length;l++){var h=a[r[l]];if(F in h){var y=h[F],x=h._length||u.minRowLength(y);if(f(y[0])&&f(y[1]))for(s=0;s<x;s++){var _=y[0][s],b=y[1][s];o(_)&&o(b)&&(m.push([_,b]),!(_ in g[0][1])&&(g[0][1][_]=g[0][0]++),!(b in g[1][1])&&(g[1][1][b]=g[1][0]++))}}}for(m.sort(function(e,t){var a=g[0][1],o=a[e[0]]-a[t[0]];if(o)return o;var r=g[1][1];return r[e[1]]-r[t[1]]}),l=0;l<m.length;l++)z(m[l])}):(e.d2r=e.r2d=e.d2c=e.r2c=e.d2l=e.r2l=g,e.c2d=e.c2r=e.l2d=e.l2r=y,e.d2p=e.r2p=function(t){return e.l2p(g(t))},e.p2d=e.p2r=V,e.cleanPos=y),e.fraction2r=function(t){var a=e.r2l(e.range[0]),o=e.r2l(e.range[1]);return e.l2r(a+t*(o-a))},e.r2fraction=function(t){var a=e.r2l(e.range[0]),o=e.r2l(e.range[1]);return(e.r2l(t)-a)/(o-a)},e.cleanRange=function(t,a){a||(a={}),t||(t="range");var o=u.nestedProperty(e,t).get(),r,n;if(n="date"===e.type?u.dfltRange(e.calendar):"y"===F?C.DFLTRANGEY:a.dfltRange||C.DFLTRANGEX,n=n.slice(),("tozero"===e.rangemode||"nonnegative"===e.rangemode)&&(n[0]=0),!o||2!==o.length)return void u.nestedProperty(e,t).set(n);for("date"!==e.type||e.autorange||(o[0]=u.cleanDate(o[0],b,e.calendar),o[1]=u.cleanDate(o[1],b,e.calendar)),r=0;2>r;r++)if("date"===e.type){if(!u.isDateTime(o[r],e.calendar)){e[t]=n;break}if(e.r2l(o[0])===e.r2l(o[1])){var d=u.constrain(e.r2l(o[0]),u.MIN_MS+1e3,u.MAX_MS-1e3);o[0]=e.l2r(d-1e3),o[1]=e.l2r(d+1e3);break}}else{if(!p(o[r]))if(p(o[1-r]))o[r]=o[1-r]*(r?10:.1);else{e[t]=n;break}if(o[r]<-_?o[r]=-_:o[r]>_&&(o[r]=_),o[0]===o[1]){var c=s(1,l(1e-6*o[0]));o[0]-=c,o[1]+=c}}},e.setScale=function(a){var o=t._size;if(e.overlaying){var r=S.getFromId({_fullLayout:t},e.overlaying);e.domain=r.domain}var d=a&&e._r?"_r":"range",c=e.calendar;e.cleanRange(d);var p=e.r2l(e[d][0],c),u=e.r2l(e[d][1],c),g="y"===F;if(g?(e._offset=o.t+(1-e.domain[1])*o.h,e._length=o.h*(e.domain[1]-e.domain[0]),e._m=e._length/(p-u),e._b=-e._m*u):(e._offset=o.l+e.domain[0]*o.w,e._length=o.w*(e.domain[1]-e.domain[0]),e._m=e._length/(u-p),e._b=-e._m*p),e._rangebreaks=[],e._lBreaks=0,e._m2=0,e._B=[],e.rangebreaks){var m,h;if(e._rangebreaks=e.locateBreaks(n(p,u),s(p,u)),e._rangebreaks.length){for(m=0;m<e._rangebreaks.length;m++)h=e._rangebreaks[m],e._lBreaks+=l(h.max-h.min);var y=g;p>u&&(y=!y),y&&e._rangebreaks.reverse();var f=y?-1:1;for(e._m2=f*e._length/(l(u-p)-e._lBreaks),e._B.push(-e._m2*(g?u:p)),m=0;m<e._rangebreaks.length;m++)h=e._rangebreaks[m],e._B.push(e._B[e._B.length-1]-f*e._m2*(h.max-h.min));for(m=0;m<e._rangebreaks.length;m++)h=e._rangebreaks[m],h.pmin=N(h.min),h.pmax=N(h.max)}}if(!isFinite(e._m)||!isFinite(e._b)||0>e._length)throw t._replotting=!1,new Error("Something went wrong with axis scaling")},e.maskBreaks=function(t){for(var a=e.rangebreaks||[],o=0,r,n,l,s,d,c;o<a.length;o++)if(c=a[o],c.enabled)if(c.bounds){var p=c.pattern;switch(r=u.simpleMap(c.bounds,p?g:e.d2c),n=r[0],l=r[1],p){case E:d=new Date(t),s=d.getUTCDay(),n>l&&(l+=7,s<n&&(s+=7));break;case L:d=new Date(t);var m=d.getUTCHours(),h=d.getUTCMinutes(),y=d.getUTCSeconds(),f=d.getUTCMilliseconds();s=m+(h/60+y/3600+f/36e5),n>l&&(l+=24,s<n&&(s+=24));break;case"":s=t;}if(s>=n&&s<l)return b}else for(var x=u.simpleMap(c.values,e.d2c).sort(u.sorterAsc),_=0;_<x.length;_++)if(n=x[_],l=n+c.dvalue,t>=n&&t<l)return b;return t},e.locateBreaks=function(a,o){var r=[],l,c,p,m;if(!e.rangebreaks)return r;var h=e.rangebreaks.slice().sort(function(e,t){return e.pattern===E&&t.pattern===L?-1:t.pattern===E&&e.pattern===L?1:0}),y=function(e,t){if(e=u.constrain(e,a,o),t=u.constrain(t,a,o),e!==t){for(var i=!0,n=0,l;n<r.length;n++)l=r[n],e>l.max||t<l.min||(e<l.min&&(l.min=e),t>l.max&&(l.max=t),i=!1);i&&r.push({min:e,max:t})}};for(l=0;l<h.length;l++){var f=h[l];if(f.enabled)if(f.bounds){var x=a,_=o;f.pattern&&(x=d(x)),c=u.simpleMap(f.bounds,f.pattern?g:e.r2l),p=c[0],m=c[1];var b=new Date(x),v,S;switch(f.pattern){case E:S=7*w,v=((m<p?7:0)+(m-p))*w,x+=p*w-(b.getUTCDay()*w+b.getUTCHours()*k+b.getUTCMinutes()*T+b.getUTCSeconds()*A+b.getUTCMilliseconds());break;case L:S=w,v=((m<p?24:0)+(m-p))*k,x+=p*k-(b.getUTCHours()*k+b.getUTCMinutes()*T+b.getUTCSeconds()*A+b.getUTCMilliseconds());break;default:x=n(c[0],c[1]),_=s(c[0],c[1]),S=_-x,v=S;}for(var C=x;C<_;C+=S)y(C,C+v)}else for(var I=u.simpleMap(f.values,e.d2c),P=0;P<I.length;P++)p=I[P],m=p+f.dvalue,y(p,m)}return r.sort(function(e,t){return e.min-t.min}),r},e.makeCalcdata=function(t,a){var o=e.type,r="date"===o&&t[a+"calendar"],n,l,s,d;if(a in t){if(n=t[a],d=t._length||u.minRowLength(n),u.isTypedArray(n)&&("linear"===o||"log"===o)){if(d===n.length)return n;if(n.subarray)return n.subarray(0,d)}if("multicategory"===o)return D(n,d);for(l=Array(d),s=0;s<d;s++)l[s]=e.d2c(n[s],0,r)}else{var c=a+"0"in t?e.d2c(t[a+"0"],0,r):0,p=t["d"+a]?+t["d"+a]:1;for(n=t[{x:"y",y:"x"}[a]],d=t._length||n.length,l=Array(d),s=0;s<d;s++)l[s]=c+s*p}if(e.rangebreaks)for(s=0;s<d;s++)l[s]=e.maskBreaks(l[s]);return l},e.isValidRange=function(t){return Array.isArray(t)&&2===t.length&&p(e.r2l(t[0]))&&p(e.r2l(t[1]))},e.isPtWithinRange=function(t,a){var o=e.c2l(t[F],null,a),r=e.r2l(e.range[0]),i=e.r2l(e.range[1]);return r<i?r<=o&&o<=i:i<=o&&o<=r},e.clearCalc=function(){var a=function(){e._categories=[],e._categoriesMap={}},o=t._axisMatchGroups;if(o&&o.length){for(var r=!1,n=0,l;n<o.length;n++)if(l=o[n],l[B]){r=!0;var s=null,d=null;for(var c in l){var p=t[S.id2name(c)];if(p._categories){s=p._categories,d=p._categoriesMap;break}}s&&d?(e._categories=s,e._categoriesMap=d):a();break}r||a()}else a();if(e._initialCategories)for(var u=0;u<e._initialCategories.length;u++)z(e._initialCategories[u])},e.sortByInitialCategories=function(){var a=[];if(function(){e._categories=[],e._categoriesMap={}}(),e._initialCategories)for(var o=0;o<e._initialCategories.length;o++)z(e._initialCategories[o]);a=a.concat(e._traceIndices);var r=e._matchGroup;for(var i in r)if(B!==i){var n=t[S.id2name(i)];n._categories=e._categories,n._categoriesMap=e._categoriesMap,a=a.concat(n._traceIndices)}return a};var U=t._d3locale;"date"===e.type&&(e._dateFormat=U?U.timeFormat.utc:c.time.format.utc,e._extraFormat=t._extraFormat),e._separators=t.separators,e._numFormat=U?U.numberFormat:c.format,delete e._minDtick,delete e._forceTick0}},{"../../constants/numerical":633,"../../lib":657,"./axis_ids":708,"./constants":711,d3:108,"fast-isnumeric":201}],726:[function(e,t){'use strict';function a(e,t,a,o,i){var n=r(e),l=a("tickprefix");l&&a("showtickprefix",n);var s=a("ticksuffix",i.tickSuffixDflt);s&&a("showticksuffix",n)}function o(e,t,a,o,d){var c=r(e),p=a("tickprefix");p&&a("showtickprefix",c);var u=a("ticksuffix",d.tickSuffixDflt);u&&a("showticksuffix",c);var g=a("showticklabels");if(g){var m=d.font||{},h=t.color,y=h&&h!==l.color.dflt?h:m.color;if(n.coerceFont(a,"tickfont",{family:m.family,size:m.size,color:y}),a("tickangle"),"category"!==o){var f=a("tickformat");s(e,t,{name:"tickformatstops",inclusionAttr:"enabled",handleItemDefaults:i}),t.tickformatstops.length||delete t.tickformatstops,f||"date"===o||(a("showexponent",c),a("exponentformat"),a("separatethousands"))}}}function r(e){var t=["showexponent","showtickprefix","showticksuffix"].filter(function(t){return e[t]!==void 0});if(t.every(function(o){return e[o]===e[t[0]]})||1===t.length)return e[t[0]]}function i(e,t){function a(a,o){return n.coerce(e,t,l.tickformatstops,a,o)}var o=a("enabled");o&&(a("dtickrange"),a("value"))}var n=e("../../lib"),l=e("./layout_attributes"),s=e("../array_container_defaults");t.exports=function(e,t,r,i,n,l){l&&1!==l.pass||a(e,t,r,i,n),l&&2!==l.pass||o(e,t,r,i,n)}},{"../../lib":657,"../array_container_defaults":701,"./layout_attributes":719}],727:[function(e,t){'use strict';var a=e("../../lib"),o=e("./layout_attributes");t.exports=function(e,t,r,i){var n=a.coerce2(e,t,o,"ticklen"),l=a.coerce2(e,t,o,"tickwidth"),s=a.coerce2(e,t,o,"tickcolor",t.color),d=r("ticks",i.outerTicks||n||l||s?"outside":"");d||(delete t.ticklen,delete t.tickwidth,delete t.tickcolor)}},{"../../lib":657,"./layout_attributes":719}],728:[function(e,t){'use strict';var a=e("./clean_ticks");t.exports=function(e,t,o,r){function i(a){var o=e[a];return o===void 0?(t._template||{})[a]:o}var n=i("tick0"),l=i("dtick"),s=i("tickvals"),d=i("tickmode"),c;if("array"===d&&("log"===r||"date"===r))c=t.tickmode="auto";else{var p=Array.isArray(s)?"array":l?"linear":"auto";c=o("tickmode",p)}if("auto"===c)o("nticks");else if("linear"===c){var u=t.dtick=a.dtick(l,r);t.tick0=a.tick0(n,r,t.calendar,u)}else if("multicategory"!==r){var g=o("tickvals");void 0===g?t.tickmode="auto":o("ticktext")}}},{"./clean_ticks":710}],729:[function(e,t){'use strict';var a=Math.min,o=e("d3"),r=e("../../registry"),i=e("../../lib"),n=e("../../components/drawing"),l=e("./axes");t.exports=function(e,t,s,d){function c(e){var t=e.xaxis,a=e.yaxis;h._defs.select("#"+e.clipId+"> rect").call(n.setTranslate,0,0).call(n.setScale,1,1),e.plot.call(n.setTranslate,t._offset,a._offset).call(n.setScale,1,1);var o=e.plot.selectAll(".scatterlayer .trace");o.selectAll(".point").call(n.setPointGroupScale,1,1),o.selectAll(".textpoint").call(n.setTextPointsScale,1,1),o.call(n.hideOutsideRangePoints,e)}function p(t,a){var o=t.plotinfo,r=o.xaxis,s=o.yaxis,d=r._length,c=s._length,p=!!t.xr1,u=!!t.yr1,g=[];if(p){var m=i.simpleMap(t.xr0,r.r2l),h=i.simpleMap(t.xr1,r.r2l),y=m[1]-m[0],f=h[1]-h[0];g[0]=(m[0]*(1-a)+a*h[0]-m[0])/(m[1]-m[0])*d,g[2]=d*(1-a+a*f/y),r.range[0]=r.l2r(m[0]*(1-a)+a*h[0]),r.range[1]=r.l2r(m[1]*(1-a)+a*h[1])}else g[0]=0,g[2]=d;if(u){var x=i.simpleMap(t.yr0,s.r2l),_=i.simpleMap(t.yr1,s.r2l),b=x[1]-x[0],v=_[1]-_[0];g[1]=(x[1]*(1-a)+a*_[1]-x[1])/(x[0]-x[1])*c,g[3]=c*(1-a+a*v/b),s.range[0]=r.l2r(x[0]*(1-a)+a*_[0]),s.range[1]=s.l2r(x[1]*(1-a)+a*_[1])}else g[1]=0,g[3]=c;l.drawOne(e,r,{skipTitle:!0}),l.drawOne(e,s,{skipTitle:!0}),l.redrawComponents(e,[r._id,s._id]);var w=p?d/g[2]:1,k=u?c/g[3]:1,T=p?g[0]:0,A=u?g[1]:0,S=p?g[0]/g[2]*d:0,C=u?g[1]/g[3]*c:0,L=r._offset-S,E=s._offset-C;o.clipRect.call(n.setTranslate,T,A).call(n.setScale,1/w,1/k),o.plot.call(n.setTranslate,L,E).call(n.setScale,w,k),n.setPointGroupScale(o.zoomScalePts,1/w,1/k),n.setTextPointsScale(o.zoomScaleTxt,1/w,1/k)}function u(){for(var a={},o=0;o<t.length;o++){var n=t[o],l=n.plotinfo.xaxis,s=n.plotinfo.yaxis;n.xr1&&(a[l._name+".range"]=n.xr1.slice()),n.yr1&&(a[s._name+".range"]=n.yr1.slice())}return y&&y(),r.call("relayout",e,a).then(function(){for(var e=0;e<t.length;e++)c(t[e].plotinfo)})}function g(){for(var a={},o=0;o<t.length;o++){var n=t[o],l=n.plotinfo.xaxis,s=n.plotinfo.yaxis;n.xr0&&(a[l._name+".range"]=n.xr0.slice()),n.yr0&&(a[s._name+".range"]=n.yr0.slice())}return r.call("relayout",e,a).then(function(){for(var e=0;e<t.length;e++)c(t[e].plotinfo)})}function m(){_=Date.now();for(var e=a(1,(_-x)/s.duration),o=f(e),r=0;r<t.length;r++)p(t[r],o);_-x>s.duration?(u(),b=window.cancelAnimationFrame(m)):b=window.requestAnimationFrame(m)}var h=e._fullLayout;if(0===t.length)return void l.redrawComponents(e);var y;d&&(y=d());var f=o.ease(s.easing),x,_,b;return e._transitionData._interruptCallbacks.push(function(){return window.cancelAnimationFrame(b),b=null,g()}),x=Date.now(),b=window.requestAnimationFrame(m),Promise.resolve()}},{"../../components/drawing":546,"../../lib":657,"../../registry":788,"./axes":705,d3:108}],730:[function(e,t){'use strict';function a(e,t){if("-"===e.type){var a=e._id,d=a.charAt(0),c;-1!==a.indexOf("scene")&&(a=d);var p=o(t,a,d);if(p){if("histogram"===p.type&&d==={v:"y",h:"x"}[p.orientation||"v"])return void(e.type="linear");var u=d+"calendar",g=p[u],m={noMultiCategory:!l(p,"cartesian")||l(p,"noMultiCategory")};if("box"===p.type&&p._hasPreCompStats&&d==={h:"x",v:"y"}[p.orientation||"v"]&&(m.noMultiCategory=!0),n(p,d)){var h=r(p),y=[];for(c=0;c<t.length;c++){var f=t[c];!l(f,"box-violin")||(f[d+"axis"]||d)!==a||(void 0===f[h]?void 0===f.name?y.push("text"):y.push(f.name):y.push(f[h][0]),f[u]!==g&&(g=void 0))}e.type=s(y,g,m)}else if("splom"===p.type){var x=p.dimensions,_=x[p._axesDim[a]];_.visible&&(e.type=s(_.values,g,m))}else e.type=s(p[d]||[p[d+"0"]],g,m)}}}function o(e,t,a){for(var o=0,r;o<e.length;o++){if(r=e[o],"splom"===r.type&&0<r._length&&(r["_"+a+"axes"]||{})[t])return r;if((r[a+"axis"]||a)===t){if(n(r,a))return r;if((r[a]||[]).length||r[a+"0"])return r}}}function r(e){return{v:"x",h:"y"}[e.orientation||"v"]}function n(e,t){var a=r(e),o=l(e,"box-violin"),i=l(e._fullInput||{},"candlestick");return o&&!i&&t===a&&e[a]===void 0&&e[a+"0"]===void 0}var l=e("../../registry").traceIs,s=e("./axis_autotype");t.exports=function(e,t,o,r){var i=o("type",(r.splomStash||{}).type);"-"===i&&(a(t,r.data),"-"===t.type?t.type="linear":e.type=t.type)}},{"../../registry":788,"./axis_autotype":706}],731:[function(e,t,a){'use strict';var s=Math.min;function o(e,t,a){var o=!1,r,i,n;if("data"===t.type)r=e._fullData[null===t.traces?0:t.traces[0]];else if("layout"===t.type)r=e._fullLayout;else return!1;return i=c.nestedProperty(r,t.prop).get(),n=a[t.type]=a[t.type]||{},n.hasOwnProperty(t.prop)&&n[t.prop]!==i&&(o=!0),n[t.prop]=i,{changed:o,value:i}}function r(e,t){return Array.isArray(t[0])&&1===t[0].length&&-1!==["string","number"].indexOf(typeof t[0][0])?[{type:"layout",prop:"_currentFrame",value:t[0][0].toString()}]:[]}function i(e,t){var a=[],o=t[0],r={};if("string"==typeof o)r[o]=t[1];else if(c.isPlainObject(o))r=o;else return a;return l(r,function(e,t,o){a.push({type:"layout",prop:e,value:o})},"",0),a}function n(e,t){var a=[],o,r,i,n;if(r=t[0],i=t[1],o=t[2],n={},"string"==typeof r)n[r]=i;else if(c.isPlainObject(r))n=r,void 0===o&&(o=i);else return a;return void 0===o&&(o=null),l(n,function(t,r,n){var l,d;if(Array.isArray(n)){d=n.slice();var c=s(d.length,e.data.length);o&&(c=s(c,o.length)),l=[];for(var p=0;p<c;p++)l[p]=o?o[p]:p}else d=n,l=o?o.slice():null;if(null===l)Array.isArray(d)&&(d=d[0]);else if(Array.isArray(l)){if(!Array.isArray(d)){var u=d;d=[];for(var g=0;g<l.length;g++)d[g]=u}d.length=s(l.length,d.length)}a.push({type:"data",prop:t,traces:l,value:d})},"",0),a}function l(e,t,a,o){Object.keys(e).forEach(function(r){var i=e[r];if("_"!==r[0]){var n=a+(0<o?".":"")+r;c.isPlainObject(i)?l(i,t,n,o+1):t(n,r,i)}})}var d=e("../registry"),c=e("../lib");a.manageCommandObserver=function(e,t,r,n){var l={},s=!0;t&&t._commandObserver&&(l=t._commandObserver),l.cache||(l.cache={}),l.lookupTable={};var d=a.hasSimpleAPICommandBindings(e,r,l.lookupTable);if(t&&t._commandObserver){if(!!d)return l;if(t._commandObserver.remove)return t._commandObserver.remove(),t._commandObserver=null,l}if(d){o(e,d,l.cache),l.check=function(){if(s){var t=o(e,d,l.cache);return t.changed&&n&&void 0!==l.lookupTable[t.value]&&(l.disable(),Promise.resolve(n({value:t.value,type:d.type,prop:d.prop,traces:d.traces,index:l.lookupTable[t.value]})).then(l.enable,l.enable)),t.changed}};for(var p=["plotly_relayout","plotly_redraw","plotly_restyle","plotly_update","plotly_animatingframe","plotly_afterplot"],u=0;u<p.length;u++)e._internalOn(p[u],l.check);l.remove=function(){for(var t=0;t<p.length;t++)e._removeInternalListener(p[t],l.check)}}else c.log("Unable to automatically bind plot updates to API command"),l.lookupTable={},l.remove=function(){};return l.disable=function(){s=!1},l.enable=function(){s=!0},t&&(t._commandObserver=l),l},a.hasSimpleAPICommandBindings=function(e,t,o){var r=t.length,n,l;for(n=0;n<r;n++){var s=t[n],d=s.method,c=s.args,p;if(Array.isArray(c)||(c=[]),!d)return!1;var u=a.computeAPICommandBindings(e,d,c);if(1!==u.length)return!1;if(!l)l=u[0],Array.isArray(l.traces)&&l.traces.sort();else{if(p=u[0],p.type!==l.type)return!1;if(p.prop!==l.prop)return!1;if(Array.isArray(l.traces)){if(Array.isArray(p.traces)){p.traces.sort();for(var g=0;g<l.traces.length;g++)if(l.traces[g]!==p.traces[g])return!1}else return!1;}else if(p.prop!==l.prop)return!1}p=u[0];var m=p.value;if(Array.isArray(m))if(1===m.length)m=m[0];else return!1;o&&(o[m]=n)}return l},a.executeAPICommand=function(e,t,a){if("skip"===t)return Promise.resolve();var o=d.apiMethodRegistry[t],r=[e];Array.isArray(a)||(a=[]);for(var n=0;n<a.length;n++)r.push(a[n]);return o.apply(null,r).catch(function(e){return c.warn("API call to Plotly."+t+" rejected.",e),Promise.reject(e)})},a.computeAPICommandBindings=function(e,t,a){var o;return Array.isArray(a)||(a=[]),o="restyle"===t?n(e,a):"relayout"===t?i(e,a):"update"===t?n(e,[a[0],a[2]]).concat(i(e,[a[1]])):"animate"===t?r(e,a):[],o}},{"../lib":657,"../registry":788}],732:[function(e,t,a){'use strict';var o=e("../lib/extend").extendFlat;a.attributes=function(e,t){e=e||{},t=t||{};var a={valType:"info_array",editType:e.editType,items:[{valType:"number",min:0,max:1,editType:e.editType},{valType:"number",min:0,max:1,editType:e.editType}],dflt:[0,1]},r=e.name?e.name+" ":"",i=e.trace?"trace ":"subplot ",n=t.description?" "+t.description:"",l={x:o({},a,{}),y:o({},a,{}),editType:e.editType};return e.noGridCell||(l.row={valType:"integer",min:0,dflt:0,editType:e.editType},l.column={valType:"integer",min:0,dflt:0,editType:e.editType}),l},a.defaults=function(e,t,a,o){var r=o&&o.x||[0,1],i=o&&o.y||[0,1],n=t.grid;if(n){var l=a("domain.column");l!==void 0&&(l<n.columns?r=n._domains.x[l]:delete e.domain.column);var s=a("domain.row");s!==void 0&&(s<n.rows?i=n._domains.y[s]:delete e.domain.row)}var d=a("domain.x",r),c=a("domain.y",i);d[0]<d[1]||(e.domain.x=r.slice()),c[0]<c[1]||(e.domain.y=i.slice())}},{"../lib/extend":648}],733:[function(e,t){'use strict';t.exports=function(e){var t=e.editType,a=e.colorEditType;void 0===a&&(a=t);var o={family:{valType:"string",noBlank:!0,strict:!0,editType:t},size:{valType:"number",min:1,editType:t},color:{valType:"color",editType:a},editType:t};return e.arrayOk&&(o.family.arrayOk=!0,o.size.arrayOk=!0,o.color.arrayOk=!0),o}},{}],734:[function(e,t){'use strict';t.exports={_isLinkedToArray:"frames_entry",group:{valType:"string"},name:{valType:"string"},traces:{valType:"any"},baseframe:{valType:"string"},data:{valType:"any"},layout:{valType:"any"}}},{}],735:[function(e,t,a){'use strict';a.projNames={equirectangular:"equirectangular",mercator:"mercator",orthographic:"orthographic","natural earth":"naturalEarth",kavrayskiy7:"kavrayskiy7",miller:"miller",robinson:"robinson",eckert4:"eckert4","azimuthal equal area":"azimuthalEqualArea","azimuthal equidistant":"azimuthalEquidistant","conic equal area":"conicEqualArea","conic conformal":"conicConformal","conic equidistant":"conicEquidistant",gnomonic:"gnomonic",stereographic:"stereographic",mollweide:"mollweide",hammer:"hammer","transverse mercator":"transverseMercator","albers usa":"albersUsa","winkel tripel":"winkel3",aitoff:"aitoff",sinusoidal:"sinusoidal"},a.axesNames=["lonaxis","lataxis"],a.lonaxisSpan={orthographic:180,"azimuthal equal area":360,"azimuthal equidistant":360,"conic conformal":180,gnomonic:160,stereographic:180,"transverse mercator":180,"*":360},a.lataxisSpan={"conic conformal":150,stereographic:179.5,"*":180},a.scopeDefaults={world:{lonaxisRange:[-180,180],lataxisRange:[-90,90],projType:"equirectangular",projRotate:[0,0,0]},usa:{lonaxisRange:[-180,-50],lataxisRange:[15,80],projType:"albers usa"},europe:{lonaxisRange:[-30,60],lataxisRange:[30,85],projType:"conic conformal",projRotate:[15,0,0],projParallels:[0,60]},asia:{lonaxisRange:[22,160],lataxisRange:[-15,55],projType:"mercator",projRotate:[0,0,0]},africa:{lonaxisRange:[-30,60],lataxisRange:[-40,40],projType:"mercator",projRotate:[0,0,0]},"north america":{lonaxisRange:[-180,-45],lataxisRange:[5,85],projType:"conic conformal",projRotate:[-100,0,0],projParallels:[29.5,45.5]},"south america":{lonaxisRange:[-100,-30],lataxisRange:[-60,15],projType:"mercator",projRotate:[0,0,0]}},a.clipPad=1e-3,a.precision=.1,a.landColor="#F0DC82",a.waterColor="#3399FF",a.locationmodeToLayer={"ISO-3":"countries","USA-states":"subunits","country names":"countries"},a.sphereSVG={type:"Sphere"},a.fillLayers={ocean:1,land:1,lakes:1},a.lineLayers={subunits:1,countries:1,coastlines:1,rivers:1,frame:1},a.layers=["bg","ocean","land","lakes","subunits","countries","coastlines","rivers","lataxis","lonaxis","frame","backplot","frontplot"],a.layersForChoropleth=["bg","ocean","land","subunits","countries","coastlines","lataxis","lonaxis","frame","backplot","rivers","lakes","frontplot"],a.layerNameToAdjective={ocean:"ocean",land:"land",lakes:"lake",subunits:"subunit",countries:"country",coastlines:"coastline",rivers:"river",frame:"frame"}},{}],736:[function(e,t){'use strict';var l=Math.PI,d=Math.min;function a(e){this.id=e.id,this.graphDiv=e.graphDiv,this.container=e.container,this.topojsonURL=e.topojsonURL,this.isStatic=e.staticPlot,this.topojsonName=null,this.topojson=null,this.projection=null,this.scope=null,this.viewInitial=null,this.fitScale=null,this.bounds=null,this.midPt=null,this.hasChoropleth=!1,this.traceHash={},this.layers={},this.basePaths={},this.dataPaths={},this.dataPoints={},this.clipDef=null,this.clipRect=null,this.bgRect=null,this.makeFramework()}function o(e){for(var t=e.projection,a=t.type,o=c.geo[w.projNames[a]](),n=e._isClipped?w.lonaxisSpan[a]/2:null,s=["center","rotate","parallels","clipExtent"],p=function(e){return e?o:[]},u=0,r;u<s.length;u++)r=s[u],"function"!=typeof o[r]&&(o[r]=p);return o.isLonLatOverEdges=function(e){if(null===o(e))return!0;if(n){var t=o.rotate(),a=c.geo.distance(e,[-t[0],-t[1]]);return a>n*l/180}return!1},o.getPath=function(){return c.geo.path().projection(o)},o.getBounds=function(e){return o.getPath().bounds(e)},o.fitExtent=function(e,t){var a=e[1][0]-e[0][0],r=e[1][1]-e[0][1],i=o.clipExtent&&o.clipExtent();o.scale(150).translate([0,0]),i&&o.clipExtent(null);var n=o.getBounds(t),l=d(a/(n[1][0]-n[0][0]),r/(n[1][1]-n[0][1])),s=+e[0][0]+(a-l*(n[1][0]+n[0][0]))/2,c=+e[0][1]+(r-l*(n[1][1]+n[0][1]))/2;return i&&o.clipExtent(i),o.scale(150*l).translate([s,c])},o.precision(w.precision),n&&o.clipAngle(n-w.clipPad),o}function r(e,t,a){var o=2.5,r=t[e],n=w.scopeDefaults[t.scope],s,d,c;"lonaxis"===e?(s=n.lonaxisRange,d=n.lataxisRange,c=function(e,t){return[e,t]}):"lataxis"==e&&(s=n.lataxisRange,d=n.lonaxisRange,c=function(e,t){return[t,e]});var p={type:"linear",range:[s[0],s[1]-1e-6],tick0:r.tick0,dtick:r.dtick};h.setConvert(p,a);var u=h.calcTicks(p);t.isScoped||"lonaxis"!==e||u.pop();for(var g=u.length,m=Array(g),y=0;y<g;y++)for(var f=u[y].x,x=m[y]=[],_=d[0];_<d[1]+o;_+=o)x.push(c(f,_));return{type:"MultiLineString",coordinates:m}}function n(e,t){var a=w.clipPad,o=e[0]+a,r=e[1]-a,i=t[0]+a,n=t[1]-a;0<o&&0>r&&(r+=360);var l=(r-o)/4;return{type:"Polygon",coordinates:[[[o,i],[o,n],[o+l,n],[o+2*l,n],[o+3*l,n],[r,n],[r,i],[r-l,i],[r-2*l,i],[r-3*l,i],[o,i]]]}}var c=e("d3"),s=e("../../registry"),p=e("../../lib"),u=e("../../components/color"),g=e("../../components/drawing"),m=e("../../components/fx"),i=e("../plots"),h=e("../cartesian/axes"),y=e("../cartesian/autorange").getAutoRange,f=e("../../components/dragelement"),x=e("../cartesian/select").prepSelect,_=e("../cartesian/select").clearSelect,b=e("../cartesian/select").selectOnClick,v=e("./zoom"),w=e("./constants"),T=e("../../lib/geo_location_utils"),A=e("../../lib/topojson_utils"),S=e("topojson-client").feature;e("./projections")(c);var C=a.prototype;t.exports=function(e){return new a(e)},C.plot=function(e,t,a){var o=this,r=t[this.id],n=[],l=!1;for(var s in w.layerNameToAdjective)if("frame"!=s&&r["show"+s]){l=!0;break}for(var d=0;d<e.length;d++)if(e[0][0].trace.locationmode){l=!0;break}if(l){var c=A.getTopojsonName(r);(null===o.topojson||c!==o.topojsonName)&&(o.topojsonName=c,PlotlyGeoAssets.topojson[o.topojsonName]===void 0&&n.push(o.fetchTopojson()))}n=n.concat(T.fetchTraceGeoData(e)),a.push(new Promise(function(a,r){Promise.all(n).then(function(){o.topojson=PlotlyGeoAssets.topojson[o.topojsonName],o.update(e,t),a()}).catch(r)}))},C.fetchTopojson=function(){var e=this,t=A.getTopojsonPath(e.topojsonURL,e.topojsonName);return new Promise(function(a,o){c.json(t,function(r,i){return r?404===r.status?o(new Error(["plotly.js could not find topojson file at",t,".","Make sure the *topojsonURL* plot config option","is set properly."].join(" "))):o(new Error(["unexpected error while fetching topojson file at",t].join(" "))):void(PlotlyGeoAssets.topojson[e.topojsonName]=i,a())})})},C.update=function(e,t){var a=t[this.id];this.hasChoropleth=!1;for(var o=0;o<e.length;o++){var r=e[o],n=r[0].trace;"choropleth"===n.type&&(this.hasChoropleth=!0),!0===n.visible&&0<n._length&&n._module.calcGeoJSON(r,t)}var l=this.updateProjection(e,t);if(!l){this.viewInitial&&this.scope===a.scope||this.saveViewInitial(a),this.scope=a.scope,this.updateBaseLayers(t,a),this.updateDims(t,a),this.updateFx(t,a),i.generalUpdatePerTraceModule(this.graphDiv,this,e,a);var s=this.layers.frontplot.select(".scatterlayer");this.dataPoints.point=s.selectAll(".point"),this.dataPoints.text=s.selectAll("text"),this.dataPaths.line=s.selectAll(".js-line");var d=this.layers.backplot.select(".choroplethlayer");this.dataPaths.choropleth=d.selectAll("path"),this.render()}},C.updateProjection=function(e,a){var r=this.graphDiv,l=a[this.id],c=a._size,u=l.domain,g=l.projection,m=l.lonaxis,h=l.lataxis,f=m._ax,x=h._ax,_=this.projection=o(l),v=[[c.l+c.w*u.x[0],c.t+c.h*(1-u.y[1])],[c.l+c.w*u.x[1],c.t+c.h*(1-u.y[0])]],k=l.center||{},T=g.rotation||{},A=m.range||[],S=h.range||[];if(l.fitbounds){f._length=v[1][0]-v[0][0],x._length=v[1][1]-v[0][1],f.range=y(r,f),x.range=y(r,x);var C=(f.range[0]+f.range[1])/2,L=(x.range[0]+x.range[1])/2;if(l._isScoped)k={lon:C,lat:L};else if(l._isClipped){k={lon:C,lat:L},T={lon:C,lat:L,roll:T.roll};var E=g.type,I=w.lonaxisSpan[E]/2||180,P=w.lataxisSpan[E]/2||180;A=[C-I,C+I],S=[L-P,L+P]}else k={lon:C,lat:L},T={lon:C,lat:T.lat,roll:T.roll}}_.center([k.lon-T.lon,k.lat-T.lat]).rotate([-T.lon,-T.lat,T.roll]).parallels(g.parallels);var z=n(A,S);_.fitExtent(v,z);var D=this.bounds=_.getBounds(z),b=this.fitScale=_.scale(),O=_.translate();if(!isFinite(D[0][0])||!isFinite(D[0][1])||!isFinite(D[1][0])||!isFinite(D[1][1])||isNaN(O[0])||isNaN(O[0])){for(var t=["fitbounds","projection.rotation","center","lonaxis.range","lataxis.range"],R="Invalid geo settings, relayout'ing to default view.",M={},j=0;j<t.length;j++)M[this.id+"."+t[j]]=null;return this.viewInitial=null,p.warn(R),r._promises.push(s.call("relayout",r,M)),R}if(l.fitbounds){var B=_.getBounds(n(f.range,x.range)),F=d((D[1][0]-D[0][0])/(B[1][0]-B[0][0]),(D[1][1]-D[0][1])/(B[1][1]-B[0][1]));isFinite(F)?_.scale(F*b):p.warn("Something went wrong during"+this.id+"fitbounds computations.")}else _.scale(g.scale*b);var N=this.midPt=[(D[0][0]+D[1][0])/2,(D[0][1]+D[1][1])/2];if(_.translate([O[0]+(N[0]-O[0]),O[1]+(N[1]-O[1])]).clipExtent(D),l._isAlbersUsa){var V=_([k.lon,k.lat]),U=_.translate();_.translate([U[0]-(V[0]-U[0]),U[1]-(V[1]-U[1])])}},C.updateBaseLayers=function(e,t){function a(e){return"lonaxis"===e||"lataxis"===e}function o(e){return!!w.lineLayers[e]}function i(e){return!!w.fillLayers[e]}var n=this,l=n.topojson,s=n.layers,p=n.basePaths,m=this.hasChoropleth?w.layersForChoropleth:w.layers,h=m.filter(function(e){return o(e)||i(e)?t["show"+e]:!a(e)||t[e].showgrid}),y=n.framework.selectAll(".layer").data(h,String);y.exit().each(function(e){delete s[e],delete p[e],c.select(this).remove()}),y.enter().append("g").attr("class",function(e){return"layer "+e}).each(function(e){var t=s[e]=c.select(this);"bg"===e?n.bgRect=t.append("rect").style("pointer-events","all"):a(e)?p[e]=t.append("path").style("fill","none"):"backplot"===e?t.append("g").classed("choroplethlayer",!0):"frontplot"===e?t.append("g").classed("scatterlayer",!0):o(e)?p[e]=t.append("path").style("fill","none").style("stroke-miterlimit",2):i(e)&&(p[e]=t.append("path").style("stroke","none"))}),y.order(),y.each(function(n){var s=p[n],d=w.layerNameToAdjective[n];"frame"===n?s.datum(w.sphereSVG):o(n)||i(n)?s.datum(S(l,l.objects[n])):a(n)&&s.datum(r(n,t,e)).call(u.stroke,t[n].gridcolor).call(g.dashLine,"",t[n].gridwidth),o(n)?s.call(u.stroke,t[d+"color"]).call(g.dashLine,"",t[d+"width"]):i(n)&&s.call(u.fill,t[d+"color"])})},C.updateDims=function(e,a){var o=this.bounds,r=(a.framewidth||0)/2,i=o[0][0]-r,n=o[0][1]-r,t=o[1][0]-i+r,l=o[1][1]-n+r;g.setRect(this.clipRect,i,n,t,l),this.bgRect.call(g.setRect,i,n,t,l).call(u.fill,a.bgcolor),this.xaxis._offset=i,this.xaxis._length=t,this.yaxis._offset=n,this.yaxis._length=l},C.updateFx=function(e,t){function a(){var e=r.viewInitial,t={};for(var a in e)t[r.id+"."+a]=e[a];s.call("_guiRelayout",i,t),i.emit("plotly_doubleclick",null)}function o(e){return r.projection.invert([e[0]+r.xaxis._offset,e[1]+r.yaxis._offset])}var r=this,i=r.graphDiv,n=r.bgRect,l=e.dragmode,d=e.clickmode;if(!r.isStatic){var p;"select"===l?p=function(e,t){var a=e.range={};a[r.id]=[o([t.xmin,t.ymin]),o([t.xmax,t.ymax])]}:"lasso"===l&&(p=function(e,t,a){var i=e.lassoPoints={};i[r.id]=a.filtered.map(o)});var u={element:r.bgRect.node(),gd:i,plotinfo:{id:r.id,xaxis:r.xaxis,yaxis:r.yaxis,fillRangeItems:p},xaxes:[r.xaxis],yaxes:[r.yaxis],subplot:r.id,clickFn:function(e){2===e&&_(i)}};"pan"===l?(n.node().onmousedown=null,n.call(v(r,t)),n.on("dblclick.zoom",a),!i._context._scrollZoom.geo&&n.on("wheel.zoom",null)):("select"===l||"lasso"===l)&&(n.on(".zoom",null),u.prepFn=function(t,e,a){x(t,e,a,u,l)},f.init(u)),n.on("mousemove",function(){var e=r.projection.invert(c.mouse(this));return!e||isNaN(e[0])||isNaN(e[1])?f.unhover(i,c.event):void(r.xaxis.p2c=function(){return e[0]},r.yaxis.p2c=function(){return e[1]},m.hover(i,c.event,r.id))}),n.on("mouseout",function(){i._dragging||f.unhover(i,c.event)}),n.on("click",function(){"select"!==l&&"lasso"!==l&&(-1<d.indexOf("select")&&b(c.event,i,[r.xaxis],[r.yaxis],r.id,u),-1<d.indexOf("event")&&m.click(i,c.event))})}},C.makeFramework=function(){var e=this,t=e.graphDiv,a=t._fullLayout,o="clip"+a._uid+e.id;e.clipDef=a._clips.append("clipPath").attr("id",o),e.clipRect=e.clipDef.append("rect"),e.framework=c.select(e.container).append("g").attr("class","geo "+e.id).call(g.setClipUrl,o,t),e.project=function(t){var a=e.projection(t);return a?[a[0]-e.xaxis._offset,a[1]-e.yaxis._offset]:[null,null]},e.xaxis={_id:"x",c2p:function(t){return e.project(t)[0]}},e.yaxis={_id:"y",c2p:function(t){return e.project(t)[1]}},e.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},h.setConvert(e.mockAxis,a)},C.saveViewInitial=function(e){var t=e.center||{},a=e.projection,o=a.rotation||{};this.viewInitial={fitbounds:e.fitbounds,"projection.scale":a.scale};var r;r=e._isScoped?{"center.lon":t.lon,"center.lat":t.lat}:e._isClipped?{"projection.rotation.lon":o.lon,"projection.rotation.lat":o.lat}:{"center.lon":t.lon,"center.lat":t.lat,"projection.rotation.lon":o.lon},p.extendFlat(this.viewInitial,r)},C.render=function(){function e(e){var t=a(e.lonlat);return t?"translate("+t[0]+","+t[1]+")":null}function t(e){return a.isLonLatOverEdges(e.lonlat)?"none":null}var a=this.projection,o=a.getPath(),r;for(r in this.basePaths)this.basePaths[r].attr("d",o);for(r in this.dataPaths)this.dataPaths[r].attr("d",function(e){return o(e.geojson)});for(r in this.dataPoints)this.dataPoints[r].attr("display",t).attr("transform",e)}},{"../../components/color":524,"../../components/dragelement":543,"../../components/drawing":546,"../../components/fx":564,"../../lib":657,"../../lib/geo_location_utils":651,"../../lib/topojson_utils":684,"../../registry":788,"../cartesian/autorange":704,"../cartesian/axes":705,"../cartesian/select":724,"../plots":768,"./constants":735,"./projections":740,"./zoom":741,d3:108,"topojson-client":1312}],737:[function(e,t){'use strict';var a=e("../../plots/get_data").getSubplotCalcData,o=e("../../lib").counterRegex,r=e("./geo"),i="geo",n=o(i),l={};l[i]={valType:"subplotid",dflt:i,editType:"calc"},t.exports={attr:i,name:i,idRoot:i,idRegex:n,attrRegex:n,attributes:l,layoutAttributes:e("./layout_attributes"),supplyLayoutDefaults:e("./layout_defaults"),plot:function(e){for(var t=e._fullLayout,o=e.calcdata,n=t._subplots.geo,l=0;l<n.length;l++){var s=n[l],d=a(o,"geo",s),c=t[s],p=c._subplot;p||(p=r({id:s,graphDiv:e,container:t._geolayer.node(),topojsonURL:e._context.topojsonURL,staticPlot:e._context.staticPlot}),t[s]._subplot=p),p.plot(d,t,e._promises)}},updateFx:function(e){for(var t=e._fullLayout,a=t._subplots.geo,o=0;o<a.length;o++){var r=t[a[o]],n=r._subplot;n.updateFx(t,r)}},clean:function(e,t,a,o){for(var r=o._subplots.geo||[],n=0;n<r.length;n++){var l=r[n],s=o[l]._subplot;t[l]||!s||(s.framework.remove(),s.clipDef.remove())}}}},{"../../lib":657,"../../plots/get_data":742,"./geo":736,"./layout_attributes":738,"./layout_defaults":739}],738:[function(e,t){'use strict';var a=e("../../components/color/attributes"),o=e("../domain").attributes,r=e("./constants"),i=e("../../plot_api/edit_types").overrideAll,n={range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},showgrid:{valType:"boolean",dflt:!1},tick0:{valType:"number",dflt:0},dtick:{valType:"number"},gridcolor:{valType:"color",dflt:a.lightLine},gridwidth:{valType:"number",min:0,dflt:1}},l=t.exports=i({domain:o({name:"geo"},{}),fitbounds:{valType:"enumerated",values:[!1,"locations","geojson"],dflt:!1,editType:"plot"},resolution:{valType:"enumerated",values:[110,50],dflt:110,coerceNumber:!0},scope:{valType:"enumerated",values:Object.keys(r.scopeDefaults),dflt:"world"},projection:{type:{valType:"enumerated",values:Object.keys(r.projNames)},rotation:{lon:{valType:"number"},lat:{valType:"number"},roll:{valType:"number"}},parallels:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},scale:{valType:"number",min:0,dflt:1}},center:{lon:{valType:"number"},lat:{valType:"number"}},visible:{valType:"boolean",dflt:!0},showcoastlines:{valType:"boolean"},coastlinecolor:{valType:"color",dflt:a.defaultLine},coastlinewidth:{valType:"number",min:0,dflt:1},showland:{valType:"boolean",dflt:!1},landcolor:{valType:"color",dflt:r.landColor},showocean:{valType:"boolean",dflt:!1},oceancolor:{valType:"color",dflt:r.waterColor},showlakes:{valType:"boolean",dflt:!1},lakecolor:{valType:"color",dflt:r.waterColor},showrivers:{valType:"boolean",dflt:!1},rivercolor:{valType:"color",dflt:r.waterColor},riverwidth:{valType:"number",min:0,dflt:1},showcountries:{valType:"boolean"},countrycolor:{valType:"color",dflt:a.defaultLine},countrywidth:{valType:"number",min:0,dflt:1},showsubunits:{valType:"boolean"},subunitcolor:{valType:"color",dflt:a.defaultLine},subunitwidth:{valType:"number",min:0,dflt:1},showframe:{valType:"boolean"},framecolor:{valType:"color",dflt:a.defaultLine},framewidth:{valType:"number",min:0,dflt:1},bgcolor:{valType:"color",dflt:a.background},lonaxis:n,lataxis:n},"plot","from-root");l.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":523,"../../plot_api/edit_types":688,"../domain":732,"./constants":735}],739:[function(e,t){'use strict';function a(e,t,a,r){var s=n(r.fullData,"geo",r.id),c=s.map(function(e){return e._expandedIndex}),p=a("resolution"),u=a("scope"),g=l.scopeDefaults[u],m=a("projection.type",g.projType),h=t._isAlbersUsa="albers usa"===m;h&&(u=t.scope="usa");var y=t._isScoped="world"!==u,f=t._isConic=-1!==m.indexOf("conic"),x=t._isClipped=!!l.lonaxisSpan[m];if(!1===e.visible){var _=o.extendDeep({},t._template);_.showcoastlines=!1,_.showcountries=!1,_.showframe=!1,_.showlakes=!1,_.showland=!1,_.showocean=!1,_.showrivers=!1,_.showsubunits=!1,_.lonaxis&&(_.lonaxis.showgrid=!1),_.lataxis&&(_.lataxis.showgrid=!1),t._template=_}for(var b=a("visible"),v=0,w;v<d.length;v++){var k=d[v],T=[30,10][v],A;if(y)A=g[k+"Range"];else{var S=l[k+"Span"],C=(S[m]||S["*"])/2,L=a("projection.rotation."+k.substr(0,3),g.projRotate[v]);A=[L-C,L+C]}var E=a(k+".range",A);a(k+".tick0"),a(k+".dtick",T),w=a(k+".showgrid",!!b&&void 0),w&&(a(k+".gridcolor"),a(k+".gridwidth")),t[k]._ax={type:"linear",_id:k.slice(0,3),_traceIndices:c,setScale:o.identity,c2l:o.identity,r2l:o.identity,autorange:!0,range:E.slice(),_m:1,_input:{}}}var I=t.lonaxis.range,P=t.lataxis.range,z=I[0],D=I[1];0<z&&0>D&&(D+=360);var O=(z+D)/2,R;if(!h){var M=y?g.projRotate:[O,0,0];R=a("projection.rotation.lon",M[0]),a("projection.rotation.lat",M[1]),a("projection.rotation.roll",M[2]),w=a("showcoastlines",!y&&b),w&&(a("coastlinecolor"),a("coastlinewidth")),w=a("showocean",!!b&&void 0),w&&a("oceancolor")}var j,B;if(h?(j=-96.6,B=38.7):(j=y?O:R,B=(P[0]+P[1])/2),a("center.lon",j),a("center.lat",B),f){var F=g.projParallels||[0,60];a("projection.parallels",F)}a("projection.scale"),w=a("showland",!!b&&void 0),w&&a("landcolor"),w=a("showlakes",!!b&&void 0),w&&a("lakecolor"),w=a("showrivers",!!b&&void 0),w&&(a("rivercolor"),a("riverwidth")),w=a("showcountries",y&&"usa"!==u&&b),w&&(a("countrycolor"),a("countrywidth")),("usa"===u||"north america"===u&&50===p)&&(a("showsubunits",b),a("subunitcolor"),a("subunitwidth")),y||(w=a("showframe",b),w&&(a("framecolor"),a("framewidth"))),a("bgcolor");var N=a("fitbounds");N&&(delete t.projection.scale,y?(delete t.center.lon,delete t.center.lat):x?(delete t.center.lon,delete t.center.lat,delete t.projection.rotation.lon,delete t.projection.rotation.lat,delete t.lonaxis.range,delete t.lataxis.range):(delete t.center.lon,delete t.center.lat,delete t.projection.rotation.lon))}var o=e("../../lib"),r=e("../subplot_defaults"),n=e("../get_data").getSubplotData,l=e("./constants"),s=e("./layout_attributes"),d=l.axesNames;t.exports=function(e,t,o){r(e,t,o,{type:"geo",attributes:s,handleDefaults:a,fullData:o,partition:"y"})}},{"../../lib":657,"../get_data":742,"../subplot_defaults":782,"./constants":735,"./layout_attributes":738}],740:[function(e,t){'use strict';var a=Math.cos,o=Math.sqrt,r=Math.sin,n=Math.min,l=Math.abs,s=Math.floor;t.exports=function(e){function t(e,t){return{type:"Feature",id:e.id,properties:e.properties,geometry:i(e.geometry,t)}}function i(t,a){if(!t)return null;if("GeometryCollection"===t.type)return{type:"GeometryCollection",geometries:object.geometries.map(function(e){return i(e,a)})};if(!z.hasOwnProperty(t.type))return null;var o=z[t.type];return e.geo.stream(t,a(o)),o.result()}function d(){}function c(e){if(4>(o=e.length))return!1;for(var t=0,a=e[o-1][1]*e[0][0]-e[o-1][0]*e[0][1],o;++t<o;)a+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return 0>=a}function p(e,t){for(var a=t[0],o=t[1],r=!1,l=0,s=e.length,n=s-1;l<s;n=l++){var d=e[l],c=d[0],p=d[1],u=e[n],g=u[0],m=u[1];p>o^m>o&&a<(g-c)*(o-p)/(m-p)+c&&(r=!r)}return r}function u(e){return e?e/r(e):1}function g(e){return 1<e?R:-1>e?-R:Math.asin(e)}function m(e){return 1<e?0:-1>e?O:Math.acos(e)}function h(e,t){var n=(2+R)*r(t);t/=2;for(var s=0,d=1/0,c;10>s&&l(d)>D;s++)c=a(t),t-=d=(t+r(t)*(c+2)-n)/(2*c*(1+c));return[2/o(O*(4+O))*e*(1+a(t)),2*o(O/(4+O))*r(t)]}function y(e,t){function a(a,o){var r=N(a/t,o);return r[0]*=e,r}return(2>arguments.length&&(t=e),1===t)?N:t===1/0?f:(a.invert=function(a,o){var r=N.invert(a/e,o);return r[0]*=t,r},a)}function f(e,t){return[e*a(t)/a(t/=2),2*r(t)]}function x(e,t){return[3*e/(2*O)*o(O*O/3-t*t),t]}function _(e,t){return[e,1.25*Math.log(Math.tan(O/4+.4*t))]}function b(e){return function(t){var o=e*r(t),n=30,s;do t-=s=(t+r(t)-o)/(1+a(t));while(l(s)>D&&0<--n);return t/2}}function v(e,t){var a=t*t,o=a*a;return[e*(.8707-.131979*a+o*(-.013791+o*(.003971*a-.001529*o))),t*(1.007226+a*(.015085+o*(-.044475+.028874*a-.005916*o)))]}function w(e,t){var a=n(18,36*l(t)/O),o=s(a),r=a-o,i=(m=H[o])[0],d=m[1],c=(m=H[++o])[0],p=m[1],u=(m=H[n(19,++o)])[0],g=m[1],m;return[e*(c+r*(u-i)/2+r*r*(u-2*c+i)/2),(0<t?R:-R)*(p+r*(g-d)/2+r*r*(g-2*p+d)/2)]}function k(e,t){return[e*a(t),t]}function T(e,t){var o=a(t),i=u(m(o*a(e/=2)));return[2*o*r(e)*i,r(t)*i]}function A(e,t){var a=T(e,t);return[(a[0]+e/R)/2,(a[1]+t)/2]}e.geo.project=function(e,t){var a=t.stream;if(!a)throw new Error("not yet supported");return(e&&S.hasOwnProperty(e.type)?S[e.type]:i)(e,a)};var S={Feature:t,FeatureCollection:function(e,a){return{type:"FeatureCollection",features:e.features.map(function(e){return t(e,a)})}}},C=[],L=[],E={point:function(e,t){C.push([e,t])},result:function(){var e=C.length?2>C.length?{type:"Point",coordinates:C[0]}:{type:"MultiPoint",coordinates:C}:null;return C=[],e}},I={lineStart:d,point:function(e,t){C.push([e,t])},lineEnd:function(){C.length&&(L.push(C),C=[])},result:function(){var e=L.length?2>L.length?{type:"LineString",coordinates:L[0]}:{type:"MultiLineString",coordinates:L}:null;return L=[],e}},P={polygonStart:d,lineStart:d,point:function(e,t){C.push([e,t])},lineEnd:function(){var e=C.length;if(e){do C.push(C[0].slice());while(4>++e);L.push(C),C=[]}},polygonEnd:d,result:function(){if(!L.length)return null;var e=[],t=[];return L.forEach(function(a){c(a)?e.push([a]):t.push(a)}),t.forEach(function(t){var a=t[0];e.some(function(e){if(p(e[0],a))return e.push(t),!0})||e.push([t])}),L=[],e.length?1<e.length?{type:"MultiPolygon",coordinates:e}:{type:"Polygon",coordinates:e[0]}:null}},z={Point:E,MultiPoint:E,LineString:I,MultiLineString:I,Polygon:P,MultiPolygon:P,Sphere:P},D=1e-6,O=Math.PI,R=O/2,M=o(O),j=e.geo.projection,F=e.geo.projectionMutator;e.geo.interrupt=function(a){function o(e,t){for(var o=0>t?-1:1,r=d[+(0>t)],l=0,s=r.length-1;l<s&&e>r[l][2][0];++l);var n=a(e-r[l][1][0],t);return n[0]+=a(r[l][1][0],o*t>o*r[l][0][1]?r[l][0][1]:t)[0],n}function r(){c=d.map(function(e){return e.map(function(e){var o=a(e[0][0],e[0][1])[0],r=a(e[2][0],e[2][1])[0],i=a(e[1][0],e[0][1])[1],n=a(e[1][0],e[1][1])[1],l;return i>n&&(l=i,i=n,n=l),[[o,i],[r,n]]})})}function i(){for(var t=1e-6,a=[],o=0,r=d[0].length;o<r;++o){var l=d[0][o],s=180*l[0][0]/O,c=180*l[0][1]/O,p=180*l[1][1]/O,u=180*l[2][0]/O,g=180*l[2][1]/O;a.push(n([[s+t,c+t],[s+t,p-t],[u-t,p-t],[u-t,g+t]],30))}for(var o=d[1].length-1;0<=o;--o){var l=d[1][o],s=180*l[0][0]/O,c=180*l[0][1]/O,p=180*l[1][1]/O,u=180*l[2][0]/O,g=180*l[2][1]/O;a.push(n([[u-t,g-t],[u-t,p+t],[s+t,p+t],[s+t,c-t]],30))}return{type:"Polygon",coordinates:[e.merge(a)]}}function n(e,t){for(var a=-1,o=e.length,r=e[0],n=[],l,s,d;++a<o;){l=e[a],s=(l[0]-r[0])/t,d=(l[1]-r[1])/t;for(var c=0;c<t;++c)n.push([r[0]+c*s,r[1]+c*d]);r=l}return n.push(l),n}function s(e,t){return l(e[0]-t[0])<D&&l(e[1]-t[1])<D}var d=[[[[-O,0],[0,R],[O,0]]],[[[-O,0],[0,-R],[O,0]]]],c;a.invert&&(o.invert=function(e,t){for(var r=c[+(0>t)],l=d[+(0>t)],p=0,u=r.length,n;p<u;++p)if(n=r[p],n[0][0]<=e&&e<n[1][0]&&n[0][1]<=t&&t<n[1][1]){var g=a.invert(e-a(l[p][1][0],0)[0],t);return g[0]+=l[p][1][0],s(o(g[0],g[1]),[e,t])?g:null}});var p=e.geo.projection(o),u=p.stream;return p.stream=function(t){var a=p.rotate(),o=u(t),r=(p.rotate([0,0]),u(t));return p.rotate(a),o.sphere=function(){e.geo.stream(i(),r)},o},p.lobes=function(e){return arguments.length?(d=e.map(function(e){return e.map(function(e){return[[e[0][0]*O/180,e[0][1]*O/180],[e[1][0]*O/180,e[1][1]*O/180],[e[2][0]*O/180,e[2][1]*O/180]]})}),r(),p):d.map(function(e){return e.map(function(e){return[[180*e[0][0]/O,180*e[0][1]/O],[180*e[1][0]/O,180*e[1][1]/O],[180*e[2][0]/O,180*e[2][1]/O]]})})},p},h.invert=function(e,t){var r=.5*t*o((4+O)/O),i=g(r),n=a(i);return[e/(2/o(O*(4+O))*(1+n)),g((i+r*(n+2))/(2+R))]},(e.geo.eckert4=function(){return j(h)}).raw=h;var N=e.geo.azimuthalEqualArea.raw;f.invert=function(e,t){var o=2*g(t/2);return[e*a(o/2)/a(o),o]},(e.geo.hammer=function(){var e=2,t=F(y),a=t(e);return a.coefficient=function(a){return arguments.length?t(e=+a):e},a}).raw=y,x.invert=function(e,t){return[2/3*O*e/o(O*O/3-t*t),t]},(e.geo.kavrayskiy7=function(){return j(x)}).raw=x,_.invert=function(e,t){return[e,2.5*Math.atan(Math.exp(.8*t))-.625*O]},(e.geo.miller=function(){return j(_)}).raw=_;var V=b(O),U=function(e,t,o){function i(o,i){return[e*o*a(i=n(i)),t*r(i)]}var n=b(o);return i.invert=function(i,n){var l=g(n/t);return[i/(e*a(l)),g((2*l+r(2*l))/o)]},i}(Math.SQRT2/R,Math.SQRT2,O);(e.geo.mollweide=function(){return j(U)}).raw=U,v.invert=function(e,t){var a=t,o=25,r;do{var n=a*a,s=n*n;a-=r=(a*(1.007226+n*(.015085+s*(-.044475+.028874*n-.005916*s)))-t)/(1.007226+n*(3*.015085+s*(7*-.044475+9*.028874*n-11*.005916*s)))}while(l(r)>D&&0<--o);return[e/(.8707+(n=a*a)*(-.131979+n*(-.013791+n*n*n*(.003971-.001529*n)))),a]},(e.geo.naturalEarth=function(){return j(v)}).raw=v;var H=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];H.forEach(function(e){e[1]*=1.0144}),w.invert=function(e,a){var o=a/R,r=90*o,d=n(18,l(r/5)),p=Math.max(0,s(d));do{var g=H[p][1],m=H[p+1][1],h=H[n(19,p+2)][1],y=h-g,u=h-2*m+g,f=2*(l(o)-m)/y,t=u/y,c=f*(1-t*f*(1-2*t*f));if(0<=c||1===p){r=(0<=a?5:-5)*(c+d);var x=50,_;do d=n(18,l(r)/5),p=s(d),c=d-p,g=H[p][1],m=H[p+1][1],h=H[n(19,p+2)][1],r-=(_=(0<=a?R:-R)*(m+c*(h-g)/2+c*c*(h-2*m+g)/2)-a)*(180/O);while(l(_)>D*D&&0<--x);break}}while(0<=--p);var b=H[p][0],v=H[p+1][0],w=H[n(19,p+2)][0];return[e/(v+c*(w-b)/2+c*c*(w-2*v+b)/2),r*(O/180)]},(e.geo.robinson=function(){return j(w)}).raw=w,k.invert=function(e,t){return[e/a(t),t]},(e.geo.sinusoidal=function(){return j(k)}).raw=k,T.invert=function(e,t){if(!(e*e+4*t*t>O*O+D)){var n=e,s=t,d=25;do{var c=r(n),p=r(n/2),u=a(n/2),g=r(s),h=a(s),y=r(2*s),f=g*g,x=h*h,_=p*p,b=1-x*u*u,v=b?m(h*u)*o(E=1/b):E=0,w=2*v*h*p-e,k=v*g-t,T=E*(x*_+v*h*u*f),A=E*(.5*c*y-2*v*g*p),S=.25*E*(y*p-v*g*x*c),C=E*(f*u+v*_*h),L=A*S-C*T,E;if(!L)break;var I=(k*A-w*C)/L,P=(w*S-k*T)/L;n-=I,s-=P}while((l(I)>D||l(P)>D)&&0<--d);return[n,s]}},(e.geo.aitoff=function(){return j(T)}).raw=T,A.invert=function(e,t){var n=e,s=t,d=25;do{var c=a(s),p=r(s),u=r(2*s),g=p*p,h=c*c,y=r(n),f=a(n/2),x=r(n/2),_=x*x,b=1-h*f*f,v=b?m(c*f)*o(P=1/b):P=0,w=.5*(2*v*c*x+n/R)-e,k=.5*(v*p+s)-t,T=.5*P*(h*_+v*c*f*g)+.5/R,A=P*(y*u/4-v*p*x),S=.125*P*(u*x-v*p*h*y),C=.5*P*(g*f+v*_*c)+.5,L=A*S-C*T,E=(k*A-w*C)/L,I=(w*S-k*T)/L,P;n-=E,s-=I}while((l(E)>D||l(I)>D)&&0<--d);return[n,s]},(e.geo.winkel3=function(){return j(A)}).raw=A}},{}],741:[function(e,t){'use strict';var v=Math.asin,w=Math.acos,k=Math.atan2,T=Math.cos,A=Math.sqrt,S=Math.PI,C=Math.sin,L=Math.min,E=Math.abs,I=Math.max;function a(e,t){return P.behavior.zoom().translate(t.translate()).scale(t.scale())}function o(e,t,a){function o(e,t){c[r+"."+e]=b.nestedProperty(l,e).get(),z.call("_storeDirectGUIEdit",n,s._preGUI,c);var a=b.nestedProperty(d,e);a.get()!==t&&(a.set(t),b.nestedProperty(l,e).set(t),p[r+"."+e]=t)}var r=e.id,i=e.graphDiv,n=i.layout,l=n[r],s=i._fullLayout,d=s[r],c={},p={};a(o),o("projection.scale",t.scale()/e.fitScale),o("fitbounds",!1),i.emit("plotly_relayout",p)}function r(e,t){function r(a){var o=t.invert(e.midPt);a("center.lon",o[0]),a("center.lat",o[1])}var i=a(e,t);return i.on("zoomstart",function(){P.select(this).style(R)}).on("zoom",function(){t.scale(P.event.scale).translate(P.event.translate),e.render();var a=t.invert(e.midPt);e.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":t.scale()/e.fitScale,"geo.center.lon":a[0],"geo.center.lat":a[1]})}).on("zoomend",function(){P.select(this).style(M),o(e,t,r)}),i}function i(e,t){function r(e){return t.invert(e)}function i(e){var a=r(e);if(!a)return!0;var o=t(a);return 2<E(o[0]-e[0])||2<E(o[1]-e[1])}function n(){P.select(this).style(R),p=P.mouse(this),u=t.rotate(),g=t.translate(),m=u,h=r(p)}function l(){if(y=P.mouse(this),i(p))return c.scale(t.scale()),void c.translate(t.translate());t.scale(P.event.scale),t.translate([g[0],P.event.translate[1]]),h?r(y)&&(x=r(y),f=[m[0]+(x[0]-h[0]),u[1],u[2]],t.rotate(f),m=f):(p=y,h=r(p)),_=!0,e.render();var a=t.rotate(),o=t.invert(e.midPt);e.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":t.scale()/e.fitScale,"geo.center.lon":o[0],"geo.center.lat":o[1],"geo.projection.rotation.lon":-a[0]})}function s(){P.select(this).style(M),_&&o(e,t,d)}function d(a){var o=t.rotate(),r=t.invert(e.midPt);a("projection.rotation.lon",-o[0]),a("center.lon",r[0]),a("center.lat",r[1])}var c=a(e,t),p,u,g,m,h,y,f,x,_;return c.on("zoomstart",n).on("zoom",l).on("zoomend",s),c}function n(e,t){function r(e){f++||e({type:"zoomstart"})}function i(e){e({type:"zoom"})}function n(e){--f||e({type:"zoomend"})}function u(e){var a=t.rotate();e("projection.rotation.lon",-a[0]),e("projection.rotation.lat",-a[1])}var g={r:t.rotate(),k:t.scale()},m=a(e,t),y=_(m,"zoomstart","zoom","zoomend"),f=0,x=m.on,b;return m.on("zoomstart",function(){P.select(this).style(R);var e=P.mouse(this),a=t.rotate(),o=a,n=t.translate(),u=s(a);b=l(t,e),x.call(m,"zoom",function(){var r=P.mouse(this);if(t.scale(g.k=P.event.scale),!b)e=r,b=l(t,e);else if(l(t,r)){t.rotate(a).translate(n);var s=l(t,r),m=c(b,s),f=h(d(u,m)),x=g.r=p(f,b,o);isFinite(x[0])&&isFinite(x[1])&&isFinite(x[2])||(x=o),t.rotate(x),o=x}i(y.of(this,arguments))}),r(y.of(this,arguments))}).on("zoomend",function(){P.select(this).style(M),x.call(m,"zoom",null),n(y.of(this,arguments)),o(e,t,u)}).on("zoom.redraw",function(){e.render();var a=t.rotate();e.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":t.scale()/e.fitScale,"geo.projection.rotation.lon":-a[0],"geo.projection.rotation.lat":-a[1]})}),P.rebind(m,y,"on")}function l(e,t){var a=e.invert(t);return a&&isFinite(a[0])&&isFinite(a[1])&&y(a)}function s(e){var t=.5*e[0]*D,a=.5*e[1]*D,o=.5*e[2]*D,r=C(t),i=T(t),n=C(a),l=T(a),s=C(o),d=T(o);return[i*l*d+r*n*s,r*l*d-i*n*s,i*n*d+r*l*s,i*l*s-r*n*d]}function d(e,t){var a=e[0],o=e[1],r=e[2],i=e[3],n=t[0],l=t[1],s=t[2],d=t[3];return[a*n-o*l-r*s-i*d,a*l+o*n+r*d-i*s,a*s-o*d+r*n+i*l,a*d+o*s-r*l+i*n]}function c(e,t){if(e&&t){var a=x(e,t),o=A(f(a,a)),r=.5*w(I(-1,L(1,f(e,t)))),i=C(r)/o;return o&&[T(r),a[2]*i,-a[1]*i,a[0]*i]}}function p(e,t,o){var r=m(t,2,e[0]);r=m(r,1,e[1]),r=m(r,0,e[2]-o[2]);var i=t[0],n=t[1],l=t[2],s=r[0],d=r[1],c=r[2],p=k(n,i)*O,g=A(i*i+n*n),a,h;E(d)>g?(h=(0<d?90:-90)-p,a=0):(h=v(d/g)*O-p,a=A(g*g-d*d));var y=180-h-2*p,f=(k(c,s)-k(l,a))*O,x=(k(c,s)-k(l,-a))*O,_=u(o[0],o[1],h,f),w=u(o[0],o[1],y,x);return _<=w?[h,f,o[2]]:[y,x,o[2]]}function u(e,t,a,o){var r=g(a-e),i=g(o-t);return A(r*r+i*i)}function g(e){return(e%360+540)%360-180}function m(e,t,a){var o=a*D,r=e.slice(),i=0===t?1:0,n=2===t?1:2,l=T(o),s=C(o);return r[i]=e[i]*l-e[n]*s,r[n]=e[n]*l+e[i]*s,r}function h(e){return[k(2*(e[0]*e[1]+e[2]*e[3]),1-2*(e[1]*e[1]+e[2]*e[2]))*O,v(I(-1,L(1,2*(e[0]*e[2]-e[3]*e[1]))))*O,k(2*(e[0]*e[3]+e[1]*e[2]),1-2*(e[2]*e[2]+e[3]*e[3]))*O]}function y(e){var t=e[0]*D,a=e[1]*D,o=T(a);return[o*T(t),o*C(t),C(a)]}function f(e,t){for(var a=0,o=0,r=e.length;o<r;++o)a+=e[o]*t[o];return a}function x(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function _(e){for(var t=0,a=arguments.length,o=[];++t<a;)o.push(arguments[t]);var r=P.dispatch.apply(null,o);return r.of=function(t,a){return function(o){var i;try{i=o.sourceEvent=P.event,o.target=e,P.event=o,r[o.type].apply(t,a)}finally{P.event=i}}},r}var P=e("d3"),b=e("../../lib"),z=e("../../registry"),D=S/180,O=180/S,R={cursor:"pointer"},M={cursor:"auto"};t.exports=function(e,t){var a=e.projection,o;return o=t._isScoped?r:t._isClipped?n:i,o(e,a)}},{"../../lib":657,"../../registry":788,d3:108}],742:[function(e,t,a){'use strict';var o=e("../registry"),r=e("./cartesian/constants").SUBPLOT_PATTERN;a.getSubplotCalcData=function(e,t,a){var r=o.subplotsRegistry[t];if(!r)return[];for(var n=r.attr,l=[],s=0;s<e.length;s++){var d=e[s],c=d[0].trace;c[n]===a&&l.push(d)}return l},a.getModuleCalcData=function(e,t){var a=[],r=[],n;if(n="string"==typeof t?o.getModule(t).plot:"function"==typeof t?t:t.plot,!n)return[a,e];for(var l=0;l<e.length;l++){var s=e[l],d=s[0].trace;!0!==d.visible||0===d._length||(d._module.plot===n?a.push(s):r.push(s))}return[a,r]},a.getSubplotData=function(e,t,a){if(!o.subplotsRegistry[t])return[];var n=o.subplotsRegistry[t].attr,l=[],s,d,c;if("gl2d"===t){var p=a.match(r);d="x"+p[1],c="y"+p[2]}for(var u=0;u<e.length;u++)s=e[u],"gl2d"===t&&o.traceIs(s,"gl2d")?s[n[0]]===d&&s[n[1]]===c&&l.push(s):s[n]===a&&l.push(s);return l}},{"../registry":788,"./cartesian/constants":711}],743:[function(e,t){'use strict';var o=Math.exp,r=Math.min,i=Math.abs,n=Math.max;function a(e,t){this.element=e,this.plot=t,this.mouseListener=null,this.wheelListener=null,this.lastInputTime=Date.now(),this.lastPos=[0,0],this.boxEnabled=!1,this.boxInited=!1,this.boxStart=[0,0],this.boxEnd=[0,0],this.dragStart=[0,0]}var l=e("mouse-change"),s=e("mouse-wheel"),d=e("mouse-event-offset"),c=e("../cartesian/constants"),p=e("has-passive-events");t.exports=function(e){function t(){e.xaxis.autorange=!1,e.yaxis.autorange=!1}function u(){for(var t=e.graphDiv._fullLayout._axisConstraintGroups,a=e.xaxis._id,o=e.yaxis._id,r=0;r<t.length;r++)if(-1!==t[r][a]){if(-1!==t[r][o])return!0;break}return!1}function g(a,o,l){function s(t,a,o){var i=r(a,o),l=n(a,o);i===l?(e.selectBox.selectBox=[0,0,1,1],e.glplot.setDirty()):(d[t]=i,d[t+2]=l,f.dataBox=d,e.setRanges(d))}var d=e.calcDataBox(),p=h.viewBox,g=f.lastPos[0],m=f.lastPos[1],_=c.MINDRAG*h.pixelRatio,b=c.MINZOOM*h.pixelRatio,v,w;switch(o*=h.pixelRatio,l*=h.pixelRatio,l=p[3]-p[1]-l,e.fullLayout.dragmode){case"zoom":if(a){var k=o/(p[2]-p[0])*(d[2]-d[0])+d[0],T=l/(p[3]-p[1])*(d[3]-d[1])+d[1];f.boxInited||(f.boxStart[0]=k,f.boxStart[1]=T,f.dragStart[0]=o,f.dragStart[1]=l),f.boxEnd[0]=k,f.boxEnd[1]=T,f.boxInited=!0,f.boxEnabled||f.boxStart[0]===f.boxEnd[0]&&f.boxStart[1]===f.boxEnd[1]||(f.boxEnabled=!0);var A=i(f.dragStart[0]-o)<b,S=i(f.dragStart[1]-l)<b;if(u()&&!(A&&S)){v=f.boxEnd[0]-f.boxStart[0],w=f.boxEnd[1]-f.boxStart[1];var C=(d[3]-d[1])/(d[2]-d[0]);i(v*C)>i(w)?(f.boxEnd[1]=f.boxStart[1]+i(v)*C*(0<=w?1:-1),f.boxEnd[1]<d[1]?(f.boxEnd[1]=d[1],f.boxEnd[0]=f.boxStart[0]+(d[1]-f.boxStart[1])/i(C)):f.boxEnd[1]>d[3]&&(f.boxEnd[1]=d[3],f.boxEnd[0]=f.boxStart[0]+(d[3]-f.boxStart[1])/i(C))):(f.boxEnd[0]=f.boxStart[0]+i(w)/C*(0<=v?1:-1),f.boxEnd[0]<d[0]?(f.boxEnd[0]=d[0],f.boxEnd[1]=f.boxStart[1]+(d[0]-f.boxStart[0])*i(C)):f.boxEnd[0]>d[2]&&(f.boxEnd[0]=d[2],f.boxEnd[1]=f.boxStart[1]+(d[2]-f.boxStart[0])*i(C)))}else A&&(f.boxEnd[0]=f.boxStart[0]),S&&(f.boxEnd[1]=f.boxStart[1])}else f.boxEnabled?(v=f.boxStart[0]!==f.boxEnd[0],w=f.boxStart[1]!==f.boxEnd[1],v||w?(v&&(s(0,f.boxStart[0],f.boxEnd[0]),e.xaxis.autorange=!1),w&&(s(1,f.boxStart[1],f.boxEnd[1]),e.yaxis.autorange=!1),e.relayoutCallback()):e.glplot.setDirty(),f.boxEnabled=!1,f.boxInited=!1):f.boxInited&&(f.boxInited=!1);break;case"pan":f.boxEnabled=!1,f.boxInited=!1,a?(!f.panning&&(f.dragStart[0]=o,f.dragStart[1]=l),i(f.dragStart[0]-o)<_&&(o=f.dragStart[0]),i(f.dragStart[1]-l)<_&&(l=f.dragStart[1]),v=(g-o)*(d[2]-d[0])/(h.viewBox[2]-h.viewBox[0]),w=(m-l)*(d[3]-d[1])/(h.viewBox[3]-h.viewBox[1]),d[0]+=v,d[2]+=v,d[1]+=w,d[3]+=w,e.setRanges(d),f.panning=!0,f.lastInputTime=Date.now(),t(),e.cameraChanged(),e.handleAnnotations()):f.panning&&(f.panning=!1,e.relayoutCallback());}f.lastPos[0]=o,f.lastPos[1]=l}var m=e.mouseContainer,h=e.glplot,f=new a(m,h);return f.mouseListener=l(m,g),m.addEventListener("touchstart",function(e){var t=d(e.changedTouches[0],m);g(0,t[0],t[1]),g(1,t[0],t[1]),e.preventDefault()},!!p&&{passive:!1}),m.addEventListener("touchmove",function(e){e.preventDefault();var t=d(e.changedTouches[0],m);g(1,t[0],t[1]),e.preventDefault()},!!p&&{passive:!1}),m.addEventListener("touchend",function(e){g(0,f.lastPos[0],f.lastPos[1]),e.preventDefault()},!!p&&{passive:!1}),f.wheelListener=s(m,function(a,r){if(!e.scrollZoom)return!1;var i=e.calcDataBox(),n=h.viewBox,l=f.lastPos[0],s=f.lastPos[1],d=o(5*r/(n[3]-n[1])),c=l/(n[2]-n[0])*(i[2]-i[0])+i[0],p=s/(n[3]-n[1])*(i[3]-i[1])+i[1];return i[0]=(i[0]-c)*d+c,i[2]=(i[2]-c)*d+c,i[1]=(i[1]-p)*d+p,i[3]=(i[3]-p)*d+p,e.setRanges(i),f.lastInputTime=Date.now(),t(),e.cameraChanged(),e.handleAnnotations(),e.relayoutCallback(),!0},!0),f}},{"../cartesian/constants":711,"has-passive-events":380,"mouse-change":410,"mouse-event-offset":411,"mouse-wheel":413}],744:[function(e,t){'use strict';var o=Math.PI;function a(e){this.scene=e,this.gl=e.gl,this.pixelRatio=e.pixelRatio,this.screenBox=[0,0,1,1],this.viewBox=[0,0,1,1],this.dataBox=[-1,-1,1,1],this.borderLineEnable=[!1,!1,!1,!1],this.borderLineWidth=[1,1,1,1],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.ticks=[[],[]],this.tickEnable=[!0,!0,!1,!1],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labels=["x","y"],this.labelEnable=[!0,!0,!1,!1],this.labelAngle=[0,o/2,0,3*o/2],this.labelPad=[15,15,15,15],this.labelSize=[12,12],this.labelFont=["sans-serif","sans-serif"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.title="",this.titleEnable=!0,this.titleCenter=[0,0,0,0],this.titleAngle=0,this.titleColor=[0,0,0,1],this.titleFont="sans-serif",this.titleSize=18,this.gridLineEnable=[!0,!0],this.gridLineColor=[[0,0,0,.5],[0,0,0,.5]],this.gridLineWidth=[1,1],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[1,1],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.static=this.scene.staticPlot}var r=e("../cartesian/axes"),n=e("../../lib/str2rgbarray"),l=a.prototype,s=["xaxis","yaxis"];l.merge=function(e){this.titleEnable=!1,this.backgroundColor=n(e.plot_bgcolor);var t,a,r,l,d,c,p,u,g,m,h;for(m=0;2>m;++m){t=s[m];var y=t.charAt(0);for(a=e[this.scene[t]._name],r=a.title.text===this.scene.fullLayout._dfltTitle[y]?"":a.title.text,h=0;2>=h;h+=2)this.labelEnable[m+h]=!1,this.labels[m+h]=r,this.labelColor[m+h]=n(a.title.font.color),this.labelFont[m+h]=a.title.font.family,this.labelSize[m+h]=a.title.font.size,this.labelPad[m+h]=this.getLabelPad(t,a),this.tickEnable[m+h]=!1,this.tickColor[m+h]=n((a.tickfont||{}).color),this.tickAngle[m+h]="auto"===a.tickangle?0:o*-a.tickangle/180,this.tickPad[m+h]=this.getTickPad(a),this.tickMarkLength[m+h]=0,this.tickMarkWidth[m+h]=a.tickwidth||0,this.tickMarkColor[m+h]=n(a.tickcolor),this.borderLineEnable[m+h]=!1,this.borderLineColor[m+h]=n(a.linecolor),this.borderLineWidth[m+h]=a.linewidth||0;p=this.hasSharedAxis(a),d=this.hasAxisInDfltPos(t,a)&&!p,c=this.hasAxisInAltrPos(t,a)&&!p,l=a.mirror||!1,u=p?-1!==(l+"").indexOf("all"):!!l,g=p?"allticks"===l:-1!==(l+"").indexOf("ticks"),d?this.labelEnable[m]=!0:c&&(this.labelEnable[m+2]=!0),d?this.tickEnable[m]=a.showticklabels:c&&(this.tickEnable[m+2]=a.showticklabels),(d||u)&&(this.borderLineEnable[m]=a.showline),(c||u)&&(this.borderLineEnable[m+2]=a.showline),(d||g)&&(this.tickMarkLength[m]=this.getTickMarkLength(a)),(c||g)&&(this.tickMarkLength[m+2]=this.getTickMarkLength(a)),this.gridLineEnable[m]=a.showgrid,this.gridLineColor[m]=n(a.gridcolor),this.gridLineWidth[m]=a.gridwidth,this.zeroLineEnable[m]=a.zeroline,this.zeroLineColor[m]=n(a.zerolinecolor),this.zeroLineWidth[m]=a.zerolinewidth}},l.hasSharedAxis=function(e){var t=this.scene,a=t.fullLayout._subplots.gl2d,o=r.findSubplotsWithAxis(a,e);return 0!==o.indexOf(t.id)},l.hasAxisInDfltPos=function(e,t){var a=t.side;if("xaxis"===e)return"bottom"===a;return"yaxis"===e?"left"===a:void 0},l.hasAxisInAltrPos=function(e,t){var a=t.side;if("xaxis"===e)return"top"===a;return"yaxis"===e?"right"===a:void 0},l.getLabelPad=function(e,t){var a=1.5,o=t.title.font.size,r=t.showticklabels;if("xaxis"===e)return"top"===t.side?-10+o*(a+(r?1:0)):-10+o*(a+(r?.5:0));return"yaxis"===e?"right"===t.side?10+o*(a+(r?1:.5)):10+o*(a+(r?.5:0)):void 0},l.getTickPad=function(e){return"outside"===e.ticks?10+e.ticklen:15},l.getTickMarkLength=function(e){if(!e.ticks)return 0;var t=e.ticklen;return"inside"===e.ticks?-t:t},t.exports=function(e){return new a(e)}},{"../../lib/str2rgbarray":680,"../cartesian/axes":705}],745:[function(e,t,a){'use strict';var o=e("../../plot_api/edit_types").overrideAll,r=e("./scene2d"),i=e("../layout_attributes"),n=e("../../constants/xmlns_namespaces"),l=e("../cartesian/constants"),s=e("../cartesian"),d=e("../../components/fx/layout_attributes"),c=e("../get_data").getSubplotData;a.name="gl2d",a.attr=["xaxis","yaxis"],a.idRoot=["x","y"],a.idRegex=l.idRegex,a.attrRegex=l.attrRegex,a.attributes=e("../cartesian/attributes"),a.supplyLayoutDefaults=function(e,t,a){t._has("cartesian")||s.supplyLayoutDefaults(e,t,a)},a.layoutAttrOverrides=o(s.layoutAttributes,"plot","from-root"),a.baseLayoutAttrOverrides=o({plot_bgcolor:i.plot_bgcolor,hoverlabel:d.hoverlabel},"plot","nested"),a.plot=function(e){for(var t=e._fullLayout,a=e._fullData,o=t._subplots.gl2d,n=0;n<o.length;n++){var l=o[n],s=t._plots[l],d=c(a,"gl2d",l),p=s._scene2d;p===void 0&&(p=new r({id:l,graphDiv:e,container:e.querySelector(".gl-container"),staticPlot:e._context.staticPlot,plotGlPixelRatio:e._context.plotGlPixelRatio},t),s._scene2d=p),p.plot(d,e.calcdata,t,e.layout)}},a.clean=function(e,t,a,o){for(var r=o._subplots.gl2d||[],n=0;n<r.length;n++){var l=r[n],d=o._plots[l];if(d._scene2d){var p=c(e,"gl2d",l);0===p.length&&(d._scene2d.destroy(),delete o._plots[l])}}s.clean.apply(this,arguments)},a.drawFramework=function(e){e._context.staticPlot||s.drawFramework(e)},a.toSVG=function(e){for(var t=e._fullLayout,a=t._subplots.gl2d,o=0;o<a.length;o++){var r=t._plots[a[o]],l=r._scene2d,s=l.toImage("png"),d=t._glimages.append("svg:image");d.attr({xmlns:n.svg,"xlink:href":s,x:0,y:0,width:"100%",height:"100%",preserveAspectRatio:"none"}),l.destroy()}},a.updateFx=function(e){for(var t=e._fullLayout,a=t._subplots.gl2d,o=0,r;o<a.length;o++)r=t._plots[a[o]]._scene2d,r.updateFx(t.dragmode)}},{"../../components/fx/layout_attributes":565,"../../constants/xmlns_namespaces":634,"../../plot_api/edit_types":688,"../cartesian":718,"../cartesian/attributes":703,"../cartesian/constants":711,"../get_data":742,"../layout_attributes":759,"./scene2d":746}],746:[function(e,t){'use strict';var r=Math.ceil,n=Math.min,l=Math.max;function a(e,t){this.container=e.container,this.graphDiv=e.graphDiv,this.pixelRatio=e.plotGlPixelRatio||window.devicePixelRatio,this.id=e.id,this.staticPlot=!!e.staticPlot,this.scrollZoom=this.graphDiv._context._scrollZoom.cartesian,this.fullData=null,this.updateRefs(t),this.makeFramework();this.stopped||(this.glplotOptions=m(this),this.glplotOptions.merge(t),this.glplot=i(this.glplotOptions),this.camera=h(this),this.traces={},this.spikes=p(this.glplot),this.selectBox=u(this.glplot,{innerFill:!1,outerFill:!0}),this.lastButtonState=0,this.pickResult=null,this.isMouseOver=!0,this.stopped=!1,this.redraw=this.draw.bind(this),this.redraw())}function o(e,t){for(var a=0;2>a;++a){var o=e[a],r=t[a];if(o.length!==r.length)return!0;for(var n=0;n<o.length;++n)if(o[n].x!==r[n].x)return!0}return!1}var s=e("../../registry"),d=e("../../plots/cartesian/axes"),c=e("../../components/fx"),i=e("gl-plot2d"),p=e("gl-spikes2d"),u=e("gl-select-box"),g=e("webgl-context"),m=e("./convert"),h=e("./camera"),y=e("../../lib/show_no_webgl_msg"),f=e("../cartesian/constraints"),x=f.enforce,_=f.clean,b=e("../cartesian/autorange").doAutoRange,v=e("../../components/dragelement/helpers"),w=v.drawMode,k=v.selectMode,T=["xaxis","yaxis"],A=e("../cartesian/constants").SUBPLOT_PATTERN,S,C;t.exports=a;var L=a.prototype;L.makeFramework=function(){if(this.staticPlot){if(!C&&(S=document.createElement("canvas"),C=g({canvas:S,preserveDrawingBuffer:!1,premultipliedAlpha:!0,antialias:!0}),!C))throw new Error("Error creating static canvas/context for image server");this.canvas=S,this.gl=C}else{var e=this.container.querySelector(".gl-canvas-focus"),t=g({canvas:e,preserveDrawingBuffer:!0,premultipliedAlpha:!0});if(!t)return y(this),void(this.stopped=!0);this.canvas=e,this.gl=t}var a=this.canvas;a.style.width="100%",a.style.height="100%",a.style.position="absolute",a.style.top="0px",a.style.left="0px",a.style["pointer-events"]="none",this.updateSize(a),a.className+=" user-select-none";var o=this.svgContainer=document.createElementNS("http://www.w3.org/2000/svg","svg");o.style.position="absolute",o.style.top=o.style.left="0px",o.style.width=o.style.height="100%",o.style["z-index"]=20,o.style["pointer-events"]="none";var r=this.mouseContainer=document.createElement("div");r.style.position="absolute",r.style["pointer-events"]="auto",this.pickCanvas=this.container.querySelector(".gl-canvas-pick");var i=this.container;i.appendChild(o),i.appendChild(r);var n=this;r.addEventListener("mouseout",function(){n.isMouseOver=!1,n.unhover()}),r.addEventListener("mouseover",function(){n.isMouseOver=!0})},L.toImage=function(e){e||(e="png"),this.stopped=!0,this.staticPlot&&this.container.appendChild(S),this.updateSize(this.canvas);var t=this.glplot.gl,a=t.drawingBufferWidth,o=t.drawingBufferHeight;t.clearColor(1,1,1,0),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.glplot.setDirty(),this.glplot.draw(),t.bindFramebuffer(t.FRAMEBUFFER,null);var r=new Uint8Array(4*(a*o));t.readPixels(0,0,a,o,t.RGBA,t.UNSIGNED_BYTE,r);for(var n=0,s=o-1;n<s;++n,--s)for(var d=0;d<a;++d)for(var c=0,p;4>c;++c)p=r[4*(a*n+d)+c],r[4*(a*n+d)+c]=r[4*(a*s+d)+c],r[4*(a*s+d)+c]=p;var u=document.createElement("canvas");u.width=a,u.height=o;var g=u.getContext("2d"),m=g.createImageData(a,o);m.data.set(r),g.putImageData(m,0,0);var h;return h="jpeg"===e?u.toDataURL("image/jpeg"):"webp"===e?u.toDataURL("image/webp"):u.toDataURL("image/png"),this.staticPlot&&this.container.removeChild(S),h},L.updateSize=function(e){e||(e=this.canvas);var t=this.pixelRatio,a=this.fullLayout,o=a.width,i=a.height,n=0|r(t*o),l=0|r(t*i);return(e.width!==n||e.height!==l)&&(e.width=n,e.height=l),e},L.computeTickMarks=function(){this.xaxis.setScale(),this.yaxis.setScale();for(var e=[d.calcTicks(this.xaxis),d.calcTicks(this.yaxis)],t=0;2>t;++t)for(var a=0;a<e[t].length;++a)e[t][a].text+="";return e},L.updateRefs=function(e){this.fullLayout=e;var t=this.id.match(A),a="xaxis"+t[1],o="yaxis"+t[2];this.xaxis=this.fullLayout[a],this.yaxis=this.fullLayout[o]},L.relayoutCallback=function(){var e=this.graphDiv,t=this.xaxis,a=this.yaxis,o=e.layout,r={},i=r[t._name+".range"]=t.range.slice(),n=r[a._name+".range"]=a.range.slice();r[t._name+".autorange"]=t.autorange,r[a._name+".autorange"]=a.autorange,s.call("_storeDirectGUIEdit",e.layout,e._fullLayout._preGUI,r);var l=o[t._name];l.range=i,l.autorange=t.autorange;var d=o[a._name];d.range=n,d.autorange=a.autorange,r.lastInputTime=this.camera.lastInputTime,e.emit("plotly_relayout",r)},L.cameraChanged=function(){var e=this.camera;this.glplot.setDataBox(this.calcDataBox());var t=this.computeTickMarks(),a=this.glplotOptions.ticks;o(t,a)&&(this.glplotOptions.ticks=t,this.glplotOptions.dataBox=e.dataBox,this.glplot.update(this.glplotOptions),this.handleAnnotations())},L.handleAnnotations=function(){for(var e=this.graphDiv,t=this.fullLayout.annotations,a=0,o;a<t.length;a++)o=t[a],o.xref===this.xaxis._id&&o.yref===this.yaxis._id&&s.getComponentMethod("annotations","drawOne")(e,a)},L.destroy=function(){if(this.glplot){var e=this.traces;e&&Object.keys(e).map(function(t){e[t].dispose(),delete e[t]}),this.glplot.dispose(),this.container.removeChild(this.svgContainer),this.container.removeChild(this.mouseContainer),this.fullData=null,this.glplot=null,this.stopped=!0,this.camera.mouseListener.enabled=!1,this.mouseContainer.removeEventListener("wheel",this.camera.wheelListener),this.camera=null}},L.plot=function(e,t,a){var o=this.glplot;this.updateRefs(a),this.xaxis.clearCalc(),this.yaxis.clearCalc(),this.updateTraces(e,t),this.updateFx(a.dragmode);var r=a.width,n=a.height;this.updateSize(this.canvas);var l=this.glplotOptions;l.merge(a),l.screenBox=[0,0,r,n];var s={_fullLayout:{_axisConstraintGroups:this.graphDiv._fullLayout._axisConstraintGroups,xaxis:this.xaxis,yaxis:this.yaxis}};_(s,this.xaxis),_(s,this.yaxis);var d=a._size,c=this.xaxis.domain,p=this.yaxis.domain;l.viewBox=[d.l+c[0]*d.w,d.b+p[0]*d.h,r-d.r-(1-c[1])*d.w,n-d.t-(1-p[1])*d.h],this.mouseContainer.style.width=d.w*(c[1]-c[0])+"px",this.mouseContainer.style.height=d.h*(p[1]-p[0])+"px",this.mouseContainer.height=d.h*(p[1]-p[0]),this.mouseContainer.style.left=d.l+c[0]*d.w+"px",this.mouseContainer.style.top=d.t+(1-p[1])*d.h+"px";var u,g;for(g=0;2>g;++g)u=this[T[g]],u._length=l.viewBox[g+2]-l.viewBox[g],b(this.graphDiv,u),u.setScale();x(s),l.ticks=this.computeTickMarks(),l.dataBox=this.calcDataBox(),l.merge(a),o.update(l),this.glplot.draw()},L.calcDataBox=function(){var e=this.xaxis,t=this.yaxis,a=e.range,o=t.range,r=e.r2l,i=t.r2l;return[r(a[0]),i(o[0]),r(a[1]),i(o[1])]},L.setRanges=function(e){var t=this.xaxis,a=this.yaxis,o=t.l2r,r=a.l2r;t.range=[o(e[0]),o(e[2])],a.range=[r(e[1]),r(e[3])]},L.updateTraces=function(e,t){var a=Object.keys(this.traces),o,r,n;this.fullData=e;traceIdLoop:for(o=0;o<a.length;o++){var l=a[o],s=this.traces[l];for(r=0;r<e.length;r++)if(n=e[r],n.uid===l&&n.type===s.type)continue traceIdLoop;s.dispose(),delete this.traces[l]}for(o=0;o<e.length;o++){n=e[o];var d=t[o],c=this.traces[n.uid];c?c.update(n,d):(c=n._module.plot(this,n,d),this.traces[n.uid]=c)}this.glplot.objects.sort(function(e,t){return e._trace.index-t._trace.index})},L.updateFx=function(e){k(e)||w(e)?(this.pickCanvas.style["pointer-events"]="none",this.mouseContainer.style["pointer-events"]="none"):(this.pickCanvas.style["pointer-events"]="auto",this.mouseContainer.style["pointer-events"]="auto"),this.mouseContainer.style.cursor="pan"===e?"move":"zoom"===e?"crosshair":null},L.emitPointAction=function(e,t){for(var a=e.trace.uid,o=e.pointIndex,r=0,n;r<this.fullData.length;r++)this.fullData[r].uid===a&&(n=this.fullData[r]);var l={x:e.traceCoord[0],y:e.traceCoord[1],curveNumber:n.index,pointNumber:o,data:n._input,fullData:this.fullData,xaxis:this.xaxis,yaxis:this.yaxis};c.appendArrayPointValue(l,n,o),this.graphDiv.emit(t,{points:[l]})},L.draw=function(){if(!this.stopped){requestAnimationFrame(this.redraw);var e=this.glplot,t=this.camera,a=t.mouseListener,o=1===this.lastButtonState&&0===a.buttons,r=this.fullLayout;this.lastButtonState=a.buttons,this.cameraChanged();var s=a.x*e.pixelRatio,d=this.canvas.height-e.pixelRatio*a.y,p;if(t.boxEnabled&&"zoom"===r.dragmode){this.selectBox.enabled=!0;for(var u=this.selectBox.selectBox=[n(t.boxStart[0],t.boxEnd[0]),n(t.boxStart[1],t.boxEnd[1]),l(t.boxStart[0],t.boxEnd[0]),l(t.boxStart[1],t.boxEnd[1])],g=0;2>g;g++)t.boxStart[g]===t.boxEnd[g]&&(u[g]=e.dataBox[g],u[g+2]=e.dataBox[g+2]);e.setDirty()}else if(!t.panning&&this.isMouseOver){this.selectBox.enabled=!1;var m=r._size,h=this.xaxis.domain,y=this.yaxis.domain;p=e.pick(s/e.pixelRatio+m.l+h[0]*m.w,d/e.pixelRatio-(m.t+(1-y[1])*m.h));var f=p&&p.object._trace.handlePick(p);if(f&&o&&this.emitPointAction(f,"plotly_click"),p&&"skip"!==p.object._trace.hoverinfo&&r.hovermode&&f&&(!this.lastPickResult||this.lastPickResult.traceUid!==f.trace.uid||this.lastPickResult.dataCoord[0]!==f.dataCoord[0]||this.lastPickResult.dataCoord[1]!==f.dataCoord[1])){var x=f;this.lastPickResult={traceUid:f.trace?f.trace.uid:null,dataCoord:f.dataCoord.slice()},this.spikes.update({center:p.dataCoord}),x.screenCoord=[((e.viewBox[2]-e.viewBox[0])*(p.dataCoord[0]-e.dataBox[0])/(e.dataBox[2]-e.dataBox[0])+e.viewBox[0])/e.pixelRatio,(this.canvas.height-(e.viewBox[3]-e.viewBox[1])*(p.dataCoord[1]-e.dataBox[1])/(e.dataBox[3]-e.dataBox[1])-e.viewBox[1])/e.pixelRatio],this.emitPointAction(f,"plotly_hover");var _=this.fullData[x.trace.index]||{},b=x.pointIndex,v=c.castHoverinfo(_,r,b);if(v&&"all"!==v){var w=v.split("+");-1===w.indexOf("x")&&(x.traceCoord[0]=void 0),-1===w.indexOf("y")&&(x.traceCoord[1]=void 0),-1===w.indexOf("z")&&(x.traceCoord[2]=void 0),-1===w.indexOf("text")&&(x.textLabel=void 0),-1===w.indexOf("name")&&(x.name=void 0)}c.loneHover({x:x.screenCoord[0],y:x.screenCoord[1],xLabel:this.hoverFormatter("xaxis",x.traceCoord[0]),yLabel:this.hoverFormatter("yaxis",x.traceCoord[1]),zLabel:x.traceCoord[2],text:x.textLabel,name:x.name,color:c.castHoverOption(_,b,"bgcolor")||x.color,borderColor:c.castHoverOption(_,b,"bordercolor"),fontFamily:c.castHoverOption(_,b,"font.family"),fontSize:c.castHoverOption(_,b,"font.size"),fontColor:c.castHoverOption(_,b,"font.color"),nameLength:c.castHoverOption(_,b,"namelength"),textAlign:c.castHoverOption(_,b,"align")},{container:this.svgContainer,gd:this.graphDiv})}}p||this.unhover(),e.draw()}},L.unhover=function(){this.lastPickResult&&(this.spikes.update({}),this.lastPickResult=null,this.graphDiv.emit("plotly_unhover"),c.loneUnhover(this.svgContainer))},L.hoverFormatter=function(e,t){if(void 0!==t){var a=this[e];return d.tickText(a,a.c2l(t),"hover").text}}},{"../../components/dragelement/helpers":542,"../../components/fx":564,"../../lib/show_no_webgl_msg":678,"../../plots/cartesian/axes":705,"../../registry":788,"../cartesian/autorange":704,"../cartesian/constants":711,"../cartesian/constraints":712,"./camera":743,"./convert":744,"gl-plot2d":263,"gl-select-box":275,"gl-spikes2d":284,"webgl-context":1394}],747:[function(e,t,a){'use strict';var o=e("../../plot_api/edit_types").overrideAll,r=e("../../components/fx/layout_attributes"),n=e("./scene"),l=e("../get_data").getSubplotData,s=e("../../lib"),d=e("../../constants/xmlns_namespaces"),c="gl3d",p="scene";a.name=c,a.attr=p,a.idRoot=p,a.idRegex=a.attrRegex=s.counterRegex("scene"),a.attributes=e("./layout/attributes"),a.layoutAttributes=e("./layout/layout_attributes"),a.baseLayoutAttrOverrides=o({hoverlabel:r.hoverlabel},"plot","nested"),a.supplyLayoutDefaults=e("./layout/defaults"),a.plot=function(e){for(var t=e._fullLayout,a=e._fullData,o=t._subplots[c],r=0;r<o.length;r++){var s=o[r],d=l(a,c,s),p=t[s],u=p.camera,g=p._scene;g||(g=new n({id:s,graphDiv:e,container:e.querySelector(".gl-container"),staticPlot:e._context.staticPlot,plotGlPixelRatio:e._context.plotGlPixelRatio,camera:u},t),p._scene=g),g.viewInitial||(g.viewInitial={up:{x:u.up.x,y:u.up.y,z:u.up.z},eye:{x:u.eye.x,y:u.eye.y,z:u.eye.z},center:{x:u.center.x,y:u.center.y,z:u.center.z}}),g.plot(d,t,e.layout)}},a.clean=function(e,t,a,o){for(var r=o._subplots[c]||[],n=0,l;n<r.length;n++)l=r[n],t[l]||!o[l]._scene||(o[l]._scene.destroy(),o._infolayer&&o._infolayer.selectAll(".annotation-"+l).remove())},a.toSVG=function(e){for(var t=e._fullLayout,a=t._subplots[c],o=t._size,r=0;r<a.length;r++){var n=t[a[r]],l=n.domain,s=n._scene,p=s.toImage("png"),u=t._glimages.append("svg:image");u.attr({xmlns:d.svg,"xlink:href":p,x:o.l+o.w*l.x[0],y:o.t+o.h*(1-l.y[1]),width:o.w*(l.x[1]-l.x[0]),height:o.h*(l.y[1]-l.y[0]),preserveAspectRatio:"none"}),s.destroy()}},a.cleanId=function(e){if(e.match(/^scene[0-9]*$/)){var t=e.substr(5);return"1"===t&&(t=""),p+t}},a.updateFx=function(e){for(var t=e._fullLayout,a=t._subplots[c],o=0,r;o<a.length;o++)r=t[a[o]]._scene,r.updateFx(t.dragmode,t.hovermode)}},{"../../components/fx/layout_attributes":565,"../../constants/xmlns_namespaces":634,"../../lib":657,"../../plot_api/edit_types":688,"../get_data":742,"./layout/attributes":748,"./layout/defaults":752,"./layout/layout_attributes":753,"./scene":757}],748:[function(e,t){'use strict';t.exports={scene:{valType:"subplotid",dflt:"scene",editType:"calc+clearAxisTypes"}}},{}],749:[function(e,t){'use strict';var a=e("../../../components/color"),o=e("../../cartesian/layout_attributes"),r=e("../../../lib/extend").extendFlat,i=e("../../../plot_api/edit_types").overrideAll;t.exports=i({visible:o.visible,showspikes:{valType:"boolean",dflt:!0},spikesides:{valType:"boolean",dflt:!0},spikethickness:{valType:"number",min:0,dflt:2},spikecolor:{valType:"color",dflt:a.defaultLine},showbackground:{valType:"boolean",dflt:!1},backgroundcolor:{valType:"color",dflt:"rgba(204, 204, 204, 0.5)"},showaxeslabels:{valType:"boolean",dflt:!0},color:o.color,categoryorder:o.categoryorder,categoryarray:o.categoryarray,title:{text:o.title.text,font:o.title.font},type:r({},o.type,{values:["-","linear","log","date","category"]}),autorange:o.autorange,rangemode:o.rangemode,range:r({},o.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],anim:!1}),tickmode:o.tickmode,nticks:o.nticks,tick0:o.tick0,dtick:o.dtick,tickvals:o.tickvals,ticktext:o.ticktext,ticks:o.ticks,mirror:o.mirror,ticklen:o.ticklen,tickwidth:o.tickwidth,tickcolor:o.tickcolor,showticklabels:o.showticklabels,tickfont:o.tickfont,tickangle:o.tickangle,tickprefix:o.tickprefix,showtickprefix:o.showtickprefix,ticksuffix:o.ticksuffix,showticksuffix:o.showticksuffix,showexponent:o.showexponent,exponentformat:o.exponentformat,separatethousands:o.separatethousands,tickformat:o.tickformat,tickformatstops:o.tickformatstops,hoverformat:o.hoverformat,showline:o.showline,linecolor:o.linecolor,linewidth:o.linewidth,showgrid:o.showgrid,gridcolor:r({},o.gridcolor,{dflt:"rgb(204, 204, 204)"}),gridwidth:o.gridwidth,zeroline:o.zeroline,zerolinecolor:o.zerolinecolor,zerolinewidth:o.zerolinewidth,_deprecated:{title:o._deprecated.title,titlefont:o._deprecated.titlefont}},"plot","from-root")},{"../../../components/color":524,"../../../lib/extend":648,"../../../plot_api/edit_types":688,"../../cartesian/layout_attributes":719}],750:[function(e,t){'use strict';var a=e("tinycolor2").mix,o=e("../../../lib"),r=e("../../../plot_api/plot_template"),i=e("./axis_attributes"),n=e("../../cartesian/type_defaults"),l=e("../../cartesian/axis_defaults"),s=["xaxis","yaxis","zaxis"];t.exports=function(e,t,d){function c(e,t){return o.coerce(u,g,i,e,t)}for(var p=0,u,g,m;p<s.length;p++)m=s[p],u=e[m]||{},g=r.newContainer(t,m),g._id=m[0]+d.scene,g._name=m,n(u,g,c,d),l(u,g,c,{font:d.font,letter:m[0],data:d.data,showGrid:!0,noTickson:!0,bgColor:d.bgColor,calendar:d.calendar},d.fullLayout),c("gridcolor",a(g.color,d.bgColor,13600/187).toRgbString()),c("title.text",m[0]),g.setScale=o.noop,c("showspikes")&&(c("spikesides"),c("spikethickness"),c("spikecolor",g.color)),c("showaxeslabels"),c("showbackground")&&c("backgroundcolor")}},{"../../../lib":657,"../../../plot_api/plot_template":695,"../../cartesian/axis_defaults":707,"../../cartesian/type_defaults":730,"./axis_attributes":749,tinycolor2:1309}],751:[function(e,t){'use strict';var o=Math.PI;function a(){this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[18,18,18],this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont=["Open Sans","Open Sans","Open Sans"],this.labelSize=[20,20,20],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[30,30,30],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[10,10,10],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!0,!0,!0],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._defaultTickPad=this.tickPad.slice(),this._defaultLabelPad=this.labelPad.slice(),this._defaultLineTickLength=this.lineTickLength.slice()}var r=e("../../../lib/str2rgbarray"),n=e("../../../lib"),l=["xaxis","yaxis","zaxis"],s=a.prototype;s.merge=function(e,t){for(var a=this,s=0,d;3>s;++s){if(d=t[l[s]],!d.visible){a.tickEnable[s]=!1,a.labelEnable[s]=!1,a.lineEnable[s]=!1,a.lineTickEnable[s]=!1,a.gridEnable[s]=!1,a.zeroEnable[s]=!1,a.backgroundEnable[s]=!1;continue}a.labels[s]=e._meta?n.templateString(d.title.text,e._meta):d.title.text,"font"in d.title&&(d.title.font.color&&(a.labelColor[s]=r(d.title.font.color)),d.title.font.family&&(a.labelFont[s]=d.title.font.family),d.title.font.size&&(a.labelSize[s]=d.title.font.size)),"showline"in d&&(a.lineEnable[s]=d.showline),"linecolor"in d&&(a.lineColor[s]=r(d.linecolor)),"linewidth"in d&&(a.lineWidth[s]=d.linewidth),"showgrid"in d&&(a.gridEnable[s]=d.showgrid),"gridcolor"in d&&(a.gridColor[s]=r(d.gridcolor)),"gridwidth"in d&&(a.gridWidth[s]=d.gridwidth),"log"===d.type?a.zeroEnable[s]=!1:"zeroline"in d&&(a.zeroEnable[s]=d.zeroline),"zerolinecolor"in d&&(a.zeroLineColor[s]=r(d.zerolinecolor)),"zerolinewidth"in d&&(a.zeroLineWidth[s]=d.zerolinewidth),a.lineTickEnable[s]="ticks"in d&&d.ticks,"ticklen"in d&&(a.lineTickLength[s]=a._defaultLineTickLength[s]=d.ticklen),"tickcolor"in d&&(a.lineTickColor[s]=r(d.tickcolor)),"tickwidth"in d&&(a.lineTickWidth[s]=d.tickwidth),"tickangle"in d&&(a.tickAngle[s]="auto"===d.tickangle?-3600:o*-d.tickangle/180),"showticklabels"in d&&(a.tickEnable[s]=d.showticklabels),"tickfont"in d&&(d.tickfont.color&&(a.tickColor[s]=r(d.tickfont.color)),d.tickfont.family&&(a.tickFont[s]=d.tickfont.family),d.tickfont.size&&(a.tickSize[s]=d.tickfont.size)),"mirror"in d?-1===["ticks","all","allticks"].indexOf(d.mirror)?!0===d.mirror?(a.lineTickMirror[s]=!1,a.lineMirror[s]=!0):(a.lineTickMirror[s]=!1,a.lineMirror[s]=!1):(a.lineTickMirror[s]=!0,a.lineMirror[s]=!0):a.lineMirror[s]=!1,"showbackground"in d&&!1!==d.showbackground?(a.backgroundEnable[s]=!0,a.backgroundColor[s]=r(d.backgroundcolor)):a.backgroundEnable[s]=!1}},t.exports=function(e,t){var o=new a;return o.merge(e,t),o}},{"../../../lib":657,"../../../lib/str2rgbarray":680}],752:[function(e,t){'use strict';var o=Math.sqrt;function a(e,t,a,r){for(var l=a("bgcolor"),d=i.combine(l,r.paper_bgcolor),p=["up","center","eye"],u=0;u<p.length;u++)a("camera."+p[u]+".x"),a("camera."+p[u]+".y"),a("camera."+p[u]+".z");a("camera.projection.type");var g=!!a("aspectratio.x")&&!!a("aspectratio.y")&&!!a("aspectratio.z"),m=g?"manual":"auto",h=a("aspectmode",m);g||(e.aspectratio=t.aspectratio={x:1,y:1,z:1},"manual"===h&&(t.aspectmode="auto"),e.aspectmode=t.aspectmode);var f=c(r.fullData,"gl3d",r.id);s(e,t,{font:r.font,scene:r.id,data:f,bgColor:d,calendar:r.calendar,fullLayout:r.fullLayout}),n.getComponentMethod("annotations3d","handleDefaults")(e,t,r);var _=r.getDfltFromLayout("dragmode");if(!1!==_&&!_)if(_="orbit",e.camera&&e.camera.up){var b=e.camera.up.x,x=e.camera.up.y,y=e.camera.up.z;0!==y&&(b&&x&&y?.999<y/o(b*b+x*x+y*y)&&(_="turntable"):_="turntable")}else _="turntable";a("dragmode",_),a("hovermode",r.getDfltFromLayout("hovermode"))}var r=e("../../../lib"),i=e("../../../components/color"),n=e("../../../registry"),l=e("../../subplot_defaults"),s=e("./axis_defaults"),d=e("./layout_attributes"),c=e("../../get_data").getSubplotData;t.exports=function(e,t,o){var i=1<t._basePlotModules.length;l(e,t,o,{type:"gl3d",attributes:d,handleDefaults:a,fullLayout:t,font:t.font,fullData:o,getDfltFromLayout:function(t){if(!i){var a=r.validate(e[t],d[t]);if(a)return e[t]}},paper_bgcolor:t.paper_bgcolor,calendar:t.calendar})}},{"../../../components/color":524,"../../../lib":657,"../../../registry":788,"../../get_data":742,"../../subplot_defaults":782,"./axis_defaults":750,"./layout_attributes":753}],753:[function(e,t){'use strict';function a(e,t,a){return{x:{valType:"number",dflt:e,editType:"camera"},y:{valType:"number",dflt:t,editType:"camera"},z:{valType:"number",dflt:a,editType:"camera"},editType:"camera"}}var o=e("./axis_attributes"),r=e("../../domain").attributes,i=e("../../../lib/extend").extendFlat,n=e("../../../lib").counterRegex;t.exports={_arrayAttrRegexps:[n("scene",".annotations",!0)],bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"plot"},camera:{up:i(a(0,0,1),{}),center:i(a(0,0,0),{}),eye:i(a(1.25,1.25,1.25),{}),projection:{type:{valType:"enumerated",values:["perspective","orthographic"],dflt:"perspective",editType:"calc"},editType:"calc"},editType:"camera"},domain:r({name:"scene",editType:"plot"}),aspectmode:{valType:"enumerated",values:["auto","cube","data","manual"],dflt:"auto",editType:"plot",impliedEdits:{"aspectratio.x":void 0,"aspectratio.y":void 0,"aspectratio.z":void 0}},aspectratio:{x:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},y:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},z:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},editType:"plot",impliedEdits:{aspectmode:"manual"}},xaxis:o,yaxis:o,zaxis:o,dragmode:{valType:"enumerated",values:["orbit","turntable","zoom","pan",!1],editType:"plot"},hovermode:{valType:"enumerated",values:["closest",!1],dflt:"closest",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"plot",_deprecated:{cameraposition:{valType:"info_array",editType:"camera"}}}},{"../../../lib":657,"../../../lib/extend":648,"../../domain":732,"./axis_attributes":749}],754:[function(e,t){'use strict';function a(){this.enabled=[!0,!0,!0],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.drawSides=[!0,!0,!0],this.lineWidth=[1,1,1]}var o=e("../../../lib/str2rgbarray"),r=["xaxis","yaxis","zaxis"],i=a.prototype;i.merge=function(e){for(var t=0,a;3>t;++t){if(a=e[r[t]],!a.visible){this.enabled[t]=!1,this.drawSides[t]=!1;continue}this.enabled[t]=a.showspikes,this.colors[t]=o(a.spikecolor),this.drawSides[t]=a.spikesides,this.lineWidth[t]=a.spikethickness}},t.exports=function(e){var t=new a;return t.merge(e),t}},{"../../../lib/str2rgbarray":680}],755:[function(e,t){'use strict';var o=Math.abs;function a(e){for(var t=[,,,],a=0;3>a;++a){for(var o=e[a],r=Array(o.length),n=0;n<o.length;++n)r[n]=o[n].x;t[a]=r}return t}t.exports=function(e){for(var t=e.axesOptions,s=e.glplot.axesPixels,d=e.fullSceneLayout,c=[[],[],[]],p=0,u;3>p;++p)if(u=d[n[p]],u._length=(s[p].hi-s[p].lo)*s[p].pixelsPerDataUnit/e.dataScale[p],o(u._length)===1/0||isNaN(u._length))c[p]=[];else{u._input_range=u.range.slice(),u.range[0]=s[p].lo/e.dataScale[p],u.range[1]=s[p].hi/e.dataScale[p],u._m=1/(e.dataScale[p]*s[p].pixelsPerDataUnit),u.range[0]===u.range[1]&&(u.range[0]-=1,u.range[1]+=1);var g=u.tickmode;if("auto"===u.tickmode){u.tickmode="linear";var m=u.nticks||i.constrain(u._length/40,4,9);r.autoTicks(u,o(u.range[1]-u.range[0])/m)}for(var h=r.calcTicks(u),y=0;y<h.length;++y)h[y].x*=e.dataScale[p],"date"===u.type&&(h[y].text=h[y].text.replace(/\<br\>/g," "));c[p]=h,u.tickmode=g}t.ticks=c;for(var p=0;3>p;++p){l[p]=.5*(e.glplot.bounds[0][p]+e.glplot.bounds[1][p]);for(var y=0;2>y;++y)t.bounds[y][p]=e.glplot.bounds[y][p]}e.contourLevels=a(c)};var r=e("../../cartesian/axes"),i=e("../../../lib"),n=["xaxis","yaxis","zaxis"],l=[0,0,0]},{"../../../lib":657,"../../cartesian/axes":705}],756:[function(e,t){'use strict';function a(e,t){var a=[0,0,0,0],o,r;for(o=0;4>o;++o)for(r=0;4>r;++r)a[r]+=e[4*o+r]*t[o];return a}t.exports=function(e,t){var o=a(e.projection,a(e.view,a(e.model,[t[0],t[1],t[2],1])));return o}},{}],757:[function(e,t){'use strict';var d=Math.sqrt,c=Math.min,p=Math.pow,u=Math.max;function a(e,t){var a=document.createElement("div"),o=e.container;this.graphDiv=e.graphDiv;var r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.style.position="absolute",r.style.top=r.style.left="0px",r.style.width=r.style.height="100%",r.style["z-index"]=20,r.style["pointer-events"]="none",a.appendChild(r),this.svgContainer=r,a.id=e.id,a.style.position="absolute",a.style.top=a.style.left="0px",a.style.width=a.style.height="100%",o.appendChild(a),this.fullLayout=t,this.id=e.id||"scene",this.fullSceneLayout=t[this.id],this.plotArgs=[[],{},{}],this.axesOptions=A(t,t[this.id]),this.spikeOptions=S(t[this.id]),this.container=a,this.staticMode=!!e.staticPlot,this.pixelRatio=this.pixelRatio||e.plotGlPixelRatio||2,this.dataScale=[1,1,1],this.contourLevels=[[],[],[]],this.convertAnnotations=x.getComponentMethod("annotations3d","convert"),this.drawAnnotations=x.getComponentMethod("annotations3d","draw"),this.initializeGLPlot()}function o(e,t,a){for(var o=e.fullSceneLayout,r=0;3>r;r++){var n=z[r],l=n.charAt(0),s=o[n],p=t[l],g=t[l+"calendar"],m=t["_"+l+"length"];if(!_.isArrayOrTypedArray(p))a[0][r]=c(a[0][r],0),a[1][r]=u(a[1][r],m-1);else for(var h=0,y;h<(m||p.length);h++)if(_.isArrayOrTypedArray(p[h]))for(var f=0;f<p[h].length;++f)y=s.d2l(p[h][f],0,g),!isNaN(y)&&isFinite(y)&&(a[0][r]=c(a[0][r],y),a[1][r]=u(a[1][r],y));else y=s.d2l(p[h],0,g),!isNaN(y)&&isFinite(y)&&(a[0][r]=c(a[0][r],y),a[1][r]=u(a[1][r],y))}}function r(e,t){for(var a=e.fullSceneLayout,o=a.annotations||[],r=0;3>r;r++)for(var i=z[r],n=i.charAt(0),l=a[i],s=0,p;s<o.length;s++)if(p=o[s],p.visible){var g=l.r2l(p[n]);!isNaN(g)&&isFinite(g)&&(t[0][r]=c(t[0][r],g),t[1][r]=u(t[1][r],g))}}function i(e){return[[e.eye.x,e.eye.y,e.eye.z],[e.center.x,e.center.y,e.center.z],[e.up.x,e.up.y,e.up.z]]}function n(e){return{up:{x:e.up[0],y:e.up[1],z:e.up[2]},center:{x:e.center[0],y:e.center[1],z:e.center[2]},eye:{x:e.eye[0],y:e.eye[1],z:e.eye[2]},projection:{type:!0===e._ortho?"orthographic":"perspective"}}}function l(e,t,o){for(var r=0,n=o-1;r<n;++r,--n)for(var l=0;l<t;++l)for(var s=0;4>s;++s){var d=4*(t*r+l)+s,a=4*(t*n+l)+s,c=e[d];e[d]=e[a],e[a]=c}}function s(e,t,o){for(var r=0;r<o;++r)for(var n=0;n<t;++n){var s=4*(t*r+n),d=e[s+3];if(0<d)for(var a=0;3>a;++a)e[s+a]=c(255/d*e[s+a],255)}}var g=e("gl-plot3d"),m=g.createCamera,h=g.createScene,y=e("webgl-context"),f=e("has-passive-events"),x=e("../../registry"),_=e("../../lib"),b=e("../../plots/cartesian/axes"),v=e("../../components/fx"),w=e("../../lib/str2rgbarray"),k=e("../../lib/show_no_webgl_msg"),T=e("./project"),A=e("./layout/convert"),S=e("./layout/spikes"),C=e("./layout/tick_marks"),L=e("is-mobile")({tablet:!0,featureDetect:!0}),E=a.prototype,I,P;E.prepareOptions=function(){var e=this,t={canvas:e.canvas,gl:e.gl,glOptions:{preserveDrawingBuffer:L,premultipliedAlpha:!0,antialias:!0},container:e.container,axes:e.axesOptions,spikes:e.spikeOptions,pickRadius:10,snapToData:!0,autoScale:!0,autoBounds:!1,cameraObject:e.camera,pixelRatio:e.pixelRatio};if(e.staticMode){if(!P&&(I=document.createElement("canvas"),P=y({canvas:I,preserveDrawingBuffer:!0,premultipliedAlpha:!0,antialias:!0}),!P))throw new Error("error creating static canvas/context for image server");t.gl=P,t.canvas=I}return t},E.tryCreatePlot=function(){var t=this,a=t.prepareOptions(),o=!0;try{t.glplot=h(a)}catch(r){if(t.staticMode)o=!1;else try{_.warn(["webgl setup failed possibly due to",L?"disabling":"enabling","preserveDrawingBuffer config.","The device may not be supported by is-mobile module!","Inverting preserveDrawingBuffer option in second attempt to create webgl scene."].join(" ")),L=a.glOptions.preserveDrawingBuffer=!a.glOptions.preserveDrawingBuffer,t.glplot=h(a)}catch(t){o=!1}}return o},E.initializeGLCamera=function(){var e=this,t=e.fullSceneLayout.camera,a="orthographic"===t.projection.type;e.camera=m(e.container,{center:[t.center.x,t.center.y,t.center.z],eye:[t.eye.x,t.eye.y,t.eye.z],up:[t.up.x,t.up.y,t.up.z],_ortho:a,zoomMin:.01,zoomMax:100,mode:"orbit"})},E.initializeGLPlot=function(){var t=this;t.initializeGLCamera();var a=t.tryCreatePlot();if(!a)return k(t);t.traces={},t.make4thDimension();var r=t.graphDiv,e=r.layout,o=function(){var a={};return t.isCameraChanged(e)&&(a[t.id+".camera"]=t.getCamera()),t.isAspectChanged(e)&&(a[t.id+".aspectratio"]=t.glplot.getAspectratio(),"manual"!==e[t.id].aspectmode&&(t.fullSceneLayout.aspectmode=e[t.id].aspectmode=a[t.id+".aspectmode"]="manual")),a},i=function(t){if(!1!==t.fullSceneLayout.dragmode){var a=o();t.saveLayout(e),t.graphDiv.emit("plotly_relayout",a)}};return t.glplot.canvas.addEventListener("mouseup",function(){i(t)}),t.glplot.canvas.addEventListener("wheel",function(a){if(r._context._scrollZoom.gl3d){if(t.camera._ortho){var e=a.deltaX>a.deltaY?1.1:1/1.1,n=t.glplot.getAspectratio();t.glplot.setAspectratio({x:e*n.x,y:e*n.y,z:e*n.z})}i(t)}},!!f&&{passive:!1}),t.glplot.canvas.addEventListener("mousemove",function(){if(!1!==t.fullSceneLayout.dragmode&&0!==t.camera.mouseListener.buttons){var e=o();t.graphDiv.emit("plotly_relayouting",e)}}),t.staticMode||t.glplot.canvas.addEventListener("webglcontextlost",function(e){r&&r.emit&&r.emit("plotly_webglcontextlost",{event:e,layer:t.id})},!1),t.glplot.oncontextloss=function(){t.recoverContext()},t.glplot.onrender=function(){t.render()},!0},E.render=function(){function e(e,a){var o=t.fullSceneLayout[e];return b.tickText(o,o.d2l(a),"hover").text}var t=this,a=t.graphDiv,o=t.svgContainer,r=t.container.getBoundingClientRect(),n=r.width,l=r.height,s;o.setAttributeNS(null,"viewBox","0 0 "+n+" "+l),o.setAttributeNS(null,"width",n),o.setAttributeNS(null,"height",l),C(t),t.glplot.axes.update(t.axesOptions);for(var d=Object.keys(t.traces),c=null,p=t.glplot.selection,u=0;u<d.length;++u)s=t.traces[d[u]],"skip"!==s.data.hoverinfo&&s.handlePick(p)&&(c=s),s.setContourLevels&&s.setContourLevels();var g;if(null!==c){var m=T(t.glplot.cameraParams,p.dataCoordinate);s=c.data;var h=a._fullData[s.index],y=p.index,f={xLabel:e("xaxis",p.traceCoordinate[0]),yLabel:e("yaxis",p.traceCoordinate[1]),zLabel:e("zaxis",p.traceCoordinate[2])},x=v.castHoverinfo(h,t.fullLayout,y),w=(x||"").split("+"),k=x&&"all"===x;h.hovertemplate||k||(-1===w.indexOf("x")&&(f.xLabel=void 0),-1===w.indexOf("y")&&(f.yLabel=void 0),-1===w.indexOf("z")&&(f.zLabel=void 0),-1===w.indexOf("text")&&(p.textLabel=void 0),-1===w.indexOf("name")&&(c.name=void 0));var A=[],S;"cone"===s.type||"streamtube"===s.type?(f.uLabel=e("xaxis",p.traceCoordinate[3]),(k||-1!==w.indexOf("u"))&&A.push("u: "+f.uLabel),f.vLabel=e("yaxis",p.traceCoordinate[4]),(k||-1!==w.indexOf("v"))&&A.push("v: "+f.vLabel),f.wLabel=e("zaxis",p.traceCoordinate[5]),(k||-1!==w.indexOf("w"))&&A.push("w: "+f.wLabel),f.normLabel=p.traceCoordinate[6].toPrecision(3),(k||-1!==w.indexOf("norm"))&&A.push("norm: "+f.normLabel),"streamtube"===s.type&&(f.divergenceLabel=p.traceCoordinate[7].toPrecision(3),(k||-1!==w.indexOf("divergence"))&&A.push("divergence: "+f.divergenceLabel)),p.textLabel&&A.push(p.textLabel),S=A.join("<br>")):"isosurface"===s.type||"volume"===s.type?(f.valueLabel=b.tickText(t._mockAxis,t._mockAxis.d2l(p.traceCoordinate[3]),"hover").text,A.push("value: "+f.valueLabel),p.textLabel&&A.push(p.textLabel),S=A.join("<br>")):S=p.textLabel;var L={x:p.traceCoordinate[0],y:p.traceCoordinate[1],z:p.traceCoordinate[2],data:h._input,fullData:h,curveNumber:h.index,pointNumber:y};v.appendArrayPointValue(L,h,y),s._module.eventData&&(L=h._module.eventData(L,p,h,{},y));var E={points:[L]};t.fullSceneLayout.hovermode&&v.loneHover({trace:h,x:(.5+.5*m[0]/m[3])*n,y:(.5-.5*m[1]/m[3])*l,xLabel:f.xLabel,yLabel:f.yLabel,zLabel:f.zLabel,text:S,name:c.name,color:v.castHoverOption(h,y,"bgcolor")||c.color,borderColor:v.castHoverOption(h,y,"bordercolor"),fontFamily:v.castHoverOption(h,y,"font.family"),fontSize:v.castHoverOption(h,y,"font.size"),fontColor:v.castHoverOption(h,y,"font.color"),nameLength:v.castHoverOption(h,y,"namelength"),textAlign:v.castHoverOption(h,y,"align"),hovertemplate:_.castOption(h,y,"hovertemplate"),hovertemplateLabels:_.extendFlat({},L,f),eventData:[L]},{container:o,gd:a}),p.buttons&&5>p.distance?a.emit("plotly_click",E):a.emit("plotly_hover",E),g=E}else v.loneUnhover(o),a.emit("plotly_unhover",g);t.drawAnnotations(t)},E.recoverContext=function(){var e=this;e.glplot.dispose();var t=function(){return e.glplot.gl.isContextLost()?void requestAnimationFrame(t):e.initializeGLPlot()?void e.plot.apply(e,e.plotArgs):void _.error("Catastrophic and unrecoverable WebGL error. Context lost.")};requestAnimationFrame(t)};var z=["xaxis","yaxis","zaxis"];E.plot=function(e,t,a){var n=this;if(n.plotArgs=[e,t,a],!n.glplot.contextLost){var l=t[n.id],s=a[n.id],g,m,h,y,f,x;n.fullLayout=t,n.fullSceneLayout=l,n.axesOptions.merge(t,l),n.spikeOptions.merge(l),n.setViewport(l),n.updateFx(l.dragmode,l.hovermode),n.camera.enableWheel=n.graphDiv._context._scrollZoom.gl3d,n.glplot.setClearColor(w(l.bgcolor)),n.setConvert(f),e?!Array.isArray(e)&&(e=[e]):e=[];var _=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]];for(h=0;h<e.length;++h)g=e[h],!0!==g.visible||0===g._length||o(this,g,_);r(this,_);var b=[1,1,1];for(y=0;3>y;++y)b[y]=_[1][y]===_[0][y]?1:1/(_[1][y]-_[0][y]);for(n.dataScale=b,n.convertAnnotations(this),h=0;h<e.length;++h)(g=e[h],!0===g.visible&&0!==g._length)&&(m=n.traces[g.uid],m?m.data.type===g.type?m.update(g):(m.dispose(),m=g._module.plot(this,g),n.traces[g.uid]=m):(m=g._module.plot(this,g),n.traces[g.uid]=m),m.name=g.name);var v=Object.keys(n.traces);traceIdLoop:for(h=0;h<v.length;++h){for(y=0;y<e.length;++y)if(e[y].uid===v[h]&&!0===e[y].visible&&0!==e[y]._length)continue traceIdLoop;m=n.traces[v[h]],m.dispose(),delete n.traces[v[h]]}n.glplot.objects.sort(function(e,t){return e._trace.data.index-t._trace.data.index});var k=[[0,0,0],[0,0,0]],T=[],A={};for(h=0;3>h;++h){if(f=l[z[h]],x=f.type,x in A?(A[x].acc*=b[h],A[x].count+=1):A[x]={acc:b[h],count:1},f.autorange){k[0][h]=1/0,k[1][h]=-Infinity;var S=n.glplot.objects,C=n.fullSceneLayout.annotations||[],L=f._name.charAt(0);for(y=0;y<S.length;y++){var E=S[y],I=E.bounds,P=E._trace.data._pad||0;k[0][h]="ErrorBars"===E.constructor.name&&f._lowerLogErrorBound?c(k[0][h],f._lowerLogErrorBound):c(k[0][h],I[0][h]/b[h]-P),k[1][h]=u(k[1][h],I[1][h]/b[h]+P)}for(y=0;y<C.length;y++){var D=C[y];if(D.visible){var O=f.r2l(D[L]);k[0][h]=c(k[0][h],O),k[1][h]=u(k[1][h],O)}}if("rangemode"in f&&"tozero"===f.rangemode&&(k[0][h]=c(k[0][h],0),k[1][h]=u(k[1][h],0)),k[0][h]>k[1][h])k[0][h]=-1,k[1][h]=1;else{var R=k[1][h]-k[0][h];k[0][h]-=R/32,k[1][h]+=R/32}if("reversed"===f.autorange){var d=k[0][h];k[0][h]=k[1][h],k[1][h]=d}}else{var M=f.range;k[0][h]=f.r2l(M[0]),k[1][h]=f.r2l(M[1])}k[0][h]===k[1][h]&&(k[0][h]-=1,k[1][h]+=1),T[h]=k[1][h]-k[0][h],n.glplot.setBounds(h,{min:k[0][h]*b[h],max:k[1][h]*b[h]})}var B=l.aspectmode,F;if("cube"===B)F=[1,1,1];else if("manual"===B){var N=l.aspectratio;F=[N.x,N.y,N.z]}else if("auto"===B||"data"===B){var V=[1,1,1];for(h=0;3>h;++h){f=l[z[h]],x=f.type;var U=A[x];V[h]=p(U.acc,1/U.count)/b[h]}F="data"===B?V:4>=u.apply(null,V)/c.apply(null,V)?V:[1,1,1]}else throw new Error("scene.js aspectRatio was not one of the enumerated types");l.aspectratio.x=s.aspectratio.x=F[0],l.aspectratio.y=s.aspectratio.y=F[1],l.aspectratio.z=s.aspectratio.z=F[2],n.glplot.setAspectratio(l.aspectratio),n.viewInitial.aspectratio||(n.viewInitial.aspectratio={x:l.aspectratio.x,y:l.aspectratio.y,z:l.aspectratio.z}),n.viewInitial.aspectmode||(n.viewInitial.aspectmode=l.aspectmode);var H=l.domain||null,q=t._size||null;if(H&&q){var G=n.container.style;G.position="absolute",G.left=q.l+H.x[0]*q.w+"px",G.top=q.t+(1-H.y[1])*q.h+"px",G.width=q.w*(H.x[1]-H.x[0])+"px",G.height=q.h*(H.y[1]-H.y[0])+"px"}n.glplot.redraw()}},E.destroy=function(){var e=this;e.glplot&&(e.camera.mouseListener.enabled=!1,e.container.removeEventListener("wheel",e.camera.wheelListener),e.camera=null,e.glplot.dispose(),e.container.parentNode.removeChild(e.container),e.glplot=null)},E.getCamera=function(){var e=this;return e.camera.view.recalcMatrix(e.camera.view.lastT()),n(e.camera)},E.setViewport=function(e){var t=this,a=e.camera;t.camera.lookAt.apply(this,i(a)),t.glplot.setAspectratio(e.aspectratio);var o="orthographic"===a.projection.type,r=t.camera._ortho;o!==r&&(t.glplot.redraw(),t.glplot.clearRGBA(),t.glplot.dispose(),t.initializeGLPlot())},E.isCameraChanged=function(e){function t(e,t,a,o){var r=["up","center","eye"],i=["x","y","z"];return t[r[a]]&&e[r[a]][i[o]]===t[r[a]][i[o]]}var a=this,o=a.getCamera(),r=_.nestedProperty(e,a.id+".camera"),n=r.get(),l=!1;if(n===void 0)l=!0;else{for(var s=0;3>s;s++)for(var d=0;3>d;d++)if(!t(o,n,s,d)){l=!0;break}(!n.projection||o.projection&&o.projection.type!==n.projection.type)&&(l=!0)}return l},E.isAspectChanged=function(e){var t=this,a=t.glplot.getAspectratio(),o=_.nestedProperty(e,t.id+".aspectratio"),r=o.get();return r===void 0||r.x!==a.x||r.y!==a.y||r.z!==a.z},E.saveLayout=function(e){var t=this,a=t.fullLayout,o=t.isCameraChanged(e),r=t.isAspectChanged(e),i=o||r,n,l,s,d,c,p;if(i){var u={};if(o&&(n=t.getCamera(),l=_.nestedProperty(e,t.id+".camera"),s=l.get(),u[t.id+".camera"]=s),r&&(d=t.glplot.getAspectratio(),c=_.nestedProperty(e,t.id+".aspectratio"),p=c.get(),u[t.id+".aspectratio"]=p),x.call("_storeDirectGUIEdit",e,a._preGUI,u),o){l.set(n);var g=_.nestedProperty(a,t.id+".camera");g.set(n)}if(r){c.set(d);var m=_.nestedProperty(a,t.id+".aspectratio");m.set(d),t.glplot.redraw()}}return i},E.updateFx=function(e,t){var a=this,o=a.camera;if(o)if("orbit"===e)o.mode="orbit",o.keyBindingMode="rotate";else if("turntable"===e){o.up=[0,0,1],o.mode="turntable",o.keyBindingMode="rotate";var r=a.graphDiv,i=r._fullLayout,n=a.fullSceneLayout.camera,l=n.up.x,s=n.up.y,c=n.up.z;if(.999>c/d(l*l+s*s+c*c)){var p=a.id+".camera.up",u={x:0,y:0,z:1},g={};g[p]=u;var m=r.layout;x.call("_storeDirectGUIEdit",m,i._preGUI,g),n.up=u,_.nestedProperty(m,p).set(u)}}else o.keyBindingMode=e;a.fullSceneLayout.hovermode=t},E.toImage=function(e){var t=this;e||(e="png"),t.staticMode&&t.container.appendChild(I),t.glplot.redraw();var a=t.glplot.gl,o=a.drawingBufferWidth,r=a.drawingBufferHeight;a.bindFramebuffer(a.FRAMEBUFFER,null);var i=new Uint8Array(4*(o*r));a.readPixels(0,0,o,r,a.RGBA,a.UNSIGNED_BYTE,i),l(i,o,r),s(i,o,r);var n=document.createElement("canvas");n.width=o,n.height=r;var d=n.getContext("2d"),c=d.createImageData(o,r);c.data.set(i),d.putImageData(c,0,0);var p;return p="jpeg"===e?n.toDataURL("image/jpeg"):"webp"===e?n.toDataURL("image/webp"):n.toDataURL("image/png"),t.staticMode&&t.container.removeChild(I),p},E.setConvert=function(){for(var e=this,t=0,a;3>t;t++)a=e.fullSceneLayout[z[t]],b.setConvert(a,e.fullLayout),a.setScale=_.noop},E.make4thDimension=function(){var e=this,t=e.graphDiv,a=t._fullLayout;e._mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},b.setConvert(e._mockAxis,a)},t.exports=a},{"../../components/fx":564,"../../lib":657,"../../lib/show_no_webgl_msg":678,"../../lib/str2rgbarray":680,"../../plots/cartesian/axes":705,"../../registry":788,"./layout/convert":751,"./layout/spikes":754,"./layout/tick_marks":755,"./project":756,"gl-plot3d":266,"has-passive-events":380,"is-mobile":389,"webgl-context":1394}],758:[function(e,t){'use strict';t.exports=function(e,t,a,o){o=o||e.length;for(var r=Array(o),n=0;n<o;n++)r[n]=[e[n],t[n],a[n]];return r}},{}],759:[function(e,t){'use strict';var a=e("./font_attributes"),o=e("./animation_attributes"),r=e("../components/color/attributes"),i=e("../components/shapes/draw_newshape/attributes"),n=e("./pad_attributes"),l=e("../lib/extend").extendFlat,s=a({editType:"calc"});s.family.dflt="\"Open Sans\", verdana, arial, sans-serif",s.size.dflt=12,s.color.dflt=r.defaultLine,t.exports={font:s,title:{text:{valType:"string",editType:"layoutstyle"},font:a({editType:"layoutstyle"}),xref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},yref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},x:{valType:"number",min:0,max:1,dflt:.5,editType:"layoutstyle"},y:{valType:"number",min:0,max:1,dflt:"auto",editType:"layoutstyle"},xanchor:{valType:"enumerated",dflt:"auto",values:["auto","left","center","right"],editType:"layoutstyle"},yanchor:{valType:"enumerated",dflt:"auto",values:["auto","top","middle","bottom"],editType:"layoutstyle"},pad:l(n({editType:"layoutstyle"}),{}),editType:"layoutstyle"},uniformtext:{mode:{valType:"enumerated",values:[!1,"hide","show"],dflt:!1,editType:"plot"},minsize:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"},autosize:{valType:"boolean",dflt:!1,editType:"none"},width:{valType:"number",min:10,dflt:700,editType:"plot"},height:{valType:"number",min:10,dflt:450,editType:"plot"},margin:{l:{valType:"number",min:0,dflt:80,editType:"plot"},r:{valType:"number",min:0,dflt:80,editType:"plot"},t:{valType:"number",min:0,dflt:100,editType:"plot"},b:{valType:"number",min:0,dflt:80,editType:"plot"},pad:{valType:"number",min:0,dflt:0,editType:"plot"},autoexpand:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},paper_bgcolor:{valType:"color",dflt:r.background,editType:"plot"},plot_bgcolor:{valType:"color",dflt:r.background,editType:"layoutstyle"},separators:{valType:"string",editType:"plot"},hidesources:{valType:"boolean",dflt:!1,editType:"plot"},showlegend:{valType:"boolean",editType:"legend"},colorway:{valType:"colorlist",dflt:r.defaults,editType:"calc"},datarevision:{valType:"any",editType:"calc"},uirevision:{valType:"any",editType:"none"},editrevision:{valType:"any",editType:"none"},selectionrevision:{valType:"any",editType:"none"},template:{valType:"any",editType:"calc"},modebar:{orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"modebar"},bgcolor:{valType:"color",editType:"modebar"},color:{valType:"color",editType:"modebar"},activecolor:{valType:"color",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"modebar"},newshape:i.newshape,activeshape:i.activeshape,meta:{valType:"any",arrayOk:!0,editType:"plot"},transition:l({},o.transition,{editType:"none"}),_deprecated:{title:{valType:"string",editType:"layoutstyle"},titlefont:a({editType:"layoutstyle"})}}},{"../components/color/attributes":523,"../components/shapes/draw_newshape/attributes":606,"../lib/extend":648,"./animation_attributes":700,"./font_attributes":733,"./pad_attributes":767}],760:[function(e,t){'use strict';var a={"open-street-map":{id:"osm",version:8,sources:{"plotly-osm-tiles":{type:"raster",attribution:"<a href=\"http://www.openstreetmap.org/about/\" target=\"_blank\">\xA9 OpenStreetMap</a>",tiles:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png","https://b.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-osm-tiles",type:"raster",source:"plotly-osm-tiles",minzoom:0,maxzoom:22}]},"white-bg":{id:"white-bg",version:8,sources:{},layers:[{id:"white-bg",type:"background",paint:{"background-color":"#FFFFFF"},minzoom:0,maxzoom:22}]},"carto-positron":{id:"carto-positron",version:8,sources:{"plotly-carto-positron":{type:"raster",attribution:"<a href=\"https://carto.com/\" target=\"_blank\">\xA9 CARTO</a>",tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-positron",type:"raster",source:"plotly-carto-positron",minzoom:0,maxzoom:22}]},"carto-darkmatter":{id:"carto-darkmatter",version:8,sources:{"plotly-carto-darkmatter":{type:"raster",attribution:"<a href=\"https://carto.com/\" target=\"_blank\">\xA9 CARTO</a>",tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-darkmatter",type:"raster",source:"plotly-carto-darkmatter",minzoom:0,maxzoom:22}]},"stamen-terrain":{id:"stamen-terrain",version:8,sources:{"plotly-stamen-terrain":{type:"raster",attribution:"Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>, under <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a> | Data by <a href=\"http://openstreetmap.org\">OpenStreetMap</a>, under <a href=\"http://www.openstreetmap.org/copyright\">ODbL</a>.",tiles:["https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-terrain",type:"raster",source:"plotly-stamen-terrain",minzoom:0,maxzoom:22}]},"stamen-toner":{id:"stamen-toner",version:8,sources:{"plotly-stamen-toner":{type:"raster",attribution:"Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>, under <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a> | Data by <a href=\"http://openstreetmap.org\">OpenStreetMap</a>, under <a href=\"http://www.openstreetmap.org/copyright\">ODbL</a>.",tiles:["https://stamen-tiles.a.ssl.fastly.net/toner/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-toner",type:"raster",source:"plotly-stamen-toner",minzoom:0,maxzoom:22}]},"stamen-watercolor":{id:"stamen-watercolor",version:8,sources:{"plotly-stamen-watercolor":{type:"raster",attribution:"Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>, under <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a> | Data by <a href=\"http://openstreetmap.org\">OpenStreetMap</a>, under <a href=\"http://creativecommons.org/licenses/by-sa/3.0\">CC BY SA</a>.",tiles:["https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-watercolor",type:"raster",source:"plotly-stamen-watercolor",minzoom:0,maxzoom:22}]}},o=Object.keys(a);t.exports={requiredVersion:"1.10.0",styleUrlPrefix:"mapbox://styles/mapbox/",styleUrlSuffix:"v9",styleValuesMapbox:["basic","streets","outdoors","light","dark","satellite","satellite-streets"],styleValueDflt:"basic",stylesNonMapbox:a,styleValuesNonMapbox:o,traceLayerPrefix:"plotly-trace-layer-",layoutLayerPrefix:"plotly-layout-layer-",wrongVersionErrorMsg:"Your custom plotly.js bundle is not using the correct mapbox-gl version\nPlease install mapbox-gl@1.10.0.",noAccessTokenErrorMsg:"Missing Mapbox access token.\nMapbox trace type require a Mapbox access token to be registered.\nFor example:\n  Plotly.plot(gd, data, layout, { mapboxAccessToken: 'my-access-token' });\nMore info here: https://www.mapbox.com/help/define-access-token/",missingStyleErrorMsg:["No valid mapbox style found, please set `mapbox.style` to one of:",o.join(", "),"or register a Mapbox access token to use a Mapbox-served style."].join("\n"),multipleTokensErrorMsg:"Set multiple mapbox access token across different mapbox subplot,\nusing first token found as mapbox-gl does not allow multipleaccess tokens on the same page.",mapOnErrorMsg:"Mapbox error.",mapboxLogo:{path0:"m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z",path1:"M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z",path2:"M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z",polygon:"11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34"},styleRules:{map:"overflow:hidden;position:relative;","missing-css":"display:none;",canary:"background-color:salmon;","ctrl-bottom-left":"position: absolute; pointer-events: none; z-index: 2; bottom: 0; left: 0;","ctrl-bottom-right":"position: absolute; pointer-events: none; z-index: 2; right: 0; bottom: 0;",ctrl:"clear: both; pointer-events: auto; transform: translate(0, 0);","ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner":"display: none;","ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner":"display: block; margin-top:2px","ctrl-attrib.mapboxgl-compact:hover":"padding: 2px 24px 2px 4px; visibility: visible; margin-top: 6px;","ctrl-attrib.mapboxgl-compact::after":"content: \"\"; cursor: pointer; position: absolute; background-image: url('data:image/svg+xml;charset=utf-8,%3Csvg viewBox=\"0 0 20 20\" xmlns=\"http://www.w3.org/2000/svg\"%3E %3Cpath fill=\"%23333333\" fill-rule=\"evenodd\" d=\"M4,10a6,6 0 1,0 12,0a6,6 0 1,0 -12,0 M9,7a1,1 0 1,0 2,0a1,1 0 1,0 -2,0 M9,10a1,1 0 1,1 2,0l0,3a1,1 0 1,1 -2,0\"/%3E %3C/svg%3E'); background-color: rgba(255, 255, 255, 0.5); width: 24px; height: 24px; box-sizing: border-box; border-radius: 12px;","ctrl-attrib.mapboxgl-compact":"min-height: 20px; padding: 0; margin: 10px; position: relative; background-color: #fff; border-radius: 3px 12px 12px 3px;","ctrl-bottom-right > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; right: 0","ctrl-bottom-left > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; left: 0","ctrl-bottom-left .mapboxgl-ctrl":"margin: 0 0 10px 10px; float: left;","ctrl-bottom-right .mapboxgl-ctrl":"margin: 0 10px 10px 0; float: right;","ctrl-attrib":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a:hover":"color: inherit; text-decoration: underline;","ctrl-attrib .mapbox-improve-map":"font-weight: bold; margin-left: 2px;","attrib-empty":"display: none;","ctrl-logo":"display:block; width: 21px; height: 21px; background-image: url('data:image/svg+xml;charset=utf-8,%3C?xml version=\"1.0\" encoding=\"utf-8\"?%3E %3Csvg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 21 21\" style=\"enable-background:new 0 0 21 21;\" xml:space=\"preserve\"%3E%3Cg transform=\"translate(0,0.01)\"%3E%3Cpath d=\"m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z\" style=\"opacity:0.9;fill:%23ffffff;enable-background:new\" class=\"st0\"/%3E%3Cpath d=\"M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z\" style=\"opacity:0.35;enable-background:new\" class=\"st1\"/%3E%3Cpath d=\"M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z\" style=\"opacity:0.35;enable-background:new\" class=\"st1\"/%3E%3Cpolygon points=\"11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34 \" style=\"opacity:0.9;fill:%23ffffff;enable-background:new\" class=\"st0\"/%3E%3C/g%3E%3C/svg%3E')"}}},{}],761:[function(e,t){'use strict';var a=e("../../lib");t.exports=function(e,t){var o=e.split(" "),r=o[0],i=o[1],n=a.isArrayOrTypedArray(t)?a.mean(t):t,l=.5+n/100,s=1.5+n/100,d=["",""],c=[0,0];"top"===r?(d[0]="top",c[1]=-s):"bottom"===r?(d[0]="bottom",c[1]=s):void 0,"left"===i?(d[1]="right",c[0]=-l):"right"===i?(d[1]="left",c[0]=l):void 0;var p;return p=d[0]&&d[1]?d.join("-"):d[0]?d[0]:d[1]?d[1]:"center",{anchor:p,offset:c}}},{"../../lib":657}],762:[function(e,t,a){'use strict';function o(e,t){var a=e._fullLayout,o=e._context;if(""===o.mapboxAccessToken)return"";for(var n=[],s=[],d=!1,c=!1,p=0;p<t.length;p++){var u=a[t[p]],g=u.accesstoken;r(u.style)&&(g?l.pushUnique(n,g):(r(u._input.style)&&(l.error("Uses Mapbox map style, but did not set an access token."),d=!0),c=!0)),g&&l.pushUnique(s,g)}if(c){var m=d?h.noAccessTokenErrorMsg:h.missingStyleErrorMsg;throw l.error(m),new Error(m)}return n.length?(1<n.length&&l.warn(h.multipleTokensErrorMsg),n[0]):(s.length&&l.log(["Listed mapbox access token(s)",s.join(","),"but did not use a Mapbox map style, ignoring token(s)."].join(" ")),"")}function r(e){return"string"==typeof e&&(-1!==h.styleValuesMapbox.indexOf(e)||0===e.indexOf("mapbox://"))}var n=e("mapbox-gl"),l=e("../../lib"),s=e("../../plots/get_data").getSubplotCalcData,d=e("../../constants/xmlns_namespaces"),c=e("d3"),p=e("../../components/drawing"),u=e("../../lib/svg_text_utils"),g=e("./mapbox"),m="mapbox",h=a.constants=e("./constants");a.name=m,a.attr="subplot",a.idRoot=m,a.idRegex=a.attrRegex=l.counterRegex(m),a.attributes={subplot:{valType:"subplotid",dflt:"mapbox",editType:"calc"}},a.layoutAttributes=e("./layout_attributes"),a.supplyLayoutDefaults=e("./layout_defaults"),a.plot=function(e){var t=e._fullLayout,a=e.calcdata,r=t._subplots[m];if(n.version!==h.requiredVersion)throw new Error(h.wrongVersionErrorMsg);var d=o(e,r);n.accessToken=d;for(var c=0;c<r.length;c++){var p=r[c],u=s(a,m,p),y=t[p],f=y._subplot;f||(f=new g(e,p),t[p]._subplot=f),f.viewInitial||(f.viewInitial={center:l.extendFlat({},y.center),zoom:y.zoom,bearing:y.bearing,pitch:y.pitch}),f.plot(u,t,e._promises)}},a.clean=function(e,t,a,o){for(var r=o._subplots[m]||[],n=0,l;n<r.length;n++)l=r[n],t[l]||!o[l]._subplot||o[l]._subplot.destroy()},a.toSVG=function(e){for(var t=e._fullLayout,a=t._subplots[m],o=t._size,r=0;r<a.length;r++){var n=t[a[r]],l=n.domain,s=n._subplot,g=s.toImage("png"),y=t._glimages.append("svg:image");y.attr({xmlns:d.svg,"xlink:href":g,x:o.l+o.w*l.x[0],y:o.t+o.h*(1-l.y[1]),width:o.w*(l.x[1]-l.x[0]),height:o.h*(l.y[1]-l.y[0]),preserveAspectRatio:"none"});var f=c.select(n._subplot.div),x=null===f.select(".mapboxgl-ctrl-logo").node().offsetParent;if(!x){var _=t._glimages.append("g");_.attr("transform","translate("+(o.l+o.w*l.x[0]+10)+", "+(o.t+o.h*(1-l.y[0])-31)+")"),_.append("path").attr("d",h.mapboxLogo.path0).style({opacity:.9,fill:"#ffffff","enable-background":"new"}),_.append("path").attr("d",h.mapboxLogo.path1).style("opacity",.35).style("enable-background","new"),_.append("path").attr("d",h.mapboxLogo.path2).style("opacity",.35).style("enable-background","new"),_.append("polygon").attr("points",h.mapboxLogo.polygon).style({opacity:.9,fill:"#ffffff","enable-background":"new"})}var b=f.select(".mapboxgl-ctrl-attrib").text().replace("Improve this map",""),v=t._glimages.append("g"),w=v.append("text");w.text(b).classed("static-attribution",!0).attr({"font-size":12,"font-family":"Arial",color:"rgba(0, 0, 0, 0.75)","text-anchor":"end","data-unformatted":b});var k=p.bBox(w.node()),T=o.w*(l.x[1]-l.x[0]);if(k.width>T/2){var A=b.split("|").join("<br>");w.text(A).attr("data-unformatted",A).call(u.convertToTspans,e),k=p.bBox(w.node())}w.attr("transform","translate(-3, "+(-k.height+8)+")"),v.insert("rect",".static-attribution").attr({x:-k.width-6,y:-k.height-3,width:k.width+6,height:k.height+3,fill:"rgba(255, 255, 255, 0.75)"});var S=1;k.width+6>T&&(S=T/(k.width+6));var C=[o.l+o.w*l.x[1],o.t+o.h*(1-l.y[0])];v.attr("transform","translate("+C[0]+","+C[1]+") scale("+S+")")}},a.updateFx=function(e){for(var t=e._fullLayout,a=t._subplots[m],o=0,r;o<a.length;o++)r=t[a[o]]._subplot,r.updateFx(t)}},{"../../components/drawing":546,"../../constants/xmlns_namespaces":634,"../../lib":657,"../../lib/svg_text_utils":681,"../../plots/get_data":742,"./constants":760,"./layout_attributes":764,"./layout_defaults":765,"./mapbox":766,d3:108,"mapbox-gl":396}],763:[function(e,t){'use strict';function a(e,t){this.subplot=e,this.uid=e.uid+"-"+t,this.index=t,this.idSource="source-"+this.uid,this.idLayer=d.layoutLayerPrefix+this.uid,this.sourceType=null,this.source=null,this.layerType=null,this.below=null,this.visible=!1}function o(e){if(!e.visible)return!1;var t=e.source;if(Array.isArray(t)&&0<t.length){for(var a=0;a<t.length;a++)if("string"!=typeof t[a]||0===t[a].length)return!1;return!0}return n.isPlainObject(t)||"string"==typeof t&&0<t.length}function r(e){var t={},a={};switch(e.type){case"circle":n.extendFlat(a,{"circle-radius":e.circle.radius,"circle-color":e.color,"circle-opacity":e.opacity});break;case"line":n.extendFlat(a,{"line-width":e.line.width,"line-color":e.color,"line-opacity":e.opacity,"line-dasharray":e.line.dash});break;case"fill":n.extendFlat(a,{"fill-color":e.color,"fill-outline-color":e.fill.outlinecolor,"fill-opacity":e.opacity});break;case"symbol":var o=e.symbol,r=s(o.textposition,o.iconsize);n.extendFlat(t,{"icon-image":o.icon+"-15","icon-size":o.iconsize/10,"text-field":o.text,"text-size":o.textfont.size,"text-anchor":r.anchor,"text-offset":r.offset,"symbol-placement":o.placement}),n.extendFlat(a,{"icon-color":e.color,"text-color":o.textfont.color,"text-opacity":e.opacity});break;case"raster":n.extendFlat(a,{"raster-fade-duration":0,"raster-opacity":e.opacity});}return{layout:t,paint:a}}function i(e){var t=e.sourcetype,a=e.source,o={type:t},r;return"geojson"===t?r="data":"vector"===t?r="string"==typeof a?"url":"tiles":"raster"===t?(r="tiles",o.tileSize=256):"image"===t&&(r="url",o.coordinates=e.coordinates),o[r]=a,e.sourceattribution&&(o.attribution=l(e.sourceattribution)),o}var n=e("../../lib"),l=e("../../lib/svg_text_utils").sanitizeHTML,s=e("./convert_text_opts"),d=e("./constants"),c=a.prototype;c.update=function(e){this.visible?this.needsNewImage(e)?this.updateImage(e):this.needsNewSource(e)?(this.removeLayer(),this.updateSource(e),this.updateLayer(e)):this.needsNewLayer(e)?this.updateLayer(e):this.updateStyle(e):(this.updateSource(e),this.updateLayer(e)),this.visible=o(e)},c.needsNewImage=function(e){var t=this.subplot.map;return t.getSource(this.idSource)&&"image"===this.sourceType&&"image"===e.sourcetype&&(this.source!==e.source||JSON.stringify(this.coordinates)!==JSON.stringify(e.coordinates))},c.needsNewSource=function(e){return this.sourceType!==e.sourcetype||this.source!==e.source||this.layerType!==e.type},c.needsNewLayer=function(e){return this.layerType!==e.type||this.below!==this.subplot.belowLookup["layout-"+this.index]},c.updateImage=function(e){var t=this.subplot.map;t.getSource(this.idSource).updateImage({url:e.source,coordinates:e.coordinates})},c.updateSource=function(e){var t=this.subplot.map;if(t.getSource(this.idSource)&&t.removeSource(this.idSource),this.sourceType=e.sourcetype,this.source=e.source,!!o(e)){var a=i(e);t.addSource(this.idSource,a)}},c.updateLayer=function(e){var t=this.subplot,a=r(e),n=this.subplot.belowLookup["layout-"+this.index],l;if("traces"===n){for(var s=t.getMapLayers(),c=0,p;c<s.length;c++)if(p=s[c].id,"string"==typeof p&&0===p.indexOf(d.traceLayerPrefix)){l=p;break}}else l=n;this.removeLayer(),o(e)&&t.addLayer({id:this.idLayer,source:this.idSource,"source-layer":e.sourcelayer||"",type:e.type,minzoom:e.minzoom,maxzoom:e.maxzoom,layout:a.layout,paint:a.paint},l),this.layerType=e.type,this.below=n},c.updateStyle=function(e){if(o(e)){var t=r(e);this.subplot.setOptions(this.idLayer,"setLayoutProperty",t.layout),this.subplot.setOptions(this.idLayer,"setPaintProperty",t.paint)}},c.removeLayer=function(){var e=this.subplot.map;e.getLayer(this.idLayer)&&e.removeLayer(this.idLayer)},c.dispose=function(){var e=this.subplot.map;e.getLayer(this.idLayer)&&e.removeLayer(this.idLayer),e.getSource(this.idSource)&&e.removeSource(this.idSource)},t.exports=function(e,t,o){var r=new a(e,t);return r.update(o),r}},{"../../lib":657,"../../lib/svg_text_utils":681,"./constants":760,"./convert_text_opts":761}],764:[function(e,t){'use strict';var a=e("../../lib"),o=e("../../components/color").defaultLine,r=e("../domain").attributes,i=e("../font_attributes"),n=e("../../traces/scatter/attributes").textposition,l=e("../../plot_api/edit_types").overrideAll,s=e("../../plot_api/plot_template").templatedArray,d=e("./constants"),c=i({});c.family.dflt="Open Sans Regular, Arial Unicode MS Regular";var p=t.exports=l({_arrayAttrRegexps:[a.counterRegex("mapbox",".layers",!0)],domain:r({name:"mapbox"}),accesstoken:{valType:"string",noBlank:!0,strict:!0},style:{valType:"any",values:d.styleValuesMapbox.concat(d.styleValuesNonMapbox),dflt:d.styleValueDflt},center:{lon:{valType:"number",dflt:0},lat:{valType:"number",dflt:0}},zoom:{valType:"number",dflt:1},bearing:{valType:"number",dflt:0},pitch:{valType:"number",dflt:0},layers:s("layer",{visible:{valType:"boolean",dflt:!0},sourcetype:{valType:"enumerated",values:["geojson","vector","raster","image"],dflt:"geojson"},source:{valType:"any"},sourcelayer:{valType:"string",dflt:""},sourceattribution:{valType:"string"},type:{valType:"enumerated",values:["circle","line","fill","symbol","raster"],dflt:"circle"},coordinates:{valType:"any"},below:{valType:"string"},color:{valType:"color",dflt:o},opacity:{valType:"number",min:0,max:1,dflt:1},minzoom:{valType:"number",min:0,max:24,dflt:0},maxzoom:{valType:"number",min:0,max:24,dflt:24},circle:{radius:{valType:"number",dflt:15}},line:{width:{valType:"number",dflt:2},dash:{valType:"data_array"}},fill:{outlinecolor:{valType:"color",dflt:o}},symbol:{icon:{valType:"string",dflt:"marker"},iconsize:{valType:"number",dflt:10},text:{valType:"string",dflt:""},placement:{valType:"enumerated",values:["point","line","line-center"],dflt:"point"},textfont:c,textposition:a.extendFlat({},n,{arrayOk:!1})}})},"plot","from-root");p.uirevision={valType:"any",editType:"none"}},{"../../components/color":524,"../../lib":657,"../../plot_api/edit_types":688,"../../plot_api/plot_template":695,"../../traces/scatter/attributes":1062,"../domain":732,"../font_attributes":733,"./constants":760}],765:[function(e,t){'use strict';function a(e,t,a,r){a("accesstoken",r.accessToken),a("style"),a("center.lon"),a("center.lat"),a("zoom"),a("bearing"),a("pitch"),n(e,t,{name:"layers",handleItemDefaults:o}),t._input=e}function o(e,t){function a(a,o){return r.coerce(e,t,l.layers,a,o)}var o=a("visible");if(o){var i=a("sourcetype"),n="raster"===i||"image"===i;a("source"),a("sourceattribution"),"vector"===i&&a("sourcelayer"),"image"===i&&a("coordinates");var s;n&&(s="raster");var d=a("type",s);n&&"raster"!==d&&(d=t.type="raster",r.log("Source types *raster* and *image* must drawn *raster* layer type.")),a("below"),a("color"),a("opacity"),a("minzoom"),a("maxzoom"),"circle"===d&&a("circle.radius"),"line"===d&&(a("line.width"),a("line.dash")),"fill"===d&&a("fill.outlinecolor"),"symbol"===d&&(a("symbol.icon"),a("symbol.iconsize"),a("symbol.text"),r.coerceFont(a,"symbol.textfont"),a("symbol.textposition"),a("symbol.placement"))}}var r=e("../../lib"),i=e("../subplot_defaults"),n=e("../array_container_defaults"),l=e("./layout_attributes");t.exports=function(e,t,o){i(e,t,o,{type:"mapbox",attributes:l,handleDefaults:a,partition:"y",accessToken:t._mapboxAccessToken})}},{"../../lib":657,"../array_container_defaults":701,"../subplot_defaults":782,"./layout_attributes":764}],766:[function(e,t){'use strict';function a(e,t){this.id=t,this.gd=e;var a=e._fullLayout,o=e._context;this.container=a._glcontainer.node(),this.isStatic=o.staticPlot,this.uid=a._uid+"-"+this.id,this.div=null,this.xaxis=null,this.yaxis=null,this.createFramework(a),this.map=null,this.accessToken=null,this.styleObj=null,this.traceHash={},this.layerList=[],this.belowLookup={},this.dragging=!1,this.wheeling=!1}function o(e){var t={};return l.isPlainObject(e)?(t.id=e.id,t.style=e):"string"==typeof e?(t.id=e,t.style=-1===v.styleValuesMapbox.indexOf(e)?v.stylesNonMapbox[e]?v.stylesNonMapbox[e]:e:r(e)):(t.id=v.styleValueDflt,t.style=r(v.styleValueDflt)),t.transition={duration:0,delay:0},t}function r(e){return v.styleUrlPrefix+e+"-"+v.styleUrlSuffix}function i(e){return[e.lon,e.lat]}var n=e("mapbox-gl"),l=e("../../lib"),s=e("../../lib/geo_location_utils"),d=e("../../registry"),c=e("../cartesian/axes"),p=e("../../components/dragelement"),u=e("../../components/fx"),g=e("../../components/dragelement/helpers"),m=g.rectMode,h=g.drawMode,y=g.selectMode,f=e("../cartesian/select").prepSelect,x=e("../cartesian/select").clearSelect,_=e("../cartesian/select").clearSelectionsCache,b=e("../cartesian/select").selectOnClick,v=e("./constants"),w=e("./layers"),k=a.prototype;k.plot=function(e,t,a){var o=this,r=t[o.id];o.map&&r.accesstoken!==o.accessToken&&(o.map.remove(),o.map=null,o.styleObj=null,o.traceHash={},o.layerList=[]);var i;i=o.map?new Promise(function(a,r){o.updateMap(e,t,a,r)}):new Promise(function(a,r){o.createMap(e,t,a,r)}),a.push(i)},k.createMap=function(e,t,a,r){var l=this,d=t[l.id],c=l.styleObj=o(d.style);l.accessToken=d.accesstoken;var p=l.map=new n.Map({container:l.div,style:c.style,center:i(d.center),zoom:d.zoom,bearing:d.bearing,pitch:d.pitch,interactive:!l.isStatic,preserveDrawingBuffer:l.isStatic,doubleClickZoom:!1,boxZoom:!1,attributionControl:!1}).addControl(new n.AttributionControl({compact:!0}));p._canvas.style.left="0px",p._canvas.style.top="0px",l.rejectOnError(r),l.isStatic||l.initFx(e,t);var u=[];u.push(new Promise(function(e){p.once("load",e)})),u=u.concat(s.fetchTraceGeoData(e)),Promise.all(u).then(function(){l.fillBelowLookup(e,t),l.updateData(e),l.updateLayout(t),l.resolveOnRender(a)}).catch(r)},k.updateMap=function(e,t,a,r){var i=this,n=i.map,l=t[this.id];i.rejectOnError(r);var d=[],c=o(l.style);JSON.stringify(i.styleObj)!==JSON.stringify(c)&&(i.styleObj=c,n.setStyle(c.style),i.traceHash={},d.push(new Promise(function(e){n.once("styledata",e)}))),d=d.concat(s.fetchTraceGeoData(e)),Promise.all(d).then(function(){i.fillBelowLookup(e,t),i.updateData(e),i.updateLayout(t),i.resolveOnRender(a)}).catch(r)},k.fillBelowLookup=function(e,t){var a=t[this.id],o=a.layers,r=this.belowLookup={},n=!1,l,s;for(l=0;l<e.length;l++){var d=e[l][0].trace,c=d._module;"string"==typeof d.below?s=d.below:c.getBelow&&(s=c.getBelow(d,this)),""===s&&(n=!0),r["trace-"+d.uid]=s||""}for(l=0;l<o.length;l++){var p=o[l];s="string"==typeof p.below?p.below:n?"traces":"",r["layout-"+l]=s}var u={},g,m;for(g in r)s=r[g],u[s]?u[s].push(g):u[s]=[g];for(s in u){var h=u[s];if(1<h.length)for(l=0;l<h.length;l++)g=h[l],0===g.indexOf("trace-")?(m=g.split("trace-")[1],this.traceHash[m]&&(this.traceHash[m].below=null)):0===g.indexOf("layout-")&&(m=g.split("layout-")[1],this.layerList[m]&&(this.layerList[m].below=null))}};var T={choroplethmapbox:0,densitymapbox:1,scattermapbox:2};k.updateData=function(e){var t=this.traceHash,a=e.slice().sort(function(e,t){return T[e[0].trace.type]-T[t[0].trace.type]}),o,r,n,l;for(n=0;n<a.length;n++){var s=a[n];r=s[0].trace,o=t[r.uid];var d=!1;o&&(o.type===r.type?(o.update(s),d=!0):o.dispose()),!d&&r._module&&(t[r.uid]=r._module.plot(this,s))}var c=Object.keys(t);idLoop:for(n=0;n<c.length;n++){var p=c[n];for(l=0;l<e.length;l++)if(r=e[l][0].trace,p===r.uid)continue idLoop;o=t[p],o.dispose(),delete t[p]}},k.updateLayout=function(e){var t=this.map,a=e[this.id];this.dragging||this.wheeling||(t.setCenter(i(a.center)),t.setZoom(a.zoom),t.setBearing(a.bearing),t.setPitch(a.pitch)),this.updateLayers(e),this.updateFramework(e),this.updateFx(e),this.map.resize(),this.gd._context._scrollZoom.mapbox?t.scrollZoom.enable():t.scrollZoom.disable()},k.resolveOnRender=function(e){var t=this.map;t.on("render",function a(){t.loaded()&&(t.off("render",a),setTimeout(e,10))})},k.rejectOnError=function(e){function t(){e(new Error(v.mapOnErrorMsg))}var a=this.map;a.once("error",t),a.once("style.error",t),a.once("source.error",t),a.once("tile.error",t),a.once("layer.error",t)},k.createFramework=function(e){var t=this,a=t.div=document.createElement("div");a.id=t.uid,a.style.position="absolute",t.container.appendChild(a),t.xaxis={_id:"x",c2p:function(e){return t.project(e).x}},t.yaxis={_id:"y",c2p:function(e){return t.project(e).y}},t.updateFramework(e),t.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},c.setConvert(t.mockAxis,e)},k.initFx=function(e,t){function a(){u.loneUnhover(t._hoverlayer)}function o(){var e=r.getView();n.emit("plotly_relayouting",r.getViewEditsWithDerived(e))}var r=this,n=r.gd,l=r.map;l.on("moveend",function(e){if(r.map){var t=n._fullLayout;if(e.originalEvent||r.wheeling){var a=t[r.id];d.call("_storeDirectGUIEdit",n.layout,t._preGUI,r.getViewEdits(a));var o=r.getView();a._input.center=a.center=o.center,a._input.zoom=a.zoom=o.zoom,a._input.bearing=a.bearing=o.bearing,a._input.pitch=a.pitch=o.pitch,n.emit("plotly_relayout",r.getViewEditsWithDerived(o))}e.originalEvent&&"mouseup"===e.originalEvent.type?r.dragging=!1:r.wheeling&&(r.wheeling=!1),t._rehover&&t._rehover()}}),l.on("wheel",function(){r.wheeling=!0}),l.on("mousemove",function(e){var t=r.div.getBoundingClientRect();e.clientX=e.point.x+t.left,e.clientY=e.point.y+t.top,e.target.getBoundingClientRect=function(){return t},r.xaxis.p2c=function(){return e.lngLat.lng},r.yaxis.p2c=function(){return e.lngLat.lat},n._fullLayout._rehover=function(){n._fullLayout._hoversubplot===r.id&&n._fullLayout[r.id]&&u.hover(n,e,r.id)},u.hover(n,e,r.id),n._fullLayout._hoversubplot=r.id}),l.on("dragstart",function(){r.dragging=!0,a()}),l.on("zoomstart",a),l.on("mouseout",function(){n._fullLayout._hoversubplot=null}),l.on("drag",o),l.on("zoom",o),l.on("dblclick",function(){var e=n._fullLayout[r.id];d.call("_storeDirectGUIEdit",n.layout,n._fullLayout._preGUI,r.getViewEdits(e));var t=r.viewInitial;l.setCenter(i(t.center)),l.setZoom(t.zoom),l.setBearing(t.bearing),l.setPitch(t.pitch);var a=r.getView();e._input.center=e.center=a.center,e._input.zoom=e.zoom=a.zoom,e._input.bearing=e.bearing=a.bearing,e._input.pitch=e.pitch=a.pitch,n.emit("plotly_doubleclick",null),n.emit("plotly_relayout",r.getViewEditsWithDerived(a))}),r.clearSelect=function(){_(r.dragOptions),x(r.dragOptions.gd)},r.onClickInPanFn=function(e){return function(t){var a=n._fullLayout.clickmode;-1<a.indexOf("select")&&b(t.originalEvent,n,[r.xaxis],[r.yaxis],r.id,e),-1<a.indexOf("event")&&u.click(n,t.originalEvent)}}},k.updateFx=function(e){function t(e){var t=a.map.unproject(e);return[t.lng,t.lat]}var a=this,o=a.map,r=a.gd;if(!a.isStatic){var i=e.dragmode,n;n=m(i)?function(e,o){var r=e.range={};r[a.id]=[t([o.xmin,o.ymin]),t([o.xmax,o.ymax])]}:function(e,o,r){var i=e.lassoPoints={};i[a.id]=r.filtered.map(t)};var s=a.dragOptions;a.dragOptions=l.extendDeep(s||{},{dragmode:e.dragmode,element:a.div,gd:r,plotinfo:{id:a.id,domain:e[a.id].domain,xaxis:a.xaxis,yaxis:a.yaxis,fillRangeItems:n},xaxes:[a.xaxis],yaxes:[a.yaxis],subplot:a.id}),o.off("click",a.onClickInPanHandler),y(i)||h(i)?(o.dragPan.disable(),o.on("zoomstart",a.clearSelect),a.dragOptions.prepFn=function(t,e,o){f(t,e,o,a.dragOptions,i)},p.init(a.dragOptions)):(o.dragPan.enable(),o.off("zoomstart",a.clearSelect),a.div.onmousedown=null,a.onClickInPanHandler=a.onClickInPanFn(a.dragOptions),o.on("click",a.onClickInPanHandler))}},k.updateFramework=function(e){var t=e[this.id].domain,a=e._size,o=this.div.style;o.width=a.w*(t.x[1]-t.x[0])+"px",o.height=a.h*(t.y[1]-t.y[0])+"px",o.left=a.l+t.x[0]*a.w+"px",o.top=a.t+(1-t.y[1])*a.h+"px",this.xaxis._offset=a.l+t.x[0]*a.w,this.xaxis._length=a.w*(t.x[1]-t.x[0]),this.yaxis._offset=a.t+(1-t.y[1])*a.h,this.yaxis._length=a.h*(t.y[1]-t.y[0])},k.updateLayers=function(e){var t=e[this.id],a=t.layers,o=this.layerList,r;if(a.length!==o.length){for(r=0;r<o.length;r++)o[r].dispose();for(o=this.layerList=[],r=0;r<a.length;r++)o.push(w(this,r,a[r]))}else for(r=0;r<a.length;r++)o[r].update(a[r])},k.destroy=function(){this.map&&(this.map.remove(),this.map=null,this.container.removeChild(this.div))},k.toImage=function(){return this.map.stop(),this.map.getCanvas().toDataURL()},k.setOptions=function(e,t,a){for(var o in a)this.map[t](e,o,a[o])},k.getMapLayers=function(){return this.map.getStyle().layers},k.addLayer=function(e,t){var a=this.map;if("string"==typeof t){if(""===t)return void a.addLayer(e,t);for(var o=this.getMapLayers(),r=0;r<o.length;r++)if(t===o[r].id)return void a.addLayer(e,t);l.warn(["Trying to add layer with *below* value",t,"referencing a layer that does not exist","or that does not yet exist."].join(" "))}a.addLayer(e)},k.project=function(e){return this.map.project(new n.LngLat(e[0],e[1]))},k.getView=function(){var e=this.map,t=e.getCenter(),a={lon:t.lng,lat:t.lat},o=e.getCanvas(),r=o.width,i=o.height;return{center:a,zoom:e.getZoom(),bearing:e.getBearing(),pitch:e.getPitch(),_derived:{coordinates:[e.unproject([0,0]).toArray(),e.unproject([r,0]).toArray(),e.unproject([r,i]).toArray(),e.unproject([0,i]).toArray()]}}},k.getViewEdits=function(e){for(var t=this.id,a=["center","zoom","bearing","pitch"],o={},r=0,n;r<a.length;r++)n=a[r],o[t+"."+n]=e[n];return o},k.getViewEditsWithDerived=function(e){var t=this.id,a=this.getViewEdits(e);return a[t+"._derived"]=e._derived,a},t.exports=a},{"../../components/dragelement":543,"../../components/dragelement/helpers":542,"../../components/fx":564,"../../lib":657,"../../lib/geo_location_utils":651,"../../registry":788,"../cartesian/axes":705,"../cartesian/select":724,"./constants":760,"./layers":763,"mapbox-gl":396}],767:[function(e,t){'use strict';t.exports=function(e){var t=e.editType;return{t:{valType:"number",dflt:0,editType:t},r:{valType:"number",dflt:0,editType:t},b:{valType:"number",dflt:0,editType:t},l:{valType:"number",dflt:0,editType:t},editType:t}}},{}],768:[function(e,t){'use strict';var f=Math.round,x=Math.min,b=Math.abs,v=Math.max,w=Math.floor;function a(e,t){t.text("");var a=t.append("a").attr({"xlink:xlink:href":"#",class:"link--impt link--embedview","font-weight":"bold"}).text(e._context.linkText+" "+String.fromCharCode(187));if(e._context.sendData)a.on("click",function(){_.sendDataToCloud(e)});else{var o=window.location.pathname.split("/"),r=window.location.search;a.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+o[2].split(".")[0]+"/"+o[1]+r})}}function o(e,t){function a(e,t){p[t]=e,u[e]=1}function o(e,t){if(e&&"string"==typeof e&&!u[e])return a(e,t),!0}var r=t.length,n=[],l,s;for(l=0;l<e.length;l++){var d=e[l]._fullInput;d!==s&&n.push(d),s=d}var c=n.length,p=Array(r),u={};for(l=0;l<r;l++){var g=t[l].uid;"number"==typeof g&&(g=g+""),o(g,l)||l<c&&o(n[l].uid,l)||a(L.randstr(u),l)}return p}function r(){var e=A.collectableSubplotTypes,t={},a,o;if(!e){e=[];var r=A.subplotsRegistry;for(var n in r){var l=r[n],s=l.attr;if(s&&(e.push(n),Array.isArray(s)))for(o=0;o<s.length;o++)L.pushUnique(e,s[o])}}for(a=0;a<e.length;a++)t[e[a]]=[];return t}function n(e,t){function a(e){for(var a=!0,o=0,l;o<t.length;o++)l=t[o],n[l]||(e[l]?n[l]=e[l]:a=!1);a&&(r=!0)}var o=e._context.locale;for(var r=!1,n={},l=0,s;2>l;l++){s=e._context.locales;for(var d=0,c;2>d&&(c=(s[o]||{}).format,!(c&&(a(c),r)));d++)s=A.localeRegistry;var p=o.split("-")[0];if(r||p===o)break;o=p}return r||a(A.localeRegistry.en.format),n}function l(e,t){return e.decimal=t.charAt(0),e.thousands=t.charAt(1),k.locale(e)}function s(e,t){var a=[],o;t.meta&&(o=t._meta={meta:t.meta,layout:{meta:t.meta}});for(var r=0,n;r<e.length;r++)n=e[r],n.meta?a[n.index]=n._meta={meta:n.meta}:t.meta&&(n._meta={meta:t.meta}),t.meta&&(n._meta.layout={meta:t.meta});a.length&&(!o&&(o=t._meta={}),o.data=a)}function d(e,t){var a={_fullLayout:t},o="x"===e._id.charAt(0),r=e._mainAxis._anchorAxis,i="",n="",l="";if(r&&(l=r._mainAxis._id,i=o?e._id+l:l+e._id),!i||!t._plots[i]){i="";for(var s=e._counterAxes,d=0;d<s.length;d++){var c=s[d],p=o?e._id+c:c+e._id;n||(n=p);var u=P.getFromId(a,c);if(l&&u.overlaying===l){i=p;break}}}return i||n}function c(e){var t=e.transforms;if(Array.isArray(t)&&t.length)for(var a=0;a<t.length;a++){var o=t[a],r=o._module||B[o.type];if(r&&r.makesData)return!0}return!1}function p(e,t,a,o){for(var r=e.transforms,n=[e],l=0;l<r.length;l++){var s=r[l],d=B[s.type];d&&d.transform&&(n=d.transform(n,{transform:s,fullTrace:e,fullData:t,layout:a,fullLayout:o,transformIndex:l}))}return n}function u(e){var t=e.margin;if(!e._size){var a=e._size={l:f(t.l),r:f(t.r),t:f(t.t),b:f(t.b),p:f(t.pad)};a.w=f(e.width)-a.l-a.r,a.h=f(e.height)-a.t-a.b}e._pushmargin||(e._pushmargin={}),e._pushmarginIds||(e._pushmarginIds={})}function g(e,t,a){function o(e){var t=Promise.resolve();if(!e)return t;for(;e.length;)t=t.then(e.shift());return t}function r(e){if(e)for(;e.length;)e.shift()}function i(t){if(e._transitionData)return r(e._transitionData._interruptCallbacks),Promise.resolve().then(function(){if(a.redraw)return A.call("redraw",e)}).then(function(){e._transitioning=!1,e._transitioningWithDuration=!1,e.emit("plotly_transitioned",[])}).then(t)}var n=!1,l=[_.previousPromises,function(){if(e._transitionData)return e._transitioning=!1,o(e._transitionData._interruptCallbacks)},a.prepareFn,_.rehover,function(){return e.emit("plotly_transitioning",[]),new Promise(function(o){function r(){return l++,function(){s++,n||s!==l||i(o)}}e._transitioning=!0,0<t.duration&&(e._transitioningWithDuration=!0),e._transitionData._interruptCallbacks.push(function(){n=!0}),a.redraw&&e._transitionData._interruptCallbacks.push(function(){return A.call("redraw",e)}),e._transitionData._interruptCallbacks.push(function(){e.emit("plotly_transitioninterrupted",[])});var l=0,s=0;a.runFn(r),setTimeout(r())})}],s=L.syncOrAsync(l,e);return s&&s.then||(s=Promise.resolve()),s.then(function(){return e})}function m(e,t){function a(e,a,r){var i=a._id.charAt(0);if("histogram2dcontour"===e){var n=a._counterAxes[0],l=P.getFromId(t,n),s="x"===i||"x"===n&&"category"===l.type,d="y"===i||"y"===n&&"category"===l.type;return function(e,t){return 0===e||0===t?-1:s&&e===r[t].length-1?-1:d&&t===r.length-1?-1:("y"===i?t:e)-1}}return function(e,t){return"y"===i?t:e}}var r=[],n={min:function(e){return L.aggNums(Math.min,null,e)},max:function(e){return L.aggNums(Math.max,null,e)},sum:function(e){return L.aggNums(function(e,t){return e+t},null,e)},total:function(e){return L.aggNums(function(e,t){return e+t},null,e)},mean:function(e){return L.mean(e)},median:function(e){return L.median(e)}},s,d,c,p,u;for(s=0;s<e.length;s++){var g=e[s];if("category"===g.type){var m=g.categoryorder.match(H);if(m){var h=m[1],y=m[2],f=[];for(d=0;d<g._categories.length;d++)f.push([g._categories[d],[]]);for(d=0;d<g._traceIndices.length;d++){var x=g._traceIndices[d],_=t._fullData[x],b=g._id.charAt(0);if(!0===_.visible){var v=_.type;A.traceIs(_,"histogram")&&(delete _._xautoBinFinished,delete _._yautoBinFinished);var w=t.calcdata[x];for(c=0;c<w.length;c++){var T=w[c],S,C,E;if("splom"===v){var I=_._axesDim[g._id];if("y"===b){var z=_._diag[I][0];z&&(g=t._fullLayout[P.id2name(z)])}var D=T.trace.dimensions[I].values;for(p=0;p<D.length;p++)for(S=D[p],C=g._categoriesMap[S],u=0;u<T.trace.dimensions.length;u++)if(u!==I){var O=T.trace.dimensions[u];f[C][1].push(O.values[p])}}else if("scattergl"===v){for(p=0;p<T.t.x.length;p++)"x"===b&&(S=T.t.x[p],C=S,E=T.t.y[p]),"y"===b&&(S=T.t.y[p],C=S,E=T.t.x[p]),f[C][1].push(E);T.t&&T.t._scene&&delete T.t._scene.dirty}else if(T.hasOwnProperty("z")){E=T.z;var R=a(_.type,g,E);for(p=0;p<E.length;p++)for(u=0;u<E[p].length;u++)C=R(u,p),C+1&&f[C][1].push(E[p][u])}else for("x"===b?(S=T.p+1?T.p:T.x,E=T.s||T.v||T.y):"y"===b&&(S=T.p+1?T.p:T.y,E=T.s||T.v||T.x),Array.isArray(E)||(E=[E]),p=0;p<E.length;p++)f[S][1].push(E[p])}}}g._categoriesValue=f;var M=[];for(d=0;d<f.length;d++)M.push([f[d][0],n[h](f[d][1])]);M.sort(function(e,t){return e[1]-t[1]}),g._categoriesAggregatedValue=M,g._initialCategories=M.map(function(e){return e[0]}),"descending"===y&&g._initialCategories.reverse(),r=r.concat(g.sortByInitialCategories())}}}return r}function h(e,t,a){var o={},r,n,l;for(r=0;r<e.length;r++)n=e[r],l=n._id,n.clearCalc(),"multicategory"===n.type&&n.setupMultiCategory(t),o[n._id]=1;var s=a._axisMatchGroups||[];for(r=0;r<s.length;r++)for(l in s[r])o[l]||(n=a[P.id2name(l)],n.clearCalc())}function y(e){var t=e._fullLayout,a=t._visibleModules,o={},r,n,l;for(n=0;n<a.length;n++){var s=a[n],d=s.crossTraceCalc;if(d){var c=s.basePlotModule.name;o[c]?L.pushUnique(o[c],d):o[c]=[d]}}for(l in o){var p=o[l],u=t._subplots[l];if(Array.isArray(u))for(r=0;r<u.length;r++){var g=u[r],m="cartesian"===l?t._plots[g]:t[g];for(n=0;n<p.length;n++)p[n](e,m,g)}else for(n=0;n<p.length;n++)p[n](e)}}var k=e("d3"),T=e("fast-isnumeric"),A=e("../registry"),S=e("../plot_api/plot_schema"),C=e("../plot_api/plot_template"),L=e("../lib"),E=e("../components/color"),I=e("../constants/numerical").BADNUM,P=e("./cartesian/axis_ids"),z=e("./cartesian/handle_outline").clearSelect,D=e("./animation_attributes"),O=e("./frame_attributes"),R=e("../plots/get_data").getModuleCalcData,M=L.relinkPrivateKeys,j=L._,_=t.exports={};L.extendFlat(_,A),_.attributes=e("./attributes"),_.attributes.type.values=_.allTypes,_.fontAttrs=e("./font_attributes"),_.layoutAttributes=e("./layout_attributes"),_.fontWeight="normal";var B=_.transformsRegistry,F=e("./command");_.executeAPICommand=F.executeAPICommand,_.computeAPICommandBindings=F.computeAPICommandBindings,_.manageCommandObserver=F.manageCommandObserver,_.hasSimpleAPICommandBindings=F.hasSimpleAPICommandBindings,_.redrawText=function(e){e=L.getGraphDiv(e);var t=e._fullLayout||{},a=t._has&&t._has("polar"),o=!a&&e.data&&e.data[0]&&e.data[0].r;return o?void 0:new Promise(function(t){setTimeout(function(){A.getComponentMethod("annotations","draw")(e),A.getComponentMethod("legend","draw")(e),A.getComponentMethod("colorbar","draw")(e),t(_.previousPromises(e))},300)})},_.resize=function(e){e=L.getGraphDiv(e);var t=new Promise(function(t,o){(!e||L.isHidden(e))&&o(new Error("Resize must be passed a displayed plot div element.")),e._redrawTimer&&clearTimeout(e._redrawTimer),e._resolveResize&&(a=e._resolveResize),e._resolveResize=t,e._redrawTimer=setTimeout(function(){if(!e.layout||e.layout.width&&e.layout.height||L.isHidden(e))return void t(e);delete e.layout.width,delete e.layout.height;var a=e.changed;e.autoplay=!0,A.call("relayout",e,{autosize:!0}).then(function(){e.changed=a,e._resolveResize===t&&(delete e._resolveResize,t(e))})},100)}),a;return a&&a(t),t},_.previousPromises=function(e){if((e._promises||[]).length)return Promise.all(e._promises).then(function(){e._promises=[]})},_.addLinks=function(e){if(e._context.showLink||e._context.showSources){var t=e._fullLayout,o=L.ensureSingle(t._paper,"text","js-plot-link-container",function(e){e.style({"font-family":"\"Open Sans\", Arial, sans-serif","font-size":"12px",fill:E.defaultLine,"pointer-events":"all"}).each(function(){var e=k.select(this);e.append("tspan").classed("js-link-to-tool",!0),e.append("tspan").classed("js-link-spacer",!0),e.append("tspan").classed("js-sourcelinks",!0)})}),r=o.node(),i={y:t._paper.attr("height")-9};document.body.contains(r)&&r.getComputedTextLength()>=t.width-20?(i["text-anchor"]="start",i.x=5):(i["text-anchor"]="end",i.x=t._paper.attr("width")-7),o.attr(i);var n=o.select(".js-link-to-tool"),l=o.select(".js-link-spacer"),s=o.select(".js-sourcelinks");e._context.showSources&&e._context.showSources(e),e._context.showLink&&a(e,n),l.text(n.text()&&s.text()?" - ":"")}},_.sendDataToCloud=function(e){var t=(window.PLOTLYENV||{}).BASE_URL||e._context.plotlyServerURL;if(t){e.emit("plotly_beforeexport");var a=k.select(e).append("div").attr("id","hiddenform").style("display","none"),o=a.append("form").attr({action:t+"/external",method:"post",target:"_blank"}),r=o.append("input").attr({type:"text",name:"data"});return r.node().value=_.graphJson(e,!1,"keepdata"),o.node().submit(),a.remove(),e.emit("plotly_afterexport"),!1}};var N=["days","shortDays","months","shortMonths","periods","dateTime","date","time","decimal","thousands","grouping","currency"],V=["year","month","dayMonth","dayMonthYear"];_.supplyDefaults=function(e,t){var a=t&&t.skipUpdateCalc,d=e._fullLayout||{};if(d._skipDefaults)return void delete d._skipDefaults;var c=e._fullLayout={},p=e.layout||{},g=e._fullData||[],m=e._fullData=[],h=e.data||[],y=e.calcdata||[],f=e._context||{},x;e._transitionData||_.createTransitionData(e),c._dfltTitle={plot:j(e,"Click to enter Plot title"),x:j(e,"Click to enter X axis title"),y:j(e,"Click to enter Y axis title"),colorbar:j(e,"Click to enter Colorscale title"),annotation:j(e,"new text")},c._traceWord=j(e,"trace");var b=n(e,N);if(c._mapboxAccessToken=f.mapboxAccessToken,d._initialAutoSizeIsDone){var v=d.width,w=d.height;_.supplyLayoutGlobalDefaults(p,c,b),p.width||(c.width=v),p.height||(c.height=w),_.sanitizeMargins(c)}else{_.supplyLayoutGlobalDefaults(p,c,b);var T=!p.width||!p.height,S=c.autosize,C=f.autosizable;T&&(S||C)?_.plotAutoSize(e,p,c):T&&_.sanitizeMargins(c),!S&&T&&(p.width=c.width,p.height=c.height)}c._d3locale=l(b,c.separators),c._extraFormat=n(e,V),c._initialAutoSizeIsDone=!0,c._dataLength=h.length,c._modules=[],c._visibleModules=[],c._basePlotModules=[];var E=c._subplots=r(),I=c._splomAxes={x:{},y:{}},P=c._splomSubplots={};c._splomGridDflt={},c._scatterStackOpts={},c._firstScatter={},c._alignmentOpts={},c._colorAxes={},c._requestRangeslider={},c._traceUids=o(g,h),c._globalTransforms=(e._context||{}).globalTransforms,_.supplyDataDefaults(h,m,p,c);var D=Object.keys(I.x),O=Object.keys(I.y);if(1<D.length&&1<O.length){for(A.getComponentMethod("grid","sizeDefaults")(p,c),x=0;x<D.length;x++)L.pushUnique(E.xaxis,D[x]);for(x=0;x<O.length;x++)L.pushUnique(E.yaxis,O[x]);for(var R in P)L.pushUnique(E.cartesian,R)}if(c._has=_._hasPlotType.bind(c),g.length===m.length)for(x=0;x<m.length;x++)M(m[x],g[x]);_.supplyLayoutModuleDefaults(p,c,m,e._transitionData);var k=c._visibleModules,B=[];for(x=0;x<k.length;x++){var F=k[x].crossTraceDefaults;F&&L.pushUnique(B,F)}for(x=0;x<B.length;x++)B[x](m,c);c._hasOnlyLargeSploms=1===c._basePlotModules.length&&"splom"===c._basePlotModules[0].name&&15<D.length&&15<O.length&&0===c.shapes.length&&0===c.images.length,c._hasCartesian=c._has("cartesian"),c._hasGeo=c._has("geo"),c._hasGL3D=c._has("gl3d"),c._hasGL2D=c._has("gl2d"),c._hasTernary=c._has("ternary"),c._hasPie=c._has("pie"),_.linkSubplots(m,c,g,d),_.cleanPlot(m,c,g,d),d._zoomlayer&&!e._dragging&&z({_fullLayout:d}),s(m,c),M(c,d),A.getComponentMethod("colorscale","crossTraceDefaults")(m,c),c._preGUI||(c._preGUI={}),c._tracePreGUI||(c._tracePreGUI={});var U=c._tracePreGUI,H={},q;for(q in U)H[q]="old";for(x=0;x<m.length;x++)q=m[x]._fullInput.uid,H[q]||(U[q]={}),H[q]="new";for(q in H)"old"===H[q]&&delete U[q];u(c),A.getComponentMethod("rangeslider","makeData")(c),a||y.length!==m.length||_.supplyDefaultsUpdateCalc(y,m)},_.supplyDefaultsUpdateCalc=function(e,t){for(var a=0;a<t.length;a++){var o=t[a],r=(e[a]||[])[0];if(r&&r.trace){var n=r.trace;if(n._hasCalcTransform){var l=n._arrayAttrs,s,d,c;for(s=0;s<l.length;s++)d=l[s],c=L.nestedProperty(n,d).get().slice(),L.nestedProperty(o,d).set(c)}r.trace=o}}},_.createTransitionData=function(e){e._transitionData||(e._transitionData={}),e._transitionData._frames||(e._transitionData._frames=[]),e._transitionData._frameHash||(e._transitionData._frameHash={}),e._transitionData._counter||(e._transitionData._counter=0),e._transitionData._interruptCallbacks||(e._transitionData._interruptCallbacks=[])},_._hasPlotType=function(e){var t=this._basePlotModules||[],a;for(a=0;a<t.length;a++)if(t[a].name===e)return!0;var o=this._modules||[];for(a=0;a<o.length;a++){var r=o[a].name;if(r===e)return!0;var n=A.modules[r];if(n&&n.categories[e])return!0}return!1},_.cleanPlot=function(e,t,a,o){var r=o._basePlotModules||[],n,l;for(n=0;n<r.length;n++){var s=r[n];s.clean&&s.clean(e,t,a,o)}var d=o._has&&o._has("gl"),c=t._has&&t._has("gl");d&&!c&&o._glcontainer!==void 0&&(o._glcontainer.selectAll(".gl-canvas").remove(),o._glcontainer.selectAll(".no-webgl").remove(),o._glcanvas=null);var p=!!o._infolayer;oldLoop:for(n=0;n<a.length;n++){var u=a[n],g=u.uid;for(l=0;l<e.length;l++){var m=e[l];if(g===m.uid)continue oldLoop}p&&o._infolayer.select(".cb"+g).remove()}},_.linkSubplots=function(e,t,a,o){var r=o._plots||{},n=t._plots={},l=t._subplots,s={_fullData:e,_fullLayout:t},c=l.cartesian.concat(l.gl2d||[]),p,u;for(p=0;p<c.length;p++){var g=c[p],m=r[g],h=P.getFromId(s,g,"x"),y=P.getFromId(s,g,"y"),f;for(m?f=n[g]=m:(f=n[g]={},f.id=g),h._counterAxes.push(y._id),y._counterAxes.push(h._id),h._subplotsWith.push(g),y._subplotsWith.push(g),f.xaxis=h,f.yaxis=y,f._hasClipOnAxisFalse=!1,u=0;u<e.length;u++){var _=e[u];if(_.xaxis===f.xaxis._id&&_.yaxis===f.yaxis._id&&!1===_.cliponaxis){f._hasClipOnAxisFalse=!0;break}}}var b=P.list(s,null,!0),w;for(p=0;p<b.length;p++){w=b[p];var k=null;w.overlaying&&(k=P.getFromId(s,w.overlaying),k&&k.overlaying&&(w.overlaying=!1,k=null)),w._mainAxis=k||w,k&&(w.domain=k.domain.slice()),w._anchorAxis="free"===w.anchor?null:P.getFromId(s,w.anchor)}for(p=0;p<b.length;p++)if(w=b[p],w._counterAxes.sort(P.idSort),w._subplotsWith.sort(L.subplotSort),w._mainSubplot=d(w,t),w._counterAxes.length&&(w.spikemode&&-1!==w.spikemode.indexOf("across")||w.automargin&&w.mirror&&"free"!==w.anchor||A.getComponentMethod("rangeslider","isVisible")(w))){var T=1,S=0;for(u=0;u<w._counterAxes.length;u++){var C=P.getFromId(s,w._counterAxes[u]);T=x(T,C.domain[0]),S=v(S,C.domain[1])}T<S&&(w._counterDomainMin=T,w._counterDomainMax=S)}},_.clearExpandedTraceDefaultColors=function(e){function t(e,t,r,i){o[i]=t,o.length=i+1,"color"===e.valType&&e.dflt===void 0&&a.push(o.join("."))}var a,o,r;for(o=[],a=e._module._colorAttrs,a||(e._module._colorAttrs=a=[],S.crawl(e._module.attributes,t)),r=0;r<a.length;r++){var n=L.nestedProperty(e,"_input."+a[r]);n.get()||L.nestedProperty(e,a[r]).set(null)}},_.supplyDataDefaults=function(e,t,a,o){function r(e){t.push(e);var a=e._module;a&&(L.pushUnique(n,a),!0===e.visible&&L.pushUnique(l,a),L.pushUnique(s,e._module.basePlotModule),d++,!1!==e._input.visible&&c++)}var n=o._modules,l=o._visibleModules,s=o._basePlotModules,d=0,c=0,u,g,m;o._transformModules=[];var h={},y=[],f=(a.template||{}).data||{},x=C.traceTemplater(f);for(u=0;u<e.length;u++){if(m=e[u],g=x.newTrace(m),g.uid=o._traceUids[u],_.supplyTraceDefaults(m,g,c,o,u),g.index=u,g._input=m,g._expandedIndex=d,g.transforms&&g.transforms.length)for(var b=!1!==m.visible&&!1===g.visible,v=p(g,t,a,o),w=0;w<v.length;w++){var k=v[w],T={_template:g._template,type:g.type,uid:g.uid+w};b&&!1===k.visible&&delete k.visible,_.supplyTraceDefaults(k,T,d,o,u),M(T,k),T.index=u,T._input=m,T._fullInput=g,T._expandedIndex=d,T._expandedInput=k,r(T)}else g._fullInput=g,g._expandedInput=g,r(g);A.traceIs(g,"carpetAxis")&&(h[g.carpet]=g),A.traceIs(g,"carpetDependent")&&y.push(u)}for(u=0;u<y.length;u++)if(g=t[y[u]],g.visible){var S=h[g.carpet];if(g._carpet=S,!S||!S.visible){g.visible=!1;continue}g.xaxis=S.xaxis,g.yaxis=S.yaxis}},_.supplyAnimationDefaults=function(e){function t(t,o){return L.coerce(e||{},a,D,t,o)}e=e||{};var a={},o;if(t("mode"),t("direction"),t("fromcurrent"),Array.isArray(e.frame))for(a.frame=[],o=0;o<e.frame.length;o++)a.frame[o]=_.supplyAnimationFrameDefaults(e.frame[o]||{});else a.frame=_.supplyAnimationFrameDefaults(e.frame||{});if(Array.isArray(e.transition))for(a.transition=[],o=0;o<e.transition.length;o++)a.transition[o]=_.supplyAnimationTransitionDefaults(e.transition[o]||{});else a.transition=_.supplyAnimationTransitionDefaults(e.transition||{});return a},_.supplyAnimationFrameDefaults=function(e){function t(t,o){return L.coerce(e||{},a,D.frame,t,o)}var a={};return t("duration"),t("redraw"),a},_.supplyAnimationTransitionDefaults=function(e){function t(t,o){return L.coerce(e||{},a,D.transition,t,o)}var a={};return t("duration"),t("easing"),a},_.supplyFrameDefaults=function(e){function t(t,o){return L.coerce(e,a,O,t,o)}var a={};return t("group"),t("name"),t("traces"),t("baseframe"),t("data"),t("layout"),a},_.supplyTraceDefaults=function(e,t,a,o,r){function n(a,o){return L.coerce(e,t,_.attributes,a,o)}var l=o.colorway||E.defaults,s=l[a%l.length],d=n("visible"),c;n("type"),n("name",o._traceWord+" "+r),n("uirevision",o.uirevision);var p=_.getModule(t);if(t._module=p,p){var u=p.basePlotModule,g=u.attr,m=u.attributes;if(g&&m){var h=o._subplots,y="";if(d||"gl2d"!==u.name){if(Array.isArray(g))for(c=0;c<g.length;c++){var f=g[c],x=L.coerce(e,t,m,f);h[f]&&L.pushUnique(h[f],x),y+=x}else y=L.coerce(e,t,m,g);h[u.name]&&L.pushUnique(h[u.name],y)}}}return d&&(n("customdata"),n("ids"),n("meta"),A.traceIs(t,"showLegend")?(L.coerce(e,t,p.attributes.showlegend?p.attributes:_.attributes,"showlegend"),n("legendgroup"),t._dfltShowLegend=!0):t._dfltShowLegend=!1,p&&p.supplyDefaults(e,t,s,o),!A.traceIs(t,"noOpacity")&&n("opacity"),A.traceIs(t,"notLegendIsolatable")&&(t.visible=!!t.visible),!A.traceIs(t,"noHover")&&(!t.hovertemplate&&L.coerceHoverinfo(e,t,o),"parcats"!==t.type&&A.getComponentMethod("fx","supplyDefaults")(e,t,s,o)),p&&p.selectPoints&&n("selectedpoints"),_.supplyTransformDefaults(e,t,o)),t},_.hasMakesDataTransform=c,_.supplyTransformDefaults=function(e,t,a){if(t._length||c(e)){var o=a._globalTransforms||[],r=a._transformModules||[];if(Array.isArray(e.transforms)||0!==o.length)for(var n=e.transforms||[],l=o.concat(n),s=t.transforms=[],d=0;d<l.length;d++){var p=l[d],u=p.type,g=B[u],m=!(p._module&&p._module===g),h=g&&"function"==typeof g.transform,y;g||L.warn("Unrecognized transform type "+u+"."),g&&g.supplyDefaults&&(m||h)?(y=g.supplyDefaults(p,t,a,e),y.type=u,y._module=g,L.pushUnique(r,g)):y=L.extendFlat({},p),s.push(y)}}},_.supplyLayoutGlobalDefaults=function(e,t,a){function o(a,o){return L.coerce(e,t,_.layoutAttributes,a,o)}var r=e.template;L.isPlainObject(r)&&(t.template=r,t._template=r.layout,t._dataTemplate=r.data);var i=L.coerceFont(o,"font");o("title.text",t._dfltTitle.plot),L.coerceFont(o,"title.font",{family:i.family,size:f(1.4*i.size),color:i.color}),o("title.xref"),o("title.yref"),o("title.x"),o("title.y"),o("title.xanchor"),o("title.yanchor"),o("title.pad.t"),o("title.pad.r"),o("title.pad.b"),o("title.pad.l");var n=o("uniformtext.mode");n&&o("uniformtext.minsize"),o("autosize",!(e.width&&e.height)),o("width"),o("height"),o("margin.l"),o("margin.r"),o("margin.t"),o("margin.b"),o("margin.pad"),o("margin.autoexpand"),e.width&&e.height&&_.sanitizeMargins(t),A.getComponentMethod("grid","sizeDefaults")(e,t),o("paper_bgcolor"),o("separators",a.decimal+a.thousands),o("hidesources"),o("colorway"),o("datarevision");var l=o("uirevision");o("editrevision",l),o("selectionrevision",l),o("modebar.orientation"),o("modebar.bgcolor",E.addOpacity(t.paper_bgcolor,.5));var s=E.contrast(E.rgb(t.modebar.bgcolor));o("modebar.color",E.addOpacity(s,.3)),o("modebar.activecolor",E.addOpacity(s,.7)),o("modebar.uirevision",l),A.getComponentMethod("shapes","supplyDrawNewShapeDefaults")(e,t,o),o("meta"),L.isPlainObject(e.transition)&&(o("transition.duration"),o("transition.easing"),o("transition.ordering")),A.getComponentMethod("calendars","handleDefaults")(e,t,"calendar"),A.getComponentMethod("fx","supplyLayoutGlobalDefaults")(e,t,o)},_.plotAutoSize=function(e,t,a){var o=e._context||{},r=o.frameMargins,i=L.isPlotDiv(e),n,l;if(i&&e.emit("plotly_autosize"),o.fillFrame)n=window.innerWidth,l=window.innerHeight,document.body.style.overflow="hidden";else{var s=i?window.getComputedStyle(e):{};if(n=parseFloat(s.width)||parseFloat(s.maxWidth)||a.width,l=parseFloat(s.height)||parseFloat(s.maxHeight)||a.height,T(r)&&0<r){var d=1-2*r;n=f(d*n),l=f(d*l)}}var c=_.layoutAttributes.width.min,p=_.layoutAttributes.height.min;n<c&&(n=c),l<p&&(l=p);var u=!t.width&&1<b(a.width-n),g=!t.height&&1<b(a.height-l);(g||u)&&(u&&(a.width=n),g&&(a.height=l)),e._initialAutoSize||(e._initialAutoSize={width:n,height:l}),_.sanitizeMargins(a)},_.supplyLayoutModuleDefaults=function(e,t,a,o){var r=A.componentsRegistry,n=t._basePlotModules,l=A.subplotsRegistry.cartesian,s,d,c;for(s in r)c=r[s],c.includeBasePlot&&c.includeBasePlot(e,t);for(var p in n.length||n.push(l),t._has("cartesian")&&(A.getComponentMethod("grid","contentDefaults")(e,t),l.finalizeSubplots(e,t)),t._subplots)t._subplots[p].sort(L.subplotSort);for(d=0;d<n.length;d++)c=n[d],c.supplyLayoutDefaults&&c.supplyLayoutDefaults(e,t,a);var u=t._modules;for(d=0;d<u.length;d++)c=u[d],c.supplyLayoutDefaults&&c.supplyLayoutDefaults(e,t,a);var g=t._transformModules;for(d=0;d<g.length;d++)c=g[d],c.supplyLayoutDefaults&&c.supplyLayoutDefaults(e,t,a,o);for(s in r)c=r[s],c.supplyLayoutDefaults&&c.supplyLayoutDefaults(e,t,a)},_.purge=function(e){var t=e._fullLayout||{};t._glcontainer!==void 0&&(t._glcontainer.selectAll(".gl-canvas").remove(),t._glcontainer.remove(),t._glcanvas=null),t._modeBar&&t._modeBar.destroy(),e._transitionData&&(e._transitionData._interruptCallbacks&&(e._transitionData._interruptCallbacks.length=0),e._transitionData._animationRaf&&window.cancelAnimationFrame(e._transitionData._animationRaf)),L.clearThrottle(),L.clearResponsive(e),delete e.data,delete e.layout,delete e._fullData,delete e._fullLayout,delete e.calcdata,delete e.framework,delete e.empty,delete e.fid,delete e.undoqueue,delete e.undonum,delete e.autoplay,delete e.changed,delete e._promises,delete e._redrawTimer,delete e._hmlumcount,delete e._hmpixcount,delete e._transitionData,delete e._transitioning,delete e._initialAutoSize,delete e._transitioningWithDuration,delete e._dragging,delete e._dragged,delete e._dragdata,delete e._hoverdata,delete e._snapshotInProgress,delete e._editing,delete e._mouseDownTime,delete e._legendMouseDownTime,e.removeAllListeners&&e.removeAllListeners()},_.style=function(e){var t=e._fullLayout._visibleModules,a=[],o;for(o=0;o<t.length;o++){var r=t[o];r.style&&L.pushUnique(a,r.style)}for(o=0;o<a.length;o++)a[o](e)},_.sanitizeMargins=function(e){if(e&&e.margin){var t=e.width,a=e.height,o=e.margin,r=t-(o.l+o.r),i=a-(o.t+o.b),n;0>r&&(n=(t-1)/(o.l+o.r),o.l=w(n*o.l),o.r=w(n*o.r)),0>i&&(n=(a-1)/(o.t+o.b),o.t=w(n*o.t),o.b=w(n*o.b))}},_.clearAutoMarginIds=function(e){e._fullLayout._pushmarginIds={}},_.allowAutoMargin=function(e,t){e._fullLayout._pushmarginIds[t]=1},_.autoMargin=function(e,t,a){var o=e._fullLayout,r=o._pushmargin,i=o._pushmarginIds;if(!1!==o.margin.autoexpand){if(!a)delete r[t],delete i[t];else{var n=a.pad;if(n===void 0){var l=o.margin;n=x(12,l.l,l.r,l.t,l.b)}a.l+a.r>.5*o.width&&(L.log("Margin push",t,"is too big in x, dropping"),a.l=a.r=0),a.b+a.t>.5*o.height&&(L.log("Margin push",t,"is too big in y, dropping"),a.b=a.t=0);var s=a.xl===void 0?a.x:a.xl,d=a.xr===void 0?a.x:a.xr,c=a.yt===void 0?a.y:a.yt,p=a.yb===void 0?a.y:a.yb;r[t]={l:{val:s,size:a.l+n},r:{val:d,size:a.r+n},b:{val:p,size:a.b+n},t:{val:c,size:a.t+n}},i[t]=1}if(!o._replotting)return _.doAutoMargin(e)}},_.doAutoMargin=function(e){var t=e._fullLayout;t._size||(t._size={}),u(t);var a=t._size,o=t.margin,r=L.extendFlat({},a),i=o.l,n=o.r,l=o.t,s=o.b,d=t.width,c=t.height,p=t._pushmargin,g=t._pushmarginIds;if(!1!==t.margin.autoexpand){for(var m in p)g[m]||delete p[m];for(var h in p.base={l:{val:0,size:i},r:{val:1,size:n},t:{val:1,size:l},b:{val:0,size:s}},p){var y=p[h].l||{},x=p[h].b||{},b=y.val,v=y.size,w=x.val,k=x.size;for(var S in p){if(T(v)&&p[S].r){var C=p[S].r.val,E=p[S].r.size;if(C>b){var I=(v*C+(E-d)*b)/(C-b),P=(E*(1-b)+(v-d)*(1-C))/(C-b);0<=I&&0<=P&&0<d-(I+P)&&I+P>i+n&&(i=I,n=P)}}if(T(k)&&p[S].t){var z=p[S].t.val,D=p[S].t.size;if(z>w){var O=(k*z+(D-c)*w)/(z-w),R=(D*(1-w)+(k-c)*(1-z))/(z-w);0<=O&&0<=R&&0<c-(R+O)&&O+R>s+l&&(s=O,l=R)}}}}}if(a.l=f(i),a.r=f(n),a.t=f(l),a.b=f(s),a.p=f(o.pad),a.w=f(d)-a.l-a.r,a.h=f(c)-a.t-a.b,!t._replotting&&_.didMarginChange(r,a)){"_redrawFromAutoMarginCount"in t?t._redrawFromAutoMarginCount++:t._redrawFromAutoMarginCount=1;var M=3*(1+Object.keys(g).length);if(t._redrawFromAutoMarginCount<M)return A.call("plot",e);L.warn("Too many auto-margin redraws.")}};var U=["l","r","t","b","p","w","h"];_.didMarginChange=function(e,t){for(var a=0;a<U.length;a++){var o=U[a],r=e[o],n=t[o];if(!T(r)||1<b(n-r))return!0}return!1},_.graphJson=function(e,t,a,o,r,i){function n(e,t){if("function"==typeof e)return t?"_function_":null;if(L.isPlainObject(e)){var r={},o;return Object.keys(e).sort().forEach(function(i){if(-1===["_","["].indexOf(i.charAt(0))){if("function"==typeof e[i])return void(t&&(r[i]="_function"));if("keepdata"===a){if("src"===i.substr(i.length-3))return;}else if("keepstream"===a){if(o=e[i+"src"],"string"==typeof o&&0<o.indexOf(":")&&!L.isPlainObject(e.stream))return;}else if("keepall"!==a&&(o=e[i+"src"],"string"==typeof o&&0<o.indexOf(":")))return;r[i]=n(e[i],t)}}),r}return Array.isArray(e)?e.map(function(e){return n(e,t)}):L.isTypedArray(e)?L.simpleMap(e,L.identity):L.isJSDate(e)?L.ms2DateTimeLocal(+e):e}(r&&t&&!e._fullData||r&&!t&&!e._fullLayout)&&_.supplyDefaults(e);var l=r?e._fullData:e.data,s=r?e._fullLayout:e.layout,d=(e._transitionData||{})._frames,c={data:(l||[]).map(function(e){var a=n(e);return t&&delete a.fit,a})};return t||(c.layout=n(s)),e.framework&&e.framework.isPolar&&(c=e.framework.getConfig()),d&&(c.frames=n(d)),i&&(c.config=n(e._context,!0)),"object"===o?c:JSON.stringify(c)},_.modifyFrames=function(e,t){var a=e._transitionData._frames,o=e._transitionData._frameHash,r,n,l;for(r=0;r<t.length;r++)switch(n=t[r],n.type){case"replace":l=n.value;var s=(a[n.index]||{}).name,d=l.name;a[n.index]=o[d]=l,d!==s&&(delete o[s],o[d]=l);break;case"insert":l=n.value,o[l.name]=l,a.splice(n.index,0,l);break;case"delete":l=a[n.index],delete o[l.name],a.splice(n.index,1);}return Promise.resolve()},_.computeFrame=function(e,t){var a=e._transitionData._frameHash,o,r,n,l;if(!t)throw new Error("computeFrame must be given a string frame name");var s=a[t.toString()];if(!s)return!1;for(var d=[s],c=[s.name];s.baseframe&&(s=a[s.baseframe.toString()])&&!(-1!==c.indexOf(s.name));)d.push(s),c.push(s.name);for(var p={};s=d.pop();)if(s.layout&&(p.layout=_.extendLayout(p.layout,s.layout)),s.data){if(p.data||(p.data=[]),r=s.traces,!r)for(r=[],o=0;o<s.data.length;o++)r[o]=o;for(p.traces||(p.traces=[]),o=0;o<s.data.length;o++)(n=r[o],void 0!==n&&null!==n)&&(l=p.traces.indexOf(n),-1===l&&(l=p.data.length,p.traces[l]=n),p.data[l]=_.extendTrace(p.data[l],s.data[o]))}return p},_.recomputeFrameHash=function(e){for(var t=e._transitionData._frameHash={},a=e._transitionData._frames,o=0,r;o<a.length;o++)r=a[o],r&&r.name&&(t[r.name]=r)},_.extendObjectWithContainers=function(e,t,a){var o=L.extendDeepNoArrays({},t||{}),r=L.expandObjectPaths(o),n={},l,s,d,c,p,u,g,m;if(a&&a.length)for(d=0;d<a.length;d++)l=L.nestedProperty(r,a[d]),s=l.get(),void 0===s?L.nestedProperty(n,a[d]).set(null):(l.set(null),L.nestedProperty(n,a[d]).set(s));if(e=L.extendDeepNoArrays(e||{},r),a&&a.length)for(d=0;d<a.length;d++)if(p=L.nestedProperty(n,a[d]),g=p.get(),g){for(u=L.nestedProperty(e,a[d]),m=u.get(),Array.isArray(m)||(m=[],u.set(m)),c=0;c<g.length;c++){var h=g[c];m[c]=null===h?null:_.extendObjectWithContainers(m[c],h)}u.set(m)}return e},_.dataArrayContainers=["transforms","dimensions"],_.layoutArrayContainers=A.layoutArrayContainers,_.extendTrace=function(e,t){return _.extendObjectWithContainers(e,t,_.dataArrayContainers)},_.extendLayout=function(e,t){return _.extendObjectWithContainers(e,t,_.layoutArrayContainers)},_.transition=function(e,t,a,o,r,l){var s={redraw:r.redraw},d={},c=[];return s.prepareFn=function(){for(var r=Array.isArray(t)?t.length:0,l=o.slice(0,r),s=0;s<l.length;s++){var p=l[s],u=e._fullData[p],g=u._module;if(g){if(g.animatable){var m=g.basePlotModule.name;d[m]||(d[m]=[]),d[m].push(p)}e.data[l[s]]=_.extendTrace(e.data[l[s]],t[s])}}var n=L.expandObjectPaths(L.extendDeepNoArrays({},a));for(var h in n)/^[xy]axis[0-9]*$/.test(h)&&delete n[h].range;_.extendLayout(e.layout,n),delete e.calcdata,_.supplyDefaults(e),_.doCalcdata(e);var y=L.expandObjectPaths(a);if(y){var f=e._fullLayout._plots;for(var x in f){var b=f[x],v=b.xaxis,w=b.yaxis,k=v.range.slice(),T=w.range.slice(),A=null,S=null,C=null,E=null;Array.isArray(y[v._name+".range"])?A=y[v._name+".range"].slice():Array.isArray((y[v._name]||{}).range)&&(A=y[v._name].range.slice()),Array.isArray(y[w._name+".range"])?S=y[w._name+".range"].slice():Array.isArray((y[w._name]||{}).range)&&(S=y[w._name].range.slice()),k&&A&&(v.r2l(k[0])!==v.r2l(A[0])||v.r2l(k[1])!==v.r2l(A[1]))&&(C={xr0:k,xr1:A}),T&&S&&(w.r2l(T[0])!==w.r2l(S[0])||w.r2l(T[1])!==w.r2l(S[1]))&&(E={yr0:T,yr1:S}),(C||E)&&c.push(L.extendFlat({plotinfo:b},C,E))}}return Promise.resolve()},s.runFn=function(t){var o=e._fullLayout._basePlotModules,r=c.length,s,p;if(a)for(p=0;p<o.length;p++)o[p].transitionAxes&&o[p].transitionAxes(e,c,l,t);for(var u in r?(s=L.extendFlat({},l),s.duration=0,delete d.cartesian):s=l,d){var n=d[u],g=e._fullData[n[0]]._module;g.basePlotModule.plot(e,n,s,t)}},g(e,l,s)},_.transitionFromReact=function(e,t,a,o){var r=e._fullLayout,n=r.transition,l={},s=[];return l.prepareFn=function(){var e=r._plots;for(var i in l.redraw=!1,"some"===t.anim&&(l.redraw=!0),"some"===a.anim&&(l.redraw=!0),e){var n=e[i],d=n.xaxis,c=n.yaxis,p=o[d._name].range.slice(),u=o[c._name].range.slice(),g=d.range.slice(),m=c.range.slice();d.setScale(),c.setScale();var h=null,y=null;(d.r2l(p[0])!==d.r2l(g[0])||d.r2l(p[1])!==d.r2l(g[1]))&&(h={xr0:p,xr1:g}),(c.r2l(u[0])!==c.r2l(m[0])||c.r2l(u[1])!==c.r2l(m[1]))&&(y={yr0:u,yr1:m}),(h||y)&&s.push(L.extendFlat({plotinfo:n},h,y))}return Promise.resolve()},l.runFn=function(a){function o(){for(var t=0;t<c.length;t++)c[t].transitionAxes&&c[t].transitionAxes(e,s,g,a)}function r(){for(var t=0;t<c.length;t++)c[t].plot(e,h,m,a)}for(var l=e._fullData,d=e._fullLayout,c=d._basePlotModules,p=[],u=0,g,m,h;u<l.length;u++)p.push(u);s.length&&t.anim?"traces first"===n.ordering?(g=L.extendFlat({},n,{duration:0}),h=p,m=n,setTimeout(o,n.duration),r()):(g=n,h=null,m=L.extendFlat({},n,{duration:0}),setTimeout(r,g.duration),o()):s.length?(g=n,o()):t.anim&&(h=p,m=n,r())},g(e,n,l)},_.doCalcdata=function(e,t){function a(t){if(c=n[t],p=c._module,!0===c.visible&&c.transforms){if(p&&p.calc){var a=p.calc(e,c);a[0]&&a[0].t&&a[0].t._scene&&delete a[0].t._scene.dirty}for(g=0;g<c.transforms.length;g++){var o=c.transforms[g];p=B[o.type],p&&p.calcTransform&&(c._hasCalcTransform=!0,b=!0,p.calcTransform(e,c,o))}}}function o(t,a){if(c=n[t],p=c._module,!!p.isContainer===a){var o=[];if(!0===c.visible&&0!==c._length){delete c._indexToPoints;var r=c.transforms||[];for(g=r.length-1;0<=g;g--)if(r[g].enabled){c._indexToPoints=r[g]._indexToPoints;break}p&&p.calc&&(o=p.calc(e,c))}Array.isArray(o)&&o[0]||(o=[{x:I,y:I}]),o[0].t||(o[0].t={}),o[0].trace=c,s[t]=o}}var r=P.list(e),n=e._fullData,l=e._fullLayout,s=Array(n.length),d=(e.calcdata||[]).slice(),c,p,u,g;for(e.calcdata=s,l._numBoxes=0,l._numViolins=0,l._violinScaleGroupStats={},e._hmpixcount=0,e._hmlumcount=0,l._piecolormap={},l._sunburstcolormap={},l._treemapcolormap={},l._funnelareacolormap={},u=0;u<n.length;u++)if(Array.isArray(t)&&-1===t.indexOf(u)){s[u]=d[u];continue}for(u=0;u<n.length;u++)c=n[u],c._arrayAttrs=S.findArrayAttributes(c),c._extremes={};var f=l._subplots.polar||[];for(u=0;u<f.length;u++)r.push(l[f[u]].radialaxis,l[f[u]].angularaxis);for(var x in l._colorAxes){var _=l[x];!1!==_.cauto&&(delete _.cmin,delete _.cmax)}var b=!1;for(h(r,n,l),u=0;u<n.length;u++)o(u,!0);for(u=0;u<n.length;u++)a(u);for(b&&h(r,n,l),u=0;u<n.length;u++)o(u,!0);for(u=0;u<n.length;u++)o(u,!1);y(e);var v=m(r,e);if(v.length){for(l._numBoxes=0,l._numViolins=0,u=0;u<v.length;u++)o(v[u],!0);for(u=0;u<v.length;u++)o(v[u],!1);y(e)}A.getComponentMethod("fx","calc")(e),A.getComponentMethod("errorbars","calc")(e)};var H=/(total|sum|min|max|mean|median) (ascending|descending)/;_.rehover=function(e){e._fullLayout._rehover&&e._fullLayout._rehover()},_.redrag=function(e){e._fullLayout._redrag&&e._fullLayout._redrag()},_.generalUpdatePerTraceModule=function(e,t,a,o){var r=t.traceHash,n={},l;for(l=0;l<a.length;l++){var s=a[l],d=s[0].trace;d.visible&&(n[d.type]=n[d.type]||[],n[d.type].push(s))}for(var c in r)if(!n[c]){var p=r[c][0],u=p[0].trace;u.visible=!1,n[c]=[p]}for(var g in n){var m=n[g],h=m[0][0].trace._module;h.plot(e,t,L.filterVisible(m),o)}t.traceHash=n},_.plotBasePlot=function(e,t,a,o,r){var i=A.getModule(e),n=R(t.calcdata,i)[0];i.plot(t,n,o,r)},_.cleanBasePlot=function(e,t,a,o,r){var i=r._has&&r._has(e),n=a._has&&a._has(e);i&&!n&&r["_"+e+"layer"].selectAll("g.trace").remove()}},{"../components/color":524,"../constants/numerical":633,"../lib":657,"../plot_api/plot_schema":694,"../plot_api/plot_template":695,"../plots/get_data":742,"../registry":788,"./animation_attributes":700,"./attributes":702,"./cartesian/axis_ids":708,"./cartesian/handle_outline":715,"./command":731,"./font_attributes":733,"./frame_attributes":734,"./layout_attributes":759,d3:108,"fast-isnumeric":201}],769:[function(e,t){'use strict';t.exports={attr:"subplot",name:"polar",axisNames:["angularaxis","radialaxis"],axisName2dataArray:{angularaxis:"theta",radialaxis:"r"},layerNames:["draglayer","plotbg","backplot","angular-grid","radial-grid","frontplot","angular-line","radial-line","angular-axis","radial-axis"],radialDragBoxSize:50,angularDragBoxSize:30,cornerLen:25,cornerHalfWidth:2,MINDRAG:8,MINZOOM:20,OFFEDGE:20}},{}],770:[function(e,t){'use strict';var d=Math.cos,c=Math.sin,p=Math.min,u=Math.tan;function a(e,t,o,a){var r=a[0],i=a[1],n=l(c(t)-c(e)),s=l(d(t)-d(e)),p=u(o),g=l(1/p),h=n/s,m=i-h*r,y,f;return g?n&&s?(y=m/(p-h),f=p*y):s?(y=i*g,f=i):(y=r,f=r*p):n&&s?(y=0,f=m):s?(y=0,f=i):y=f=NaN,[y,f]}function o(e,t){var a=t.length,o=Array(a+1),r;for(r=0;r<a;r++){var n=t[r];o[r]=[e*d(n),e*c(n)]}return o[r]=o[0].slice(),o}function i(e,t,o,r){function n(t){return[e*d(t),e*c(t)]}function l(e,t,o){return a(e,t,o,n(e))}function s(e){return g.mod(e,u)}function p(e){return y(e,[t,o])}var u=r.length,m=[],f=h(r,function(e){return p(e)?x(e,t):1/0}),_=l(r[f],r[s(f-1)],t),b,v;for(m.push(_),b=f,v=0;v<u;b++,v++){var w=r[s(b)];if(!p(w))break;m.push(n(w))}var k=h(r,function(e){return p(e)?x(e,o):1/0}),T=l(r[k],r[s(k+1)],o);return m.push(T),m.push([0,0]),m.push(m[0].slice()),m}function n(e,t,a,r){return g.isFullCircle([t,a])?o(e,r):i(e,t,a,r)}function l(e){return 1e-10<Math.abs(e)?e:0}function s(e,t,a){t=t||0,a=a||0;for(var o=e.length,r=Array(o),n=0,l;n<o;n++)l=e[n],r[n]=[t+l[0],a-l[1]];return r}var g=e("../../lib"),m=e("../../lib/polygon").tester,h=g.findIndexOfMin,y=g.isAngleInsideSector,f=g.angleDelta,x=g.angleDist;t.exports={isPtInsidePolygon:function(e,t,a,o,r){if(!y(t,o))return!1;var i,l;a[0]<a[1]?(i=a[0],l=a[1]):(i=a[1],l=a[0]);var s=m(n(i,o[0],o[1],r)),p=m(n(l,o[0],o[1],r)),u=[e*d(t),e*c(t)];return p.contains(u)&&!s.contains(u)},findPolygonOffset:function(e,t,a,o){for(var r=1/0,l=1/0,s=n(e,t,a,o),d=0,c;d<s.length;d++)c=s[d],r=p(r,c[0]),l=p(l,-c[1]);return[r,l]},findEnclosingVertexAngles:function(e,t){var a=h(t,function(t){var a=f(t,e);return 0<a?a:1/0}),o=g.mod(a+1,t.length);return[t[a],t[o]]},findIntersectionXY:a,findXYatLength:function(e,o,r,i){var n=-o*r,t=o*o+1,a=2*(o*n-r),l=Math.sqrt(a*a-4*t*(n*n+r*r-e*e)),s=(-a+l)/(2*t),d=(-a-l)/(2*t);return[[s,o*s+n+i],[d,o*d+n+i]]},clampTiny:l,pathPolygon:function(e,t,a,o,r,i){var l=n(e,t,a,o);return"M"+s(l,r,i).join("L")},pathPolygonAnnulus:function(e,t,a,o,r,i,l){var d,c;e<t?(d=e,c=t):(d=t,c=e);var p=s(n(d,a,o,r),i,l),u=s(n(c,a,o,r),i,l);return"M"+u.reverse().join("L")+"M"+p.join("L")}}},{"../../lib":657,"../../lib/polygon":669}],771:[function(e,t){'use strict';var a=e("../get_data").getSubplotCalcData,o=e("../../lib").counterRegex,r=e("./polar"),i=e("./constants"),n=i.attr,l=i.name,s=o(l),d={};d[n]={valType:"subplotid",dflt:l,editType:"calc"},t.exports={attr:n,name:l,idRoot:l,idRegex:s,attrRegex:s,attributes:d,layoutAttributes:e("./layout_attributes"),supplyLayoutDefaults:e("./layout_defaults"),plot:function(e){for(var t=e._fullLayout,o=e.calcdata,n=t._subplots[l],s=0;s<n.length;s++){var d=n[s],c=a(o,l,d),p=t[d]._subplot;p||(p=r(e,d),t[d]._subplot=p),p.plot(c,t,e._promises)}},clean:function(e,t,a,o){for(var r=o._subplots[l]||[],n=o._has&&o._has("gl"),s=t._has&&t._has("gl"),d=0;d<r.length;d++){var c=r[d],p=o[c]._subplot;if(!t[c]&&!!p)for(var u in p.framework.remove(),p.layers["radial-axis-title"].remove(),p.clipPaths)p.clipPaths[u].remove();n&&!s&&p._scene&&(p._scene.destroy(),p._scene=null)}},toSVG:e("../cartesian").toSVG}},{"../../lib":657,"../cartesian":718,"../get_data":742,"./constants":769,"./layout_attributes":772,"./layout_defaults":773,"./polar":780}],772:[function(e,t){'use strict';var a=e("../../components/color/attributes"),o=e("../cartesian/layout_attributes"),r=e("../domain").attributes,i=e("../../lib").extendFlat,n=e("../../plot_api/edit_types").overrideAll,l=n({color:o.color,showline:i({},o.showline,{dflt:!0}),linecolor:o.linecolor,linewidth:o.linewidth,showgrid:i({},o.showgrid,{dflt:!0}),gridcolor:o.gridcolor,gridwidth:o.gridwidth},"plot","from-root"),s=n({tickmode:o.tickmode,nticks:o.nticks,tick0:o.tick0,dtick:o.dtick,tickvals:o.tickvals,ticktext:o.ticktext,ticks:o.ticks,ticklen:o.ticklen,tickwidth:o.tickwidth,tickcolor:o.tickcolor,showticklabels:o.showticklabels,showtickprefix:o.showtickprefix,tickprefix:o.tickprefix,showticksuffix:o.showticksuffix,ticksuffix:o.ticksuffix,showexponent:o.showexponent,exponentformat:o.exponentformat,separatethousands:o.separatethousands,tickfont:o.tickfont,tickangle:o.tickangle,tickformat:o.tickformat,tickformatstops:o.tickformatstops,layer:o.layer},"plot","from-root"),d={visible:i({},o.visible,{dflt:!0}),type:i({},o.type,{values:["-","linear","log","date","category"]}),autorange:i({},o.autorange,{editType:"plot"}),rangemode:{valType:"enumerated",values:["tozero","nonnegative","normal"],dflt:"tozero",editType:"calc"},range:i({},o.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],editType:"plot"}),categoryorder:o.categoryorder,categoryarray:o.categoryarray,angle:{valType:"angle",editType:"plot"},side:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"clockwise",editType:"plot"},title:{text:i({},o.title.text,{editType:"plot",dflt:""}),font:i({},o.title.font,{editType:"plot"}),editType:"plot"},hoverformat:o.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{title:o._deprecated.title,titlefont:o._deprecated.titlefont}};i(d,l,s);var c={visible:i({},o.visible,{dflt:!0}),type:{valType:"enumerated",values:["-","linear","category"],dflt:"-",editType:"calc",_noTemplating:!0},categoryorder:o.categoryorder,categoryarray:o.categoryarray,thetaunit:{valType:"enumerated",values:["radians","degrees"],dflt:"degrees",editType:"calc"},period:{valType:"number",editType:"calc",min:0},direction:{valType:"enumerated",values:["counterclockwise","clockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",editType:"calc"},hoverformat:o.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc"};i(c,l,s),t.exports={domain:r({name:"polar",editType:"plot"}),sector:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],dflt:[0,360],editType:"plot"},hole:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},bgcolor:{valType:"color",editType:"plot",dflt:a.background},radialaxis:d,angularaxis:c,gridshape:{valType:"enumerated",values:["circular","linear"],dflt:"circular",editType:"plot"},uirevision:{valType:"any",editType:"none"},editType:"calc"}},{"../../components/color/attributes":523,"../../lib":657,"../../plot_api/edit_types":688,"../cartesian/layout_attributes":719,"../domain":732}],773:[function(e,t){'use strict';var r=Math.round;function a(e,t,a,d){function y(e,t){return a(S+"."+e,t)}var v=a("bgcolor");d.bgColor=l.combine(v,d.paper_bgcolor);var w=a("sector");a("hole");for(var k=c(d.fullData,_.name,d.id),T=d.layoutOut,A=0,S;A<b.length;A++){S=b[A],n.isPlainObject(e[S])||(e[S]={});var C=e[S],L=s.newContainer(t,S);L._id=L._name=S,L._attr=d.id+"."+S,L._traceIndices=k.map(function(e){return e._expandedIndex});var E=_.axisName2dataArray[S],I=o(C,L,y,k,E);m(C,L,y,{axData:k,dataAttr:E});var P=y("visible");x(L,t,T),y("uirevision",t.uirevision);var z,D;switch(P&&(z=y("color"),D=z===C.color?z:d.font.color),L._m=1,S){case"radialaxis":var O=y("autorange",!L.isValidRange(C.range));C.autorange=O,O&&("linear"===I||"-"===I)&&y("rangemode"),"reversed"===O&&(L._m=-1),y("range"),L.cleanRange("range",{dfltRange:[0,1]}),P&&(y("side"),y("angle",w[0]),y("title.text"),n.coerceFont(y,"title.font",{family:d.font.family,size:r(1.2*d.font.size),color:D}));break;case"angularaxis":if("date"===I){n.log("Polar plots do not support date angular axes yet.");for(var R=0;R<k.length;R++)k[R].visible=!1;I=C.type=L.type="linear"}"linear"===I?y("thetaunit"):y("period");var M=y("direction");y("rotation",{counterclockwise:0,clockwise:90}[M]);}if(P){p(C,L,y,L.type),g(C,L,y,L.type,{tickSuffixDflt:"degrees"===L.thetaunit?"\xB0":void 0}),u(C,L,y,{outerTicks:!0});var B=y("showticklabels");B&&(n.coerceFont(y,"tickfont",{family:d.font.family,size:d.font.size,color:D}),y("tickangle"),y("tickformat")),h(C,L,y,{dfltColor:z,bgColor:d.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:f[S]}),y("layer")}"category"!==I&&y("hoverformat"),L._input=C}"category"===t.angularaxis.type&&a("gridshape")}function o(e,t,a,o,r){var n=a("type");if("-"===n){for(var l=0,s;l<o.length;l++)if(o[l].visible){s=o[l];break}s&&s[r]&&(t.type=y(s[r],"gregorian")),"-"===t.type?t.type="linear":e.type=t.type}return t.type}var n=e("../../lib"),l=e("../../components/color"),s=e("../../plot_api/plot_template"),d=e("../subplot_defaults"),c=e("../get_data").getSubplotData,p=e("../cartesian/tick_value_defaults"),u=e("../cartesian/tick_mark_defaults"),g=e("../cartesian/tick_label_defaults"),m=e("../cartesian/category_order_defaults"),h=e("../cartesian/line_grid_defaults"),y=e("../cartesian/axis_autotype"),f=e("./layout_attributes"),x=e("./set_convert"),_=e("./constants"),b=_.axisNames;t.exports=function(e,t,o){d(e,t,o,{type:_.name,attributes:f,handleDefaults:a,font:t.font,paper_bgcolor:t.paper_bgcolor,fullData:o,layoutOut:t})}},{"../../components/color":524,"../../lib":657,"../../plot_api/plot_template":695,"../cartesian/axis_autotype":706,"../cartesian/category_order_defaults":709,"../cartesian/line_grid_defaults":721,"../cartesian/tick_label_defaults":726,"../cartesian/tick_mark_defaults":727,"../cartesian/tick_value_defaults":728,"../get_data":742,"../subplot_defaults":782,"./constants":769,"./layout_attributes":772,"./set_convert":781}],774:[function(e,t){'use strict';var a=e("../../../traces/scatter/attributes"),o=a.marker,r=e("../../../lib/extend").extendFlat;t.exports={r:r({},a.r,{}),t:r({},a.t,{}),marker:{color:r({},o.color,{}),size:r({},o.size,{}),symbol:r({},o.symbol,{}),opacity:r({},o.opacity,{}),editType:"calc"}}},{"../../../lib/extend":648,"../../../traces/scatter/attributes":1062}],775:[function(e,t){'use strict';function a(e,t){return r({},t,{showline:{valType:"boolean"},showticklabels:{valType:"boolean"},tickorientation:{valType:"enumerated",values:["horizontal","vertical"]},ticklen:{valType:"number",min:0},tickcolor:{valType:"color"},ticksuffix:{valType:"string"},endpadding:{valType:"number",description:n},visible:{valType:"boolean"}})}var o=e("../../cartesian/layout_attributes"),r=e("../../../lib/extend").extendFlat,i=e("../../../plot_api/edit_types").overrideAll,n="Legacy polar charts are deprecated! Please switch to *polar* subplots.",l=r({},o.domain,{});t.exports=i({radialaxis:a("radial",{range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},domain:l,orientation:{valType:"number"}}),angularaxis:a("angular",{range:{valType:"info_array",items:[{valType:"number",dflt:0},{valType:"number",dflt:360}]},domain:l}),layout:{direction:{valType:"enumerated",values:["clockwise","counterclockwise"]},orientation:{valType:"angle"}}},"plot","nested")},{"../../../lib/extend":648,"../../../plot_api/edit_types":688,"../../cartesian/layout_attributes":719}],776:[function(e,t){'use strict';var a=t.exports=e("./micropolar");a.manager=e("./micropolar_manager")},{"./micropolar":777,"./micropolar_manager":778}],777:[function(e,t){var a=Math.atan2,o=Math.cos,r=Math.sqrt,i=Math.round,n=Math.PI,l=Math.sin,s=Math.min,d=Math.abs,c=Math.max,p=e("d3"),u=e("../../../lib"),g=u.extendDeepAll,m=e("../../../constants/alignment").MID_SHIFT,h=t.exports={version:"0.2.2"};h.Axis=function(){function e(e){u=e||u;var a=t.data,x=t.layout;return("string"==typeof u||u.nodeName)&&(u=p.select(u)),u.datum(a).each(function(e){function t(e){return f(e)%360+x.orientation}var a=e.slice();o={data:h.util.cloneJson(a),layout:h.util.cloneJson(x)};var r=0;a.forEach(function(e,t){e.color||(e.color=x.defaultColorRange[r],r=(r+1)%x.defaultColorRange.length),e.strokeColor||(e.strokeColor="LinePlot"===e.geometry?e.color:p.rgb(e.color).darker().toString()),o.data[t].color=e.color,o.data[t].strokeColor=e.strokeColor,o.data[t].strokeDash=e.strokeDash,o.data[t].strokeSize=e.strokeSize});var n=a.filter(function(e){var t=e.visible;return"undefined"==typeof t||!0===t}),u=!1,_=n.map(function(e){return u=u||"undefined"!=typeof e.groupId,e});if(u){var b=p.nest().key(function(e){return"undefined"==typeof e.groupId?"unstacked":e.groupId}).entries(_),v=[],w=b.map(function(e){if("unstacked"===e.key)return e.values;var t=e.values[0].r.map(function(){return 0});return e.values.forEach(function(e){e.yStack=[t],v.push(t),t=h.util.sumArrays(e.r,t)}),e.values});n=p.merge(w)}n.forEach(function(e){e.t=Array.isArray(e.t[0])?e.t:[e.t],e.r=Array.isArray(e.r[0])?e.r:[e.r]});var k=s(x.width-x.margin.left-x.margin.right,x.height-x.margin.top-x.margin.bottom)/2;k=c(10,k);var T=[x.margin.left+k,x.margin.top+k],A;if(u){var S=p.max(h.util.sumArrays(h.util.arrayLast(n).r[0],h.util.arrayLast(v)));A=[0,S]}else A=p.extent(h.util.flattenArray(n.map(function(e){return e.r})));x.radialAxis.domain!=h.DATAEXTENT&&(A[0]=0),y=p.scale.linear().domain(x.radialAxis.domain!=h.DATAEXTENT&&x.radialAxis.domain?x.radialAxis.domain:A).range([0,k]),o.layout.radialAxis.domain=y.domain();var C=h.util.flattenArray(n.map(function(e){return e.t})),L="string"==typeof C[0],E;L&&(C=h.util.deduplicate(C),E=C.slice(),C=p.range(C.length),n=n.map(function(e){var t=e;return e.t=[C],u&&(t.yStack=e.yStack),t}));var I=n.filter(function(e){return"LinePlot"===e.geometry||"DotPlot"===e.geometry}).length===n.length,P=null===x.needsEndSpacing?L||!I:x.needsEndSpacing,z=x.angularAxis.domain&&x.angularAxis.domain!=h.DATAEXTENT&&!L&&0<=x.angularAxis.domain[0],D=z?x.angularAxis.domain:p.extent(C),O=d(C[1]-C[0]);I&&!L&&(O=0);var R=D.slice();P&&L&&(R[1]+=O);var M=x.angularAxis.ticksCount||4;8<M&&(M=M/(M/8)+M%8),x.angularAxis.ticksStep&&(M=(R[1]-R[0])/M);var j=x.angularAxis.ticksStep||(R[1]-R[0])/(M*(x.minorTicks+1));E&&(j=c(i(j),1)),R[2]||(R[2]=j);var B=p.range.apply(this,R);if(B=B.map(function(e){return parseFloat(e.toPrecision(12))}),f=p.scale.linear().domain(R.slice(0,2)).range("clockwise"===x.direction?[0,360]:[360,0]),o.layout.angularAxis.domain=f.domain(),o.layout.angularAxis.endPadding=P?O:0,l=p.select(this).select("svg.chart-root"),"undefined"==typeof l||l.empty()){var F=new DOMParser().parseFromString("<svg xmlns='http://www.w3.org/2000/svg' class='chart-root'>' + '<g class='outer-group'>' + '<g class='chart-group'>' + '<circle class='background-circle'></circle>' + '<g class='geometry-group'></g>' + '<g class='radial axis-group'>' + '<circle class='outside-circle'></circle>' + '</g>' + '<g class='angular axis-group'></g>' + '<g class='guides-group'><line></line><circle r='0'></circle></g>' + '</g>' + '<g class='legend-group'></g>' + '<g class='tooltips-group'></g>' + '<g class='title-group'><text></text></g>' + '</g>' + '</svg>","application/xml"),N=this.appendChild(this.ownerDocument.importNode(F.documentElement,!0));l=p.select(N)}l.select(".guides-group").style({"pointer-events":"none"}),l.select(".angular.axis-group").style({"pointer-events":"none"}),l.select(".radial.axis-group").style({"pointer-events":"none"});var V=l.select(".chart-group"),U={fill:"none",stroke:x.tickColor},H={"font-size":x.font.size,"font-family":x.font.family,fill:x.font.color,"text-shadow":["-1px 0px","1px -1px","-1px 1px","1px 1px"].map(function(e){return" "+e+" 0 "+x.font.outlineColor}).join(",")},q;if(x.showLegend){q=l.select(".legend-group").attr({transform:"translate("+[k,x.margin.top]+")"}).style({display:"block"});var G=n.map(function(e){var t=h.util.cloneJson(e);return t.symbol="DotPlot"===e.geometry?e.dotType||"circle":"LinePlot"==e.geometry?"line":"square",t.visibleInLegend="undefined"==typeof e.visibleInLegend||e.visibleInLegend,t.color="LinePlot"===e.geometry?e.strokeColor:e.color,t});h.Legend().config({data:n.map(function(e,t){return e.name||"Element"+t}),legendConfig:g({},h.Legend.defaultConfig().legendConfig,{container:q,elements:G,reverseOrder:x.legend.reverseOrder})})();var Y=q.node().getBBox();k=s(x.width-Y.width-x.margin.left-x.margin.right,x.height-x.margin.top-x.margin.bottom)/2,k=c(10,k),T=[x.margin.left+k,x.margin.top+k],y.range([0,k]),o.layout.radialAxis.domain=y.domain(),q.attr("transform","translate("+[T[0]+k,T[1]-k]+")")}else q=l.select(".legend-group").style({display:"none"});l.attr({width:x.width,height:x.height}).style({opacity:x.opacity}),V.attr("transform","translate("+T+")").style({cursor:"crosshair"});var W=[(x.width-(x.margin.left+x.margin.right+2*k+(Y?Y.width:0)))/2,(x.height-(x.margin.top+x.margin.bottom+2*k))/2];if(W[0]=c(0,W[0]),W[1]=c(0,W[1]),l.select(".outer-group").attr("transform","translate("+W+")"),x.title&&x.title.text){var X=l.select("g.title-group text").style(H).text(x.title.text),Z=X.node().getBBox();X.attr({x:T[0]-Z.width/2,y:T[1]-k-20})}var K=l.select(".radial.axis-group");if(x.radialAxis.gridLinesVisible){var $=K.selectAll("circle.grid-circle").data(y.ticks(5));$.enter().append("circle").attr({class:"grid-circle"}).style(U),$.attr("r",y),$.exit().remove()}K.select("circle.outside-circle").attr({r:k}).style(U);var J=l.select("circle.background-circle").attr({r:k}).style({fill:x.backgroundColor,stroke:x.stroke});if(x.radialAxis.visible){var Q=p.svg.axis().scale(y).ticks(5).tickSize(5);K.call(Q).attr({transform:"rotate("+x.radialAxis.orientation+")"}),K.selectAll(".domain").style(U),K.selectAll("g>text").text(function(){return this.textContent+x.radialAxis.ticksSuffix}).style(H).style({"text-anchor":"start"}).attr({x:0,y:0,dx:0,dy:0,transform:function(){return"horizontal"===x.radialAxis.tickOrientation?"rotate("+-x.radialAxis.orientation+") translate("+[0,H["font-size"]]+")":"translate("+[0,H["font-size"]]+")"}}),K.selectAll("g>line").style({stroke:"black"})}var ee=l.select(".angular.axis-group").selectAll("g.angular-tick").data(B),te=ee.enter().append("g").classed("angular-tick",!0);ee.attr({transform:function(e,a){return"rotate("+t(e,a)+")"}}).style({display:x.angularAxis.visible?"block":"none"}),ee.exit().remove(),te.append("line").classed("grid-line",!0).classed("major",function(e,t){return 0==t%(x.minorTicks+1)}).classed("minor",function(e,t){return 0!=t%(x.minorTicks+1)}).style(U),te.selectAll(".minor").style({stroke:x.minorTickColor}),ee.select("line.grid-line").attr({x1:x.tickLength?k-x.tickLength:0,x2:k}).style({display:x.angularAxis.gridLinesVisible?"block":"none"}),te.append("text").classed("axis-text",!0).style(H);var ae=ee.select("text.axis-text").attr({x:k+x.labelOffset,dy:m+"em",transform:function(e,a){var o=t(e,a),r=k+x.labelOffset,i=x.angularAxis.tickOrientation;return"horizontal"==i?"rotate("+-o+" "+r+" 0)":"radial"==i?270>o&&90<o?"rotate(180 "+r+" 0)":null:"rotate("+(180>=o&&0<o?-90:90)+" "+r+" 0)"}}).style({"text-anchor":"middle",display:x.angularAxis.labelsVisible?"block":"none"}).text(function(e,t){return 0==t%(x.minorTicks+1)?E?E[e]+x.angularAxis.ticksSuffix:e+x.angularAxis.ticksSuffix:""}).style(H);x.angularAxis.rewriteTicks&&ae.text(function(e,t){return 0==t%(x.minorTicks+1)?x.angularAxis.rewriteTicks(this.textContent,t):""});var oe=p.max(V.selectAll(".angular-tick text")[0].map(function(e){return e.getCTM().e+e.getBBox().width}));q.attr({transform:"translate("+[k+oe,x.margin.top]+")"});var re=0<l.select("g.geometry-group").selectAll("g").size(),ie=l.select("g.geometry-group").selectAll("g.geometry").data(n);if(ie.enter().append("g").attr({class:function(e,t){return"geometry geometry"+t}}),ie.exit().remove(),n[0]||re){var ne=[];n.forEach(function(e,t){var a={};a.radialScale=y,a.angularScale=f,a.container=ie.filter(function(e,a){return a==t}),a.geometry=e.geometry,a.orientation=x.orientation,a.direction=x.direction,a.index=t,ne.push({data:e,geometryConfig:a})});var le=p.nest().key(function(e){return"undefined"!=typeof e.data.groupId||"unstacked"}).entries(ne),se=[];le.forEach(function(e){"unstacked"===e.key?se=se.concat(e.values.map(function(e){return[e]})):se.push(e.values)}),se.forEach(function(e){var t=Array.isArray(e)?e[0].geometryConfig.geometry:e.geometryConfig.geometry;var a=e.map(function(e){return g(h[t].defaultConfig(),e)});h[t]().config(a)()})}var de=l.select(".guides-group"),ce=l.select(".tooltips-group"),pe=h.tooltipPanel().config({container:ce,fontSize:8})(),ue=h.tooltipPanel().config({container:ce,fontSize:8})(),ge=h.tooltipPanel().config({container:ce,hasTick:!0})(),me,he;if(!L){var ye=de.select("line").attr({x1:0,y1:0,y2:0}).style({stroke:"grey","pointer-events":"none"});V.on("mousemove.angular-guide",function(){var e=h.util.getMousePos(J).angle;ye.attr({x2:-k,transform:"rotate("+e+")"}).style({opacity:.5});var t=(e+180+360-x.orientation)%360;me=f.invert(t);var a=h.util.convertToCartesian(k+12,e+180);pe.text(h.util.round(me)).move([a[0]+T[0],a[1]+T[1]])}).on("mouseout.angular-guide",function(){de.select("line").style({opacity:0})})}var fe=de.select("circle").style({stroke:"grey",fill:"none"});V.on("mousemove.radial-guide",function(){var e=h.util.getMousePos(J).radius;fe.attr({r:e}).style({opacity:.5}),he=y.invert(h.util.getMousePos(J).radius);var t=h.util.convertToCartesian(e,x.radialAxis.orientation);ue.text(h.util.round(he)).move([t[0]+T[0],t[1]+T[1]])}).on("mouseout.radial-guide",function(){fe.style({opacity:0}),ge.hide(),pe.hide(),ue.hide()}),l.selectAll(".geometry-group .mark").on("mouseover.tooltip",function(e){var t=p.select(this),a=this.style.fill,o="black",r=this.style.opacity||1;if(t.attr({"data-opacity":r}),a&&"none"!==a){t.attr({"data-fill":a}),o=p.hsl(a).darker().toString(),t.style({fill:o,opacity:1});var i={t:h.util.round(e[0]),r:h.util.round(e[1])};L&&(i.t=E[e[0]]);var n="t: "+i.t+", r: "+i.r,s=this.getBoundingClientRect(),d=l.node().getBoundingClientRect(),c=[s.left+s.width/2-W[0]-d.left,s.top+s.height/2-W[1]-d.top];ge.config({color:o}).text(n),ge.move(c)}else a=this.style.stroke||"black",t.attr({"data-stroke":a}),o=p.hsl(a).darker().toString(),t.style({stroke:o,opacity:1})}).on("mousemove.tooltip",function(){return 0==p.event.which&&void(p.select(this).attr("data-fill")&&ge.show())}).on("mouseout.tooltip",function(){ge.hide();var e=p.select(this),t=e.attr("data-fill");t?e.style({fill:t,opacity:e.attr("data-opacity")}):e.style({stroke:e.attr("data-stroke"),opacity:e.attr("data-opacity")})})}),n}var t={data:[],layout:{}},a={},o={},r=p.dispatch("hover"),n={},l,u,y,f;return n.render=function(t){return e(t),this},n.config=function(e){if(!arguments.length)return t;var a=h.util.cloneJson(e);return a.data.forEach(function(e,a){t.data[a]||(t.data[a]={}),g(t.data[a],h.Axis.defaultConfig().data[0]),g(t.data[a],e)}),g(t.layout,h.Axis.defaultConfig().layout),g(t.layout,a.layout),this},n.getLiveConfig=function(){return o},n.getinputConfig=function(){return a},n.radialScale=function(){return y},n.angularScale=function(){return f},n.svg=function(){return l},p.rebind(n,r,"on"),n},h.Axis.defaultConfig=function(){var e={data:[{t:[1,2,3,4],r:[10,11,12,13],name:"Line1",geometry:"LinePlot",color:null,strokeDash:"solid",strokeColor:null,strokeSize:"1",visibleInLegend:!0,opacity:1}],layout:{defaultColorRange:p.scale.category10().range(),title:null,height:450,width:500,margin:{top:40,right:40,bottom:40,left:40},font:{size:12,color:"gray",outlineColor:"white",family:"Tahoma, sans-serif"},direction:"clockwise",orientation:0,labelOffset:10,radialAxis:{domain:null,orientation:-45,ticksSuffix:"",visible:!0,gridLinesVisible:!0,tickOrientation:"horizontal",rewriteTicks:null},angularAxis:{domain:[0,360],ticksSuffix:"",visible:!0,gridLinesVisible:!0,labelsVisible:!0,tickOrientation:"horizontal",rewriteTicks:null,ticksCount:null,ticksStep:null},minorTicks:0,tickLength:null,tickColor:"silver",minorTickColor:"#eee",backgroundColor:"none",needsEndSpacing:null,showLegend:!0,legend:{reverseOrder:!1},opacity:1}};return e},h.util={},h.DATAEXTENT="dataExtent",h.AREA="AreaChart",h.LINE="LinePlot",h.DOT="DotPlot",h.BAR="BarChart",h.util._override=function(e,t){for(var a in e)a in t&&(t[a]=e[a])},h.util._extend=function(e,t){for(var a in e)t[a]=e[a]},h.util._rndSnd=function(){return 2*Math.random()-1+(2*Math.random()-1)+(2*Math.random()-1)},h.util.dataFromEquation2=function(e,t){var a=t||6,o=p.range(0,360+a,a).map(function(t){var a=e(t*n/180);return[t,a]});return o},h.util.dataFromEquation=function(e,a,o){var i=a||6,l=[],t=[];p.range(0,360+i,i).forEach(function(a){var o=e(a*n/180);l.push(a),t.push(o)});var r={t:l,r:t};return o&&(r.name=o),r},h.util.ensureArray=function(e,t){if("undefined"==typeof e)return null;var a=[].concat(e);return p.range(t).map(function(e,t){return a[t]||a[0]})},h.util.fillArrays=function(e,t,a){return t.forEach(function(t){e[t]=h.util.ensureArray(e[t],a)}),e},h.util.cloneJson=function(e){return JSON.parse(JSON.stringify(e))},h.util.validateKeys=function(e,t){"string"==typeof t&&(t=t.split("."));var a=t.shift();return e[a]&&(!t.length||objHasKeys(e[a],t))},h.util.sumArrays=function(e,t){return p.zip(e,t).map(function(e){return p.sum(e)})},h.util.arrayLast=function(e){return e[e.length-1]},h.util.arrayEqual=function(e,t){for(var a=c(e.length,t.length,1);0<=a--&&e[a]===t[a];);return-2===a},h.util.flattenArray=function(e){for(var t=[];!h.util.arrayEqual(t,e);)t=e,e=[].concat.apply([],e);return e},h.util.deduplicate=function(e){return e.filter(function(e,t,o){return o.indexOf(e)==t})},h.util.convertToCartesian=function(e,t){var a=t*n/180,r=e*o(a),i=e*l(a);return[r,i]},h.util.round=function(e,t){var a=Math.pow(10,t||2);return i(e*a)/a},h.util.getMousePos=function(e){var t=p.mouse(e.node()),o=t[0],i=t[1],l={};return l.x=o,l.y=i,l.pos=t,l.angle=180*(a(i,o)+n)/n,l.radius=r(o*o+i*i),l},h.util.duplicatesCount=function(e){for(var t={},a={},o=0,r=e.length,n;o<r;o++)n=e[o],n in t?(t[n]++,a[n]=t[n]):t[n]=1;return a},h.util.duplicates=function(e){return Object.keys(h.util.duplicatesCount(e))},h.util.translator=function(e,t,a,o){if(o){var r=a.slice();a=t,t=r}var i=t.reduce(function(e,t){if("undefined"!=typeof e)return e[t]},e);"undefined"==typeof i||(t.reduce(function(e,a,o){if("undefined"!=typeof e)return o===t.length-1&&delete e[a],e[a]},e),a.reduce(function(e,t,o){return"undefined"==typeof e[t]&&(e[t]={}),o===a.length-1&&(e[t]=i),e[t]},e))},h.PolyChart=function(){function e(){var e=t[0].geometryConfig,a=e.container;"string"==typeof a&&(a=p.select(a)),a.datum(t).each(function(t){function a(a){var o=e.radialScale(a[1]),r=(e.angularScale(a[0])+e.orientation)*n/180;return{r:o,t:r}}function i(e){var t=e.r*o(e.t),a=e.r*l(e.t);return{x:t,y:a}}var s=!!t[0].data.yStack,c=t.map(function(e){return s?p.zip(e.data.t[0],e.data.r[0],e.data.yStack[0]):p.zip(e.data.t[0],e.data.r[0])}),u=e.angularScale,g=e.radialScale.domain()[0],m={};m.bar=function(a,o,r){var i=t[r].data,n=e.radialScale(a[1])-e.radialScale(0),l=e.radialScale(a[2]||0),s=i.barWidth;p.select(this).attr({class:"mark bar",d:"M"+[[n+l,-s/2],[n+l,s/2],[l,s/2],[l,-s/2]].join("L")+"Z",transform:function(t){return"rotate("+(e.orientation+u(t[0]))+")"}})},m.dot=function(e,o,r){var n=e[2]?[e[0],e[1]+e[2]]:e,l=p.svg.symbol().size(t[r].data.dotSize).type(t[r].data.dotType)(e,o);p.select(this).attr({class:"mark dot",d:l,transform:function(){var e=i(a(n));return"translate("+[e.x,e.y]+")"}})};var h=p.svg.line.radial().interpolate(t[0].data.lineInterpolation).radius(function(t){return e.radialScale(t[1])}).angle(function(t){return e.angularScale(t[0])*n/180});m.line=function(a,o,r){var i=a[2]?c[r].map(function(e){return[e[0],e[1]+e[2]]}):c[r];if(p.select(this).each(m.dot).style({opacity:function(){return+t[r].data.dotVisible},fill:_.stroke(a,o,r)}).attr({class:"mark dot"}),!(0<o)){var n=p.select(this.parentNode).selectAll("path.line").data([0]);n.enter().insert("path"),n.attr({class:"line",d:h(i),transform:function(){return"rotate("+(e.orientation+90)+")"},"pointer-events":"none"}).style({fill:function(){return _.fill(a,o,r)},"fill-opacity":0,stroke:function(){return _.stroke(a,o,r)},"stroke-width":function(){return _["stroke-width"](a,o,r)},"stroke-dasharray":function(){return _["stroke-dasharray"](a,o,r)},opacity:function(){return _.opacity(a,o,r)},display:function(){return _.display(a,o,r)}})}};var y=e.angularScale.range(),f=d(y[1]-y[0])/c[0].length*n/180,x=p.svg.arc().startAngle(function(){return-f/2}).endAngle(function(){return f/2}).innerRadius(function(t){return e.radialScale(g+(t[2]||0))}).outerRadius(function(t){return e.radialScale(g+(t[2]||0))+e.radialScale(t[1])});m.arc=function(){p.select(this).attr({class:"mark arc",d:x,transform:function(t){return"rotate("+(e.orientation+u(t[0])+90)+")"}})};var _={fill:function(e,a,o){return t[o].data.color},stroke:function(e,a,o){return t[o].data.strokeColor},"stroke-width":function(e,a,o){return t[o].data.strokeSize+"px"},"stroke-dasharray":function(e,a,o){return r[t[o].data.strokeDash]},opacity:function(e,a,o){return t[o].data.opacity},display:function(e,a,o){return"undefined"==typeof t[o].data.visible||t[o].data.visible?"block":"none"}},b=p.select(this).selectAll("g.layer").data(c);b.enter().append("g").attr({class:"layer"});var v=b.selectAll("path.mark").data(function(e){return e});v.enter().append("path").attr({class:"mark"}),v.style(_).each(m[e.geometryType]),v.exit().remove(),b.exit().remove()})}var t=[h.PolyChart.defaultConfig()],a=p.dispatch("hover"),r={solid:"none",dash:[5,2],dot:[2,5]},i;return e.config=function(e){return arguments.length?(e.forEach(function(e,a){t[a]||(t[a]={}),g(t[a],h.PolyChart.defaultConfig()),g(t[a],e)}),this):t},e.getColorScale=function(){return i},p.rebind(e,a,"on"),e},h.PolyChart.defaultConfig=function(){var e={data:{name:"geom1",t:[[1,2,3,4]],r:[[1,2,3,4]],dotType:"circle",dotSize:64,dotVisible:!1,barWidth:20,color:"#ffa500",strokeSize:1,strokeColor:"silver",strokeDash:"solid",opacity:1,index:0,visible:!0,visibleInLegend:!0},geometryConfig:{geometry:"LinePlot",geometryType:"arc",direction:"clockwise",orientation:0,container:"body",radialScale:null,angularScale:null,colorScale:p.scale.category20()}};return e},h.BarChart=function(){return h.PolyChart()},h.BarChart.defaultConfig=function(){return{geometryConfig:{geometryType:"bar"}}},h.AreaChart=function(){return h.PolyChart()},h.AreaChart.defaultConfig=function(){return{geometryConfig:{geometryType:"arc"}}},h.DotPlot=function(){return h.PolyChart()},h.DotPlot.defaultConfig=function(){return{geometryConfig:{geometryType:"dot",dotType:"circle"}}},h.LinePlot=function(){return h.PolyChart()},h.LinePlot.defaultConfig=function(){return{geometryConfig:{geometryType:"line"}}},h.Legend=function(){function e(){var a=t.legendConfig,o=t.data.map(function(e,t){return[].concat(e).map(function(e,o){var r=g({},a.elements[t]);return r.name=e,r.color=[].concat(a.elements[t].color)[o],r})}),r=p.merge(o);r=r.filter(function(e,t){return a.elements[t]&&(a.elements[t].visibleInLegend||"undefined"==typeof a.elements[t].visibleInLegend)}),a.reverseOrder&&(r=r.reverse());var i=a.container;("string"==typeof i||i.nodeName)&&(i=p.select(i));var n=r.map(function(e){return e.color}),l=a.fontSize,s=null==a.isContinuous?"number"==typeof r[0]:a.isContinuous,d=s?a.height:l*r.length,c=i.classed("legend-group",!0),u=c.selectAll("svg").data([0]),m=u.enter().append("svg").attr({width:300,height:d+l,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"});m.append("g").classed("legend-axis",!0),m.append("g").classed("legend-marks",!0);var h=p.range(r.length),y=p.scale[s?"linear":"ordinal"]().domain(h).range(n),f=p.scale[s?"linear":"ordinal"]().domain(h)[s?"range":"rangePoints"]([0,d]),x=function(e,t){var a=3*t;return"line"===e?"M"+[[-t/2,-t/12],[t/2,-t/12],[t/2,t/12],[-t/2,t/12]]+"Z":-1==p.svg.symbolTypes.indexOf(e)?p.svg.symbol().type("square").size(a)():p.svg.symbol().type(e).size(a)()};if(s){var _=u.select(".legend-marks").append("defs").append("linearGradient").attr({id:"grad1",x1:"0%",y1:"0%",x2:"0%",y2:"100%"}).selectAll("stop").data(n);_.enter().append("stop"),_.attr({offset:function(e,t){return 100*(t/(n.length-1))+"%"}}).style({"stop-color":function(e){return e}}),u.append("rect").classed("legend-mark",!0).attr({height:a.height,width:a.colorBandWidth,fill:"url(#grad1)"})}else{var b=u.select(".legend-marks").selectAll("path.legend-mark").data(r);b.enter().append("path").classed("legend-mark",!0),b.attr({transform:function(e,t){return"translate("+[l/2,f(t)+l/2]+")"},d:function(e){var t=e.symbol;return x(t,l)},fill:function(e,t){return y(t)}}),b.exit().remove()}var v=p.svg.axis().scale(f).orient("right"),w=u.select("g.legend-axis").attr({transform:"translate("+[s?a.colorBandWidth:l,l/2]+")"}).call(v);return w.selectAll(".domain").style({fill:"none",stroke:"none"}),w.selectAll("line").style({fill:"none",stroke:s?a.textColor:"none"}),w.selectAll("text").style({fill:a.textColor,"font-size":a.fontSize}).text(function(e,t){return r[t].name}),e}var t=h.Legend.defaultConfig(),a=p.dispatch("hover");return e.config=function(e){return arguments.length?(g(t,e),this):t},p.rebind(e,a,"on"),e},h.Legend.defaultConfig=function(){return{data:["a","b","c"],legendConfig:{elements:[{symbol:"line",color:"red"},{symbol:"square",color:"yellow"},{symbol:"diamond",color:"limegreen"}],height:150,colorBandWidth:30,fontSize:12,container:"body",isContinuous:null,textColor:"grey",reverseOrder:!1}}},h.tooltipPanel=function(){var e={container:null,hasTick:!1,fontSize:12,color:"white",padding:5},t="tooltip-"+h.tooltipPanel.uid++,a=10,o=function(){r=e.container.selectAll("g."+t).data([0]);var l=r.enter().append("g").classed(t,!0).style({"pointer-events":"none",display:"none"});return n=l.append("path").style({fill:"white","fill-opacity":.9}).attr({d:"M0 0"}),i=l.append("text").attr({dx:e.padding+a,dy:.3*+e.fontSize}),o},r,i,n;return o.text=function(t){var s=p.hsl(e.color).l,l=.5<=s?"#aaa":"white",d=.5<=s?"black":"white";i.style({fill:d,"font-size":e.fontSize+"px"}).text(t||"");var c=e.padding,u=i.node().getBBox(),g={fill:e.color,stroke:l,"stroke-width":"2px"},m=u.width+2*c+a,h=u.height+2*c;return n.attr({d:"M"+[[a,-h/2],[a,-h/4],[e.hasTick?0:a,0],[a,h/4],[a,h/2],[m,h/2],[m,-h/2]].join("L")+"Z"}).style(g),r.attr({transform:"translate("+[a,-h/2+2*c]+")"}),r.style({display:"block"}),o},o.move=function(e){if(r)return r.attr({transform:"translate("+[e[0],e[1]]+")"}).style({display:"block"}),o},o.hide=function(){if(r)return r.style({display:"none"}),o},o.show=function(){if(r)return r.style({display:"block"}),o},o.config=function(t){return g(e,t),o},o},h.tooltipPanel.uid=1,h.adapter={},h.adapter.plotly=function(){return{convert:function(e,t){var a={};if(e.data&&(a.data=e.data.map(function(e){var a=g({},e);return[[a,["marker","color"],["color"]],[a,["marker","opacity"],["opacity"]],[a,["marker","line","color"],["strokeColor"]],[a,["marker","line","dash"],["strokeDash"]],[a,["marker","line","width"],["strokeSize"]],[a,["marker","symbol"],["dotType"]],[a,["marker","size"],["dotSize"]],[a,["marker","barWidth"],["barWidth"]],[a,["line","interpolation"],["lineInterpolation"]],[a,["showlegend"],["visibleInLegend"]]].forEach(function(e){h.util.translator.apply(null,e.concat(t))}),t||delete a.marker,t&&delete a.groupId,t?("LinePlot"===a.geometry?(a.type="scatter",!0===a.dotVisible?(delete a.dotVisible,a.mode="lines+markers"):a.mode="lines"):"DotPlot"===a.geometry?(a.type="scatter",a.mode="markers"):"AreaChart"===a.geometry?a.type="area":"BarChart"===a.geometry&&(a.type="bar"),delete a.geometry):("scatter"===a.type?"lines"===a.mode?a.geometry="LinePlot":"markers"===a.mode?a.geometry="DotPlot":"lines+markers"===a.mode&&(a.geometry="LinePlot",a.dotVisible=!0):"area"===a.type?a.geometry="AreaChart":"bar"===a.type&&(a.geometry="BarChart"),delete a.mode,delete a.type),a}),!t&&e.layout&&"stack"===e.layout.barmode)){var o=h.util.duplicates(a.data.map(function(e){return e.geometry}));a.data.forEach(function(e,t){var r=o.indexOf(e.geometry);-1!=r&&(a.data[t].groupId=r)})}if(e.layout){var i=g({},e.layout),r=[[i,["plot_bgcolor"],["backgroundColor"]],[i,["showlegend"],["showLegend"]],[i,["radialaxis"],["radialAxis"]],[i,["angularaxis"],["angularAxis"]],[i.angularaxis,["showline"],["gridLinesVisible"]],[i.angularaxis,["showticklabels"],["labelsVisible"]],[i.angularaxis,["nticks"],["ticksCount"]],[i.angularaxis,["tickorientation"],["tickOrientation"]],[i.angularaxis,["ticksuffix"],["ticksSuffix"]],[i.angularaxis,["range"],["domain"]],[i.angularaxis,["endpadding"],["endPadding"]],[i.radialaxis,["showline"],["gridLinesVisible"]],[i.radialaxis,["tickorientation"],["tickOrientation"]],[i.radialaxis,["ticksuffix"],["ticksSuffix"]],[i.radialaxis,["range"],["domain"]],[i.angularAxis,["showline"],["gridLinesVisible"]],[i.angularAxis,["showticklabels"],["labelsVisible"]],[i.angularAxis,["nticks"],["ticksCount"]],[i.angularAxis,["tickorientation"],["tickOrientation"]],[i.angularAxis,["ticksuffix"],["ticksSuffix"]],[i.angularAxis,["range"],["domain"]],[i.angularAxis,["endpadding"],["endPadding"]],[i.radialAxis,["showline"],["gridLinesVisible"]],[i.radialAxis,["tickorientation"],["tickOrientation"]],[i.radialAxis,["ticksuffix"],["ticksSuffix"]],[i.radialAxis,["range"],["domain"]],[i.font,["outlinecolor"],["outlineColor"]],[i.legend,["traceorder"],["reverseOrder"]],[i,["labeloffset"],["labelOffset"]],[i,["defaultcolorrange"],["defaultColorRange"]]];if(r.forEach(function(e){h.util.translator.apply(null,e.concat(t))}),t?("undefined"!=typeof i.tickLength&&(i.angularaxis.ticklen=i.tickLength,delete i.tickLength),i.tickColor&&(i.angularaxis.tickcolor=i.tickColor,delete i.tickColor)):(i.angularAxis&&"undefined"!=typeof i.angularAxis.ticklen&&(i.tickLength=i.angularAxis.ticklen),i.angularAxis&&"undefined"!=typeof i.angularAxis.tickcolor&&(i.tickColor=i.angularAxis.tickcolor)),i.legend&&"boolean"!=typeof i.legend.reverseOrder&&(i.legend.reverseOrder="normal"!=i.legend.reverseOrder),i.legend&&"boolean"==typeof i.legend.traceorder&&(i.legend.traceorder=i.legend.traceorder?"reversed":"normal",delete i.legend.reverseOrder),i.margin&&"undefined"!=typeof i.margin.t){var n=["t","r","b","l","pad"],l=["top","right","bottom","left","pad"],s={};p.entries(i.margin).forEach(function(e){s[l[n.indexOf(e.key)]]=e.value}),i.margin=s}t&&(delete i.needsEndSpacing,delete i.minorTickColor,delete i.minorTicks,delete i.angularaxis.ticksCount,delete i.angularaxis.ticksCount,delete i.angularaxis.ticksStep,delete i.angularaxis.rewriteTicks,delete i.angularaxis.nticks,delete i.radialaxis.ticksCount,delete i.radialaxis.ticksCount,delete i.radialaxis.ticksStep,delete i.radialaxis.rewriteTicks,delete i.radialaxis.nticks),a.layout=i}return a}}}},{"../../../constants/alignment":626,"../../../lib":657,d3:108}],778:[function(e,t){'use strict';var a=e("d3"),o=e("../../../lib"),r=e("../../../components/color"),i=e("./micropolar"),n=e("./undo_manager"),l=o.extendDeepAll,s=t.exports={};s.framework=function(e){function t(t,o){return o&&(u=o),a.select(a.select(u).node().parentNode).selectAll(".svg-container>*:not(.chart-root)").remove(),r=r?l(r,t):t,c||(c=i.Axis()),p=i.adapter.plotly().convert(r),c.config(p).render(u),e.data=r.data,e.layout=r.layout,s.fillLayout(e),r}var o=new n,r,d,c,p,u;return t.isPolar=!0,t.svg=function(){return c.svg()},t.getConfig=function(){return r},t.getLiveConfig=function(){return i.adapter.plotly().convert(c.getLiveConfig(),!0)},t.getLiveScales=function(){return{t:c.angularScale(),r:c.radialScale()}},t.setUndoPoint=function(){var e=this,t=i.util.cloneJson(r);(function(t,a){o.add({undo:function(){a&&e(a)},redo:function(){e(t)}})})(t,d),d=i.util.cloneJson(t)},t.undo=function(){o.undo()},t.redo=function(){o.redo()},t},s.fillLayout=function(e){var t=a.select(e).selectAll(".plot-container"),o=t.selectAll(".svg-container"),i=e.framework&&e.framework.svg&&e.framework.svg(),n={width:800,height:600,paper_bgcolor:r.background,_container:t,_paperdiv:o,_paper:i};e._fullLayout=l(n,e.layout)}},{"../../../components/color":524,"../../../lib":657,"./micropolar":777,"./undo_manager":779,d3:108}],779:[function(e,t){'use strict';t.exports=function(){function e(e,t){return e?(o=!0,e[t](),o=!1,this):this}var t=[],a=-1,o=!1,r;return{add:function(e){return o?this:(t.splice(a+1,t.length-a),t.push(e),a=t.length-1,this)},setCallback:function(e){r=e},undo:function(){var o=t[a];return o?(e(o,"undo"),a-=1,r&&r(o.undo),this):this},redo:function(){var o=t[a+1];return o?(e(o,"redo"),a+=1,r&&r(o.redo),this):this},clear:function(){t=[],a=-1},hasUndo:function(){return-1!==a},hasRedo:function(){return a<t.length-1},getCommands:function(){return t},getPreviousCommand:function(){return t[a-1]},getIndex:function(){return a}}}},{}],780:[function(e,t){'use strict';var d=Math.atan2,c=Math.cos,p=Math.sqrt,u=Math.sin,g=Math.min,m=Math.abs,h=Math.max;function a(e,t){this.id=t,this.gd=e,this._hasClipOnAxisFalse=null,this.vangles=null,this.radialAxisAngle=null,this.traceHash={},this.layers={},this.clipPaths={},this.clipIds={},this.viewInitial={};var a=e._fullLayout,o="clip"+a._uid+t;this.clipIds.forTraces=o+"-for-traces",this.clipPaths.forTraces=a._clips.append("clipPath").attr("id",this.clipIds.forTraces),this.clipPaths.forTraces.append("path"),this.framework=a._polarlayer.append("g").attr("class",t),this.radialTickLayout=null,this.angularTickLayout=null}function o(e){var t=e.ticks+(e.ticklen+"")+(e.showticklabels+"");return"side"in e&&(t+=e.side),t}function r(e){var t=e[0],a=e[1],o=_(t,360),r=o+(a-t),i=c(U(o)),n=u(U(o)),l=c(U(r)),s=u(U(r)),d,p,m,y;return y=90>=o&&90<=r||90<o&&450<=r?1:0>=n&&0>=s?0:h(n,s),d=180>=o&&180<=r||180<o&&540<=r?-1:0<=i&&0<=l?0:g(i,l),p=270>=o&&270<=r||270<o&&630<=r?-1:0<=n&&0<=s?0:g(n,s),m=360<=r?1:0>=i&&0>=l?0:h(i,l),[d,p,m,y]}function i(e,t){var a=b.findIndexOfMin(t,function(t){return b.angleDist(e,t)});return t[a]}function n(e,t,a){return t?(e.attr("display",null),e.attr(a)):e&&e.attr("display","none"),e}function l(e,t){return"translate("+e+","+t+")"}function s(e){return"rotate("+e+")"}var y=e("d3"),f=e("tinycolor2"),x=e("../../registry"),b=e("../../lib"),v=e("../../components/color"),w=e("../../components/drawing"),k=e("../plots"),T=e("../../plots/cartesian/axes"),A=e("../cartesian/set_convert"),S=e("./set_convert"),C=e("../cartesian/autorange").doAutoRange,L=e("../cartesian/dragbox"),E=e("../../components/dragelement"),I=e("../../components/fx"),P=e("../../components/titles"),z=e("../cartesian/select").prepSelect,D=e("../cartesian/select").selectOnClick,O=e("../cartesian/select").clearSelect,R=e("../../lib/setcursor"),M=e("../../lib/clear_gl_canvases"),j=e("../../plot_api/subroutines").redrawReglTraces,B=e("../../constants/alignment").MID_SHIFT,F=e("./constants"),N=e("./helpers"),V=b._,_=b.mod,U=b.deg2rad,H=b.rad2deg,q=a.prototype;t.exports=function(e,t){return new a(e,t)},q.plot=function(e,t){var a=this,o=t[a.id];a._hasClipOnAxisFalse=!1;for(var r=0,n;r<e.length;r++)if(n=e[r][0].trace,!1===n.cliponaxis){a._hasClipOnAxisFalse=!0;break}a.updateLayers(t,o),a.updateLayout(t,o),k.generalUpdatePerTraceModule(a.gd,a,e,o),a.updateFx(t,o)},q.updateLayers=function(e,t){var a=this,o=a.layers,r=t.radialaxis,i=t.angularaxis,n=F.layerNames,l=n.indexOf("frontplot"),s=n.slice(0,l),d="below traces"===i.layer,c="below traces"===r.layer;d&&s.push("angular-line"),c&&s.push("radial-line"),d&&s.push("angular-axis"),c&&s.push("radial-axis"),s.push("frontplot"),d||s.push("angular-line"),c||s.push("radial-line"),d||s.push("angular-axis"),c||s.push("radial-axis");var p=a.framework.selectAll(".polarsublayer").data(s,String);p.enter().append("g").attr("class",function(e){return"polarsublayer "+e}).each(function(e){var t=o[e]=y.select(this);"frontplot"===e?(t.append("g").classed("barlayer",!0),t.append("g").classed("scatterlayer",!0)):"backplot"===e?t.append("g").classed("maplayer",!0):"plotbg"===e?o.bg=t.append("path"):"radial-grid"===e?t.style("fill","none"):"angular-grid"===e?t.style("fill","none"):"radial-line"===e?t.append("line").style("fill","none"):"angular-line"===e?t.append("path").style("fill","none"):void 0}),p.order()},q.updateLayout=function(e,t){var a=this,o=a.layers,i=e._size,n=t.radialaxis,s=t.angularaxis,d=t.domain.x,c=t.domain.y;a.xOffset=i.l+i.w*d[0],a.yOffset=i.t+i.h*(1-c[1]);var p=a.xLength=i.w*(d[1]-d[0]),u=a.yLength=i.h*(c[1]-c[0]),g=t.sector;a.sectorInRad=g.map(U);var h=a.sectorBBox=r(g),y=h[2]-h[0],f=h[3]-h[1],x=m(f/y),_,b,k,T,A;u/p>x?(_=p,b=p*x,A=(u-b)/i.h/2,k=[d[0],d[1]],T=[c[0]+A,c[1]-A]):(_=u/x,b=u,A=(p-_)/i.w/2,k=[d[0]+A,d[1]-A],T=[c[0],c[1]]),a.xLength2=_,a.yLength2=b,a.xDomain2=k,a.yDomain2=T;var S=a.xOffset2=i.l+i.w*k[0],C=a.yOffset2=i.t+i.h*(1-T[1]),L=a.radius=_/y,E=a.innerRadius=t.hole*L,I=a.cx=S-L*h[0],P=a.cy=C+L*h[3],z=a.cxx=I-S,D=a.cyy=P-C;a.radialAxis=a.mockAxis(e,t,n,{_id:"x",side:{counterclockwise:"top",clockwise:"bottom"}[n.side],domain:[E/i.w,L/i.w]}),a.angularAxis=a.mockAxis(e,t,s,{side:"right",domain:[0,Math.PI],autorange:!1}),a.doAutoRange(e,t),a.updateAngularAxis(e,t),a.updateRadialAxis(e,t),a.updateRadialAxisTitle(e,t),a.xaxis=a.mockCartesianAxis(e,t,{_id:"x",domain:k}),a.yaxis=a.mockCartesianAxis(e,t,{_id:"y",domain:T});var O=a.pathSubplot();a.clipPaths.forTraces.select("path").attr("d",O).attr("transform",l(z,D)),o.frontplot.attr("transform",l(S,C)).call(w.setClipUrl,a._hasClipOnAxisFalse?null:a.clipIds.forTraces,a.gd),o.bg.attr("d",O).attr("transform",l(I,P)).call(v.fill,t.bgcolor)},q.mockAxis=function(e,t,a,o){var r=b.extendFlat({},a,o);return S(r,t,e),r},q.mockCartesianAxis=function(e,t,a){var o=this,r=a._id,i=b.extendFlat({type:"linear"},a);A(i,e);var n={x:[0,2],y:[1,3]};return i.setRange=function(){var e=o.sectorBBox,a=n[r],l=o.radialAxis._rl,s=(l[1]-l[0])/(1-t.hole);i.range=[e[a[0]]*s,e[a[1]]*s]},i.isPtWithinRange="x"===r?function(e){return o.isPtInside(e)}:function(){return!0},i.setRange(),i.setScale(),i},q.doAutoRange=function(e,t){var a=this.gd,o=this.radialAxis,r=t.radialaxis;o.setScale(),C(a,o);var i=o.range;r.range=i.slice(),r._input.range=i.slice(),o._rl=[o.r2l(i[0],null,"gregorian"),o.r2l(i[1],null,"gregorian")]},q.updateRadialAxis=function(e,t){var a=this,r=a.gd,d=a.layers,c=a.radius,p=a.innerRadius,u=a.cx,g=a.cy,m=t.radialaxis,h=_(t.sector[0],360),y=a.radialAxis,f=p<c;a.fillViewInitialKey("radialaxis.angle",m.angle),a.fillViewInitialKey("radialaxis.range",y.range.slice()),y.setGeometry(),"auto"===y.tickangle&&90<h&&270>=h&&(y.tickangle=180);var x=function(e){return"translate("+(y.l2p(e.x)+p)+",0)"},w=function(e){return a.pathArc(y.r2p(e.x)+p)},k=o(m);if(a.radialTickLayout!==k&&(d["radial-axis"].selectAll(".xtick").remove(),a.radialTickLayout=k),f){y.setScale();var A=T.calcTicks(y),S=T.clipEnds(y,A),C=T.getTickSigns(y)[2];T.drawTicks(r,y,{vals:A,layer:d["radial-axis"],path:T.makeTickPath(y,0,C),transFn:x,crisp:!1}),T.drawGrid(r,y,{vals:S,layer:d["radial-grid"],path:w,transFn:b.noop,crisp:!1}),T.drawLabels(r,y,{vals:A,layer:d["radial-axis"],transFn:x,labelFns:T.makeLabelFns(y,0)})}var L=a.radialAxisAngle=a.vangles?H(i(U(m.angle),a.vangles)):m.angle,E=l(u,g),I=E+s(-L);n(d["radial-axis"],f&&(m.showticklabels||m.ticks),{transform:I}),n(d["radial-grid"],f&&m.showgrid,{transform:E}),n(d["radial-line"].select("line"),f&&m.showline,{x1:p,y1:0,x2:c,y2:0,transform:I}).attr("stroke-width",m.linewidth).call(v.stroke,m.linecolor)},q.updateRadialAxisTitle=function(e,t,a){var o=this,r=o.gd,i=o.radius,n=o.cx,l=o.cy,s=t.radialaxis,d=o.id+"title",p=a===void 0?o.radialAxisAngle:a,g=U(p),m=c(g),y=u(g),f=0;if(s.title){var x=w.bBox(o.layers["radial-axis"].node()).height,h=s.title.font.size;f="counterclockwise"===s.side?-x-.4*h:x+.8*h}o.layers["radial-axis-title"]=P.draw(r,d,{propContainer:s,propName:o.id+".radialaxis.title",placeholder:V(r,"Click to enter radial axis title"),attributes:{x:n+i/2*m+f*y,y:l-i/2*y+f*m,"text-anchor":"middle"},transform:{rotate:-p}})},q.updateAngularAxis=function(e,t){var a=this,r=a.gd,i=a.layers,p=a.radius,g=a.innerRadius,h=a.cx,y=a.cy,d=t.angularaxis,f=a.angularAxis;a.fillViewInitialKey("angularaxis.rotation",d.rotation),f.setGeometry(),f.setScale();var x=function(e){return f.t2g(e.x)};"linear"===f.type&&"radians"===f.thetaunit&&(f.tick0=H(f.tick0),f.dtick=H(f.dtick));var _=function(e){return l(h+p*c(e),y-p*u(e))},w=function(e){return _(x(e))},k=function(e){var t=x(e);return _(t)+s(-H(t))},A=function(e){var t=x(e),a=c(t),o=u(t);return"M"+[h+g*a,y-g*o]+"L"+[h+p*a,y-p*o]},S=T.makeLabelFns(f,0),C=S.labelStandoff,L={};L.xFn=function(e){var t=x(e);return c(t)*C},L.yFn=function(e){var t=x(e),a=0<u(t)?.2:1;return-u(t)*(C+e.fontSize*a)+m(c(t))*(e.fontSize*B)},L.anchorFn=function(e){var t=x(e),a=c(t);return .1>m(a)?"middle":0<a?"start":"end"},L.heightFn=function(e,t,a){var o=x(e);return-.5*(1+u(o))*a};var E=o(d);a.angularTickLayout!==E&&(i["angular-axis"].selectAll("."+f._id+"tick").remove(),a.angularTickLayout=E);var I=T.calcTicks(f),P;if("linear"===t.gridshape?(P=I.map(x),0>b.angleDelta(P[0],P[1])&&(P=P.slice().reverse())):P=null,a.vangles=P,"category"===f.type&&(I=I.filter(function(e){return b.isAngleInsideSector(x(e),a.sectorInRad)})),f.visible){var z="inside"===f.ticks?-1:1,D=(f.linewidth||1)/2;T.drawTicks(r,f,{vals:I,layer:i["angular-axis"],path:"M"+z*D+",0h"+z*f.ticklen,transFn:k,crisp:!1}),T.drawGrid(r,f,{vals:I,layer:i["angular-grid"],path:A,transFn:b.noop,crisp:!1}),T.drawLabels(r,f,{vals:I,layer:i["angular-axis"],repositionOnUpdate:!0,transFn:w,labelFns:L})}n(i["angular-line"].select("path"),d.showline,{d:a.pathSubplot(),transform:l(h,y)}).attr("stroke-width",d.linewidth).call(v.stroke,d.linecolor)},q.updateFx=function(e,t){this.gd._context.staticPlot||(this.updateAngularDrag(e),this.updateRadialDrag(e,t,0),this.updateRadialDrag(e,t,1),this.updateMainDrag(e))},q.updateMainDrag=function(e){function t(e,t){return p(e*e+t*t)}function a(e,a){return t(e-G,a-Y)}function o(e,t){return d(Y-t,e-G)}function i(e,t){return[e*c(t),e*u(-t)]}function n(e,t){if(0===e)return P.pathSector(2*Q);var a=ee/e,o=t-a,r=t+a,n=h(0,g(e,V)),l=n-Q,s=n+Q;return"M"+i(l,o)+"A"+[l,l]+" 0,0,0 "+i(l,r)+"L"+i(s,r)+"A"+[s,s]+" 0,0,1 "+i(s,o)+"Z"}function s(e,t,a){if(0===e)return P.pathSector(2*Q);var o=i(e,t),r=i(e,a),n=K((o[0]+r[0])/2),l=K((o[1]+r[1])/2),s,d;if(n&&l){var c=l/n,p=-1/c,u=$(Q,c,n,l);s=$(ee,p,u[0][0],u[0][1]),d=$(ee,p,u[1][0],u[1][1])}else{var g,m;l?(g=ee,m=Q):(g=Q,m=ee),s=[[n-g,l-m],[n+g,l-m]],d=[[n-g,l+m],[n+g,l+m]]}return"M"+s.join("L")+"L"+d.reverse().join("L")+"Z"}function _(){ie=null,ne=null,le=P.pathSubplot(),se=!1;var e=R._fullLayout[P.id];de=f(e.bgcolor).getLuminance(),ce=L.makeZoombox(M,de,H,q,le),ce.attr("fill-rule","evenodd"),pe=L.makeCorners(M,H,q),O(R)}function b(e,t){return t=h(g(t,V),U),e<B?e=0:V-e<B?e=V:t<B?t=0:V-t<B&&(t=V),m(t-e)>j?(e<t?(ie=e,ne=t):(ie=t,ne=e),!0):(ie=null,ne=null,!1)}function v(e,t){e=e||le,t=t||"M0,0Z",ce.attr("d",e),pe.attr("d",t),L.transitionZoombox(ce,pe,se,de),se=!0;var a={};S(a),R.emit("plotly_relayouting",a)}function w(e,t){var r=oe+e,i=re+t,l=a(oe,re),s=g(a(r,i),V),d=o(oe,re),c,p;b(l,s)&&(c=le+P.pathSector(ne),ie&&(c+=P.pathSector(ie)),p=n(ie,d)+n(ne,d)),v(c,p)}function k(e,a,o,r){var i=N.findIntersectionXY(o,r,o,[e-G,Y-a]);return t(i[0],i[1])}function T(e,t){var a=oe+e,r=re+t,i=o(oe,re),n=o(a,r),l=J(i,X),d=J(n,X),c=k(oe,re,l[0],l[1]),p=g(k(a,r,d[0],d[1]),V),u,m;b(c,p)&&(u=le+P.pathSector(ne),ie&&(u+=P.pathSector(ie)),m=[s(ie,l[0],l[1]),s(ne,l[0],l[1])].join(" ")),v(u,m)}function A(){if(L.removeZoombox(R),null!==ie&&null!==ne){var e={};S(e),L.showDoubleClickNotifier(R),x.call("_guiRelayout",R,e)}}function S(e){var t=Z._rl,a=(t[1]-t[0])/(1-U/V)/V,o=[t[0]+(ie-U)*a,t[0]+(ne-U)*a];e[P.id+".radialaxis.range"]=o}function C(e,t){var a=R._fullLayout.clickmode;if(L.removeZoombox(R),2===e){var o={};for(var r in P.viewInitial)o[P.id+"."+r]=P.viewInitial[r];R.emit("plotly_doubleclick",null),x.call("_guiRelayout",R,o)}-1<a.indexOf("select")&&1===e&&D(t,R,[P.xaxis],[P.yaxis],P.id,ae),-1<a.indexOf("event")&&I.click(R,t,P.id)}var P=this,R=P.gd,r=P.layers,M=e._zoomlayer,j=F.MINZOOM,B=F.OFFEDGE,V=P.radius,U=P.innerRadius,H=P.cx,q=P.cy,G=P.cxx,Y=P.cyy,W=P.sectorInRad,X=P.vangles,Z=P.radialAxis,K=N.clampTiny,$=N.findXYatLength,J=N.findEnclosingVertexAngles,Q=F.cornerHalfWidth,ee=F.cornerLen/2,te=L.makeDragger(r,"path","maindrag","crosshair");y.select(te).attr("d",P.pathSubplot()).attr("transform",l(H,q));var ae={element:te,gd:R,subplot:P.id,plotinfo:{id:P.id,xaxis:P.xaxis,yaxis:P.yaxis},xaxes:[P.xaxis],yaxes:[P.yaxis]},oe,re,ie,ne,le,se,de,ce,pe;ae.prepFn=function(e,t,a){var o=R._fullLayout.dragmode,r=te.getBoundingClientRect();if(oe=t-r.left,re=a-r.top,X){var i=N.findPolygonOffset(V,W[0],W[1],X);oe+=G+i[0],re+=Y+i[1]}"zoom"===o?(ae.moveFn=X?T:w,ae.clickFn=C,ae.doneFn=A,_(e,t,a)):"select"===o||"lasso"===o?z(e,t,a,ae,o):void 0},te.onmousemove=function(e){I.hover(R,e,P.id),R._fullLayout._lasthover=te,R._fullLayout._hoversubplot=P.id},te.onmouseout=function(e){R._dragging||E.unhover(R,e)},E.init(ae)},q.updateRadialDrag=function(e,t,a){function o(e,t){if(Z)Z(e,t);else{var a=[e,-t],o=[c(z),u(z)],i=m(b.dot(a,o)/p(b.dot(a,a)));isNaN(i)||(Z=.5>i?h:f)}var n={};r(n),v.emit("plotly_relayouting",n)}function r(e){null===K?null!==$&&(e[_.id+".radialaxis.range["+a+"]"]=$):e[_.id+".radialaxis.angle"]=K}function g(){null===K?null!==$&&x.call("_guiRelayout",v,_.id+".radialaxis.range["+a+"]",$):x.call("_guiRelayout",v,_.id+".radialaxis.angle",K)}function h(e,t){if(0!==a){var o=q+e,r=G+t;K=d(S-r,o-A),_.vangles&&(K=i(K,_.vangles)),K=H(K);var n=l(A,S)+s(-K);w["radial-axis"].attr("transform",n),w["radial-line"].select("line").attr("transform",n);var c=_.gd._fullLayout,p=c[_.id];_.updateRadialAxisTitle(c,p,K)}}function f(e,t){var o=b.dot([e,-t],[c(z),u(z)]);if($=N-V*o,0<V!=(a?$>R:$<B))return void($=null);var r=v._fullLayout,i=r[_.id];C.range[a]=$,C._rl[a]=$,_.updateRadialAxis(r,i),_.xaxis.setRange(),_.xaxis.setScale(),_.yaxis.setRange(),_.yaxis.setScale();var n=!1;for(var l in _.traceHash){var s=_.traceHash[l],d=b.filterVisible(s),p=s[0][0].trace._module;p.plot(v,_,d,i),x.traceIs(l,"gl")&&d.length&&(n=!0)}n&&(M(v),j(v))}var _=this,v=_.gd,w=_.layers,k=_.radius,T=_.innerRadius,A=_.cx,S=_.cy,C=_.radialAxis,I=F.radialDragBoxSize,P=I/2;if(C.visible){var z=U(_.radialAxisAngle),D=C._rl,R=D[0],B=D[1],N=D[a],V=.75*(D[1]-D[0])/(1-t.hole)/k,q,G,Y;a?(q=A+(k+P)*c(z),G=S-(k+P)*u(z),Y="radialdrag"):(q=A+(T-P)*c(z),G=S-(T-P)*u(z),Y="radialdrag-inner");var W=L.makeRectDragger(w,Y,"crosshair",-P,-P,I,I),X={element:W,gd:v};n(y.select(W),C.visible&&T<k,{transform:l(q,G)});var Z,K,$;X.prepFn=function(){Z=null,K=null,$=null,X.moveFn=o,X.doneFn=g,O(v)},X.clampFn=function(e,t){return p(e*e+t*t)<F.MINDRAG&&(e=0,t=0),[e,t]},E.init(X)}},q.updateAngularDrag=function(e){function t(e,t){return d(f+_-t,e-h-_)}function a(e,a){var r=i.gd._fullLayout,d=r[i.id],p=C+e,_=I+a,v=t(p,_),k=H(v-B);if(z=P+k,c.frontplot.attr("transform",l(i.xOffset2,i.yOffset2)+s([-k,h,f])),i.vangles){D=i.radialAxisAngle+k;var L=l(g,m)+s(-k),E=l(g,m)+s(-D);c.bg.attr("transform",L),c["radial-grid"].attr("transform",L),c["radial-axis"].attr("transform",E),c["radial-line"].select("line").attr("transform",E),i.updateRadialAxisTitle(r,d,D)}else i.clipPaths.forTraces.select("path").attr("transform",l(h,f)+s(k));A.each(function(){var e=y.select(this),t=w.getTranslate(e);e.attr("transform",l(t.x,t.y)+s([k]))}),S.each(function(){var e=y.select(this),t=e.select("text"),a=w.getTranslate(e);e.attr("transform",s([k,t.attr("x"),t.attr("y")])+l(a.x,a.y))}),u.rotation=b.modHalf(z,360),i.updateAngularAxis(r,d),i._hasClipOnAxisFalse&&!b.isFullCircle(i.sectorInRad)&&T.call(w.hideOutsideRangePoints,i);var O=!1;for(var R in i.traceHash)if(x.traceIs(R,"gl")){var F=i.traceHash[R],N=b.filterVisible(F),V=F[0][0].trace._module;V.plot(n,i,N,d),N.length&&(O=!0)}O&&(M(n),j(n));var U={};o(U),n.emit("plotly_relayouting",U)}function o(e){e[i.id+".angularaxis.rotation"]=z,i.vangles&&(e[i.id+".radialaxis.angle"]=D)}function r(){S.select("text").attr("transform",null);var e={};o(e),x.call("_guiRelayout",n,e)}var i=this,n=i.gd,c=i.layers,p=i.radius,u=i.angularAxis,g=i.cx,m=i.cy,h=i.cxx,f=i.cyy,_=F.angularDragBoxSize,v=L.makeDragger(c,"path","angulardrag","move"),k={element:v,gd:n};y.select(v).attr("d",i.pathAnnulus(p,p+_)).attr("transform",l(g,m)).call(R,"move");var T=c.frontplot.select(".scatterlayer").selectAll(".trace"),A=T.selectAll(".point"),S=T.selectAll(".textpoint"),C,I,P,z,D,B;k.prepFn=function(o,l,s){var d=e[i.id];P=d.angularaxis.rotation;var c=v.getBoundingClientRect();C=l-c.left,I=s-c.top,B=t(C,I),k.moveFn=a,k.doneFn=r,O(n)},i.vangles&&!b.isFullCircle(i.sectorInRad)&&(k.prepFn=b.noop,R(y.select(v),null)),E.init(k)},q.isPtInside=function(e){var t=this.sectorInRad,a=this.vangles,o=this.angularAxis.c2g(e.theta),i=this.radialAxis,n=i.c2l(e.r),r=i._rl,l=a?N.isPtInsidePolygon:b.isPtInsideSector;return l(n,o,r,t,a)},q.pathArc=function(e){var t=this.sectorInRad,a=this.vangles,o=a?N.pathPolygon:b.pathArc;return o(e,t[0],t[1],a)},q.pathSector=function(e){var t=this.sectorInRad,a=this.vangles,o=a?N.pathPolygon:b.pathSector;return o(e,t[0],t[1],a)},q.pathAnnulus=function(e,t){var a=this.sectorInRad,o=this.vangles,r=o?N.pathPolygonAnnulus:b.pathAnnulus;return r(e,t,a[0],a[1],o)},q.pathSubplot=function(){var e=this.innerRadius,t=this.radius;return e?this.pathAnnulus(e,t):this.pathSector(t)},q.fillViewInitialKey=function(e,t){e in this.viewInitial||(this.viewInitial[e]=t)}},{"../../components/color":524,"../../components/dragelement":543,"../../components/drawing":546,"../../components/fx":564,"../../components/titles":619,"../../constants/alignment":626,"../../lib":657,"../../lib/clear_gl_canvases":642,"../../lib/setcursor":677,"../../plot_api/subroutines":696,"../../plots/cartesian/axes":705,"../../registry":788,"../cartesian/autorange":704,"../cartesian/dragbox":713,"../cartesian/select":724,"../cartesian/set_convert":725,"../plots":768,"./constants":769,"./helpers":770,"./set_convert":781,d3:108,tinycolor2:1309}],781:[function(e,t){'use strict';var n=Math.PI;function a(e,t){var a=t._subplot;e.setGeometry=function(){var t=e._rl[0],o=e._rl[1],r=a.innerRadius,i=(a.radius-r)/(o-t),n=r/i,l=t>o?function(e){return 0>=e}:function(e){return 0<=e};e.c2g=function(a){var o=e.c2l(a)-t;return(l(o)?o:0)+n},e.g2c=function(a){return e.l2c(a+t-n)},e.g2p=function(e){return e*i},e.c2p=function(t){return e.g2p(e.c2g(t))}}}function o(e,t){return"degrees"===t?d(e):e}function r(e,t){return"degrees"===t?c(e):e}function i(e,t){var a=e.type;if("linear"===a){var i=e.d2c,s=e.c2d;e.d2c=function(e,t){return o(i(e),t)},e.c2d=function(e,t){return s(r(e,t))}}e.makeCalcdata=function(t,o){var r=t[o],s=t._length,d=function(a){return e.d2c(a,t.thetaunit)},c,p;if(r){if(l.isTypedArray(r)&&"linear"===a){if(s===r.length)return r;if(r.subarray)return r.subarray(0,s)}for(c=Array(s),p=0;p<s;p++)c[p]=d(r[p])}else{var u=o+"0",g="d"+o,m=u in t?d(t[u]):0,h=t[g]?d(t[g]):(e.period||2*n)/s;for(c=Array(s),p=0;p<s;p++)c[p]=m+p*h}return c},e.setGeometry=function(){var o=t.sector,r=o.map(d),i={clockwise:-1,counterclockwise:1}[e.direction],s=d(e.rotation),p=function(e){return i*e+s},u=function(e){return(e-s)/i},g,m,h,y;switch(a){case"linear":m=g=l.identity,y=d,h=c,e.range=l.isFullCircle(r)?[o[0],o[0]+360]:r.map(u).map(c);break;case"category":var f=e._categories.length,x=e.period?Math.max(e.period,f):f;0===x&&(x=1),m=y=function(e){return 2*e*n/x},g=h=function(e){return e*x/n/2},e.range=[0,x];}e.c2g=function(e){return p(m(e))},e.g2c=function(e){return g(u(e))},e.t2g=function(e){return p(y(e))},e.g2t=function(e){return h(u(e))}}}var l=e("../../lib"),s=e("../cartesian/set_convert"),d=l.deg2rad,c=l.rad2deg;t.exports=function(e,t,o){switch(s(e,o),e._id){case"x":case"radialaxis":a(e,t);break;case"angularaxis":i(e,t);}}},{"../../lib":657,"../cartesian/set_convert":725}],782:[function(e,t){'use strict';var a=e("../lib"),o=e("../plot_api/plot_template"),r=e("./domain").defaults;t.exports=function(e,t,n,l){function s(e,t){return a.coerce(f,x,c,e,t)}for(var d=l.type,c=l.attributes,p=l.handleDefaults,u=l.partition||"x",g=t._subplots[d],m=g.length,h=m&&g[0].replace(/\d+$/,""),y=0,f,x,_;y<m;y++){_=g[y],f=e[_]?e[_]:e[_]={},x=o.newContainer(t,_,h),s("uirevision",t.uirevision);var b={};b[u]=[y/m,(y+1)/m],r(x,t,s,b),l.id=_,p(f,x,s,l)}}},{"../lib":657,"../plot_api/plot_template":695,"./domain":732}],783:[function(e,t,a){'use strict';function o(e){var t=e.description?" "+e.description:"",a=e.keys||[];if(0<a.length){for(var o=[],r=0;r<a.length;r++)o[r]="`"+a[r]+"`";t+="Finally, the template string has access to ",t=1===a.length?"variable "+o[0]:"variables "+o.slice(0,-1).join(", ")+" and "+o.slice(-1)+"."}return t}var r=e("../constants/docs").FORMAT_LINK,i=e("../constants/docs").DATE_FORMAT_LINK,n=["Variables are inserted using %{variable}, for example \"y: %{y}\".","Numbers are formatted using d3-format's syntax %{variable:d3-format}, for example \"Price: %{y:$.2f}\".",r,"for details on the formatting syntax.","Dates are formatted using d3-time-format's syntax %{variable|d3-time-format}, for example \"Day: %{2019-01-01|%A}\".",i,"for details on the date formatting syntax."].join(" ");a.hovertemplateAttrs=function(e,t){e=e||{},t=t||{};var a=o(t),r={valType:"string",dflt:"",editType:e.editType||"none"};return!1!==e.arrayOk&&(r.arrayOk=!0),r},a.texttemplateAttrs=function(e,t){e=e||{},t=t||{};var a=o(t),r={valType:"string",dflt:"",editType:e.editType||"calc"};return!1!==e.arrayOk&&(r.arrayOk=!0),r}},{"../constants/docs":628}],784:[function(e,t,a){'use strict';var o=e("./ternary"),r=e("../../plots/get_data").getSubplotCalcData,i=e("../../lib").counterRegex,n="ternary";a.name=n;var l=a.attr="subplot";a.idRoot=n,a.idRegex=a.attrRegex=i(n);var s=a.attributes={};s[l]={valType:"subplotid",dflt:"ternary",editType:"calc"},a.layoutAttributes=e("./layout_attributes"),a.supplyLayoutDefaults=e("./layout_defaults"),a.plot=function(e){for(var t=e._fullLayout,a=e.calcdata,l=t._subplots[n],s=0;s<l.length;s++){var d=l[s],c=r(a,n,d),p=t[d]._subplot;p||(p=new o({id:d,graphDiv:e,container:t._ternarylayer.node()},t),t[d]._subplot=p),p.plot(c,t,e._promises)}},a.clean=function(e,t,a,o){for(var r=o._subplots[n]||[],l=0;l<r.length;l++){var s=r[l],d=o[s]._subplot;t[s]||!d||(d.plotContainer.remove(),d.clipDef.remove(),d.clipDefRelative.remove(),d.layers["a-title"].remove(),d.layers["b-title"].remove(),d.layers["c-title"].remove())}}},{"../../lib":657,"../../plots/get_data":742,"./layout_attributes":785,"./layout_defaults":786,"./ternary":787}],785:[function(e,t){'use strict';var a=e("../../components/color/attributes"),o=e("../domain").attributes,r=e("../cartesian/layout_attributes"),i=e("../../plot_api/edit_types").overrideAll,n=e("../../lib/extend").extendFlat,l={title:{text:r.title.text,font:r.title.font},color:r.color,tickmode:r.tickmode,nticks:n({},r.nticks,{dflt:6,min:1}),tick0:r.tick0,dtick:r.dtick,tickvals:r.tickvals,ticktext:r.ticktext,ticks:r.ticks,ticklen:r.ticklen,tickwidth:r.tickwidth,tickcolor:r.tickcolor,showticklabels:r.showticklabels,showtickprefix:r.showtickprefix,tickprefix:r.tickprefix,showticksuffix:r.showticksuffix,ticksuffix:r.ticksuffix,showexponent:r.showexponent,exponentformat:r.exponentformat,separatethousands:r.separatethousands,tickfont:r.tickfont,tickangle:r.tickangle,tickformat:r.tickformat,tickformatstops:r.tickformatstops,hoverformat:r.hoverformat,showline:n({},r.showline,{dflt:!0}),linecolor:r.linecolor,linewidth:r.linewidth,showgrid:n({},r.showgrid,{dflt:!0}),gridcolor:r.gridcolor,gridwidth:r.gridwidth,layer:r.layer,min:{valType:"number",dflt:0,min:0},_deprecated:{title:r._deprecated.title,titlefont:r._deprecated.titlefont}},s=t.exports=i({domain:o({name:"ternary"}),bgcolor:{valType:"color",dflt:a.background},sum:{valType:"number",dflt:1,min:0},aaxis:l,baxis:l,caxis:l},"plot","from-root");s.uirevision={valType:"any",editType:"none"},s.aaxis.uirevision=s.baxis.uirevision=s.caxis.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":523,"../../lib/extend":648,"../../plot_api/edit_types":688,"../cartesian/layout_attributes":719,"../domain":732}],786:[function(e,t){'use strict';function a(e,t,a,n){var l=a("bgcolor"),s=a("sum");n.bgColor=r.combine(l,n.paper_bgcolor);for(var d=0,c,p,u;d<g.length;d++)c=g[d],p=e[c]||{},u=i.newContainer(t,c),u._name=c,o(p,u,n,t);var m=t.aaxis,h=t.baxis,y=t.caxis;m.min+h.min+y.min>=s&&(m.min=0,h.min=0,y.min=0,e.aaxis&&delete e.aaxis.min,e.baxis&&delete e.baxis.min,e.caxis&&delete e.caxis.min)}function o(e,t,a,o){function r(a,o){return n.coerce(e,t,i,a,o)}var i=u[t._name];r("uirevision",o.uirevision),t.type="linear";var l=r("color"),g=l===i.color.dflt?a.font.color:l,m=t._name,h=m.charAt(0).toUpperCase(),y="Component "+h,f=r("title.text",y);t._hovertitle=f===y?f:h,n.coerceFont(r,"title.font",{family:a.font.family,size:Math.round(1.2*a.font.size),color:g}),r("min"),c(e,t,r,"linear"),s(e,t,r,"linear",{}),d(e,t,r,{outerTicks:!0});var x=r("showticklabels");x&&(n.coerceFont(r,"tickfont",{family:a.font.family,size:a.font.size,color:g}),r("tickangle"),r("tickformat")),p(e,t,r,{dfltColor:l,bgColor:a.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:i}),r("hoverformat"),r("layer")}var r=e("../../components/color"),i=e("../../plot_api/plot_template"),n=e("../../lib"),l=e("../subplot_defaults"),s=e("../cartesian/tick_label_defaults"),d=e("../cartesian/tick_mark_defaults"),c=e("../cartesian/tick_value_defaults"),p=e("../cartesian/line_grid_defaults"),u=e("./layout_attributes"),g=["aaxis","baxis","caxis"];t.exports=function(e,t,o){l(e,t,o,{type:"ternary",attributes:u,handleDefaults:a,font:t.font,paper_bgcolor:t.paper_bgcolor})}},{"../../components/color":524,"../../lib":657,"../../plot_api/plot_template":695,"../cartesian/line_grid_defaults":721,"../cartesian/tick_label_defaults":726,"../cartesian/tick_mark_defaults":727,"../cartesian/tick_value_defaults":728,"../subplot_defaults":782,"./layout_attributes":785}],787:[function(e,t){'use strict';var i=Math.cos,n=Math.sqrt,l=Math.sin,s=Math.min,d=Math.max;function a(e,t){this.id=e.id,this.graphDiv=e.graphDiv,this.init(t),this.makeFramework(t),this.aTickLayout=null,this.bTickLayout=null,this.cTickLayout=null}function o(e){return e.ticks+(e.ticklen+"")+(e.showticklabels+"")}function r(e){c.select(e).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}var c=e("d3"),p=e("tinycolor2"),u=e("../../registry"),g=e("../../lib"),m=g._,y=e("../../components/color"),f=e("../../components/drawing"),x=e("../cartesian/set_convert"),_=e("../../lib/extend").extendFlat,b=e("../plots"),v=e("../cartesian/axes"),w=e("../../components/dragelement"),k=e("../../components/fx"),h=e("../../components/dragelement/helpers"),T=h.freeMode,A=h.rectMode,S=e("../../components/titles"),C=e("../cartesian/select").prepSelect,L=e("../cartesian/select").selectOnClick,E=e("../cartesian/select").clearSelect,I=e("../cartesian/select").clearSelectionsCache,P=e("../cartesian/constants");t.exports=a;var z=a.prototype;z.init=function(e){this.container=e._ternarylayer,this.defs=e._defs,this.layoutId=e._uid,this.traceHash={},this.layers={}},z.plot=function(e,t){var a=this,o=t[a.id],r=t._size;a._hasClipOnAxisFalse=!1;for(var n=0,l;n<e.length;n++)if(l=e[n][0].trace,!1===l.cliponaxis){a._hasClipOnAxisFalse=!0;break}a.updateLayers(o),a.adjustLayout(o,r),b.generalUpdatePerTraceModule(a.graphDiv,a,e,o),a.layers.plotbg.select("path").call(y.fill,o.bgcolor)},z.makeFramework=function(e){var t=this,a=t.graphDiv,o=e[t.id],r=t.clipId="clip"+t.layoutId+t.id,i=t.clipIdRelative="clip-relative"+t.layoutId+t.id;t.clipDef=g.ensureSingleById(e._clips,"clipPath",r,function(e){e.append("path").attr("d","M0,0Z")}),t.clipDefRelative=g.ensureSingleById(e._clips,"clipPath",i,function(e){e.append("path").attr("d","M0,0Z")}),t.plotContainer=g.ensureSingle(t.container,"g",t.id),t.updateLayers(o),f.setClipUrl(t.layers.backplot,r,a),f.setClipUrl(t.layers.grids,r,a)},z.updateLayers=function(e){var t=this,a=t.layers,o=["draglayer","plotbg","backplot","grids"];"below traces"===e.aaxis.layer&&o.push("aaxis","aline"),"below traces"===e.baxis.layer&&o.push("baxis","bline"),"below traces"===e.caxis.layer&&o.push("caxis","cline"),o.push("frontplot"),"above traces"===e.aaxis.layer&&o.push("aaxis","aline"),"above traces"===e.baxis.layer&&o.push("baxis","bline"),"above traces"===e.caxis.layer&&o.push("caxis","cline");var r=t.plotContainer.selectAll("g.toplevel").data(o,String),i=["agrid","bgrid","cgrid"];r.enter().append("g").attr("class",function(e){return"toplevel "+e}).each(function(e){var t=c.select(this);a[e]=t,"frontplot"===e?t.append("g").classed("scatterlayer",!0):"backplot"===e?t.append("g").classed("maplayer",!0):"plotbg"===e?t.append("path").attr("d","M0,0Z"):"aline"===e||"bline"===e||"cline"===e?t.append("path"):"grids"===e&&i.forEach(function(e){a[e]=t.append("g").classed("grid "+e,!0)})}),r.order()};var D=n(4/3);z.adjustLayout=function(e,t){var a=this,o=e.domain,r=(o.x[0]+o.x[1])/2,i=(o.y[0]+o.y[1])/2,n=o.x[1]-o.x[0],l=o.y[1]-o.y[0],s=n*t.w,d=l*t.h,c=e.sum,p=e.aaxis.min,u=e.baxis.min,g=e.caxis.min,m,b,v,k,T,A;s>D*d?(k=d,v=k*D):(v=s,k=v/D),T=n*v/s,A=l*k/d,m=t.l+t.w*r-v/2,b=t.t+t.h*(1-i)-k/2,a.x0=m,a.y0=b,a.w=v,a.h=k,a.sum=c,a.xaxis={type:"linear",range:[p+2*g-c,c-p-2*u],domain:[r-T/2,r+T/2],_id:"x"},x(a.xaxis,a.graphDiv._fullLayout),a.xaxis.setScale(),a.xaxis.isPtWithinRange=function(e){return e.a>=a.aaxis.range[0]&&e.a<=a.aaxis.range[1]&&e.b>=a.baxis.range[1]&&e.b<=a.baxis.range[0]&&e.c>=a.caxis.range[1]&&e.c<=a.caxis.range[0]},a.yaxis={type:"linear",range:[p,c-u-g],domain:[i-A/2,i+A/2],_id:"y"},x(a.yaxis,a.graphDiv._fullLayout),a.yaxis.setScale(),a.yaxis.isPtWithinRange=function(){return!0};var S=a.yaxis.domain[0],C=a.aaxis=_({},e.aaxis,{range:[p,c-u-g],side:"left",tickangle:(+e.aaxis.tickangle||0)-30,domain:[S,S+A*D],anchor:"free",position:0,_id:"y",_length:v});x(C,a.graphDiv._fullLayout),C.setScale();var L=a.baxis=_({},e.baxis,{range:[c-p-g,u],side:"bottom",domain:a.xaxis.domain,anchor:"free",position:0,_id:"x",_length:v});x(L,a.graphDiv._fullLayout),L.setScale();var E=a.caxis=_({},e.caxis,{range:[c-p-u,g],side:"right",tickangle:(+e.caxis.tickangle||0)+30,domain:[S,S+A*D],anchor:"free",position:0,_id:"y",_length:v});x(E,a.graphDiv._fullLayout),E.setScale();var I="M"+m+","+(b+k)+"h"+v+"l-"+v/2+",-"+k+"Z";a.clipDef.select("path").attr("d",I),a.layers.plotbg.select("path").attr("d",I);var P="M0,"+k+"h"+v+"l-"+v/2+",-"+k+"Z";a.clipDefRelative.select("path").attr("d",P);var z="translate("+m+","+b+")";a.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",z),a.clipDefRelative.select("path").attr("transform",null);var O="translate("+(m-L._offset)+","+(b+k)+")";a.layers.baxis.attr("transform",O),a.layers.bgrid.attr("transform",O);var R="translate("+(m+v/2)+","+b+")rotate(30)translate(0,"+-C._offset+")";a.layers.aaxis.attr("transform",R),a.layers.agrid.attr("transform",R);var M="translate("+(m+v/2)+","+b+")rotate(-30)translate(0,"+-E._offset+")";a.layers.caxis.attr("transform",M),a.layers.cgrid.attr("transform",M),a.drawAxes(!0),a.layers.aline.select("path").attr("d",C.showline?"M"+m+","+(b+k)+"l"+v/2+",-"+k:"M0,0").call(y.stroke,C.linecolor||"#000").style("stroke-width",(C.linewidth||0)+"px"),a.layers.bline.select("path").attr("d",L.showline?"M"+m+","+(b+k)+"h"+v:"M0,0").call(y.stroke,L.linecolor||"#000").style("stroke-width",(L.linewidth||0)+"px"),a.layers.cline.select("path").attr("d",E.showline?"M"+(m+v/2)+","+b+"l"+v/2+","+k:"M0,0").call(y.stroke,E.linecolor||"#000").style("stroke-width",(E.linewidth||0)+"px"),a.graphDiv._context.staticPlot||a.initInteractions(),f.setClipUrl(a.layers.frontplot,a._hasClipOnAxisFalse?null:a.clipId,a.graphDiv)},z.drawAxes=function(e){var t=this,a=t.graphDiv,o=t.id.substr(7)+"title",r=t.layers,i=t.aaxis,n=t.baxis,l=t.caxis;if(t.drawAx(i),t.drawAx(n),t.drawAx(l),e){var s=d(i.showticklabels?i.tickfont.size/2:0,(l.showticklabels?.75*l.tickfont.size:0)+("outside"===l.ticks?.87*l.ticklen:0)),c=(n.showticklabels?n.tickfont.size:0)+("outside"===n.ticks?n.ticklen:0)+3;r["a-title"]=S.draw(a,"a"+o,{propContainer:i,propName:t.id+".aaxis.title",placeholder:m(a,"Click to enter Component A title"),attributes:{x:t.x0+t.w/2,y:t.y0-i.title.font.size/3-s,"text-anchor":"middle"}}),r["b-title"]=S.draw(a,"b"+o,{propContainer:n,propName:t.id+".baxis.title",placeholder:m(a,"Click to enter Component B title"),attributes:{x:t.x0-c,y:t.y0+t.h+.83*n.title.font.size+c,"text-anchor":"middle"}}),r["c-title"]=S.draw(a,"c"+o,{propContainer:l,propName:t.id+".caxis.title",placeholder:m(a,"Click to enter Component C title"),attributes:{x:t.x0+t.w+c,y:t.y0+t.h+.83*l.title.font.size+c,"text-anchor":"middle"}})}},z.drawAx=function(e){var t=this,a=t.graphDiv,r=e._name,n=r.charAt(0),s=e._id,d=t.layers[r],c=30,p=n+"tickLayout",u=o(e);t[p]!==u&&(d.selectAll("."+s+"tick").remove(),t[p]=u),e.setScale();var m=v.calcTicks(e),y=v.clipEnds(e,m),f=v.makeTransFn(e),x=v.getTickSigns(e)[2],_=g.deg2rad(c),b=x*(e.linewidth||1)/2,k=x*e.ticklen,T=t.w,w=t.h,h="b"===n?"M0,"+b+"l"+l(_)*k+","+i(_)*k:"M"+b+",0l"+i(_)*k+","+-l(_)*k,A={a:"M0,0l"+w+",-"+T/2,b:"M0,0l-"+T/2+",-"+w,c:"M0,0l-"+w+","+T/2}[n];v.drawTicks(a,e,{vals:"inside"===e.ticks?y:m,layer:d,path:h,transFn:f,crisp:!1}),v.drawGrid(a,e,{vals:y,layer:t.layers[n+"grid"],path:A,transFn:f,crisp:!1}),v.drawLabels(a,e,{vals:m,layer:d,transFn:f,labelFns:v.makeLabelFns(e,0,c)})};var O=P.MINZOOM/2+.87,R=!0;z.clearSelect=function(){I(this.dragOptions),E(this.dragOptions.gd)},z.initInteractions=function(){function e(e){var t={};return t[v.id+".aaxis.min"]=e.a,t[v.id+".baxis.min"]=e.b,t[v.id+".caxis.min"]=e.c,t}function t(t,a){var o=E._fullLayout.clickmode;r(E),2===t&&(E.emit("plotly_doubleclick",null),u.call("_guiRelayout",E,e({a:0,b:0,c:0}))),-1<o.indexOf("select")&&1===t&&L(a,E,[v.xaxis],[v.yaxis],v.id,v.dragOptions),-1<o.indexOf("event")&&k.click(E,a,v.id)}function a(t,e,a){var o=S.getBoundingClientRect();z=e-o.left,M=a-o.top,j={a:v.aaxis.range[0],b:v.baxis.range[1],c:v.caxis.range[1]},F=j,B=v.aaxis.range[1]-j.a,N=p(v.graphDiv._fullLayout[v.id].bgcolor).getLuminance(),V="M0,"+v.h+"L"+v.w/2+", 0L"+v.w+","+v.h+"Z",U=!1,H=I.append("path").attr("class","zoombox").attr("transform","translate("+v.x0+", "+v.y0+")").style({fill:.2<N?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("d",V),q=I.append("path").attr("class","zoombox-corners").attr("transform","translate("+v.x0+", "+v.y0+")").style({fill:y.background,stroke:y.defaultLine,"stroke-width":1,opacity:0}).attr("d","M0,0Z"),v.clearSelect(E)}function o(e,t){return 1-t/v.h}function i(e,t){return 1-(e+(v.h-t)/n(3))/v.w}function l(e,t){return(e-(v.h-t)/n(3))/v.w}function c(t,a){var r=z+t,n=M+a,c=d(0,s(1,o(z,M),o(r,n))),p=d(0,s(1,i(z,M),i(r,n))),u=d(0,s(1,l(z,M),l(r,n))),g=(c/2+u)*v.w,m=(1-c/2-p)*v.w,h=(g+m)/2,y=m-g,f=(1-c)*v.h,x=f-y/D;y<P.MINZOOM?(F=j,H.attr("d",V),q.attr("d","M0,0Z")):(F={a:j.a+c*B,b:j.b+p*B,c:j.c+u*B},H.attr("d",V+"M"+g+","+f+"H"+m+"L"+h+","+x+"L"+g+","+f+"Z"),q.attr("d","M"+z+","+M+"m0.5,0.5h5v-2h-5v-5h-2v5h-5v2h5v5h2Z"+"M"+g+","+f+("m-0.87,.5h"+O+"v3h-"+(O+5.2)+"l"+(O/2+2.6)+",-"+(.87*O+4.5)+"l2.6,1.5l-"+O/2+","+.87*O+"Z")+"M"+m+","+f+("m0.87,.5h-"+O+"v3h"+(O+5.2)+"l-"+(O/2+2.6)+",-"+(.87*O+4.5)+"l-2.6,1.5l"+O/2+","+.87*O+"Z")+"M"+h+","+x+("m0,1l"+O/2+","+.87*O+"l2.6,-1.5l-"+(O/2+2.6)+",-"+(.87*O+4.5)+"l-"+(O/2+2.6)+","+(.87*O+4.5)+"l2.6,1.5l"+O/2+",-"+.87*O+"Z"))),U||(H.transition().style("fill",.2<N?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),q.transition().style("opacity",1).duration(200),U=!0),E.emit("plotly_relayouting",e(F))}function h(){r(E);F===j||(u.call("_guiRelayout",E,e(F)),R&&E.data&&E._context.showTips&&(g.notifier(m(E,"Double-click to zoom back out"),"long"),R=!1))}function x(){j={a:v.aaxis.range[0],b:v.baxis.range[1],c:v.caxis.range[1]},F=j}function _(t,a){var o=t/v.xaxis._m,r=a/v.yaxis._m;F={a:j.a-r,b:j.b+(o+r)/2,c:j.c-(o-r)/2};var i=[F.a,F.b,F.c].sort(),n={a:i.indexOf(F.a),b:i.indexOf(F.b),c:i.indexOf(F.c)};0>i[0]&&(0>i[1]+i[0]/2?(i[2]+=i[0]+i[1],i[0]=i[1]=0):(i[2]+=i[0]/2,i[1]+=i[0]/2,i[0]=0),F={a:i[n.a],b:i[n.b],c:i[n.c]},a=(j.a-F.a)*v.yaxis._m,t=(j.c-F.c-j.b+F.b)*v.xaxis._m);var l="translate("+(v.x0+t)+","+(v.y0+a)+")";v.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",l);var s="translate("+-t+","+-a+")";v.clipDefRelative.select("path").attr("transform",s),v.aaxis.range=[F.a,v.sum-F.b-F.c],v.baxis.range=[v.sum-F.a-F.c,F.b],v.caxis.range=[v.sum-F.a-F.b,F.c],v.drawAxes(!1),v._hasClipOnAxisFalse&&v.plotContainer.select(".scatterlayer").selectAll(".trace").call(f.hideOutsideRangePoints,v),E.emit("plotly_relayouting",e(F))}function b(){u.call("_guiRelayout",E,e(F))}var v=this,S=v.layers.plotbg.select("path").node(),E=v.graphDiv,I=E._fullLayout._zoomlayer;this.dragOptions={element:S,gd:E,plotinfo:{id:v.id,domain:E._fullLayout[v.id].domain,xaxis:v.xaxis,yaxis:v.yaxis},subplot:v.id,prepFn:function(o,e,r){v.dragOptions.xaxes=[v.xaxis],v.dragOptions.yaxes=[v.yaxis];var i=v.dragOptions.dragmode=E._fullLayout.dragmode;v.dragOptions.minDrag=T(i)?1:void 0,"zoom"===i?(v.dragOptions.moveFn=c,v.dragOptions.clickFn=t,v.dragOptions.doneFn=h,a(o,e,r)):"pan"===i?(v.dragOptions.moveFn=_,v.dragOptions.clickFn=t,v.dragOptions.doneFn=b,x(),v.clearSelect(E)):(A(i)||T(i))&&C(o,e,r,v.dragOptions,i)}};var z,M,j,B,F,N,V,U,H,q;S.onmousemove=function(e){k.hover(E,e,v.id),E._fullLayout._lasthover=S,E._fullLayout._hoversubplot=v.id},S.onmouseout=function(e){E._dragging||w.unhover(E,e)},w.init(this.dragOptions)}},{"../../components/color":524,"../../components/dragelement":543,"../../components/dragelement/helpers":542,"../../components/drawing":546,"../../components/fx":564,"../../components/titles":619,"../../lib":657,"../../lib/extend":648,"../../registry":788,"../cartesian/axes":705,"../cartesian/constants":711,"../cartesian/select":724,"../cartesian/set_convert":725,"../plots":768,d3:108,tinycolor2:1309}],788:[function(e,t,a){'use strict';function o(e){var t=e.name,o=e.categories,n=e.meta;if(a.modules[t])return void g.log("Type "+t+" already registered");a.subplotsRegistry[e.basePlotModule.name]||r(e.basePlotModule);for(var l={},s=0;s<o.length;s++)l[o[s]]=!0,a.allCategories[o[s]]=!0;for(var c in a.modules[t]={_module:e,categories:l},n&&Object.keys(n).length&&(a.modules[t].meta=n),a.allTypes.push(t),a.componentsRegistry)d(c,t);e.layoutAttributes&&v(a.traceLayoutAttributes,e.layoutAttributes);var p=e.basePlotModule,u=p.name;if("mapbox"===u){var m=p.constants.styleRules;for(var h in m)f(".js-plotly-plot .plotly .mapboxgl-"+h,m[h])}("geo"===u||"mapbox"===u)&&void 0!==typeof window&&void 0===window.PlotlyGeoAssets&&(window.PlotlyGeoAssets={topojson:{}})}function r(e){var t=e.name;if(a.subplotsRegistry[t])return void g.log("Plot type "+t+" already registered.");for(var o in s(e),a.subplotsRegistry[t]=e,a.componentsRegistry)p(o,e.name)}function i(e){if("string"!=typeof e.name)throw new Error("Component module *name* must be a string.");var t=e.name;for(var o in a.componentsRegistry[t]=e,e.layoutAttributes&&(e.layoutAttributes._isLinkedToArray&&h(a.layoutArrayContainers,t),s(e)),a.modules)d(t,o);for(var r in a.subplotsRegistry)p(t,r);for(var i in a.transformsRegistry)c(t,i);e.schema&&e.schema.layout&&w(b,e.schema.layout)}function n(e){if("string"!=typeof e.name)throw new Error("Transform module *name* must be a string.");var t="Transform module "+e.name,o="function"==typeof e.transform,r="function"==typeof e.calcTransform;if(!o&&!r)throw new Error(t+" is missing a *transform* or *calcTransform* method.");for(var i in o&&r&&g.log([t+" has both a *transform* and *calcTransform* methods.","Please note that all *transform* methods are executed","before all *calcTransform* methods."].join(" ")),y(e.attributes)||g.log(t+" registered without an *attributes* object."),"function"!=typeof e.supplyDefaults&&g.log(t+" registered without a *supplyDefaults* method."),a.transformsRegistry[e.name]=e,a.componentsRegistry)c(i,e.name)}function l(e){var t=e.name,o=t.split("-")[0],r=e.dictionary,i=e.format,n=r&&Object.keys(r).length,l=i&&Object.keys(i).length,s=a.localeRegistry,d=s[t];if(d||(s[t]=d={}),o!==t){var c=s[o];c||(s[o]=c={}),n&&c.dictionary===d.dictionary&&(c.dictionary=r),l&&c.format===d.format&&(c.format=i)}n&&(d.dictionary=r),l&&(d.format=i)}function s(e){if(e.layoutAttributes){var t=e.layoutAttributes._arrayAttrRegexps;if(t)for(var o=0;o<t.length;o++)h(a.layoutArrayRegexes,t[o])}}function d(e,t){var o=a.componentsRegistry[e].schema;if(o&&o.traces){var r=o.traces[t];r&&w(a.modules[t]._module.attributes,r)}}function c(e,t){var o=a.componentsRegistry[e].schema;if(o&&o.transforms){var r=o.transforms[t];r&&w(a.transformsRegistry[t].attributes,r)}}function p(e,t){var o=a.componentsRegistry[e].schema;if(o&&o.subplots){var r=a.subplotsRegistry[t],i=r.layoutAttributes,n="subplot"===r.attr?r.name:r.attr;Array.isArray(n)&&(n=n[0]);var l=o.subplots[n];i&&l&&w(i,l)}}function u(e){return"object"==typeof e&&(e=e.type),e}var g=e("./lib/loggers"),m=e("./lib/noop"),h=e("./lib/push_unique"),y=e("./lib/is_plain_object"),f=e("./lib/dom").addStyleRule,x=e("./lib/extend"),_=e("./plots/attributes"),b=e("./plots/layout_attributes"),v=x.extendFlat,w=x.extendDeepAll;a.modules={},a.allCategories={},a.allTypes=[],a.subplotsRegistry={},a.transformsRegistry={},a.componentsRegistry={},a.layoutArrayContainers=[],a.layoutArrayRegexes=[],a.traceLayoutAttributes={},a.localeRegistry={},a.apiMethodRegistry={},a.collectableSubplotTypes=null,a.register=function(e){if(a.collectableSubplotTypes=null,!e)throw new Error("No argument passed to Plotly.register.");else e&&!Array.isArray(e)&&(e=[e]);for(var t=0,r;t<e.length;t++){if(r=e[t],!r)throw new Error("Invalid module was attempted to be registered!");switch(r.moduleType){case"trace":o(r);break;case"transform":n(r);break;case"component":i(r);break;case"locale":l(r);break;case"apiMethod":var s=r.name;a.apiMethodRegistry[s]=r.fn;break;default:throw new Error("Invalid module was attempted to be registered!");}}},a.getModule=function(e){var t=a.modules[u(e)];return!!t&&t._module},a.traceIs=function(e,t){if(e=u(e),"various"===e)return!1;var o=a.modules[e];return o||(e&&"area"!==e&&g.log("Unrecognized trace type "+e+"."),o=a.modules[_.type.dflt]),!!o.categories[t]},a.getTransformIndices=function(e,t){for(var a=[],o=e.transforms||[],r=0;r<o.length;r++)o[r].type===t&&a.push(r);return a},a.hasTransform=function(e,t){for(var a=e.transforms||[],o=0;o<a.length;o++)if(a[o].type===t)return!0;return!1},a.getComponentMethod=function(e,t){var o=a.componentsRegistry[e];return o?o[t]||m:m},a.call=function(){var e=arguments[0],t=[].slice.call(arguments,1);return a.apiMethodRegistry[e].apply(null,t)}},{"./lib/dom":646,"./lib/extend":648,"./lib/is_plain_object":658,"./lib/loggers":661,"./lib/noop":666,"./lib/push_unique":671,"./plots/attributes":702,"./plots/layout_attributes":759}],789:[function(e,t){'use strict';function a(e){var t;return t="themes__thumb"===e?{autosize:!0,width:150,height:150,title:{text:""},showlegend:!1,margin:{l:5,r:5,t:5,b:5,pad:0},annotations:[]}:"thumbnail"===e?{title:{text:""},hidesources:!0,showlegend:!1,borderwidth:0,bordercolor:"",margin:{l:1,r:1,t:1,b:1,pad:0},annotations:[]}:{},t}function o(e){return-1<["xaxis","yaxis","zaxis"].indexOf(e.slice(0,5))}var r=e("../registry"),i=e("../lib"),n=i.extendFlat,l=i.extendDeep;t.exports=function(e,t){e.framework&&e.framework.isPolar&&(e=e.framework.getConfig());var s=e.data,d=e.layout,c=l([],s),p=l({},d,a(t.tileClass)),u=e._context||{},g;if(t.width&&(p.width=t.width),t.height&&(p.height=t.height),"thumbnail"===t.tileClass||"themes__thumb"===t.tileClass){p.annotations=[];var m=Object.keys(p);for(g=0;g<m.length;g++)o(m[g])&&(p[m[g]].title={text:""});for(g=0;g<c.length;g++){var h=c[g];h.showscale=!1,h.marker&&(h.marker.showscale=!1),r.traceIs(h,"pie-like")&&(h.textposition="none")}}if(Array.isArray(t.annotations))for(g=0;g<t.annotations.length;g++)p.annotations.push(t.annotations[g]);var y=Object.keys(p).filter(function(e){return e.match(/^scene\d*$/)});if(y.length){var f={};for("thumbnail"===t.tileClass&&(f={title:{text:""},showaxeslabels:!1,showticklabels:!1,linetickenable:!1}),g=0;g<y.length;g++){var x=p[y[g]];x.xaxis||(x.xaxis={}),x.yaxis||(x.yaxis={}),x.zaxis||(x.zaxis={}),n(x.xaxis,f),n(x.yaxis,f),n(x.zaxis,f),x._scene=null}}var _=document.createElement("div");t.tileClass&&(_.className=t.tileClass);var b={gd:_,td:_,layout:p,data:c,config:{staticPlot:void 0===t.staticPlot||t.staticPlot,plotGlPixelRatio:void 0===t.plotGlPixelRatio?2:t.plotGlPixelRatio,displaylogo:t.displaylogo||!1,showLink:t.showLink||!1,showTips:t.showTips||!1,mapboxAccessToken:u.mapboxAccessToken}};return"transparent"!==t.setBackground&&(b.config.setBackground=t.setBackground||"opaque"),b.gd.defaultLayout=a(t.tileClass),b}},{"../lib":657,"../registry":788}],790:[function(e,t){'use strict';var a=e("../lib"),o=e("../plot_api/to_image"),r=e("./filesaver"),i=e("./helpers");t.exports=function(e,t){var n;return a.isPlainObject(e)||(n=a.getGraphDiv(e)),t=t||{},t.format=t.format||"png",t.imageDataOnly=!0,new Promise(function(l,s){n&&n._snapshotInProgress&&s(new Error("Snapshotting already in progress.")),a.isIE()&&"svg"!==t.format&&s(new Error(i.MSG_IE_BAD_FORMAT)),n&&(n._snapshotInProgress=!0);var d=o(e,t),c=t.filename||e.fn||"newplot";c+="."+t.format.replace("-","."),d.then(function(e){return n&&(n._snapshotInProgress=!1),r(e,c,t.format)}).then(function(e){l(e)}).catch(function(e){n&&(n._snapshotInProgress=!1),s(e)})})}},{"../lib":657,"../plot_api/to_image":698,"./filesaver":791,"./helpers":792}],791:[function(e,t){'use strict';function a(e,t,a){var i=document.createElement("a"),n=("download"in i),l=new Promise(function(l,s){var d,c;if(o.isIE9orBelow()&&s(new Error("IE < 10 unsupported")),o.isSafari()){var p="svg"===a?",":";base64,";return r.octetStream(p+encodeURIComponent(e)),l(t)}return o.isIE()?(d=r.createBlob(e,"svg"),window.navigator.msSaveBlob(d,t),d=null,l(t)):n?(d=r.createBlob(e,a),c=r.createObjectURL(d),i.href=c,i.download=t,document.body.appendChild(i),i.click(),document.body.removeChild(i),r.revokeObjectURL(c),d=null,l(t)):void s(new Error("download error"))});return l}var o=e("../lib"),r=e("./helpers");t.exports=a},{"../lib":657,"./helpers":792}],792:[function(e,t,a){'use strict';function o(e){for(var t=e.length,a=new ArrayBuffer(t),o=new Uint8Array(a),r=0;r<t;r++)o[r]=e.charCodeAt(r);return a}var r=e("../registry");a.getDelay=function(e){return e._has?e._has("gl3d")||e._has("gl2d")||e._has("mapbox")?500:0:0},a.getRedrawFunc=function(e){return function(){var t=e._fullLayout||{},a=t._has&&t._has("polar"),o=!a&&e.data&&e.data[0]&&e.data[0].r;o||r.getComponentMethod("colorbar","draw")(e)}},a.encodeSVG=function(e){return"data:image/svg+xml,"+encodeURIComponent(e)},a.encodeJSON=function(e){return"data:application/json,"+encodeURIComponent(e)};var i=window.URL||window.webkitURL;a.createObjectURL=function(e){return i.createObjectURL(e)},a.revokeObjectURL=function(e){return i.revokeObjectURL(e)},a.createBlob=function(e,t){if("svg"===t)return new window.Blob([e],{type:"image/svg+xml;charset=utf-8"});if("full-json"===t)return new window.Blob([e],{type:"application/json;charset=utf-8"});var a=o(window.atob(e));return new window.Blob([a],{type:"image/"+t})},a.octetStream=function(e){document.location.href="data:application/octet-stream"+e},a.IMAGE_URL_PREFIX=/^data:image\/\w+;base64,/,a.MSG_IE_BAD_FORMAT="Sorry IE does not support downloading from canvas. Try {format:'svg'} instead."},{"../registry":788}],793:[function(e,t){'use strict';var a=e("./helpers"),o={getDelay:a.getDelay,getRedrawFunc:a.getRedrawFunc,clone:e("./cloneplot"),toSVG:e("./tosvg"),svgToImg:e("./svgtoimg"),toImage:e("./toimage"),downloadImage:e("./download")};t.exports=o},{"./cloneplot":789,"./download":790,"./helpers":792,"./svgtoimg":794,"./toimage":795,"./tosvg":796}],794:[function(e,t){'use strict';var a=e("../lib"),o=e("events").EventEmitter,r=e("./helpers");t.exports=function(e){var t=e.emitter||new o,i=new Promise(function(o,n){var l=window.Image,s=e.svg,d=e.format||"png";if(a.isIE()&&"svg"!==d){var c=new Error(r.MSG_IE_BAD_FORMAT);return n(c),e.promise?i:t.emit("error",c)}var p=e.canvas,u=e.scale||1,g=e.width||300,m=e.height||150,h=u*g,y=u*m,f=p.getContext("2d"),x=new l,_,b;"svg"===d||a.isIE9orBelow()||a.isSafari()?b=r.encodeSVG(s):(_=r.createBlob(s,"svg"),b=r.createObjectURL(_)),p.width=h,p.height=y,x.onload=function(){var a;switch(_=null,r.revokeObjectURL(b),"svg"!==d&&f.drawImage(x,0,0,h,y),d){case"jpeg":a=p.toDataURL("image/jpeg");break;case"png":a=p.toDataURL("image/png");break;case"webp":a=p.toDataURL("image/webp");break;case"svg":a=b;break;default:var i="Image format is not jpeg, png, svg or webp.";if(n(new Error(i)),!e.promise)return t.emit("error",i);}o(a),e.promise||t.emit("success",a)},x.onerror=function(a){if(_=null,r.revokeObjectURL(b),n(a),!e.promise)return t.emit("error",a)},x.src=b});return e.promise?i:t}},{"../lib":657,"./helpers":792,events:1421}],795:[function(e,t){'use strict';var a=e("events").EventEmitter,o=e("../registry"),r=e("../lib"),i=e("./helpers"),n=e("./cloneplot"),l=e("./tosvg"),s=e("./svgtoimg");t.exports=function(e,t){var d=new a,c=n(e,{format:"png"}),p=c.gd;p.style.position="absolute",p.style.left="-5000px",document.body.appendChild(p);var u=i.getRedrawFunc(p);return o.call("plot",p,c.data,c.layout,c.config).then(u).then(function(){var e=i.getDelay(p._fullLayout);setTimeout(function(){var e=l(p),a=document.createElement("canvas");a.id=r.randstr(),d=s({format:t.format,width:p._fullLayout.width,height:p._fullLayout.height,canvas:a,emitter:d,svg:e}),d.clean=function(){p&&document.body.removeChild(p)}},e)}).catch(function(e){d.emit("error",e)}),d}},{"../lib":657,"../registry":788,"./cloneplot":789,"./helpers":792,"./svgtoimg":794,"./tosvg":796,events:1421}],796:[function(e,t){'use strict';function a(e){var t=r.select("body").append("div").style({display:"none"}).html(""),a=e.replace(/(&[^;]*;)/gi,function(e){return"&lt;"===e?"&#60;":"&rt;"===e?"&#62;":-1!==e.indexOf("<")||-1!==e.indexOf(">")?"":t.html(e).text()});return t.remove(),a}function o(e){return e.replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;")}var r=e("d3"),n=e("../lib"),l=e("../components/drawing"),d=e("../components/color"),c=e("../constants/xmlns_namespaces"),p=/"/g,u="TOBESTRIPPED",g=new RegExp("(\""+u+")|("+u+"\")","g");t.exports=function(e,t,m){var h=e._fullLayout,y=h._paper,f=h._toppaper,x=h.width,_=h.height,b;y.insert("rect",":first-child").call(l.setRect,0,0,x,_).call(d.fill,h.paper_bgcolor);var v=h._basePlotModules||[];for(b=0;b<v.length;b++){var w=v[b];w.toSVG&&w.toSVG(e)}if(f){var T=f.node().childNodes,A=Array.prototype.slice.call(T);for(b=0;b<A.length;b++){var S=A[b];S.childNodes.length&&y.node().appendChild(S)}}if(h._draggers&&h._draggers.remove(),y.node().style.background="",y.selectAll("text").attr({"data-unformatted":null,"data-math":null}).each(function(){var e=r.select(this);if("hidden"===this.style.visibility||"none"===this.style.display)return void e.remove();e.style({visibility:null,display:null});var t=this.style.fontFamily;t&&-1!==t.indexOf("\"")&&e.style("font-family",t.replace(p,u))}),h._gradientUrlQueryParts){var C=[];for(var L in h._gradientUrlQueryParts)C.push(L);C.length&&y.selectAll(C.join(",")).each(function(){var e=r.select(this),t=this.style.fill;t&&-1!==t.indexOf("url(")&&e.style("fill",t.replace(p,u));var a=this.style.stroke;a&&-1!==a.indexOf("url(")&&e.style("stroke",a.replace(p,u))})}("pdf"===t||"eps"===t)&&y.selectAll("#MathJax_SVG_glyphs path").attr("stroke-width",0),y.node().setAttributeNS(c.xmlns,"xmlns",c.svg),y.node().setAttributeNS(c.xmlns,"xmlns:xlink",c.xlink),"svg"===t&&m&&(y.attr("width",m*x),y.attr("height",m*_),y.attr("viewBox","0 0 "+x+" "+_));var k=new window.XMLSerializer().serializeToString(y.node());return k=a(k),k=o(k),k=k.replace(g,"'"),n.isIE()&&(k=k.replace(/"/gi,"'"),k=k.replace(/(\('#)([^']*)('\))/gi,"(\"#$2\")"),k=k.replace(/(\\')/gi,"\"")),k}},{"../components/color":524,"../components/drawing":546,"../constants/xmlns_namespaces":634,"../lib":657,d3:108}],797:[function(e,t){'use strict';var a=e("../../lib");t.exports=function(e,t){for(var o=0;o<e.length;o++)e[o].i=o;a.mergeArray(t.text,e,"tx"),a.mergeArray(t.hovertext,e,"htx");var r=t.marker;if(r){a.mergeArray(r.opacity,e,"mo",!0),a.mergeArray(r.color,e,"mc");var n=r.line;n&&(a.mergeArray(n.color,e,"mlc"),a.mergeArrayCastPositive(n.width,e,"mlw"))}}},{"../../lib":657}],798:[function(e,t){'use strict';var a=e("../scatter/attributes"),o=e("../../plots/template_attributes").hovertemplateAttrs,r=e("../../plots/template_attributes").texttemplateAttrs,i=e("../../components/colorscale/attributes"),n=e("../../plots/font_attributes"),l=e("./constants"),s=e("../../lib/extend").extendFlat,d=n({editType:"calc",arrayOk:!0,colorEditType:"style"}),c=a.marker,p=c.line,u=s({},p.width,{dflt:0}),g=s({width:u,editType:"calc"},i("marker.line")),m=s({line:g,editType:"calc"},i("marker"),{opacity:{valType:"number",arrayOk:!0,dflt:1,min:0,max:1,editType:"style"}});t.exports={x:a.x,x0:a.x0,dx:a.dx,y:a.y,y0:a.y0,dy:a.dy,text:a.text,texttemplate:r({editType:"plot"},{keys:l.eventDataKeys}),hovertext:a.hovertext,hovertemplate:o({},{keys:l.eventDataKeys}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"none",arrayOk:!0,editType:"calc"},insidetextanchor:{valType:"enumerated",values:["end","middle","start"],dflt:"end",editType:"plot"},textangle:{valType:"angle",dflt:"auto",editType:"plot"},textfont:s({},d,{}),insidetextfont:s({},d,{}),outsidetextfont:s({},d,{}),constraintext:{valType:"enumerated",values:["inside","outside","both","none"],dflt:"both",editType:"calc"},cliponaxis:s({},a.cliponaxis,{}),orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},base:{valType:"any",dflt:null,arrayOk:!0,editType:"calc"},offset:{valType:"number",dflt:null,arrayOk:!0,editType:"calc"},width:{valType:"number",dflt:null,min:0,arrayOk:!0,editType:"calc"},marker:m,offsetgroup:{valType:"string",dflt:"",editType:"calc"},alignmentgroup:{valType:"string",dflt:"",editType:"calc"},selected:{marker:{opacity:a.selected.marker.opacity,color:a.selected.marker.color,editType:"style"},textfont:a.selected.textfont,editType:"style"},unselected:{marker:{opacity:a.unselected.marker.opacity,color:a.unselected.marker.color,editType:"style"},textfont:a.unselected.textfont,editType:"style"},r:a.r,t:a.t,_deprecated:{bardir:{valType:"enumerated",editType:"calc",values:["v","h"]}}}},{"../../components/colorscale/attributes":531,"../../lib/extend":648,"../../plots/font_attributes":733,"../../plots/template_attributes":783,"../scatter/attributes":1062,"./constants":800}],799:[function(e,t){'use strict';var a=Math.min,o=e("../../plots/cartesian/axes"),r=e("../../components/colorscale/helpers").hasColorscale,n=e("../../components/colorscale/calc"),l=e("./arrays_to_calcdata"),s=e("../scatter/calc_selection");t.exports=function(e,t){var d=o.getFromId(e,t.xaxis||"x"),c=o.getFromId(e,t.yaxis||"y"),p,u;"h"===t.orientation?(p=d.makeCalcdata(t,"x"),u=c.makeCalcdata(t,"y")):(p=c.makeCalcdata(t,"y"),u=d.makeCalcdata(t,"x"));for(var g=a(u.length,p.length),m=Array(g),h=0;h<g;h++)m[h]={p:u[h],s:p[h]},t.ids&&(m[h].id=t.ids[h]+"");return r(t,"marker")&&n(e,t,{vals:t.marker.color,containerStr:"marker",cLetter:"c"}),r(t,"marker.line")&&n(e,t,{vals:t.marker.line.color,containerStr:"marker.line",cLetter:"c"}),l(m,t),s(m,t),m}},{"../../components/colorscale/calc":532,"../../components/colorscale/helpers":535,"../../plots/cartesian/axes":705,"../scatter/calc_selection":1064,"./arrays_to_calcdata":797}],800:[function(e,t){'use strict';t.exports={TEXTPAD:3,eventDataKeys:["value","label"]}},{}],801:[function(e,t){'use strict';var v=Math.min,w=Math.abs,k=Math.max;function a(e,t,a,s,d){if(s.length){var c,p,u,g,m;switch(o(a,s),d.mode){case"overlay":r(t,a,s,d);break;case"group":for(c=[],p=[],u=0;u<s.length;u++)g=s[u],m=g[0].trace,void 0===m.offset?p.push(g):c.push(g);p.length&&n(e,t,a,p,d),c.length&&r(t,a,c,d);break;case"stack":case"relative":for(c=[],p=[],u=0;u<s.length;u++)g=s[u],m=g[0].trace,void 0===m.base?p.push(g):c.push(g);p.length&&l(e,t,a,p,d),c.length&&r(t,a,c,d);}x(s,t)}}function o(e,t){var a,o;for(a=0;a<t.length;a++){var r=t[a],n=r[0].trace,l="funnel"===n.type?n._base:n.base,s="h"===n.orientation?n.xcalendar:n.ycalendar,d="category"===e.type||"multicategory"===e.type?function(){return null}:e.d2c,c;if(A(l)){for(o=0;o<v(l.length,r.length);o++)c=d(l[o],0,s),T(c)?(r[o].b=+c,r[o].hasB=1):r[o].b=0;for(;o<r.length;o++)r[o].b=0}else{c=d(l,0,s);var p=T(c);for(c=p?c:0,o=0;o<r.length;o++)r[o].b=c,p&&(r[o].hasB=1)}}}function r(e,t,a,o){for(var r=0;r<a.length;r++){var n=a[r],l=new I([n],{sepNegVal:!1,overlapNoMerge:!o.norm});s(e,l,o),o.norm?(h(l),f(t,l,o)):g(t,l)}}function n(e,t,a,o,r){var i=new I(o,{sepNegVal:!1,overlapNoMerge:!r.norm});d(e,t,i,r),y(i),r.norm?(h(i),f(a,i,r)):g(a,i)}function l(e,t,a,o,r){var n=new I(o,{sepNegVal:"relative"===r.mode,overlapNoMerge:!(r.norm||"stack"===r.mode||"relative"===r.mode)});s(t,n,r),m(a,n,r);for(var l=0,d;l<o.length;l++){d=o[l];for(var c=0,p;c<d.length;c++)if(p=d[c],p.s!==S){var u=p.b+p.s===n.get(p.p,p.s);u&&(p._outmost=!0)}}r.norm&&f(a,n,r)}function s(e,a,o){for(var r=a.minDiff,n=a.traces,l=r*(1-o.gap),s=l*(1-(o.groupgap||0)),d=0;d<n.length;d++){var g=n[d],m=g[0].t;m.barwidth=s,m.poffset=-s/2,m.bargroupwidth=l,m.bardelta=r}a.binWidth=n[0][0].t.barwidth/100,c(a),p(e,a),u(e,a)}function d(e,a,o,r){for(var n=e._fullLayout,l=o.positions,s=o.distinctPositions,d=o.minDiff,g=o.traces,m=g.length,h=l.length!==s.length,y=d*(1-r.gap),f=E(n,a._id)+g[0][0].trace.orientation,x=n._alignmentOpts[f]||{},_=0;_<m;_++){var b=g[_],v=b[0].trace,w=x[v.alignmentgroup]||{},k=Object.keys(w.offsetGroups||{}).length,T;T=k?y/k:h?y/m:y;var A=T*(1-(r.groupgap||0)),S;S=k?((2*v._offsetIndex+1-k)*T-A)/2:h?((2*_+1-m)*T-A)/2:-A/2;var C=b[0].t;C.barwidth=A,C.poffset=S,C.bargroupwidth=y,C.bardelta=d}o.binWidth=g[0][0].t.barwidth/100,c(o),p(a,o),u(a,o,h)}function c(e){var a=e.traces,o,r;for(o=0;o<a.length;o++){var n=a[o],l=n[0],s=l.trace,d=l.t,t=s._offset||s.offset,c=d.poffset,p;if(A(t)){for(p=Array.prototype.slice.call(t,0,n.length),r=0;r<p.length;r++)T(p[r])||(p[r]=c);for(r=p.length;r<n.length;r++)p.push(c);d.poffset=p}else void 0!==t&&(d.poffset=t);var u=s._width||s.width,g=d.barwidth;if(A(u)){var m=Array.prototype.slice.call(u,0,n.length);for(r=0;r<m.length;r++)T(m[r])||(m[r]=g);for(r=m.length;r<n.length;r++)m.push(g);if(d.barwidth=m,void 0===t){for(p=[],r=0;r<n.length;r++)p.push(c+(g-m[r])/2);d.poffset=p}}else void 0!==u&&(d.barwidth=u,void 0===t&&(d.poffset=c+(g-u)/2))}}function p(e,a){for(var o=a.traces,r=_(e),n=0;n<o.length;n++)for(var l=o[n],s=l[0].t,t=s.poffset,d=Array.isArray(t),c=s.barwidth,p=Array.isArray(c),u=0;u<l.length;u++){var g=l[u],m=g.w=p?c[u]:c;g[r]=g.p+(d?t[u]:t)+m/2}}function u(e,a,o){var n=a.traces,s=a.minDiff,d=s/2;L.minDtick(e,a.minDiff,a.distinctPositions[0],o);for(var c=0;c<n.length;c++){var p=n[c],u=p[0],g=u.trace,m=[],h,y,f,x;for(x=0;x<p.length;x++)h=p[x],y=h.p-d,f=h.p+d,m.push(y,f);if(g.width||g.offset){var _=u.t,t=_.poffset,b=_.barwidth,v=Array.isArray(t),w=Array.isArray(b);for(x=0;x<p.length;x++){h=p[x];var k=v?t[x]:t,T=w?b[x]:b;y=h.p+k,f=y+T,m.push(y,f)}}g._extremes[e._id]=L.findExtremes(e,m,{padded:!1})}}function g(e,t){for(var a=t.traces,o=_(e),r=0;r<a.length;r++){for(var n=a[r],l=n[0].trace,s=[],d=!1,c=0;c<n.length;c++){var p=n[c],u=p.b,g=u+p.s;p[o]=g,s.push(g),p.hasB&&s.push(u),p.hasB&&p.b||(d=!0)}l._extremes[e._id]=L.findExtremes(e,s,{tozero:d,padded:!0})}}function m(e,t,a){var o=_(e),r=t.traces,n,l,s,d,c,p;for(d=0;d<r.length;d++)if(n=r[d],l=n[0].trace,"funnel"===l.type)for(c=0;c<n.length;c++)p=n[c],p.s!==S&&t.put(p.p,-.5*p.s);for(d=0;d<r.length;d++){n=r[d],l=n[0].trace,s="funnel"===l.type;var u=[];for(c=0;c<n.length;c++)if(p=n[c],p.s!==S){var g=s?p.s:p.s+p.b;var m=t.put(p.p,g),h=m+g;p.b=m,p[o]=h,a.norm||(u.push(h),p.hasB&&u.push(m))}a.norm||(l._extremes[e._id]=L.findExtremes(e,u,{tozero:!0,padded:!0}))}}function h(e){for(var t=e.traces,a=0,o;a<t.length;a++){o=t[a];for(var r=0,n;r<o.length;r++)n=o[r],n.s!==S&&e.put(n.p,n.b+n.s)}}function y(e){for(var t=e.traces,a=0;a<t.length;a++){var o=t[a],r=o[0].trace;if(r.base===void 0)for(var n=new I([o],{sepNegVal:!0,overlapNoMerge:!0}),l=0,s;l<o.length;l++)if(s=o[l],s.p!==S){var d=n.put(s.p,s.b+s.s);d&&(s.b=d)}}}function f(e,t,a){function o(t){return T(e.c2l(t))&&(t<d-s||t>c+s||!T(d))}for(var r=t.traces,n=_(e),l="fraction"===a.norm?1:100,s=l/1e9,d=e.l2c(e.c2l(0)),c="stack"===a.mode?l:d,p=0;p<r.length;p++){for(var u=r[p],g=u[0].trace,m=[],h=!1,y=!1,f=0,x;f<u.length;f++)if(x=u[f],x.s!==S){var b=w(l/t.get(x.p,x.s));x.b*=b,x.s*=b;var v=x.b,k=v+x.s;x[n]=k,m.push(k),y=y||o(k),x.hasB&&(m.push(v),y=y||o(v)),x.hasB&&x.b||(h=!0)}g._extremes[e._id]=L.findExtremes(e,m,{tozero:h,padded:y})}}function x(e,t){var a=_(t),o={},r=1/0,n=-Infinity,l,s,d;for(l=0;l<e.length;l++)for(d=e[l],s=0;s<d.length;s++){var c=d[s].p;T(c)&&(r=v(r,c),n=k(n,c))}var u=1e4/(n-r),g=o.round=function(e){return Math.round(u*(e-r))+""};for(l=0;l<e.length;l++){d=e[l],d[0].t.extents=o;var m=d[0].t.poffset,h=Array.isArray(m);for(s=0;s<d.length;s++){var y=d[s],p=y[a]-y.w/2;if(T(p)){var f=y[a]+y.w/2,x=g(y.p);o[x]=o[x]?[v(p,o[x][0]),k(f,o[x][1])]:[p,f]}y.p0=y.p+(h?m[s]:m),y.p1=y.p0+y.w,y.s0=y.b,y.s1=y.s0+y.s}}}function _(e){return e._id.charAt(0)}var T=e("fast-isnumeric"),A=e("../../lib").isArrayOrTypedArray,S=e("../../constants/numerical").BADNUM,C=e("../../registry"),L=e("../../plots/cartesian/axes"),E=e("../../plots/cartesian/axis_ids").getAxisGroup,I=e("./sieve.js");t.exports={crossTraceCalc:function(e,t){for(var o=t.xaxis,r=t.yaxis,n=e._fullLayout,l=e._fullData,s=e.calcdata,d=[],c=[],p=0,u;p<l.length;p++)if(u=l[p],!0===u.visible&&C.traceIs(u,"bar")&&u.xaxis===o._id&&u.yaxis===r._id&&("h"===u.orientation?d.push(s[p]):c.push(s[p]),u._computePh))for(var g=e.calcdata[p],m=0;m<g.length;m++)"function"==typeof g[m].ph0&&(g[m].ph0=g[m].ph0()),"function"==typeof g[m].ph1&&(g[m].ph1=g[m].ph1());var h={mode:n.barmode,norm:n.barnorm,gap:n.bargap,groupgap:n.bargroupgap};a(e,o,r,c,h),a(e,r,o,d,h)},setGroupPositions:a}},{"../../constants/numerical":633,"../../lib":657,"../../plots/cartesian/axes":705,"../../plots/cartesian/axis_ids":708,"../../registry":788,"./sieve.js":811,"fast-isnumeric":201}],802:[function(e,t){'use strict';function a(e,t,a,o){var r=t.orientation,i=t[{v:"x",h:"y"}[r]+"axis"],n=d(a,i)+r,l=a._alignmentOpts||{},s=o("alignmentgroup"),c=l[n];c||(c=l[n]={});var p=c[s];p?p.traces.push(t):p=c[s]={traces:[t],alignmentIndex:Object.keys(c).length,offsetGroups:{}};var u=o("offsetgroup"),g=p.offsetGroups,m=g[u];u&&(!m&&(m=g[u]={offsetIndex:Object.keys(g).length}),t._offsetIndex=m.offsetIndex)}function o(e,t,a,o,i,n){n=n||{};var l=!1!==n.moduleHasSelected,s=!1!==n.moduleHasUnselected,d=!1!==n.moduleHasConstrain,c=!1!==n.moduleHasCliponaxis,u=!1!==n.moduleHasTextangle,g=!1!==n.moduleHasInsideanchor,m=!!n.hasPathbar,h=Array.isArray(i)||"auto"===i,y=h||"inside"===i,f=h||"outside"===i;if(y||f){var x=p(o,"textfont",a.font),_=r.extendFlat({},x),b=e.textfont&&e.textfont.color,v=!b;if(v&&delete _.color,p(o,"insidetextfont",_),m){var w=r.extendFlat({},x);v&&delete w.color,p(o,"pathbar.textfont",w)}f&&p(o,"outsidetextfont",x),l&&o("selected.textfont.color"),s&&o("unselected.textfont.color"),d&&o("constraintext"),c&&o("cliponaxis"),u&&o("textangle"),o("texttemplate")}y&&g&&o("insidetextanchor")}var r=e("../../lib"),i=e("../../components/color"),n=e("../../registry"),l=e("../scatter/xy_defaults"),s=e("./style_defaults"),d=e("../../plots/cartesian/axis_ids").getAxisGroup,c=e("./attributes"),p=r.coerceFont;t.exports={supplyDefaults:function(e,t,a,d){function p(a,o){return r.coerce(e,t,c,a,o)}var u=l(e,t,d,p);if(!u)return void(t.visible=!1);p("orientation",t.x&&!t.y?"h":"v"),p("base"),p("offset"),p("width"),p("text"),p("hovertext"),p("hovertemplate");var g=p("textposition");o(e,t,d,p,g,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),s(e,t,p,a,d);var m=(t.marker.line||{}).color,h=n.getComponentMethod("errorbars","supplyDefaults");h(e,t,m||i.defaultLine,{axis:"y"}),h(e,t,m||i.defaultLine,{axis:"x",inherit:"y"}),r.coerceSelectionMarkerOpacity(t,p)},crossTraceDefaults:function(e,t){function o(e){return r.coerce(l._input,l,c,e)}var n,l;if("group"===t.barmode)for(var s=0;s<e.length;s++)l=e[s],"bar"===l.type&&(n=l._input,a(n,l,t,o))},handleGroupingDefaults:a,handleText:o}},{"../../components/color":524,"../../lib":657,"../../plots/cartesian/axis_ids":708,"../../registry":788,"../scatter/xy_defaults":1088,"./attributes":798,"./style_defaults":813}],803:[function(e,t){'use strict';t.exports=function(e,t,a){return e.x="xVal"in t?t.xVal:t.x,e.y="yVal"in t?t.yVal:t.y,t.xa&&(e.xaxis=t.xa),t.ya&&(e.yaxis=t.ya),"h"===a.orientation?(e.label=e.y,e.value=e.x):(e.label=e.x,e.value=e.y),e}},{}],804:[function(e,t,a){'use strict';var o=e("fast-isnumeric"),r=e("tinycolor2"),i=e("../../lib").isArrayOrTypedArray;a.coerceString=function(e,t,a){if("string"==typeof t){if(t||!e.noBlank)return t;}else if(("number"==typeof t||!0===t)&&!e.strict)return t+"";return a===void 0?e.dflt:a},a.coerceNumber=function(e,t,a){if(o(t)){t=+t;var r=e.min,i=e.max,n=r!==void 0&&t<r||i!==void 0&&t>i;if(!n)return t}return a===void 0?e.dflt:a},a.coerceColor=function(e,t,a){return r(t).isValid()?t:a===void 0?e.dflt:a},a.coerceEnumerated=function(e,t,a){return e.coerceNumber&&(t=+t),-1===e.values.indexOf(t)?void 0===a?e.dflt:a:t},a.getValue=function(e,t){var a;return Array.isArray(e)?t<e.length&&(a=e[t]):a=e,a},a.getLineWidth=function(e,t){var a=0<t.mlw?t.mlw:i(e.marker.line.width)?0:e.marker.line.width;return a}},{"../../lib":657,"fast-isnumeric":201,tinycolor2:1309}],805:[function(e,t){'use strict';var r=Math.min,i=Math.abs,n=Math.max;function a(e,a,o,s){function d(e){return e[L]-e.w/2}function p(e){return e[L]+e.w/2}function m(e,t){return l.inbox(e-S,t-S,k+r(1,i(t-e)/z)-1)}function h(e){return m(T(e),A(e))}function y(e){return m(d(e),p(e))}function f(e){var t=C,a=e.b,o=e[E];if(w){var r=i(e.rawS)||0;0<t?o+=r:0>t&&(o-=r)}return l.inbox(a-t,o-t,k+(o-t)/(o-a)-1)}function x(e){return(I(e)+P(e))/2}var _=e.cd,b=_[0].trace,v=_[0].t,t="closest"===s,w="waterfall"===b.type,k=e.maxHoverDistance,T=t?d:function(e){return r(d(e),e.p-v.bardelta/2)},A=t?p:function(e){return n(p(e),e.p+v.bardelta/2)},S,C,L,E,I,P,z;"h"===b.orientation?(S=o,C=a,L="y",E="x",I=f,P=h):(S=a,C=o,L="x",E="y",P=f,I=h);var D=e[L+"a"],O=e[E+"a"];z=i(D.r2c(D.range[1])-D.r2c(D.range[0]));var R=l.getDistanceFunction(s,I,P,x);if((l.getClosest(_,R,e),!1!==e.index)&&_[e.index].p!==g){t||(T=function(e){return r(d(e),e.p-v.bargroupwidth/2)},A=function(e){return n(p(e),e.p+v.bargroupwidth/2)});var M=e.index,j=_[M],B=b.base?j.b+j.s:j.s;e[E+"0"]=e[E+"1"]=O.c2p(j[E],!0),e[E+"LabelVal"]=B;var F=v.extents[v.extents.round(j.p)];return e[L+"0"]=D.c2p(t?T(j):F[0],!0),e[L+"1"]=D.c2p(t?A(j):F[1],!0),e[L+"LabelVal"]=j.p,e.labelLabel=u(D,e[L+"LabelVal"]),e.valueLabel=u(O,e[E+"LabelVal"]),e.spikeDistance=(f(j)+y(j))/2-k,e[L+"Spike"]=D.c2p(j.p,!0),c(j,b,e),e.hovertemplate=b.hovertemplate,e}}function o(e,t){var a=t.mcc||e.marker.color,o=t.mlcc||e.marker.line.color,r=p(e,t);if(d.opacity(a))return a;return d.opacity(o)&&r?o:void 0}var l=e("../../components/fx"),s=e("../../registry"),d=e("../../components/color"),c=e("../../lib").fillText,p=e("./helpers").getLineWidth,u=e("../../plots/cartesian/axes").hoverLabelText,g=e("../../constants/numerical").BADNUM;t.exports={hoverPoints:function(e,t,r,i){var n=a(e,t,r,i);if(n){var l=n.cd,d=l[0].trace,c=l[n.index];return n.color=o(d,c),s.getComponentMethod("errorbars","hoverInfo")(c,d,n),[n]}},hoverOnBars:a,getTraceColor:o}},{"../../components/color":524,"../../components/fx":564,"../../constants/numerical":633,"../../lib":657,"../../plots/cartesian/axes":705,"../../registry":788,"./helpers":804}],806:[function(e,t){'use strict';t.exports={attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults").supplyDefaults,crossTraceDefaults:e("./defaults").crossTraceDefaults,supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc"),crossTraceCalc:e("./cross_trace_calc").crossTraceCalc,colorbar:e("../scatter/marker_colorbar"),arraysToCalcdata:e("./arrays_to_calcdata"),plot:e("./plot").plot,style:e("./style").style,styleOnSelect:e("./style").styleOnSelect,hoverPoints:e("./hover").hoverPoints,eventData:e("./event_data"),selectPoints:e("./select"),moduleType:"trace",name:"bar",basePlotModule:e("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","oriented","errorBarsOK","showLegend","zoomScale"],animatable:!0,meta:{}}},{"../../plots/cartesian":718,"../scatter/marker_colorbar":1080,"./arrays_to_calcdata":797,"./attributes":798,"./calc":799,"./cross_trace_calc":801,"./defaults":802,"./event_data":803,"./hover":805,"./layout_attributes":807,"./layout_defaults":808,"./plot":809,"./select":810,"./style":812}],807:[function(e,t){'use strict';t.exports={barmode:{valType:"enumerated",values:["stack","group","overlay","relative"],dflt:"group",editType:"calc"},barnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},bargap:{valType:"number",min:0,max:1,editType:"calc"},bargroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],808:[function(e,t){'use strict';var a=e("../../registry"),o=e("../../plots/cartesian/axes"),r=e("../../lib"),i=e("./layout_attributes");t.exports=function(e,t,n){function l(a,o){return r.coerce(e,t,i,a,o)}for(var s=!1,d=!1,c=!1,p={},u=l("barmode"),g=0,m;g<n.length;g++){if(m=n[g],a.traceIs(m,"bar")&&m.visible)s=!0;else continue;if("group"===u){var h=m.xaxis+m.yaxis;p[h]&&(c=!0),p[h]=!0}if(m.visible&&"histogram"===m.type){var y=o.getFromId({_fullLayout:t},m["v"===m.orientation?"xaxis":"yaxis"]);"category"!==y.type&&(d=!0)}}return s?void("overlay"!==u&&l("barnorm"),l("bargap",d&&!c?0:.2),l("bargroupgap")):void delete t.barmode}},{"../../lib":657,"../../plots/cartesian/axes":705,"../../registry":788,"./layout_attributes":807}],809:[function(e,t){'use strict';var x=Math.ceil,_=Math.round,b=Math.min,w=Math.abs,k=Math.floor;function a(e){return e.id}function o(e){if(e.ids)return a}function r(e,t){return e<t?1:-1}function n(e,t,a,o){var r=[],i=[],n=o?t:a,l=o?a:t;return r[0]=n.c2p(e.s0,!0),i[0]=l.c2p(e.p0,!0),r[1]=n.c2p(e.s1,!0),i[1]=l.c2p(e.p1,!0),o?[r,i]:[i,r]}function l(e,t,a,o){if(!t.uniformtext.mode&&s(a)){var r;return o&&(r=o()),e.transition().duration(a.duration).ease(a.easing).each("end",function(){r&&r()}).each("interrupt",function(){r&&r()})}return e}function s(e){return e&&0<e.duration}function d(e,t,a,o,r,i,n,s,d,c,p){function y(t,a,o){var r=A.ensureSingle(t,"text").text(a).attr({class:"bartext bartext-"+T,"text-anchor":"middle","data-notex":1}).call(L.font,o).call(S.convertToTspans,e);return r}var f=t.xaxis,x=t.yaxis,_=e._fullLayout,b=o[0].trace,v="h"===b.orientation,k=m(_,o,r,f,x),T;T=h(b,r);var C="stack"===c.mode||"relative"===c.mode,E=o[r],I=!C||E._outmost;if(!k||"none"===T||(E.isBlank||i===n||s===d)&&("auto"===T||"inside"===T))return void a.select("text").remove();var P=_.font,D=O.getBarColor(o[r],b),R=O.getInsideTextFont(b,r,P,D),M=O.getOutsideTextFont(b,r,P),j=a.datum();v?"log"===f.type&&0>=j.s0&&(f.range[0]<f.range[1]?i=0:i=f._length):"log"===x.type&&0>=j.s0&&(x.range[0]<x.range[1]?s=x._length:s=0);var B=w(n-i)-2*V,F=w(d-s)-2*V,N,U,H,q,G;if("outside"!==T||I||E.hasB||(T="inside"),"auto"===T)if(I){T="inside",G=A.ensureUniformFontSize(e,R),N=y(a,k,G),U=L.bBox(N.node()),H=U.width,q=U.height;var Y=0<H&&0<q,W=H<=B&&q<=F,X=H<=F&&q<=B,Z=v?B>=H*(F/q):F>=q*(B/H);Y&&(W||X||Z)?T="inside":(T="outside",N.remove(),N=null)}else T="inside";if(!N){G=A.ensureUniformFontSize(e,"outside"===T?M:R),N=y(a,k,G);var K=N.attr("transform");if(N.attr("transform",""),U=L.bBox(N.node()),H=U.width,q=U.height,N.attr("transform",K),0>=H||0>=q)return void N.remove()}var $=b.textangle,J,Q;"outside"===T?(Q="both"===b.constraintext||"outside"===b.constraintext,J=g(i,n,s,d,U,{isHorizontal:v,constrained:Q,angle:$})):(Q="both"===b.constraintext||"inside"===b.constraintext,J=u(i,n,s,d,U,{isHorizontal:v,constrained:Q,angle:$,anchor:b.insidetextanchor})),J.fontSize=G.size,z(b.type,J,_),E.transform=J,l(N,_,c,p).attr("transform",A.getTextTransform(J))}function c(e){return"auto"===e?0:e}function p(e,t){var o=Math.PI/180*t,a=w(Math.sin(o)),r=w(Math.cos(o));return{x:e.width*r+e.height*a,y:e.width*a+e.height*r}}function u(e,a,o,i,n,l){var s=!!l.isHorizontal,d=!!l.constrained,u=l.angle||0,g=l.anchor||"end",m="start"===g,h=l.leftToRight||0,y=(h+1)/2,f=1-y,x=n.width,_=n.height,v=w(a-e),k=w(i-o),T=v>2*V&&k>2*V?V:0;v-=2*T,k-=2*T;var A=c(u);"auto"===u&&!(x<=v&&_<=k)&&(x>v||_>k)&&(!(x>k||_>v)||x<_!=v<k)&&(A+=90);var S=p(n,A),t=1;d&&(t=b(1,v/S.x,k/S.y));var C=n.left*f+n.right*y,L=(n.top+n.bottom)/2,E=(e+V)*f+(a-V)*y,I=(o+i)/2,P=0,z=0;if(m||"end"===g){var D=(s?S.x:S.y)/2,O=s?r(e,a):r(o,i);s?m?(E=e+O*T,P=-O*D):(E=a-O*T,P=O*D):m?(I=o+O*T,z=-O*D):(I=i-O*T,z=O*D)}return{textX:C,textY:L,targetX:E,targetY:I,anchorX:P,anchorY:z,scale:t,rotate:A}}function g(e,a,o,i,n,l){var s=!!l.isHorizontal,d=!!l.constrained,u=l.angle||0,g=n.width,m=n.height,h=w(a-e),y=w(i-o),f;f=s?y>2*V?V:0:h>2*V?V:0;var x=1;d&&(x=s?b(1,y/m):b(1,h/g));var _=c(u),v=p(n,_),t=(s?v.x:v.y)/2,k=(n.left+n.right)/2,T=(n.top+n.bottom)/2,A=(e+a)/2,S=(o+i)/2,C=0,L=0,E=s?r(a,e):r(o,i);return s?(A=a-E*f,C=E*t):(S=i+E*f,L=-E*t),{textX:k,textY:T,targetX:A,targetY:S,anchorX:C,anchorY:L,scale:x,rotate:_}}function m(e,t,a,o,r){var i=t[0].trace,n=i.texttemplate,l;return l=n?y(e,t,a,o,r):i.textinfo?f(t,a,o,r):R.getValue(i.text,a),R.coerceString(B,l)}function h(e,t){var a=R.getValue(e.textposition,t);return R.coerceEnumerated(F,a)}function y(e,t,a,o,r){function i(e){return I(g,e,!0).text}function n(e){return I(h,+e,!0).text}var l=t[0].trace,s=A.castOption(l,a,"texttemplate");if(!s)return"";var d="waterfall"===l.type,c="funnel"===l.type,p,g,m,h;"h"===l.orientation?(p="y",g=r,m="x",h=o):(p="x",g=o,m="y",h=r);var y=t[a],f={};f.label=y.p,f.labelLabel=f[p+"Label"]=i(y.p);var x=A.castOption(l,y.i,"text");(0===x||x)&&(f.text=x),f.value=y.s,f.valueLabel=f[m+"Label"]=n(y.s);var u={};N(u,l,y.i),d&&(f.delta=+y.rawS||y.s,f.deltaLabel=n(f.delta),f.final=y.v,f.finalLabel=n(f.final),f.initial=f.final-f.delta,f.initialLabel=n(f.initial)),c&&(f.value=y.s,f.valueLabel=n(f.value),f.percentInitial=y.begR,f.percentInitialLabel=A.formatPercent(y.begR),f.percentPrevious=y.difR,f.percentPreviousLabel=A.formatPercent(y.difR),f.percentTotal=y.sumR,f.percenTotalLabel=A.formatPercent(y.sumR));var _=A.castOption(l,y.i,"customdata");return _&&(f.customdata=_),A.texttemplateString(s,f,e._d3locale,u,f,l._meta||{})}function f(e,t,a,o){function r(e){var t=n?a:o;return I(t,+e,!0).text}var i=e[0].trace,n="h"===i.orientation,l="waterfall"===i.type,s="funnel"===i.type,d=i.textinfo,c=e[t],p=d.split("+"),u=[],g=function(e){return-1!==p.indexOf(e)},m;if(g("label")&&u.push(function(e){var t=n?o:a;return I(t,e,!0).text}(e[t].p)),g("text")&&(m=A.castOption(i,c.i,"text"),(0===m||m)&&u.push(m)),l){var h=+c.rawS||c.s,y=c.v;g("initial")&&u.push(r(y-h)),g("delta")&&u.push(r(h)),g("final")&&u.push(r(y))}if(s){g("value")&&u.push(r(c.s));var f=0;g("percent initial")&&f++,g("percent previous")&&f++,g("percent total")&&f++;var x=1<f;g("percent initial")&&(m=A.formatPercent(c.begR),x&&(m+=" of initial"),u.push(m)),g("percent previous")&&(m=A.formatPercent(c.difR),x&&(m+=" of previous"),u.push(m)),g("percent total")&&(m=A.formatPercent(c.sumR),x&&(m+=" of total"),u.push(m))}return u.join("<br>")}var T=e("d3"),v=e("fast-isnumeric"),A=e("../../lib"),S=e("../../lib/svg_text_utils"),C=e("../../components/color"),L=e("../../components/drawing"),E=e("../../registry"),I=e("../../plots/cartesian/axes").tickText,P=e("./uniform_text"),z=P.recordMinTextSize,D=P.clearMinTextSize,O=e("./style"),R=e("./helpers"),M=e("./constants"),j=e("./attributes"),B=j.text,F=j.textposition,N=e("../../components/fx/helpers").appendArrayPointValue,V=M.TEXTPAD;t.exports={plot:function(e,t,a,i,c,p){var u=t.xaxis,g=t.yaxis,m=e._fullLayout;c||(c={mode:m.barmode,norm:m.barmode,gap:m.bargap,groupgap:m.bargroupgap},D("bar",m));var h=A.makeTraceGroups(i,a,"trace bars").each(function(a){var i=T.select(this),h=a[0].trace,y="waterfall"===h.type,f="funnel"===h.type,b="bar"===h.type,S=0;y&&h.connector.visible&&"between"===h.connector.mode&&(S=h.connector.line.width/2);var E="h"===h.orientation,I=s(c),P=A.ensureSingle(i,"g","points"),z=o(h),D=P.selectAll("g.point").data(A.identity,z);D.enter().append("g").classed("point",!0),D.exit().remove(),D.each(function(o,s){function i(e){var t=T.round(F/2%1,2);return 0===c.gap&&0===c.groupgap?T.round(_(e)-t,2):e}function y(e,t,a){return a&&e===t?e:2<=w(e-t)?i(e):e>t?x(e):k(e)}var P=T.select(this),z=n(o,u,g,E),D=z[0][0],O=z[0][1],M=z[1][0],j=z[1][1],B=0==(E?O-D:j-M);B&&(b||f)&&R.getLineWidth(h,o)&&(B=!1),B||(B=!v(D)||!v(O)||!v(M)||!v(j)),o.isBlank=B,B&&(E?O=D:j=M),S&&!B&&(E?(D-=r(D,O)*S,O+=r(D,O)*S):(M-=r(M,j)*S,j+=r(M,j)*S));var F,N;if("waterfall"!==h.type)F=R.getLineWidth(h,o),N=o.mc||h.marker.color;else if(!B){var V=h[o.dir].marker;F=V.line.width,N=V.color}if(!e._context.staticPlot){var U=C.opacity(N),H=1>U||.01<F?i:y;D=H(D,O,E),O=H(O,D,E),M=H(M,j,!E),j=H(j,M,!E)}var q=l(A.ensureSingle(P,"path"),m,c,p);if(q.style("vector-effect","non-scaling-stroke").attr("d",isNaN((O-D)*(j-M))?"M0,0Z":"M"+D+","+M+"V"+j+"H"+O+"V"+M+"Z").call(L.setClipUrl,t.layerClipId,e),!m.uniformtext.mode&&I){var G=L.makePointStyleFns(h);L.singlePointStyle(o,q,h,G,e)}d(e,t,P,a,s,D,O,M,j,c,p),t.layerClipId&&L.hideOutsideRangePoint(o,P.select("text"),u,g,h.xcalendar,h.ycalendar)});var O=!1===h.cliponaxis;L.setClipUrl(i,O?null:t.layerClipId,e)});E.getComponentMethod("errorbars","plot")(e,h,t,c)},toMoveInsideBar:u}},{"../../components/color":524,"../../components/drawing":546,"../../components/fx/helpers":560,"../../lib":657,"../../lib/svg_text_utils":681,"../../plots/cartesian/axes":705,"../../registry":788,"./attributes":798,"./constants":800,"./helpers":804,"./style":812,"./uniform_text":814,d3:108,"fast-isnumeric":201}],810:[function(e,t){'use strict';function a(e,t,a,o,r){var i=t.c2p(o?e.s0:e.p0,!0),n=t.c2p(o?e.s1:e.p1,!0),l=a.c2p(o?e.p0:e.s0,!0),s=a.c2p(o?e.p1:e.s1,!0);return r?[(i+n)/2,(l+s)/2]:o?[n,(l+s)/2]:[(i+n)/2,s]}t.exports=function(e,t){var o=e.cd,r=e.xaxis,n=e.yaxis,l=o[0].trace,s="funnel"===l.type,d="h"===l.orientation,c=[],p;if(!1===t)for(p=0;p<o.length;p++)o[p].selected=0;else for(p=0;p<o.length;p++){var u=o[p],g="ct"in u?u.ct:a(u,r,n,d,s);t.contains(g,!1,p,e)?(c.push({pointNumber:p,x:r.c2d(u.x),y:n.c2d(u.y)}),u.selected=1):u.selected=0}return c}},{}],811:[function(e,t){'use strict';var o=Math.min;function a(e,t){this.traces=e,this.sepNegVal=t.sepNegVal,this.overlapNoMerge=t.overlapNoMerge;for(var a=1/0,n=[],l=0,s;l<e.length;l++){s=e[l];for(var d=0,c;d<s.length;d++)c=s[d],c.p!==i&&n.push(c.p);s[0]&&s[0].width1&&(a=o(s[0].width1,a))}this.positions=n;var p=r(n);this.distinctPositions=p.vals,this.minDiff=1===p.vals.length&&a!==1/0?a:o(p.minDiff,a),this.binWidth=this.minDiff,this.bins={}}t.exports=a;var r=e("../../lib").distinctVals,i=e("../../constants/numerical").BADNUM;a.prototype.put=function(e,t){var a=this.getLabel(e,t),o=this.bins[a]||0;return this.bins[a]=o+t,o},a.prototype.get=function(e,t){var a=this.getLabel(e,t);return this.bins[a]||0},a.prototype.getLabel=function(e,t){var a=0>t&&this.sepNegVal?"v":"^",o=this.overlapNoMerge?e:Math.round(e/this.binWidth);return a+o}},{"../../constants/numerical":633,"../../lib":657}],812:[function(e,t){'use strict';function a(e,t,a){m.pointStyle(e.selectAll("path"),t,a),o(e,t,a)}function o(e,t,a){e.selectAll("text").each(function(e){var o=g.select(this),r=h.ensureUniformFontSize(a,n(o,e,t,a));m.font(o,r)})}function r(e,t,a){m.selectedPointStyle(e.selectAll("path"),t),i(e.selectAll("text"),t,a)}function i(e,t,a){e.each(function(e){var o=g.select(this),r;if(e.selected){r=h.ensureUniformFontSize(a,n(o,e,t,a));var i=t.selected.textfont&&t.selected.textfont.color;i&&(r.color=i),m.font(o,r)}else m.selectedTextStyle(o,t)})}function n(e,t,a,o){var r=o._fullLayout.font,i=a.textfont;if(e.classed("bartext-inside")){var n=u(t,a);i=s(a,t.i,r,n)}else e.classed("bartext-outside")&&(i=c(a,t.i,r));return i}function l(e,t,a){return p(_,e.textfont,t,a)}function s(e,t,a,o){var r=l(e,t,a),i=void 0===e._input.textfont||void 0===e._input.textfont.color||Array.isArray(e.textfont.color)&&void 0===e.textfont.color[t];return i&&(r={color:d.contrast(o),family:r.family,size:r.size}),p(b,e.insidetextfont,t,r)}function c(e,t,a){var o=l(e,t,a);return p(v,e.outsidetextfont,t,o)}function p(e,t,a,o){t=t||{};var r=w.getValue(t.family,a),i=w.getValue(t.size,a),n=w.getValue(t.color,a);return{family:w.coerceString(e.family,r,o.family),size:w.coerceNumber(e.size,i,o.size),color:w.coerceColor(e.color,n,o.color)}}function u(e,t){return"waterfall"===t.type?t[e.dir].marker.color:e.mc||t.marker.color}var g=e("d3"),d=e("../../components/color"),m=e("../../components/drawing"),h=e("../../lib"),y=e("../../registry"),f=e("./uniform_text").resizeText,x=e("./attributes"),_=x.textfont,b=x.insidetextfont,v=x.outsidetextfont,w=e("./helpers");t.exports={style:function(e){var t=g.select(e).selectAll("g.barlayer").selectAll("g.trace");f(e,t,"bar");var o=t.size(),r=e._fullLayout;t.style("opacity",function(e){return e[0].trace.opacity}).each(function(e){("stack"===r.barmode&&1<o||0===r.bargap&&0===r.bargroupgap&&!e[0].trace.marker.line.width)&&g.select(this).attr("shape-rendering","crispEdges")}),t.selectAll("g.points").each(function(t){var o=g.select(this),r=t[0].trace;a(o,r,e)}),y.getComponentMethod("errorbars","style")(t)},styleTextPoints:o,styleOnSelect:function(e,t,o){var i=t[0].trace;i.selectedpoints?r(o,i,e):(a(o,i,e),y.getComponentMethod("errorbars","style")(o))},getInsideTextFont:s,getOutsideTextFont:c,getBarColor:u,resizeText:f}},{"../../components/color":524,"../../components/drawing":546,"../../lib":657,"../../registry":788,"./attributes":798,"./helpers":804,"./uniform_text":814,d3:108}],813:[function(e,t){'use strict';var a=e("../../components/color"),o=e("../../components/colorscale/helpers").hasColorscale,r=e("../../components/colorscale/defaults");t.exports=function(e,t,i,n,l){i("marker.color",n),o(e,"marker")&&r(e,t,l,i,{prefix:"marker.",cLetter:"c"}),i("marker.line.color",a.defaultLine),o(e,"marker.line")&&r(e,t,l,i,{prefix:"marker.line.",cLetter:"c"}),i("marker.line.width"),i("marker.opacity"),i("selected.marker.color"),i("unselected.marker.color")}},{"../../components/color":524,"../../components/colorscale/defaults":534,"../../components/colorscale/helpers":535}],814:[function(e,t){'use strict';function a(e){return"_"+e+"Text_minsize"}var o=e("d3"),r=e("../../lib");t.exports={recordMinTextSize:function(e,t,o){if(o.uniformtext.mode){var r=a(e),i=o.uniformtext.minsize,n=t.scale*t.fontSize;t.hide=n<i,o[r]=o[r]||1/0,t.hide||(o[r]=Math.min(o[r],Math.max(n,i)))}},clearMinTextSize:function(e,t){var o=a(e);t[o]=void 0},resizeText:function(e,t,a){var i=e._fullLayout,n=i["_"+a+"Text_minsize"];if(n){var l="hide"===i.uniformtext.mode,s;s="funnelarea"===a||"pie"===a||"sunburst"===a?"g.slice":"treemap"===a?"g.slice, g.pathbar":"g.points > g.point";t.selectAll(s).each(function(e){var t=e.transform;if(t){t.scale=l&&t.hide?0:n/t.fontSize;var a=o.select(this).select("text");a.attr("transform",r.getTextTransform(t))}})}}}},{"../../lib":657,d3:108}],815:[function(e,t){'use strict';var a=e("../../plots/template_attributes").hovertemplateAttrs,o=e("../../lib/extend").extendFlat,r=e("../scatterpolar/attributes"),i=e("../bar/attributes");t.exports={r:r.r,theta:r.theta,r0:r.r0,dr:r.dr,theta0:r.theta0,dtheta:r.dtheta,thetaunit:r.thetaunit,base:o({},i.base,{}),offset:o({},i.offset,{}),width:o({},i.width,{}),text:o({},i.text,{}),hovertext:o({},i.hovertext,{}),marker:i.marker,hoverinfo:r.hoverinfo,hovertemplate:a(),selected:i.selected,unselected:i.unselected}},{"../../lib/extend":648,"../../plots/template_attributes":783,"../bar/attributes":798,"../scatterpolar/attributes":1135}],816:[function(e,t){'use strict';var a=e("../../components/colorscale/helpers").hasColorscale,o=e("../../components/colorscale/calc"),r=e("../bar/arrays_to_calcdata"),n=e("../bar/cross_trace_calc").setGroupPositions,l=e("../scatter/calc_selection"),s=e("../../registry").traceIs,d=e("../../lib").extendFlat;t.exports={calc:function(e,t){function n(e){var a=t[e];void 0!==a&&(t["_"+e]=Array.isArray(a)?p.makeCalcdata(t,e):p.d2c(a,t.thetaunit))}for(var s=e._fullLayout,d=t.subplot,c=s[d].radialaxis,p=s[d].angularaxis,u=c.makeCalcdata(t,"r"),g=p.makeCalcdata(t,"theta"),m=t._length,h=Array(m),y=0;y<m;y++)h[y]={p:g[y],s:u[y]};return"linear"===p.type&&(n("width"),n("offset")),a(t,"marker")&&o(e,t,{vals:t.marker.color,containerStr:"marker",cLetter:"c"}),a(t,"marker.line")&&o(e,t,{vals:t.marker.line.color,containerStr:"marker.line",cLetter:"c"}),r(h,t),l(h,t),h},crossTraceCalc:function(e,t,a){for(var o=e.calcdata,r=[],l=0;l<o.length;l++){var c=o[l],p=c[0].trace;!0===p.visible&&s(p,"bar")&&p.subplot===a&&r.push(c)}var u=d({},t.radialaxis,{_id:"x"}),g=t.angularaxis;n(e,g,u,r,{mode:t.barmode,norm:t.barnorm,gap:t.bargap,groupgap:t.bargroupgap})}}},{"../../components/colorscale/calc":532,"../../components/colorscale/helpers":535,"../../lib":657,"../../registry":788,"../bar/arrays_to_calcdata":797,"../bar/cross_trace_calc":801,"../scatter/calc_selection":1064}],817:[function(e,t){'use strict';var a=e("../../lib"),o=e("../scatterpolar/defaults").handleRThetaDefaults,r=e("../bar/style_defaults"),i=e("./attributes");t.exports=function(e,t,n,l){function s(o,r){return a.coerce(e,t,i,o,r)}var d=o(e,t,l,s);return d?void(s("thetaunit"),s("base"),s("offset"),s("width"),s("text"),s("hovertext"),s("hovertemplate"),r(e,t,s,n,l),a.coerceSelectionMarkerOpacity(t,s)):void(t.visible=!1)}},{"../../lib":657,"../bar/style_defaults":813,"../scatterpolar/defaults":1137,"./attributes":815}],818:[function(e,t){'use strict';var a=Math.atan2,o=Math.sqrt,r=Math.PI,i=Math.min,n=Math.abs,l=e("../../components/fx"),s=e("../../lib"),d=e("../bar/hover").getTraceColor,c=s.fillText,p=e("../scatterpolar/hover").makeHoverPointText,u=e("../../plots/polar/helpers").isPtInsidePolygon;t.exports=function(e,t,g){var m=e.cd,h=m[0].trace,y=e.subplot,f=y.radialAxis,x=y.angularAxis,_=y.vangles,b=_?u:s.isPtInsideSector,v=e.maxHoverDistance,w=x._period||2*r,k=n(f.g2p(o(t*t+g*g))),T=a(g,t);f.range[0]>f.range[1]&&(T+=r);var A=function(e){return b(k,T,[e.rp0,e.rp1],[e.thetag0,e.thetag1],_)?v+i(1,n(e.thetag1-e.thetag0)/w)-1+(e.rp1-k)/(e.rp1-e.rp0)-1:1/0};if(l.getClosest(m,A,e),!1!==e.index){var S=e.index,C=m[S];e.x0=e.x1=C.ct[0],e.y0=e.y1=C.ct[1];var L=s.extendFlat({},C,{r:C.s,theta:C.p});return c(C,h,e),p(L,h,y,e),e.hovertemplate=h.hovertemplate,e.color=d(h,C),e.xLabelVal=e.yLabelVal=void 0,0>C.s&&(e.idealAlign="left"),[e]}}},{"../../components/fx":564,"../../lib":657,"../../plots/polar/helpers":770,"../bar/hover":805,"../scatterpolar/hover":1139}],819:[function(e,t){'use strict';t.exports={moduleType:"trace",name:"barpolar",basePlotModule:e("../../plots/polar"),categories:["polar","bar","showLegend"],attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults"),supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc").calc,crossTraceCalc:e("./calc").crossTraceCalc,plot:e("./plot"),colorbar:e("../scatter/marker_colorbar"),formatLabels:e("../scatterpolar/format_labels"),style:e("../bar/style").style,styleOnSelect:e("../bar/style").styleOnSelect,hoverPoints:e("./hover"),selectPoints:e("../bar/select"),meta:{}}},{"../../plots/polar":771,"../bar/select":810,"../bar/style":812,"../scatter/marker_colorbar":1080,"../scatterpolar/format_labels":1138,"./attributes":815,"./calc":816,"./defaults":817,"./hover":818,"./layout_attributes":820,"./layout_defaults":821,"./plot":822}],820:[function(e,t){'use strict';t.exports={barmode:{valType:"enumerated",values:["stack","overlay"],dflt:"stack",editType:"calc"},bargap:{valType:"number",dflt:.1,min:0,max:1,editType:"calc"}}},{}],821:[function(e,t){'use strict';var a=e("../../lib"),o=e("./layout_attributes");t.exports=function(e,t,r){function n(r,i){return a.coerce(e[d]||{},t[d],o,r,i)}for(var l={},s=0,d,c;s<r.length;s++)c=r[s],"barpolar"===c.type&&!0===c.visible&&(d=c.subplot,!l[d]&&(n("barmode"),n("bargap"),l[d]=1))}},{"../../lib":657,"./layout_attributes":820}],822:[function(e,t){'use strict';function a(e){var t=e.cxx,a=e.cyy;return e.vangles?function(o,r,n,s){var d,c;0<i.angleDelta(n,s)?(d=n,c=s):(d=s,c=n);var p=l.findEnclosingVertexAngles(d,e.vangles)[0],u=l.findEnclosingVertexAngles(c,e.vangles)[1],g=[p,(d+c)/2,u];return l.pathPolygonAnnulus(o,r,d,c,g,t,a)}:function(e,o,r,n){return i.pathAnnulus(e,o,r,n,t,a)}}var o=e("d3"),r=e("fast-isnumeric"),i=e("../../lib"),n=e("../../components/drawing"),l=e("../../plots/polar/helpers");t.exports=function(e,t,l){var s=t.xaxis,d=t.yaxis,c=t.radialAxis,p=t.angularAxis,u=a(t),g=t.layers.frontplot.select("g.barlayer");i.makeTraceGroups(g,l,"trace bars").each(function(){var a=o.select(this),l=i.ensureSingle(a,"g","points"),g=l.selectAll("g.point").data(i.identity);g.enter().append("g").style("vector-effect","non-scaling-stroke").style("stroke-miterlimit",2).classed("point",!0),g.exit().remove(),g.each(function(e){var t=o.select(this),a=e.rp0=c.c2p(e.s0),n=e.rp1=c.c2p(e.s1),l=e.thetag0=p.c2g(e.p0),g=e.thetag1=p.c2g(e.p1),m;if(!r(a)||!r(n)||!r(l)||!r(g)||a===n||l===g)m="M0,0Z";else{var h=c.c2g(e.s1),y=(l+g)/2;e.ct=[s.c2p(h*Math.cos(y)),d.c2p(h*Math.sin(y))],m=u(a,n,l,g)}i.ensureSingle(t,"path").attr("d",m)}),n.setClipUrl(a,t._hasClipOnAxisFalse?t.clipIds.forTraces:null,e)})}},{"../../components/drawing":546,"../../lib":657,"../../plots/polar/helpers":770,d3:108,"fast-isnumeric":201}],823:[function(e,t){'use strict';var a=e("../scatter/attributes"),o=e("../bar/attributes"),r=e("../../components/color/attributes"),i=e("../../plots/template_attributes").hovertemplateAttrs,n=e("../../lib/extend").extendFlat,l=a.marker,s=l.line;t.exports={y:{valType:"data_array",editType:"calc+clearAxisTypes"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",editType:"calc+clearAxisTypes"},y0:{valType:"any",editType:"calc+clearAxisTypes"},dx:{valType:"number",editType:"calc"},dy:{valType:"number",editType:"calc"},name:{valType:"string",editType:"calc+clearAxisTypes"},q1:{valType:"data_array",editType:"calc+clearAxisTypes"},median:{valType:"data_array",editType:"calc+clearAxisTypes"},q3:{valType:"data_array",editType:"calc+clearAxisTypes"},lowerfence:{valType:"data_array",editType:"calc"},upperfence:{valType:"data_array",editType:"calc"},notched:{valType:"boolean",editType:"calc"},notchwidth:{valType:"number",min:0,max:.5,dflt:.25,editType:"calc"},notchspan:{valType:"data_array",editType:"calc"},boxpoints:{valType:"enumerated",values:["all","outliers","suspectedoutliers",!1],editType:"calc"},jitter:{valType:"number",min:0,max:1,editType:"calc"},pointpos:{valType:"number",min:-2,max:2,editType:"calc"},boxmean:{valType:"enumerated",values:[!0,"sd",!1],editType:"calc"},mean:{valType:"data_array",editType:"calc"},sd:{valType:"data_array",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},quartilemethod:{valType:"enumerated",values:["linear","exclusive","inclusive"],dflt:"linear",editType:"calc"},width:{valType:"number",min:0,dflt:0,editType:"calc"},marker:{outliercolor:{valType:"color",dflt:"rgba(0, 0, 0, 0)",editType:"style"},symbol:n({},l.symbol,{arrayOk:!1,editType:"plot"}),opacity:n({},l.opacity,{arrayOk:!1,dflt:1,editType:"style"}),size:n({},l.size,{arrayOk:!1,editType:"calc"}),color:n({},l.color,{arrayOk:!1,editType:"style"}),line:{color:n({},s.color,{arrayOk:!1,dflt:r.defaultLine,editType:"style"}),width:n({},s.width,{arrayOk:!1,dflt:0,editType:"style"}),outliercolor:{valType:"color",editType:"style"},outlierwidth:{valType:"number",min:0,dflt:1,editType:"style"},editType:"style"},editType:"plot"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:a.fillcolor,whiskerwidth:{valType:"number",min:0,max:1,dflt:.5,editType:"calc"},offsetgroup:o.offsetgroup,alignmentgroup:o.alignmentgroup,selected:{marker:a.selected.marker,editType:"style"},unselected:{marker:a.unselected.marker,editType:"style"},text:n({},a.text,{}),hovertext:n({},a.hovertext,{}),hovertemplate:i({}),hoveron:{valType:"flaglist",flags:["boxes","points"],dflt:"boxes+points",editType:"style"}}},{"../../components/color/attributes":523,"../../lib/extend":648,"../../plots/template_attributes":783,"../bar/attributes":798,"../scatter/attributes":1062}],824:[function(e,t){'use strict';var y=Math.min,f=Math.max;function a(e,t,a,o){var r=(t in e),n=(t+"0"in e),l=("d"+t in e);if(r||n&&l)return a.makeCalcdata(e,t);var s=n?e[t+"0"]:"name"in e&&("category"===a.type||x(e.name)&&-1!==["linear","log"].indexOf(a.type)||w.isDateTime(e.name)&&"date"===a.type)?e.name:o;for(var d="multicategory"===a.type?a.r2c_just_indices(s):a.d2c(s,0,e[t+"calendar"]),c=e._length,p=Array(c),u=0;u<c;u++)p[u]=d;return p}function o(e,t){for(var a=e.length,o=Array(a+1),r=0;r<a;r++)o[r]=e[r]-t;return o[a]=e[a-1]+t,o}function r(e){for(var t=Array(e),a=0;a<e;a++)t[a]=[];return t}function l(e,t,a){for(var o in i)w.isArrayOrTypedArray(t[o])&&(Array.isArray(a)?w.isArrayOrTypedArray(t[o][a[0]])&&(e[i[o]]=t[o][a[0]][a[1]]):e[i[o]]=t[o][a])}function s(e,t){if(w.isArrayOrTypedArray(t.selectedpoints))for(var a=0;a<e.length;a++){for(var o=e[a].pts||[],r={},n=0;n<o.length;n++)r[o[n].i]=n;w.tagSelected(o,t,r)}}function d(e,t){return e.v-t.v}function c(e){return e.v}function p(e,t,a){return 0===a?e.q1:y(e.q1,t[y(w.findBin(2.5*e.q1-1.5*e.q3,t,!0)+1,a-1)])}function u(e,t,a){return 0===a?e.q3:f(e.q3,t[f(w.findBin(2.5*e.q3-1.5*e.q1,t),0)])}function g(e){return 4*e.q1-3*e.q3}function m(e){return 4*e.q3-3*e.q1}function h(e,t){return 0===t?0:1.57*(e.q3-e.q1)/Math.sqrt(t)}var x=e("fast-isnumeric"),b=e("../../plots/cartesian/axes"),w=e("../../lib"),k=e("../../constants/numerical").BADNUM,T=w._;t.exports=function(e,t){var _=e._fullLayout,A=b.getFromId(e,t.xaxis||"x"),S=b.getFromId(e,t.yaxis||"y"),C=[],L="violin"===t.type?"_numViolins":"_numBoxes",E,I,P,z,D,O;"h"===t.orientation?(P=A,z="x",D=S,O="y"):(P=S,z="y",D=A,O="x");var R=a(t,O,D,_[L]),M=w.distinctVals(R),B=M.vals,F=M.minDiff/2,V="all"===(t.boxpoints||t.points)?w.identity:function(e){return e.v<U.lf||e.v>U.uf},U,H,q,G,Y,W;if(t._hasPreCompStats){var X=t[z],Z=function(e){return P.d2c((t[e]||[])[E])},K=1/0,$=-Infinity;for(E=0;E<t._length;E++){var J=R[E];if(x(J)){if(U={},U.pos=U[O]=J,U.q1=Z("q1"),U.med=Z("median"),U.q3=Z("q3"),H=[],X&&w.isArrayOrTypedArray(X[E]))for(I=0;I<X[E].length;I++)W=P.d2c(X[E][I]),W!==k&&(Y={v:W,i:[E,I]},l(Y,t,[E,I]),H.push(Y));if(U.pts=H.sort(d),q=U[z]=H.map(c),G=q.length,U.med!==k&&U.q1!==k&&U.q3!==k&&U.med>=U.q1&&U.q3>=U.med){var Q=Z("lowerfence");U.lf=Q!==k&&Q<=U.q1?Q:p(U,q,G);var ee=Z("upperfence");U.uf=ee!==k&&ee>=U.q3?ee:u(U,q,G);var te=Z("mean");U.mean=te===k?G?w.mean(q,G):(U.q1+U.q3)/2:te;var ae=Z("sd");U.sd=te!==k&&0<=ae?ae:G?w.stdev(q,G,U.mean):U.q3-U.q1,U.lo=g(U),U.uo=m(U);var oe=Z("notchspan");oe=oe!==k&&0<oe?oe:h(U,G),U.ln=U.med-oe,U.un=U.med+oe;var re=U.lf,ie=U.uf;t.boxpoints&&q.length&&(re=y(re,q[0]),ie=f(ie,q[G-1])),t.notched&&(re=y(re,U.ln),ie=f(ie,U.un)),U.min=re,U.max=ie}else{w.warn(["Invalid input - make sure that q1 <= median <= q3","q1 = "+U.q1,"median = "+U.med,"q3 = "+U.q3].join("\n"));var ne;ne=U.med===k?U.q1===k?U.q3===k?0:U.q3:U.q3===k?U.q1:(U.q1+U.q3)/2:U.med,U.med=ne,U.q1=U.q3=ne,U.lf=U.uf=ne,U.mean=U.sd=ne,U.ln=U.un=ne,U.min=U.max=ne}K=y(K,U.min),$=f($,U.max),U.pts2=H.filter(V),C.push(U)}}t._extremes[P._id]=b.findExtremes(P,[K,$],{padded:!0})}else{var le=P.makeCalcdata(t,z),se=o(B,F),de=B.length,ce=r(de);for(E=0;E<t._length;E++)if(W=le[E],x(W)){var pe=w.findBin(R[E],se);0<=pe&&pe<de&&(Y={v:W,i:E},l(Y,t,E),ce[pe].push(Y))}var n=1/0,ue=-Infinity,ge=t.quartilemethod,me="exclusive"===ge,he="inclusive"===ge;for(E=0;E<de;E++)if(0<ce[E].length){if(U={},U.pos=U[O]=B[E],H=U.pts=ce[E].sort(d),q=U[z]=H.map(c),G=q.length,U.min=q[0],U.max=q[G-1],U.mean=w.mean(q,G),U.sd=w.stdev(q,G,U.mean),U.med=w.interp(q,.5),G%2&&(me||he)){var ye,fe;me?(ye=q.slice(0,G/2),fe=q.slice(G/2+1)):he&&(ye=q.slice(0,G/2+1),fe=q.slice(G/2)),U.q1=w.interp(ye,.5),U.q3=w.interp(fe,.5)}else U.q1=w.interp(q,.25),U.q3=w.interp(q,.75);U.lf=p(U,q,G),U.uf=u(U,q,G),U.lo=g(U),U.uo=m(U);var xe=h(U,G);U.ln=U.med-xe,U.un=U.med+xe,n=y(n,U.ln),ue=f(ue,U.un),U.pts2=H.filter(V),C.push(U)}t._extremes[P._id]=b.findExtremes(P,t.notched?le.concat([n,ue]):le,{padded:!0})}return s(C,t),0<C.length?(C[0].t={num:_[L],dPos:F,posLetter:O,valLetter:z,labels:{med:T(e,"median:"),min:T(e,"min:"),q1:T(e,"q1:"),q3:T(e,"q3:"),max:T(e,"max:"),mean:"sd"===t.boxmean?T(e,"mean \xB1 \u03C3:"):T(e,"mean:"),lf:T(e,"lower fence:"),uf:T(e,"upper fence:")}},_[L]++,C):[{t:{empty:!0}}]};var i={text:"tx",hovertext:"htx"}},{"../../constants/numerical":633,"../../lib":657,"../../plots/cartesian/axes":705,"fast-isnumeric":201}],825:[function(e,t){'use strict';function a(e,a,n,l){var s=a.calcdata,d=a._fullLayout,c=l._id,p=c.charAt(0),u=[],g=0,m,h,y;for(m=0;m<n.length;m++)for(y=s[n[m]],h=0;h<y.length;h++)u.push(l.c2l(y[h].pos,!0)),g+=(y[h].pts2||[]).length;if(u.length){var f=r.distinctVals(u),x=f.minDiff/2;o.minDtick(l,f.minDiff,f.vals[0],!0);var _="violin"===e?"_numViolins":"_numBoxes",b=d[_],v="group"===d[e+"mode"]&&1<b,w=1-d[e+"gap"],k=1-d[e+"groupgap"];for(m=0;m<n.length;m++){y=s[n[m]];var T=y[0].trace,A=y[0].t,t=T.width,S=T.side,C,L,E,I;if(t)C=L=I=t/2,E=0;else if(C=x,v){var P=i(d,l._id)+T.orientation,z=d._alignmentOpts[P]||{},D=z[T.alignmentgroup]||{},O=Object.keys(D.offsetGroups||{}).length,R=O||b,M=O?T._offsetIndex:A.num;L=C*w*k/R,E=2*C*(-.5+(M+.5)/R)*w,I=C*w/R}else L=C*w*k,E=0,I=C;A.dPos=C,A.bPos=E,A.bdPos=L,A.wHover=I;var B=E+L,F=!!t,N=(T.boxpoints||T.points)&&0<g,V,U,H,q,G,Y,W,X;if("positive"===S?(V=C*(t?1:.5),H=B,U=H=E):"negative"===S?(V=H=E,U=C*(t?1:.5),q=B):(V=U=C,H=q=B),N){var Z=T.pointpos,K=T.jitter,$=T.marker.size/2,J=0;0<=Z+K&&(J=B*(Z+K),J>V?(F=!0,W=$,G=J):J>H&&(W=$,G=V)),J<=V&&(G=V);var Q=0;0>=Z-K&&(Q=-B*(Z-K),Q>U?(F=!0,X=$,Y=Q):Q>q&&(X=$,Y=U)),Q<=U&&(Y=U)}else G=V,Y=U;var ee=Array(y.length);for(h=0;h<y.length;h++)ee[h]=y[h].pos;T._extremes[c]=o.findExtremes(l,ee,{padded:F,vpadminus:Y,vpadplus:G,vpadLinearized:!0,ppadminus:{x:X,y:W}[p],ppadplus:{x:W,y:X}[p]})}}}var o=e("../../plots/cartesian/axes"),r=e("../../lib"),i=e("../../plots/cartesian/axis_ids").getAxisGroup,n=["v","h"];t.exports={crossTraceCalc:function(e,o){for(var r=e.calcdata,l=o.xaxis,s=o.yaxis,d=0;d<n.length;d++){for(var c=n[d],p="h"===c?s:l,u=[],g=0;g<r.length;g++){var m=r[g],h=m[0].t,t=m[0].trace;!0!==t.visible||"box"!==t.type&&"candlestick"!==t.type||h.empty||(t.orientation||"v")!==c||t.xaxis!==l._id||t.yaxis!==s._id||u.push(g)}a("box",e,u,p)}},setPositionOffset:a}},{"../../lib":657,"../../plots/cartesian/axes":705,"../../plots/cartesian/axis_ids":708}],826:[function(e,t){'use strict';var r=Math.min;function a(e,t,a,o){function s(e){var t=0;return e&&e.length&&(t+=1,n.isArrayOrTypedArray(e[0])&&e[0].length&&(t+=1)),t}function d(t){return n.validate(e[t],p[t])}var u=a("y"),g=a("x"),m;if("box"===t.type){var h=a("q1"),y=a("median"),f=a("q3");t._hasPreCompStats=h&&h.length&&y&&y.length&&f&&f.length,m=r(n.minRowLength(h),n.minRowLength(y),n.minRowLength(f))}var x=s(u),_=s(g),b=x&&n.minRowLength(u),v=_&&n.minRowLength(g),w,k;if(t._hasPreCompStats)switch(_+""+(x+"")){case"00":var T=d("x0")||d("dx"),A=d("y0")||d("dy");w=A&&!T?"h":"v",k=m;break;case"10":w="v",k=r(m,v);break;case"20":w="h",k=r(m,g.length);break;case"01":w="h",k=r(m,b);break;case"02":w="v",k=r(m,u.length);break;case"12":w="v",k=r(m,v,u.length);break;case"21":w="h",k=r(m,g.length,b);break;case"11":k=0;break;case"22":var S=!1,C;for(C=0;C<g.length;C++)if("category"===c(g[C])){S=!0;break}if(S)w="v",k=r(m,v,u.length);else{for(C=0;C<u.length;C++)if("category"===c(u[C])){S=!0;break}S?(w="h",k=r(m,g.length,b)):(w="v",k=r(m,v,u.length))}}else 0<x?(w="v",k=0<_?r(v,b):r(b)):0<_?(w="h",k=r(v)):k=0;if(!k)return void(t.visible=!1);t._length=k;var L=a("orientation",w);t._hasPreCompStats?"v"===L&&0===_?(a("x0",0),a("dx",1)):"h"===L&&0===x&&(a("y0",0),a("dy",1)):"v"===L&&0===_?a("x0"):"h"===L&&0===x&&a("y0");var E=l.getComponentMethod("calendars","handleTraceDefaults");E(e,t,["x","y"],o)}function o(e,t,a,o){var r=o.prefix,i=n.coerce2(e,t,p,"marker.outliercolor"),l=a("marker.line.outliercolor"),s="outliers";t._hasPreCompStats?s="all":(i||l)&&(s="suspectedoutliers");var d=a(r+"points",s);d?(a("jitter","all"===d?.3:0),a("pointpos","all"===d?-1.5:0),a("marker.symbol"),a("marker.opacity"),a("marker.size"),a("marker.color",t.line.color),a("marker.line.color"),a("marker.line.width"),"suspectedoutliers"===d&&(a("marker.line.outliercolor",t.marker.color),a("marker.line.outlierwidth")),a("selected.marker.color"),a("unselected.marker.color"),a("selected.marker.size"),a("unselected.marker.size"),a("text"),a("hovertext")):delete t.marker;var c=a("hoveron");("all"===c||-1!==c.indexOf("points"))&&a("hovertemplate"),n.coerceSelectionMarkerOpacity(t,a)}var n=e("../../lib"),l=e("../../registry"),s=e("../../components/color"),d=e("../bar/defaults").handleGroupingDefaults,c=e("../../plots/cartesian/axis_autotype"),p=e("./attributes");t.exports={supplyDefaults:function(e,t,r,i){function l(a,o){return n.coerce(e,t,p,a,o)}if(a(e,t,l,i),!1!==t.visible){var d=t._hasPreCompStats;d&&(l("lowerfence"),l("upperfence")),l("line.color",(e.marker||{}).color||r),l("line.width"),l("fillcolor",s.addOpacity(t.line.color,.5));var c=!1;if(d){var u=l("mean"),g=l("sd");u&&u.length&&(c=!0,g&&g.length&&(c="sd"))}l("boxmean",c),l("whiskerwidth"),l("width"),l("quartilemethod");var m=!1;if(d){var h=l("notchspan");h&&h.length&&(m=!0)}else n.validate(e.notchwidth,p.notchwidth)&&(m=!0);var y=l("notched",m);y&&l("notchwidth"),o(e,t,l,{prefix:"box"})}},crossTraceDefaults:function(e,t){function a(e){return n.coerce(l._input,l,p,e)}for(var o=0,r,l;o<e.length;o++){l=e[o];var s=l.type;("box"===s||"violin"===s)&&(r=l._input,"group"===t[s+"mode"]&&d(r,l,t,a))}},handleSampleDefaults:a,handlePointsDefaults:o}},{"../../components/color":524,"../../lib":657,"../../plots/cartesian/axis_autotype":706,"../../registry":788,"../bar/defaults":802,"./attributes":823}],827:[function(e,t){'use strict';t.exports=function(e,t){return t.hoverOnBox&&(e.hoverOnBox=t.hoverOnBox),"xVal"in t&&(e.x=t.xVal),"yVal"in t&&(e.y=t.yVal),t.xa&&(e.xaxis=t.xa),t.ya&&(e.yaxis=t.ya),e}},{}],828:[function(e,t){'use strict';var r=Math.min,n=Math.abs,l=Math.max;function a(e,a,o,l){function u(e){return(L(e)+E(e))/2}var g=e.cd,m=e.xa,h=e.ya,y=g[0].trace,f=g[0].t,t="violin"===y.type,x=[],_=f.bdPos,b=f.wHover,v=function(e){return T.c2l(e.pos)+f.bPos-T.c2l(C)},w,k,T,A,S,C,L,E,I,P,z,D,O;t&&"both"!==y.side?("positive"===y.side&&(I=function(e){var t=v(e);return c.inbox(t,t+b,P)},D=_,O=0),"negative"===y.side&&(I=function(e){var t=v(e);return c.inbox(t-b,t,P)},D=0,O=_)):(I=function(e){var t=v(e);return c.inbox(t-b,t+b,P)},D=O=_);var R;R=t?function(e){return c.inbox(e.span[0]-S,e.span[1]-S,P)}:function(e){return c.inbox(e.min-S,e.max-S,P)},"h"===y.orientation?(S=a,C=o,L=R,E=I,w="y",T=h,k="x",A=m):(S=o,C=a,L=I,E=R,w="x",T=m,k="y",A=h);var M=r(1,_/n(T.r2c(T.range[1])-T.r2c(T.range[0])));P=e.maxHoverDistance-M,z=e.maxSpikeDistance-M;var j=c.getDistanceFunction(l,L,E,u);if(c.getClosest(g,j,e),!1===e.index)return[];var B=g[e.index],F=y.line.color,N=(y.marker||{}).color;e.color=p.opacity(F)&&y.line.width?F:p.opacity(N)&&y.boxpoints?N:y.fillcolor,e[w+"0"]=T.c2p(B.pos+f.bPos-O,!0),e[w+"1"]=T.c2p(B.pos+f.bPos+D,!0),e[w+"LabelVal"]=B.pos;var V=w+"Spike";e.spikeDistance=u(B)*z/P,e[V]=T.c2p(B.pos,!0);var U={},H=["med","q1","q3","min","max"];(y.boxmean||(y.meanline||{}).visible)&&H.push("mean"),(y.boxpoints||y.points)&&H.push("lf","uf");for(var q=0,G;q<H.length;q++)if(G=H[q],G in B&&!(B[G]in U)){U[B[G]]=!0;var Y=B[G],W=A.c2p(Y,!0),X=d.extendFlat({},e);X.attr=G,X[k+"0"]=X[k+"1"]=W,X[k+"LabelVal"]=Y,X[k+"Label"]=(f.labels?f.labels[G]+" ":"")+s.hoverLabelText(A,Y),X.hoverOnBox=!0,"mean"===G&&"sd"in B&&"sd"===y.boxmean&&(X[k+"err"]=B.sd),e.name="",e.spikeDistance=void 0,e[V]=void 0,X.hovertemplate=!1,x.push(X)}return x}function o(e,t,a){for(var o=e.cd,r=e.xa,s=e.ya,p=o[0].trace,g=r.c2p(t),m=s.c2p(a),h=function(e){var t=l(3,e.mrc||0);return l(n(r.c2p(e.x)-g)-t,1-3/t)},y=function(e){var t=l(3,e.mrc||0);return l(n(s.c2p(e.y)-m)-t,1-3/t)},f=c.quadrature(h,y),x=!1,_=0,b,v,w;_<o.length;_++){v=o[_];for(var k=0;k<(v.pts||[]).length;k++){w=v.pts[k];var T=f(w);T<=e.distance&&(e.distance=T,x=[_,k])}}if(!x)return!1;v=o[x[0]],w=v.pts[x[1]];var A=r.c2p(w.x,!0),S=s.c2p(w.y,!0),C=w.mrc||1;b=d.extendFlat({},e,{index:w.i,color:(p.marker||{}).color,name:p.name,x0:A-C,x1:A+C,y0:S-C,y1:S+C,spikeDistance:e.distance,hovertemplate:p.hovertemplate});var L;"h"===p.orientation?(L=s,b.xLabelVal=w.x,b.yLabelVal=v.pos):(L=r,b.xLabelVal=v.pos,b.yLabelVal=w.y);var E=L._id.charAt(0);return b[E+"Spike"]=L.c2p(v.pos,!0),u(w,p,b),b}var s=e("../../plots/cartesian/axes"),d=e("../../lib"),c=e("../../components/fx"),p=e("../../components/color"),u=d.fillText;t.exports={hoverPoints:function(e,t,r,i){var n=e.cd,l=n[0].trace,s=l.hoveron,d=[],c;return-1!==s.indexOf("boxes")&&(d=d.concat(a(e,t,r,i))),-1!==s.indexOf("points")&&(c=o(e,t,r)),"closest"===i?c?[c]:d:c?(d.push(c),d):d},hoverOnBoxes:a,hoverOnPoints:o}},{"../../components/color":524,"../../components/fx":564,"../../lib":657,"../../plots/cartesian/axes":705}],829:[function(e,t){'use strict';t.exports={attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults").supplyDefaults,crossTraceDefaults:e("./defaults").crossTraceDefaults,supplyLayoutDefaults:e("./layout_defaults").supplyLayoutDefaults,calc:e("./calc"),crossTraceCalc:e("./cross_trace_calc").crossTraceCalc,plot:e("./plot").plot,style:e("./style").style,styleOnSelect:e("./style").styleOnSelect,hoverPoints:e("./hover").hoverPoints,eventData:e("./event_data"),selectPoints:e("./select"),moduleType:"trace",name:"box",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","boxLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":718,"./attributes":823,"./calc":824,"./cross_trace_calc":825,"./defaults":826,"./event_data":827,"./hover":828,"./layout_attributes":830,"./layout_defaults":831,"./plot":832,"./select":833,"./style":834}],830:[function(e,t){'use strict';t.exports={boxmode:{valType:"enumerated",values:["group","overlay"],dflt:"overlay",editType:"calc"},boxgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"},boxgroupgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"}}},{}],831:[function(e,t){'use strict';function a(e,t,a,r,n){for(var l=!1,s=0,d;s<a.length;s++)if(d=a[s],o.traceIs(d,n+"Layout")){l=!0;break}l&&(r(n+"mode"),r(n+"gap"),r(n+"groupgap"))}var o=e("../../registry"),r=e("../../lib"),i=e("./layout_attributes");t.exports={supplyLayoutDefaults:function(e,t,o){a(e,t,o,function(a,o){return r.coerce(e,t,i,a,o)},"box")},_supply:a}},{"../../lib":657,"../../registry":788,"./layout_attributes":830}],832:[function(e,t){'use strict';var n=Math.sqrt,l=Math.min,s=Math.abs,c=Math.max;function a(e,a,o,r){var t=a.pos,i=a.val,n=r.bPos,s=r.wdPos||0,g=r.bPosPxOffset||0,h=o.whiskerwidth||0,y=o.notched||!1,f=y?1-2*o.notchwidth:1,x,_;Array.isArray(r.bdPos)?(x=r.bdPos[0],_=r.bdPos[1]):(x=r.bdPos,_=r.bdPos);var b=e.selectAll("path.box").data("violin"!==o.type||o.box.visible?u.identity:[]);b.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","box"),b.exit().remove(),b.each(function(e){if(e.empty)return"M0,0Z";var a=t.c2l(e.pos+n,!0),r=t.l2p(a)+g,d=t.l2p(a-x)+g,b=t.l2p(a+_)+g,v=t.l2p(a-s)+g,w=t.l2p(a+s)+g,k=t.l2p(a-x*f)+g,T=t.l2p(a+_*f)+g,A=i.c2p(e.q1,!0),S=i.c2p(e.q3,!0),C=u.constrain(i.c2p(e.med,!0),l(A,S)+1,c(A,S)-1),m=e.lf===void 0||!1===o.boxpoints,L=i.c2p(m?e.min:e.lf,!0),E=i.c2p(m?e.max:e.uf,!0),I=i.c2p(e.ln,!0),P=i.c2p(e.un,!0);"h"===o.orientation?p.select(this).attr("d","M"+C+","+k+"V"+T+"M"+A+","+d+"V"+b+(y?"H"+I+"L"+C+","+T+"L"+P+","+b:"")+"H"+S+"V"+d+(y?"H"+P+"L"+C+","+k+"L"+I+","+d:"")+"ZM"+A+","+r+"H"+L+"M"+S+","+r+"H"+E+(0===h?"":"M"+L+","+v+"V"+w+"M"+E+","+v+"V"+w)):p.select(this).attr("d","M"+k+","+C+"H"+T+"M"+d+","+A+"H"+b+(y?"V"+I+"L"+T+","+C+"L"+b+","+P:"")+"V"+S+"H"+d+(y?"V"+P+"L"+k+","+C+"L"+d+","+I:"")+"ZM"+r+","+A+"V"+L+"M"+r+","+S+"V"+E+(0===h?"":"M"+v+","+L+"H"+w+"M"+v+","+E+"H"+w))})}function o(e,a,o,r){var t=a.x,i=a.y,p=r.bdPos,h=r.bPos,y=o.boxpoints||o.points;u.seedPseudoRandom();var f=e.selectAll("g.points").data(y?function(e){return e.forEach(function(e){e.t=r,e.trace=o}),e}:[]);f.enter().append("g").attr("class","points"),f.exit().remove();var x=f.selectAll("path").data(function(e){var t=e.pts2,a=c((e.max-e.min)/10,e.q3-e.q1),r=[],d=0,g,f;if(o.jitter){if(0===a)for(d=1,r=Array(t.length),g=0;g<t.length;g++)r[g]=1;else for(g=0;g<t.length;g++){var x=c(0,g-5),_=t[x].v,b=l(t.length-1,g+5),w=t[b].v;"all"!==y&&(t[g].v<e.lf?w=l(w,e.lf):_=c(_,e.uf));var k=n(a*m*(b-x)/(w-_+1e-9*a))||0;k=u.constrain(s(k),0,1),r.push(k),d=c(k,d)}f=2*o.jitter/(d||1)}for(g=0;g<t.length;g++){var T=t[g],A=T.v,v=o.jitter?f*r[g]*(u.pseudoRandom()-.5):0,S=e.pos+h+p*(o.pointpos+v);"h"===o.orientation?(T.y=S,T.x=A):(T.x=S,T.y=A),"suspectedoutliers"===y&&A<e.uo&&A>e.lo&&(T.so=!0)}return t});x.enter().append("path").classed("point",!0),x.exit().remove(),x.call(g.translatePoints,t,i)}function r(e,a,o,r){var t=a.pos,i=a.val,n=r.bPos,l=r.bPosPxOffset||0,s=o.boxmean||(o.meanline||{}).visible,c,g;Array.isArray(r.bdPos)?(c=r.bdPos[0],g=r.bdPos[1]):(c=r.bdPos,g=r.bdPos);var m=e.selectAll("path.mean").data("box"===o.type&&o.boxmean||"violin"===o.type&&o.box.visible&&o.meanline.visible?u.identity:[]);m.enter().append("path").attr("class","mean").style({fill:"none","vector-effect":"non-scaling-stroke"}),m.exit().remove(),m.each(function(e){var a=t.c2l(e.pos+n,!0),r=t.l2p(a)+l,d=t.l2p(a-c)+l,u=t.l2p(a+g)+l,h=i.c2p(e.mean,!0),m=i.c2p(e.mean-e.sd,!0),y=i.c2p(e.mean+e.sd,!0);"h"===o.orientation?p.select(this).attr("d","M"+h+","+d+"V"+u+("sd"===s?"m0,0L"+m+","+r+"L"+h+","+d+"L"+y+","+r+"Z":"")):p.select(this).attr("d","M"+d+","+h+"H"+u+("sd"===s?"m0,0L"+r+","+m+"L"+d+","+h+"L"+r+","+y+"Z":""))})}var p=e("d3"),u=e("../../lib"),g=e("../../components/drawing"),m=.01;t.exports={plot:function(e,t,i,n){var l=t.xaxis,s=t.yaxis;u.makeTraceGroups(n,i,"trace boxes").each(function(e){var i=p.select(this),n=e[0],d=n.t,t=n.trace;if(d.wdPos=d.bdPos*t.whiskerwidth,!0!==t.visible||d.empty)return void i.remove();var c,u;"h"===t.orientation?(c=s,u=l):(c=l,u=s),a(i,{pos:c,val:u},t,d),o(i,{x:l,y:s},t,d),r(i,{pos:c,val:u},t,d)})},plotBoxAndWhiskers:a,plotPoints:o,plotBoxMean:r}},{"../../components/drawing":546,"../../lib":657,d3:108}],833:[function(e,t){'use strict';t.exports=function(e,t){var a=e.cd,o=e.xaxis,r=e.yaxis,n=[],l,s;if(!1===t)for(l=0;l<a.length;l++)for(s=0;s<(a[l].pts||[]).length;s++)a[l].pts[s].selected=0;else for(l=0;l<a.length;l++)for(s=0;s<(a[l].pts||[]).length;s++){var d=a[l].pts[s],c=o.c2p(d.x),p=r.c2p(d.y);t.contains([c,p],null,d.i,e)?(n.push({pointNumber:d.i,x:o.c2d(d.x),y:r.c2d(d.y)}),d.selected=1):d.selected=0}return n}},{}],834:[function(e,t){'use strict';var a=e("d3"),o=e("../../components/color"),r=e("../../components/drawing");t.exports={style:function(e,t,i){var n=i?i:a.select(e).selectAll("g.trace.boxes");n.style("opacity",function(e){return e[0].trace.opacity}),n.each(function(t){function i(e,t,a,r){e.style("stroke-width",t+"px").call(o.stroke,a).call(o.fill,r)}var n=a.select(this),l=t[0].trace,s=l.line.width,d=n.selectAll("path.box");if("candlestick"===l.type)d.each(function(e){if(!e.empty){var t=a.select(this),o=l[e.dir];i(t,o.line.width,o.line.color,o.fillcolor),t.style("opacity",l.selectedpoints&&!e.selected?.3:1)}});else{i(d,s,l.line.color,l.fillcolor),n.selectAll("path.mean").style({"stroke-width":s,"stroke-dasharray":2*s+"px,"+s+"px"}).call(o.stroke,l.line.color);var c=n.selectAll("path.point");r.pointStyle(c,l,e)}})},styleOnSelect:function(e,t,a){var o=t[0].trace,i=a.selectAll("path.point");o.selectedpoints?r.selectedPointStyle(i,o):r.pointStyle(i,o,e)}}},{"../../components/color":524,"../../components/drawing":546,d3:108}],835:[function(e,t){'use strict';function a(e){return{line:{color:o({},i.line.color,{dflt:e}),width:i.line.width,editType:"style"},fillcolor:i.fillcolor,editType:"style"}}var o=e("../../lib").extendFlat,r=e("../ohlc/attributes"),i=e("../box/attributes");t.exports={x:r.x,open:r.open,high:r.high,low:r.low,close:r.close,line:{width:o({},i.line.width,{}),editType:"style"},increasing:a(r.increasing.line.color.dflt),decreasing:a(r.decreasing.line.color.dflt),text:r.text,hovertext:r.hovertext,whiskerwidth:o({},i.whiskerwidth,{dflt:0}),hoverlabel:r.hoverlabel}},{"../../lib":657,"../box/attributes":823,"../ohlc/attributes":1008}],836:[function(e,t){'use strict';function a(e,t,a,o){return{min:a,q1:Math.min(e,o),med:o,q3:Math.max(e,o),max:t}}var o=e("../../lib"),r=e("../../plots/cartesian/axes"),i=e("../ohlc/calc").calcCommon;t.exports=function(e,t){var n=e._fullLayout,l=r.getFromId(e,t.xaxis),s=r.getFromId(e,t.yaxis),d=l.makeCalcdata(t,"x"),c=i(e,t,d,s,a);return c.length?(o.extendFlat(c[0].t,{num:n._numBoxes,dPos:o.distinctVals(d).minDiff/2,posLetter:"x",valLetter:"y"}),n._numBoxes++,c):[{t:{empty:!0}}]}},{"../../lib":657,"../../plots/cartesian/axes":705,"../ohlc/calc":1009}],837:[function(e,t){'use strict';function a(e,t,a,o){var i=a(o+".line.color");a(o+".line.width",t.line.width),a(o+".fillcolor",r.addOpacity(i,.5))}var o=e("../../lib"),r=e("../../components/color"),i=e("../ohlc/ohlc_defaults"),n=e("./attributes");t.exports=function(e,t,r,l){function s(a,r){return o.coerce(e,t,n,a,r)}var d=i(e,t,s,l);return d?void(s("line.width"),a(e,t,s,"increasing"),a(e,t,s,"decreasing"),s("text"),s("hovertext"),s("whiskerwidth"),l._requestRangeslider[t.xaxis]=!0):void(t.visible=!1)}},{"../../components/color":524,"../../lib":657,"../ohlc/ohlc_defaults":1013,"./attributes":835}],838:[function(e,t){'use strict';t.exports={moduleType:"trace",name:"candlestick",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","showLegend","candlestick","boxLayout"],meta:{},attributes:e("./attributes"),layoutAttributes:e("../box/layout_attributes"),supplyLayoutDefaults:e("../box/layout_defaults").supplyLayoutDefaults,crossTraceCalc:e("../box/cross_trace_calc").crossTraceCalc,supplyDefaults:e("./defaults"),calc:e("./calc"),plot:e("../box/plot").plot,layerName:"boxlayer",style:e("../box/style").style,hoverPoints:e("../ohlc/hover").hoverPoints,selectPoints:e("../ohlc/select")}},{"../../plots/cartesian":718,"../box/cross_trace_calc":825,"../box/layout_attributes":830,"../box/layout_defaults":831,"../box/plot":832,"../box/style":834,"../ohlc/hover":1011,"../ohlc/select":1015,"./attributes":835,"./calc":836,"./defaults":837}],839:[function(e,t){'use strict';function o(e,t,a,o){["aaxis","baxis"].forEach(function(n){var l=n.charAt(0),s=e[n]||{},d=i.newContainer(t,n),c={tickfont:"x",id:l+"axis",letter:l,font:t.font,name:n,data:e[l],calendar:t.calendar,dfltColor:o,bgColor:a.paper_bgcolor,fullLayout:a};r(s,d,c),d._categories=d._categories||[],e[n]||"-"===s.type||(e[n]={type:s.type})})}var r=e("./axis_defaults"),i=e("../../plot_api/plot_template");t.exports=function(e,t,r,i,n){var l=i("a");l||(i("da"),i("a0"));var a=i("b");a||(i("db"),i("b0")),o(e,t,r,n)}},{"../../plot_api/plot_template":695,"./axis_defaults":844}],840:[function(e,t){'use strict';var r=Math.min,l=Math.max;function o(e,t){if(!s(e)||10<=t)return null;for(var a=1/0,d=-Infinity,c=e.length,n=0,p;n<c;n++)if(p=e[n],s(p)){var u=o(p,t+1);u&&(a=r(u[0],a),d=l(u[1],d))}else a=r(p,a),d=l(p,d);return[a,d]}var s=e("../../lib").isArrayOrTypedArray;t.exports=function(e){return o(e,0)}},{"../../lib":657}],841:[function(e,t){'use strict';var a=e("../../plots/font_attributes"),o=e("./axis_attributes"),r=e("../../components/color/attributes"),i=a({editType:"calc"});i.family.dflt="\"Open Sans\", verdana, arial, sans-serif",i.size.dflt=12,i.color.dflt=r.defaultLine,t.exports={carpet:{valType:"string",editType:"calc"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},a:{valType:"data_array",editType:"calc"},a0:{valType:"number",dflt:0,editType:"calc"},da:{valType:"number",dflt:1,editType:"calc"},b:{valType:"data_array",editType:"calc"},b0:{valType:"number",dflt:0,editType:"calc"},db:{valType:"number",dflt:1,editType:"calc"},cheaterslope:{valType:"number",dflt:1,editType:"calc"},aaxis:o,baxis:o,font:i,color:{valType:"color",dflt:r.defaultLine,editType:"plot"},transforms:void 0}},{"../../components/color/attributes":523,"../../plots/font_attributes":733,"./axis_attributes":843}],842:[function(e,t){'use strict';var o=Math.ceil,r=Math.min,i=Math.max,l=Math.floor,s=e("../../lib").isArrayOrTypedArray;t.exports=function(e,t,d,a){var c=s(d)?"a":"b",p="a"===c?e.aaxis:e.baxis,u=p.smoothing,g="a"===c?e.a2i:e.b2j,h="a"===c?d:a,y="a"===c?a:d,f="a"===c?t.a.length:t.b.length,n="a"===c?t.b.length:t.a.length,m=l("a"===c?e.b2j(y):e.a2i(y)),x="a"===c?function(t){return e.evalxy([],t,m)}:function(t){return e.evalxy([],m,t)},_,b,v,w,k,T,A,S,C,L,E,I,P;u&&(v=i(0,r(n-2,m)),w=m-v,b="a"===c?function(t,a){return e.dxydi([],t,v,a,w)}:function(t,a){return e.dxydj([],v,t,w,a)});var z=g(h[0]),D=g(h[1]),O=z<D?1:-1,R=1e-8*(D-z),M=0<O?l:o,j=0<O?o:l,B=0<O?r:i,F=0<O?i:r,N=M(z+R),V=j(D-R);A=x(z);var U=[[A]];for(_=N;_*O<V*O;_+=O)k=[],E=F(z,_),I=B(D,_+O),P=I-E,T=i(0,r(f-2,l(.5*(E+I)))),S=x(I),u&&(C=b(T,E-T),L=b(T,I-T),k.push([A[0]+C[0]/3*P,A[1]+C[1]/3*P]),k.push([S[0]-L[0]/3*P,S[1]-L[1]/3*P])),k.push(S),U.push(k),A=S;return U}},{"../../lib":657}],843:[function(e,t){'use strict';var a=e("../../plots/font_attributes"),o=e("../../components/color/attributes"),r=e("../../plots/cartesian/layout_attributes"),i=e("../../plot_api/edit_types").overrideAll,n=e("../../constants/docs").FORMAT_LINK,l=e("../../constants/docs").TIME_FORMAT_LINK;t.exports={color:{valType:"color",editType:"calc"},smoothing:{valType:"number",dflt:1,min:0,max:1.3,editType:"calc"},title:{text:{valType:"string",dflt:"",editType:"calc"},font:a({editType:"calc"}),offset:{valType:"number",dflt:10,editType:"calc"},editType:"calc"},type:{valType:"enumerated",values:["-","linear","date","category"],dflt:"-",editType:"calc"},autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"calc"},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"calc"},range:{valType:"info_array",editType:"calc",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}]},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},cheatertype:{valType:"enumerated",values:["index","value"],dflt:"value",editType:"calc"},tickmode:{valType:"enumerated",values:["linear","array"],dflt:"array",editType:"calc"},nticks:{valType:"integer",min:0,dflt:0,editType:"calc"},tickvals:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},showticklabels:{valType:"enumerated",values:["start","end","both","none"],dflt:"start",editType:"calc"},tickfont:a({editType:"calc"}),tickangle:{valType:"angle",dflt:"auto",editType:"calc"},tickprefix:{valType:"string",dflt:"",editType:"calc"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},ticksuffix:{valType:"string",dflt:"",editType:"calc"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"calc"},separatethousands:{valType:"boolean",dflt:!1,editType:"calc"},tickformat:{valType:"string",dflt:"",editType:"calc"},tickformatstops:i(r.tickformatstops,"calc","from-root"),categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},labelpadding:{valType:"integer",dflt:10,editType:"calc"},labelprefix:{valType:"string",editType:"calc"},labelsuffix:{valType:"string",dflt:"",editType:"calc"},showline:{valType:"boolean",dflt:!1,editType:"calc"},linecolor:{valType:"color",dflt:o.defaultLine,editType:"calc"},linewidth:{valType:"number",min:0,dflt:1,editType:"calc"},gridcolor:{valType:"color",editType:"calc"},gridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},showgrid:{valType:"boolean",dflt:!0,editType:"calc"},minorgridcount:{valType:"integer",min:0,dflt:0,editType:"calc"},minorgridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},minorgridcolor:{valType:"color",dflt:o.lightLine,editType:"calc"},startline:{valType:"boolean",editType:"calc"},startlinecolor:{valType:"color",editType:"calc"},startlinewidth:{valType:"number",dflt:1,editType:"calc"},endline:{valType:"boolean",editType:"calc"},endlinewidth:{valType:"number",dflt:1,editType:"calc"},endlinecolor:{valType:"color",editType:"calc"},tick0:{valType:"number",min:0,dflt:0,editType:"calc"},dtick:{valType:"number",min:0,dflt:1,editType:"calc"},arraytick0:{valType:"integer",min:0,dflt:0,editType:"calc"},arraydtick:{valType:"integer",min:1,dflt:1,editType:"calc"},_deprecated:{title:{valType:"string",editType:"calc"},titlefont:a({editType:"calc"}),titleoffset:{valType:"number",dflt:10,editType:"calc"}},editType:"calc"}},{"../../components/color/attributes":523,"../../constants/docs":628,"../../plot_api/edit_types":688,"../../plots/cartesian/layout_attributes":719,"../../plots/font_attributes":733}],844:[function(e,t){'use strict';var o=Math.round;function a(e,t){if("-"===e.type){var a=e._id,o=a.charAt(0),r=e[o+"calendar"];e.type=u(t,r)}}var r=e("./attributes"),i=e("../../components/color").addOpacity,n=e("../../registry"),l=e("../../lib"),s=e("../../plots/cartesian/tick_value_defaults"),d=e("../../plots/cartesian/tick_label_defaults"),c=e("../../plots/cartesian/category_order_defaults"),p=e("../../plots/cartesian/set_convert"),u=e("../../plots/cartesian/axis_autotype");t.exports=function(e,t,u){function g(a,o){return l.coerce(e,t,f,a,o)}function m(a,o){return l.coerce2(e,t,f,a,o)}var h=u.letter,y=u.font||{},f=r[h+"axis"];u.name&&(t._name=u.name,t._id=u.name);var x=g("type");if("-"===x&&(u.data&&a(t,u.data),"-"===t.type?t.type="linear":x=e.type=t.type),g("smoothing"),g("cheatertype"),g("showticklabels"),g("labelprefix",h+" = "),g("labelsuffix"),g("showtickprefix"),g("showticksuffix"),g("separatethousands"),g("tickformat"),g("exponentformat"),g("showexponent"),g("categoryorder"),g("tickmode"),g("tickvals"),g("ticktext"),g("tick0"),g("dtick"),"array"===t.tickmode&&(g("arraytick0"),g("arraydtick")),g("labelpadding"),t._hovertitle=h,"date"===x){var _=n.getComponentMethod("calendars","handleDefaults");_(e,t,"calendar",u.calendar)}p(t,u.fullLayout),t.c2p=l.identity;var b=g("color",u.dfltColor),v=b===e.color?b:y.color,w=g("title.text");w&&(l.coerceFont(g,"title.font",{family:y.family,size:o(1.2*y.size),color:v}),g("title.offset")),g("tickangle");var k=g("autorange",!t.isValidRange(e.range));k&&g("rangemode"),g("range"),t.cleanRange(),g("fixedrange"),s(e,t,g,x),d(e,t,g,x,u),c(e,t,g,{data:u.data,dataAttr:h});var T=m("gridcolor",i(b,.3)),A=m("gridwidth"),S=g("showgrid");S||(delete t.gridcolor,delete t.gridwidth);var C=m("startlinecolor",b),L=m("startlinewidth",A),E=g("startline",t.showgrid||!!C||!!L);E||(delete t.startlinecolor,delete t.startlinewidth);var I=m("endlinecolor",b),P=m("endlinewidth",A),z=g("endline",t.showgrid||!!I||!!P);return z||(delete t.endlinecolor,delete t.endlinewidth),S?(g("minorgridcount"),g("minorgridwidth",A),g("minorgridcolor",i(T,.06)),!t.minorgridcount&&(delete t.minorgridwidth,delete t.minorgridcolor)):(delete t.gridcolor,delete t.gridWidth),"none"===t.showticklabels&&(delete t.tickfont,delete t.tickangle,delete t.showexponent,delete t.exponentformat,delete t.tickformat,delete t.showticksuffix,delete t.showtickprefix),t.showticksuffix||delete t.ticksuffix,t.showtickprefix||delete t.tickprefix,g("tickmode"),t}},{"../../components/color":524,"../../lib":657,"../../plots/cartesian/axis_autotype":706,"../../plots/cartesian/category_order_defaults":709,"../../plots/cartesian/set_convert":725,"../../plots/cartesian/tick_label_defaults":726,"../../plots/cartesian/tick_value_defaults":728,"../../registry":788,"./attributes":841}],845:[function(e,t){'use strict';var o=e("../../plots/cartesian/axes"),r=e("../../lib").isArray1D,i=e("./cheater_basis"),n=e("./array_minmax"),l=e("./calc_gridlines"),s=e("./calc_labels"),d=e("./calc_clippath"),c=e("../heatmap/clean_2d_array"),p=e("./smooth_fill_2d_array"),u=e("../heatmap/convert_column_xyz"),g=e("./set_convert");t.exports=function(e,m){var h=o.getFromId(e,m.xaxis),f=o.getFromId(e,m.yaxis),_=m.aaxis,v=m.baxis,w=m.x,k=m.y,T=[];w&&r(w)&&T.push("x"),k&&r(k)&&T.push("y"),T.length&&u(m,_,v,"a","b",T);var A=m._a=m._a||m.a,a=m._b=m._b||m.b;w=m._x||m.x,k=m._y||m.y;var b={};if(m._cheater){var t="index"===_.cheatertype?A.length:A,S="index"===v.cheatertype?a.length:a;w=i(t,S,m.cheaterslope)}m._x=w=c(w),m._y=k=c(k),p(w,A,a),p(k,A,a),g(m),m.setScale();var C=n(w),L=n(k),E=.5*(C[1]-C[0]),I=.5*(C[1]+C[0]),P=.5*(L[1]-L[0]),z=.5*(L[1]+L[0]),D=1.3;return C=[I-E*D,I+E*D],L=[z-P*D,z+P*D],m._extremes[h._id]=o.findExtremes(h,C,{padded:!0}),m._extremes[f._id]=o.findExtremes(f,L,{padded:!0}),l(m,"a","b"),l(m,"b","a"),s(m,_),s(m,v),b.clipsegments=d(m._xctrl,m._yctrl,_,v),b.x=w,b.y=k,b.a=A,b.b=a,[b]}},{"../../lib":657,"../../plots/cartesian/axes":705,"../heatmap/clean_2d_array":944,"../heatmap/convert_column_xyz":946,"./array_minmax":840,"./calc_clippath":846,"./calc_gridlines":847,"./calc_labels":848,"./cheater_basis":850,"./set_convert":863,"./smooth_fill_2d_array":864}],846:[function(e,t){'use strict';t.exports=function(e,t,a,o){var r=[],n=!!a.smoothing,l=!!o.smoothing,s=e[0].length-1,d=e.length-1,c,p,u;for(c=0,p=[],u=[];c<=s;c++)p[c]=e[0][c],u[c]=t[0][c];for(r.push({x:p,y:u,bicubic:n}),c=0,p=[],u=[];c<=d;c++)p[c]=e[c][s],u[c]=t[c][s];for(r.push({x:p,y:u,bicubic:l}),c=s,p=[],u=[];0<=c;c--)p[s-c]=e[d][c],u[s-c]=t[d][c];for(r.push({x:p,y:u,bicubic:n}),c=d,p=[],u=[];0<=c;c--)p[d-c]=e[c][0],u[d-c]=t[c][0];return r.push({x:p,y:u,bicubic:l}),r}},{}],847:[function(e,t){'use strict';var a=Math.ceil,o=Math.min,r=Math.max,l=Math.floor,s=e("../../plots/cartesian/axes"),c=e("../../lib/extend").extendFlat;t.exports=function(e,t,p){function u(a){var n=[],s=[],d={},c,u,g,m,y,f,x,_,v,w,k,T;if("b"===t)for(u=e.b2j(a),g=l(r(0,o(U-2,u))),m=u-g,d.length=U,d.crossLength=V,d.xy=function(t){return e.evalxy([],t,u)},d.dxy=function(t,a){return e.dxydi([],t,g,a,m)},c=0;c<V;c++)f=o(V-2,c),x=c-f,_=e.evalxy([],c,u),b.smoothing&&0<c&&(v=e.dxydi([],c-1,g,0,m),n.push(y[0]+v[0]/3),s.push(y[1]+v[1]/3),w=e.dxydi([],c-1,g,1,m),n.push(_[0]-w[0]/3),s.push(_[1]-w[1]/3)),n.push(_[0]),s.push(_[1]),y=_;else for(c=e.a2i(a),f=l(r(0,o(V-2,c))),x=c-f,d.length=V,d.crossLength=U,d.xy=function(t){return e.evalxy([],c,t)},d.dxy=function(t,a){return e.dxydj([],f,t,x,a)},u=0;u<U;u++)g=o(U-2,u),m=u-g,_=e.evalxy([],c,u),b.smoothing&&0<u&&(k=e.dxydj([],f,u-1,x,0),n.push(y[0]+k[0]/3),s.push(y[1]+k[1]/3),T=e.dxydj([],f,u-1,x,1),n.push(_[0]-T[0]/3),s.push(_[1]-T[1]/3)),n.push(_[0]),s.push(_[1]),y=_;return d.axisLetter=t,d.axis=h,d.crossAxis=b,d.value=a,d.constvar=p,d.index=E,d.x=n,d.y=s,d.smoothing=b.smoothing,d}function g(a){var i=[],n=[],l={},s,d,c,u,g;if(l.length=m.length,l.crossLength=_.length,"b"===t)for(c=r(0,o(U-2,a)),g=o(1,r(0,a-c)),l.xy=function(t){return e.evalxy([],t,a)},l.dxy=function(t,a){return e.dxydi([],t,c,a,g)},s=0;s<F;s++)i[s]=M[a*H][s],n[s]=B[a*H][s];else for(d=r(0,o(V-2,a)),u=o(1,r(0,a-d)),l.xy=function(t){return e.evalxy([],a,t)},l.dxy=function(t,a){return e.dxydj([],d,t,u,a)},s=0;s<N;s++)i[s]=M[s][a*H],n[s]=B[s][a*H];return l.axisLetter=t,l.axis=h,l.crossAxis=b,l.value=m[a],l.constvar=p,l.index=a,l.x=i,l.y=n,l.smoothing=b.smoothing,l}var m=e["_"+t],h=e[t+"axis"],y=h._gridlines=[],f=h._minorgridlines=[],x=h._boundarylines=[],_=e["_"+p],b=e[p+"axis"],w,k,T,A,S,C,L,E,I,P,z,D,O,R;"array"===h.tickmode&&(h.tickvals=m.slice());var M=e._xctrl,B=e._yctrl,F=M[0].length,N=M.length,V=e._a.length,U=e._b.length;s.prepTicks(h),"array"===h.tickmode&&delete h.tickvals;var H=h.smoothing?3:1;if("array"===h.tickmode){for(A=5e-15,S=[l((m.length-1-h.arraytick0)/h.arraydtick*(1+A)),a(-h.arraytick0/h.arraydtick/(1+A))].sort(function(e,t){return e-t}),C=S[0]-1,L=S[1]+1,E=C;E<L;E++)k=h.arraytick0+h.arraydtick*E,0>k||k>m.length-1||y.push(c(g(k),{color:h.gridcolor,width:h.gridwidth}));for(E=C;E<L;E++)if(T=h.arraytick0+h.arraydtick*E,z=o(T+h.arraydtick,m.length-1),!(0>T||T>m.length-1)&&!(0>z||z>m.length-1))for(D=m[T],O=m[z],w=0;w<h.minorgridcount;w++)R=z-T,0>=R||(P=D+(O-D)*(w+1)/(h.minorgridcount+1)*(h.arraydtick/R),!(P<m[0]||P>m[m.length-1])&&f.push(c(u(P),{color:h.minorgridcolor,width:h.minorgridwidth})));h.startline&&x.push(c(g(0),{color:h.startlinecolor,width:h.startlinewidth})),h.endline&&x.push(c(g(m.length-1),{color:h.endlinecolor,width:h.endlinewidth}))}else{for(A=5e-15,S=[l((m[m.length-1]-h.tick0)/h.dtick*(1+A)),a((m[0]-h.tick0)/h.dtick/(1+A))].sort(function(e,t){return e-t}),C=S[0],L=S[1],E=C;E<=L;E++)I=h.tick0+h.dtick*E,y.push(c(u(I),{color:h.gridcolor,width:h.gridwidth}));for(E=C-1;E<L+1;E++)for(I=h.tick0+h.dtick*E,w=0;w<h.minorgridcount;w++)P=I+h.dtick*(w+1)/(h.minorgridcount+1),P<m[0]||P>m[m.length-1]||f.push(c(u(P),{color:h.minorgridcolor,width:h.minorgridwidth}));h.startline&&x.push(c(u(m[0]),{color:h.startlinecolor,width:h.startlinewidth})),h.endline&&x.push(c(u(m[m.length-1]),{color:h.endlinecolor,width:h.endlinewidth}))}}},{"../../lib/extend":648,"../../plots/cartesian/axes":705}],848:[function(e,t){'use strict';var a=e("../../plots/cartesian/axes"),o=e("../../lib/extend").extendFlat;t.exports=function(e,t){var r=t._labels=[],n=t._gridlines,l,s,d,c,p;for(l=0;l<n.length;l++)p=n[l],-1!==["start","both"].indexOf(t.showticklabels)&&(s=a.tickText(t,p.value),o(s,{prefix:d,suffix:c,endAnchor:!0,xy:p.xy(0),dxy:p.dxy(0,0),axis:p.axis,length:p.crossAxis.length,font:p.axis.tickfont,isFirst:0===l,isLast:l===n.length-1}),r.push(s)),-1!==["end","both"].indexOf(t.showticklabels)&&(s=a.tickText(t,p.value),o(s,{endAnchor:!1,xy:p.xy(p.crossLength-1),dxy:p.dxy(p.crossLength-2,1),axis:p.axis,length:p.crossAxis.length,font:p.axis.tickfont,isFirst:0===l,isLast:l===n.length-1}),r.push(s))}},{"../../lib/extend":648,"../../plots/cartesian/axes":705}],849:[function(e,t){'use strict';var a=Math.pow,o=.5;t.exports=function(e,t,r,i){var n=e[0]-t[0],l=e[1]-t[1],s=r[0]-t[0],d=r[1]-t[1],c=a(n*n+l*l,o/2),p=a(s*s+d*d,o/2),u=(p*p*n-c*c*s)*i,g=(p*p*l-c*c*d)*i,m=3*(p*(c+p)),h=3*(c*(c+p));return[[t[0]+(m&&u/m),t[1]+(m&&g/m)],[t[0]-(h&&u/h),t[1]-(h&&g/h)]]}},{}],850:[function(e,t){'use strict';var a=Math.min,o=Math.max,r=e("../../lib").isArrayOrTypedArray;t.exports=function(e,t,n){var l=[],s=r(e)?e.length:e,d=r(t)?t.length:t,c=r(e)?e:null,p=r(t)?t:null,u,g,m,h,y,f;c&&(m=(c.length-1)/(c[c.length-1]-c[0])/(s-1)),p&&(h=(p.length-1)/(p[p.length-1]-p[0])/(d-1));var x=1/0,_=-Infinity,b;for(g=0;g<d;g++)for(l[g]=[],f=p?(p[g]-p[0])*h:g/(d-1),u=0;u<s;u++)y=c?(c[u]-c[0])*m:u/(s-1),b=y-f*n,x=a(b,x),_=o(b,_),l[g][u]=b;var v=1/(_-x),w=-x*v;for(g=0;g<d;g++)for(u=0;u<s;u++)l[g][u]=v*l[g][u]+w;return l}},{"../../lib":657}],851:[function(e,t){'use strict';function a(e,t,a){var o=-.5*a[0]+1.5*t[0],r=-.5*a[1]+1.5*t[1];return[(2*o+e[0])/3,(2*r+e[1])/3]}var o=e("./catmull_rom"),r=e("../../lib").ensureArray;t.exports=function(e,t,n,l,s,d){var c=n[0].length,p=n.length,u=s?3*c-2:c,g=d?3*p-2:p,m,h,y,f,x,_,b,v,w,k;for(e=r(e,g),t=r(t,g),y=0;y<g;y++)e[y]=r(e[y],u),t[y]=r(t[y],u);for(h=0,f=0;h<p;h++,f+=d?3:1)for(x=e[f],_=t[f],b=n[h],v=l[h],(m=0,y=0);m<c;m++,y+=s?3:1)x[y]=b[m],_[y]=v[m];if(s)for(h=0,f=0;h<p;h++,f+=d?3:1){for(m=1,y=3;m<c-1;m++,y+=3)w=o([n[h][m-1],l[h][m-1]],[n[h][m],l[h][m]],[n[h][m+1],l[h][m+1]],s),e[f][y-1]=w[0][0],t[f][y-1]=w[0][1],e[f][y+1]=w[1][0],t[f][y+1]=w[1][1];k=a([e[f][0],t[f][0]],[e[f][2],t[f][2]],[e[f][3],t[f][3]]),e[f][1]=k[0],t[f][1]=k[1],k=a([e[f][u-1],t[f][u-1]],[e[f][u-3],t[f][u-3]],[e[f][u-4],t[f][u-4]]),e[f][u-2]=k[0],t[f][u-2]=k[1]}if(d)for(y=0;y<u;y++){for(f=3;f<g-3;f+=3)w=o([e[f-3][y],t[f-3][y]],[e[f][y],t[f][y]],[e[f+3][y],t[f+3][y]],d),e[f-1][y]=w[0][0],t[f-1][y]=w[0][1],e[f+1][y]=w[1][0],t[f+1][y]=w[1][1];k=a([e[0][y],t[0][y]],[e[2][y],t[2][y]],[e[3][y],t[3][y]]),e[1][y]=k[0],t[1][y]=k[1],k=a([e[g-1][y],t[g-1][y]],[e[g-3][y],t[g-3][y]],[e[g-4][y],t[g-4][y]]),e[g-2][y]=k[0],t[g-2][y]=k[1]}if(s&&d)for(f=1;f<g;f+=0==(f+1)%3?2:1){for(y=3;y<u-3;y+=3)w=o([e[f][y-3],t[f][y-3]],[e[f][y],t[f][y]],[e[f][y+3],t[f][y+3]],s),e[f][y-1]=.5*(e[f][y-1]+w[0][0]),t[f][y-1]=.5*(t[f][y-1]+w[0][1]),e[f][y+1]=.5*(e[f][y+1]+w[1][0]),t[f][y+1]=.5*(t[f][y+1]+w[1][1]);k=a([e[f][0],t[f][0]],[e[f][2],t[f][2]],[e[f][3],t[f][3]]),e[f][1]=.5*(e[f][1]+k[0]),t[f][1]=.5*(t[f][1]+k[1]),k=a([e[f][u-1],t[f][u-1]],[e[f][u-3],t[f][u-3]],[e[f][u-4],t[f][u-4]]),e[f][u-2]=.5*(e[f][u-2]+k[0]),t[f][u-2]=.5*(t[f][u-2]+k[1])}return[e,t]}},{"../../lib":657,"./catmull_rom":849}],852:[function(e,t){'use strict';t.exports={RELATIVE_CULL_TOLERANCE:1e-6}},{}],853:[function(e,t){'use strict';t.exports=function(e,t,a){return t&&a?function(t,o,r,i,n){t||(t=[]);var l,s,p,u,g,m;o*=3,r*=3;var h=i*i,y=1-i,f=y*y,x=2*(y*i),_=-3*f,a=3*(f-x),b=3*(x-h),c=3*h,d=n*n,v=1-n,w=v*v;for(m=0;m<e.length;m++)g=e[m],l=_*g[r][o]+a*g[r][o+1]+b*g[r][o+2]+c*g[r][o+3],s=_*g[r+1][o]+a*g[r+1][o+1]+b*g[r+1][o+2]+c*g[r+1][o+3],p=_*g[r+2][o]+a*g[r+2][o+1]+b*g[r+2][o+2]+c*g[r+2][o+3],u=_*g[r+3][o]+a*g[r+3][o+1]+b*g[r+3][o+2]+c*g[r+3][o+3],t[m]=w*v*l+3*(w*n*s+v*d*p)+d*n*u;return t}:t?function(t,o,r,i,n){t||(t=[]);var l,s,p,u;o*=3;var g=i*i,m=1-i,h=m*m,y=2*(m*i),f=-3*h,a=3*(h-y),x=3*(y-g),c=3*g;for(p=0;p<e.length;p++)u=e[p],l=f*u[r][o]+a*u[r][o+1]+x*u[r][o+2]+c*u[r][o+3],s=f*u[r+1][o]+a*u[r+1][o+1]+x*u[r+1][o+2]+c*u[r+1][o+3],t[p]=(1-n)*l+n*s;return t}:a?function(t,a,o,r,i){t||(t=[]);var n,l,s,d,c,p;o*=3;var u=i*i,g=1-i,m=g*g;for(c=0;c<e.length;c++)p=e[c],n=p[o][a+1]-p[o][a],l=p[o+1][a+1]-p[o+1][a],s=p[o+2][a+1]-p[o+2][a],d=p[o+3][a+1]-p[o+3][a],t[c]=m*g*n+3*(m*i*l+g*u*s)+u*i*d;return t}:function(t,a,o,r,i){t||(t=[]);var n,l,s,d;for(s=0;s<e.length;s++)d=e[s],n=d[o][a+1]-d[o][a],l=d[o+1][a+1]-d[o+1][a],t[s]=(1-i)*n+i*l;return t}}},{}],854:[function(e,t){'use strict';t.exports=function(e,t,a){return t&&a?function(t,o,r,i,n){t||(t=[]);var l,s,p,u,g,m;o*=3,r*=3;var h=i*i,y=1-i,f=y*y,x=n*n,_=1-n,v=_*_,w=2*(_*n),T=-3*v,a=3*(v-w),b=3*(w-x),c=3*x;for(m=0;m<e.length;m++)g=e[m],l=T*g[r][o]+a*g[r+1][o]+b*g[r+2][o]+c*g[r+3][o],s=T*g[r][o+1]+a*g[r+1][o+1]+b*g[r+2][o+1]+c*g[r+3][o+1],p=T*g[r][o+2]+a*g[r+1][o+2]+b*g[r+2][o+2]+c*g[r+3][o+2],u=T*g[r][o+3]+a*g[r+1][o+3]+b*g[r+2][o+3]+c*g[r+3][o+3],t[m]=f*y*l+3*(f*i*s+y*h*p)+h*i*u;return t}:t?function(t,a,o,r,i){t||(t=[]);var n,l,s,d,c,p;a*=3;var u=i*i,g=1-i,m=g*g;for(c=0;c<e.length;c++)p=e[c],n=p[o+1][a]-p[o][a],l=p[o+1][a+1]-p[o][a+1],s=p[o+1][a+2]-p[o][a+2],d=p[o+1][a+3]-p[o][a+3],t[c]=m*g*n+3*(m*i*l+g*u*s)+u*i*d;return t}:a?function(t,o,r,i,n){t||(t=[]);var l,s,p,u;r*=3;var g=n*n,m=1-n,h=m*m,y=2*(m*n),f=-3*h,a=3*(h-y),x=3*(y-g),c=3*g;for(p=0;p<e.length;p++)u=e[p],l=f*u[r][o]+a*u[r+1][o]+x*u[r+2][o]+c*u[r+3][o],s=f*u[r][o+1]+a*u[r+1][o+1]+x*u[r+2][o+1]+c*u[r+3][o+1],t[p]=(1-i)*l+i*s;return t}:function(t,a,o,r){t||(t=[]);var i,n,l,s;for(l=0;l<e.length;l++)s=e[l],i=s[o+1][a]-s[o][a],n=s[o+1][a+1]-s[o][a+1],t[l]=(1-r)*i+r*n;return t}}},{}],855:[function(e,t){'use strict';var a=Math.min,o=Math.max,r=Math.floor;t.exports=function(e,t,i,n,l){var s=t-2,d=i-2;return n&&l?function(t,n,i){t||(t=[]);var l=o(0,a(r(n),s)),c=o(0,a(r(i),d)),p=o(0,a(1,n-l)),u=o(0,a(1,i-c)),g,m,h,y,f,x;l*=3,c*=3;var _=p*p,b=_*p,v=1-p,w=v*v,T=w*v,A=u*u,S=1-u,C=S*S;for(x=0;x<e.length;x++)f=e[x],g=T*f[c][l]+3*(w*p*f[c][l+1]+v*_*f[c][l+2])+b*f[c][l+3],m=T*f[c+1][l]+3*(w*p*f[c+1][l+1]+v*_*f[c+1][l+2])+b*f[c+1][l+3],h=T*f[c+2][l]+3*(w*p*f[c+2][l+1]+v*_*f[c+2][l+2])+b*f[c+2][l+3],y=T*f[c+3][l]+3*(w*p*f[c+3][l+1]+v*_*f[c+3][l+2])+b*f[c+3][l+3],t[x]=C*S*g+3*(C*u*m+S*A*h)+A*u*y;return t}:n?function(t,n,i){t||(t=[]);var l=o(0,a(r(n),s)),c=o(0,a(r(i),d)),p=o(0,a(1,n-l)),u=o(0,a(1,i-c)),g,m,h,y,f,x;l*=3;var _=p*p,b=1-p,v=b*b,w=1-u;for(f=0;f<e.length;f++)x=e[f],g=w*x[c][l]+u*x[c+1][l],m=w*x[c][l+1]+u*x[c+1][l+1],h=w*x[c][l+2]+u*x[c+1][l+1],y=w*x[c][l+3]+u*x[c+1][l+1],t[f]=v*b*g+3*(v*p*m+b*_*h)+_*p*y;return t}:l?function(t,n,i){t||(t=[]);var l=o(0,a(r(n),s)),c=o(0,a(r(i),d)),p=o(0,a(1,n-l)),u=o(0,a(1,i-c)),g,m,h,y,f,x;c*=3;var _=u*u,b=1-u,v=b*b,w=1-p;for(f=0;f<e.length;f++)x=e[f],g=w*x[c][l]+p*x[c][l+1],m=w*x[c+1][l]+p*x[c+1][l+1],h=w*x[c+2][l]+p*x[c+2][l+1],y=w*x[c+3][l]+p*x[c+3][l+1],t[f]=v*b*g+3*(v*u*m+b*_*h)+_*u*y;return t}:function(t,n,i){t||(t=[]);var l=o(0,a(r(n),s)),c=o(0,a(r(i),d)),p=o(0,a(1,n-l)),u=o(0,a(1,i-c)),g=1-p,m,h,y,f;for(y=0;y<e.length;y++)f=e[y],m=g*f[c][l]+p*f[c][l+1],h=g*f[c+1][l]+p*f[c+1][l+1],t[y]=(1-u)*m+u*h;return t}}},{}],856:[function(e,t){'use strict';var a=e("../../lib"),o=e("./xy_defaults"),r=e("./ab_defaults"),i=e("./attributes"),n=e("../../components/color/attributes");t.exports=function(e,t,l,s){function d(o,r){return a.coerce(e,t,i,o,r)}t._clipPathId="clip"+t.uid+"carpet";var c=d("color",n.defaultLine);if(a.coerceFont(d,"font"),d("carpet"),r(e,t,s,d,c),!t.a||!t.b)return void(t.visible=!1);3>t.a.length&&(t.aaxis.smoothing=0),3>t.b.length&&(t.baxis.smoothing=0);var p=o(e,t,d);p||(t.visible=!1),t._cheater&&d("cheaterslope")}},{"../../components/color/attributes":523,"../../lib":657,"./ab_defaults":839,"./attributes":841,"./xy_defaults":865}],857:[function(e,t){'use strict';t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),plot:e("./plot"),calc:e("./calc"),animatable:!0,isContainer:!0,moduleType:"trace",name:"carpet",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","carpet","carpetAxis","notLegendIsolatable","noMultiCategory","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":718,"./attributes":841,"./calc":845,"./defaults":856,"./plot":862}],858:[function(e,t){'use strict';t.exports=function(e,t){for(var a=e._fullData.length,o=0,r,n;o<a;o++)if(n=e._fullData[o],n.index!==t.index&&"carpet"===n.type&&(r||(r=n),n.carpet===t.carpet))return n;return r}},{}],859:[function(e,t){'use strict';t.exports=function(e,t,a){if(0===e.length)return"";var o=[],r=a?3:1,n;for(n=0;n<e.length;n+=r)o.push(e[n]+","+t[n]),a&&n<e.length-r&&(o.push("C"),o.push([e[n+1]+","+t[n+1],e[n+2]+","+t[n+2]+" "].join(" ")));return o.join(a?"":"L")}},{}],860:[function(e,t){'use strict';var a=e("../../lib").isArrayOrTypedArray;t.exports=function(e,t,o){var r;for(a(e)?e.length>t.length&&(e=e.slice(0,t.length)):e=[],r=0;r<t.length;r++)e[r]=o(t[r]);return e}},{"../../lib":657}],861:[function(e,t){'use strict';var a=Math.atan2,o=Math.sqrt,r=Math.PI,i=Math.max;t.exports=function(e,t,n,l,s,d){var c=s[0]*e.dpdx(t),p=s[1]*e.dpdy(n),u=1,g=1;if(d){var m=o(s[0]*s[0]+s[1]*s[1]),h=o(d[0]*d[0]+d[1]*d[1]),y=(s[0]*d[0]+s[1]*d[1])/m/h;g=i(0,y)}var f=180*a(p,c)/r;return-90>f?(f+=180,u=-u):90<f&&(f-=180,u=-u),{angle:f,flip:u,p:e.c2p(l,t,n),offsetMultplier:g}}},{}],862:[function(e,t){'use strict';var l=Math.cos,s=Math.PI,d=Math.sin,c=Math.max;function a(e,a,t,o,r){var n=t.select("#"+e._clipPathId),l,s,d,c;n.size()||(n=t.append("clipPath").classed("carpetclip",!0));var p=f.ensureSingle(n,"path","carpetboundary"),u=a.clipsegments,h=[];for(c=0;c<u.length;c++)l=u[c],s=g([],l.x,o.c2p),d=g([],l.y,r.c2p),h.push(m(s,d,l.bicubic));var y="M"+h.join("L")+"Z";n.attr("id",e._clipPathId),p.attr("d",y)}function o(e,t,a,o,r,i){var n="const-"+r+"-lines",l=a.selectAll("."+n).data(i);l.enter().append("path").classed(n,!0).style("vector-effect","non-scaling-stroke"),l.each(function(a){var o=a,r=o.x,i=o.y,n=g([],r,e.c2p),l=g([],i,t.c2p),s="M"+m(n,l,o.smoothing),d=p.select(this);d.attr("d",s).style("stroke-width",o.width).style("stroke",o.color).style("fill","none")}),l.exit().remove()}function r(e,a,o,r,i,t,n,g){var m=t.selectAll("text."+g).data(n);m.enter().append("text").classed(g,!0);var f=0,x={};return m.each(function(t,n){var i;if("auto"===t.axis.tickangle)i=h(r,a,o,t.xy,t.dxy);else{var g=(t.axis.tickangle+180)*s/180;i=h(r,a,o,t.xy,[l(g),d(g)])}n||(x={angle:i.angle,flip:i.flip});var m=(t.endAnchor?-1:1)*i.flip,_=p.select(this).attr({"text-anchor":0<m?"start":"end","data-notex":1}).call(u.font,t.font).text(t.text).call(y.convertToTspans,e),b=u.bBox(this);_.attr("transform","translate("+i.p[0]+","+i.p[1]+") rotate("+i.angle+")translate("+t.axis.labelpadding*m+","+.3*b.height+")"),f=c(f,b.width+t.axis.labelpadding)}),m.exit().remove(),x.maxExtent=f,x}function i(e,o,r,i,t,l,s,d){var c=f.aggNums(Math.min,null,r.a),p=f.aggNums(Math.max,null,r.a),u=f.aggNums(Math.min,null,r.b),g=f.aggNums(Math.max,null,r.b),m,y,x,_;m=.5*(c+p),y=u,x=r.ab2xy(m,y,!0),_=r.dxyda_rough(m,y),s.angle===void 0&&f.extendFlat(s,h(r,t,l,x,r.dxydb_rough(m,y))),n(e,o,r,i,x,_,r.aaxis,t,l,s,"a-title"),m=c,y=.5*(u+g),x=r.ab2xy(m,y,!0),_=r.dxydb_rough(m,y),d.angle===void 0&&f.extendFlat(d,h(r,t,l,x,r.dxyda_rough(m,y))),n(e,o,r,i,x,_,r.baxis,t,l,d,"b-title")}function n(e,a,o,r,t,i,n,l,s,d,c){var g=[];n.title.text&&g.push(n.title.text);var m=a.selectAll("text."+c).data(g),f=d.maxExtent;m.enter().append("text").classed(c,!0),m.each(function(){var a=h(o,l,s,t,i);-1===["start","both"].indexOf(n.showticklabels)&&(f=0);var r=n.title.font.size;f+=r+n.title.offset;var c=d.angle+(0>d.flip?180:0),g=(c-a.angle+450)%360,m=p.select(this);m.text(n.title.text).call(y.convertToTspans,e),90<g&&270>g&&(f=(-y.lineCount(m)+b)*_*r-f),m.attr("transform","translate("+a.p[0]+","+a.p[1]+") rotate("+a.angle+") translate(0,"+f+")").classed("user-select-none",!0).attr("text-anchor","middle").call(u.font,n.title.font)}),m.exit().remove()}var p=e("d3"),u=e("../../components/drawing"),g=e("./map_1d_array"),m=e("./makepath"),h=e("./orient_text"),y=e("../../lib/svg_text_utils"),f=e("../../lib"),x=e("../../constants/alignment");t.exports=function(e,t,n,l){var s=t.xaxis,d=t.yaxis,c=e._fullLayout,u=c._clips;f.makeTraceGroups(l,n,"trace").each(function(t){var n=p.select(this),l=t[0],c=l.trace,g=c.aaxis,m=c.baxis,h=f.ensureSingle(n,"g","minorlayer"),y=f.ensureSingle(n,"g","majorlayer"),x=f.ensureSingle(n,"g","boundarylayer"),_=f.ensureSingle(n,"g","labellayer");n.style("opacity",c.opacity),o(s,d,y,g,"a",g._gridlines,!0),o(s,d,y,m,"b",m._gridlines,!0),o(s,d,h,g,"a",g._minorgridlines,!0),o(s,d,h,m,"b",m._minorgridlines,!0),o(s,d,x,g,"a-boundary",g._boundarylines),o(s,d,x,m,"b-boundary",m._boundarylines);var b=r(e,s,d,c,l,_,g._labels,"a-label"),v=r(e,s,d,c,l,_,m._labels,"b-label");i(e,_,c,l,s,d,b,v),a(c,l,u,s,d)})};var _=x.LINE_SPACING,b=(1-x.MID_SHIFT)/_+1},{"../../components/drawing":546,"../../constants/alignment":626,"../../lib":657,"../../lib/svg_text_utils":681,"./makepath":859,"./map_1d_array":860,"./orient_text":861,d3:108}],863:[function(e,t){'use strict';var o=Math.min,r=Math.max,n=Math.floor,l=e("./constants"),s=e("../../lib/search").findBin,d=e("./compute_control_points"),c=e("./create_spline_evaluator"),p=e("./create_i_derivative_evaluator"),u=e("./create_j_derivative_evaluator");t.exports=function(e){var t=e._a,a=e._b,g=t.length,m=a.length,i=e.aaxis,h=e.baxis,y=t[0],f=t[g-1],x=a[0],_=a[m-1],v=t[t.length-1]-t[0],w=a[a.length-1]-a[0],k=v*l.RELATIVE_CULL_TOLERANCE,T=w*l.RELATIVE_CULL_TOLERANCE;y-=k,f+=k,x-=T,_+=T,e.isVisible=function(e,t){return e>y&&e<f&&t>x&&t<_},e.isOccluded=function(e,t){return e<y||e>f||t<x||t>_},e.setScale=function(){var t=e._x,a=e._y,o=d(e._xctrl,e._yctrl,t,a,i.smoothing,h.smoothing);e._xctrl=o[0],e._yctrl=o[1],e.evalxy=c([e._xctrl,e._yctrl],g,m,i.smoothing,h.smoothing),e.dxydi=p([e._xctrl,e._yctrl],i.smoothing,h.smoothing),e.dxydj=u([e._xctrl,e._yctrl],i.smoothing,h.smoothing)},e.i2a=function(e){var a=r(0,n(e[0]),g-2),o=e[0]-a;return(1-o)*t[a]+o*t[a+1]},e.j2b=function(e){var t=r(0,n(e[1]),g-2),o=e[1]-t;return(1-o)*a[t]+o*a[t+1]},e.ij2ab=function(t){return[e.i2a(t[0]),e.j2b(t[1])]},e.a2i=function(e){var a=r(0,o(s(e,t),g-2)),i=t[a],n=t[a+1];return r(0,o(g-1,a+(e-i)/(n-i)))},e.b2j=function(e){var t=r(0,o(s(e,a),m-2)),i=a[t],n=a[t+1];return r(0,o(m-1,t+(e-i)/(n-i)))},e.ab2ij=function(t){return[e.a2i(t[0]),e.b2j(t[1])]},e.i2c=function(t,a){return e.evalxy([],t,a)},e.ab2xy=function(l,s,d){if(!d&&(l<t[0]||l>t[g-1]|s<a[0]||s>a[m-1]))return[!1,!1];var c=e.a2i(l),i=e.b2j(s),p=e.evalxy([],c,i);if(d){var u=0,h=0,y=[],f,x,_,b;l<t[0]?(f=0,x=0,u=(l-t[0])/(t[1]-t[0])):l>t[g-1]?(f=g-2,x=1,u=(l-t[g-1])/(t[g-1]-t[g-2])):(f=r(0,o(g-2,n(c))),x=c-f),s<a[0]?(_=0,b=0,h=(s-a[0])/(a[1]-a[0])):s>a[m-1]?(_=m-2,b=1,h=(s-a[m-1])/(a[m-1]-a[m-2])):(_=r(0,o(m-2,n(i))),b=i-_),u&&(e.dxydi(y,f,_,x,b),p[0]+=y[0]*u,p[1]+=y[1]*u),h&&(e.dxydj(y,f,_,x,b),p[0]+=y[0]*h,p[1]+=y[1]*h)}return p},e.c2p=function(e,t,a){return[t.c2p(e[0]),a.c2p(e[1])]},e.p2x=function(e,t,a){return[t.p2c(e[0]),a.p2c(e[1])]},e.dadi=function(e){var a=r(0,o(t.length-2,e));return t[a+1]-t[a]},e.dbdj=function(e){var t=r(0,o(a.length-2,e));return a[t+1]-a[t]},e.dxyda=function(t,a,o,r){var i=e.dxydi(null,t,a,o,r),n=e.dadi(t,o);return[i[0]/n,i[1]/n]},e.dxydb=function(t,a,o,r){var i=e.dxydj(null,t,a,o,r),n=e.dbdj(a,r);return[i[0]/n,i[1]/n]},e.dxyda_rough=function(t,a,o){var r=v*(o||.1),i=e.ab2xy(t+r,a,!0),n=e.ab2xy(t-r,a,!0);return[.5*(i[0]-n[0])/r,.5*(i[1]-n[1])/r]},e.dxydb_rough=function(t,a,o){var r=w*(o||.1),i=e.ab2xy(t,a+r,!0),n=e.ab2xy(t,a-r,!0);return[.5*(i[0]-n[0])/r,.5*(i[1]-n[1])/r]},e.dpdx=function(e){return e._m},e.dpdy=function(e){return e._m}}},{"../../lib/search":676,"./compute_control_points":851,"./constants":852,"./create_i_derivative_evaluator":853,"./create_j_derivative_evaluator":854,"./create_spline_evaluator":855}],864:[function(e,t){'use strict';var o=Math.sqrt,r=Math.min,n=Math.abs,l=Math.max,s=e("../../lib");t.exports=function(e,t,a){function p(t,a){var o=0,r=0,i;return 0<t&&void 0!==(i=e[a][t-1])&&(r++,o+=i),t<m-1&&void 0!==(i=e[a][t+1])&&(r++,o+=i),0<a&&void 0!==(i=e[a-1][t])&&(r++,o+=i),a<h-1&&void 0!==(i=e[a+1][t])&&(r++,o+=i),o/l(1,r)}var u=[],g=[],m=e[0].length,h=e.length,y=0,f,x,_;for(f=0;f<m;f++)for(x=0;x<h;x++)void 0===e[x][f]&&(u.push(f),g.push(x),e[x][f]=p(f,x)),y=l(y,n(e[x][f]));if(!u.length)return e;var b=0,v=0,w=u.length,T,A,S,C,L,E,I,P,z,D,O;do{for(b=0,_=0;_<w;_++){f=u[_],x=g[_];var R=0,M=0,B,F,N,V,U,H;0===f?(U=r(m-1,2),N=t[U],V=t[1],B=e[x][U],F=e[x][1],M+=F+(F-B)*(t[0]-V)/(V-N),R++):f===m-1&&(U=l(0,m-3),N=t[U],V=t[m-2],B=e[x][U],F=e[x][m-2],M+=F+(F-B)*(t[m-1]-V)/(V-N),R++),(0===f||f===m-1)&&0<x&&x<h-1&&(T=a[x+1]-a[x],A=a[x]-a[x-1],M+=(A*e[x+1][f]+T*e[x-1][f])/(A+T),R++),0===x?(H=r(h-1,2),N=a[H],V=a[1],B=e[H][f],F=e[1][f],M+=F+(F-B)*(a[0]-V)/(V-N),R++):x===h-1&&(H=l(0,h-3),N=a[H],V=a[h-2],B=e[H][f],F=e[h-2][f],M+=F+(F-B)*(a[h-1]-V)/(V-N),R++),(0===x||x===h-1)&&0<f&&f<m-1&&(T=t[f+1]-t[f],A=t[f]-t[f-1],M+=(A*e[x][f+1]+T*e[x][f-1])/(A+T),R++),R?M/=R:(S=t[f+1]-t[f],C=t[f]-t[f-1],L=a[x+1]-a[x],E=a[x]-a[x-1],I=S*C*(S+C),P=L*E*(L+E),M=(I*(E*e[x+1][f]+L*e[x-1][f])+P*(C*e[x][f+1]+S*e[x][f-1]))/(P*(C+S)+I*(E+L))),z=M-e[x][f],D=z/y,b+=D*D,O=R?0:.85,e[x][f]+=z*(1+O)}b=o(b)}while(v++<100&&b>1e-5);return s.log("Smoother converged to",b,"after",v,"iterations"),e}},{"../../lib":657}],865:[function(e,t){'use strict';var a=Math.min,o=e("../../lib").isArray1D;t.exports=function(e,t,r){var i=r("x"),n=i&&i.length,l=r("y"),s=l&&l.length;if(!n&&!s)return!1;if(t._cheater=!i,(!n||o(i))&&(!s||o(l))){var d=n?i.length:1/0;s&&(d=a(d,l.length)),t.a&&t.a.length&&(d=a(d,t.a.length)),t.b&&t.b.length&&(d=a(d,t.b.length)),t._length=d}else t._length=null;return!0}},{"../../lib":657}],866:[function(e,t){'use strict';var a=e("../../plots/template_attributes").hovertemplateAttrs,o=e("../scattergeo/attributes"),r=e("../../components/colorscale/attributes"),i=e("../../plots/attributes"),n=e("../../components/color/attributes").defaultLine,l=e("../../lib/extend").extendFlat,s=o.marker.line;t.exports=l({locations:{valType:"data_array",editType:"calc"},locationmode:o.locationmode,z:{valType:"data_array",editType:"calc"},geojson:l({},o.geojson,{}),featureidkey:o.featureidkey,text:l({},o.text,{}),hovertext:l({},o.hovertext,{}),marker:{line:{color:l({},s.color,{dflt:n}),width:l({},s.width,{dflt:1}),editType:"calc"},opacity:{valType:"number",arrayOk:!0,min:0,max:1,dflt:1,editType:"style"},editType:"calc"},selected:{marker:{opacity:o.selected.marker.opacity,editType:"plot"},editType:"plot"},unselected:{marker:{opacity:o.unselected.marker.opacity,editType:"plot"},editType:"plot"},hoverinfo:l({},i.hoverinfo,{editType:"calc",flags:["location","z","text","name"]}),hovertemplate:a(),showlegend:l({},i.showlegend,{dflt:!1})},r("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/color/attributes":523,"../../components/colorscale/attributes":531,"../../lib/extend":648,"../../plots/attributes":702,"../../plots/template_attributes":783,"../scattergeo/attributes":1103}],867:[function(e,t){'use strict';function a(e){return e&&"string"==typeof e}var o=e("fast-isnumeric"),r=e("../../constants/numerical").BADNUM,n=e("../../components/colorscale/calc"),l=e("../scatter/arrays_to_calcdata"),s=e("../scatter/calc_selection");t.exports=function(e,t){var d=t._length,c=Array(d),p;p=t.geojson?function(e){return a(e)||o(e)}:a;for(var u=0;u<d;u++){var g=c[u]={},m=t.locations[u],h=t.z[u];p(m)&&o(h)?(g.loc=m,g.z=h):(g.loc=null,g.z=r),g.index=u}return l(c,t),n(e,t,{vals:t.z,containerStr:"",cLetter:"z"}),s(c,t),c}},{"../../components/colorscale/calc":532,"../../constants/numerical":633,"../scatter/arrays_to_calcdata":1061,"../scatter/calc_selection":1064,"fast-isnumeric":201}],868:[function(e,t){'use strict';var a=e("../../lib"),o=e("../../components/colorscale/defaults"),r=e("./attributes");t.exports=function(e,t,i,n){function l(o,i){return a.coerce(e,t,r,o,i)}var s=l("locations"),d=l("z");if(!(s&&s.length&&a.isArrayOrTypedArray(d)&&d.length))return void(t.visible=!1);t._length=Math.min(s.length,d.length);var c=l("geojson"),p;("string"==typeof c&&""!==c||a.isPlainObject(c))&&(p="geojson-id");var u=l("locationmode",p);"geojson-id"===u&&l("featureidkey"),l("text"),l("hovertext"),l("hovertemplate");var g=l("marker.line.width");g&&l("marker.line.color"),l("marker.opacity"),o(e,t,n,l,{prefix:"",cLetter:"z"}),a.coerceSelectionMarkerOpacity(t,l)}},{"../../components/colorscale/defaults":534,"../../lib":657,"./attributes":866}],869:[function(e,t){'use strict';t.exports=function(e,t,a,o,r){e.location=t.location,e.z=t.z;var i=o[r];return i.fIn&&i.fIn.properties&&(e.properties=i.fIn.properties),e.ct=i.ct,e}},{}],870:[function(e,t){'use strict';function a(e,t,a){if(!t.hovertemplate){var o=a.hi||t.hoverinfo,n=a.loc+"",l="all"===o?r.hoverinfo.flags:o.split("+"),s=-1!==l.indexOf("name"),d=-1!==l.indexOf("location"),c=-1!==l.indexOf("z"),p=-1!==l.indexOf("text"),u=[];!s&&d?e.nameOverride=n:(s&&(e.nameOverride=t.name),d&&u.push(n)),c&&u.push(e.zLabel),p&&i(a,t,u),e.extraText=u.join("<br>")}}var o=e("../../plots/cartesian/axes"),r=e("./attributes"),i=e("../../lib").fillText;t.exports=function(e,t,r){var n=e.cd,l=n[0].trace,s=e.subplot,d,c,p,u;for(c=0;c<n.length;c++)if(d=n[c],u=!1,d._polygons){for(p=0;p<d._polygons.length;p++)d._polygons[p].contains([t,r])&&(u=!u),d._polygons[p].contains([t+360,r])&&(u=!u);if(u)break}if(u&&d)return e.x0=e.x1=e.xa.c2p(d.ct),e.y0=e.y1=e.ya.c2p(d.ct),e.index=d.index,e.location=d.loc,e.z=d.z,e.zLabel=o.tickText(s.mockAxis,s.mockAxis.c2l(d.z),"hover").text,e.hovertemplate=d.hovertemplate,a(e,l,d,s.mockAxis),[e]}},{"../../lib":657,"../../plots/cartesian/axes":705,"./attributes":866}],871:[function(e,t){'use strict';t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../heatmap/colorbar"),calc:e("./calc"),calcGeoJSON:e("./plot").calcGeoJSON,plot:e("./plot").plot,style:e("./style").style,styleOnSelect:e("./style").styleOnSelect,hoverPoints:e("./hover"),eventData:e("./event_data"),selectPoints:e("./select"),moduleType:"trace",name:"choropleth",basePlotModule:e("../../plots/geo"),categories:["geo","noOpacity","showLegend"],meta:{}}},{"../../plots/geo":737,"../heatmap/colorbar":945,"./attributes":866,"./calc":867,"./defaults":868,"./event_data":869,"./hover":870,"./plot":872,"./select":873,"./style":874}],872:[function(e,t){'use strict';var a=e("d3"),o=e("../../lib"),r=e("../../lib/geo_location_utils"),n=e("../../lib/topojson_utils").getTopojsonFeatures,l=e("../../plots/cartesian/autorange").findExtremes,s=e("./style").style;t.exports={calcGeoJSON:function(e,t){for(var a=e[0].trace,o=t[a.geo],s=o._subplot,d=a.locationmode,c=a._length,p="geojson-id"===d?r.extractTraceFeature(e):n(a,s.topojson),u=[],g=[],m=0;m<c;m++){var h=e[m],y="geojson-id"===d?h.fOut:r.locationToFeature(d,h.loc,p);if(y){h.geojson=y,h.ct=y.properties.ct,h._polygons=r.feature2polygons(y);var f=r.computeBbox(y);u.push(f[0],f[2]),g.push(f[1],f[3])}else h.geojson=null}if("geojson"===o.fitbounds&&"geojson-id"===d){var x=r.computeBbox(r.getTraceGeojson(a));u=[x[0],x[2]],g=[x[1],x[3]]}var _={padded:!0};a._extremes.lon=l(o.lonaxis._ax,u,_),a._extremes.lat=l(o.lataxis._ax,g,_)},plot:function(e,t,r){var i=t.layers.backplot.select(".choroplethlayer");o.makeTraceGroups(i,r,"trace choropleth").each(function(t){var r=a.select(this),i=r.selectAll("path.choroplethlocation").data(o.identity);i.enter().append("path").classed("choroplethlocation",!0),i.exit().remove(),s(e,t)})}}},{"../../lib":657,"../../lib/geo_location_utils":651,"../../lib/topojson_utils":684,"../../plots/cartesian/autorange":704,"./style":874,d3:108}],873:[function(e,t){'use strict';t.exports=function(e,t){var a=e.cd,o=e.xaxis,r=e.yaxis,n=[],l,s,d,c,p;if(!1===t)for(l=0;l<a.length;l++)a[l].selected=0;else for(l=0;l<a.length;l++)s=a[l],d=s.ct,d&&(c=o.c2p(d),p=r.c2p(d),t.contains([c,p],null,l,e)?(n.push({pointNumber:l,lon:d[0],lat:d[1]}),s.selected=1):s.selected=0);return n}},{}],874:[function(e,t){'use strict';function a(e,t){var a=t[0].trace,l=t[0].node3,s=l.selectAll(".choroplethlocation"),c=a.marker||{},p=c.line||{},u=n.makeColorScaleFuncFromTrace(a);s.each(function(e){o.select(this).attr("fill",u(e.z)).call(r.stroke,e.mlc||p.color).call(i.dashLine,"",e.mlw||p.width||0).style("opacity",c.opacity)}),i.selectedPointStyle(s,a,e)}var o=e("d3"),r=e("../../components/color"),i=e("../../components/drawing"),n=e("../../components/colorscale");t.exports={style:function(e,t){t&&a(e,t)},styleOnSelect:function(e,t){var o=t[0].node3,r=t[0].trace;r.selectedpoints?i.selectedPointStyle(o.selectAll(".choroplethlocation"),r,e):a(e,t)}}},{"../../components/color":524,"../../components/colorscale":536,"../../components/drawing":546,d3:108}],875:[function(e,t){'use strict';var a=e("../choropleth/attributes"),o=e("../../components/colorscale/attributes"),r=e("../../plots/template_attributes").hovertemplateAttrs,i=e("../../plots/attributes"),n=e("../../lib/extend").extendFlat;t.exports=n({locations:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},geojson:{valType:"any",editType:"calc"},featureidkey:n({},a.featureidkey,{}),below:{valType:"string",editType:"plot"},text:a.text,hovertext:a.hovertext,marker:{line:{color:n({},a.marker.line.color,{editType:"plot"}),width:n({},a.marker.line.width,{editType:"plot"}),editType:"calc"},opacity:n({},a.marker.opacity,{editType:"plot"}),editType:"calc"},selected:{marker:{opacity:n({},a.selected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},unselected:{marker:{opacity:n({},a.unselected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},hoverinfo:a.hoverinfo,hovertemplate:r({},{keys:["properties"]}),showlegend:n({},i.showlegend,{dflt:!1})},o("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":531,"../../lib/extend":648,"../../plots/attributes":702,"../../plots/template_attributes":783,"../choropleth/attributes":866}],876:[function(e,t){'use strict';function a(e){var t=e[0].trace,a=t._opts,o;if(t.selectedpoints){for(var n=l.makeSelectedPointStyleFns(t),s=0,d;s<e.length;s++)d=e[s],d.fOut&&(d.fOut.properties.mo2=n.selectedOpacityFn(d));o={type:"identity",property:"mo2"}}else o=r.isArrayOrTypedArray(t.marker.opacity)?{type:"identity",property:"mo"}:t.marker.opacity;return r.extendFlat(a.fill.paint,{"fill-opacity":o}),r.extendFlat(a.line.paint,{"line-opacity":o}),a}var o=e("fast-isnumeric"),r=e("../../lib"),n=e("../../components/colorscale"),l=e("../../components/drawing"),s=e("../../lib/geojson_utils").makeBlank,d=e("../../lib/geo_location_utils");t.exports={convert:function(e){var t=e[0].trace,l=!0===t.visible&&0!==t._length,c={layout:{visibility:"none"},paint:{}},p={layout:{visibility:"none"},paint:{}},u=t._opts={fill:c,line:p,geojson:s()};if(!l)return u;var g=d.extractTraceFeature(e);if(!g)return u;var m=n.makeColorScaleFuncFromTrace(t),h=t.marker,y=h.line||{},f;r.isArrayOrTypedArray(h.opacity)&&(f=function(e){var t=e.mo;return o(t)?+r.constrain(t,0,1):0});var x;r.isArrayOrTypedArray(y.color)&&(x=function(e){return e.mlc});var _;r.isArrayOrTypedArray(y.width)&&(_=function(e){return e.mlw});for(var b=0;b<e.length;b++){var v=e[b],w=v.fOut;if(w){var k=w.properties;k.fc=m(v.z),f&&(k.mo=f(v)),x&&(k.mlc=x(v)),_&&(k.mlw=_(v)),v.ct=k.ct,v._polygons=d.feature2polygons(w)}}var T=f?{type:"identity",property:"mo"}:h.opacity;return r.extendFlat(c.paint,{"fill-color":{type:"identity",property:"fc"},"fill-opacity":T}),r.extendFlat(p.paint,{"line-color":x?{type:"identity",property:"mlc"}:y.color,"line-width":_?{type:"identity",property:"mlw"}:y.width,"line-opacity":T}),c.layout.visibility="visible",p.layout.visibility="visible",u.geojson={type:"FeatureCollection",features:g},a(e),u},convertOnSelect:a}},{"../../components/colorscale":536,"../../components/drawing":546,"../../lib":657,"../../lib/geo_location_utils":651,"../../lib/geojson_utils":652,"fast-isnumeric":201}],877:[function(e,t){'use strict';var a=e("../../lib"),o=e("../../components/colorscale/defaults"),r=e("./attributes");t.exports=function(e,t,i,n){function l(o,i){return a.coerce(e,t,r,o,i)}var s=l("locations"),d=l("z"),c=l("geojson");if(!a.isArrayOrTypedArray(s)||!s.length||!a.isArrayOrTypedArray(d)||!d.length||!("string"==typeof c&&""!==c||a.isPlainObject(c)))return void(t.visible=!1);l("featureidkey"),t._length=Math.min(s.length,d.length),l("below"),l("text"),l("hovertext"),l("hovertemplate");var p=l("marker.line.width");p&&l("marker.line.color"),l("marker.opacity"),o(e,t,n,l,{prefix:"",cLetter:"z"}),a.coerceSelectionMarkerOpacity(t,l)}},{"../../components/colorscale/defaults":534,"../../lib":657,"./attributes":875}],878:[function(e,t){'use strict';t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../heatmap/colorbar"),calc:e("../choropleth/calc"),plot:e("./plot"),hoverPoints:e("../choropleth/hover"),eventData:e("../choropleth/event_data"),selectPoints:e("../choropleth/select"),styleOnSelect:function(e,t){if(t){var a=t[0].trace;a._glTrace.updateOnSelect(t)}},getBelow:function(e,t){for(var a=t.getMapLayers(),o=a.length-2,r;0<=o;o--)if(r=a[o].id,"string"==typeof r&&0===r.indexOf("water"))for(var n=o+1;n<a.length;n++)if(r=a[n].id,"string"==typeof r&&-1===r.indexOf("plotly-"))return r},moduleType:"trace",name:"choroplethmapbox",basePlotModule:e("../../plots/mapbox"),categories:["mapbox","gl","noOpacity","showLegend"],meta:{hr_name:"choropleth_mapbox"}}},{"../../plots/mapbox":762,"../choropleth/calc":867,"../choropleth/event_data":869,"../choropleth/hover":870,"../choropleth/select":873,"../heatmap/colorbar":945,"./attributes":875,"./defaults":877,"./plot":879}],879:[function(e,t){'use strict';function a(e,t){this.type="choroplethmapbox",this.subplot=e,this.uid=t,this.sourceId="source-"+t,this.layerList=[["fill",i+t+"-fill"],["line",i+t+"-line"]],this.below=null}var o=e("./convert").convert,r=e("./convert").convertOnSelect,i=e("../../plots/mapbox/constants").traceLayerPrefix,n=a.prototype;n.update=function(e){this._update(o(e))},n.updateOnSelect=function(e){this._update(r(e))},n._update=function(e){var t=this.subplot,a=this.layerList,o=t.belowLookup["trace-"+this.uid];t.map.getSource(this.sourceId).setData(e.geojson),o!==this.below&&(this._removeLayers(),this._addLayers(e,o),this.below=o);for(var r=0;r<a.length;r++){var n=a[r],l=n[0],s=n[1],d=e[l];t.setOptions(s,"setLayoutProperty",d.layout),"visible"===d.layout.visibility&&t.setOptions(s,"setPaintProperty",d.paint)}},n._addLayers=function(e,t){for(var a=this.subplot,o=this.layerList,r=this.sourceId,n=0;n<o.length;n++){var l=o[n],s=l[0],d=e[s];a.addLayer({type:s,id:l[1],source:r,layout:d.layout,paint:d.paint},t)}},n._removeLayers=function(){for(var e=this.subplot.map,t=this.layerList,a=t.length-1;0<=a;a--)e.removeLayer(t[a][1])},n.dispose=function(){var e=this.subplot.map;this._removeLayers(),e.removeSource(this.sourceId)},t.exports=function(e,t){var r=t[0].trace,i=new a(e,r.uid),n=i.sourceId,l=o(t),s=i.below=e.belowLookup["trace-"+r.uid];return e.map.addSource(n,{type:"geojson",data:l.geojson}),i._addLayers(l,s),t[0].trace._glTrace=i,i}},{"../../plots/mapbox/constants":760,"./convert":876}],880:[function(e,t){'use strict';var a=e("../../components/colorscale/attributes"),o=e("../../plots/template_attributes").hovertemplateAttrs,r=e("../mesh3d/attributes"),i=e("../../plots/attributes"),n=e("../../lib/extend").extendFlat,l={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},sizemode:{valType:"enumerated",values:["scaled","absolute"],editType:"calc",dflt:"scaled"},sizeref:{valType:"number",editType:"calc",min:0},anchor:{valType:"enumerated",editType:"calc",values:["tip","tail","cm","center"],dflt:"cm"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:o({editType:"calc"},{keys:["norm"]}),showlegend:n({},i.showlegend,{dflt:!1})};n(l,a("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"}));["opacity","lightposition","lighting"].forEach(function(e){l[e]=r[e]}),l.hoverinfo=n({},i.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","text","name"],dflt:"x+y+z+norm+text+name"}),l.transforms=void 0,t.exports=l},{"../../components/colorscale/attributes":531,"../../lib/extend":648,"../../plots/attributes":702,"../../plots/template_attributes":783,"../mesh3d/attributes":1003}],881:[function(e,t){'use strict';var a=Math.min,o=e("../../components/colorscale/calc");t.exports=function(e,t){for(var r=t.u,n=t.v,l=t.w,s=a(t.x.length,t.y.length,t.z.length,r.length,n.length,l.length),d=-Infinity,c=1/0,p=0;p<s;p++){var u=r[p],g=n[p],m=l[p],h=Math.sqrt(u*u+g*g+m*m);d=Math.max(d,h),c=a(c,h)}t._len=s,t._normMax=d,o(e,t,{vals:[c,d],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":532}],882:[function(e,t){'use strict';var r=Math.sqrt;function a(e,t){this.scene=e,this.uid=t,this.mesh=null,this.data=null}function o(e,t){function a(e,t){var a=o[t],i=r[u[t]];return l(e,function(e){return a.d2l(e)*i})}var o=e.fullSceneLayout,r=e.dataScale,n={};n.vectors=c(a(t.u,"xaxis"),a(t.v,"yaxis"),a(t.w,"zaxis"),t._len),n.positions=c(a(t.x,"xaxis"),a(t.y,"yaxis"),a(t.z,"zaxis"),t._len);var p=d(t);n.colormap=s(t),n.vertexIntensityBounds=[p.min/t._normMax,p.max/t._normMax],n.coneOffset=g[t.anchor],n.coneSize="scaled"===t.sizemode?t.sizeref||.5:t.sizeref&&t._normMax?t.sizeref/t._normMax:.5;var h=i(n),y=t.lightposition;return h.lightPosition=[y.x,y.y,y.z],h.ambient=t.lighting.ambient,h.diffuse=t.lighting.diffuse,h.specular=t.lighting.specular,h.roughness=t.lighting.roughness,h.fresnel=t.lighting.fresnel,h.opacity=t.opacity,t._pad=m[t.anchor]*h.vectorScale*h.coneScale*t._normMax,h}var i=e("gl-cone3d"),n=e("gl-cone3d").createConeMesh,l=e("../../lib").simpleMap,s=e("../../lib/gl_format_color").parseColorScale,d=e("../../components/colorscale").extractOpts,c=e("../../plots/gl3d/zip3"),p=a.prototype;p.handlePick=function(e){if(e.object===this.mesh){var t=e.index=e.data.index,a=this.data.x[t],o=this.data.y[t],i=this.data.z[t],n=this.data.u[t],l=this.data.v[t],s=this.data.w[t];e.traceCoordinate=[a,o,i,n,l,s,r(n*n+l*l+s*s)];var d=this.data.hovertext||this.data.text;return Array.isArray(d)&&void 0!==d[t]?e.textLabel=d[t]:d&&(e.textLabel=d),!0}};var u={xaxis:0,yaxis:1,zaxis:2},g={tip:1,tail:0,cm:.25,center:.5},m={tip:1,tail:1,cm:.75,center:.5};p.update=function(e){this.data=e;var t=o(this.scene,e);this.mesh.update(t)},p.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},t.exports=function(e,t){var r=e.glplot.gl,i=o(e,t),l=n(r,i),s=new a(e,t.uid);return s.mesh=l,s.data=t,l._trace=s,e.glplot.add(l),s}},{"../../components/colorscale":536,"../../lib":657,"../../lib/gl_format_color":654,"../../plots/gl3d/zip3":758,"gl-cone3d":221}],883:[function(e,t){'use strict';var a=e("../../lib"),o=e("../../components/colorscale/defaults"),r=e("./attributes");t.exports=function(e,t,i,n){function l(o,i){return a.coerce(e,t,r,o,i)}var s=l("u"),d=l("v"),c=l("w"),p=l("x"),u=l("y"),g=l("z");return s&&s.length&&d&&d.length&&c&&c.length&&p&&p.length&&u&&u.length&&g&&g.length?void(l("sizeref"),l("sizemode"),l("anchor"),l("lighting.ambient"),l("lighting.diffuse"),l("lighting.specular"),l("lighting.roughness"),l("lighting.fresnel"),l("lightposition.x"),l("lightposition.y"),l("lightposition.z"),o(e,t,n,l,{prefix:"",cLetter:"c"}),l("text"),l("hovertext"),l("hovertemplate"),t._length=null):void(t.visible=!1)}},{"../../components/colorscale/defaults":534,"../../lib":657,"./attributes":880}],884:[function(e,t){'use strict';t.exports={moduleType:"trace",name:"cone",basePlotModule:e("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:e("./calc"),plot:e("./convert"),eventData:function(e,t){return e.norm=t.traceCoordinate[6],e},meta:{}}},{"../../plots/gl3d":747,"./attributes":880,"./calc":881,"./convert":882,"./defaults":883}],885:[function(e,t){'use strict';var a=e("../heatmap/attributes"),o=e("../scatter/attributes"),r=e("../../components/colorscale/attributes"),i=e("../../components/drawing/attributes").dash,n=e("../../plots/font_attributes"),l=e("../../lib/extend").extendFlat,s=e("../../constants/filter_ops"),d=s.COMPARISON_OPS2,c=s.INTERVAL_OPS,p=e("../../constants/docs").FORMAT_LINK,u=o.line;t.exports=l({z:a.z,x:a.x,x0:a.x0,dx:a.dx,y:a.y,y0:a.y0,dy:a.dy,text:a.text,hovertext:a.hovertext,transpose:a.transpose,xtype:a.xtype,ytype:a.ytype,zhoverformat:a.zhoverformat,hovertemplate:a.hovertemplate,hoverongaps:a.hoverongaps,connectgaps:l({},a.connectgaps,{}),fillcolor:{valType:"color",editType:"calc"},autocontour:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"contours.start":void 0,"contours.end":void 0,"contours.size":void 0}},ncontours:{valType:"integer",dflt:15,min:1,editType:"calc"},contours:{type:{valType:"enumerated",values:["levels","constraint"],dflt:"levels",editType:"calc"},start:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},end:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},size:{valType:"number",dflt:null,min:0,editType:"plot",impliedEdits:{"^autocontour":!1}},coloring:{valType:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill",editType:"calc"},showlines:{valType:"boolean",dflt:!0,editType:"plot"},showlabels:{valType:"boolean",dflt:!1,editType:"plot"},labelfont:n({editType:"plot",colorEditType:"style"}),labelformat:{valType:"string",dflt:"",editType:"plot"},operation:{valType:"enumerated",values:[].concat(d).concat(c),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},editType:"calc",impliedEdits:{autocontour:!1}},line:{color:l({},u.color,{editType:"style+colorbars"}),width:{valType:"number",min:0,editType:"style+colorbars"},dash:i,smoothing:l({},u.smoothing,{}),editType:"plot"}},r("",{cLetter:"z",autoColorDflt:!1,editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":531,"../../components/drawing/attributes":545,"../../constants/docs":628,"../../constants/filter_ops":629,"../../lib/extend":648,"../../plots/font_attributes":733,"../heatmap/attributes":942,"../scatter/attributes":1062}],886:[function(e,t){'use strict';var a=Math.floor,o=e("../../components/colorscale"),r=e("../heatmap/calc"),i=e("./set_contours"),n=e("./end_plus");t.exports=function(e,t){var l=r(e,t),s=l[0].z;i(t,s);var d=t.contours,c=o.extractOpts(t),p;if("heatmap"===d.coloring&&c.auto&&!1===t.autocontour){var u=d.start,g=n(d),m=d.size||1,h=a((g-u)/m)+1;isFinite(m)||(m=1,h=1);var y=u-m/2,f=y+h*m;p=[y,f]}else p=s;return o.calc(e,t,{vals:p,cLetter:"z"}),l}},{"../../components/colorscale":536,"../heatmap/calc":943,"./end_plus":896,"./set_contours":904}],887:[function(e,t){'use strict';var a=Math.min,o=Math.max;t.exports=function(e,t){var r=e[0],n=r.z,l;switch(t.type){case"levels":var s=a(n[0][0],n[0][1]);for(l=0;l<e.length;l++){var d=e[l];d.prefixBoundary=!d.edgepaths.length&&(s>d.level||d.starts.length&&s===d.level)}break;case"constraint":if(r.prefixBoundary=!1,r.edgepaths.length)return;var c=r.x.length,p=r.y.length,u=-Infinity,g=1/0;for(l=0;l<p;l++)g=a(g,n[l][0]),g=a(g,n[l][c-1]),u=o(u,n[l][0]),u=o(u,n[l][c-1]);for(l=1;l<c-1;l++)g=a(g,n[0][l]),g=a(g,n[p-1][l]),u=o(u,n[0][l]),u=o(u,n[p-1][l]);var m=t.value,h,y;switch(t._operation){case">":m>u&&(r.prefixBoundary=!0);break;case"<":(m<g||r.starts.length&&m===g)&&(r.prefixBoundary=!0);break;case"[]":h=a(m[0],m[1]),y=o(m[0],m[1]),(y<g||h>u||r.starts.length&&y===g)&&(r.prefixBoundary=!0);break;case"][":h=a(m[0],m[1]),y=o(m[0],m[1]),h<g&&y>u&&(r.prefixBoundary=!0);}}}},{}],888:[function(e,t){'use strict';var a=e("../../components/colorscale"),o=e("./make_color_map"),r=e("./end_plus");t.exports={min:"zmin",max:"zmax",calc:function(e,t,i){var n=t.contours,l=t.line,s=n.size||1,d=n.coloring,c=o(t,{isColorbar:!0});if("heatmap"===d){var p=a.extractOpts(t);i._fillgradient=p.reversescale?a.flipScale(p.colorscale):p.colorscale,i._zrange=[p.min,p.max]}else"fill"===d&&(i._fillcolor=c);i._line={color:"lines"===d?c:l.color,width:!1===n.showlines?0:l.width,dash:l.dash},i._levels={start:n.start,end:r(n),size:s}}}},{"../../components/colorscale":536,"./end_plus":896,"./make_color_map":901}],889:[function(e,t){'use strict';t.exports={BOTTOMSTART:[1,9,13,104,713],TOPSTART:[4,6,7,104,713],LEFTSTART:[8,12,14,208,1114],RIGHTSTART:[2,3,11,208,1114],NEWDELTA:[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],CHOOSESADDLE:{104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},SADDLEREMAINDER:{1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11},LABELDISTANCE:2,LABELINCREASE:10,LABELMIN:3,LABELMAX:10,LABELOPTIMIZER:{EDGECOST:1,ANGLECOST:1,NEIGHBORCOST:5,SAMELEVELFACTOR:10,SAMELEVELDISTANCE:5,MAXCOST:100,INITIALSEARCHPOINTS:10,ITERATIONS:5}}},{}],890:[function(e,t){'use strict';function a(e,t){var a;-1===c.indexOf(t.operation)?(e("contours.value",[0,1]),Array.isArray(t.value)?2<t.value.length?t.value=t.value.slice(2):0===t.length?t.value=[0,1]:2>t.length?(a=parseFloat(t.value[0]),t.value=[a,a+1]):t.value=[parseFloat(t.value[0]),parseFloat(t.value[1])]:o(t.value)&&(a=parseFloat(t.value),t.value=[a,a+1])):(e("contours.value",0),!o(t.value)&&(Array.isArray(t.value)?t.value=parseFloat(t.value[0]):t.value=0))}var o=e("fast-isnumeric"),r=e("./label_defaults"),i=e("../../components/color"),n=i.addOpacity,l=i.opacity,s=e("../../constants/filter_ops"),d=s.CONSTRAINT_REDUCTION,c=s.COMPARISON_OPS2;t.exports=function(e,t,o,i,s,c){var p=t.contours,u=o("contours.operation"),g,m,h;if(p._operation=d[u],a(o,p),"="===u?g=p.showlines=!0:(g=o("contours.showlines"),h=o("fillcolor",n((e.line||{}).color||s,.5))),g){var y=h&&l(h)?n(t.fillcolor,1):s;m=o("line.color",y),o("line.width",2),o("line.dash")}o("line.smoothing"),r(o,i,m,c)}},{"../../components/color":524,"../../constants/filter_ops":629,"./label_defaults":900,"fast-isnumeric":201}],891:[function(e,t){'use strict';function a(e,t){function a(e){return n(e)?+e:null}var o=Array.isArray(t),r;return-1===i.COMPARISON_OPS2.indexOf(e)?-1===i.INTERVAL_OPS.indexOf(e)?-1!==i.SET_OPS.indexOf(e)&&(r=o?t.map(a):[a(t)]):r=o?[a(t[0]),a(t[1])]:[a(t),a(t)]:r=o?a(t[0]):a(t),r}function o(e){return function(t){t=a(e,t);var o=Math.min(t[0],t[1]),r=Math.max(t[0],t[1]);return{start:o,end:r,size:r-o}}}function r(e){return function(t){return t=a(e,t),{start:t,end:1/0,size:1/0}}}var i=e("../../constants/filter_ops"),n=e("fast-isnumeric");t.exports={"[]":o("[]"),"][":o("]["),">":r(">"),"<":r("<"),"=":r("=")}},{"../../constants/filter_ops":629,"fast-isnumeric":201}],892:[function(e,t){'use strict';t.exports=function(e,t,a,o){var r=o("contours.start"),i=o("contours.end"),n=a("contours.size"),l;l=!1===r||!1===i?t.autocontour=!0:a("autocontour",!1),(l||!n)&&a("ncontours")}},{}],893:[function(e,t){'use strict';function a(e){return o.extendFlat({},e,{edgepaths:o.extendDeep([],e.edgepaths),paths:o.extendDeep([],e.paths),starts:o.extendDeep([],e.starts)})}var o=e("../../lib");t.exports=function(e,t){var r=function(e){return e.reverse()},n=function(e){return e},l,s,d;switch(t){case"=":case"<":return e;case">":for(1!==e.length&&o.warn("Contour data invalid for the specified inequality operation."),s=e[0],l=0;l<s.edgepaths.length;l++)s.edgepaths[l]=r(s.edgepaths[l]);for(l=0;l<s.paths.length;l++)s.paths[l]=r(s.paths[l]);for(l=0;l<s.starts.length;l++)s.starts[l]=r(s.starts[l]);return e;case"][":var c=r;r=n,n=c;case"[]":for(2!==e.length&&o.warn("Contour data invalid for the specified inequality range operation."),s=a(e[0]),d=a(e[1]),l=0;l<s.edgepaths.length;l++)s.edgepaths[l]=r(s.edgepaths[l]);for(l=0;l<s.paths.length;l++)s.paths[l]=r(s.paths[l]);for(l=0;l<s.starts.length;l++)s.starts[l]=r(s.starts[l]);for(;d.edgepaths.length;)s.edgepaths.push(n(d.edgepaths.shift()));for(;d.paths.length;)s.paths.push(n(d.paths.shift()));for(;d.starts.length;)s.starts.push(n(d.starts.shift()));return[s];}}},{"../../lib":657}],894:[function(e,t){'use strict';var a=e("../../lib"),o=e("../heatmap/xyz_defaults"),r=e("./constraint_defaults"),i=e("./contours_defaults"),n=e("./style_defaults"),l=e("./attributes");t.exports=function(e,t,s,d){function c(o,r){return a.coerce(e,t,l,o,r)}var p=o(e,t,c,d);if(!p)return void(t.visible=!1);c("text"),c("hovertext"),c("hovertemplate"),c("hoverongaps");var u="constraint"===c("contours.type");c("connectgaps",a.isArray1D(t.z)),u?r(e,t,c,d,s):(i(e,t,c,function(o){return a.coerce2(e,t,l,o)}),n(e,t,c,d))}},{"../../lib":657,"../heatmap/xyz_defaults":956,"./attributes":885,"./constraint_defaults":890,"./contours_defaults":892,"./style_defaults":906}],895:[function(e,t){'use strict';var a=e("../../lib"),o=e("./constraint_mapping"),r=e("./end_plus");t.exports=function(e,t,i){for(var n="constraint"===e.type?o[e._operation](e.value):e,l=n.size,s=[],d=r(n),c=i.trace._carpetTrace,p=c?{xaxis:c.aaxis,yaxis:c.baxis,x:i.a,y:i.b}:{xaxis:t.xaxis,yaxis:t.yaxis,x:i.x,y:i.y},u=n.start;u<d;u+=l)if(s.push(a.extendFlat({level:u,crossings:{},starts:[],edgepaths:[],paths:[],z:i.z,smoothing:i.trace.line.smoothing},p)),1e3<s.length){a.warn("Too many contours, clipping at 1000",e);break}return s}},{"../../lib":657,"./constraint_mapping":891,"./end_plus":896}],896:[function(e,t){'use strict';t.exports=function(e){return e.end+e.size/1e6}},{}],897:[function(e,t){'use strict';var d=Math.abs,c=Math.max,p=Math.floor;function a(e,t,a,o){return d(e[0]-t[0])<a&&d(e[1]-t[1])<o}function o(e,t){var a=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(a*a+o*o)}function r(e,t,r,d,c){function h(e){return _[e%_.length]}var y=t.join(","),f=e.crossings[y],x=l(f,r,t),_=[s(e,t,[-x[0],-x[1]])],b=e.z.length,m=e.z[0].length,n=t.slice(),v=x.slice(),w;for(w=0;1e4>w;w++){if(20<f?(f=g.CHOOSESADDLE[f][0>(x[0]||x[1])?0:1],e.crossings[y]=g.SADDLEREMAINDER[f]):delete e.crossings[y],x=g.NEWDELTA[f],!x){u.log("Found bad marching index:",f,t,e.level);break}_.push(s(e,t,x)),t[0]+=x[0],t[1]+=x[1],y=t.join(","),a(_[_.length-1],_[_.length-2],d,c)&&_.pop();var k=x[0]&&(0>t[0]||t[0]>m-2)||x[1]&&(0>t[1]||t[1]>b-2),T=t[0]===n[0]&&t[1]===n[1]&&x[0]===v[0]&&x[1]===v[1];if(T||r&&k)break;f=e.crossings[y]}1e4===w&&u.log("Infinite loop in contour?");var A=a(_[0],_[_.length-1],d,c),S=0,C=.2*e.smoothing,L=[],E=0,I,P,z,D,O,R,M,B,F,N,V;for(w=1;w<_.length;w++)M=o(_[w],_[w-1]),S+=M,L.push(M);var U=S/L.length*C;for(w=_.length-2;w>=E;w--)if(I=L[w],I<U){for(z=0,P=w-1;P>=E&&I+L[P]<U;P--)I+=L[P];if(A&&w===_.length-2)for(z=0;z<P&&I+L[z]<U;z++)I+=L[z];O=w-P+z+1,R=p((w+P+z+2)/2),D=A||w!==_.length-2?A||-1!==P?O%2?h(R):[(h(R)[0]+h(R+1)[0])/2,(h(R)[1]+h(R+1)[1])/2]:_[0]:_[_.length-1],_.splice(P+1,w-P+1,D),w=P+1,z&&(E=z),A&&(w===_.length-2?_[z]=_[_.length-1]:0===w&&(_[_.length-1]=_[0]))}for(_.splice(0,E),w=0;w<_.length;w++)_[w].length=2;if(!(2>_.length))if(A)_.pop(),e.paths.push(_);else{r||u.log("Unclosed interior contour?",e.level,n.join(","),_.join("L"));var H=!1;for(B=0;B<e.edgepaths.length;B++)if(N=e.edgepaths[B],!H&&a(N[0],_[_.length-1],d,c)){_.pop(),H=!0;var q=!1;for(F=0;F<e.edgepaths.length;F++)if(V=e.edgepaths[F],a(V[V.length-1],_[0],d,c)){q=!0,_.shift(),e.edgepaths.splice(B,1),F===B?e.paths.push(_.concat(V)):(F>B&&F--,e.edgepaths[F]=V.concat(_,N));break}q||(e.edgepaths[B]=_.concat(N))}for(B=0;B<e.edgepaths.length&&!H;B++)N=e.edgepaths[B],a(N[N.length-1],_[0],d,c)&&(_.shift(),e.edgepaths[B]=N.concat(_),H=!0);H||e.edgepaths.push(_)}}function l(e,t,a){var o=0,r=0;return 20<e&&t?208===e||1114===e?o=0===a[0]?1:-1:r=0===a[1]?1:-1:-1===g.BOTTOMSTART.indexOf(e)?-1===g.LEFTSTART.indexOf(e)?-1===g.TOPSTART.indexOf(e)?o=-1:r=-1:o=1:r=1,[o,r]}function s(e,t,a){var o=t[0]+c(a[0],0),r=t[1]+c(a[1],0),i=e.z[r][o],n=e.xaxis,l=e.yaxis;if(a[1]){var s=(e.level-i)/(e.z[r][o+1]-i);return[n.c2p((1-s)*e.x[o]+s*e.x[o+1],!0),l.c2p(e.y[r],!0),o+s,r]}var d=(e.level-i)/(e.z[r+1][o]-i);return[n.c2p(e.x[o],!0),l.c2p((1-d)*e.y[r]+d*e.y[r+1],!0),o,r+d]}var u=e("../../lib"),g=e("./constants");t.exports=function(e,t,a){var o,n,l,s,d;for(t=t||.01,a=a||.01,l=0;l<e.length;l++){for(s=e[l],d=0;d<s.starts.length;d++)n=s.starts[d],r(s,n,"edge",t,a);for(o=0;Object.keys(s.crossings).length&&1e4>o;)o++,n=Object.keys(s.crossings)[0].split(",").map(Number),r(s,n,void 0,t,a);1e4===o&&u.log("Infinite loop in contour?")}}},{"../../lib":657,"./constants":889}],898:[function(e,t){'use strict';var a=e("../../components/color"),o=e("../heatmap/hover");t.exports=function(e,t,r,i,n){var l=o(e,t,r,i,n,!0);return l&&l.forEach(function(e){var t=e.trace;"constraint"===t.contours.type&&(t.fillcolor&&a.opacity(t.fillcolor)?e.color=a.addOpacity(t.fillcolor,1):t.contours.showlines&&a.opacity(t.line.color)&&(e.color=a.addOpacity(t.line.color,1)))}),l}},{"../../components/color":524,"../heatmap/hover":949}],899:[function(e,t){'use strict';t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc"),plot:e("./plot").plot,style:e("./style"),colorbar:e("./colorbar"),hoverPoints:e("./hover"),moduleType:"trace",name:"contour",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","showLegend"],meta:{}}},{"../../plots/cartesian":718,"./attributes":885,"./calc":886,"./colorbar":888,"./defaults":894,"./hover":898,"./plot":903,"./style":905}],900:[function(e,t){'use strict';var a=e("../../lib");t.exports=function(e,t,o,r){r||(r={});var i=e("contours.showlabels");if(i){var n=t.font;a.coerceFont(e,"contours.labelfont",{family:n.family,size:n.size,color:o}),e("contours.labelformat")}!1!==r.hasHover&&e("zhoverformat")}},{"../../lib":657}],901:[function(e,t){'use strict';var a=e("d3"),o=e("../../components/colorscale"),r=e("./end_plus");t.exports=function(e){var t=e.contours,n=t.start,l=r(t),s=t.size||1,d=Math.floor((l-n)/s)+1,c="lines"===t.coloring?0:1,p=o.extractOpts(e);isFinite(s)||(s=1,d=1);var u=p.reversescale?o.flipScale(p.colorscale):p.colorscale,g=u.length,m=Array(g),h=Array(g),y,f;if("heatmap"===t.coloring){var x=p.min,_=p.max;for(f=0;f<g;f++)y=u[f],m[f]=y[0]*(_-x)+x,h[f]=y[1];var b=a.extent([x,_,t.start,t.start+s*(d-1)]),v=b[x<_?0:1],w=b[x<_?1:0];v!==x&&(m.splice(0,0,v),h.splice(0,0,h[0])),w!==_&&(m.push(w),h.push(h[h.length-1]))}else for(f=0;f<g;f++)y=u[f],m[f]=(y[0]*(d+c-1)-c/2)*s+n,h[f]=y[1];return o.makeColorScaleFunc({domain:m,range:h},{noNumericCheck:!0})}},{"../../components/colorscale":536,"./end_plus":896,d3:108}],902:[function(e,t){'use strict';function a(e,t){var a=(t[0][0]>e?0:1)+(t[0][1]>e?0:2)+(t[1][1]>e?0:4)+(t[1][0]>e?0:8);if(5==a||10===a){var o=(t[0][0]+t[0][1]+t[1][0]+t[1][1])/4;return e>o?5===a?713:1114:5===a?104:208}return 15==a?0:a}var o=e("./constants");t.exports=function(e){var t=e[0].z,r=t.length,l=t[0].length,n,s,d,c,p,u,g,m,h;for(s=0;s<r-1;s++)for(c=[],0===s&&(c=c.concat(o.BOTTOMSTART)),s===r-2&&(c=c.concat(o.TOPSTART)),n=0;n<l-1;n++)for(d=c.slice(),0===n&&(d=d.concat(o.LEFTSTART)),n===l-2&&(d=d.concat(o.RIGHTSTART)),p=n+","+s,u=[[t[s][n],t[s][n+1]],[t[s+1][n],t[s+1][n+1]]],h=0;h<e.length;h++)m=e[h],g=a(m.level,u),g&&(m.crossings[p]=g,-1!==d.indexOf(g)&&(m.starts.push([n,s]),(2===r||2===l)&&-1!==d.indexOf(g,d.indexOf(g)+1)&&m.starts.push([n,s])))}},{"./constants":889}],903:[function(e,t,a){'use strict';var c=Math.cos,p=Math.ceil,u=Math.sqrt,g=Math.PI,m=Math.sin,h=Math.min,f=Math.abs,_=Math.max;function o(e,t,a){var o=v.ensureSingle(e,"g","contourbg"),r=o.selectAll("path").data("fill"===a.coloring?[0]:[]);r.enter().append("path"),r.exit().remove(),r.attr("d","M"+t.join("L")+"Z").style("stroke","none")}function r(e,t,a,o){var r="fill"===o.coloring||"constraint"===o.type&&"="!==o._operation,n="M"+a.join("L")+"Z";r&&z(t,o);var l=v.ensureSingle(e,"g","contourfill"),s=l.selectAll("path").data(r?t:[]);s.enter().append("path"),s.exit().remove(),s.each(function(e){var t=(e.prefixBoundary?n:"")+i(e,a);t?b.select(this).attr("d",t).style("stroke","none"):b.select(this).remove()})}function i(e,t){function a(e){return .01>f(e[1]-t[0][1])}function o(e){return .01>f(e[1]-t[2][1])}function r(e){return .01>f(e[0]-t[0][0])}function n(e){return .01>f(e[0]-t[2][0])}for(var l="",s=0,d=e.edgepaths.map(function(e,t){return t}),c=!0,p,u,g,m,h,y;d.length;){for(y=w.smoothopen(e.edgepaths[s],e.smoothing),l+=c?y:y.replace(/^M/,"L"),d.splice(d.indexOf(s),1),p=e.edgepaths[s][e.edgepaths[s].length-1],m=-1,g=0;4>g;g++){if(!p){v.log("Missing end?",s,e);break}for(a(p)&&!n(p)?u=t[1]:r(p)?u=t[0]:o(p)?u=t[3]:n(p)&&(u=t[2]),h=0;h<e.edgepaths.length;h++){var x=e.edgepaths[h][0];.01>f(p[0]-u[0])?.01>f(p[0]-x[0])&&0<=(x[1]-p[1])*(u[1]-x[1])&&(u=x,m=h):.01>f(p[1]-u[1])?.01>f(p[1]-x[1])&&0<=(x[0]-p[0])*(u[0]-x[0])&&(u=x,m=h):v.log("endpt to newendpt is not vert. or horz.",p,u,x)}if(p=u,0<=m)break;l+="L"+u}if(m===e.edgepaths.length){v.log("unclosed perimeter path");break}s=m,c=-1===d.indexOf(s),c&&(s=d[0],l+="Z")}for(s=0;s<e.paths.length;s++)l+=w.smoothclosed(e.paths[s],e.smoothing);return l}function n(e,t,o,r,i){var n=v.ensureSingle(e,"g","contourlines"),l=!1!==i.showlines,s=i.showlabels,d=l&&s,c=a.createLines(n,l||s,t),g=a.createLineClip(n,d,o,r.trace.uid),m=e.selectAll("g.contourlabels").data(s?[0]:[]);if(m.exit().remove(),m.enter().append("g").classed("contourlabels",!0),s){var y=[],f=[];v.clearLocationCache();var x=a.labelFormatter(o,r),k=w.tester.append("text").attr("data-notex",1).call(w.font,i.labelfont),T=t[0].xaxis,A=t[0].yaxis,S=T._length,C=A._length,L=T.range,E=A.range,I=v.aggNums(Math.min,null,r.x),P=v.aggNums(Math.max,null,r.x),z=v.aggNums(Math.min,null,r.y),O=v.aggNums(Math.max,null,r.y),R=_(T.c2p(I,!0),0),M=h(T.c2p(P,!0),S),j=_(A.c2p(O,!0),0),B=h(A.c2p(z,!0),C),F={};L[0]<L[1]?(F.left=R,F.right=M):(F.left=M,F.right=R),E[0]<E[1]?(F.top=j,F.bottom=B):(F.top=B,F.bottom=j),F.middle=(F.top+F.bottom)/2,F.center=(F.left+F.right)/2,y.push([[F.left,F.top],[F.right,F.top],[F.right,F.bottom],[F.left,F.bottom]]);var N=u(S*S+C*C),V=D.LABELDISTANCE*N/_(1,t.length/D.LABELINCREASE);c.each(function(e){var t=a.calcTextOpts(e.level,x,k,o);b.select(this).selectAll("path").each(function(){var e=this,o=v.getVisibleSegment(e,F,t.height/2);if(o&&!(o.len<(t.width+t.height)*D.LABELMIN))for(var r=h(p(o.len/V),D.LABELMAX),n=0,l;n<r&&(l=a.findBestTextLocation(e,o,t,f,F),!!l);n++)a.addLabelData(l,t,f,y)})}),k.remove(),a.drawLabels(m,f,o,g,d?y:null)}s&&!l&&c.remove()}function l(e,t,a,o){var r=t.width/2,n=t.height/2,l=e.x,s=e.y,d=e.theta,p=c(d)*r,u=m(d)*r,g=(l>o.center?o.right-l:l-o.left)/(p+f(m(d)*n)),h=(s>o.middle?o.bottom-s:s-o.top)/(f(u)+c(d)*n);if(1>g||1>h)return 1/0;var y=O.EDGECOST*(1/(g-1)+1/(h-1));y+=O.ANGLECOST*d*d;for(var x=0;x<a.length;x++){var _=a[x],b=c(_.theta)*_.width/2,w=m(_.theta)*_.width/2,k=2*v.segmentDistance(l-p,s-u,l+p,s+u,_.x-b,_.y-w,_.x+b,_.y+w)/(t.height+_.height),T=_.level===t.level,A=T?O.SAMELEVELDISTANCE:1;if(k<=A)return 1/0;var S=O.NEIGHBORCOST*(T?O.SAMELEVELFACTOR:1);y+=S/(k-A)}return y}function s(e,t,a,o,r){var n=o.trace,l=a._fullLayout._clips,s="clip"+n.uid,c=l.selectAll("#"+s).data(n.connectgaps?[]:[0]);if(c.enter().append("clipPath").classed("contourclip",!0).attr("id",s),c.exit().remove(),!1===n.connectgaps){var p={level:.9,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:t.xaxis,yaxis:t.yaxis,x:o.x,y:o.y,z:d(o),smoothing:0};L([p]),E([p]),z([p],{type:"levels"});var u=v.ensureSingle(c,"path","");u.attr("d",(p.prefixBoundary?"M"+r.join("L")+"Z":"")+i(p,r))}else s=null;w.setClipUrl(e,s,a)}function d(e){var t=e.trace._emptypoints,a=[],o=e.z.length,r=e.z[0].length,n=[],l,s;for(l=0;l<r;l++)n.push(1);for(l=0;l<o;l++)a.push(n.slice());for(l=0;l<t.length;l++)s=t[l],a[s[0]][s[1]]=0;return e.zmask=a,a}var b=e("d3"),v=e("../../lib"),w=e("../../components/drawing"),k=e("../../components/colorscale"),T=e("../../lib/svg_text_utils"),A=e("../../plots/cartesian/axes"),S=e("../../plots/cartesian/set_convert"),C=e("../heatmap/plot"),L=e("./make_crossings"),E=e("./find_all_paths"),I=e("./empty_pathinfo"),P=e("./convert_to_constraints"),z=e("./close_boundaries"),D=e("./constants"),O=D.LABELOPTIMIZER;a.plot=function(e,t,a,i){var l=t.xaxis,d=t.yaxis;v.makeTraceGroups(i,a,"contour").each(function(a){var i=b.select(this),c=a[0],p=c.trace,u=c.x,g=c.y,m=p.contours,h=I(m,t,c),y=v.ensureSingle(i,"g","heatmapcoloring"),f=[];"heatmap"===m.coloring&&(f=[a]),C(e,t,f,y),L(h),E(h);var x=l.c2p(u[0],!0),_=l.c2p(u[u.length-1],!0),w=d.c2p(g[0],!0),k=d.c2p(g[g.length-1],!0),T=[[x,k],[_,k],[_,w],[x,w]],A=h;"constraint"===m.type&&(A=P(h,m._operation)),o(i,T,m),r(i,A,T,m),n(i,h,e,c,m),s(i,t,e,c,T)})},a.createLines=function(e,t,a){var o=a[0].smoothing,r=e.selectAll("g.contourlevel").data(t?a:[]);if(r.exit().remove(),r.enter().append("g").classed("contourlevel",!0),t){var i=r.selectAll("path.openline").data(function(e){return e.pedgepaths||e.edgepaths});i.exit().remove(),i.enter().append("path").classed("openline",!0),i.attr("d",function(e){return w.smoothopen(e,o)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke");var n=r.selectAll("path.closedline").data(function(e){return e.ppaths||e.paths});n.exit().remove(),n.enter().append("path").classed("closedline",!0),n.attr("d",function(e){return w.smoothclosed(e,o)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke")}return r},a.createLineClip=function(e,t,a,o){var r=a._fullLayout._clips,i=t?"clipline"+o:null,n=r.selectAll("#"+i).data(t?[0]:[]);return n.exit().remove(),n.enter().append("clipPath").classed("contourlineclip",!0).attr("id",i),w.setClipUrl(e,i,a),n},a.labelFormatter=function(e,t){var a=e._fullLayout,o=t.trace,r=o.contours,i={type:"linear",_id:"ycontour",showexponent:"all",exponentformat:"B"};if(r.labelformat)i.tickformat=r.labelformat,S(i,a);else{var n=k.extractOpts(o);if(n&&n.colorbar&&n.colorbar._axis)i=n.colorbar._axis;else{if("constraint"===r.type){var l=r.value;i.range=Array.isArray(l)?[l[0],l[l.length-1]]:[l,l]}else i.range=[r.start,r.end],i.nticks=(r.end-r.start)/r.size;i.range[0]===i.range[1]&&(i.range[1]+=i.range[0]||1),i.nticks||(i.nticks=1e3),S(i,a),A.prepTicks(i),i._tmin=null,i._tmax=null}}return function(e){return A.tickText(i,e).text}},a.calcTextOpts=function(e,t,a,o){var r=t(e);a.text(r).call(T.convertToTspans,o);var i=a.node(),n=w.bBox(i,!0);return{text:r,width:n.width,height:n.height,fontSize:+i.style["font-size"].replace("px",""),level:e,dy:(n.top+n.bottom)/2}},a.findBestTextLocation=function(e,t,a,o,r){var i=a.width,n,s,d,c,u;t.isClosed?(s=t.len/O.INITIALSEARCHPOINTS,n=t.min+s/2,d=t.max):(s=(t.len-i)/(O.INITIALSEARCHPOINTS+1),n=t.min+s+i/2,d=t.max-(s+i)/2);for(var g=1/0,m=0;m<O.ITERATIONS;m++){for(var h=n;h<d;h+=s){var y=v.getTextLocation(e,t.total,h,i),f=l(y,a,o,r);f<g&&(g=f,u=y,c=h)}if(g>2*O.MAXCOST)break;m&&(s/=2),n=c-s/2,d=n+1.5*s}if(g<=O.MAXCOST)return u},a.addLabelData=function(e,t,a,o){var r=t.fontSize,i=t.width+r/3,n=_(0,t.height-r/3),l=e.x,s=e.y,d=e.theta,p=m(d),u=c(d),g=function(e,t){return[l+e*u-t*p,s+e*p+t*u]},h=[g(-i/2,-n/2),g(-i/2,n/2),g(i/2,n/2),g(i/2,-n/2)];a.push({text:t.text,x:l,y:s,dy:t.dy,theta:d,level:t.level,width:i,height:n}),o.push(h)},a.drawLabels=function(e,t,a,o,r){var n=e.selectAll("text").data(t,function(e){return e.text+","+e.x+","+e.y+","+e.theta});if(n.exit().remove(),n.enter().append("text").attr({"data-notex":1,"text-anchor":"middle"}).each(function(e){var t=e.x+m(e.theta)*e.dy,o=e.y-c(e.theta)*e.dy;b.select(this).text(e.text).attr({x:t,y:o,transform:"rotate("+180*e.theta/g+" "+t+" "+o+")"}).call(T.convertToTspans,a)}),r){for(var l="",s=0;s<r.length;s++)l+="M"+r[s].join("L")+"Z";var d=v.ensureSingle(o,"path","");d.attr("d",l)}}},{"../../components/colorscale":536,"../../components/drawing":546,"../../lib":657,"../../lib/svg_text_utils":681,"../../plots/cartesian/axes":705,"../../plots/cartesian/set_convert":725,"../heatmap/plot":953,"./close_boundaries":887,"./constants":889,"./convert_to_constraints":893,"./empty_pathinfo":895,"./find_all_paths":897,"./make_crossings":902,d3:108}],904:[function(e,t){'use strict';function a(e,t,a){var r={type:"linear",range:[e,t]};return o.autoTicks(r,(t-e)/(a||15)),r}var o=e("../../plots/cartesian/axes"),r=e("../../lib");t.exports=function(e,t){var i=e.contours;if(e.autocontour){var n=e.zmin,l=e.zmax;(e.zauto||n===void 0)&&(n=r.aggNums(Math.min,null,t)),(e.zauto||l===void 0)&&(l=r.aggNums(Math.max,null,t));var s=a(n,l,e.ncontours);i.size=s.dtick,i.start=o.tickFirst(s),s.range.reverse(),i.end=o.tickFirst(s),i.start===n&&(i.start+=i.size),i.end===l&&(i.end-=i.size),i.start>i.end&&(i.start=i.end=(i.start+i.end)/2),e._input.contours||(e._input.contours={}),r.extendFlat(e._input.contours,{start:i.start,end:i.end,size:i.size}),e._input.autocontour=!0}else if("constraint"!==i.type){var d=i.start,c=i.end,p=e._input.contours;if(d>c&&(i.start=p.start=c,c=i.end=p.end=d,d=i.start),!(0<i.size)){var u;u=d===c?1:a(d,c,e.ncontours).dtick,p.size=i.size=u}}}},{"../../lib":657,"../../plots/cartesian/axes":705}],905:[function(e,t){'use strict';var a=e("d3"),o=e("../../components/drawing"),r=e("../heatmap/style"),i=e("./make_color_map");t.exports=function(e){var t=a.select(e).selectAll("g.contour");t.style("opacity",function(e){return e[0].trace.opacity}),t.each(function(e){var t=a.select(this),r=e[0].trace,n=r.contours,l=r.line,s=n.size||1,d=n.start,c="constraint"===n.type,p=!c&&"lines"===n.coloring,u=!c&&"fill"===n.coloring,g=p||u?i(r):null;t.selectAll("g.contourlevel").each(function(e){a.select(this).selectAll("path").call(o.lineGroupStyle,l.width,p?g(e.level):l.color,l.dash)});var m=n.labelfont;if(t.selectAll("g.contourlabels text").each(function(e){o.font(a.select(this),{family:m.family,size:m.size,color:m.color||(p?g(e.level):l.color)})}),c)t.selectAll("g.contourfill path").style("fill",r.fillcolor);else if(u){var h;t.selectAll("g.contourfill path").style("fill",function(e){return void 0===h&&(h=e.level),g(e.level+.5*s)}),void 0===h&&(h=d),t.selectAll("g.contourbg path").style("fill",g(h-.5*s))}}),r(e)}},{"../../components/drawing":546,"../heatmap/style":954,"./make_color_map":901,d3:108}],906:[function(e,t){'use strict';var a=e("../../components/colorscale/defaults"),o=e("./label_defaults");t.exports=function(e,t,r,i,n){var l=r("contours.coloring"),s="",d;"fill"===l&&(d=r("contours.showlines")),!1!==d&&("lines"!==l&&(s=r("line.color","#000")),r("line.width",.5),r("line.dash")),"none"!==l&&(!0!==e.showlegend&&(t.showlegend=!1),t._dfltShowLegend=!1,a(e,t,i,r,{prefix:"",cLetter:"z"})),r("line.smoothing"),o(r,i,s,n)}},{"../../components/colorscale/defaults":534,"./label_defaults":900}],907:[function(e,t){'use strict';var a=e("../heatmap/attributes"),o=e("../contour/attributes"),r=e("../../components/colorscale/attributes"),i=e("../../lib/extend").extendFlat,n=o.contours;t.exports=i({carpet:{valType:"string",editType:"calc"},z:a.z,a:a.x,a0:a.x0,da:a.dx,b:a.y,b0:a.y0,db:a.dy,text:a.text,hovertext:a.hovertext,transpose:a.transpose,atype:a.xtype,btype:a.ytype,fillcolor:o.fillcolor,autocontour:o.autocontour,ncontours:o.ncontours,contours:{type:n.type,start:n.start,end:n.end,size:n.size,coloring:{valType:"enumerated",values:["fill","lines","none"],dflt:"fill",editType:"calc"},showlines:n.showlines,showlabels:n.showlabels,labelfont:n.labelfont,labelformat:n.labelformat,operation:n.operation,value:n.value,editType:"calc",impliedEdits:{autocontour:!1}},line:{color:o.line.color,width:o.line.width,dash:o.line.dash,smoothing:o.line.smoothing,editType:"plot"},transforms:void 0},r("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":531,"../../lib/extend":648,"../contour/attributes":885,"../heatmap/attributes":942}],908:[function(e,t){'use strict';function a(e,t){var c=t._carpetTrace,p=c.aaxis,u=c.baxis,g,m,h,y,f,x,_;p._minDtick=0,u._minDtick=0,r.isArray1D(t.z)&&i(t,p,u,"a","b",["z"]),g=t._a=t._a||t.a,y=t._b=t._b||t.b,g=g?p.makeCalcdata(t,"_a"):[],y=y?u.makeCalcdata(t,"_b"):[],m=t.a0||0,h=t.da||1,f=t.b0||0,x=t.db||1,_=t._z=n(t._z||t.z,t.transpose),t._emptypoints=s(_),l(_,t._emptypoints);var v=r.maxRowLength(_),w="scaled"===t.xtype?"":g,k=d(t,w,m,h,v,p),T="scaled"===t.ytype?"":y,A=d(t,T,f,x,_.length,u),S={a:k,b:A,z:_};return"levels"===t.contours.type&&"none"!==t.contours.coloring&&o(e,t,{vals:_,containerStr:"",cLetter:"z"}),[S]}var o=e("../../components/colorscale/calc"),r=e("../../lib"),i=e("../heatmap/convert_column_xyz"),n=e("../heatmap/clean_2d_array"),l=e("../heatmap/interp2d"),s=e("../heatmap/find_empties"),d=e("../heatmap/make_bound_array"),c=e("./defaults"),p=e("../carpet/lookup_carpetid"),u=e("../contour/set_contours");t.exports=function(e,t){var o=t._carpetTrace=p(e,t);if(o&&o.visible&&"legendonly"!==o.visible){if(!t.a||!t.b){var r=e.data[o.index],i=e.data[t.index];i.a||(i.a=r.a),i.b||(i.b=r.b),c(i,t,t._defaultColor,e._fullLayout)}var n=a(e,t);return u(t,t._z),n}}},{"../../components/colorscale/calc":532,"../../lib":657,"../carpet/lookup_carpetid":858,"../contour/set_contours":904,"../heatmap/clean_2d_array":944,"../heatmap/convert_column_xyz":946,"../heatmap/find_empties":948,"../heatmap/interp2d":951,"../heatmap/make_bound_array":952,"./defaults":909}],909:[function(e,t){'use strict';var a=e("../../lib"),o=e("../heatmap/xyz_defaults"),r=e("./attributes"),i=e("../contour/constraint_defaults"),n=e("../contour/contours_defaults"),l=e("../contour/style_defaults");t.exports=function(e,t,s,d){function c(o,i){return a.coerce(e,t,r,o,i)}function p(o){return a.coerce2(e,t,r,o)}if(c("carpet"),e.a&&e.b){var u=o(e,t,c,d,"a","b");if(!u)return void(t.visible=!1);c("text");var g="constraint"===c("contours.type");g?i(e,t,c,d,s,{hasHover:!1}):(n(e,t,c,p),l(e,t,c,d,{hasHover:!1}))}else t._defaultColor=s,t._length=null}},{"../../lib":657,"../contour/constraint_defaults":890,"../contour/contours_defaults":892,"../contour/style_defaults":906,"../heatmap/xyz_defaults":956,"./attributes":907}],910:[function(e,t){'use strict';t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../contour/colorbar"),calc:e("./calc"),plot:e("./plot"),style:e("../contour/style"),moduleType:"trace",name:"contourcarpet",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","carpet","contour","symbols","showLegend","hasLines","carpetDependent","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":718,"../contour/colorbar":888,"../contour/style":905,"./attributes":907,"./calc":908,"./defaults":909,"./plot":911}],911:[function(e,t){'use strict';var g=Math.ceil,m=Math.sqrt,h=Math.min,y=Math.abs,f=Math.max;function o(e,t){var a,o,r,n,l,s,d,c,p;for(a=0;a<e.length;a++){for(n=e[a],l=n.pedgepaths=[],s=n.ppaths=[],o=0;o<n.edgepaths.length;o++){for(p=n.edgepaths[o],d=[],r=0;r<p.length;r++)d[r]=t(p[r]);l.push(d)}for(o=0;o<n.paths.length;o++){for(p=n.paths[o],c=[],r=0;r<p.length;r++)c[r]=t(p[r]);s.push(c)}}}function r(e,t,a,o,r,i,l){var s=w.ensureSingle(e,"g","contourlines"),d=!1!==r.showlines,c=r.showlabels,p=d&&c,u=A.createLines(s,d||c,t),y=A.createLineClip(s,p,a,o.trace.uid),_=e.selectAll("g.contourlabels").data(c?[0]:[]);if(_.exit().remove(),_.enter().append("g").classed("contourlabels",!0),c){var b=i.xaxis,k=i.yaxis,T=b._length,C=k._length,L=[[[0,0],[T,0],[T,C],[0,C]]],E=[];w.clearLocationCache();var I=A.labelFormatter(a,o),P=v.tester.append("text").attr("data-notex",1).call(v.font,r.labelfont),z={left:0,right:T,center:T/2,top:0,bottom:C,middle:C/2},D=m(T*T+C*C),O=S.LABELDISTANCE*D/f(1,t.length/S.LABELINCREASE);u.each(function(e){var t=A.calcTextOpts(e.level,I,P,a);x.select(this).selectAll("path").each(function(a){var o=this,r=w.getVisibleSegment(o,z,t.height/2);if(r&&(n(o,a,e,r,l,t.height),!(r.len<(t.width+t.height)*S.LABELMIN)))for(var s=h(g(r.len/O),S.LABELMAX),d=0,c;d<s&&(c=A.findBestTextLocation(o,r,t,E,z),!!c);d++)A.addLabelData(c,t,E,L)})}),P.remove(),A.drawLabels(_,E,a,y,p?L:null)}c&&!d&&u.remove()}function n(e,t,a,o,r,n){function c(e,t){var a=0,o=.1,i;return(y(e[0]-g)<o||y(e[0]-m)<o)&&(i=s(r.dxydb_rough(e[0],e[1],o)),a=f(a,n*d(t,i)/2)),(y(e[1]-h)<o||y(e[1]-x)<o)&&(i=s(r.dxyda_rough(e[0],e[1],o)),a=f(a,n*d(t,i)/2)),a}for(var p=0,u;p<a.pedgepaths.length;p++)t===a.pedgepaths[p]&&(u=a.edgepaths[p]);if(u){var g=r.a[0],m=r.a[r.a.length-1],h=r.b[0],x=r.b[r.b.length-1],_=l(e,0,1),b=l(e,o.total,o.total-1),v=c(u[0],_),w=o.total-c(u[u.length-1],b);o.min<v&&(o.min=v),o.max>w&&(o.max=w),o.len=o.max-o.min}}function l(e,t,a){var o=e.getPointAtLength(t),r=e.getPointAtLength(a),i=r.x-o.x,n=r.y-o.y,l=m(i*i+n*n);return[i/l,n/l]}function s(e){var t=m(e[0]*e[0]+e[1]*e[1]);return[e[0]/t,e[1]/t]}function d(e,t){var a=y(e[0]*t[0]+e[1]*t[1]),o=m(1-a*a);return o/a}function c(e,t,o,r,n,l){var s=w.ensureSingle(e,"g","contourbg"),d=s.selectAll("path").data("fill"!==l||n?[]:[0]),c,p,u,g;d.enter().append("path"),d.exit().remove();var m=[];for(g=0;g<t.length;g++)c=t[g],p=a([],c.x,o.c2p),u=a([],c.y,r.c2p),m.push(_(p,u,c.bicubic));d.attr("d","M"+m.join("L")+"Z").style("stroke","none")}function p(e,t,a,o,r,i,n,l,s,d,c){var p="fill"===d;p&&E(r,e.contours);var g=w.ensureSingle(t,"g","contourfill"),m=g.selectAll("path").data(p?r:[]);m.enter().append("path"),m.exit().remove(),m.each(function(t){var r=(t.prefixBoundary?c:"")+u(e,t,i,n,l,s,a,o);r?x.select(this).attr("d",r).style("stroke","none"):x.select(this).remove()})}function u(e,t,a,o,r,n,l,s){function d(e){return y(e[1]-a[0][1])<_}function c(e){return y(e[1]-a[2][1])<_}function p(e){return y(e[0]-a[0][0])<x}function u(e){return y(e[0]-a[2][0])<x}function g(e,t){var a="",o,g,m,h;for(d(e)&&!u(e)||c(e)&&!p(e)?(h=r.aaxis,m=P(r,n,[e[0],t[0]],.5*(e[1]+t[1]))):(h=r.baxis,m=P(r,n,.5*(e[0]+t[0]),[e[1],t[1]])),o=1;o<m.length;o++)for(a+=h.smoothing?"C":"L",g=0;g<m[o].length;g++){var y=m[o][g];a+=[l.c2p(y[0]),s.c2p(y[1])]+" "}return a}var m="",h=t.edgepaths.map(function(e,t){return t}),f=!0,x=1e-4*y(a[0][0]-a[2][0]),_=1e-4*y(a[0][1]-a[2][1]),b,k,T,A,S,C,L;for(b=0,k=null;h.length;){var E=t.edgepaths[b][0];for(k&&(m+=g(k,E)),L=v.smoothopen(t.edgepaths[b].map(o),t.smoothing),m+=f?L:L.replace(/^M/,"L"),h.splice(h.indexOf(b),1),k=t.edgepaths[b][t.edgepaths[b].length-1],S=-1,A=0;4>A;A++){if(!k){w.log("Missing end?",b,t);break}for(d(k)&&!u(k)?T=a[1]:p(k)?T=a[0]:c(k)?T=a[3]:u(k)&&(T=a[2]),C=0;C<t.edgepaths.length;C++){var I=t.edgepaths[C][0];y(k[0]-T[0])<x?y(k[0]-I[0])<x&&0<=(I[1]-k[1])*(T[1]-I[1])&&(T=I,S=C):y(k[1]-T[1])<_?y(k[1]-I[1])<_&&0<=(I[0]-k[0])*(T[0]-I[0])&&(T=I,S=C):w.log("endpt to newendpt is not vert. or horz.",k,T,I)}if(0<=S)break;m+=g(k,T),k=T}if(S===t.edgepaths.length){w.log("unclosed perimeter path");break}b=S,f=-1===h.indexOf(b),f&&(b=h[0],m+=g(k,T)+"Z",k=null)}for(b=0;b<t.paths.length;b++)m+=v.smoothclosed(t.paths[b].map(o),t.smoothing);return m}var x=e("d3"),a=e("../carpet/map_1d_array"),_=e("../carpet/makepath"),v=e("../../components/drawing"),w=e("../../lib"),k=e("../contour/make_crossings"),T=e("../contour/find_all_paths"),A=e("../contour/plot"),S=e("../contour/constants"),C=e("../contour/convert_to_constraints"),L=e("../contour/empty_pathinfo"),E=e("../contour/close_boundaries"),I=e("../carpet/lookup_carpetid"),P=e("../carpet/axis_aligned_line");t.exports=function(e,t,i,n){var l=t.xaxis,s=t.yaxis;w.makeTraceGroups(n,i,"contour").each(function(n){function d(e){var t=h.ab2xy(e[0],e[1],!0);return[l.c2p(t[0]),s.c2p(t[1])]}var u=x.select(this),g=n[0],m=g.trace,h=m._carpetTrace=I(e,m),y=e.calcdata[h.index][0];if(h.visible&&"legendonly"!==h.visible){var f=g.a,w=g.b,b=m.contours,A=L(b,t,g),S="constraint"===b.type,E=b._operation,P=S?"="===E?"lines":"fill":b.coloring,z=[[f[0],w[w.length-1]],[f[f.length-1],w[w.length-1]],[f[f.length-1],w[0]],[f[0],w[0]]];k(A);var D=1e-8*(f[f.length-1]-f[0]),O=1e-8*(w[w.length-1]-w[0]);T(A,D,O);var R=A;"constraint"===b.type&&(R=C(A,E)),o(A,d);var M=[],j,B,F,N;for(N=y.clipsegments.length-1;0<=N;N--)j=y.clipsegments[N],B=a([],j.x,l.c2p),F=a([],j.y,s.c2p),B.reverse(),F.reverse(),M.push(_(B,F,j.bicubic));var V="M"+M.join("L")+"Z";c(u,y.clipsegments,l,s,S,P),p(m,u,l,s,R,z,d,h,y,P,V),r(u,A,e,g,b,t,h),v.setClipUrl(u,h._clipPathId,e)}})}},{"../../components/drawing":546,"../../lib":657,"../carpet/axis_aligned_line":842,"../carpet/lookup_carpetid":858,"../carpet/makepath":859,"../carpet/map_1d_array":860,"../contour/close_boundaries":887,"../contour/constants":889,"../contour/convert_to_constraints":893,"../contour/empty_pathinfo":895,"../contour/find_all_paths":897,"../contour/make_crossings":902,"../contour/plot":903,d3:108}],912:[function(e,t){'use strict';var a=e("../../components/colorscale/attributes"),o=e("../../plots/template_attributes").hovertemplateAttrs,r=e("../../plots/attributes"),i=e("../scattermapbox/attributes"),n=e("../../lib/extend").extendFlat;t.exports=n({lon:i.lon,lat:i.lat,z:{valType:"data_array",editType:"calc"},radius:{valType:"number",editType:"plot",arrayOk:!0,min:1,dflt:30},below:{valType:"string",editType:"plot"},text:i.text,hovertext:i.hovertext,hoverinfo:n({},r.hoverinfo,{flags:["lon","lat","z","text","name"]}),hovertemplate:o(),showlegend:n({},r.showlegend,{dflt:!1})},a("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":531,"../../lib/extend":648,"../../plots/attributes":702,"../../plots/template_attributes":783,"../scattermapbox/attributes":1126}],913:[function(e,t){'use strict';var a=e("fast-isnumeric"),o=e("../../lib").isArrayOrTypedArray,r=e("../../constants/numerical").BADNUM,n=e("../../components/colorscale/calc"),l=e("../../lib")._;t.exports=function(e,t){for(var s=t._length,d=Array(s),c=t.z,p=o(c)&&c.length,u=0;u<s;u++){var g=d[u]={},m=t.lon[u],h=t.lat[u];if(g.lonlat=a(m)&&a(h)?[+m,+h]:[r,r],p){var y=c[u];g.z=a(y)?y:r}}return n(e,t,{vals:p?c:[0,1],containerStr:"",cLetter:"z"}),s&&(d[0].t={labels:{lat:l(e,"lat:")+" ",lon:l(e,"lon:")+" "}}),d}},{"../../components/colorscale/calc":532,"../../constants/numerical":633,"../../lib":657,"fast-isnumeric":201}],914:[function(e,t){'use strict';var a=e("fast-isnumeric"),o=e("../../lib"),r=e("../../components/color"),n=e("../../components/colorscale"),l=e("../../constants/numerical").BADNUM,s=e("../../lib/geojson_utils").makeBlank;t.exports=function(e){var t=e[0].trace,d=!0===t.visible&&0!==t._length,c=t._opts={heatmap:{layout:{visibility:"none"},paint:{}},geojson:s()};if(!d)return c;var p=[],u=t.z,g=t.radius,m=o.isArrayOrTypedArray(u)&&u.length,h=o.isArrayOrTypedArray(g),y;for(y=0;y<e.length;y++){var f=e[y],x=f.lonlat;if(x[0]!==l){var _={};if(m){var b=f.z;_.z=b===l?0:b}h&&(_.r=a(g[y])&&0<g[y]?+g[y]:0),p.push({type:"Feature",geometry:{type:"Point",coordinates:x},properties:_})}}var v=n.extractOpts(t),w=v.reversescale?n.flipScale(v.colorscale):v.colorscale,k=w[0][1],T=1>r.opacity(k)?k:r.addOpacity(k,0),A=["interpolate",["linear"],["heatmap-density"],0,T];for(y=1;y<w.length;y++)A.push(w[y][0],w[y][1]);var S=["interpolate",["linear"],["get","z"],v.min,0,v.max,1];return o.extendFlat(c.heatmap.paint,{"heatmap-weight":m?S:1/(v.max-v.min),"heatmap-color":A,"heatmap-radius":h?{type:"identity",property:"r"}:t.radius,"heatmap-opacity":t.opacity}),c.geojson={type:"FeatureCollection",features:p},c.heatmap.layout.visibility="visible",c}},{"../../components/color":524,"../../components/colorscale":536,"../../constants/numerical":633,"../../lib":657,"../../lib/geojson_utils":652,"fast-isnumeric":201}],915:[function(e,t){'use strict';var a=e("../../lib"),o=e("../../components/colorscale/defaults"),r=e("./attributes");t.exports=function(e,t,i,n){function l(o,i){return a.coerce(e,t,r,o,i)}var s=l("lon")||[],d=l("lat")||[],c=Math.min(s.length,d.length);return c?void(t._length=c,l("z"),l("radius"),l("below"),l("text"),l("hovertext"),l("hovertemplate"),o(e,t,n,l,{prefix:"",cLetter:"z"})):void(t.visible=!1)}},{"../../components/colorscale/defaults":534,"../../lib":657,"./attributes":912}],916:[function(e,t){'use strict';t.exports=function(e,t){return e.lon=t.lon,e.lat=t.lat,e.z=t.z,e}},{}],917:[function(e,t){'use strict';function a(e,t,a){function r(e){return e+"\xB0"}if(!e.hovertemplate){var i=t.hi||e.hoverinfo,n=i.split("+"),l=-1!==n.indexOf("all"),s=-1!==n.indexOf("lon"),d=-1!==n.indexOf("lat"),c=t.lonlat,p=[];return l||s&&d?p.push("("+r(c[0])+", "+r(c[1])+")"):s?p.push(a.lon+r(c[0])):d&&p.push(a.lat+r(c[1])),(l||-1!==n.indexOf("text"))&&o.fillText(t,e,p),p.join("<br>")}}var o=e("../../lib"),r=e("../../plots/cartesian/axes"),i=e("../scattermapbox/hover");t.exports=function(e,t,o){var n=i(e,t,o);if(n){var l=n[0],s=l.cd,d=s[0].trace,c=s[l.index];if(delete l.color,"z"in c){var p=l.subplot.mockAxis;l.z=c.z,l.zLabel=r.tickText(p,p.c2l(c.z),"hover").text}return l.extraText=a(d,c,s[0].t.labels),[l]}}},{"../../lib":657,"../../plots/cartesian/axes":705,"../scattermapbox/hover":1131}],918:[function(e,t){'use strict';t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../heatmap/colorbar"),formatLabels:e("../scattermapbox/format_labels"),calc:e("./calc"),plot:e("./plot"),hoverPoints:e("./hover"),eventData:e("./event_data"),getBelow:function(e,t){for(var a=t.getMapLayers(),o=0;o<a.length;o++){var r=a[o],n=r.id;if("symbol"===r.type&&"string"==typeof n&&-1===n.indexOf("plotly-"))return n}},moduleType:"trace",name:"densitymapbox",basePlotModule:e("../../plots/mapbox"),categories:["mapbox","gl","showLegend"],meta:{hr_name:"density_mapbox"}}},{"../../plots/mapbox":762,"../heatmap/colorbar":945,"../scattermapbox/format_labels":1130,"./attributes":912,"./calc":913,"./defaults":915,"./event_data":916,"./hover":917,"./plot":919}],919:[function(e,t){'use strict';function a(e,t){this.type="densitymapbox",this.subplot=e,this.uid=t,this.sourceId="source-"+t,this.layerList=[["heatmap",r+t+"-heatmap"]],this.below=null}var o=e("./convert"),r=e("../../plots/mapbox/constants").traceLayerPrefix,i=a.prototype;i.update=function(e){var t=this.subplot,a=this.layerList,r=o(e),n=t.belowLookup["trace-"+this.uid];t.map.getSource(this.sourceId).setData(r.geojson),n!==this.below&&(this._removeLayers(),this._addLayers(r,n),this.below=n);for(var l=0;l<a.length;l++){var s=a[l],d=s[0],c=s[1],p=r[d];t.setOptions(c,"setLayoutProperty",p.layout),"visible"===p.layout.visibility&&t.setOptions(c,"setPaintProperty",p.paint)}},i._addLayers=function(e,t){for(var a=this.subplot,o=this.layerList,r=this.sourceId,n=0;n<o.length;n++){var l=o[n],s=l[0],d=e[s];a.addLayer({type:s,id:l[1],source:r,layout:d.layout,paint:d.paint},t)}},i._removeLayers=function(){for(var e=this.subplot.map,t=this.layerList,a=t.length-1;0<=a;a--)e.removeLayer(t[a][1])},i.dispose=function(){var e=this.subplot.map;this._removeLayers(),e.removeSource(this.sourceId)},t.exports=function(e,t){var r=t[0].trace,i=new a(e,r.uid),n=i.sourceId,l=o(t),s=i.below=e.belowLookup["trace-"+r.uid];return e.map.addSource(n,{type:"geojson",data:l.geojson}),i._addLayers(l,s),i}},{"../../plots/mapbox/constants":760,"./convert":914}],920:[function(e,t){'use strict';var a=e("../../lib");t.exports=function(e,t){for(var o=0;o<e.length;o++)e[o].i=o;a.mergeArray(t.text,e,"tx"),a.mergeArray(t.hovertext,e,"htx");var r=t.marker;if(r){a.mergeArray(r.opacity,e,"mo"),a.mergeArray(r.color,e,"mc");var n=r.line;n&&(a.mergeArray(n.color,e,"mlc"),a.mergeArrayCastPositive(n.width,e,"mlw"))}}},{"../../lib":657}],921:[function(e,t){'use strict';var a=e("../bar/attributes"),o=e("../scatter/attributes").line,r=e("../../plots/attributes"),i=e("../../plots/template_attributes").hovertemplateAttrs,n=e("../../plots/template_attributes").texttemplateAttrs,l=e("./constants"),s=e("../../lib/extend").extendFlat,d=e("../../components/color");t.exports={x:a.x,x0:a.x0,dx:a.dx,y:a.y,y0:a.y0,dy:a.dy,hovertext:a.hovertext,hovertemplate:i({},{keys:l.eventDataKeys}),hoverinfo:s({},r.hoverinfo,{flags:["name","x","y","text","percent initial","percent previous","percent total"]}),textinfo:{valType:"flaglist",flags:["label","text","percent initial","percent previous","percent total","value"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:n({editType:"plot"},{keys:l.eventDataKeys.concat(["label","value"])}),text:a.text,textposition:s({},a.textposition,{dflt:"auto"}),insidetextanchor:s({},a.insidetextanchor,{dflt:"middle"}),textangle:s({},a.textangle,{dflt:0}),textfont:a.textfont,insidetextfont:a.insidetextfont,outsidetextfont:a.outsidetextfont,constraintext:a.constraintext,cliponaxis:a.cliponaxis,orientation:s({},a.orientation,{}),offset:s({},a.offset,{arrayOk:!1}),width:s({},a.width,{arrayOk:!1}),marker:a.marker,connector:{fillcolor:{valType:"color",editType:"style"},line:{color:s({},o.color,{dflt:d.defaultLine}),width:s({},o.width,{dflt:0,editType:"plot"}),dash:o.dash,editType:"style"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:a.offsetgroup,alignmentgroup:a.alignmentgroup}},{"../../components/color":524,"../../lib/extend":648,"../../plots/attributes":702,"../../plots/template_attributes":783,"../bar/attributes":798,"../scatter/attributes":1062,"./constants":923}],922:[function(e,t){'use strict';var o=Math.min;function a(e){return e===s?0:e}var r=e("../../plots/cartesian/axes"),n=e("./arrays_to_calcdata"),l=e("../scatter/calc_selection"),s=e("../../constants/numerical").BADNUM;t.exports=function(e,t){var d=r.getFromId(e,t.xaxis||"x"),c=r.getFromId(e,t.yaxis||"y"),p,u,g,m;"h"===t.orientation?(p=d.makeCalcdata(t,"x"),u=c.makeCalcdata(t,"y")):(p=c.makeCalcdata(t,"y"),u=d.makeCalcdata(t,"x"));var h=o(u.length,p.length),y=Array(h);for(t._base=[],g=0;g<h;g++){0>p[g]&&(p[g]=s);var f=!1;p[g]!==s&&g+1<h&&p[g+1]!==s&&(f=!0),m=y[g]={p:u[g],s:p[g],cNext:f},t._base[g]=-.5*m.s,t.ids&&(m.id=t.ids[g]+""),0===g&&(y[0].vTotal=0),y[0].vTotal+=a(m.s),m.begR=a(m.s)/a(y[0].s)}var x;for(g=0;g<h;g++)m=y[g],m.s===s||(m.sumR=m.s/y[0].vTotal,m.difR=void 0===x?1:m.s/x,x=m.s);return n(y,t),l(y,t),y}},{"../../constants/numerical":633,"../../plots/cartesian/axes":705,"../scatter/calc_selection":1064,"./arrays_to_calcdata":920}],923:[function(e,t){'use strict';t.exports={eventDataKeys:["percentInitial","percentPrevious","percentTotal"]}},{}],924:[function(e,t){'use strict';var a=e("../bar/cross_trace_calc").setGroupPositions;t.exports=function(e,t){var o=e._fullLayout,r=e._fullData,n=e.calcdata,l=t.xaxis,s=t.yaxis,d=[],c=[],p=[],u,g;for(g=0;g<r.length;g++){var m=r[g],h="h"===m.orientation;!0===m.visible&&m.xaxis===l._id&&m.yaxis===s._id&&"funnel"===m.type&&(u=n[g],h?p.push(u):c.push(u),d.push(u))}var y={mode:o.funnelmode,norm:o.funnelnorm,gap:o.funnelgap,groupgap:o.funnelgroupgap};for(a(e,l,s,c,y),a(e,s,l,p,y),g=0;g<d.length;g++){u=d[g];for(var f=0;f<u.length;f++)f+1<u.length&&(u[f].nextP0=u[f+1].p0,u[f].nextS0=u[f+1].s0,u[f].nextP1=u[f+1].p1,u[f].nextS1=u[f+1].s1)}}},{"../bar/cross_trace_calc":801}],925:[function(e,t){'use strict';function a(e){var t=o.isArrayOrTypedArray(e)?"#000":e;return s.addOpacity(t,.5*s.opacity(t))}var o=e("../../lib"),r=e("../bar/defaults").handleGroupingDefaults,i=e("../bar/defaults").handleText,n=e("../scatter/xy_defaults"),l=e("./attributes"),s=e("../../components/color");t.exports={supplyDefaults:function(e,t,r,d){function c(a,r){return o.coerce(e,t,l,a,r)}var p=n(e,t,d,c);if(!p)return void(t.visible=!1);c("orientation",t.y&&!t.x?"v":"h"),c("offset"),c("width");var u=c("text");c("hovertext"),c("hovertemplate");var g=c("textposition");i(e,t,d,c,g,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),"none"===t.textposition||t.texttemplate||c("textinfo",Array.isArray(u)?"text+value":"value");var m=c("marker.color",r);c("marker.line.color",s.defaultLine),c("marker.line.width");var h=c("connector.visible");if(h){c("connector.fillcolor",a(m));var y=c("connector.line.width");y&&(c("connector.line.color"),c("connector.line.dash"))}},crossTraceDefaults:function(e,t){function a(e){return o.coerce(s._input,s,l,e)}var n,s;if("group"===t.funnelmode)for(var d=0;d<e.length;d++)s=e[d],n=s._input,r(n,s,t,a)}}},{"../../components/color":524,"../../lib":657,"../bar/defaults":802,"../scatter/xy_defaults":1088,"./attributes":921}],926:[function(e,t){'use strict';t.exports=function(e,t){return e.x="xVal"in t?t.xVal:t.x,e.y="yVal"in t?t.yVal:t.y,"percentInitial"in t&&(e.percentInitial=t.percentInitial),"percentPrevious"in t&&(e.percentPrevious=t.percentPrevious),"percentTotal"in t&&(e.percentTotal=t.percentTotal),t.xa&&(e.xaxis=t.xa),t.ya&&(e.yaxis=t.ya),e}},{}],927:[function(e,t){'use strict';function a(e,t){var a=e.marker,r=t.mc||a.color,i=t.mlc||a.line.color,n=t.mlw||a.line.width;if(o(r))return r;return o(i)&&n?i:void 0}var o=e("../../components/color").opacity,r=e("../bar/hover").hoverOnBars,i=e("../../lib").formatPercent;t.exports=function(e,t,o,n){var l=r(e,t,o,n);if(l){var s=l.cd,d=s[0].trace,c="h"===d.orientation,p=l.index,u=s[p],g=c?"x":"y";l[g+"LabelVal"]=u.s,l.percentInitial=u.begR,l.percentInitialLabel=i(u.begR,1),l.percentPrevious=u.difR,l.percentPreviousLabel=i(u.difR,1),l.percentTotal=u.sumR,l.percentTotalLabel=i(u.sumR,1);var m=u.hi||d.hoverinfo,h=[];if(m&&"none"!==m&&"skip"!==m){var y=m.split("+"),f=function(e){return"all"===m||-1!==y.indexOf(e)};f("percent initial")&&h.push(l.percentInitialLabel+" of initial"),f("percent previous")&&h.push(l.percentPreviousLabel+" of previous"),f("percent total")&&h.push(l.percentTotalLabel+" of total")}return l.extraText=h.join("<br>"),l.color=a(d,u),[l]}}},{"../../components/color":524,"../../lib":657,"../bar/hover":805}],928:[function(e,t){'use strict';t.exports={attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults").supplyDefaults,crossTraceDefaults:e("./defaults").crossTraceDefaults,supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc"),crossTraceCalc:e("./cross_trace_calc"),plot:e("./plot"),style:e("./style").style,hoverPoints:e("./hover"),eventData:e("./event_data"),selectPoints:e("../bar/select"),moduleType:"trace",name:"funnel",basePlotModule:e("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":718,"../bar/select":810,"./attributes":921,"./calc":922,"./cross_trace_calc":924,"./defaults":925,"./event_data":926,"./hover":927,"./layout_attributes":929,"./layout_defaults":930,"./plot":931,"./style":932}],929:[function(e,t){'use strict';t.exports={funnelmode:{valType:"enumerated",values:["stack","group","overlay"],dflt:"stack",editType:"calc"},funnelgap:{valType:"number",min:0,max:1,editType:"calc"},funnelgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],930:[function(e,t){'use strict';var a=e("../../lib"),o=e("./layout_attributes");t.exports=function(e,t,r){function n(r,i){return a.coerce(e,t,o,r,i)}for(var l=!1,s=0,d;s<r.length;s++)if(d=r[s],d.visible&&"funnel"===d.type){l=!0;break}l&&(n("funnelmode"),n("funnelgap",.2),n("funnelgroupgap"))}},{"../../lib":657,"./layout_attributes":929}],931:[function(e,t){'use strict';function a(e,t,a,o){var d=t.xaxis,c=t.yaxis;n.makeTraceGroups(o,a,"trace bars").each(function(a){var o=i.select(this),p=a[0].trace,u=n.ensureSingle(o,"g","regions");if(!p.connector||!p.connector.visible)return void u.remove();var g="h"===p.orientation,m=u.selectAll("g.region").data(n.identity);m.enter().append("g").classed("region",!0),m.exit().remove();var h=m.size();m.each(function(a,o){if(o===h-1||a.cNext){var p=r(a,d,c,g),u=p[0],m=p[1],y="";u[0]!==s&&m[0]!==s&&u[1]!==s&&m[1]!==s&&u[2]!==s&&m[2]!==s&&u[3]!==s&&m[3]!==s&&(g?y+="M"+u[0]+","+m[1]+"L"+u[2]+","+m[2]+"H"+u[3]+"L"+u[1]+","+m[1]+"Z":y+="M"+u[1]+","+m[1]+"L"+u[2]+","+m[3]+"V"+m[2]+"L"+u[1]+","+m[0]+"Z"),""===y&&(y="M0,0Z"),n.ensureSingle(i.select(this),"path").attr("d",y).call(l.setClipUrl,t.layerClipId,e)}})})}function o(e,t,a,o){var s=t.xaxis,d=t.yaxis;n.makeTraceGroups(o,a,"trace bars").each(function(a){var o=i.select(this),c=a[0].trace,p=n.ensureSingle(o,"g","lines");if(!c.connector||!c.connector.visible||!c.connector.line.width)return void p.remove();var u="h"===c.orientation,g=p.selectAll("g.line").data(n.identity);g.enter().append("g").classed("line",!0),g.exit().remove();var m=g.size();g.each(function(a,o){if(o===m-1||a.cNext){var c=r(a,s,d,u),p=c[0],g=c[1],h="";void 0!==p[3]&&void 0!==g[3]&&(u?(h+="M"+p[0]+","+g[1]+"L"+p[2]+","+g[2],h+="M"+p[1]+","+g[1]+"L"+p[3]+","+g[2]):(h+="M"+p[1]+","+g[1]+"L"+p[2]+","+g[3],h+="M"+p[1]+","+g[0]+"L"+p[2]+","+g[2])),""===h&&(h="M0,0Z"),n.ensureSingle(i.select(this),"path").attr("d",h).call(l.setClipUrl,t.layerClipId,e)}})})}function r(e,t,a,o){var r=[],i=[],n=o?t:a,l=o?a:t;return r[0]=n.c2p(e.s0,!0),i[0]=l.c2p(e.p0,!0),r[1]=n.c2p(e.s1,!0),i[1]=l.c2p(e.p1,!0),r[2]=n.c2p(e.nextS0,!0),i[2]=l.c2p(e.nextP0,!0),r[3]=n.c2p(e.nextS1,!0),i[3]=l.c2p(e.nextP1,!0),o?[r,i]:[i,r]}var i=e("d3"),n=e("../../lib"),l=e("../../components/drawing"),s=e("../../constants/numerical").BADNUM,d=e("../bar/plot"),c=e("../bar/uniform_text").clearMinTextSize;t.exports=function(e,t,r,i){var n=e._fullLayout;c("funnel",n),a(e,t,r,i),o(e,t,r,i),d.plot(e,t,r,i,{mode:n.funnelmode,norm:n.funnelmode,gap:n.funnelgap,groupgap:n.funnelgroupgap})}},{"../../components/drawing":546,"../../constants/numerical":633,"../../lib":657,"../bar/plot":809,"../bar/uniform_text":814,d3:108}],932:[function(e,t){'use strict';var a=e("d3"),o=e("../../components/drawing"),r=e("../../components/color"),i=e("../../constants/interactions").DESELECTDIM,n=e("../bar/style"),l=e("../bar/uniform_text").resizeText,s=n.styleTextPoints;t.exports={style:function(e,t,n){var d=n?n:a.select(e).selectAll("g.funnellayer").selectAll("g.trace");l(e,d,"funnel"),d.style("opacity",function(e){return e[0].trace.opacity}),d.each(function(t){var n=a.select(this),l=t[0].trace;n.selectAll(".point > path").each(function(e){if(!e.isBlank){var t=l.marker;a.select(this).call(r.fill,e.mc||t.color).call(r.stroke,e.mlc||t.line.color).call(o.dashLine,t.line.dash,e.mlw||t.line.width).style("opacity",l.selectedpoints&&!e.selected?i:1)}}),s(n,l,e),n.selectAll(".regions").each(function(){a.select(this).selectAll("path").style("stroke-width",0).call(r.fill,l.connector.fillcolor)}),n.selectAll(".lines").each(function(){var e=l.connector.line;o.lineGroupStyle(a.select(this).selectAll("path"),e.width,e.color,e.dash)})})}}},{"../../components/color":524,"../../components/drawing":546,"../../constants/interactions":632,"../bar/style":812,"../bar/uniform_text":814,d3:108}],933:[function(e,t){'use strict';var a=e("../pie/attributes"),o=e("../../plots/attributes"),r=e("../../plots/domain").attributes,i=e("../../plots/template_attributes").hovertemplateAttrs,n=e("../../plots/template_attributes").texttemplateAttrs,l=e("../../lib/extend").extendFlat;t.exports={labels:a.labels,label0:a.label0,dlabel:a.dlabel,values:a.values,marker:{colors:a.marker.colors,line:{color:l({},a.marker.line.color,{dflt:null}),width:l({},a.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},text:a.text,hovertext:a.hovertext,scalegroup:l({},a.scalegroup,{}),textinfo:l({},a.textinfo,{flags:["label","text","value","percent"]}),texttemplate:n({editType:"plot"},{keys:["label","color","value","text","percent"]}),hoverinfo:l({},o.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:i({},{keys:["label","color","value","text","percent"]}),textposition:l({},a.textposition,{values:["inside","none"],dflt:"inside"}),textfont:a.textfont,insidetextfont:a.insidetextfont,title:{text:a.title.text,font:a.title.font,position:l({},a.title.position,{values:["top left","top center","top right"],dflt:"top center"}),editType:"plot"},domain:r({name:"funnelarea",trace:!0,editType:"calc"}),aspectratio:{valType:"number",min:0,dflt:1,editType:"plot"},baseratio:{valType:"number",min:0,max:1,dflt:.333,editType:"plot"}}},{"../../lib/extend":648,"../../plots/attributes":702,"../../plots/domain":732,"../../plots/template_attributes":783,"../pie/attributes":1036}],934:[function(e,t,a){'use strict';var o=e("../../plots/plots");a.name="funnelarea",a.plot=function(e,t,r,i){o.plotBasePlot(a.name,e,t,r,i)},a.clean=function(e,t,r,i){o.cleanBasePlot(a.name,e,t,r,i)}},{"../../plots/plots":768}],935:[function(e,t){'use strict';var a=e("../pie/calc");t.exports={calc:function(e,t){return a.calc(e,t)},crossTraceCalc:function(e){a.crossTraceCalc(e,{type:"funnelarea"})}}},{"../pie/calc":1038}],936:[function(e,t){'use strict';var a=e("../../lib"),o=e("./attributes"),r=e("../../plots/domain").defaults,i=e("../bar/defaults").handleText,n=e("../pie/defaults").handleLabelsAndValues;t.exports=function(e,t,l,s){function d(r,i){return a.coerce(e,t,o,r,i)}var c=d("labels"),p=d("values"),u=n(c,p),g=u.len;if(t._hasLabels=u.hasLabels,t._hasValues=u.hasValues,!t._hasLabels&&t._hasValues&&(d("label0"),d("dlabel")),!g)return void(t.visible=!1);t._length=g;var m=d("marker.line.width");m&&d("marker.line.color",s.paper_bgcolor),d("marker.colors"),d("scalegroup");var h=d("text"),y=d("texttemplate"),f;if(y||(f=d("textinfo",Array.isArray(h)?"text+percent":"percent")),d("hovertext"),d("hovertemplate"),y||f&&"none"!==f){var x=d("textposition");i(e,t,s,d,x,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1})}r(t,s,d);var _=d("title.text");_&&(d("title.position"),a.coerceFont(d,"title.font",s.font)),d("aspectratio"),d("baseratio")}},{"../../lib":657,"../../plots/domain":732,"../bar/defaults":802,"../pie/defaults":1039,"./attributes":933}],937:[function(e,t){'use strict';t.exports={moduleType:"trace",name:"funnelarea",basePlotModule:e("./base_plot"),categories:["pie-like","funnelarea","showLegend"],attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults"),supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc").calc,crossTraceCalc:e("./calc").crossTraceCalc,plot:e("./plot"),style:e("./style"),styleOne:e("../pie/style_one"),meta:{}}},{"../pie/style_one":1047,"./attributes":933,"./base_plot":934,"./calc":935,"./defaults":936,"./layout_attributes":938,"./layout_defaults":939,"./plot":940,"./style":941}],938:[function(e,t){'use strict';var a=e("../pie/layout_attributes").hiddenlabels;t.exports={hiddenlabels:a,funnelareacolorway:{valType:"colorlist",editType:"calc"},extendfunnelareacolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{"../pie/layout_attributes":1043}],939:[function(e,t){'use strict';var a=e("../../lib"),o=e("./layout_attributes");t.exports=function(e,t){function r(r,i){return a.coerce(e,t,o,r,i)}r("hiddenlabels"),r("funnelareacolorway",t.colorway),r("extendfunnelareacolors")}},{"../../lib":657,"./layout_attributes":938}],940:[function(e,t){'use strict';var n=Math.min,l=Math.pow,s=Math.max;function a(e,t){var a=t[0]-e[0],o=t[1]-e[1];return"l"+a+","+o}function o(e,t){return[.5*(e[0]+t[0]),.5*(e[1]+t[1])]}function r(e){function t(){var e=Math.sqrt(_);return{x:e,y:-e}}function a(){var e=t();return[e.x,e.y]}if(e.length){var d=e[0],c=d.trace,u=c.aspectratio,g=c.baseratio;.999<g&&(g=.999);var m=l(g,2),f=d.vTotal,_=f*m/(1-m)/f,b=[],v;b.push(a());var w,k;for(w=e.length-1;-1<w;w--)if(k=e[w],!k.hidden){var T=k.v/f;_+=T,b.push(a())}var A=1/0,S=-Infinity;for(w=0;w<b.length;w++)v=b[w],A=n(A,v[1]),S=s(S,v[1]);for(w=0;w<b.length;w++)b[w][1]-=(S+A)/2;var C=b[b.length-1][0],L=d.r,r=(S-A)/2,E=L/r*u;for(d.r=E*r,w=0;w<b.length;w++)b[w][0]*=L/C,b[w][1]*=E;v=b[0];var I=[-v[0],v[1]],P=[v[0],v[1]],z=0;for(w=e.length-1;-1<w;w--)if(k=e[w],!k.hidden){z+=1;var D=b[z][0],x=b[z][1];k.TL=[-D,x],k.TR=[D,x],k.BL=I,k.BR=P,k.pxmid=o(k.TR,k.BR),I=k.TL,P=k.TR}}}var d=e("d3"),c=e("../../components/drawing"),p=e("../../lib"),u=e("../../lib/svg_text_utils"),g=e("../bar/plot"),m=g.toMoveInsideBar,h=e("../bar/uniform_text"),y=h.recordMinTextSize,f=h.clearMinTextSize,x=e("../pie/helpers"),_=e("../pie/plot"),b=_.attachFxHandlers,v=_.determineInsideTextFont,w=_.layoutAreas,k=_.prerenderTitles,T=_.positionTitleOutside,A=_.formatSliceLabel;t.exports=function(e,t){var o=e._fullLayout;f("funnelarea",o),k(t,e),w(t,o._size),p.makeTraceGroups(o._funnelarealayer,t,"trace").each(function(t){var i=d.select(this),l=t[0],g=l.trace;r(t),i.each(function(){var r=d.select(this).selectAll("g.slice").data(t);r.enter().append("g").classed("slice",!0),r.exit().remove(),r.each(function(r,h){if(r.hidden)return void d.select(this).selectAll("path,g").remove();r.pointNumber=r.i,r.curveNumber=g.index;var i=l.cx,f=l.cy,_=d.select(this),w=_.selectAll("path.surface").data([r]);w.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),_.call(b,e,t);var k="M"+(i+r.TR[0])+","+(f+r.TR[1])+a(r.TR,r.BR)+a(r.BR,r.BL)+a(r.BL,r.TL)+"Z";w.attr("d",k),A(e,r,l);var T=x.castOption(g.textposition,r.pts),S=_.selectAll("g.slicetext").data(r.text&&"none"!==T?[0]:[]);S.enter().append("g").classed("slicetext",!0),S.exit().remove(),S.each(function(){var a=p.ensureSingle(d.select(this),"text","",function(e){e.attr("data-notex",1)}),l=p.ensureUniformFontSize(e,v(g,r,o.font));a.text(r.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(c.font,l).call(u.convertToTspans,e);var x=c.bBox(a.node()),_=n(r.BL[1],r.BR[1])+f,b=s(r.TL[1],r.TR[1])+f,w,k,T;k=s(r.TL[0],r.BL[0])+i,T=n(r.TR[0],r.BR[0])+i,w=m(k,T,_,b,x,{isHorizontal:!0,constrained:!0,angle:0,anchor:"middle"}),w.fontSize=l.size,y(g.type,w,o),t[h].transform=w,a.attr("transform",p.getTextTransform(w))})});var i=d.select(this).selectAll("g.titletext").data(g.title.text?[0]:[]);i.enter().append("g").classed("titletext",!0),i.exit().remove(),i.each(function(){var t=p.ensureSingle(d.select(this),"text","",function(e){e.attr("data-notex",1)}),a=g.title.text;g._meta&&(a=p.templateString(a,g._meta)),t.text(a).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(c.font,g.title.font).call(u.convertToTspans,e);var r=T(l,o._size);t.attr("transform","translate("+r.x+","+r.y+")"+(1>r.scale?"scale("+r.scale+")":"")+"translate("+r.tx+","+r.ty+")")})})})}},{"../../components/drawing":546,"../../lib":657,"../../lib/svg_text_utils":681,"../bar/plot":809,"../bar/uniform_text":814,"../pie/helpers":1041,"../pie/plot":1045,d3:108}],941:[function(e,t){'use strict';var a=e("d3"),o=e("../pie/style_one"),r=e("../bar/uniform_text").resizeText;t.exports=function(e){var t=e._fullLayout._funnelarealayer.selectAll(".trace");r(e,t,"funnelarea"),t.each(function(e){var t=e[0],r=t.trace,i=a.select(this);i.style({opacity:r.opacity}),i.selectAll("path.surface").each(function(e){a.select(this).call(o,e,r)})})}},{"../bar/uniform_text":814,"../pie/style_one":1047,d3:108}],942:[function(e,t){'use strict';var a=e("../scatter/attributes"),o=e("../../plots/attributes"),r=e("../../plots/template_attributes").hovertemplateAttrs,i=e("../../components/colorscale/attributes"),n=e("../../constants/docs").FORMAT_LINK,l=e("../../lib/extend").extendFlat;t.exports=l({z:{valType:"data_array",editType:"calc"},x:l({},a.x,{impliedEdits:{xtype:"array"}}),x0:l({},a.x0,{impliedEdits:{xtype:"scaled"}}),dx:l({},a.dx,{impliedEdits:{xtype:"scaled"}}),y:l({},a.y,{impliedEdits:{ytype:"array"}}),y0:l({},a.y0,{impliedEdits:{ytype:"scaled"}}),dy:l({},a.dy,{impliedEdits:{ytype:"scaled"}}),text:{valType:"data_array",editType:"calc"},hovertext:{valType:"data_array",editType:"calc"},transpose:{valType:"boolean",dflt:!1,editType:"calc"},xtype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},ytype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},zsmooth:{valType:"enumerated",values:["fast","best",!1],dflt:!1,editType:"calc"},hoverongaps:{valType:"boolean",dflt:!0,editType:"none"},connectgaps:{valType:"boolean",editType:"calc"},xgap:{valType:"number",dflt:0,min:0,editType:"plot"},ygap:{valType:"number",dflt:0,min:0,editType:"plot"},zhoverformat:{valType:"string",dflt:"",editType:"none"},hovertemplate:r(),showlegend:l({},o.showlegend,{dflt:!1})},{transforms:void 0},i("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":531,"../../constants/docs":628,"../../lib/extend":648,"../../plots/attributes":702,"../../plots/template_attributes":783,"../scatter/attributes":1062}],943:[function(e,t){'use strict';var a=Math.abs,o=e("../../registry"),r=e("../../lib"),n=e("../../plots/cartesian/axes"),l=e("../histogram2d/calc"),s=e("../../components/colorscale/calc"),d=e("./convert_column_xyz"),c=e("./clean_2d_array"),p=e("./interp2d"),u=e("./find_empties"),g=e("./make_bound_array");t.exports=function(e,t){function m(e){w=t._input.zsmooth=t.zsmooth=!1,r.warn("cannot use zsmooth: \"fast\": "+e)}var h=n.getFromId(e,t.xaxis||"x"),f=n.getFromId(e,t.yaxis||"y"),_=o.traceIs(t,"contour"),b=o.traceIs(t,"histogram"),v=o.traceIs(t,"gl2d"),w=_?"best":t.zsmooth,k,T,A,S,C,L,E,I,P;if(h._minDtick=0,f._minDtick=0,b)P=l(e,t),k=P.x,T=P.x0,A=P.dx,S=P.y,C=P.y0,L=P.dy,E=P.z;else{var D=t.z;r.isArray1D(D)?(d(t,h,f,"x","y",["z"]),k=t._x,S=t._y,D=t._z):(k=t._x=t.x?h.makeCalcdata(t,"x"):[],S=t._y=t.y?f.makeCalcdata(t,"y"):[]),T=t.x0,A=t.dx,C=t.y0,L=t.dy,E=c(D,t,h,f),(_||t.connectgaps)&&(t._emptypoints=u(E),p(E,t._emptypoints))}if("fast"===w)if("log"===h.type||"log"===f.type)m("log axis found");else if(!b){if(k.length){var O=(k[k.length-1]-k[0])/(k.length-1),R=a(O/100);for(I=0;I<k.length-1;I++)if(a(k[I+1]-k[I]-O)>R){m("x scale is not linear");break}}if(S.length&&"fast"===w){var M=(S[S.length-1]-S[0])/(S.length-1),j=a(M/100);for(I=0;I<S.length-1;I++)if(a(S[I+1]-S[I]-M)>j){m("y scale is not linear");break}}}var B=r.maxRowLength(E),F="scaled"===t.xtype?"":k,N=g(t,F,T,A,B,h),V="scaled"===t.ytype?"":S,U=g(t,V,C,L,E.length,f);v||(t._extremes[h._id]=n.findExtremes(h,N),t._extremes[f._id]=n.findExtremes(f,U));var H={x:N,y:U,z:E,text:t._text||t.text,hovertext:t._hovertext||t.hovertext};if(F&&F.length===N.length-1&&(H.xCenter=F),V&&V.length===U.length-1&&(H.yCenter=V),b&&(H.xRanges=P.xRanges,H.yRanges=P.yRanges,H.pts=P.pts),_||s(e,t,{vals:E,cLetter:"z"}),_&&t.contours&&"heatmap"===t.contours.coloring){var q={type:"contour"===t.type?"heatmap":"histogram2d",xcalendar:t.xcalendar,ycalendar:t.ycalendar};H.xfill=g(q,F,T,A,B,h),H.yfill=g(q,V,C,L,E.length,f)}return[H]}},{"../../components/colorscale/calc":532,"../../lib":657,"../../plots/cartesian/axes":705,"../../registry":788,"../histogram2d/calc":974,"./clean_2d_array":944,"./convert_column_xyz":946,"./find_empties":948,"./interp2d":951,"./make_bound_array":952}],944:[function(e,t){'use strict';var a=e("fast-isnumeric"),o=e("../../lib"),r=e("../../constants/numerical").BADNUM;t.exports=function(e,t,n,l){function s(e){return a(e)?+e:void 0}function d(e){if(t&&"carpet"!==t.type&&"contourcarpet"!==t.type&&e&&"category"===e.type&&t["_"+e._id.charAt(0)].length){var a=e._id.charAt(0),n={},l=t["_"+a+"CategoryMap"]||t[a];for(m=0;m<l.length;m++)n[l[m]]=m;return function(t){var a=n[e._categories[t]];return a+1?a:r}}return o.identity}var c,p,u,g,m,h;if(t&&t.transpose){for(c=0,m=0;m<e.length;m++)c=Math.max(c,e[m].length);if(0===c)return!1;u=function(e){return e.length},g=function(e,t,a){return(e[a]||[])[t]}}else c=e.length,u=function(e,t){return e[t].length},g=function(e,t,a){return(e[t]||[])[a]};var y=function(e,t,a){return t===r||a===r?r:g(e,t,a)},f=d(n),x=d(l);l&&"category"===l.type&&(c=l._categories.length);var _=Array(c);for(m=0;m<c;m++)for(p=n&&"category"===n.type?n._categories.length:u(e,m),_[m]=Array(p),h=0;h<p;h++)_[m][h]=s(y(e,x(m),f(h)));return _}},{"../../constants/numerical":633,"../../lib":657,"fast-isnumeric":201}],945:[function(e,t){'use strict';t.exports={min:"zmin",max:"zmax"}},{}],946:[function(e,t){'use strict';var a=e("../../lib"),o=e("../../constants/numerical").BADNUM;t.exports=function(e,t,r,n,l,s){var d=e._length,c=t.makeCalcdata(e,n),p=r.makeCalcdata(e,l),u=e.text,g=u!==void 0&&a.isArray1D(u),m=e.hovertext,h=m!==void 0&&a.isArray1D(m),y=a.distinctVals(c),f=y.vals,x=a.distinctVals(p),_=x.vals,b=[],v,w,k,T;for(v=0;v<s.length;v++)b[v]=a.init2dArray(_.length,f.length);g&&(k=a.init2dArray(_.length,f.length)),h&&(T=a.init2dArray(_.length,f.length));var A=a.init2dArray(_.length,f.length);for(v=0;v<d;v++)if(c[v]!==o&&p[v]!==o){var S=a.findBin(c[v]+y.minDiff/2,f),C=a.findBin(p[v]+x.minDiff/2,_);for(w=0;w<s.length;w++){var L=s[w],E=e[L],I=b[w];I[C][S]=E[v],A[C][S]=v}g&&(k[C][S]=u[v]),h&&(T[C][S]=m[v])}for(e["_"+n]=f,e["_"+l]=_,w=0;w<s.length;w++)e["_"+s[w]]=b[w];g&&(e._text=k),h&&(e._hovertext=T),t&&"category"===t.type&&(e["_"+n+"CategoryMap"]=f.map(function(e){return t._categories[e]})),r&&"category"===r.type&&(e["_"+l+"CategoryMap"]=_.map(function(e){return r._categories[e]})),e._after2before=A}},{"../../constants/numerical":633,"../../lib":657}],947:[function(e,t){'use strict';var a=e("../../lib"),o=e("./xyz_defaults"),r=e("./style_defaults"),i=e("../../components/colorscale/defaults"),n=e("./attributes");t.exports=function(e,t,l,s){function d(o,r){return a.coerce(e,t,n,o,r)}var c=o(e,t,d,s);return c?void(d("text"),d("hovertext"),d("hovertemplate"),r(e,t,d,s),d("hoverongaps"),d("connectgaps",a.isArray1D(t.z)&&!1!==t.zsmooth),i(e,t,s,d,{prefix:"",cLetter:"z"})):void(t.visible=!1)}},{"../../components/colorscale/defaults":534,"../../lib":657,"./attributes":942,"./style_defaults":955,"./xyz_defaults":956}],948:[function(e,t){'use strict';var a=e("../../lib").maxRowLength;t.exports=function(e){var t=[],o={},r=[],n=e[0],l=[],s=[0,0,0],d=a(e),c,u,g,m,h,y,f,x;for(u=0;u<e.length;u++)for(c=l,l=n,n=e[u+1]||[],g=0;g<d;g++)void 0===l[g]&&(y=(void 0===l[g-1]?0:1)+(void 0===l[g+1]?0:1)+(void 0===c[g]?0:1)+(void 0===n[g]?0:1),y?(0===u&&y++,0===g&&y++,u===e.length-1&&y++,g===l.length-1&&y++,4>y&&(o[[u,g]]=[u,g,y]),t.push([u,g,y])):r.push([u,g]));for(;r.length;){for(f={},x=!1,h=r.length-1;0<=h;h--)m=r[h],u=m[0],g=m[1],y=((o[[u-1,g]]||s)[2]+(o[[u+1,g]]||s)[2]+(o[[u,g-1]]||s)[2]+(o[[u,g+1]]||s)[2])/20,y&&(f[m]=[u,g,y],r.splice(h,1),x=!0);if(!x)throw"findEmpties iterated with no new neighbors";for(m in f)o[m]=f[m],t.push(f[m])}return t.sort(function(e,t){return t[2]-e[2]})}},{"../../lib":657}],949:[function(e,t){'use strict';var a=Math.round,o=Math.min,r=Math.max,i=e("../../components/fx"),n=e("../../lib"),l=e("../../plots/cartesian/axes"),s=e("../../components/colorscale").extractOpts;t.exports=function(t,d,c,p,u,g){var m=t.cd[0],h=m.trace,f=t.xa,e=t.ya,_=m.x,x=m.y,y=m.z,b=m.xCenter,v=m.yCenter,w=m.zmask,k=h.zhoverformat,T=_,A=x,S,C,L,E;if(!1!==t.index){try{L=a(t.index[1]),E=a(t.index[0])}catch(a){return void n.error("Error hovering on heatmap, pointNumber must be [row,col], found:",t.index)}if(0>L||L>=y[0].length||0>E||E>y.length)return}else{if(0<i.inbox(d-_[0],d-_[_.length-1],0)||0<i.inbox(c-x[0],c-x[x.length-1],0))return;if(g){var I;for(T=[2*_[0]-_[1]],I=1;I<_.length;I++)T.push((_[I]+_[I-1])/2);for(T.push([2*_[_.length-1]-_[_.length-2]]),A=[2*x[0]-x[1]],I=1;I<x.length;I++)A.push((x[I]+x[I-1])/2);A.push([2*x[x.length-1]-x[x.length-2]])}L=r(0,o(T.length-2,n.findBin(d,T))),E=r(0,o(A.length-2,n.findBin(c,A)))}var P=f.c2p(_[L]),z=f.c2p(_[L+1]),D=e.c2p(x[E]),O=e.c2p(x[E+1]);g?(z=P,S=_[L],O=D,C=x[E]):(S=b?b[L]:(_[L]+_[L+1])/2,C=v?v[E]:(x[E]+x[E+1])/2,f&&"category"===f.type&&(S=_[L]),e&&"category"===e.type&&(C=x[E]),h.zsmooth&&(P=z=f.c2p(S),D=O=e.c2p(C)));var R=y[E][L];if(w&&!w[E][L]&&(R=void 0),void 0!==R||h.hoverongaps){var M;Array.isArray(m.hovertext)&&Array.isArray(m.hovertext[E])?M=m.hovertext[E][L]:Array.isArray(m.text)&&Array.isArray(m.text[E])&&(M=m.text[E][L]);var j=s(h),B={type:"linear",range:[j.min,j.max],hoverformat:k,_separators:f._separators,_numFormat:f._numFormat},F=l.tickText(B,R,"hover").text;return[n.extendFlat(t,{index:h._after2before?h._after2before[E][L]:[E,L],distance:t.maxHoverDistance,spikeDistance:t.maxSpikeDistance,x0:P,x1:z,y0:D,y1:O,xLabelVal:S,yLabelVal:C,zLabelVal:R,zLabel:F,text:M})]}}},{"../../components/colorscale":536,"../../components/fx":564,"../../lib":657,"../../plots/cartesian/axes":705}],950:[function(e,t){'use strict';t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc"),plot:e("./plot"),colorbar:e("./colorbar"),style:e("./style"),hoverPoints:e("./hover"),moduleType:"trace",name:"heatmap",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","2dMap","showLegend"],meta:{}}},{"../../plots/cartesian":718,"./attributes":942,"./calc":943,"./colorbar":945,"./defaults":947,"./hover":949,"./plot":953,"./style":954}],951:[function(e,t){'use strict';var r=Math.min,n=Math.max;function a(e){return .5-.25*r(1,.5*e)}function o(e,t,a){var o=0,l,s,c,u,g,m,h,y,f,x,_,b,v;for(u=0;u<t.length;u++){for(l=t[u],s=l[0],c=l[1],_=e[s][c],x=0,f=0,g=0;4>g;g++)m=d[g],h=e[s+m[0]],h&&(y=h[c+m[1]],void 0!==y&&(0===x?b=v=y:(b=r(b,y),v=n(v,y)),f++,x+=y));if(0===f)throw"iterateInterp2d order is wrong: no defined neighbors";e[s][c]=x/f,_===void 0?4>f&&(o=1):(e[s][c]=(1+a)*e[s][c]-a*_,v>b&&(o=n(o,Math.abs(e[s][c]-_)/(v-b))))}return o}var l=e("../../lib"),s=.01,d=[[-1,0],[1,0],[0,-1],[0,1]];t.exports=function(e,t){var r=1,n;for(o(e,t),n=0;n<t.length&&!(4>t[n][2]);n++);for(t=t.slice(n),n=0;100>n&&r>s;n++)r=o(e,t,a(r));return r>s&&l.log("interp2d didn't converge quickly",r),e}},{"../../lib":657}],952:[function(e,t){'use strict';var a=e("../../registry"),o=e("../../lib").isArrayOrTypedArray;t.exports=function(e,t,r,n,l,s){var d=[],c=a.traceIs(e,"contour"),p=a.traceIs(e,"histogram"),u=a.traceIs(e,"gl2d"),g=o(t)&&1<t.length,m,h,y;if(g&&!p&&"category"!==s.type){var f=t.length;if(f<=l){if(c||u)d=t.slice(0,l);else if(1===l)d=[t[0]-.5,t[0]+.5];else{for(d=[1.5*t[0]-.5*t[1]],y=1;y<f;y++)d.push(.5*(t[y-1]+t[y]));d.push(1.5*t[f-1]-.5*t[f-2])}if(f<l){var x=d[d.length-1],_=x-d[d.length-2];for(y=f;y<l;y++)x+=_,d.push(x)}}else return c?t.slice(0,l):t.slice(0,l+1)}else{var b=e[s._id.charAt(0)+"calendar"];if(p)m=s.r2c(r,0,b);else if(o(t)&&1===t.length)m=t[0];else if(void 0===r)m=0;else{var v="log"===s.type?s.d2c:s.r2c;m=v(r,0,b)}for(h=n||1,y=c||u?0:-.5;y<l;y++)d.push(m+h*y)}return d}},{"../../lib":657,"../../registry":788}],953:[function(e,t){'use strict';var l=Math.round,s=Math.min,d=Math.max,p=Math.floor;function a(e,t){var a=t.length-2,o=f.constrain(f.findBin(e,t),0,a),r=t[o],i=t[o+1],n=f.constrain(o+(e-r)/(i-r)-.5,0,a),s=l(n),d=Math.abs(n-s);return n&&n!==a&&d?{bin0:s,frac:d,bin1:l(s+d/(n-s))}:{bin0:s,bin1:s,frac:0}}function o(e,t){var a=t.length-1,o=f.constrain(f.findBin(e,t),0,a),r=t[o],i=t[o+1],n=(e-r)/(i-r)||0;return 0>=n?{bin0:o,bin1:o,frac:0}:.5>n?{bin0:o,bin1:o+1,frac:n}:{bin0:o+1,bin1:o,frac:1-n}}function r(e,t,a){e[t]=a[0],e[t+1]=a[1],e[t+2]=a[2],e[t+3]=l(255*a[3])}var u=e("d3"),g=e("tinycolor2"),h=e("../../registry"),f=e("../../lib"),_=e("../../components/colorscale").makeColorScaleFuncFromTrace,b=e("../../constants/xmlns_namespaces");t.exports=function(e,t,i,n){var c=t.xaxis,m=t.yaxis;f.makeTraceGroups(n,i,"hm").each(function(t){function w(e,t){if(void 0!==e){var a=J(e);return a[0]=l(a[0]),a[1]=l(a[1]),a[2]=l(a[2]),ie+=t,ne+=a[0]*t,le+=a[1]*t,se+=a[2]*t,a}return[0,0,0,0]}function k(e,t,a,o){var r=e[a.bin0];if(void 0===r)return w(void 0,1);var i=e[a.bin1],n=t[a.bin0],l=t[a.bin1],s;return s=void 0===i?void 0===l?0:void 0===n?2*(l-r):2*(2*l-n-r)/3:void 0===l?void 0===n?0:2*(2*r-i-n)/3:void 0===n?2*(2*l-i-r)/3:l+r-i-n,w(r+a.frac*(i-r||0)+o.frac*((n-r||0)+a.frac*s))}var T=u.select(this),A=t[0],S=A.trace,C=A.z,L=A.x,E=A.y,I=A.xCenter,P=A.yCenter,z=h.traceIs(S,"contour"),D=z?"best":S.zsmooth,O=C.length,R=f.maxRowLength(C),n=!1,M=!1,B,F,N,V,U,H;for(H=0;void 0===B&&H<L.length-1;)B=c.c2p(L[H]),H++;for(H=L.length-1;void 0===F&&0<H;)F=c.c2p(L[H]),H--;for(F<B&&(N=F,F=B,B=N,n=!0),H=0;void 0===V&&H<E.length-1;)V=m.c2p(E[H]),H++;for(H=E.length-1;void 0===U&&0<H;)U=m.c2p(E[H]),H--;if(U<V&&(N=V,V=U,U=N,M=!0),z&&(I=L,P=E,L=A.xfill,E=A.yfill),"fast"!==D){var q="best"===D?0:.5;B=d(-q*c._length,B),F=s((1+q)*c._length,F),V=d(-q*m._length,V),U=s((1+q)*m._length,U)}var G=l(F-B),Y=l(U-V);if(0>=G||0>=Y){var W=T.selectAll("image").data([]);return void W.exit().remove()}var X,Z;"fast"===D?(X=R,Z=O):(X=G,Z=Y);var K=document.createElement("canvas");K.width=X,K.height=Z;var $=K.getContext("2d"),J=_(S,{noNumericCheck:!0,returnArray:!0}),Q,ee;"fast"===D?(Q=n?function(e){return R-1-e}:f.identity,ee=M?function(e){return O-1-e}:f.identity):(Q=function(e){return f.constrain(l(c.c2p(L[e])-B),0,G)},ee=function(e){return f.constrain(l(m.c2p(E[e])-V),0,Y)});var te=ee(0),ae=[te,te],oe=n?0:1,re=M?0:1,ie=0,ne=0,le=0,se=0,de,ce,pe,ue,ge,me;if(D){var he=0,ye;try{ye=new Uint8Array(4*(G*Y))}catch(t){ye=Array(4*(G*Y))}if("best"===D){var fe=I||L,xe=P||E,_e=Array(fe.length),be=Array(xe.length),ve=Array(G),we=I?o:a,ke=P?o:a,Te,Ae,Se;for(H=0;H<fe.length;H++)_e[H]=l(c.c2p(fe[H])-B);for(H=0;H<xe.length;H++)be[H]=l(m.c2p(xe[H])-V);for(H=0;H<G;H++)ve[H]=we(H,_e);for(ce=0;ce<Y;ce++)for(Te=ke(ce,be),Ae=C[Te.bin0],Se=C[Te.bin1],H=0;H<G;H++,he+=4)me=k(Ae,Se,ve[H],Te),r(ye,he,me)}else for(ce=0;ce<O;ce++)for(ge=C[ce],ae=ee(ce),H=0;H<G;H++)me=w(ge[H],1),he=4*(ae*G+Q(H)),r(ye,he,me);var Ce=$.createImageData(G,Y);try{Ce.data.set(ye)}catch(t){var Le=Ce.data,Ee=Le.length;for(ce=0;ce<Ee;ce++)Le[ce]=ye[ce]}$.putImageData(Ce,0,0)}else{var Ie=S.xgap,Pe=S.ygap,ze=p(Ie/2),De=p(Pe/2);for(ce=0;ce<O;ce++)if(ge=C[ce],ae.reverse(),ae[re]=ee(ce+1),ae[0]!==ae[1]&&void 0!==ae[0]&&void 0!==ae[1])for(pe=Q(0),de=[pe,pe],H=0;H<R;H++)(de.reverse(),de[oe]=Q(H+1),de[0]!==de[1]&&void 0!==de[0]&&void 0!==de[1])&&(ue=ge[H],me=w(ue,(de[1]-de[0])*(ae[1]-ae[0])),$.fillStyle="rgba("+me.join(",")+")",$.fillRect(de[0]+ze,ae[0]+De,de[1]-de[0]-Ie,ae[1]-ae[0]-Pe))}ne=l(ne/ie),le=l(le/ie),se=l(se/ie);var Oe=g("rgb("+ne+","+le+","+se+")");e._hmpixcount=(e._hmpixcount||0)+ie,e._hmlumcount=(e._hmlumcount||0)+ie*Oe.getLuminance();var Re=T.selectAll("image").data(t);Re.enter().append("svg:image").attr({xmlns:b.svg,preserveAspectRatio:"none"}),Re.attr({height:Y,width:G,x:B,y:V,"xlink:href":K.toDataURL("image/png")})})}},{"../../components/colorscale":536,"../../constants/xmlns_namespaces":634,"../../lib":657,"../../registry":788,d3:108,tinycolor2:1309}],954:[function(e,t){'use strict';var a=e("d3");t.exports=function(e){a.select(e).selectAll(".hm image").style("opacity",function(e){return e.trace.opacity})}},{d3:108}],955:[function(e,t){'use strict';t.exports=function(e,t,a){var o=a("zsmooth");!1===o&&(a("xgap"),a("ygap")),a("zhoverformat")}},{}],956:[function(e,t){'use strict';var r=Math.min;function a(e,t){var a=t(e),o=a?t(e+"type","array"):"scaled";return"scaled"===o&&(t(e+"0"),t("d"+e)),a}function o(e){for(var t=!0,a=!1,o=!1,r=0,l;r<e.length;r++){if(l=e[r],!n.isArrayOrTypedArray(l)){t=!1;break}0<l.length&&(a=!0);for(var s=0;s<l.length;s++)if(i(l[s])){o=!0;break}}return t&&a&&o}var i=e("fast-isnumeric"),n=e("../../lib"),l=e("../../registry");t.exports=function(e,t,i,s,d,c){var p=i("z");d=d||"x",c=c||"y";var u,g;if(void 0===p||!p.length)return 0;if(n.isArray1D(e.z)){u=i(d),g=i(c);var m=n.minRowLength(u),h=n.minRowLength(g);if(0===m||0===h)return 0;t._length=r(m,h,p.length)}else{if(u=a(d,i),g=a(c,i),!o(p))return 0;i("transpose"),t._length=null}var f=l.getComponentMethod("calendars","handleTraceDefaults");return f(e,t,[d,c],s),!0}},{"../../lib":657,"../../registry":788,"fast-isnumeric":201}],957:[function(e,t){'use strict';for(var a=e("../heatmap/attributes"),o=e("../../components/colorscale/attributes"),r=e("../../lib/extend").extendFlat,n=e("../../plot_api/edit_types").overrideAll,l=["z","x","x0","dx","y","y0","dy","text","transpose","xtype","ytype"],s={},d=0,c;d<l.length;d++)c=l[d],s[c]=a[c];r(s,o("",{cLetter:"z",autoColorDflt:!1})),t.exports=n(s,"calc","nested")},{"../../components/colorscale/attributes":531,"../../lib/extend":648,"../../plot_api/edit_types":688,"../heatmap/attributes":942}],958:[function(e,t){'use strict';function a(e,t){this.scene=e,this.uid=t,this.type="heatmapgl",this.name="",this.hoverinfo="all",this.xData=[],this.yData=[],this.zData=[],this.textLabels=[],this.idToIndex=[],this.bounds=[0,0,0,0],this.options={z:[],x:[],y:[],shape:[0,0],colorLevels:[0],colorValues:[0,0,0,1]},this.heatmap=r(e.glplot,this.options),this.heatmap._trace=this}function o(e){for(var t=e.colorscale,a=e.zmin,o=e.zmax,r=t.length,l=Array(r),s=Array(4*r),d=0;d<r;d++){var c=t[d],p=n(c[1]);l[d]=a+c[0]*(o-a);for(var u=0;4>u;u++)s[4*d+u]=p[u]}return{colorLevels:l,colorValues:s}}var r=e("gl-heatmap2d"),i=e("../../plots/cartesian/axes"),n=e("../../lib/str2rgbarray"),l=a.prototype;l.handlePick=function(e){var t=this.options,a=t.shape,o=e.pointId,r=o%a[0],i=Math.floor(o/a[0]);return{trace:this,dataCoord:e.dataCoord,traceCoord:[t.x[r],t.y[i],t.z[o]],textLabel:this.textLabels[o],name:this.name,pointIndex:[i,r],hoverinfo:this.hoverinfo}},l.update=function(e,t){var a=t[0];this.index=e.index,this.name=e.name,this.hoverinfo=e.hoverinfo;var r=a.z;this.options.z=[].concat.apply([],r);var n=r[0].length,l=r.length;this.options.shape=[n,l],this.options.x=a.x,this.options.y=a.y;var s=o(e);this.options.colorLevels=s.colorLevels,this.options.colorValues=s.colorValues,this.textLabels=[].concat.apply([],e.text),this.heatmap.update(this.options);var d=this.scene.xaxis,c=this.scene.yaxis;e._extremes[d._id]=i.findExtremes(d,a.x),e._extremes[c._id]=i.findExtremes(c,a.y)},l.dispose=function(){this.heatmap.dispose()},t.exports=function(e,t,o){var r=new a(e,t.uid);return r.update(t,o),r}},{"../../lib/str2rgbarray":680,"../../plots/cartesian/axes":705,"gl-heatmap2d":230}],959:[function(e,t){'use strict';t.exports={attributes:e("./attributes"),supplyDefaults:e("../heatmap/defaults"),colorbar:e("../heatmap/colorbar"),calc:e("../heatmap/calc"),plot:e("./convert"),moduleType:"trace",name:"heatmapgl",basePlotModule:e("../../plots/gl2d"),categories:["gl","gl2d","2dMap"],meta:{}}},{"../../plots/gl2d":745,"../heatmap/calc":943,"../heatmap/colorbar":945,"../heatmap/defaults":947,"./attributes":957,"./convert":958}],960:[function(e,t){'use strict';var a=e("../bar/attributes"),o=e("../../plots/template_attributes").hovertemplateAttrs,r=e("./bin_attributes"),i=e("./constants"),n=e("../../lib/extend").extendFlat;t.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},text:n({},a.text,{}),hovertext:n({},a.hovertext,{}),orientation:a.orientation,histfunc:{valType:"enumerated",values:["count","sum","avg","min","max"],dflt:"count",editType:"calc"},histnorm:{valType:"enumerated",values:["","percent","probability","density","probability density"],dflt:"",editType:"calc"},cumulative:{enabled:{valType:"boolean",dflt:!1,editType:"calc"},direction:{valType:"enumerated",values:["increasing","decreasing"],dflt:"increasing",editType:"calc"},currentbin:{valType:"enumerated",values:["include","exclude","half"],dflt:"include",editType:"calc"},editType:"calc"},nbinsx:{valType:"integer",min:0,dflt:0,editType:"calc"},xbins:r("x",!0),nbinsy:{valType:"integer",min:0,dflt:0,editType:"calc"},ybins:r("y",!0),autobinx:{valType:"boolean",dflt:null,editType:"calc"},autobiny:{valType:"boolean",dflt:null,editType:"calc"},bingroup:{valType:"string",dflt:"",editType:"calc"},hovertemplate:o({},{keys:i.eventDataKeys}),marker:a.marker,offsetgroup:a.offsetgroup,alignmentgroup:a.alignmentgroup,selected:a.selected,unselected:a.unselected,_deprecated:{bardir:a._deprecated.bardir}}},{"../../lib/extend":648,"../../plots/template_attributes":783,"../bar/attributes":798,"./bin_attributes":962,"./constants":966}],961:[function(e,t){'use strict';t.exports=function(e,t){for(var a=e.length,o=0,r=0;r<a;r++)t[r]?(e[r]/=t[r],o+=e[r]):e[r]=null;return o}},{}],962:[function(e,t){'use strict';t.exports=function(){return{start:{valType:"any",editType:"calc"},end:{valType:"any",editType:"calc"},size:{valType:"any",editType:"calc"},editType:"calc"}}},{}],963:[function(e,t){'use strict';var a=e("fast-isnumeric");t.exports={count:function(e,t,a){return a[e]++,1},sum:function(e,t,o,r){var i=r[t];return a(i)?(i=+i,o[e]+=i,i):0},avg:function(e,t,o,r,i){var n=r[t];return a(n)&&(n=+n,o[e]+=n,i[e]++),0},min:function(e,t,o,r){var i=r[t];if(a(i)){if(i=+i,!a(o[e]))return o[e]=i,i;if(o[e]>i){var n=i-o[e];return o[e]=i,n}}return 0},max:function(e,t,o,r){var i=r[t];if(a(i)){if(i=+i,!a(o[e]))return o[e]=i,i;if(o[e]<i){var n=i-o[e];return o[e]=i,n}}return 0}}},{"fast-isnumeric":201}],964:[function(e,t){'use strict';var n=Math.round,l=Math.min,s=Math.abs,d=Math.floor;function a(e,t,a,n){if(0>=e*t)return 1/0;for(var l=s(t-e),d="date"===a.type,c=o(l,d),p=0,u;10>p&&(u=o(80*c,d),c!==u)&&r(u,e,t,d,a,n);p++)c=u;return c}function o(e,t){return t&&e>y?e>g?e>1.1*p?p:e>1.1*u?u:g:e>m?m:e>h?h:y:Math.pow(10,d(Math.log(e)/Math.LN10))}function r(e,t,a,o,r,n){if(o&&e>g){var l=i(t,r,n),s=i(a,r,n),c=e===p?0:1;return l[c]!==s[c]}return .1<d(a/e)-d(t/e)}function i(e,t,a){var o=t.c2d(e,p,a).split("-");return""===o[0]&&(o.unshift(),o[0]="-"+o[0]),o}var c=e("../../constants/numerical"),p=c.ONEAVGYEAR,u=c.ONEAVGMONTH,g=c.ONEDAY,m=c.ONEHOUR,h=c.ONEMIN,y=c.ONESEC,f=e("../../plots/cartesian/axes").tickIncrement;t.exports=function(e,t,o,r,i){var d=-1.1*t,c=-.1*t,u=e-c,m=o[0],h=o[1],y=l(a(m+c,m+u,r,i),a(h+c,h+u,r,i)),x=l(a(m+d,m+c,r,i),a(h+d,h+c,r,i)),_,b;if(y>x&&x<s(h-m)/4e3?(_=y,b=!1):(_=l(y,x),b=!0),"date"===r.type&&_>g){var w=_===p?1:6,k=_===p?"M12":"M1";return function(t,a){var o=r.c2d(t,p,i),n=o.indexOf("-",w);0<n&&(o=o.substr(0,n));var l=r.d2c(o,0,i);if(l<t){var s=f(l,k,!1,i);(l+s)/2<t+e&&(l=s)}return a&&b?f(l,k,!0,i):l}}return function(t,a){var o=_*n(t/_);return o+_/10<t&&o+.9*_<t+e&&(o+=_),a&&b&&(o-=_),o}}},{"../../constants/numerical":633,"../../plots/cartesian/axes":705}],965:[function(e,t){'use strict';var s=Math.min;function a(e,t,a,r,n){function l(e,t,a){t[e+"Found"]?(t[e]=_(t[e]),null===t[e]&&(t[e]=a[e])):(A[e]=t[e]=a[e],c.nestedProperty(v[0],s+"."+e).set(a[e]))}var s=r+"bins",g=e._fullLayout,m=t["_"+r+"bingroup"],h=g._histogramBinOpts[m],y="overlay"===g.barmode,f=function(e){return a.r2c(e,0,k)},x=function(e){return a.c2r(e,0,k)},_="date"===a.type?function(e){return e||0===e?c.cleanDate(e,null,k):null}:function(e){return d(e)?+e:null},b,v,w,k,T,A,S;if(t["_"+r+"autoBinFinished"])delete t["_"+r+"autoBinFinished"];else{v=h.traces;var C=[],L=!0,E=!1,I=!1;for(b=0;b<v.length;b++)if(w=v[b],w.visible){var P=h.dirs[b];T=w["_"+P+"pos0"]=a.makeCalcdata(w,P),C=c.concat(C,T),delete w["_"+r+"autoBinFinished"],!0===t.visible&&(L?L=!1:(delete w._autoBin,w["_"+r+"autoBinFinished"]=1),p.traceIs(w,"2dMap")&&(E=!0),"histogram2dcontour"===w.type&&(I=!0))}k=v[0][r+"calendar"];var z=u.autoBin(C,a,h.nbins,E,k,h.sizeFound&&h.size),D=v[0]._autoBin={};if(A=D[h.dirs[0]]={},I&&(!h.size&&(z.start=x(u.tickIncrement(f(z.start),z.size,!0,k))),void 0===h.end&&(z.end=x(u.tickIncrement(f(z.end),z.size,!1,k)))),y&&!p.traceIs(t,"2dMap")&&0===z._dataSpan&&"category"!==a.type&&"multicategory"!==a.type){if(n)return[z,T,!0];z=o(e,t,a,r,s)}S=w.cumulative||{},S.enabled&&"include"!==S.currentbin&&("decreasing"===S.direction?z.start=x(u.tickIncrement(f(z.start),z.size,!0,k)):z.end=x(u.tickIncrement(f(z.end),z.size,!1,k))),h.size=z.size,h.sizeFound||(A.size=z.size,c.nestedProperty(v[0],s+".size").set(z.size)),l("start",h,z),l("end",h,z)}T=t["_"+r+"pos0"],delete t["_"+r+"pos0"];var O=t._input[s]||{},R=c.extendFlat({},h),M=h.start,j=a.r2l(O.start),B=void 0!==j;if((h.startFound||B)&&j!==a.r2l(M)){var F=B?j:c.aggNums(Math.min,null,T),N={type:"category"===a.type||"multicategory"===a.type?"linear":a.type,r2l:a.r2l,dtick:h.size,tick0:M,calendar:k,range:[F,u.tickIncrement(F,h.size,!1,k)].map(a.l2r)},V=u.tickFirst(N);V>a.r2l(F)&&(V=u.tickIncrement(V,h.size,!0,k)),R.start=a.l2r(V),B||c.nestedProperty(t,s+".start").set(R.start)}var U=h.end,H=a.r2l(O.end),q=void 0!==H;if((h.endFound||q)&&H!==a.r2l(U)){var G=q?H:c.aggNums(Math.max,null,T);R.end=a.l2r(G),q||c.nestedProperty(t,s+".start").set(R.end)}var Y="autobin"+r;return!1===t._input[Y]&&(t._input[s]=c.extendFlat({},t[s]||{}),delete t._input[Y],delete t[Y]),[R,T]}function o(e,t,o,n,l){var d=e._fullLayout,p=r(e,t),u=!1,g=1/0,m=[t],h,y,f;for(h=0;h<p.length;h++)if(y=p[h],y===t)u=!0;else if(!u)f=d._histogramBinOpts[y["_"+n+"bingroup"]],g=s(g,f.size||y[l].size);else{var x=a(e,y,o,n,!0),_=x[0],b=x[2];y["_"+n+"autoBinFinished"]=1,y["_"+n+"pos0"]=x[1],b?m.push(y):g=s(g,_.size)}var v=Array(m.length);for(h=0;h<m.length;h++)for(var w=m[h]["_"+n+"pos0"],k=0;k<w.length;k++)if(void 0!==w[k]){v[h]=w[k];break}for(isFinite(g)||(g=c.distinctVals(v).minDiff),h=0;h<m.length;h++){y=m[h];var T=y[n+"calendar"],A={start:o.c2r(v[h]-g/2,0,T),end:o.c2r(v[h]+g/2,0,T),size:g};y._input[l]=y[l]=A,f=d._histogramBinOpts[y["_"+n+"bingroup"]],f&&c.extendFlat(f,A)}return t[l]}function r(e,t){for(var a=t.xaxis,o=t.yaxis,r=t.orientation,n=[],l=e._fullData,s=0,d;s<l.length;s++)d=l[s],"histogram"===d.type&&!0===d.visible&&d.orientation===r&&d.xaxis===a&&d.yaxis===o&&n.push(d);return n}function l(e,t,a){function o(t){s=e[t],e[t]/=2}function r(t){l=e[t],e[t]=s+l/2,s+=l}var n,l,s;if("half"===a){if("increasing"===t)for(o(0),n=1;n<e.length;n++)r(n);else for(o(e.length-1),n=e.length-2;0<=n;n--)r(n);}else if("increasing"===t){for(n=1;n<e.length;n++)e[n]+=e[n-1];"exclude"===a&&(e.unshift(0),e.pop())}else{for(n=e.length-2;0<=n;n--)e[n]+=e[n+1];"exclude"===a&&(e.push(0),e.shift())}}var d=e("fast-isnumeric"),c=e("../../lib"),p=e("../../registry"),u=e("../../plots/cartesian/axes"),g=e("../bar/arrays_to_calcdata"),m=e("./bin_functions"),h=e("./norm_functions"),y=e("./average"),f=e("./bin_label_vals");t.exports={calc:function(e,t){var o=[],r=[],p=u.getFromId(e,"h"===t.orientation?t.yaxis:t.xaxis),x="h"===t.orientation?"y":"x",_={x:"y",y:"x"}[x],b=t[x+"calendar"],v=t.cumulative,w=a(e,t,p,x),k=w[0],T=w[1],A="string"==typeof k.size,S=[],C=A?S:k,L=[],E=[],I=[],P=0,z=t.histnorm,D=t.histfunc,O=-1!==z.indexOf("density"),R,M,j,B;v.enabled&&O&&(z=z.replace(/ ?density$/,""),O=!1);var F="max"===D||"min"===D?null:0,N=m.count,V=h[z],U=!1,H=function(e){return p.r2c(e,0,b)},q;for(c.isArrayOrTypedArray(t[_])&&"count"!==D&&(q=t[_],U="avg"===D,N=m[D]),R=H(k.start),j=H(k.end)+(R-u.tickIncrement(R,k.size,!1,b))/1e6;R<j&&1e6>o.length&&(M=u.tickIncrement(R,k.size,!1,b),o.push((R+M)/2),r.push(F),I.push([]),S.push(R),O&&L.push(1/(M-R)),U&&E.push(0),!(M<=R));)R=M;S.push(R),A||"date"!==p.type||(C={start:H(C.start),end:H(C.end),size:C.size}),e._fullLayout._roundFnOpts||(e._fullLayout._roundFnOpts={});var G=t["_"+x+"bingroup"],Y={leftGap:1/0,rightGap:1/0};G&&(!e._fullLayout._roundFnOpts[G]&&(e._fullLayout._roundFnOpts[G]=Y),Y=e._fullLayout._roundFnOpts[G]);var W=r.length,X=!0,Z=Y.leftGap,K=Y.rightGap,$={};for(R=0;R<T.length;R++){var J=T[R];B=c.findBin(J,C),0<=B&&B<W&&(P+=N(B,R,r,q,E),X&&I[B].length&&J!==T[I[B][0]]&&(X=!1),I[B].push(R),$[R]=B,Z=s(Z,J-S[B]),K=s(K,S[B+1]-J))}Y.leftGap=Z,Y.rightGap=K;var Q;X||(Q=function(t,a){return function(){var o=e._fullLayout._roundFnOpts[G];return f(o.leftGap,o.rightGap,S,p,b)(t,a)}}),U&&(P=y(r,E)),V&&V(r,P,L),v.enabled&&l(r,v.direction,v.currentbin);var ee=s(o.length,r.length),te=[],ae=0,oe=ee-1;for(R=0;R<ee;R++)if(r[R]){ae=R;break}for(R=ee-1;R>=ae;R--)if(r[R]){oe=R;break}for(R=ae;R<=oe;R++)if(d(o[R])&&d(r[R])){var re={p:o[R],s:r[R],b:0};v.enabled||(re.pts=I[R],X?re.ph0=re.ph1=I[R].length?T[I[R][0]]:o[R]:(t._computePh=!0,re.ph0=Q(S[R]),re.ph1=Q(S[R+1],!0))),te.push(re)}return 1===te.length&&(te[0].width1=u.tickIncrement(te[0].p,k.size,!1,b)-te[0].p),g(te,t),c.isArrayOrTypedArray(t.selectedpoints)&&c.tagSelected(te,t,$),te},calcAllAutoBins:a}},{"../../lib":657,"../../plots/cartesian/axes":705,"../../registry":788,"../bar/arrays_to_calcdata":797,"./average":961,"./bin_functions":963,"./bin_label_vals":964,"./norm_functions":972,"fast-isnumeric":201}],966:[function(e,t){'use strict';t.exports={eventDataKeys:["binNumber"]}},{}],967:[function(e,t){'use strict';var a=e("../../lib"),o=e("../../plots/cartesian/axis_ids"),r=e("../../registry").traceIs,n=e("../bar/defaults").handleGroupingDefaults,l=a.nestedProperty,s=o.getAxisGroup,d=[{aStr:{x:"xbins.start",y:"ybins.start"},name:"start"},{aStr:{x:"xbins.end",y:"ybins.end"},name:"end"},{aStr:{x:"xbins.size",y:"ybins.size"},name:"size"},{aStr:{x:"nbinsx",y:"nbinsy"},name:"nbins"}],c=["x","y"];t.exports=function(e,t){function p(e,t){return a.coerce(_._input,_,_._module.attributes,e,t)}function u(e){return"v"===e.orientation?"x":"y"}function g(e,a){var r=o.getFromTrace({_fullLayout:t},e,a);return r.type}function m(e,t,o){var r=e.uid+"__"+o;t||(t=r);var i=g(e,o),n=e[o+"calendar"]||"",l=h[t],s=!0;l&&(i===l.axType&&n===l.calendar?(s=!1,l.traces.push(e),l.dirs.push(o)):(t=r,i!==l.axType&&a.warn(["Attempted to group the bins of trace",e.index,"set on a","type:"+i,"axis","with bins on","type:"+l.axType,"axis."].join(" ")),n!==l.calendar&&a.warn(["Attempted to group the bins of trace",e.index,"set with a",n,"calendar","with bins",l.calendar?"on a "+l.calendar+" calendar":"w/o a set calendar"].join(" ")))),s&&(h[t]={traces:[e],dirs:[o],axType:i,calendar:e[o+"calendar"]||""}),e["_"+o+"bingroup"]=t}var h=t._histogramBinOpts={},y=[],f={},x=[],_,b,v,w,T,A,S;for(T=0;T<e.length;T++)_=e[T],r(_,"histogram")&&(y.push(_),delete _._xautoBinFinished,delete _._yautoBinFinished,!r(_,"2dMap")&&n(_._input,_,t,p));var C=t._alignmentOpts||{};for(T=0;T<y.length;T++){if(_=y[T],v="",!r(_,"2dMap")){if(w=u(_),"group"===t.barmode&&_.alignmentgroup){var L=_[w+"axis"],E=s(t,L)+_.orientation;(C[E]||{})[_.alignmentgroup]&&(v=E)}v||"overlay"===t.barmode||(v=s(t,_.xaxis)+s(t,_.yaxis)+u(_))}v?(!f[v]&&(f[v]=[]),f[v].push(_)):x.push(_)}for(v in f){if(b=f[v],1===b.length){x.push(b[0]);continue}var I=!1;for(T=0;T<b.length;T++){_=b[T],I=p("bingroup");break}for(v=I||v,T=0;T<b.length;T++){_=b[T];var P=_._input.bingroup;P&&P!==v&&a.warn(["Trace",_.index,"must match","within bingroup",v+".","Ignoring its bingroup:",P,"setting."].join(" ")),_.bingroup=v,m(_,v,u(_))}}for(T=0;T<x.length;T++){_=x[T];var z=p("bingroup");if(r(_,"2dMap"))for(S=0;2>S;S++){w=c[S];var D=p(w+"bingroup",z?z+"__"+w:null);m(_,D,w)}else m(_,z,u(_))}for(v in h){var O=h[v];for(b=O.traces,A=0;A<d.length;A++){var R=d[A],M=R.name,B,F;if(!("nbins"===M&&O.sizeFound)){for(T=0;T<b.length;T++){if(_=b[T],w=O.dirs[T],B=R.aStr[w],void 0!==l(_._input,B).get()){O[M]=p(B),O[M+"Found"]=!0;break}F=(_._autoBin||{})[w]||{},F[M]&&l(_,B).set(F[M])}if("start"===M||"end"===M)for(;T<b.length;T++)_=b[T],_["_"+w+"bingroup"]&&(F=(_._autoBin||{})[w]||{},p(B,F[M]));"nbins"!==M||O.sizeFound||O.nbinsFound||(_=b[0],O[M]=p(B))}}}}},{"../../lib":657,"../../plots/cartesian/axis_ids":708,"../../registry":788,"../bar/defaults":802}],968:[function(e,t){'use strict';var a=e("../../registry"),o=e("../../lib"),r=e("../../components/color"),i=e("../bar/style_defaults"),n=e("./attributes");t.exports=function(e,t,l,s){function d(a,r){return o.coerce(e,t,n,a,r)}var c=d("x"),p=d("y"),u=d("cumulative.enabled");u&&(d("cumulative.direction"),d("cumulative.currentbin")),d("text"),d("hovertext"),d("hovertemplate");var g=d("orientation",p&&!c?"h":"v"),m="v"===g?"x":"y",h="v"===g?"y":"x",y=c&&p?Math.min(o.minRowLength(c)&&o.minRowLength(p)):o.minRowLength(t[m]||[]);if(!y)return void(t.visible=!1);t._length=y;var f=a.getComponentMethod("calendars","handleTraceDefaults");f(e,t,["x","y"],s);var x=t[h];x&&d("histfunc"),d("histnorm"),d("autobin"+m),i(e,t,d,l,s),o.coerceSelectionMarkerOpacity(t,d);var _=(t.marker.line||{}).color,b=a.getComponentMethod("errorbars","supplyDefaults");b(e,t,_||r.defaultLine,{axis:"y"}),b(e,t,_||r.defaultLine,{axis:"x",inherit:"y"})}},{"../../components/color":524,"../../lib":657,"../../registry":788,"../bar/style_defaults":813,"./attributes":960}],969:[function(e,t){'use strict';t.exports=function(e,t,a,o,r){if(e.x="xVal"in t?t.xVal:t.x,e.y="yVal"in t?t.yVal:t.y,"zLabelVal"in t&&(e.z=t.zLabelVal),t.xa&&(e.xaxis=t.xa),t.ya&&(e.yaxis=t.ya),!(a.cumulative||{}).enabled){var n=Array.isArray(r)?o[0].pts[r[0]][r[1]]:o[r].pts;e.pointNumbers=n,e.binNumber=e.pointNumber,delete e.pointNumber,delete e.pointIndex;var l;if(a._indexToPoints){l=[];for(var s=0;s<n.length;s++)l=l.concat(a._indexToPoints[n[s]])}else l=n;e.pointIndices=l}return e}},{}],970:[function(e,t){'use strict';var a=e("../bar/hover").hoverPoints,o=e("../../plots/cartesian/axes").hoverLabelText;t.exports=function(e,t,r,i){var n=a(e,t,r,i);if(n){e=n[0];var l=e.cd[e.index],s=e.cd[0].trace;if(!s.cumulative.enabled){var d="h"===s.orientation?"y":"x";e[d+"Label"]=o(e[d+"a"],l.ph0,l.ph1)}return n}}},{"../../plots/cartesian/axes":705,"../bar/hover":805}],971:[function(e,t){'use strict';t.exports={attributes:e("./attributes"),layoutAttributes:e("../bar/layout_attributes"),supplyDefaults:e("./defaults"),crossTraceDefaults:e("./cross_trace_defaults"),supplyLayoutDefaults:e("../bar/layout_defaults"),calc:e("./calc").calc,crossTraceCalc:e("../bar/cross_trace_calc").crossTraceCalc,plot:e("../bar/plot").plot,layerName:"barlayer",style:e("../bar/style").style,styleOnSelect:e("../bar/style").styleOnSelect,colorbar:e("../scatter/marker_colorbar"),hoverPoints:e("./hover"),selectPoints:e("../bar/select"),eventData:e("./event_data"),moduleType:"trace",name:"histogram",basePlotModule:e("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","histogram","oriented","errorBarsOK","showLegend"],meta:{}}},{"../../plots/cartesian":718,"../bar/cross_trace_calc":801,"../bar/layout_attributes":807,"../bar/layout_defaults":808,"../bar/plot":809,"../bar/select":810,"../bar/style":812,"../scatter/marker_colorbar":1080,"./attributes":960,"./calc":965,"./cross_trace_defaults":967,"./defaults":968,"./event_data":969,"./hover":970}],972:[function(e,t){'use strict';t.exports={percent:function(e,t){for(var a=e.length,o=0;o<a;o++)e[o]*=100/t},probability:function(e,t){for(var a=e.length,o=0;o<a;o++)e[o]/=t},density:function(e,t,a,o){var r=e.length;o=o||1;for(var i=0;i<r;i++)e[i]*=a[i]*o},"probability density":function(e,t,a,o){var r=e.length;o&&(t/=o);for(var i=0;i<r;i++)e[i]*=a[i]/t}}},{}],973:[function(e,t){'use strict';var a=e("../histogram/attributes"),o=e("../histogram/bin_attributes"),r=e("../heatmap/attributes"),i=e("../../plots/attributes"),n=e("../../plots/template_attributes").hovertemplateAttrs,l=e("../../components/colorscale/attributes"),s=e("../../lib/extend").extendFlat;t.exports=s({x:a.x,y:a.y,z:{valType:"data_array",editType:"calc"},marker:{color:{valType:"data_array",editType:"calc"},editType:"calc"},histnorm:a.histnorm,histfunc:a.histfunc,nbinsx:a.nbinsx,xbins:o("x"),nbinsy:a.nbinsy,ybins:o("y"),autobinx:a.autobinx,autobiny:a.autobiny,bingroup:s({},a.bingroup,{}),xbingroup:s({},a.bingroup,{}),ybingroup:s({},a.bingroup,{}),xgap:r.xgap,ygap:r.ygap,zsmooth:r.zsmooth,zhoverformat:r.zhoverformat,hovertemplate:n({},{keys:"z"}),showlegend:s({},i.showlegend,{dflt:!1})},l("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":531,"../../lib/extend":648,"../../plots/attributes":702,"../../plots/template_attributes":783,"../heatmap/attributes":942,"../histogram/attributes":960,"../histogram/bin_attributes":962}],974:[function(e,t){'use strict';var l=Math.min;function a(e,t,a,o){var r=Array(e),n;if(o)for(n=0;n<e;n++)r[n]=1/(t[n+1]-t[n]);else{for(n=0;n<e;n++)r[n]=1/a}return r}function o(e,t){return{start:e(t.start),end:e(t.end),size:t.size}}function r(e,t,a,o,r,n){var l=e.length-1,s=Array(l),d=g(a,o,e,r,n),c;for(c=0;c<l;c++){var p=(t||[])[c];s[c]=p===void 0?[d(e[c]),d(e[c+1],!0)]:[p,p]}return s}var s=e("../../lib"),d=e("../../plots/cartesian/axes"),c=e("../histogram/bin_functions"),p=e("../histogram/norm_functions"),u=e("../histogram/average"),g=e("../histogram/bin_label_vals"),h=e("../histogram/calc").calcAllAutoBins;t.exports=function(e,t){var g=d.getFromId(e,t.xaxis),y=d.getFromId(e,t.yaxis),f=t.xcalendar,x=t.ycalendar,_=function(e){return g.r2c(e,0,f)},b=function(e){return y.r2c(e,0,x)},v=h(e,t,g,"x"),w=v[0],k=v[1],T=h(e,t,y,"y"),A=T[0],S=T[1],C=t._length,L,E,I,P;k.length>C&&k.splice(C,k.length-C),S.length>C&&S.splice(C,S.length-C);var D=[],z=[],O=[],R="string"==typeof w.size,M="string"==typeof A.size,B=[],F=[],N=R?B:w,V=M?F:A,U=0,H=[],q=[],G=t.histnorm,Y=t.histfunc,W=-1!==G.indexOf("density"),X="max"===Y||"min"===Y?null:0,Z=c.count,K=p[G],$=!1,J=[],Q=[],ee="z"in t?t.z:"marker"in t&&Array.isArray(t.marker.color)?t.marker.color:"";ee&&"count"!==Y&&($="avg"===Y,Z=c[Y]);var te=w.size,ae=_(w.start),oe=_(w.end)+(ae-d.tickIncrement(ae,te,!1,f))/1e6;for(L=ae;L<oe;L=d.tickIncrement(L,te,!1,f))z.push(X),B.push(L),$&&O.push(0);B.push(L);var re=z.length,ie=(L-ae)/re,ne=function(e){return g.c2r(e,0,f)}(ae+ie/2),le=A.size,se=b(A.start),de=b(A.end)+(se-d.tickIncrement(se,le,!1,x))/1e6;for(L=se;L<de;L=d.tickIncrement(L,le,!1,x)){D.push(z.slice()),F.push(L);var ce=Array(re);for(E=0;E<re;E++)ce[E]=[];q.push(ce),$&&H.push(O.slice())}F.push(L);var pe=D.length,ue=(L-se)/pe,ge=function(e){return y.c2r(e,0,x)}(se+ue/2);W&&(J=a(z.length,N,ie,R),Q=a(D.length,V,ue,M)),R||"date"!==g.type||(N=o(_,N)),M||"date"!==y.type||(V=o(b,V));var me=!0,he=!0,ye=Array(re),fe=Array(pe),xe=1/0,_e=1/0,be=1/0,ve=1/0;for(L=0;L<C;L++){var we=k[L],ke=S[L];I=s.findBin(we,N),P=s.findBin(ke,V),0<=I&&I<re&&0<=P&&P<pe&&(U+=Z(I,L,D[P],ee,H[P]),q[P][I].push(L),me&&(ye[I]===void 0?ye[I]=we:ye[I]!==we&&(me=!1)),he&&(fe[P]===void 0?fe[P]=ke:fe[P]!==ke&&(he=!1)),xe=l(xe,we-B[I]),_e=l(_e,B[I+1]-we),be=l(be,ke-F[P]),ve=l(ve,F[P+1]-ke))}if($)for(P=0;P<pe;P++)U+=u(D[P],H[P]);if(K)for(P=0;P<pe;P++)K(D[P],U,J,Q[P]);return{x:k,xRanges:r(B,me&&ye,xe,_e,g,f),x0:ne,dx:ie,y:S,yRanges:r(F,he&&fe,be,ve,y,x),y0:ge,dy:ue,z:D,pts:q}}},{"../../lib":657,"../../plots/cartesian/axes":705,"../histogram/average":961,"../histogram/bin_functions":963,"../histogram/bin_label_vals":964,"../histogram/calc":965,"../histogram/norm_functions":972}],975:[function(e,t){'use strict';var a=e("../../lib"),o=e("./sample_defaults"),r=e("../heatmap/style_defaults"),i=e("../../components/colorscale/defaults"),n=e("./attributes");t.exports=function(e,t,l,s){function d(o,r){return a.coerce(e,t,n,o,r)}o(e,t,d,s);!1===t.visible||(r(e,t,d,s),i(e,t,s,d,{prefix:"",cLetter:"z"}),d("hovertemplate"))}},{"../../components/colorscale/defaults":534,"../../lib":657,"../heatmap/style_defaults":955,"./attributes":973,"./sample_defaults":978}],976:[function(e,t){'use strict';var a=e("../heatmap/hover"),o=e("../../plots/cartesian/axes").hoverLabelText;t.exports=function(e,t,r,i,n,l){var s=a(e,t,r,i,n,l);if(s){e=s[0];var d=e.index,c=d[0],p=d[1],u=e.cd[0],g=u.xRanges[p],m=u.yRanges[c];return e.xLabel=o(e.xa,g[0],g[1]),e.yLabel=o(e.ya,m[0],m[1]),s}}},{"../../plots/cartesian/axes":705,"../heatmap/hover":949}],977:[function(e,t){'use strict';t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),crossTraceDefaults:e("../histogram/cross_trace_defaults"),calc:e("../heatmap/calc"),plot:e("../heatmap/plot"),layerName:"heatmaplayer",colorbar:e("../heatmap/colorbar"),style:e("../heatmap/style"),hoverPoints:e("./hover"),eventData:e("../histogram/event_data"),moduleType:"trace",name:"histogram2d",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","2dMap","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":718,"../heatmap/calc":943,"../heatmap/colorbar":945,"../heatmap/plot":953,"../heatmap/style":954,"../histogram/cross_trace_defaults":967,"../histogram/event_data":969,"./attributes":973,"./defaults":975,"./hover":976}],978:[function(e,t){'use strict';var a=e("../../registry"),o=e("../../lib");t.exports=function(e,t,r,i){var n=r("x"),l=r("y"),s=o.minRowLength(n),d=o.minRowLength(l);if(!s||!d)return void(t.visible=!1);t._length=Math.min(s,d);var c=a.getComponentMethod("calendars","handleTraceDefaults");c(e,t,["x","y"],i);var p=r("z")||r("marker.color");p&&r("histfunc"),r("histnorm"),r("autobinx"),r("autobiny")}},{"../../lib":657,"../../registry":788}],979:[function(e,t){'use strict';var a=e("../histogram2d/attributes"),o=e("../contour/attributes"),r=e("../../components/colorscale/attributes"),i=e("../../lib/extend").extendFlat;t.exports=i({x:a.x,y:a.y,z:a.z,marker:a.marker,histnorm:a.histnorm,histfunc:a.histfunc,nbinsx:a.nbinsx,xbins:a.xbins,nbinsy:a.nbinsy,ybins:a.ybins,autobinx:a.autobinx,autobiny:a.autobiny,bingroup:a.bingroup,xbingroup:a.xbingroup,ybingroup:a.ybingroup,autocontour:o.autocontour,ncontours:o.ncontours,contours:o.contours,line:{color:o.line.color,width:i({},o.line.width,{dflt:.5}),dash:o.line.dash,smoothing:o.line.smoothing,editType:"plot"},zhoverformat:a.zhoverformat,hovertemplate:a.hovertemplate},r("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":531,"../../lib/extend":648,"../contour/attributes":885,"../histogram2d/attributes":973}],980:[function(e,t){'use strict';var a=e("../../lib"),o=e("../histogram2d/sample_defaults"),r=e("../contour/contours_defaults"),i=e("../contour/style_defaults"),n=e("./attributes");t.exports=function(e,t,l,s){function d(o,r){return a.coerce(e,t,n,o,r)}o(e,t,d,s);!1===t.visible||(r(e,t,d,function(o){return a.coerce2(e,t,n,o)}),i(e,t,d,s),d("hovertemplate"))}},{"../../lib":657,"../contour/contours_defaults":892,"../contour/style_defaults":906,"../histogram2d/sample_defaults":978,"./attributes":979}],981:[function(e,t){'use strict';t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),crossTraceDefaults:e("../histogram/cross_trace_defaults"),calc:e("../contour/calc"),plot:e("../contour/plot").plot,layerName:"contourlayer",style:e("../contour/style"),colorbar:e("../contour/colorbar"),hoverPoints:e("../contour/hover"),moduleType:"trace",name:"histogram2dcontour",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":718,"../contour/calc":886,"../contour/colorbar":888,"../contour/hover":898,"../contour/plot":903,"../contour/style":905,"../histogram/cross_trace_defaults":967,"./attributes":979,"./defaults":980}],982:[function(e,t){'use strict';for(var a=e("../../plots/attributes"),o=e("../../plots/template_attributes").hovertemplateAttrs,r=e("../../lib/extend").extendFlat,n=e("./constants").colormodel,l=["rgb","rgba","hsl","hsla"],s=[],d=[],c=0;c<l.length;c++)s.push("For the `"+l[c]+"` colormodel, it is ["+n[l[c]].min.join(", ")+"]."),d.push("For the `"+l[c]+"` colormodel, it is ["+n[l[c]].max.join(", ")+"].");t.exports=r({z:{valType:"data_array",editType:"calc"},colormodel:{valType:"enumerated",values:l,dflt:"rgb",editType:"calc"},zmin:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},zmax:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dx:{valType:"number",dflt:1,editType:"calc"},dy:{valType:"number",dflt:1,editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"data_array",editType:"plot"},hoverinfo:r({},a.hoverinfo,{flags:["x","y","z","color","name","text"],dflt:"x+y+z+text+name"}),hovertemplate:o({},{keys:["z","color","colormodel"]}),transforms:void 0})},{"../../lib/extend":648,"../../plots/attributes":702,"../../plots/template_attributes":783,"./constants":984}],983:[function(e,t){'use strict';function a(e,t,a,o){return function(r){return i.constrain((r-e)*t,a,o)}}function o(e,t){return function(a){return i.constrain(a,e,t)}}function r(e){var t=e.colormodel,r=t.length,i=l.colormodel[t];e._sArray=[];for(var n=0;n<r;n++)i.min[n]!==e.zmin[n]||i.max[n]!==e.zmax[n]?e._sArray.push(a(e.zmin[n],(i.max[n]-i.min[n])/(e.zmax[n]-e.zmin[n]),i.min[n],i.max[n])):e._sArray.push(o(i.min[n],i.max[n]));return function(t){for(var a=t.slice(0,r),o=0,i;o<r;o++){if(i=a[o],!s(i))return!1;a[o]=e._sArray[o](i)}return a}}var i=e("../../lib"),l=e("./constants"),s=e("fast-isnumeric"),d=e("../../plots/cartesian/axes"),c=e("../../lib").maxRowLength;t.exports=function(e,t){var a=d.getFromId(e,t.xaxis||"x"),o=d.getFromId(e,t.yaxis||"y"),n=a.d2c(t.x0)-t.dx/2,l=o.d2c(t.y0)-t.dy/2,s=t.z.length,p=c(t.z),u=[n,n+p*t.dx],g=[l,l+s*t.dy],m;if(a&&"log"===a.type)for(m=0;m<p;m++)u.push(n+m*t.dx);if(o&&"log"===o.type)for(m=0;m<s;m++)g.push(l+m*t.dy);t._extremes[a._id]=d.findExtremes(a,u),t._extremes[o._id]=d.findExtremes(o,g),t._scaler=r(t);var h={x0:n,y0:l,z:t.z,w:p,h:s};return[h]}},{"../../lib":657,"../../plots/cartesian/axes":705,"./constants":984,"fast-isnumeric":201}],984:[function(e,t){'use strict';t.exports={colormodel:{rgb:{min:[0,0,0],max:[255,255,255],fmt:function(e){return e.slice(0,3)},suffix:["","",""]},rgba:{min:[0,0,0,0],max:[255,255,255,1],fmt:function(e){return e.slice(0,4)},suffix:["","","",""]},hsl:{min:[0,0,0],max:[360,100,100],fmt:function(e){var t=e.slice(0,3);return t[1]+="%",t[2]+="%",t},suffix:["\xB0","%","%"]},hsla:{min:[0,0,0,0],max:[360,100,100,1],fmt:function(e){var t=e.slice(0,4);return t[1]+="%",t[2]+="%",t},suffix:["\xB0","%","%",""]}}}},{}],985:[function(e,t){'use strict';var a=e("../../lib"),o=e("./attributes"),r=e("./constants");t.exports=function(e,t){function i(r,i){return a.coerce(e,t,o,r,i)}var n=i("z");if(void 0===n||!n.length||!n[0]||!n[0].length)return void(t.visible=!1);i("x0"),i("y0"),i("dx"),i("dy");var l=i("colormodel");i("zmin",r.colormodel[l].min),i("zmax",r.colormodel[l].max),i("text"),i("hovertext"),i("hovertemplate"),t._length=null}},{"../../lib":657,"./attributes":982,"./constants":984}],986:[function(e,t){'use strict';t.exports=function(e,t){return"xVal"in t&&(e.x=t.xVal),"yVal"in t&&(e.y=t.yVal),t.xa&&(e.xaxis=t.xa),t.ya&&(e.yaxis=t.ya),e.color=t.color,e.colormodel=t.trace.colormodel,e}},{}],987:[function(e,t){'use strict';var a=Math.abs,o=Math.floor,r=e("../../components/fx"),i=e("../../lib"),n=e("./constants");t.exports=function(e,t,l){var d=e.cd[0],p=d.trace,u=e.xa,g=e.ya;if(!(0<r.inbox(t-d.x0,t-(d.x0+d.w*p.dx),0)||0<r.inbox(l-d.y0,l-(d.y0+d.h*p.dy),0))){var m=o((t-d.x0)/p.dx),h=o(a(l-d.y0)/p.dy);if(d.z[h][m]){var y=d.hi||p.hoverinfo,f;if(y){var x=y.split("+");-1!==x.indexOf("all")&&(x=["color"]),-1!==x.indexOf("color")&&(f=!0)}var _=p.colormodel,b=_.length,v=p._scaler(d.z[h][m]),c=n.colormodel[_].suffix,s=[];(p.hovertemplate||f)&&(s.push("["+[v[0]+c[0],v[1]+c[1],v[2]+c[2]].join(", ")),4===b&&s.push(", "+v[3]+c[3]),s.push("]"),s=s.join(""),e.extraText=_.toUpperCase()+": "+s);var w;Array.isArray(p.hovertext)&&Array.isArray(p.hovertext[h])?w=p.hovertext[h][m]:Array.isArray(p.text)&&Array.isArray(p.text[h])&&(w=p.text[h][m]);var k=g.c2p(d.y0+(h+.5)*p.dy),T=d.x0+(m+.5)*p.dx,A=d.y0+(h+.5)*p.dy,S="["+d.z[h][m].slice(0,p.colormodel.length).join(", ")+"]";return[i.extendFlat(e,{index:[h,m],x0:u.c2p(d.x0+m*p.dx),x1:u.c2p(d.x0+(m+1)*p.dx),y0:k,y1:k,color:v,xVal:T,xLabelVal:T,yVal:A,yLabelVal:A,zLabelVal:S,text:w,hovertemplateLabels:{zLabel:S,colorLabel:s,"color[0]Label":v[0]+c[0],"color[1]Label":v[1]+c[1],"color[2]Label":v[2]+c[2],"color[3]Label":v[3]+c[3]}})]}}}},{"../../components/fx":564,"../../lib":657,"./constants":984}],988:[function(e,t){'use strict';t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc"),plot:e("./plot"),style:e("./style"),hoverPoints:e("./hover"),eventData:e("./event_data"),moduleType:"trace",name:"image",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","2dMap","noSortingByValue"],animatable:!1,meta:{}}},{"../../plots/cartesian":718,"./attributes":982,"./calc":983,"./defaults":985,"./event_data":986,"./hover":987,"./plot":989,"./style":990}],989:[function(e,t){'use strict';var a=Math.round,o=Math.min,r=Math.max,n=e("d3"),l=e("../../lib"),s=e("../../constants/xmlns_namespaces"),d=e("./constants");t.exports=function(e,t,i,c){var p=t.xaxis,u=t.yaxis;l.makeTraceGroups(c,i,"im").each(function(e){var t=n.select(this),g=e[0],m=g.trace,y=g.z,f=g.x0,x=g.y0,_=g.w,b=g.h,h=m.dx,v=m.dy,w,k,T,A,S,C;for(C=0;w===void 0&&C<_;)w=p.c2p(f+C*h),C++;for(C=_;k===void 0&&0<C;)k=p.c2p(f+C*h),C--;for(C=0;A===void 0&&C<b;)A=u.c2p(x+C*v),C++;for(C=b;S===void 0&&0<C;)S=u.c2p(x+C*v),C--;k<w&&(T=k,k=w,w=T),S<A&&(T=A,A=S,S=T);var L=.5;w=r(-L*p._length,w),k=o((1+L)*p._length,k),A=r(-L*u._length,A),S=o((1+L)*u._length,S);var E=a(k-w),I=a(S-A);if(0>=E||0>=I){var P=t.selectAll("image").data([]);return void P.exit().remove()}var z=document.createElement("canvas");z.width=E,z.height=I;var D=z.getContext("2d"),O=function(e){return l.constrain(a(p.c2p(f+e*h)-w),0,E)},R=function(e){return l.constrain(a(u.c2p(x+e*v)-A),0,I)},M=d.colormodel[m.colormodel].fmt,B;for(C=0;C<g.w;C++){var F=O(C),N=O(C+1);if(!(N===F||isNaN(N)||isNaN(F)))for(var V=0;V<g.h;V++){var U=R(V),H=R(V+1);H===U||isNaN(H)||isNaN(U)||!y[V][C]||(B=m._scaler(y[V][C]),D.fillStyle=B?m.colormodel+"("+M(B).join(",")+")":"rgba(0,0,0,0)",D.fillRect(F,U,N-F,H-U))}}var q=t.selectAll("image").data(e);q.enter().append("svg:image").attr({xmlns:s.svg,preserveAspectRatio:"none"}),q.attr({height:I,width:E,x:w,y:A,"xlink:href":z.toDataURL("image/png")})})}},{"../../constants/xmlns_namespaces":634,"../../lib":657,"./constants":984,d3:108}],990:[function(e,t){'use strict';var a=e("d3");t.exports=function(e){a.select(e).selectAll(".im image").style("opacity",function(e){return e.trace.opacity})}},{d3:108}],991:[function(e,t){'use strict';var a=e("../../lib/extend").extendFlat,o=e("../../lib/extend").extendDeep,r=e("../../plot_api/edit_types").overrideAll,i=e("../../plots/font_attributes"),n=e("../../components/color/attributes"),l=e("../../plots/domain").attributes,s=e("../../plots/cartesian/layout_attributes"),d=e("../../plot_api/plot_template").templatedArray,c=e("../../constants/delta.js"),p=e("../../constants/docs").FORMAT_LINK,u=i({editType:"plot",colorEditType:"plot"}),g={color:{valType:"color",editType:"plot"},line:{color:{valType:"color",dflt:n.defaultLine,editType:"plot"},width:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},thickness:{valType:"number",min:0,max:1,dflt:1,editType:"plot"},editType:"calc"},m={valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},h=d("step",o({},g,{range:m}));t.exports={mode:{valType:"flaglist",editType:"calc",flags:["number","delta","gauge"],dflt:"number"},value:{valType:"number",editType:"calc",anim:!0},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},domain:l({name:"indicator",trace:!0,editType:"calc"}),title:{text:{valType:"string",editType:"plot"},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},font:a({},u,{}),editType:"plot"},number:{valueformat:{valType:"string",dflt:"",editType:"plot"},font:a({},u,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"plot"},delta:{reference:{valType:"number",editType:"calc"},position:{valType:"enumerated",values:["top","bottom","left","right"],dflt:"bottom",editType:"plot"},relative:{valType:"boolean",editType:"plot",dflt:!1},valueformat:{valType:"string",editType:"plot"},increasing:{symbol:{valType:"string",dflt:c.INCREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:c.INCREASING.COLOR,editType:"plot"},editType:"plot"},decreasing:{symbol:{valType:"string",dflt:c.DECREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:c.DECREASING.COLOR,editType:"plot"},editType:"plot"},font:a({},u,{}),editType:"calc"},gauge:{shape:{valType:"enumerated",editType:"plot",dflt:"angular",values:["angular","bullet"]},bar:o({},g,{color:{dflt:"green"}}),bgcolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:n.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:1,editType:"plot"},axis:r({range:m,visible:a({},s.visible,{dflt:!0}),tickmode:s.tickmode,nticks:s.nticks,tick0:s.tick0,dtick:s.dtick,tickvals:s.tickvals,ticktext:s.ticktext,ticks:a({},s.ticks,{dflt:"outside"}),ticklen:s.ticklen,tickwidth:s.tickwidth,tickcolor:s.tickcolor,showticklabels:s.showticklabels,tickfont:i({}),tickangle:s.tickangle,tickformat:s.tickformat,tickformatstops:s.tickformatstops,tickprefix:s.tickprefix,showtickprefix:s.showtickprefix,ticksuffix:s.ticksuffix,showticksuffix:s.showticksuffix,separatethousands:s.separatethousands,exponentformat:s.exponentformat,showexponent:s.showexponent,editType:"plot"},"plot"),steps:h,threshold:{line:{color:a({},g.line.color,{}),width:a({},g.line.width,{dflt:1}),editType:"plot"},thickness:a({},g.thickness,{dflt:.85}),value:{valType:"number",editType:"calc",dflt:!1},editType:"plot"},editType:"plot"}}},{"../../components/color/attributes":523,"../../constants/delta.js":627,"../../constants/docs":628,"../../lib/extend":648,"../../plot_api/edit_types":688,"../../plot_api/plot_template":695,"../../plots/cartesian/layout_attributes":719,"../../plots/domain":732,"../../plots/font_attributes":733}],992:[function(e,t,a){'use strict';var o=e("../../plots/plots");a.name="indicator",a.plot=function(e,t,r,i){o.plotBasePlot(a.name,e,t,r,i)},a.clean=function(e,t,r,i){o.cleanBasePlot(a.name,e,t,r,i)}},{"../../plots/plots":768}],993:[function(e,t){'use strict';t.exports={calc:function(e,t){var a=[],o=t.value;"number"==typeof t._lastValue||(t._lastValue=t.value);var r=t._lastValue,i=r;return t._hasDelta&&"number"==typeof t.delta.reference&&(i=t.delta.reference),a[0]={y:o,lastY:r,delta:o-i,relativeDelta:(o-i)/i},a}}},{}],994:[function(e,t){'use strict';t.exports={defaultNumberFontSize:80,bulletNumberDomainSize:.25,bulletPadding:.025,innerRadius:.75,valueThickness:.5,titlePadding:5,horizontalPadding:10}},{}],995:[function(e,t){'use strict';function a(e,t){function a(a,i){return o.coerce(e,t,r.gauge.steps,a,i)}a("color"),a("line.color"),a("line.width"),a("range"),a("thickness")}var o=e("../../lib"),r=e("./attributes"),i=e("../../plots/domain").defaults,n=e("../../plot_api/plot_template"),l=e("../../plots/array_container_defaults"),s=e("./constants.js"),d=e("../../plots/cartesian/tick_value_defaults"),c=e("../../plots/cartesian/tick_mark_defaults"),p=e("../../plots/cartesian/tick_label_defaults");t.exports={supplyDefaults:function(e,t,u,g){function m(a,i){return o.coerce(e,t,r,a,i)}function h(e,t){return o.coerce(v,w,r.gauge,e,t)}function y(e,t){return o.coerce(k,T,r.gauge.axis,e,t)}i(t,g,m),m("mode"),t._hasNumber=-1!==t.mode.indexOf("number"),t._hasDelta=-1!==t.mode.indexOf("delta"),t._hasGauge=-1!==t.mode.indexOf("gauge");var f=m("value");t._range=[0,"number"==typeof f?1.5*f:1];var x=[,,],_;t._hasNumber&&(m("number.valueformat"),m("number.font.color",g.font.color),m("number.font.family",g.font.family),m("number.font.size"),t.number.font.size===void 0&&(t.number.font.size=s.defaultNumberFontSize,x[0]=!0),m("number.prefix"),m("number.suffix"),_=t.number.font.size);var b;t._hasDelta&&(m("delta.font.color",g.font.color),m("delta.font.family",g.font.family),m("delta.font.size"),t.delta.font.size===void 0&&(t.delta.font.size=(t._hasNumber?.5:1)*(_||s.defaultNumberFontSize),x[1]=!0),m("delta.reference",t.value),m("delta.relative"),m("delta.valueformat",t.delta.relative?"2%":""),m("delta.increasing.symbol"),m("delta.increasing.color"),m("delta.decreasing.symbol"),m("delta.decreasing.color"),m("delta.position"),b=t.delta.font.size),t._scaleNumbers=(!t._hasNumber||x[0])&&(!t._hasDelta||x[1])||!1,m("title.font.color",g.font.color),m("title.font.family",g.font.family),m("title.font.size",.25*(_||b||s.defaultNumberFontSize)),m("title.text");var v,w,k,T;if(t._hasGauge){v=e.gauge,v||(v={}),w=n.newContainer(t,"gauge"),h("shape");var A=t._isBullet="bullet"===t.gauge.shape;A||m("title.align","center");var S=t._isAngular="angular"===t.gauge.shape;S||m("align","center"),h("bgcolor",g.paper_bgcolor),h("borderwidth"),h("bordercolor"),h("bar.color"),h("bar.line.color"),h("bar.line.width");var C=s.valueThickness*("bullet"===t.gauge.shape?.5:1);h("bar.thickness",C),l(v,w,{name:"steps",handleItemDefaults:a}),h("threshold.value"),h("threshold.thickness"),h("threshold.line.width"),h("threshold.line.color"),k={},v&&(k=v.axis||{}),T=n.newContainer(w,"axis"),y("visible"),t._range=y("range",t._range);var L={outerTicks:!0};d(k,T,y,"linear"),p(k,T,y,"linear",L),c(k,T,y,L)}else m("title.align","center"),m("align","center"),t._isAngular=t._isBullet=!1;t._length=null}}},{"../../lib":657,"../../plot_api/plot_template":695,"../../plots/array_container_defaults":701,"../../plots/cartesian/tick_label_defaults":726,"../../plots/cartesian/tick_mark_defaults":727,"../../plots/cartesian/tick_value_defaults":728,"../../plots/domain":732,"./attributes":991,"./constants.js":994}],996:[function(e,t){'use strict';t.exports={moduleType:"trace",name:"indicator",basePlotModule:e("./base_plot"),categories:["svg","noOpacity","noHover"],animatable:!0,attributes:e("./attributes"),supplyDefaults:e("./defaults").supplyDefaults,calc:e("./calc").calc,plot:e("./plot"),meta:{}}},{"./attributes":991,"./base_plot":992,"./calc":993,"./defaults":995,"./plot":997}],997:[function(e,t){'use strict';var m=Math.cos,h=Math.PI,y=Math.sin,f=Math.min,x=Math.abs,_=Math.max;function a(e){return e&&0<e.duration}function o(e,t,o,r){function i(e){e.attr("width",function(e){return _(0,x.c2p(e.range[1])-x.c2p(e.range[0]))}).attr("x",function(e){return x.c2p(e.range[0])}).attr("y",function(e){return .5*(1-e.thickness)*T}).attr("height",function(e){return e.thickness*T})}var l=o[0].trace,d=r.gauge,c=r.layer,p=r.gaugeBg,u=r.gaugeOutline,g=r.size,m=l.domain,h=r.transitionOpts,y=r.onComplete,x,b,v,w,k;d.enter().append("g").classed("bullet",!0),d.attr("transform","translate("+g.l+", "+g.t+")"),c.enter().append("g").classed("bulletaxis",!0).classed("crisp",!0),c.selectAll("g.xbulletaxistick,path,text").remove();var T=g.h,A=l.gauge.bar.thickness*T,L=m.x[0],E=m.x[0]+(m.x[1]-m.x[0])*(l._hasNumber||l._hasDelta?1-S.bulletNumberDomainSize:1);x=s(e,l.gauge.axis),x._id="xbulletaxis",x.domain=[L,E],x.setScale(),b=C.calcTicks(x),v=C.makeTransFn(x),w=C.getTickSigns(x)[2],k=g.t+g.h,x.visible&&(C.drawTicks(e,x,{vals:"inside"===x.ticks?C.clipEnds(x,b):b,layer:c,path:C.makeTickPath(x,k,w),transFn:v}),C.drawLabels(e,x,{vals:b,layer:c,transFn:v,labelFns:C.makeLabelFns(x,k)}));var I=[p].concat(l.gauge.steps),z=d.selectAll("g.bg-bullet").data(I);z.enter().append("g").classed("bg-bullet",!0).append("rect"),z.select("rect").call(i).call(n),z.exit().remove();var D=d.selectAll("g.value-bullet").data([l.gauge.bar]);D.enter().append("g").classed("value-bullet",!0).append("rect"),D.select("rect").attr("height",A).attr("y",(T-A)/2).call(n),a(h)?D.select("rect").transition().duration(h.duration).ease(h.easing).each("end",function(){y&&y()}).each("interrupt",function(){y&&y()}).attr("width",_(0,x.c2p(f(l.gauge.axis.range[1],o[0].y)))):D.select("rect").attr("width","number"==typeof o[0].y?_(0,x.c2p(f(l.gauge.axis.range[1],o[0].y))):0),D.exit().remove();var O=o.filter(function(){return l.gauge.threshold.value}),R=d.selectAll("g.threshold-bullet").data(O);R.enter().append("g").classed("threshold-bullet",!0).append("line"),R.select("line").attr("x1",x.c2p(l.gauge.threshold.value)).attr("x2",x.c2p(l.gauge.threshold.value)).attr("y1",(1-l.gauge.threshold.thickness)/2*T).attr("y2",(1-(1-l.gauge.threshold.thickness)/2)*T).call(P.stroke,l.gauge.threshold.line.color).style("stroke-width",l.gauge.threshold.line.width),R.exit().remove();var M=d.selectAll("g.gauge-outline").data([u]);M.enter().append("g").classed("gauge-outline",!0).append("rect"),M.select("rect").call(i).call(n),M.exit().remove()}function r(e,t,o,r){function i(e){var t=u.gauge.axis.range[0],a=u.gauge.axis.range[1],o=(e-t)/(a-t)*h-z;return o<-z?-z:o>z?z:o}function c(e){return b.svg.arc().innerRadius((_+f)/2-e/2*(f-_)).outerRadius((_+f)/2+e/2*(f-_)).startAngle(-z)}function p(e){e.attr("d",function(e){return c(e.thickness).startAngle(i(e.range[0])).endAngle(i(e.range[1]))()})}var u=o[0].trace,g=r.size,f=r.radius,_=r.innerRadius,w=r.gaugeBg,A=r.gaugeOutline,S=[g.l+g.w/2,g.t+g.h/2+f/2],L=r.gauge,E=r.layer,I=r.transitionOpts,P=r.onComplete,z=h/2,D,O,R,M;L.enter().append("g").classed("angular",!0),L.attr("transform",d(S[0],S[1])),E.enter().append("g").classed("angularaxis",!0).classed("crisp",!0),E.selectAll("g.xangularaxistick,path,text").remove(),D=s(e,u.gauge.axis),D.type="linear",D.range=u.gauge.axis.range,D._id="xangularaxis",D.setScale();var j=function(e){return(D.range[0]-e.x)/(D.range[1]-D.range[0])*h+h},B={},F=C.makeLabelFns(D,0),N=F.labelStandoff;B.xFn=function(e){var t=j(e);return m(t)*N},B.yFn=function(e){var t=j(e),a=0<y(t)?.2:1;return-y(t)*(N+e.fontSize*a)+x(m(t))*(e.fontSize*T)},B.anchorFn=function(e){var t=j(e),a=m(t);return .1>x(a)?"middle":0<a?"start":"end"},B.heightFn=function(e,t,a){var o=j(e);return-.5*(1+y(o))*a};var V=function(e){return d(S[0]+f*m(e),S[1]-f*y(e))};R=function(e){return V(j(e))};var U=function(e){var t=j(e);return V(t)+"rotate("+-k(t)+")"};if(O=C.calcTicks(D),M=C.getTickSigns(D)[2],D.visible){M="inside"===D.ticks?-1:1;var H=(D.linewidth||1)/2;C.drawTicks(e,D,{vals:O,layer:E,path:"M"+M*H+",0h"+M*D.ticklen,transFn:U}),C.drawLabels(e,D,{vals:O,layer:E,transFn:R,labelFns:B})}var q=[w].concat(u.gauge.steps),G=L.selectAll("g.bg-arc").data(q);G.enter().append("g").classed("bg-arc",!0).append("path"),G.select("path").call(p).call(n),G.exit().remove();var Y=c(u.gauge.bar.thickness),W=L.selectAll("g.value-arc").data([u.gauge.bar]);W.enter().append("g").classed("value-arc",!0).append("path");var X=W.select("path");a(I)?(X.transition().duration(I.duration).ease(I.easing).each("end",function(){P&&P()}).each("interrupt",function(){P&&P()}).attrTween("d",l(Y,i(o[0].lastY),i(o[0].y))),u._lastValue=o[0].y):X.attr("d","number"==typeof o[0].y?Y.endAngle(i(o[0].y)):"M0,0Z"),X.call(n),W.exit().remove(),q=[];var Z=u.gauge.threshold.value;Z&&q.push({range:[Z,Z],color:u.gauge.threshold.color,line:{color:u.gauge.threshold.line.color,width:u.gauge.threshold.line.width},thickness:u.gauge.threshold.thickness});var v=L.selectAll("g.threshold-arc").data(q);v.enter().append("g").classed("threshold-arc",!0).append("path"),v.select("path").call(p).call(n),v.exit().remove();var K=L.selectAll("g.gauge-outline").data([A]);K.enter().append("g").classed("gauge-outline",!0).append("path"),K.select("path").call(p).call(n),K.exit().remove()}function i(e,t,o,r){function i(t,a,o,r){if(t.match("s")&&0<=o!=0<=r&&!a(o).slice(-1).match(O)&&!a(r).slice(-1).match(O)){var i=t.slice().replace("s","f").replace(/\d+/,function(e){return parseInt(e)-1}),n=s(e,{tickformat:i});return function(e){return 1>x(e)?C.tickText(n,e).text:a(e)}}return a}function n(){function t(){g.text(c(d(o[0]),n)).call(P.fill,p(o[0])).call(v.convertToTspans,e)}var r=s(e,{tickformat:l.delta.valueformat},l._range);r.setScale(),C.prepTicks(r);var n=function(e){return C.tickText(r,e).text},d=function(e){var t=l.delta.relative?e.relativeDelta:e.delta;return t},c=function(e,t){return 0===e||"number"!=typeof e||isNaN(e)?"-":(0<e?l.delta.increasing.symbol:l.delta.decreasing.symbol)+t(e)},p=function(e){return 0<=e.delta?l.delta.increasing.color:l.delta.decreasing.color};void 0===l._deltaLastValue&&(l._deltaLastValue=d(o[0]));var g=S.select("text.delta");return g.call(A.font,l.delta.font).call(P.fill,p({delta:l._deltaLastValue})),a(k)?g.transition().duration(k.duration).ease(k.easing).tween("text",function(){var e=b.select(this),t=d(o[0]),a=l._deltaLastValue,r=i(l.delta.valueformat,n,a,t),s=b.interpolateNumber(a,t);return l._deltaLastValue=t,function(a){e.text(c(s(a),r)),e.call(P.fill,p({delta:s(a)}))}}).each("end",function(){t(),T&&T()}).each("interrupt",function(){t(),T&&T()}):t(),I=u(c(d(o[0]),n),l.delta.font,y,e),g}var l=o[0].trace,c=r.numbersX,p=r.numbersY,h=l.align||"center",y=z[h],k=r.transitionOpts,T=r.onComplete,S=w.ensureSingle(t,"g","numbers"),L=[],E,I,R;l._hasNumber&&L.push("number"),l._hasDelta&&(L.push("delta"),"left"===l.delta.position&&L.reverse());var M=S.selectAll("text").data(L);M.enter().append("text"),M.attr("text-anchor",function(){return y}).attr("class",function(e){return e}).attr("x",null).attr("y",null).attr("dx",null).attr("dy",null),M.exit().remove();var j=l.mode+l.align,B;if(l._hasDelta&&(B=n(),j+=l.delta.position+l.delta.font.size+l.delta.font.family+l.delta.valueformat,j+=l.delta.increasing.symbol+l.delta.decreasing.symbol,R=I),l._hasNumber&&(function(){function t(){var t="number"==typeof o[0].y?c+n(o[0].y)+d:"-";p.text(t).call(A.font,l.number.font).call(v.convertToTspans,e)}var r=s(e,{tickformat:l.number.valueformat},l._range);r.setScale(),C.prepTicks(r);var n=function(e){return C.tickText(r,e).text},d=l.number.suffix,c=l.number.prefix,p=S.select("text.number");return a(k)?p.transition().duration(k.duration).ease(k.easing).each("end",function(){t(),T&&T()}).each("interrupt",function(){t(),T&&T()}).attrTween("text",function(){var e=b.select(this),a=b.interpolateNumber(o[0].lastY,o[0].y);l._lastValue=o[0].y;var r=i(l.number.valueformat,n,o[0].lastY,o[0].y);return function(o){e.text(c+r(a(o))+d)}}):t(),E=u(c+n(o[0].y)+d,l.number.font,y,e),p}(),j+=l.number.font.size+l.number.font.family+l.number.valueformat+l.number.suffix+l.number.prefix,R=E),l._hasDelta&&l._hasNumber){var F=[(E.left+E.right)/2,(E.top+E.bottom)/2],N=[(I.left+I.right)/2,(I.top+I.bottom)/2],V=.75*l.delta.font.size,U,m;"left"===l.delta.position&&(U=g(l,"deltaPos",0,-1*(E.width*D[l.align]+I.width*(1-D[l.align])+V),j,Math.min),m=F[1]-N[1],R={width:E.width+I.width+V,height:_(E.height,I.height),left:I.left+U,right:E.right,top:f(E.top,I.top+m),bottom:_(E.bottom,I.bottom+m)}),"right"===l.delta.position&&(U=g(l,"deltaPos",0,E.width*(1-D[l.align])+I.width*D[l.align]+V,j,Math.max),m=F[1]-N[1],R={width:E.width+I.width+V,height:_(E.height,I.height),left:E.left,right:I.right+U,top:f(E.top,I.top+m),bottom:_(E.bottom,I.bottom+m)}),"bottom"===l.delta.position&&(U=null,m=I.height,R={width:_(E.width,I.width),height:E.height+I.height,left:f(E.left,I.left),right:_(E.right,I.right),top:E.bottom-E.height,bottom:E.bottom+I.height}),"top"===l.delta.position&&(U=null,m=E.top,R={width:_(E.width,I.width),height:E.height+I.height,left:f(E.left,I.left),right:_(E.right,I.right),top:E.bottom-E.height-I.height,bottom:E.bottom}),B.attr({dx:U,dy:m})}(l._hasNumber||l._hasDelta)&&S.attr("transform",function(){var e=r.numbersScaler(R);j+=e[2];var t=g(l,"numbersScale",1,e[0],j,Math.min),a;l._scaleNumbers||(t=1),a=l._isAngular?p-t*R.bottom:p-t*(R.top+R.bottom)/2,l._numbersTop=t*R.top+a;var o=R[h];"center"===h&&(o=(R.left+R.right)/2);var i=c-t*o;return i=g(l,"numbersTranslate",0,i,j,Math.max),d(i,a)+" scale("+t+")"})}function n(e){e.each(function(e){P.stroke(b.select(this),e.line.color)}).each(function(e){P.fill(b.select(this),e.color)}).style("stroke-width",function(e){return e.line.width})}function l(e,t,a){return function(){var o=b.interpolate(t,a);return function(a){return e.endAngle(o(a))()}}}function s(e,t,a){function o(e,t){return w.coerce(i,n,I,e,t)}var r=e._fullLayout,i=w.extendFlat({type:"linear",ticks:"outside",range:a,showline:!0},t),n={type:"linear",_id:"x"+t._id},l={letter:"x",font:r.font,noHover:!0,noTickson:!0};return L(i,n,o,l,r),E(i,n,o,l),n}function d(e,t){return"translate("+e+","+t+")"}function c(e,t,a){var o=f(t/e.width,a/e.height);return[o,e,t+"x"+a]}function p(e,t){var a=Math.sqrt(e.width/2*(e.width/2)+e.height*e.height);return[t/a,e,t]}function u(e,t,a,o){var r=document.createElementNS("http://www.w3.org/2000/svg","text"),i=b.select(r);return i.text(e).attr("x",0).attr("y",0).attr("text-anchor",a).attr("data-unformatted",e).call(v.convertToTspans,o).call(A.font,t),A.bBox(i.node())}function g(e,t,a,o,r,i){var n="_cache"+t;e[n]&&e[n].key===r||(e[n]={key:r,value:a});var l=w.aggNums(i,null,[e[n].value,o],2);return e[n].value=l,l}var b=e("d3"),w=e("../../lib"),k=w.rad2deg,T=e("../../constants/alignment").MID_SHIFT,A=e("../../components/drawing"),S=e("./constants"),v=e("../../lib/svg_text_utils"),C=e("../../plots/cartesian/axes"),L=e("../../plots/cartesian/axis_defaults"),E=e("../../plots/cartesian/position_defaults"),I=e("../../plots/cartesian/layout_attributes"),P=e("../../components/color"),z={left:"start",center:"middle",right:"end"},D={left:0,center:.5,right:1},O=/[yzafpnµmkMGTPEZY]/;t.exports=function(e,t,n,l){var s=e._fullLayout,u;a(n)&&l&&(u=l()),w.makeTraceGroups(s._indicatorlayer,t,"trace").each(function(t){var a=t[0],l=a.trace,g=b.select(this),m=l._hasGauge,h=l._isAngular,y=l._isBullet,x=l.domain,_={w:s._size.w*(x.x[1]-x.x[0]),h:s._size.h*(x.y[1]-x.y[0]),l:s._size.l+s._size.w*x.x[0],r:s._size.r+s._size.w*(1-x.x[1]),t:s._size.t+s._size.h*(1-x.y[1]),b:s._size.b+s._size.h*x.y[0]},w=_.l+_.w/2,k=_.t+_.h/2,T=f(_.w/2,_.h),C=S.innerRadius*T,L=l.align||"center",E,I,P;if(I=k,!m)E=_.l+D[L]*_.w,P=function(e){return c(e,_.w,_.h)};else if(h&&(E=w,I=k+T/2,P=function(e){return p(e,.9*C)}),y){var O=S.bulletPadding,R=1-S.bulletNumberDomainSize+O;E=_.l+(R+(1-R)*D[L])*_.w,P=function(e){return c(e,(S.bulletNumberDomainSize-O)*_.w,_.h)}}i(e,g,t,{numbersX:E,numbersY:I,numbersScaler:P,transitionOpts:n,onComplete:u});var M,j;m&&(M={range:l.gauge.axis.range,color:l.gauge.bgcolor,line:{color:l.gauge.bordercolor,width:0},thickness:1},j={range:l.gauge.axis.range,color:"rgba(0, 0, 0, 0)",line:{color:l.gauge.bordercolor,width:l.gauge.borderwidth},thickness:1});var B=g.selectAll("g.angular").data(h?t:[]);B.exit().remove();var F=g.selectAll("g.angularaxis").data(h?t:[]);F.exit().remove(),h&&r(e,g,t,{radius:T,innerRadius:C,gauge:B,layer:F,size:_,gaugeBg:M,gaugeOutline:j,transitionOpts:n,onComplete:u});var N=g.selectAll("g.bullet").data(y?t:[]);N.exit().remove();var V=g.selectAll("g.bulletaxis").data(y?t:[]);V.exit().remove(),y&&o(e,g,t,{gauge:N,layer:V,size:_,gaugeBg:M,gaugeOutline:j,transitionOpts:n,onComplete:u});var U=g.selectAll("text.title").data(t);U.exit().remove(),U.enter().append("text").classed("title",!0),U.attr("text-anchor",function(){return y?z.right:z[l.title.align]}).text(l.title.text).call(A.font,l.title.font).call(v.convertToTspans,e),U.attr("transform",function(){var e=_.l+_.w*D[l.title.align],t=S.titlePadding,a=A.bBox(U.node()),o;if(m){if(h)if(l.gauge.axis.visible){var r=A.bBox(F.node());o=r.top-t-a.bottom}else o=_.t+_.h/2-T/2-a.bottom-t;y&&(o=I-(a.top+a.bottom)/2,e=_.l-S.bulletPadding*_.w)}else o=l._numbersTop-t-a.bottom;return d(e,o)})})}},{"../../components/color":524,"../../components/drawing":546,"../../constants/alignment":626,"../../lib":657,"../../lib/svg_text_utils":681,"../../plots/cartesian/axes":705,"../../plots/cartesian/axis_defaults":707,"../../plots/cartesian/layout_attributes":719,"../../plots/cartesian/position_defaults":722,"./constants":994,d3:108}],998:[function(e,t){'use strict';function a(){return{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}}}function o(){return{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}}}var r=e("../../components/colorscale/attributes"),i=e("../../plots/template_attributes").hovertemplateAttrs,n=e("../mesh3d/attributes"),l=e("../../plots/attributes"),s=e("../../lib/extend").extendFlat,d=e("../../plot_api/edit_types").overrideAll,c=t.exports=d(s({x:{valType:"data_array"},y:{valType:"data_array"},z:{valType:"data_array"},value:{valType:"data_array"},isomin:{valType:"number"},isomax:{valType:"number"},surface:{show:{valType:"boolean",dflt:!0},count:{valType:"integer",dflt:2,min:1},fill:{valType:"number",min:0,max:1,dflt:1},pattern:{valType:"flaglist",flags:["A","B","C","D","E"],extras:["all","odd","even"],dflt:"all"}},spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:.15}},slices:{x:a("x"),y:a("y"),z:a("z")},caps:{x:o("x"),y:o("y"),z:o("z")},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:i(),showlegend:s({},l.showlegend,{dflt:!1})},r("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:n.opacity,lightposition:n.lightposition,lighting:n.lighting,flatshading:n.flatshading,contour:n.contour,hoverinfo:s({},l.hoverinfo)}),"calc","nested");c.flatshading.dflt=!0,c.lighting.facenormalsepsilon.dflt=0,c.x.editType=c.y.editType=c.z.editType=c.value.editType="calc+clearAxisTypes",c.transforms=void 0},{"../../components/colorscale/attributes":531,"../../lib/extend":648,"../../plot_api/edit_types":688,"../../plots/attributes":702,"../../plots/template_attributes":783,"../mesh3d/attributes":1003}],999:[function(e,t){'use strict';var a=Math.min,o=Math.max,r=e("../../components/colorscale/calc"),n=e("../streamtube/calc").processGrid,l=e("../streamtube/calc").filter;t.exports=function(e,t){t._len=a(t.x.length,t.y.length,t.z.length,t.value.length),t._x=l(t.x,t._len),t._y=l(t.y,t._len),t._z=l(t.z,t._len),t._value=l(t.value,t._len);var s=n(t);t._gridFill=s.fill,t._Xs=s.Xs,t._Ys=s.Ys,t._Zs=s.Zs,t._len=s.len;for(var d=1/0,c=-Infinity,p=0,u;p<t._len;p++)u=t._value[p],d=a(d,u),c=o(c,u);t._minValues=d,t._maxValues=c,t._vMin=t.isomin===void 0||null===t.isomin?d:t.isomin,t._vMax=t.isomax===void 0||null===t.isomin?c:t.isomax,r(e,t,{vals:[t._vMin,t._vMax],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":532,"../streamtube/calc":1169}],1e3:[function(e,t){'use strict';var i=Math.sqrt,n=Math.min,l=Math.abs,s=Math.max;function a(e,t,a){this.scene=e,this.uid=a,this.mesh=t,this.name="",this.data=null,this.showContour=!1}function o(t){function a(e,t,a){for(var o=ye.length,r=ue;r<o;r++)if(e===ge[r]&&t===me[r]&&a===he[r])return r;return-1}function o(){ue=pe}function r(){ge=[],me=[],he=[],ye=[],pe=0,o()}function d(e,t,a,o){return ge.push(e),me.push(t),he.push(a),ye.push(o),pe++,pe-1}function c(e,a,o){return t._meshI.push(e),t._meshJ.push(a),t._meshK.push(o),ee++,ee-1}function p(e,t,a){for(var o=[],r=0;r<e.length;r++)o[r]=(e[r]+t[r]+a[r])/3;return o}function u(e,t,a){for(var o=[],r=0;r<e.length;r++)o[r]=e[r]*(1-a)+a*t[r];return o}function g(e){fe=e}function h(e,t){var o=e[0],n=e[1],l=e[2],s=p(o,n,l),d=i(1-fe),r=u(s,o,d),g=u(s,n,d),m=u(s,l,d),h=t[0],a=t[1],y=t[2];return{xyzv:[[o,n,g],[g,r,o],[n,l,m],[m,g,n],[l,o,r],[r,m,l]],abc:[[h,a,-1],[-1,-1,h],[a,y,-1],[-1,-1,a],[y,h,-1],[-1,-1,y]]}}function f(e,t){return"all"===e||null===e||-1<e.indexOf(t)}function _(e,t){return null===e?t:e}function b(e,t,r){o();var n=[t],l=[r];if(1<=fe)n=[t],l=[r];else if(0<fe){var s=h(t,r);n=s.xyzv,l=s.abc}for(var p=0;p<n.length;p++){t=n[p],r=l[p];for(var u=[],g=0;3>g;g++){var m=t[g][0],x=t[g][1],y=t[g][2],b=t[g][3],v=-1<r[g]?r[g]:a(m,x,y);u[g]=-1<v?v:d(m,x,y,_(e,b))}c(u[0],u[1],u[2])}}function v(e,t,a){var o=function(o,r,i){b(e,[t[o],t[r],t[i]],[a[o],a[r],a[i]])};o(0,1,2),o(2,3,0)}function w(e,t,a){var o=function(o,r,i){b(e,[t[o],t[r],t[i]],[a[o],a[r],a[i]])};o(0,1,2),o(3,0,1),o(2,3,0),o(1,2,3)}function k(e,t,a,o){var r=e[3];r<a&&(r=a),r>o&&(r=o);for(var i=(e[3]-r)/(e[3]-t[3]+1e-9),n=[],l=0;4>l;l++)n[l]=(1-i)*e[l]+i*t[l];return n}function T(e,t,a){return e>=t&&e<=a}function A(e){var t=.001*(ce-de);return e>=de-t&&e<=ce+t}function S(e){for(var a=[],o=0,r;4>o;o++)r=e[o],a.push([t._x[r],t._y[r],t._z[r],t._value[r]]);return a}function L(t,a,o,r,i,n){n||(n=1),o=[-1,-1,-1];var l=!1,s=[T(a[0][3],r,i),T(a[1][3],r,i),T(a[2][3],r,i)];if(!s[0]&&!s[1]&&!s[2])return!1;var d=function(e,t,a){return A(t[0][3])&&A(t[1][3])&&A(t[2][3])?(b(e,t,a),!0):!!(3>n)&&L(e,t,a,de,ce,++n)};if(s[0]&&s[1]&&s[2])return d(t,a,o)||l;var c=!1;return([[0,1,2],[2,0,1],[1,2,0]].forEach(function(n){if(s[n[0]]&&s[n[1]]&&!s[n[2]]){var e=a[n[0]],p=a[n[1]],u=a[n[2]],g=k(u,e,r,i),m=k(u,p,r,i);l=d(t,[m,g,e],[-1,-1,o[n[0]]])||l,l=d(t,[e,p,m],[o[n[0]],o[n[1]],-1])||l,c=!0}}),c)?l:([[0,1,2],[1,2,0],[2,0,1]].forEach(function(n){if(s[n[0]]&&!s[n[1]]&&!s[n[2]]){var e=a[n[0]],p=a[n[1]],u=a[n[2]],g=k(p,e,r,i),m=k(u,e,r,i);l=d(t,[m,g,e],[-1,-1,o[n[0]]])||l,c=!0}}),l)}function E(t,a,o,r){var i=!1,n=S(a),l=[T(n[0][3],o,r),T(n[1][3],o,r),T(n[2][3],o,r),T(n[3][3],o,r)];if(!l[0]&&!l[1]&&!l[2]&&!l[3])return i;if(l[0]&&l[1]&&l[2]&&l[3])return Q&&(i=w(t,n,a)||i),i;var s=!1;return([[0,1,2,3],[3,0,1,2],[2,3,0,1],[1,2,3,0]].forEach(function(d){if(l[d[0]]&&l[d[1]]&&l[d[2]]&&!l[d[3]]){var e=n[d[0]],c=n[d[1]],p=n[d[2]],u=n[d[3]];if(Q)i=b(t,[e,c,p],[a[d[0]],a[d[1]],a[d[2]]])||i;else{var g=k(u,e,o,r),m=k(u,c,o,r),h=k(u,p,o,r);i=b(null,[g,m,h],[-1,-1,-1])||i}s=!0}}),s)?i:([[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2],[0,2,3,1],[1,3,2,0]].forEach(function(d){if(l[d[0]]&&l[d[1]]&&!l[d[2]]&&!l[d[3]]){var e=n[d[0]],c=n[d[1]],p=n[d[2]],u=n[d[3]],g=k(p,e,o,r),m=k(p,c,o,r),h=k(u,c,o,r),y=k(u,e,o,r);Q?(i=b(t,[e,y,g],[a[d[0]],-1,-1])||i,i=b(t,[c,m,h],[a[d[1]],-1,-1])||i):i=v(null,[g,m,h,y],[-1,-1,-1,-1])||i,s=!0}}),s)?i:([[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2]].forEach(function(d){if(l[d[0]]&&!l[d[1]]&&!l[d[2]]&&!l[d[3]]){var e=n[d[0]],c=n[d[1]],p=n[d[2]],u=n[d[3]],g=k(c,e,o,r),m=k(p,e,o,r),h=k(u,e,o,r);Q?(i=b(t,[e,g,m],[a[d[0]],-1,-1])||i,i=b(t,[e,m,h],[a[d[0]],-1,-1])||i,i=b(t,[e,h,g],[a[d[0]],-1,-1])||i):i=b(null,[g,m,h],[-1,-1,-1])||i,s=!0}}),i)}function I(e,t,a,o,r,i,n,l,s,d,c){var p=!1;return J&&(f(e,"A")&&(p=E(null,[t,a,o,i],d,c)||p),f(e,"B")&&(p=E(null,[a,o,r,s],d,c)||p),f(e,"C")&&(p=E(null,[a,i,n,s],d,c)||p),f(e,"D")&&(p=E(null,[o,i,l,s],d,c)||p),f(e,"E")&&(p=E(null,[a,o,i,s],d,c)||p)),Q&&(p=E(e,[a,o,i,s],d,c)||p),p}function P(e,t,a,o,r,i,n,l){return[!0===l[0]||L(e,S([t,a,o]),[t,a,o],i,n),!0===l[1]||L(e,S([o,r,t]),[o,r,t],i,n)]}function z(e,t,a,o,r,i,n,l,s){return l?P(e,t,a,r,o,i,n,s):P(e,a,r,o,t,i,n,s)}function D(e,t,a,o,r,i,n){var l=!1,s=function(){l=L(e,[g,m,h],[-1,-1,-1],r,i)||l,l=L(e,[h,y,g],[-1,-1,-1],r,i)||l},d=n[0],c=n[1],p=n[2],g,m,h,y;return d&&(g=u(S([ne(t,a-0,o-0)])[0],S([ne(t-1,a-0,o-0)])[0],d),m=u(S([ne(t,a-0,o-1)])[0],S([ne(t-1,a-0,o-1)])[0],d),h=u(S([ne(t,a-1,o-1)])[0],S([ne(t-1,a-1,o-1)])[0],d),y=u(S([ne(t,a-1,o-0)])[0],S([ne(t-1,a-1,o-0)])[0],d),s()),c&&(g=u(S([ne(t-0,a,o-0)])[0],S([ne(t-0,a-1,o-0)])[0],c),m=u(S([ne(t-0,a,o-1)])[0],S([ne(t-0,a-1,o-1)])[0],c),h=u(S([ne(t-1,a,o-1)])[0],S([ne(t-1,a-1,o-1)])[0],c),y=u(S([ne(t-1,a,o-0)])[0],S([ne(t-1,a-1,o-0)])[0],c),s()),p&&(g=u(S([ne(t-0,a-0,o)])[0],S([ne(t-0,a-0,o-1)])[0],p),m=u(S([ne(t-0,a-1,o)])[0],S([ne(t-0,a-1,o-1)])[0],p),h=u(S([ne(t-1,a-1,o)])[0],S([ne(t-1,a-1,o-1)])[0],p),y=u(S([ne(t-1,a-0,o)])[0],S([ne(t-1,a-0,o-1)])[0],p),s()),l}function O(e,t,a,o,r,i,n,l,s,d,c,p){var u=e;return p?(J&&"even"===e&&(u=null),I(u,t,a,o,r,i,n,l,s,d,c)):(J&&"odd"===e&&(u=null),I(u,s,l,n,i,r,o,a,t,d,c))}function R(e,t,a,o,r){for(var l=[],s=0,d=0,c;d<t.length;d++){c=t[d];for(var p=1;p<re;p++)for(var u=1;u<oe;u++)l.push(z(e,ne(c,u-1,p-1),ne(c,u-1,p),ne(c,u,p-1),ne(c,u,p),a,o,(c+u+p)%2,r&&r[s]?r[s]:[])),s++}return l}function M(e,t,a,o,r){for(var l=[],s=0,d=0,c;d<t.length;d++){c=t[d];for(var p=1;p<ae;p++)for(var u=1;u<re;u++)l.push(z(e,ne(p-1,c,u-1),ne(p,c,u-1),ne(p-1,c,u),ne(p,c,u),a,o,(p+c+u)%2,r&&r[s]?r[s]:[])),s++}return l}function j(e,t,a,o,r){for(var l=[],s=0,d=0,c;d<t.length;d++){c=t[d];for(var p=1;p<oe;p++)for(var u=1;u<ae;u++)l.push(z(e,ne(u-1,p-1,c),ne(u-1,p,c),ne(u,p-1,c),ne(u,p,c),a,o,(u+p+c)%2,r&&r[s]?r[s]:[])),s++}return l}function B(e,t,a){for(var o=1;o<re;o++)for(var r=1;r<oe;r++)for(var n=1;n<ae;n++)O(e,ne(n-1,r-1,o-1),ne(n-1,r-1,o),ne(n-1,r,o-1),ne(n-1,r,o),ne(n,r-1,o-1),ne(n,r-1,o),ne(n,r,o-1),ne(n,r,o),t,a,(n+r+o)%2)}function F(e,t,a){Q=!0,B(e,t,a),Q=!1}function N(e,t,a){J=!0,B(e,t,a),J=!1}function V(e,t,a,o,r,l){for(var s=[],d=0,c=0,p;c<t.length;c++){p=t[c];for(var u=1;u<re;u++)for(var g=1;g<oe;g++)s.push(D(e,p,g,u,a,o,r[c],l&&l[d]?l[d]:[])),d++}return s}function U(e,t,a,o,r,l){for(var s=[],d=0,c=0,p;c<t.length;c++){p=t[c];for(var u=1;u<ae;u++)for(var g=1;g<re;g++)s.push(D(e,u,p,g,a,o,r[c],l&&l[d]?l[d]:[])),d++}return s}function H(e,t,a,o,r,l){for(var s=[],d=0,c=0,p;c<t.length;c++){p=t[c];for(var u=1;u<oe;u++)for(var g=1;g<ae;g++)s.push(D(e,g,u,p,a,o,r[c],l&&l[d]?l[d]:[])),d++}return s}function G(e,t){for(var a=[],o=e;o<t;o++)a.push(o);return a}function Y(){for(var e=0;e<ae;e++)for(var a=0;a<oe;a++)for(var o=0,r;o<re;o++)r=ne(e,a,o),d(t._x[r],t._y[r],t._z[r],t._value[r])}function W(){r(),Y();var a=null;if(Z&&$&&(g($),F(a,de,ce)),X&&K){g(K);for(var o=t.surface.pattern,i=t.surface.count,d=0;d<i;d++){var e=1===i?.5:d/(i-1),c=(1-e)*de+e*ce,p=l(c-le),u=l(c-se),h=p>u?[le,c]:[c,se];N(o,h[0],h[1])}}var y=[[n(de,se),s(de,se)],[n(le,ce),s(le,ce)]];["x","y","z"].forEach(function(o){for(var e=[],r=0;r<y.length;r++){var i=0,n=y[r][0],l=y[r][1],d=t.slices[o];if(d.show&&d.fill){g(d.fill);var c=[],p=[],u=[];if(d.locations.length)for(var h=0,f;h<d.locations.length;h++)f=m(d.locations[h],"x"===o?te:"y"===o?x:C),0===f.distRatio?c.push(f.id):0<f.id&&(p.push(f.id),"x"===o?u.push([f.distRatio,0,0]):"y"===o?u.push([0,f.distRatio,0]):u.push([0,0,f.distRatio]));else c="x"===o?G(1,ae-1):"y"===o?G(1,oe-1):G(1,re-1);0<p.length&&(e[i]="x"===o?V(a,p,n,l,u,e[i]):"y"===o?U(a,p,n,l,u,e[i]):H(a,p,n,l,u,e[i]),i++),0<c.length&&(e[i]="x"===o?R(a,c,n,l,e[i]):"y"===o?M(a,c,n,l,e[i]):j(a,c,n,l,e[i]),i++)}var _=t.caps[o];_.show&&_.fill&&(g(_.fill),e[i]="x"===o?R(a,[0,ae-1],n,l,e[i]):"y"===o?M(a,[0,oe-1],n,l,e[i]):j(a,[0,re-1],n,l,e[i]),i++)}}),0===ee&&r(),t._meshX=ge,t._meshY=me,t._meshZ=he,t._meshIntensity=ye,t._Xs=te,t._Ys=x,t._Zs=C}t._meshI=[],t._meshJ=[],t._meshK=[];var X=t.surface.show,Z=t.spaceframe.show,K=t.surface.fill,$=t.spaceframe.fill,J=!1,Q=!1,ee=0,te=t._Xs,x=t._Ys,C=t._Zs,ae=te.length,oe=x.length,re=C.length,ie=y.indexOf(t._gridFill.replace(/-/g,"").replace(/\+/g,"")),ne=function(e,t,a){return 5===ie?a+re*t+re*oe*e:4===ie?a+re*e+re*ae*t:3===ie?t+oe*a+oe*re*e:2===ie?t+oe*e+oe*ae*a:1===ie?e+ae*a+ae*re*t:e+ae*t+ae*oe*a},le=t._minValues,se=t._maxValues,de=t._vMin,ce=t._vMax,pe,ue,ge,me,he,ye,fe;return W(),t}var d=e("gl-mesh3d"),c=e("../../lib/gl_format_color").parseColorScale,p=e("../../lib/str2rgbarray"),u=e("../../components/colorscale").extractOpts,g=e("../../plots/gl3d/zip3"),m=function(e,t){for(var a=t.length-1;0<a;a--){var o=n(t[a],t[a-1]),r=s(t[a],t[a-1]);if(r>o&&o<e&&e<=r)return{id:a,distRatio:(r-e)/(r-o)}}return{id:0,distRatio:0}},h=a.prototype;h.handlePick=function(e){if(e.object===this.mesh){var t=e.data.index,a=this.data._meshX[t],o=this.data._meshY[t],r=this.data._meshZ[t],n=this.data._Ys.length,l=this.data._Zs.length,s=m(a,this.data._Xs).id,i=m(o,this.data._Ys).id,d=m(r,this.data._Zs).id,c=e.index=d+l*i+l*n*s;e.traceCoordinate=[this.data._meshX[c],this.data._meshY[c],this.data._meshZ[c],this.data._value[c]];var p=this.data.hovertext||this.data.text;return Array.isArray(p)&&void 0!==p[c]?e.textLabel=p[c]:p&&(e.textLabel=p),!0}},h.update=function(e){function t(e,t,a,o){return t.map(function(t){return e.d2l(t,0,o)*a})}var a=this.scene,r=a.fullSceneLayout;this.data=o(e);var i=g(t(r.xaxis,e._meshX,a.dataScale[0],e.xcalendar),t(r.yaxis,e._meshY,a.dataScale[1],e.ycalendar),t(r.zaxis,e._meshZ,a.dataScale[2],e.zcalendar)),n=g(e._meshI,e._meshJ,e._meshK),l={positions:i,cells:n,lightPosition:[e.lightposition.x,e.lightposition.y,e.lightposition.z],ambient:e.lighting.ambient,diffuse:e.lighting.diffuse,specular:e.lighting.specular,roughness:e.lighting.roughness,fresnel:e.lighting.fresnel,vertexNormalsEpsilon:e.lighting.vertexnormalsepsilon,faceNormalsEpsilon:e.lighting.facenormalsepsilon,opacity:e.opacity,contourEnable:e.contour.show,contourColor:p(e.contour.color).slice(0,3),contourWidth:e.contour.width,useFacetNormals:e.flatshading},s=u(e);l.vertexIntensity=e._meshIntensity,l.vertexIntensityBounds=[s.min,s.max],l.colormap=c(e),this.mesh.update(l)},h.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};var y=["xyz","xzy","yxz","yzx","zxy","zyx"];t.exports={findNearestOnAxis:m,generateIsoMeshes:o,createIsosurfaceTrace:function(e,t){var o=e.glplot.gl,r=d({gl:o}),i=new a(e,r,t.uid);return r._trace=i,i.update(t),e.glplot.add(r),i}}},{"../../components/colorscale":536,"../../lib/gl_format_color":654,"../../lib/str2rgbarray":680,"../../plots/gl3d/zip3":758,"gl-mesh3d":257}],1001:[function(e,t){'use strict';function a(e,t,a,o,i){var l=i("isomin"),s=i("isomax");s!==void 0&&null!==s&&l!==void 0&&null!==l&&l>s&&(t.isomin=null,t.isomax=null);var d=i("x"),c=i("y"),p=i("z"),u=i("value");if(!d||!d.length||!c||!c.length||!p||!p.length||!u||!u.length)return void(t.visible=!1);var g=r.getComponentMethod("calendars","handleTraceDefaults");g(e,t,["x","y","z"],o),["x","y","z"].forEach(function(e){var t="caps."+e,a=i(t+".show");a&&i(t+".fill");var o="slices."+e,r=i(o+".show");r&&(i(o+".fill"),i(o+".locations"))});var m=i("spaceframe.show");m&&i("spaceframe.fill");var h=i("surface.show");h&&(i("surface.count"),i("surface.fill"),i("surface.pattern"));var y=i("contour.show");y&&(i("contour.color"),i("contour.width")),["text","hovertext","hovertemplate","lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","opacity"].forEach(function(e){i(e)}),n(e,t,o,i,{prefix:"",cLetter:"c"}),t._length=null}var o=e("../../lib"),r=e("../../registry"),i=e("./attributes"),n=e("../../components/colorscale/defaults");t.exports={supplyDefaults:function(e,t,r,n){a(e,t,r,n,function(a,r){return o.coerce(e,t,i,a,r)})},supplyIsoDefaults:a}},{"../../components/colorscale/defaults":534,"../../lib":657,"../../registry":788,"./attributes":998}],1002:[function(e,t){'use strict';t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults").supplyDefaults,calc:e("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:e("./convert").createIsosurfaceTrace,moduleType:"trace",name:"isosurface",basePlotModule:e("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":747,"./attributes":998,"./calc":999,"./convert":1e3,"./defaults":1001}],1003:[function(e,t){'use strict';var a=e("../../components/colorscale/attributes"),o=e("../../plots/template_attributes").hovertemplateAttrs,r=e("../surface/attributes"),i=e("../../plots/attributes"),n=e("../../lib/extend").extendFlat;t.exports=n({x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},i:{valType:"data_array",editType:"calc"},j:{valType:"data_array",editType:"calc"},k:{valType:"data_array",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:o({editType:"calc"}),delaunayaxis:{valType:"enumerated",values:["x","y","z"],dflt:"z",editType:"calc"},alphahull:{valType:"number",dflt:-1,editType:"calc"},intensity:{valType:"data_array",editType:"calc"},intensitymode:{valType:"enumerated",values:["vertex","cell"],dflt:"vertex",editType:"calc"},color:{valType:"color",editType:"calc"},vertexcolor:{valType:"data_array",editType:"calc"},facecolor:{valType:"data_array",editType:"calc"},transforms:void 0},a("",{colorAttr:"`intensity`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:r.opacity,flatshading:{valType:"boolean",dflt:!1,editType:"calc"},contour:{show:n({},r.contours.x.show,{}),color:r.contours.x.color,width:r.contours.x.width,editType:"calc"},lightposition:{x:n({},r.lightposition.x,{dflt:1e5}),y:n({},r.lightposition.y,{dflt:1e5}),z:n({},r.lightposition.z,{dflt:0}),editType:"calc"},lighting:n({vertexnormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-12,editType:"calc"},facenormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-6,editType:"calc"},editType:"calc"},r.lighting),hoverinfo:n({},i.hoverinfo,{editType:"calc"}),showlegend:n({},i.showlegend,{dflt:!1})})},{"../../components/colorscale/attributes":531,"../../lib/extend":648,"../../plots/attributes":702,"../../plots/template_attributes":783,"../surface/attributes":1185}],1004:[function(e,t){'use strict';var a=e("../../components/colorscale/calc");t.exports=function(e,t){t.intensity&&a(e,t,{vals:t.intensity,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":532}],1005:[function(e,t){'use strict';function a(e,t,a){this.scene=e,this.uid=a,this.mesh=t,this.name="",this.color="#fff",this.data=null,this.showContour=!1}function o(e){for(var t=[],a=e.length,o=0;o<a;o++)t[o]=m(e[o]);return t}function r(e,t,a,o){for(var r=[],n=t.length,l=0;l<n;l++)r[l]=e.d2l(t[l],0,o)*a;return r}function i(e){for(var t=[],a=e.length,o=0;o<a;o++)t[o]=Math.round(e[o]);return t}function n(e,t){for(var a=["x","y","z"].indexOf(e),o=[],r=t.length,n=0;n<r;n++)o[n]=[t[n][(a+1)%3],t[n][(a+2)%3]];return c(o)}function l(e,t){for(var a=e.length,o=0;o<a;o++)if(-.5>=e[o]||e[o]>=t-.5)return!1;return!0}var s=e("gl-mesh3d"),c=e("delaunay-triangulate"),p=e("alpha-shape"),u=e("convex-hull"),g=e("../../lib/gl_format_color").parseColorScale,m=e("../../lib/str2rgbarray"),h=e("../../components/colorscale").extractOpts,y=e("../../plots/gl3d/zip3"),f=a.prototype;f.handlePick=function(e){if(e.object===this.mesh){var t=e.index=e.data.index;e.traceCoordinate=e.data._cellCenter?e.data.dataCoordinate:[this.data.x[t],this.data.y[t],this.data.z[t]];var a=this.data.hovertext||this.data.text;return Array.isArray(a)&&void 0!==a[t]?e.textLabel=a[t]:a&&(e.textLabel=a),!0}},f.update=function(e){var t=this.scene,a=t.fullSceneLayout;this.data=e;var s=e.x.length,d=y(r(a.xaxis,e.x,t.dataScale[0],e.xcalendar),r(a.yaxis,e.y,t.dataScale[1],e.ycalendar),r(a.zaxis,e.z,t.dataScale[2],e.zcalendar)),c;if(e.i&&e.j&&e.k){if(e.i.length!==e.j.length||e.j.length!==e.k.length||!l(e.i,s)||!l(e.j,s)||!l(e.k,s))return;c=y(i(e.i),i(e.j),i(e.k))}else c=0===e.alphahull?u(d):0<e.alphahull?p(e.alphahull,d):n(e.delaunayaxis,d);var f={positions:d,cells:c,lightPosition:[e.lightposition.x,e.lightposition.y,e.lightposition.z],ambient:e.lighting.ambient,diffuse:e.lighting.diffuse,specular:e.lighting.specular,roughness:e.lighting.roughness,fresnel:e.lighting.fresnel,vertexNormalsEpsilon:e.lighting.vertexnormalsepsilon,faceNormalsEpsilon:e.lighting.facenormalsepsilon,opacity:e.opacity,contourEnable:e.contour.show,contourColor:m(e.contour.color).slice(0,3),contourWidth:e.contour.width,useFacetNormals:e.flatshading};if(e.intensity){var x=h(e);this.color="#fff";var _=e.intensitymode;f[_+"Intensity"]=e.intensity,f[_+"IntensityBounds"]=[x.min,x.max],f.colormap=g(e)}else e.vertexcolor?(this.color=e.vertexcolor[0],f.vertexColors=o(e.vertexcolor)):e.facecolor?(this.color=e.facecolor[0],f.cellColors=o(e.facecolor)):(this.color=e.color,f.meshColor=m(e.color));this.mesh.update(f)},f.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},t.exports=function(e,t){var o=e.glplot.gl,r=s({gl:o}),i=new a(e,r,t.uid);return r._trace=i,i.update(t),e.glplot.add(r),i}},{"../../components/colorscale":536,"../../lib/gl_format_color":654,"../../lib/str2rgbarray":680,"../../plots/gl3d/zip3":758,"alpha-shape":20,"convex-hull":77,"delaunay-triangulate":111,"gl-mesh3d":257}],1006:[function(e,t){'use strict';var a=e("../../registry"),o=e("../../lib"),r=e("../../components/colorscale/defaults"),i=e("./attributes");t.exports=function(e,t,n,l){function s(a,r){return o.coerce(e,t,i,a,r)}function d(e){var t=e.map(function(e){var t=s(e);return t&&o.isArrayOrTypedArray(t)?t:null});return t.every(function(e){return e&&e.length===t[0].length})&&t}var c=d(["x","y","z"]);if(!c)return void(t.visible=!1);if(d(["i","j","k"]),t.i&&(!t.j||!t.k)||t.j&&(!t.k||!t.i)||t.k&&(!t.i||!t.j))return void(t.visible=!1);var p=a.getComponentMethod("calendars","handleTraceDefaults");p(e,t,["x","y","z"],l),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","alphahull","delaunayaxis","opacity"].forEach(function(e){s(e)});var u=s("contour.show");u&&(s("contour.color"),s("contour.width")),"intensity"in e?(s("intensity"),s("intensitymode"),r(e,t,l,s,{prefix:"",cLetter:"c"})):(t.showscale=!1,"facecolor"in e?s("facecolor"):"vertexcolor"in e?s("vertexcolor"):s("color",n)),s("text"),s("hovertext"),s("hovertemplate"),t._length=null}},{"../../components/colorscale/defaults":534,"../../lib":657,"../../registry":788,"./attributes":1003}],1007:[function(e,t){'use strict';t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:e("./convert"),moduleType:"trace",name:"mesh3d",basePlotModule:e("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":747,"./attributes":1003,"./calc":1004,"./convert":1005,"./defaults":1006}],1008:[function(e,t){'use strict';function a(e){return{line:{color:o({},c.color,{dflt:e}),width:c.width,dash:i,editType:"style"},editType:"style"}}var o=e("../../lib").extendFlat,r=e("../scatter/attributes"),i=e("../../components/drawing/attributes").dash,n=e("../../components/fx/attributes"),l=e("../../constants/delta.js"),s=l.INCREASING.COLOR,d=l.DECREASING.COLOR,c=r.line;t.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},open:{valType:"data_array",editType:"calc"},high:{valType:"data_array",editType:"calc"},low:{valType:"data_array",editType:"calc"},close:{valType:"data_array",editType:"calc"},line:{width:o({},c.width,{}),dash:o({},i,{}),editType:"style"},increasing:a(s),decreasing:a(d),text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},tickwidth:{valType:"number",min:0,max:.5,dflt:.3,editType:"calc"},hoverlabel:o({},n.hoverlabel,{split:{valType:"boolean",dflt:!1,editType:"style"}})}},{"../../components/drawing/attributes":545,"../../components/fx/attributes":555,"../../constants/delta.js":627,"../../lib":657,"../scatter/attributes":1062}],1009:[function(e,t){'use strict';function a(e,t,a,o){return{o:e,h:t,l:a,c:o}}function o(e,t,a,r,u){for(var g=r.makeCalcdata(t,"open"),o=r.makeCalcdata(t,"high"),m=r.makeCalcdata(t,"low"),l=r.makeCalcdata(t,"close"),c=Array.isArray(t.text),h=Array.isArray(t.hovertext),y=!0,f=null,x=[],_=0;_<a.length;_++){var b=a[_],v=g[_],w=o[_],k=m[_],T=l[_];if(b!==p&&v!==p&&w!==p&&k!==p&&T!==p){T===v?null!==f&&T!==f&&(y=T>f):y=T>v,f=T;var A=u(v,w,k,T);A.pos=b,A.yc=(v+T)/2,A.i=_,A.dir=y?"increasing":"decreasing",A.x=A.pos,A.y=[k,w],c&&(A.tx=t.text[_]),h&&(A.htx=t.hovertext[_]),x.push(A)}else x.push({pos:b,empty:!0})}return t._extremes[r._id]=d.findExtremes(r,n.concat(m,o),{padded:!0}),x.length&&(x[0].t={labels:{open:s(e,"open:")+" ",high:s(e,"high:")+" ",low:s(e,"low:")+" ",close:s(e,"close:")+" "}}),x}function r(e,t,a){var o=a._minDiff;if(!o){var r=e._fullData,l=[];o=1/0;var s;for(s=0;s<r.length;s++){var d=r[s];if("ohlc"===d.type&&!0===d.visible&&d.xaxis===t._id){l.push(d);var c=t.makeCalcdata(d,"x");d._xcalc=c;var p=n.distinctVals(c).minDiff;p&&isFinite(p)&&(o=Math.min(o,p))}}for(o===1/0&&(o=1),s=0;s<l.length;s++)l[s]._minDiff=o}return o*a.tickwidth}var n=e("../../lib"),s=n._,d=e("../../plots/cartesian/axes"),p=e("../../constants/numerical").BADNUM;t.exports={calc:function(e,t){var i=d.getFromId(e,t.xaxis),l=d.getFromId(e,t.yaxis),s=r(e,i,t),c=t._minDiff;t._minDiff=null;var p=t._xcalc;t._xcalc=null;var u=o(e,t,p,l,a);return t._extremes[i._id]=d.findExtremes(i,p,{vpad:c/2}),u.length?(n.extendFlat(u[0].t,{wHover:c/2,tickLen:s}),u):[{t:{empty:!0}}]},calcCommon:o}},{"../../constants/numerical":633,"../../lib":657,"../../plots/cartesian/axes":705}],1010:[function(e,t){'use strict';function a(e,t,a,o){a(o+".line.color"),a(o+".line.width",t.line.width),a(o+".line.dash",t.line.dash)}var o=e("../../lib"),r=e("./ohlc_defaults"),i=e("./attributes");t.exports=function(e,t,n,l){function s(a,r){return o.coerce(e,t,i,a,r)}var d=r(e,t,s,l);return d?void(s("line.width"),s("line.dash"),a(e,t,s,"increasing"),a(e,t,s,"decreasing"),s("text"),s("hovertext"),s("tickwidth"),l._requestRangeslider[t.xaxis]=!0):void(t.visible=!1)}},{"../../lib":657,"./attributes":1008,"./ohlc_defaults":1013}],1011:[function(e,t){'use strict';var i=Math.min,n=Math.abs;function a(e,a,o,r){function l(e){var t=_(e);return d.inbox(t-v,t+v,k)}function s(e){var t=e[y],a=e[f];return t===a||d.inbox(t-o,a-o,k)}function p(e){return(l(e)+s(e))/2}var u=e.cd,g=e.xa,m=u[0].trace,h=u[0].t,t=m.type,y="ohlc"===t?"l":"min",f="ohlc"===t?"h":"max",x=h.bPos||0,_=function(e){return e.pos+x-a},b=h.bdPos||h.tickLen,v=h.wHover,w=i(1,b/n(g.r2c(g.range[1])-g.r2c(g.range[0]))),k,T;k=e.maxHoverDistance-w,T=e.maxSpikeDistance-w;var A=d.getDistanceFunction(r,l,s,p);if(d.getClosest(u,A,e),!1===e.index)return null;var S=u[e.index];if(S.empty)return null;var C=S.dir,L=m[C],E=L.line.color;return e.color=c.opacity(E)&&L.line.width?E:L.fillcolor,e.x0=g.c2p(S.pos+x-b,!0),e.x1=g.c2p(S.pos+x+b,!0),e.xLabelVal=S.pos,e.spikeDistance=p(S)*T/k,e.xSpike=g.c2p(S.pos,!0),e}function o(e,o,r,n){var d=e.cd,c=e.ya,p=d[0].trace,u=d[0].t,t=[],g=a(e,o,r,n);if(!g)return[];var m=g.index,h=d[m],y=h.hi||p.hoverinfo,f=y.split("+"),x="all"===y||-1!==f.indexOf("y");if(!x)return[];for(var _=["high","open","close","low"],b={},v=0;v<_.length;v++){var w=_[v],k=p[w][g.index],T=c.c2p(k,!0),A;k in b?(A=b[k],A.yLabel+="<br>"+u.labels[w]+l.hoverLabelText(c,k)):(A=s.extendFlat({},g),A.y0=A.y1=T,A.yLabelVal=k,A.yLabel=u.labels[w]+l.hoverLabelText(c,k),A.name="",t.push(A),b[k]=A)}return t}function r(e,o,r,n){function s(e){return m.labels[e]+l.hoverLabelText(c,u[e][f])}var d=e.cd,c=e.ya,u=d[0].trace,m=d[0].t,t=a(e,o,r,n);if(!t)return[];var h=t.index,y=d[h],f=t.index=y.i,i=y.dir,x=y.hi||u.hoverinfo,_=x.split("+"),b="all"===x,v=b||-1!==_.indexOf("y"),w=b||-1!==_.indexOf("text"),k=v?[s("open"),s("high"),s("low"),s("close")+"  "+g[i]]:[];return w&&p(y,u,k),t.extraText=k.join("<br>"),t.y0=t.y1=c.c2p(y.yc,!0),[t]}var l=e("../../plots/cartesian/axes"),s=e("../../lib"),d=e("../../components/fx"),c=e("../../components/color"),p=e("../../lib").fillText,u=e("../../constants/delta.js"),g={increasing:u.INCREASING.SYMBOL,decreasing:u.DECREASING.SYMBOL};t.exports={hoverPoints:function(e,t,a,i){var n=e.cd,l=n[0].trace;return l.hoverlabel.split?o(e,t,a,i):r(e,t,a,i)},hoverSplit:o,hoverOnPoints:r}},{"../../components/color":524,"../../components/fx":564,"../../constants/delta.js":627,"../../lib":657,"../../plots/cartesian/axes":705}],1012:[function(e,t){'use strict';t.exports={moduleType:"trace",name:"ohlc",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","showLegend"],meta:{},attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc").calc,plot:e("./plot"),style:e("./style"),hoverPoints:e("./hover").hoverPoints,selectPoints:e("./select")}},{"../../plots/cartesian":718,"./attributes":1008,"./calc":1009,"./defaults":1010,"./hover":1011,"./plot":1014,"./select":1015,"./style":1016}],1013:[function(e,t){'use strict';var a=Math.min,o=e("../../registry"),r=e("../../lib");t.exports=function(e,t,i,n){var l=i("x"),s=i("open"),d=i("high"),c=i("low"),p=i("close");i("hoverlabel.split");var u=o.getComponentMethod("calendars","handleTraceDefaults");if(u(e,t,["x"],n),!!(s&&d&&c&&p)){var g=a(s.length,d.length,c.length,p.length);return l&&(g=a(g,r.minRowLength(l))),t._length=g,g}}},{"../../lib":657,"../../registry":788}],1014:[function(e,t){'use strict';var a=e("d3"),o=e("../../lib");t.exports=function(e,t,r,i){var n=t.xaxis,l=t.yaxis;o.makeTraceGroups(i,r,"trace ohlc").each(function(e){var r=a.select(this),i=e[0],s=i.t,t=i.trace;if(!0!==t.visible||s.empty)return void r.remove();var c=s.tickLen,p=r.selectAll("path").data(o.identity);p.enter().append("path"),p.exit().remove(),p.attr("d",function(e){if(e.empty)return"M0,0Z";var t=n.c2p(e.pos,!0),a=n.c2p(e.pos-c,!0),o=n.c2p(e.pos+c,!0),r=l.c2p(e.o,!0),i=l.c2p(e.h,!0),s=l.c2p(e.l,!0),d=l.c2p(e.c,!0);return"M"+a+","+r+"H"+t+"M"+t+","+i+"V"+s+"M"+o+","+d+"H"+t})})}},{"../../lib":657,d3:108}],1015:[function(e,t){'use strict';t.exports=function(e,t){var a=e.cd,o=e.xaxis,r=e.yaxis,n=[],l=a[0].t.bPos||0,s;if(!1===t)for(s=0;s<a.length;s++)a[s].selected=0;else for(s=0;s<a.length;s++){var d=a[s];t.contains([o.c2p(d.pos+l),r.c2p(d.yc)],null,d.i,e)?(n.push({pointNumber:d.i,x:o.c2d(d.pos),y:r.c2d(d.yc)}),d.selected=1):d.selected=0}return n}},{}],1016:[function(e,t){'use strict';var a=e("d3"),o=e("../../components/drawing"),r=e("../../components/color");t.exports=function(e,t,i){var n=i?i:a.select(e).selectAll("g.ohlclayer").selectAll("g.trace");n.style("opacity",function(e){return e[0].trace.opacity}),n.each(function(e){var t=e[0].trace;a.select(this).selectAll("path").each(function(e){if(!e.empty){var i=t[e.dir].line;a.select(this).style("fill","none").call(r.stroke,i.color).call(o.dashLine,i.dash,i.width).style("opacity",t.selectedpoints&&!e.selected?.3:1)}})})}},{"../../components/color":524,"../../components/drawing":546,d3:108}],1017:[function(e,t){'use strict';var a=e("../../lib/extend").extendFlat,o=e("../../plots/attributes"),r=e("../../plots/font_attributes"),i=e("../../components/colorscale/attributes"),n=e("../../plots/template_attributes").hovertemplateAttrs,l=e("../../plots/domain").attributes,s=a({editType:"calc"},i("line",{editTypeOverride:"calc"}),{shape:{valType:"enumerated",values:["linear","hspline"],dflt:"linear",editType:"plot"},hovertemplate:n({editType:"plot",arrayOk:!1},{keys:["count","probability"]})});t.exports={domain:l({name:"parcats",trace:!0,editType:"calc"}),hoverinfo:a({},o.hoverinfo,{flags:["count","probability"],editType:"plot",arrayOk:!1}),hoveron:{valType:"enumerated",values:["category","color","dimension"],dflt:"category",editType:"plot"},hovertemplate:n({editType:"plot",arrayOk:!1},{keys:["count","probability","category","categorycount","colorcount","bandcolorcount"]}),arrangement:{valType:"enumerated",values:["perpendicular","freeform","fixed"],dflt:"perpendicular",editType:"plot"},bundlecolors:{valType:"boolean",dflt:!0,editType:"plot"},sortpaths:{valType:"enumerated",values:["forward","backward"],dflt:"forward",editType:"plot"},labelfont:r({editType:"calc"}),tickfont:r({editType:"calc"}),dimensions:{_isLinkedToArray:"dimension",label:{valType:"string",editType:"calc"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},values:{valType:"data_array",dflt:[],editType:"calc"},displayindex:{valType:"integer",editType:"calc"},editType:"calc",visible:{valType:"boolean",dflt:!0,editType:"calc"}},line:s,counts:{valType:"number",min:0,dflt:1,arrayOk:!0,editType:"calc"},customdata:void 0,hoverlabel:void 0,ids:void 0,legendgroup:void 0,opacity:void 0,selectedpoints:void 0,showlegend:void 0}},{"../../components/colorscale/attributes":531,"../../lib/extend":648,"../../plots/attributes":702,"../../plots/domain":732,"../../plots/font_attributes":733,"../../plots/template_attributes":783}],1018:[function(e,t,a){'use strict';var o=e("../../plots/get_data").getModuleCalcData,r=e("./plot"),i="parcats";a.name=i,a.plot=function(e,t,a,n){var l=o(e.calcdata,i);if(l.length){var s=l[0];r(e,s,a,n)}},a.clean=function(e,t,a,o){var r=o._has&&o._has("parcats"),i=t._has&&t._has("parcats");r&&!i&&o._paperdiv.selectAll(".parcats").remove()}},{"../../plots/get_data":742,"./plot":1023}],1019:[function(e,t){'use strict';function a(e,t,a){var o=e.map(function(e){return e.categories.length}).reduce(function(e,t){return Math.max(e,t)});return{dimensions:e,paths:t,trace:void 0,maxCats:o,count:a}}function o(e,t,a,o,r){return{dimensionInd:e,containerInd:t,displayInd:a,dimensionLabel:o,count:r,categories:[],dragX:null}}function r(e,t,a,o){return{dimensionInd:e,categoryInd:t,categoryValue:a,displayInd:t,categoryLabel:o,valueInds:[],count:0,dragY:null}}function i(e,t,a){e.valueInds.push(t),e.count+=a}function n(e,t,a){return{categoryInds:e,color:t,rawColor:a,valueInds:[],count:0}}function l(e,t,a){e.valueInds.push(t),e.count+=a}function s(e,t){t=void 0===t||null===t?[]:t.map(function(t){return t});var a={},o={},r=[];t.forEach(function(e,t){a[e]=0,o[e]=t});for(var n=0;n<e.length;n++){var l=e[n],s;a[l]===void 0?(a[l]=1,s=t.push(l)-1,o[l]=s):(a[l]++,s=o[l]),r.push(s)}var d=t.map(function(e){return a[e]});return{uniqueValues:t,uniqueCounts:d,inds:r}}function c(e){var t=e.map(function(e){return e.displayindex}),a;if(u(t))for(a=0;a<e.length;a++)e[a]._displayindex=e[a].displayindex;else for(a=0;a<e.length;a++)e[a]._displayindex=a}function p(e,t){e._categoryarray=t.uniqueValues,e._ticktext=null===e.ticktext||void 0===e.ticktext?[]:e.ticktext.slice();for(var a=e._ticktext.length;a<t.uniqueValues.length;a++)e._ticktext.push(t.uniqueValues[a])}function u(e){for(var t=Array(e.length),a=0;a<e.length;a++){if(0>e[a]||e[a]>=e.length)return!1;if(void 0!==t[e[a]])return!1;t[e[a]]=!0}return!0}var g=e("../../lib/gup").wrap,m=e("../../components/colorscale/helpers").hasColorscale,h=e("../../components/colorscale/calc"),y=e("../../lib/filter_unique.js"),f=e("../../components/drawing"),x=e("../../lib");t.exports=function(e,t){function u(e){var t,a;return x.isArrayOrTypedArray(T.color)?(t=T.color[e%T.color.length],a=t):t=T.color,{color:A(t),rawColor:a}}var _=x.filterVisible(t.dimensions);if(0===_.length)return[];var b=_.map(function(e){var t;return"trace"===e.categoryorder?t=null:"array"===e.categoryorder?t=e.categoryarray:(t=y(e.values).sort(),"category descending"===e.categoryorder&&(t=t.reverse())),s(e.values,t)}),v,w,k;v=x.isArrayOrTypedArray(t.counts)?t.counts:[t.counts],c(_),_.forEach(function(e,t){p(e,b[t])});var T=t.line,A;T?(m(t,"line")&&h(e,t,{vals:t.line.color,containerStr:"line",cLetter:"c"}),A=f.tryColorscale(T)):A=x.identity;var S=_[0].values.length,C={},L=b.map(function(e){return e.inds});k=0;var E,I;for(E=0;E<S;E++){var P=[];for(I=0;I<L.length;I++)P.push(L[I][E]);w=v[E%v.length],k+=w;var z=u(E),D="-"+z.rawColor;C[D]===void 0&&(C[D]=n(P,z.color,z.rawColor)),l(C[D],E,w)}var O=_.map(function(e,t){return o(t,e._index,e._displayindex,e.label,k)});for(E=0;E<S;E++)for(w=v[E%v.length],I=0;I<O.length;I++){var R=O[I].containerInd,M=b[I].inds[E],j=O[I].categories;if(void 0===j[M]){var B=t.dimensions[R]._categoryarray[M],F=t.dimensions[R]._ticktext[M];j[M]=r(I,M,B,F)}i(j[M],E,w)}return g(a(O,C,k))}},{"../../components/colorscale/calc":532,"../../components/colorscale/helpers":535,"../../components/drawing":546,"../../lib":657,"../../lib/filter_unique.js":649,"../../lib/gup":655}],1020:[function(e,t){'use strict';var r=Math.round;function a(e,t,a,o,r){r("line.shape"),r("line.hovertemplate");var s=r("line.color",o.colorway[0]);if(n(e,"line")&&i.isArrayOrTypedArray(s)){if(s.length)return r("line.colorscale"),l(e,t,o,r,{prefix:"line.",cLetter:"c"}),s.length;t.line.color=a}return 1/0}function o(e,t){function a(a,o){return i.coerce(e,t,c.dimensions,a,o)}var o=a("values"),r=a("visible");if(o&&o.length||(r=t.visible=!1),r){a("label"),a("displayindex",t._index);var n=e.categoryarray,l=Array.isArray(n)&&0<n.length,s;l&&(s="array");var d=a("categoryorder",s);"array"===d?(a("categoryarray"),a("ticktext")):(delete e.categoryarray,delete e.ticktext),l||"array"!==d||(t.categoryorder="trace")}}var i=e("../../lib"),n=e("../../components/colorscale/helpers").hasColorscale,l=e("../../components/colorscale/defaults"),s=e("../../plots/domain").defaults,d=e("../../plots/array_container_defaults"),c=e("./attributes"),p=e("../parcoords/merge_length");t.exports=function(e,t,n,l){function u(a,o){return i.coerce(e,t,c,a,o)}var g=d(e,t,{name:"dimensions",handleItemDefaults:o}),m=a(e,t,n,l,u);s(t,l,u),Array.isArray(g)&&g.length||(t.visible=!1),p(t,g,"values",m),u("hoveron"),u("hovertemplate"),u("arrangement"),u("bundlecolors"),u("sortpaths"),u("counts");var h={family:l.font.family,size:r(l.font.size),color:l.font.color};i.coerceFont(u,"labelfont",h);var y={family:l.font.family,size:r(l.font.size/1.2),color:l.font.color};i.coerceFont(u,"tickfont",y)}},{"../../components/colorscale/defaults":534,"../../components/colorscale/helpers":535,"../../lib":657,"../../plots/array_container_defaults":701,"../../plots/domain":732,"../parcoords/merge_length":1033,"./attributes":1017}],1021:[function(e,t){'use strict';t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc"),plot:e("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcats",basePlotModule:e("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1017,"./base_plot":1018,"./calc":1019,"./defaults":1020,"./plot":1023}],1022:[function(e,t){'use strict';var F=Math.floor;function a(e,t,a,s){var d=e.map(O.bind(0,t,a)),c=s.selectAll("g.parcatslayer").data([null]);c.enter().append("g").attr("class","parcatslayer").style("pointer-events","all");var g=c.selectAll("g.trace.parcats").data(d,o),m=g.enter().append("g").attr("class","trace parcats");g.attr("transform",function(e){return"translate("+e.x+", "+e.y+")"}),m.append("g").attr("class","paths");var y=g.select("g.paths"),x=y.selectAll("path.path").data(function(e){return e.paths},o);x.attr("fill",function(e){return e.model.color});var _=x.enter().append("path").attr("class","path").attr("stroke-opacity",0).attr("fill",function(e){return e.model.color}).attr("fill-opacity",0);u(_),x.attr("d",function(e){return e.svgD}),_.empty()||x.sort(i),x.exit().remove(),x.on("mouseover",n).on("mouseout",l).on("click",p),m.append("g").attr("class","dimensions");var b=g.select("g.dimensions"),v=b.selectAll("g.dimension").data(function(e){return e.dimensions},o);v.enter().append("g").attr("class","dimension"),v.attr("transform",function(e){return"translate("+e.x+", 0)"}),v.exit().remove();var w=v.selectAll("g.category").data(function(e){return e.categories},o),k=w.enter().append("g").attr("class","category");w.attr("transform",function(e){return"translate(0, "+e.y+")"}),k.append("rect").attr("class","catrect").attr("pointer-events","none"),w.select("rect.catrect").attr("fill","none").attr("width",function(e){return e.width}).attr("height",function(e){return e.height}),h(k);var T=w.selectAll("rect.bandrect").data(function(e){return e.bands},o);T.each(function(){H.raiseToTop(this)}),T.attr("fill",function(e){return e.color});var A=T.enter().append("rect").attr("class","bandrect").attr("stroke-opacity",0).attr("fill",function(e){return e.color}).attr("fill-opacity",0);T.attr("fill",function(e){return e.color}).attr("width",function(e){return e.width}).attr("height",function(e){return e.height}).attr("y",function(e){return e.y}).attr("cursor",function(e){return"fixed"===e.parcatsViewModel.arrangement?"default":"perpendicular"===e.parcatsViewModel.arrangement?"ns-resize":"move"}),f(A),T.exit().remove(),k.append("text").attr("class","catlabel").attr("pointer-events","none");var P=t._fullLayout.paper_bgcolor;w.select("text.catlabel").attr("text-anchor",function(e){return r(e)?"start":"end"}).attr("alignment-baseline","middle").style("text-shadow",P+" -1px  1px 2px, "+P+" 1px  1px 2px, "+P+"  1px -1px 2px, "+P+" -1px -1px 2px").style("fill","rgb(0, 0, 0)").attr("x",function(e){return r(e)?e.width+5:-5}).attr("y",function(e){return e.height/2}).text(function(e){return e.model.categoryLabel}).each(function(e){q.font(N.select(this),e.parcatsViewModel.categorylabelfont),Y.convertToTspans(N.select(this),t)}),k.append("text").attr("class","dimlabel"),w.select("text.dimlabel").attr("text-anchor","middle").attr("alignment-baseline","baseline").attr("cursor",function(e){return"fixed"===e.parcatsViewModel.arrangement?"default":"ew-resize"}).attr("x",function(e){return e.width/2}).attr("y",-5).text(function(e,t){return 0===t?e.parcatsViewModel.model.dimensions[e.model.dimensionInd].dimensionLabel:null}).each(function(e){q.font(N.select(this),e.parcatsViewModel.labelfont)}),w.selectAll("rect.bandrect").on("mouseover",S).on("mouseout",C),w.exit().remove(),v.call(N.behavior.drag().origin(function(e){return{x:e.x,y:0}}).on("dragstart",L).on("drag",E).on("dragend",I)),g.each(function(e){e.traceSelection=N.select(this),e.pathSelection=N.select(this).selectAll("g.paths").selectAll("path.path"),e.dimensionSelection=N.select(this).selectAll("g.dimensions").selectAll("g.dimension")}),g.exit().remove()}function o(e){return e.key}function r(e){var t=e.parcatsViewModel.dimensions.length,a=e.parcatsViewModel.dimensions[t-1].model.dimensionInd;return e.model.dimensionInd===a}function i(e,t){return e.model.rawColor>t.model.rawColor?1:e.model.rawColor<t.model.rawColor?-1:0}function n(e){if(!e.parcatsViewModel.dragDimension&&-1===e.parcatsViewModel.hoverinfoItems.indexOf("skip")){H.raiseToTop(this),g(N.select(this));var t=s(e),a=c(e);if(e.parcatsViewModel.graphDiv.emit("plotly_hover",{points:t,event:N.event,constraints:a}),-1===e.parcatsViewModel.hoverinfoItems.indexOf("none")){var o=N.mouse(this)[0],r=e.parcatsViewModel.graphDiv,i=e.parcatsViewModel.trace,n=r._fullLayout,l=n._paperdiv.node().getBoundingClientRect(),d=e.parcatsViewModel.graphDiv.getBoundingClientRect(),p,u,m;for(m=0;m<e.leftXs.length-1;m++)if(e.leftXs[m]+e.dimWidths[m]-2<=o&&o<=e.leftXs[m+1]+2){var h=e.parcatsViewModel.dimensions[m],y=e.parcatsViewModel.dimensions[m+1];p=(h.x+h.width+y.x)/2,u=(e.topYs[m]+e.topYs[m+1]+e.height)/2;break}var f=e.parcatsViewModel.x+p,x=e.parcatsViewModel.y+u,_=G.mostReadable(e.model.color,["black","white"]),b=e.model.count,v=b/e.parcatsViewModel.model.count,w={countLabel:b,probabilityLabel:v.toFixed(3)},k=[];-1!==e.parcatsViewModel.hoverinfoItems.indexOf("count")&&k.push(["Count:",w.countLabel].join(" ")),-1!==e.parcatsViewModel.hoverinfoItems.indexOf("probability")&&k.push(["P:",w.probabilityLabel].join(" "));var T=k.join("<br>"),A=N.mouse(r)[0];U.loneHover({trace:i,x:f-l.left+d.left,y:x-l.top+d.top,text:T,color:e.model.color,borderColor:"black",fontFamily:"Monaco, \"Courier New\", monospace",fontSize:10,fontColor:_,idealAlign:A<f?"right":"left",hovertemplate:(i.line||{}).hovertemplate,hovertemplateLabels:w,eventData:[{data:i._input,fullData:i,count:b,probability:v}]},{container:n._hoverlayer.node(),outerContainer:n._paper.node(),gd:r})}}}function l(e){if(!e.parcatsViewModel.dragDimension&&(u(N.select(this)),U.loneUnhover(e.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()),e.parcatsViewModel.pathSelection.sort(i),-1===e.parcatsViewModel.hoverinfoItems.indexOf("skip"))){var t=s(e),a=c(e);e.parcatsViewModel.graphDiv.emit("plotly_unhover",{points:t,event:N.event,constraints:a})}}function s(e){for(var t=[],a=P(e.parcatsViewModel),o=0,r;o<e.model.valueInds.length;o++)r=e.model.valueInds[o],t.push({curveNumber:a,pointNumber:r});return t}function c(e){for(var t={},a=e.parcatsViewModel.model.dimensions,o=0;o<a.length;o++){var r=a[o],n=r.categories[e.model.categoryInds[o]];t[r.containerInd]=n.categoryValue}return void 0!==e.model.rawColor&&(t.color=e.model.rawColor),t}function p(e){if(-1===e.parcatsViewModel.hoverinfoItems.indexOf("skip")){var t=s(e),a=c(e);e.parcatsViewModel.graphDiv.emit("plotly_click",{points:t,event:N.event,constraints:a})}}function u(e){e.attr("fill",function(e){return e.model.color}).attr("fill-opacity",.6).attr("stroke","lightgray").attr("stroke-width",.2).attr("stroke-opacity",1)}function g(e){e.attr("fill-opacity",.8).attr("stroke",function(e){return G.mostReadable(e.model.color,["black","white"])}).attr("stroke-width",.3)}function m(e){e.select("rect.catrect").attr("stroke","black").attr("stroke-width",2.5)}function h(e){e.select("rect.catrect").attr("stroke","black").attr("stroke-width",1).attr("stroke-opacity",1)}function y(e){e.attr("stroke","black").attr("stroke-width",1.5)}function f(e){e.attr("stroke","black").attr("stroke-width",.2).attr("stroke-opacity",1).attr("fill-opacity",1)}function x(e){var t=e.parcatsViewModel.pathSelection,a=e.categoryViewModel.model.dimensionInd,o=e.categoryViewModel.model.categoryInd;return t.filter(function(t){return t.model.categoryInds[a]===o&&t.model.color===e.color})}function _(e){var t=N.select(e.parentNode).selectAll("rect.bandrect");t.each(function(e){var t=x(e);g(t),t.each(function(){H.raiseToTop(this)})}),m(N.select(e.parentNode))}function b(e){var t=N.select(e).datum(),a=x(t);g(a),a.each(function(){H.raiseToTop(this)}),N.select(e.parentNode).selectAll("rect.bandrect").filter(function(e){return e.color===t.color}).each(function(){H.raiseToTop(this),y(N.select(this))})}function v(e,t,a){var o=N.select(e).datum(),r=o.categoryViewModel.model,i=o.parcatsViewModel.graphDiv,n=N.select(e.parentNode).selectAll("rect.bandrect"),l=[];n.each(function(e){var t=x(e);t.each(function(e){Array.prototype.push.apply(l,s(e))})});var d={};d[r.dimensionInd]=r.categoryValue,i.emit(t,{points:l,event:a,constraints:d})}function w(e,t,a){var o=N.select(e).datum(),r=o.categoryViewModel.model,i=o.parcatsViewModel.graphDiv,n=x(o),l=[];n.each(function(e){Array.prototype.push.apply(l,s(e))});var d={};d[r.dimensionInd]=r.categoryValue,o.rawColor!==void 0&&(d.color=o.rawColor),i.emit(t,{points:l,event:a,constraints:d})}function k(e,t){var a=N.select(t.parentNode).select("rect.catrect"),o=a.node().getBoundingClientRect(),r=a.datum(),i=r.parcatsViewModel,n=i.model.dimensions[r.model.dimensionInd],l=i.trace,s=o.top+o.height/2,d,c;1<i.dimensions.length&&n.displayInd===i.dimensions.length-1?(d=o.left,c="left"):(d=o.left+o.width,c="right");var p=r.model.count,u=r.model.categoryLabel,g=p/r.parcatsViewModel.model.count,m={countLabel:p,categoryLabel:u,probabilityLabel:g.toFixed(3)},h=[];-1!==r.parcatsViewModel.hoverinfoItems.indexOf("count")&&h.push(["Count:",m.countLabel].join(" ")),-1!==r.parcatsViewModel.hoverinfoItems.indexOf("probability")&&h.push(["P("+m.categoryLabel+"):",m.probabilityLabel].join(" "));var y=h.join("<br>");return{trace:l,x:d-e.left,y:s-e.top,text:y,color:"lightgray",borderColor:"black",fontFamily:"Monaco, \"Courier New\", monospace",fontSize:12,fontColor:"black",idealAlign:c,hovertemplate:l.hovertemplate,hovertemplateLabels:m,eventData:[{data:l._input,fullData:l,count:p,category:u,probability:g}]}}function T(e,t){var a=[];return N.select(t.parentNode.parentNode).selectAll("g.category").select("rect.catrect").each(function(){var t=this;a.push(k(e,t))}),a}function A(e,t){var a=t.getBoundingClientRect(),o=N.select(t).datum(),r=o.categoryViewModel,i=r.parcatsViewModel,n=i.model.dimensions[r.model.dimensionInd],l=i.trace,s=a.y+a.height/2,d,c;1<i.dimensions.length&&n.displayInd===i.dimensions.length-1?(d=a.left,c="left"):(d=a.left+a.width,c="right");var p=r.model.categoryLabel,u=o.parcatsViewModel.model.count,g=0;o.categoryViewModel.bands.forEach(function(e){e.color===o.color&&(g+=e.count)});var m=r.model.count,h=0;i.pathSelection.each(function(e){e.model.color===o.color&&(h+=e.model.count)});var y=g/u,f=g/h,x=g/m,_={countLabel:u,categoryLabel:p,probabilityLabel:y.toFixed(3)},b=[];-1!==r.parcatsViewModel.hoverinfoItems.indexOf("count")&&b.push(["Count:",_.countLabel].join(" ")),-1!==r.parcatsViewModel.hoverinfoItems.indexOf("probability")&&(b.push("P(color \u2229 "+p+"): "+_.probabilityLabel),b.push("P("+p+" | color): "+f.toFixed(3)),b.push("P(color | "+p+"): "+x.toFixed(3)));var v=b.join("<br>"),w=G.mostReadable(o.color,["black","white"]);return{trace:l,x:d-e.left,y:s-e.top,text:v,color:o.color,borderColor:"black",fontFamily:"Monaco, \"Courier New\", monospace",fontColor:w,fontSize:10,idealAlign:c,hovertemplate:l.hovertemplate,hovertemplateLabels:_,eventData:[{data:l._input,fullData:l,category:p,count:u,probability:y,categorycount:m,colorcount:h,bandcolorcount:g}]}}function S(e){if(!e.parcatsViewModel.dragDimension&&-1===e.parcatsViewModel.hoverinfoItems.indexOf("skip")){var t=N.mouse(this)[1];if(-1>t)return;var a=e.parcatsViewModel.graphDiv,o=a._fullLayout,r=o._paperdiv.node().getBoundingClientRect(),i=e.parcatsViewModel.hoveron,n=this;if("color"===i?(b(n),w(n,"plotly_hover",N.event)):(_(n),v(n,"plotly_hover",N.event)),-1===e.parcatsViewModel.hoverinfoItems.indexOf("none")){var l;"category"===i?l=k(r,n):"color"===i?l=A(r,n):"dimension"===i&&(l=T(r,n)),l&&U.loneHover(l,{container:o._hoverlayer.node(),outerContainer:o._paper.node(),gd:a})}}}function C(e){var t=e.parcatsViewModel;if(!t.dragDimension&&(u(t.pathSelection),h(t.dimensionSelection.selectAll("g.category")),f(t.dimensionSelection.selectAll("g.category").selectAll("rect.bandrect")),U.loneUnhover(t.graphDiv._fullLayout._hoverlayer.node()),t.pathSelection.sort(i),-1===t.hoverinfoItems.indexOf("skip"))){var a=e.parcatsViewModel.hoveron,o=this;"color"===a?w(o,"plotly_unhover",N.event):v(o,"plotly_unhover",N.event)}}function L(e){"fixed"===e.parcatsViewModel.arrangement||(e.dragDimensionDisplayInd=e.model.displayInd,e.initialDragDimensionDisplayInds=e.parcatsViewModel.model.dimensions.map(function(e){return e.displayInd}),e.dragHasMoved=!1,e.dragCategoryDisplayInd=null,N.select(this).selectAll("g.category").select("rect.catrect").each(function(t){var a=N.mouse(this)[0],o=N.mouse(this)[1];-2<=a&&a<=t.width+2&&-2<=o&&o<=t.height+2&&(e.dragCategoryDisplayInd=t.model.displayInd,e.initialDragCategoryDisplayInds=e.model.categories.map(function(e){return e.displayInd}),t.model.dragY=t.y,H.raiseToTop(this.parentNode),N.select(this.parentNode).selectAll("rect.bandrect").each(function(t){t.y<o&&o<=t.y+t.height&&(e.potentialClickBand=this)}))}),e.parcatsViewModel.dragDimension=e,U.loneUnhover(e.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()))}function E(e){if("fixed"!==e.parcatsViewModel.arrangement&&(e.dragHasMoved=!0,null!==e.dragDimensionDisplayInd)){var t=e.dragDimensionDisplayInd,a=e.parcatsViewModel.dimensions[t];if(null!==e.dragCategoryDisplayInd){var o=a.categories[e.dragCategoryDisplayInd];o.model.dragY+=N.event.dy;var r=o.model.dragY,i=o.model.displayInd,n=a.categories,l=n[i-1],s=n[i+1];void 0!==l&&r<l.y+l.height/2&&(o.model.displayInd=l.model.displayInd,l.model.displayInd=i),void 0!==s&&r+o.height>s.y+s.height/2&&(o.model.displayInd=s.model.displayInd,s.model.displayInd=i),e.dragCategoryDisplayInd=o.model.displayInd}if(null===e.dragCategoryDisplayInd||"freeform"===e.parcatsViewModel.arrangement){a.model.dragX=N.event.x;var d=e.parcatsViewModel.dimensions[t-1],c=e.parcatsViewModel.dimensions[t+1];void 0!==d&&a.model.dragX<d.x+d.width&&(a.model.displayInd=d.model.displayInd,d.model.displayInd=t),void 0!==c&&a.model.dragX+a.width>c.x&&(a.model.displayInd=c.model.displayInd,c.model.displayInd=e.dragDimensionDisplayInd),e.dragDimensionDisplayInd=a.model.displayInd}j(e.parcatsViewModel),M(e.parcatsViewModel),D(e.parcatsViewModel),z(e.parcatsViewModel)}}function I(e){if("fixed"!==e.parcatsViewModel.arrangement&&null!==e.dragDimensionDisplayInd){N.select(this).selectAll("text").attr("font-weight","normal");var t={},a=P(e.parcatsViewModel),o=e.parcatsViewModel.model.dimensions.map(function(e){return e.displayInd}),r=e.initialDragDimensionDisplayInds.some(function(e,t){return e!==o[t]});r&&o.forEach(function(a,o){var r=e.parcatsViewModel.model.dimensions[o].containerInd;t["dimensions["+r+"].displayindex"]=a});var i=!1;if(null!==e.dragCategoryDisplayInd){var n=e.model.categories.map(function(e){return e.displayInd});if(i=e.initialDragCategoryDisplayInds.some(function(e,t){return e!==n[t]}),i){var l=e.model.categories.slice().sort(function(e,t){return e.displayInd-t.displayInd}),s=l.map(function(e){return e.categoryValue}),d=l.map(function(e){return e.categoryLabel});t["dimensions["+e.model.containerInd+"].categoryarray"]=[s],t["dimensions["+e.model.containerInd+"].ticktext"]=[d],t["dimensions["+e.model.containerInd+"].categoryorder"]="array"}}if(-1===e.parcatsViewModel.hoverinfoItems.indexOf("skip")&&!e.dragHasMoved&&e.potentialClickBand&&("color"===e.parcatsViewModel.hoveron?w(e.potentialClickBand,"plotly_click",N.event.sourceEvent):v(e.potentialClickBand,"plotly_click",N.event.sourceEvent)),e.model.dragX=null,null!==e.dragCategoryDisplayInd){var c=e.parcatsViewModel.dimensions[e.dragDimensionDisplayInd].categories[e.dragCategoryDisplayInd];c.model.dragY=null,e.dragCategoryDisplayInd=null}e.dragDimensionDisplayInd=null,e.parcatsViewModel.dragDimension=null,e.dragHasMoved=null,e.potentialClickBand=null,j(e.parcatsViewModel),M(e.parcatsViewModel);var p=N.transition().duration(300).ease("cubic-in-out");p.each(function(){D(e.parcatsViewModel,!0),z(e.parcatsViewModel,!0)}).each("end",function(){(r||i)&&V.restyle(e.parcatsViewModel.graphDiv,t,[a])})}}function P(e){for(var t=e.graphDiv._fullData,a=0,o;a<t.length;a++)if(e.key===t[a].uid){o=a;break}return o}function z(e,t){function a(e){return t?e.transition():e}t===void 0&&(t=!1),e.pathSelection.data(function(e){return e.paths},o),a(e.pathSelection).attr("d",function(e){return e.svgD})}function D(e,t){function a(e){return t?e.transition():e}t===void 0&&(t=!1),e.dimensionSelection.data(function(e){return e.dimensions},o);var i=e.dimensionSelection.selectAll("g.category").data(function(e){return e.categories},o);a(e.dimensionSelection).attr("transform",function(e){return"translate("+e.x+", 0)"}),a(i).attr("transform",function(e){return"translate(0, "+e.y+")"});var n=i.select(".dimlabel");n.text(function(e,t){return 0===t?e.parcatsViewModel.model.dimensions[e.model.dimensionInd].dimensionLabel:null});var l=i.select(".catlabel");l.attr("text-anchor",function(e){return r(e)?"start":"end"}).attr("x",function(e){return r(e)?e.width+5:-5}).each(function(e){var t,a;r(e)?(t=e.width+5,a="start"):(t=-5,a="end"),N.select(this).selectAll("tspan").attr("x",t).attr("text-anchor",a)});var s=i.selectAll("rect.bandrect").data(function(e){return e.bands},o),d=s.enter().append("rect").attr("class","bandrect").attr("cursor","move").attr("stroke-opacity",0).attr("fill",function(e){return e.color}).attr("fill-opacity",0);s.attr("fill",function(e){return e.color}).attr("width",function(e){return e.width}).attr("height",function(e){return e.height}).attr("y",function(e){return e.y}),f(d),s.each(function(){H.raiseToTop(this)}),s.exit().remove()}function O(e,t,a){var o=a[0],r=t.margin||{l:80,r:80,t:100,b:80},i=o.trace,n=i.domain,l=t.width,s=t.height,d=F(l*(n.x[1]-n.x[0])),c=F(s*(n.y[1]-n.y[0])),p=n.x[0]*l+r.l,u=t.height-n.y[1]*t.height+r.t,g=i.line.shape,m;m="all"===i.hoverinfo?["count","probability"]:(i.hoverinfo||"").split("+");var h={trace:i,key:i.uid,model:o,x:p,y:u,width:d,height:c,hoveron:i.hoveron,hoverinfoItems:m,arrangement:i.arrangement,bundlecolors:i.bundlecolors,sortpaths:i.sortpaths,labelfont:i.labelfont,categorylabelfont:i.tickfont,pathShape:g,dragDimension:null,margin:r,paths:[],dimensions:[],graphDiv:e,traceSelection:null,pathSelection:null,dimensionSelection:null};return o.dimensions&&(j(h),M(h)),h}function R(e,t,a,o,r){var i=[],n=[],l,s;for(s=0;s<a.length-1;s++)l=N.interpolateNumber(a[s]+e[s],e[s+1]),i.push(l(r)),n.push(l(1-r));var c="M "+e[0]+","+t[0];for(c+="l"+a[0]+",0 ",s=1;s<a.length;s++)c+="C"+i[s-1]+","+t[s-1]+" "+n[s-1]+","+t[s]+" "+e[s]+","+t[s],c+="l"+a[s]+",0 ";for(c+="l0,"+o+" ",c+="l -"+a[a.length-1]+",0 ",s=a.length-2;0<=s;s--)c+="C"+n[s]+","+(t[s+1]+o)+" "+i[s]+","+(t[s]+o)+" "+(e[s]+a[s])+","+(t[s]+o),c+="l-"+a[s]+",0 ";return c+="Z",c}function M(e){function t(e){var t=e.categoryInds.map(function(e,t){return i[t][e]}),a=l.map(function(e){return t[e]});return a}var a=e.dimensions,o=e.model,r=a.map(function(e){return e.categories.map(function(e){return e.y})}),i=e.model.dimensions.map(function(e){return e.categories.map(function(e){return e.displayInd})}),n=e.model.dimensions.map(function(e){return e.displayInd}),l=e.dimensions.map(function(e){return e.model.dimensionInd}),s=a.map(function(e){return e.x}),c=a.map(function(e){return e.width}),u=[];for(var g in o.paths)o.paths.hasOwnProperty(g)&&u.push(o.paths[g]);u.sort(function(a,o){var r=t(a),i=t(o);return"backward"===e.sortpaths&&(r.reverse(),i.reverse()),r.push(a.valueInds[0]),i.push(o.valueInds[0]),e.bundlecolors&&(r.unshift(a.rawColor),i.unshift(o.rawColor)),r<i?-1:r>i?1:0});for(var p=Array(u.length),m=a[0].model.count,h=a[0].categories.map(function(e){return e.height}).reduce(function(e,t){return e+t}),y=0;y<u.length;y++){var f=u[y],x;x=0<m?h*(f.count/m):0;for(var _=Array(r.length),b=0;b<f.categoryInds.length;b++){var v=f.categoryInds[b],w=i[b][v],k=n[b];_[k]=r[k][w],r[k][w]+=x;var T=e.dimensions[k].categories[w],A=T.bands.length,S=T.bands[A-1];if(S===void 0||f.rawColor!==S.rawColor){var C=S===void 0?0:S.y+S.height;T.bands.push({key:C,color:f.color,rawColor:f.rawColor,height:x,width:T.width,count:f.count,y:C,categoryViewModel:T,parcatsViewModel:e})}else{var L=T.bands[A-1];L.height+=x,L.count+=f.count}}var E;E="hspline"===e.pathShape?R(s,_,c,x,.5):R(s,_,c,x,0),p[y]={key:f.valueInds[0],model:f,height:x,leftXs:s,topYs:_,dimWidths:c,svgD:E,parcatsViewModel:e}}e.paths=p}function j(e){var t=e.model.dimensions.map(function(e){return{displayInd:e.displayInd,dimensionInd:e.dimensionInd}});t.sort(function(e,t){return e.displayInd-t.displayInd});var a=[];for(var o in t){var r=t[o].dimensionInd,i=e.model.dimensions[r];a.push(B(e,i))}e.dimensions=a}function B(e,t){var a=16,o=e.model.dimensions.length,r=t.displayInd,i,n,l;i=1<o?(e.width-80-a)/(o-1):0,n=40,l=n+i*r;var s=[],d=e.model.maxCats,c=t.categories.length,p=8,u=t.count,g=e.height-p*(d-1),m=(d-c)*p/2,h=t.categories.map(function(e){return{displayInd:e.displayInd,categoryInd:e.categoryInd}}),y,f,x,_,b;for(h.sort(function(e,t){return e.displayInd-t.displayInd}),b=0;b<c;b++)_=h[b].categoryInd,f=t.categories[_],y=0<u?f.count/u*g:0,x={key:f.valueInds[0],model:f,width:a,height:y,y:null===f.dragY?m:f.dragY,bands:[],parcatsViewModel:e},m=m+y+p,s.push(x);return{key:t.dimensionInd,x:null===t.dragX?l:t.dragX,y:0,width:a,model:t,categories:s,parcatsViewModel:e,dragCategoryDisplayInd:null,dragDimensionDisplayInd:null,initialDragDimensionDisplayInds:null,initialDragCategoryDisplayInds:null,dragHasMoved:null,potentialClickBand:null}}var N=e("d3"),V=e("../../plot_api/plot_api"),U=e("../../components/fx"),H=e("../../lib"),q=e("../../components/drawing"),G=e("tinycolor2"),Y=e("../../lib/svg_text_utils");t.exports=function(e,t,o,r){a(o,e,r,t)}},{"../../components/drawing":546,"../../components/fx":564,"../../lib":657,"../../lib/svg_text_utils":681,"../../plot_api/plot_api":692,d3:108,tinycolor2:1309}],1023:[function(e,t){'use strict';var a=e("./parcats");t.exports=function(e,t,o,r){var i=e._fullLayout,n=i._paper,l=i._size;a(e,n,t,{width:l.w,height:l.h,margin:{t:l.t,r:l.r,b:l.b,l:l.l}},o,r)}},{"./parcats":1022}],1024:[function(e,t){'use strict';var a=e("../../components/colorscale/attributes"),o=e("../../plots/cartesian/layout_attributes"),r=e("../../plots/font_attributes"),i=e("../../plots/domain").attributes,n=e("../../lib/extend").extendFlat,l=e("../../plot_api/plot_template").templatedArray;t.exports={domain:i({name:"parcoords",trace:!0,editType:"plot"}),labelangle:{valType:"angle",dflt:0,editType:"plot"},labelside:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},labelfont:r({editType:"plot"}),tickfont:r({editType:"plot"}),rangefont:r({editType:"plot"}),dimensions:l("dimension",{label:{valType:"string",editType:"plot"},tickvals:n({},o.tickvals,{editType:"plot"}),ticktext:n({},o.ticktext,{editType:"plot"}),tickformat:n({},o.tickformat,{editType:"plot"}),visible:{valType:"boolean",dflt:!0,editType:"plot"},range:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},constraintrange:{valType:"info_array",freeLength:!0,dimensions:"1-2",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},multiselect:{valType:"boolean",dflt:!0,editType:"plot"},values:{valType:"data_array",editType:"calc"},editType:"calc"}),line:n({editType:"calc"},a("line",{colorscaleDflt:"Viridis",autoColorDflt:!1,editTypeOverride:"calc"}))}},{"../../components/colorscale/attributes":531,"../../lib/extend":648,"../../plot_api/plot_template":695,"../../plots/cartesian/layout_attributes":719,"../../plots/domain":732,"../../plots/font_attributes":733}],1025:[function(e,t){'use strict';var P=Math.min,z=Math.max;function o(e,t){return e*(1-R)+t*R}function r(e,t){return e*(1-M)+t*M}function i(e,t,a,l){if(n(a,l))return a;var s=e?-1:1,d=0,c=t.length-1;if(0>s){var p=d;d=c,c=p}for(var u=t[d],g=u,m=d;s*m<s*c;m+=s){var h=m+s,y=t[h];if(s*a<s*r(u,y))return o(u,g);if(s*a<s*y||h===c)return o(y,u);g=u,u=y}}function n(e,t){for(var a=0;a<t.length;a++)if(e>=t[a][0]&&e<=t[a][1])return!0;return!1}function l(e){e.attr("x",-D.bar.captureWidth/2).attr("width",D.bar.captureWidth)}function s(e){e.attr("visibility","visible").style("visibility","visible").attr("fill","yellow").attr("opacity",0)}function d(e){if(!e.brush.filterSpecified)return"0,"+e.height;for(var t=u(e.brush.filter.getConsolidated(),e.height),a=[0],o=t.length?t[0][0]:null,r=0,n,l,s;r<t.length;r++)n=t[r],l=n[1]-n[0],a.push(o),a.push(l),s=r+1,s<t.length&&(o=t[s][0]-n[1]);return a.push(e.height),a}function u(e,t){return e.map(function(e){return e.map(function(e){return z(0,e*t)}).sort(O)})}function g(e,t){var a=D.bar.handleHeight;return t>e[1]+a||t<e[0]-a?void 0:t>=.9*e[1]+.1*e[0]?"n":t<=.9*e[0]+.1*e[1]?"s":"ns"}function m(){c.select(document.body).style("cursor",null)}function h(e){e.attr("stroke-dasharray",d)}function f(e,t){var a=c.select(e).selectAll(".highlight, .highlight-shadow"),o=t?a.transition().duration(D.bar.snapDuration).each("end",t):a;h(o)}function x(e,t){var o=e.brush,r=o.filterSpecified,n=NaN,l={},s;if(r){var d=e.height,c=o.filter.getConsolidated(),m=u(c,d),h=NaN,y=NaN,f=NaN;for(s=0;s<=m.length;s++){var x=m[s];if(x&&x[0]<=t&&t<=x[1]){h=s;break}else if(y=s?s-1:NaN,x&&x[0]>t){f=s;break}}if(n=h,isNaN(n)&&(isNaN(y)||isNaN(f)?n=isNaN(y)?f:y:n=t-m[y][1]<m[f][0]-t?y:f),!isNaN(n)){var p=m[n],_=g(p,t);_&&(l.interval=c[n],l.intervalPix=p,l.region=_)}}if(e.ordinal&&!l.region){var b=e.unitTickvals,a=e.unitToPaddedPx.invert(t);for(s=0;s<b.length;s++){var v=[.25*b[z(s-1,0)]+.75*b[s],.25*b[P(s+1,b.length-1)]+.75*b[s]];if(a>=v[0]&&a<=v[1]){l.clickableOrdinalRange=v;break}}}return l}function _(e,t){c.event.sourceEvent.stopPropagation();var a=t.height-c.mouse(e)[1]-2*D.verticalPadding,o=t.unitToPaddedPx.invert(a),r=t.brush,i=x(t,a),n=i.interval,l=r.svgBrush;if(l.wasDragged=!1,l.grabbingBar="ns"===i.region,l.grabbingBar){var s=n.map(t.unitToPaddedPx);l.grabPoint=a-s[0]-D.verticalPadding,l.barLength=s[1]-s[0]}l.clickableOrdinalRange=i.clickableOrdinalRange,l.stayingIntervals=t.multiselect&&r.filterSpecified?r.filter.getConsolidated():[],n&&(l.stayingIntervals=l.stayingIntervals.filter(function(e){return e[0]!==n[0]&&e[1]!==n[1]})),l.startExtent=i.region?n["s"===i.region?1:0]:o,t.parent.inBrushDrag=!0,l.brushStartCallback()}function b(e,t){c.event.sourceEvent.stopPropagation();var a=t.height-c.mouse(e)[1]-2*D.verticalPadding,o=t.brush.svgBrush;o.wasDragged=!0,o._dragging=!0,o.newExtent=o.grabbingBar?[a-o.grabPoint,a+o.barLength-o.grabPoint].map(t.unitToPaddedPx.invert):[o.startExtent,t.unitToPaddedPx.invert(a)].sort(O),t.brush.filterSpecified=!0,o.extent=o.stayingIntervals.concat([o.newExtent]),o.brushCallback(t),f(e.parentNode)}function v(t,o){var r=o.brush,n=r.filter,l=r.svgBrush;l._dragging||(w(t,o),b(t,o),o.brush.svgBrush.wasDragged=!1),l._dragging=!1;var s=c.event;s.sourceEvent.stopPropagation();var e=l.grabbingBar;if(l.grabbingBar=!1,l.grabLocation=void 0,o.parent.inBrushDrag=!1,m(),!l.wasDragged)return l.wasDragged=void 0,l.clickableOrdinalRange?r.filterSpecified&&o.multiselect?l.extent.push(l.clickableOrdinalRange):(l.extent=[l.clickableOrdinalRange],r.filterSpecified=!0):e?(l.extent=l.stayingIntervals,0===l.extent.length&&C(r)):C(r),l.brushCallback(o),f(t.parentNode),void l.brushEndCallback(r.filterSpecified?n.getConsolidated():[]);var d=function(){n.set(n.getConsolidated())};if(o.ordinal){var p=o.unitTickvals;p[p.length-1]<p[0]&&p.reverse(),l.newExtent=[i(0,p,l.newExtent[0],l.stayingIntervals),i(1,p,l.newExtent[1],l.stayingIntervals)];var a=l.newExtent[1]>l.newExtent[0];l.extent=l.stayingIntervals.concat(a?[l.newExtent]:[]),l.extent.length||C(r),l.brushCallback(o),a?f(t.parentNode,d):(d(),f(t.parentNode))}else d();l.brushEndCallback(r.filterSpecified?n.getConsolidated():[])}function w(e,t){var a=t.height-c.mouse(e)[1]-2*D.verticalPadding,o=x(t,a),r="crosshair";o.clickableOrdinalRange?r="pointer":o.region&&(r=o.region+"-resize"),c.select(document.body).style("cursor",r)}function k(e){e.on("mousemove",function(e){c.event.preventDefault(),e.parent.inBrushDrag||w(this,e)}).on("mouseleave",function(e){e.parent.inBrushDrag||m()}).call(c.behavior.drag().on("dragstart",function(e){_(this,e)}).on("drag",function(e){b(this,e)}).on("dragend",function(e){v(this,e)}))}function T(e,t){return e[0]-t[0]}function A(e){var t=e.selectAll(".background").data(p);t.enter().append("rect").classed("background",!0).call(l).call(s).style("pointer-events","auto").attr("transform","translate(0 "+D.verticalPadding+")"),t.call(k).attr("height",function(e){return e.height-D.verticalPadding});var a=e.selectAll(".highlight-shadow").data(p);a.enter().append("line").classed("highlight-shadow",!0).attr("x",-D.bar.width/2).attr("stroke-width",D.bar.width+D.bar.strokeWidth).attr("stroke",D.bar.strokeColor).attr("opacity",D.bar.strokeOpacity).attr("stroke-linecap","butt"),a.attr("y1",function(e){return e.height}).call(h);var o=e.selectAll(".highlight").data(p);o.enter().append("line").classed("highlight",!0).attr("x",-D.bar.width/2).attr("stroke-width",D.bar.width-D.bar.strokeWidth).attr("stroke",D.bar.fillColor).attr("opacity",D.bar.fillOpacity).attr("stroke-linecap","butt"),o.attr("y1",function(e){return e.height}).call(h)}function S(e){return e.svgBrush.extent.map(function(t){return t.slice()})}function C(e){e.filterSpecified=!1,e.svgBrush.extent=[[-Infinity,1/0]]}function L(e){return function(t){var a=t.brush,o=S(a),r=o.slice();a.filter.set(r),e()}}function E(e){for(var t=e.slice(),a=[],o=t.shift(),r;o;){for(r=o.slice();(o=t.shift())&&o[0]<=r[1];)r[1]=z(r[1],o[1]);a.push(r)}return a}function I(){var e=[],t,o;return{set:function(r){e=r.map(function(e){return e.slice().sort(O)}).sort(T),1===e.length&&e[0][0]===-Infinity&&e[0][1]===1/0&&(e=[[0,-1]]),t=E(e),o=e.reduce(function(e,t){return[P(e[0],t[0]),z(e[1],t[1])]},[1/0,-Infinity])},get:function(){return e.slice()},getConsolidated:function(){return t},getBounds:function(){return o}}}var D=e("./constants"),c=e("d3"),a=e("../../lib/gup").keyFun,p=e("../../lib/gup").repeat,O=e("../../lib").sorterAsc,R=D.bar.snapRatio,M=D.bar.snapClose;t.exports={makeBrush:function(e,t,a,o,r,i){var n=I();return n.set(a),{filter:n,filterSpecified:t,svgBrush:{extent:[],brushStartCallback:o,brushCallback:L(r),brushEndCallback:i}}},ensureAxisBrush:function(e){var t=e.selectAll("."+D.cn.axisBrush).data(p,a);t.enter().append("g").classed(D.cn.axisBrush,!0),A(t)},cleanRanges:function(e,t){if(Array.isArray(e[0])?(e=e.map(function(e){return e.sort(O)}),e=t.multiselect?E(e.sort(T)):[e[0]]):e=[e.sort(O)],t.tickvals){var a=t.tickvals.slice().sort(O);if(e=e.map(function(e){var t=[i(0,a,e[0],[]),i(1,a,e[1],[])];if(t[1]>t[0])return t}).filter(function(e){return e}),!e.length)return}return 1<e.length?e:e[0]}}},{"../../lib":657,"../../lib/gup":655,"./constants":1028,d3:108}],1026:[function(e,t,a){'use strict';var o=e("d3"),r=e("../../plots/get_data").getModuleCalcData,i=e("./plot"),n=e("../../constants/xmlns_namespaces");a.name="parcoords",a.plot=function(e){var t=r(e.calcdata,"parcoords")[0];t.length&&i(e,t)},a.clean=function(e,t,a,o){var r=o._has&&o._has("parcoords"),i=t._has&&t._has("parcoords");r&&!i&&(o._paperdiv.selectAll(".parcoords").remove(),o._glimages.selectAll("*").remove())},a.toSVG=function(e){var t=e._fullLayout._glimages,a=o.select(e).selectAll(".svg-container"),r=a.filter(function(e,t){return t===a.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus");r.each(function(){var e=this,a=e.toDataURL("image/png"),o=t.append("svg:image");o.attr({xmlns:n.svg,"xlink:href":a,preserveAspectRatio:"none",x:0,y:0,width:e.width,height:e.height})}),window.setTimeout(function(){o.selectAll("#filterBarPattern").attr("id","filterBarPattern")},60)}},{"../../constants/xmlns_namespaces":634,"../../plots/get_data":742,"./plot":1035,d3:108}],1027:[function(e,t){'use strict';function a(e){for(var t=Array(e),a=0;a<e;a++)t[a]=.5;return t}var o=e("../../lib").isArrayOrTypedArray,r=e("../../components/colorscale"),i=e("../../lib/gup").wrap;t.exports=function(e,t){var n,l;return r.hasColorscale(t,"line")&&o(t.line.color)?(n=t.line.color,l=r.extractOpts(t.line).colorscale,r.calc(e,t,{vals:n,containerStr:"line",cLetter:"c"})):(n=a(t._length),l=[[0,t.line.color],[1,t.line.color]]),i({lineColor:n,cscale:l})}},{"../../components/colorscale":536,"../../lib":657,"../../lib/gup":655}],1028:[function(e,t){'use strict';t.exports={maxDimensionCount:60,overdrag:45,verticalPadding:2,tickDistance:50,canvasPixelRatio:1,blockLineCount:5e3,layers:["contextLineLayer","focusLineLayer","pickLineLayer"],axisTitleOffset:28,axisExtentOffset:10,deselectedLineColor:"#777",bar:{width:4,captureWidth:10,fillColor:"magenta",fillOpacity:1,snapDuration:150,snapRatio:.25,snapClose:.01,strokeColor:"white",strokeOpacity:1,strokeWidth:1,handleHeight:8,handleOpacity:1,handleOverlap:0},cn:{axisExtentText:"axis-extent-text",parcoordsLineLayers:"parcoords-line-layers",parcoordsLineLayer:"parcoords-lines",parcoords:"parcoords",parcoordsControlView:"parcoords-control-view",yAxis:"y-axis",axisOverlays:"axis-overlays",axis:"axis",axisHeading:"axis-heading",axisTitle:"axis-title",axisExtent:"axis-extent",axisExtentTop:"axis-extent-top",axisExtentTopText:"axis-extent-top-text",axisExtentBottom:"axis-extent-bottom",axisExtentBottomText:"axis-extent-bottom-text",axisBrush:"axis-brush"},id:{filterBarPattern:"filter-bar-pattern"}}},{}],1029:[function(e,t){'use strict';function a(e,t,a,o,l){var s=l("line.color",a);if(i(e,"line")&&r.isArrayOrTypedArray(s)){if(s.length)return l("line.colorscale"),n(e,t,o,l,{prefix:"line.",cLetter:"c"}),s.length;t.line.color=a}return 1/0}function o(e,t,a,o){function i(a,o){return r.coerce(e,t,c.dimensions,a,o)}var n=i("values"),l=i("visible");if(n&&n.length||(l=t.visible=!1),l){i("label"),i("tickvals"),i("ticktext"),i("tickformat");var s=i("range");t._ax={_id:"y",type:"linear",showexponent:"all",exponentformat:"B",range:s},d.setConvert(t._ax,o.layout),i("multiselect");var u=i("constraintrange");u&&(t.constraintrange=p.cleanRanges(u,t))}}var r=e("../../lib"),i=e("../../components/colorscale/helpers").hasColorscale,n=e("../../components/colorscale/defaults"),l=e("../../plots/domain").defaults,s=e("../../plots/array_container_defaults"),d=e("../../plots/cartesian/axes"),c=e("./attributes"),p=e("./axisbrush"),u=e("./constants").maxDimensionCount,g=e("./merge_length");t.exports=function(e,t,i,n){function d(a,o){return r.coerce(e,t,c,a,o)}var p=e.dimensions;Array.isArray(p)&&p.length>u&&(r.log("parcoords traces support up to "+u+" dimensions at the moment"),p.splice(u));var m=s(e,t,{name:"dimensions",layout:n,handleItemDefaults:o}),h=a(e,t,i,n,d);l(t,n,d),Array.isArray(m)&&m.length||(t.visible=!1),g(t,m,"values",h);var y={family:n.font.family,size:Math.round(n.font.size/1.2),color:n.font.color};r.coerceFont(d,"labelfont",y),r.coerceFont(d,"tickfont",y),r.coerceFont(d,"rangefont",y),d("labelangle"),d("labelside")}},{"../../components/colorscale/defaults":534,"../../components/colorscale/helpers":535,"../../lib":657,"../../plots/array_container_defaults":701,"../../plots/cartesian/axes":705,"../../plots/domain":732,"./attributes":1024,"./axisbrush":1025,"./constants":1028,"./merge_length":1033}],1030:[function(e,t,a){'use strict';var o=e("../../lib").isTypedArray;a.convertTypedArray=function(e){return o(e)?Array.prototype.slice.call(e):e},a.isOrdinal=function(e){return!!e.tickvals},a.isVisible=function(e){return e.visible||!("visible"in e)}},{"../../lib":657}],1031:[function(e,t){'use strict';t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc"),plot:e("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcoords",basePlotModule:e("./base_plot"),categories:["gl","regl","noOpacity","noHover"],meta:{}}},{"./attributes":1024,"./base_plot":1026,"./calc":1027,"./defaults":1029,"./plot":1035}],1032:[function(e,t){'use strict';var _=Math.min,b=Math.pow,w=Math.max;function a(e){e.read({x:0,y:0,width:1,height:1,data:I})}function o(e,t,a,o,r){var i=e._gl;i.enable(i.SCISSOR_TEST),i.scissor(t,a,o,r),e.clear({color:[0,0,0,0],depth:1})}function r(e,t,r,i,n,l){function s(a){var c=_(i,n-a*i);0===a&&(window.cancelAnimationFrame(r.currentRafs[d]),delete r.currentRafs[d],o(e,l.scissorX,l.scissorY,l.scissorWidth,l.viewBoxSize[1]));r.clearOnly||(l.count=2*c,l.offset=2*a*i,t(l),a*i+c<n&&(r.currentRafs[d]=window.requestAnimationFrame(function(){s(a+1)})),r.drawCompleted=!1)}var d=l.key;r.drawCompleted||(a(e),r.drawCompleted=!0),s(0)}function l(e){return w(L,_(1-L,e))}function s(e,t){for(var a=Array(256),o=0;256>o;o++)a[o]=e(o/255).concat(t);return a}function d(e,t){return(e>>>8*t)%256/255}function c(e,t,a){for(var o=Array(e*(S+4)),r=0,s=0;s<e;s++){for(var c=0;c<S;c++)o[r++]=c<t.length?t[c].paddedUnitValues[s]:.5;o[r++]=d(s,2),o[r++]=d(s,1),o[r++]=d(s,0),o[r++]=l(a[s])}return o}function p(e,t,a){for(var o=Array(8*t),r=0,l=0;l<t;l++)for(var s=0;2>s;s++)for(var d=0;4>d;d++){var c=4*e+d,p=a[64*l+c];63==c&&0===s&&(p*=-1),o[r++]=p}return o}function u(e){var t="0"+e;return t.substr(t.length-2)}function g(e){return e<S?"p"+u(e+1)+"_"+u(e+4):"colors"}function m(e,t,a){for(var o=0;o<=S;o+=4)e[g(o)](p(o/4,t,a))}function h(e){for(var t={},a=0;a<=S;a+=4)t[g(a)]=e.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});return t}function f(e,t,a,o,r,i,n,l,s,d,c,p,u){for(var g=[[],[]],m=0;64>m;m++)g[0][m]=m===r?1:0,g[1][m]=m===i?1:0;var h=e.lines.canvasOverdrag,y=e.domain,f=e.canvasWidth,x=e.canvasHeight,_=e.deselectedLines.color,v=C.extendFlat({key:c,resolution:[f,x],viewBoxPos:[n+h,l],viewBoxSize:[s,d],i0:r,i1:i,dim0A:g[0].slice(0,16),dim0B:g[0].slice(16,32),dim0C:g[0].slice(32,48),dim0D:g[0].slice(48,64),dim1A:g[1].slice(0,16),dim1B:g[1].slice(16,32),dim1C:g[1].slice(32,48),dim1D:g[1].slice(48,64),drwLayer:p,contextColor:[_[0]/255,_[1]/255,_[2]/255,1>_[3]?_[3]:w(1/255,b(1/e.lines.color.length,1/3))],scissorX:(o===t?0:n+h)+(e.pad.l-h)+e.layoutWidth*y.x[0],scissorWidth:(o===a?f-n+h:s+.5)+(o===t?n+h:0),scissorY:l+e.pad.b+e.layoutHeight*y.y[0],scissorHeight:d,viewportX:e.pad.l-h+e.layoutWidth*y.x[0],viewportY:e.pad.b+e.layoutHeight*y.y[0],viewportWidth:f,viewportHeight:x},u);return v}function x(e){var t=w(0,Math.floor(e[0]*2047),0),a=_(2047,Math.ceil(e[1]*2047),2047);return[_(t,a),w(t,a)]}var k=e("glslify"),T=k(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nattribute vec4 p01_04, p05_08, p09_12, p13_16,\n               p17_20, p21_24, p25_28, p29_32,\n               p33_36, p37_40, p41_44, p45_48,\n               p49_52, p53_56, p57_60, colors;\n\nuniform mat4 dim0A, dim1A, dim0B, dim1B, dim0C, dim1C, dim0D, dim1D,\n             loA, hiA, loB, hiB, loC, hiC, loD, hiD;\n\nuniform vec2 resolution, viewBoxPos, viewBoxSize;\nuniform sampler2D mask, palette;\nuniform float maskHeight;\nuniform float drwLayer; // 0: context, 1: focus, 2: pick\nuniform vec4 contextColor;\n\nbool isPick    = (drwLayer > 1.5);\nbool isContext = (drwLayer < 0.5);\n\nconst vec4 ZEROS = vec4(0.0, 0.0, 0.0, 0.0);\nconst vec4 UNITS = vec4(1.0, 1.0, 1.0, 1.0);\n\nfloat val(mat4 p, mat4 v) {\n    return dot(matrixCompMult(p, v) * UNITS, UNITS);\n}\n\nfloat axisY(float ratio, mat4 A, mat4 B, mat4 C, mat4 D) {\n    float y1 = val(A, dim0A) + val(B, dim0B) + val(C, dim0C) + val(D, dim0D);\n    float y2 = val(A, dim1A) + val(B, dim1B) + val(C, dim1C) + val(D, dim1D);\n    return y1 * (1.0 - ratio) + y2 * ratio;\n}\n\nint iMod(int a, int b) {\n    return a - b * (a / b);\n}\n\nbool fOutside(float p, float lo, float hi) {\n    return (lo < hi) && (lo > p || p > hi);\n}\n\nbool vOutside(vec4 p, vec4 lo, vec4 hi) {\n    return (\n        fOutside(p[0], lo[0], hi[0]) ||\n        fOutside(p[1], lo[1], hi[1]) ||\n        fOutside(p[2], lo[2], hi[2]) ||\n        fOutside(p[3], lo[3], hi[3])\n    );\n}\n\nbool mOutside(mat4 p, mat4 lo, mat4 hi) {\n    return (\n        vOutside(p[0], lo[0], hi[0]) ||\n        vOutside(p[1], lo[1], hi[1]) ||\n        vOutside(p[2], lo[2], hi[2]) ||\n        vOutside(p[3], lo[3], hi[3])\n    );\n}\n\nbool outsideBoundingBox(mat4 A, mat4 B, mat4 C, mat4 D) {\n    return mOutside(A, loA, hiA) ||\n           mOutside(B, loB, hiB) ||\n           mOutside(C, loC, hiC) ||\n           mOutside(D, loD, hiD);\n}\n\nbool outsideRasterMask(mat4 A, mat4 B, mat4 C, mat4 D) {\n    mat4 pnts[4];\n    pnts[0] = A;\n    pnts[1] = B;\n    pnts[2] = C;\n    pnts[3] = D;\n\n    for(int i = 0; i < 4; ++i) {\n        for(int j = 0; j < 4; ++j) {\n            for(int k = 0; k < 4; ++k) {\n                if(0 == iMod(\n                    int(255.0 * texture2D(mask,\n                        vec2(\n                            (float(i * 2 + j / 2) + 0.5) / 8.0,\n                            (pnts[i][j][k] * (maskHeight - 1.0) + 1.0) / maskHeight\n                        ))[3]\n                    ) / int(pow(2.0, float(iMod(j * 4 + k, 8)))),\n                    2\n                )) return true;\n            }\n        }\n    }\n    return false;\n}\n\nvec4 position(bool isContext, float v, mat4 A, mat4 B, mat4 C, mat4 D) {\n    float x = 0.5 * sign(v) + 0.5;\n    float y = axisY(x, A, B, C, D);\n    float z = 1.0 - abs(v);\n\n    z += isContext ? 0.0 : 2.0 * float(\n        outsideBoundingBox(A, B, C, D) ||\n        outsideRasterMask(A, B, C, D)\n    );\n\n    return vec4(\n        2.0 * (vec2(x, y) * viewBoxSize + viewBoxPos) / resolution - 1.0,\n        z,\n        1.0\n    );\n}\n\nvoid main() {\n    mat4 A = mat4(p01_04, p05_08, p09_12, p13_16);\n    mat4 B = mat4(p17_20, p21_24, p25_28, p29_32);\n    mat4 C = mat4(p33_36, p37_40, p41_44, p45_48);\n    mat4 D = mat4(p49_52, p53_56, p57_60, ZEROS);\n\n    float v = colors[3];\n\n    gl_Position = position(isContext, v, A, B, C, D);\n\n    fragColor =\n        isContext ? vec4(contextColor) :\n        isPick ? vec4(colors.rgb, 1.0) : texture2D(palette, vec2(abs(v), 0.5));\n}\n"]),A=k(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n    gl_FragColor = fragColor;\n}\n"]),S=e("./constants").maxDimensionCount,C=e("../../lib"),L=1e-6,E=2048,I=new Uint8Array(4),P=new Uint8Array(4),z={shape:[256,1],format:"rgba",type:"uint8",mag:"nearest",min:"nearest"};t.exports=function(e,t){function a(e){D=e.model,O=e.viewModel,y=O.dimensions.slice(),k=y[0]?y[0].values.length:0;var t=D.lines,a=g?t.color.map(function(e,a){return a/t.color.length}):t.color,o=c(k,y,a);m(S,k,o),u||g||(L=_.texture(C.extendFlat({data:s(D.unitToColor,255)},z)))}function n(e){var t=[[],[]],a,o,r;for(r=0;64>r;r++){var n=!e&&r<y.length?y[r].brush.filter.getBounds():[-Infinity,1/0];t[0][r]=n[0],t[1][r]=n[1]}var l=8*E,s=Array(l);for(a=0;a<l;a++)s[a]=255;if(!e)for(a=0;a<y.length;a++){var d=a%8,c=(a-d)/8,p=b(2,d),u=y[a],g=u.brush.filter.get();if(!(2>g.length)){var m=x(g[0])[1];for(o=1;o<g.length;o++){var h=x(g[o]);for(r=m+1;r<h[0];r++)s[8*r+c]&=~p;m=w(m,h[1])}}}var f={shape:[8,E],format:"alpha",type:"uint8",mag:"nearest",min:"nearest",data:s};return R?R(f):R=_.texture(f),{maskTexture:R,maskHeight:E,loA:t[0].slice(0,16),loB:t[0].slice(16,32),loC:t[0].slice(32,48),loD:t[0].slice(48,64),hiA:t[1].slice(0,16),hiB:t[1].slice(16,32),hiC:t[1].slice(32,48),hiD:t[1].slice(48,64)}}function l(e,t,a){var l=e.length,s=1/0,d=-Infinity,c,m,h;for(c=0;c<l;c++)e[c].dim0.canvasX<s&&(s=e[c].dim0.canvasX,m=c),e[c].dim1.canvasX>d&&(d=e[c].dim1.canvasX,h=c);0===l&&o(_,0,0,D.canvasWidth,D.canvasHeight);var b=n(u);for(c=0;c<l;c++){var w=e[c],p=w.dim0.crossfilterDimensionIndex,T=w.dim1.crossfilterDimensionIndex,A=w.canvasX,x=w.canvasY,y=A+w.panelSizeX;if(t||!I[p]||I[p][0]!==A||I[p][1]!==y){I[p]=[A,y];var S=f(D,m,h,c,p,T,A,x,w.panelSizeX,w.panelSizeY,w.dim0.crossfilterDimensionIndex,u?0:g?2:1,b);v.clearOnly=a;var C=t?D.lines.blockLineCount:k;r(_,M,v,C,k,S)}}}function d(){for(var t in e.style["pointer-events"]="none",L.destroy(),R&&R.destroy(),S)S[t].destroy()}var u=t.context,g=t.pick,_=t.regl,v={currentRafs:{},drawCompleted:!0,clearOnly:!1},S=h(_),L=_.texture(z),I=[],D,O,y,k,R;a(t);var M=_({profile:!1,blend:{enable:u,func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:1,dstAlpha:1},equation:{rgb:"add",alpha:"add"},color:[0,0,0,0]},depth:{enable:!u,mask:!0,func:"less",range:[0,1]},cull:{enable:!0,face:"back"},scissor:{enable:!0,box:{x:_.prop("scissorX"),y:_.prop("scissorY"),width:_.prop("scissorWidth"),height:_.prop("scissorHeight")}},viewport:{x:_.prop("viewportX"),y:_.prop("viewportY"),width:_.prop("viewportWidth"),height:_.prop("viewportHeight")},dither:!1,vert:T,frag:A,primitive:"lines",lineWidth:1,attributes:S,uniforms:{resolution:_.prop("resolution"),viewBoxPos:_.prop("viewBoxPos"),viewBoxSize:_.prop("viewBoxSize"),dim0A:_.prop("dim0A"),dim1A:_.prop("dim1A"),dim0B:_.prop("dim0B"),dim1B:_.prop("dim1B"),dim0C:_.prop("dim0C"),dim1C:_.prop("dim1C"),dim0D:_.prop("dim0D"),dim1D:_.prop("dim1D"),loA:_.prop("loA"),hiA:_.prop("hiA"),loB:_.prop("loB"),hiB:_.prop("hiB"),loC:_.prop("loC"),hiC:_.prop("hiC"),loD:_.prop("loD"),hiD:_.prop("hiD"),palette:L,contextColor:_.prop("contextColor"),mask:_.prop("maskTexture"),drwLayer:_.prop("drwLayer"),maskHeight:_.prop("maskHeight")},offset:_.prop("offset"),count:_.prop("count")});return{render:l,readPixel:function(e,t){return _.read({x:e,y:t,width:1,height:1,data:P}),P},readPixels:function(e,t,a,o){var r=new Uint8Array(4*a*o);return _.read({x:e,y:t,width:a,height:o,data:r}),r},destroy:d,update:a}}},{"../../lib":657,"./constants":1028,glslify:378}],1033:[function(e,t){'use strict';var a=Math.min;t.exports=function(e,t,o,r){r||(r=1/0);var n,l;for(n=0;n<t.length;n++)l=t[n],l.visible&&(r=a(r,l[o].length));for(r===1/0&&(r=0),e._length=r,n=0;n<t.length;n++)l=t[n],l.visible&&(l._length=r);return r}},{}],1034:[function(e,t){'use strict';var T=Math.abs,A=Math.max,S=Math.floor;function a(e,t,a){return E.aggNums(e,null,t,a)}function o(e,t){return i(a(Math.min,e,t),a(Math.max,e,t))}function r(e){var t=e.range;return t?i(t[0],t[1]):o(e.values,e._length)}function i(e,t){return(isNaN(e)||!isFinite(e))&&(e=0),(isNaN(t)||!isFinite(t))&&(t=0),e===t&&(0===e?(e-=1,t+=1):(e*=.9,t*=1.1)),[e,t]}function n(e,t){return t?function(a,o){var r=t[o];return null===r||void 0===r?e(a):r}:e}function l(e,t,a,o,i){var l=r(a);return o?C.scale.ordinal().domain(o.map(n(C.format(a.tickformat),i))).range(o.map(function(a){var o=(a-l[0])/(l[1]-l[0]);return e-t+o*(2*t-e)})):C.scale.linear().domain(l).range([e-t,t])}function s(e,t){return C.scale.linear().range([t,e-t])}function d(e,t){return C.scale.linear().domain(r(e)).range([t,1-t])}function p(e){if(e.tickvals){var t=r(e);return C.scale.ordinal().domain(e.tickvals).range(e.tickvals.map(function(e){return(e-t[0])/(t[1]-t[0])}))}}function u(e){var t=e.map(function(e){return e[0]}),a=e.map(function(e){var t=v(e[1]);return C.rgb("rgb("+t[0]+","+t[1]+","+t[2]+")")}),o=function(e){return function(t){return t[e]}},r=["r","g","b"].map(function(e){return C.scale.linear().clamp(!0).domain(t).range(a.map(o(e)))});return function(e){return r.map(function(t){return t(e)})}}function g(e){return e.dimensions.some(function(e){return e.brush.filterSpecified})}function m(e,t,a){var o=M(t),i=o.trace,n=B.convertTypedArray(o.lineColor),l=i.line,s={color:v(F.deselectedLineColor)},d=z.extractOpts(l),c=d.reversescale?z.flipScale(o.cscale):o.cscale,p=i.domain,g=i.dimensions,m=e.width,h=i.labelangle,y=i.labelside,f=i.labelfont,x=i.tickfont,_=i.rangefont,b=E.extendDeepNoArrays({},l,{color:n.map(C.scale.linear().domain(r({values:n,range:[d.min,d.max],_length:i._length}))),blockLineCount:F.blockLineCount,canvasOverdrag:F.overdrag*F.canvasPixelRatio}),w=S(m*(p.x[1]-p.x[0])),k=S(e.height*(p.y[1]-p.y[0])),T=e.margin||{l:80,r:80,t:100,b:80},A=w,L=k;return{key:a,colCount:g.filter(B.isVisible).length,dimensions:g,tickDistance:F.tickDistance,unitToColor:u(c),lines:b,deselectedLines:s,labelAngle:h,labelSide:y,labelFont:f,tickFont:x,rangeFont:_,layoutWidth:m,layoutHeight:e.height,domain:p,translateX:p.x[0]*m,translateY:e.height-p.y[1]*e.height,pad:T,canvasWidth:A*F.canvasPixelRatio+2*b.canvasOverdrag,canvasHeight:L*F.canvasPixelRatio,width:A,height:L,canvasPixelRatio:F.canvasPixelRatio}}function h(e,t,a){var o=a.width,r=a.height,i=a.dimensions,n=a.canvasPixelRatio,u=function(e){return o*e/A(1,a.colCount-1)},m=F.verticalPadding/r,h=s(r,F.verticalPadding),y={key:a.key,xScale:u,model:a,inBrushDrag:!1},f={};return y.dimensions=i.filter(B.isVisible).map(function(o,s){function i(e,t){return{val:e,text:I[t]}}function x(e,t){return e.val-t.val}var _=d(o,m),b=f[o.label];f[o.label]=(b||0)+1;var v=o.label+(b?"__"+b:""),w=o.constraintrange,T=w&&w.length;T&&!Array.isArray(w[0])&&(w=[w]);var A=T?w.map(function(e){return e.map(_)}):[[-Infinity,1/0]],S=o.values;S.length>o._length&&(S=S.slice(0,o._length));var L=o.tickvals,I;if(Array.isArray(L)&&L.length){I=o.ticktext,Array.isArray(I)&&I.length?I.length>L.length?I=I.slice(0,L.length):L.length>I.length&&(L=L.slice(0,I.length)):I=L.map(C.format(o.tickformat));for(var P=1;P<L.length;P++)if(L[P]<L[P-1]){for(var z=L.map(i).sort(x),D=0;D<L.length;D++)L[D]=z[D].val,I[D]=z[D].text;break}}else L=void 0;return S=B.convertTypedArray(S),{key:v,label:o.label,tickFormat:o.tickformat,tickvals:L,ticktext:I,ordinal:B.isOrdinal(o),multiselect:o.multiselect,xIndex:s,crossfilterDimensionIndex:s,visibleIndex:o._index,height:r,values:S,paddedUnitValues:S.map(_),unitTickvals:L&&L.map(_),xScale:u,x:u(s),canvasX:u(s)*n,unitToPaddedPx:h,domainScale:l(r,F.verticalPadding,o,L,I),ordinalScale:p(o),parent:y,model:a,brush:c.makeBrush(e,T,A,function(){e.linePickActive(!1)},function(){var t=y;t.focusLayer&&t.focusLayer.render(t.panels,!0);var a=g(t);!e.contextShown()&&a?(t.contextLayer&&t.contextLayer.render(t.panels,!0),e.contextShown(!0)):e.contextShown()&&!a&&(t.contextLayer&&t.contextLayer.render(t.panels,!0,!0),e.contextShown(!1))},function(a){if(y.focusLayer.render(y.panels,!0),y.pickLayer&&y.pickLayer.render(y.panels,!0),e.linePickActive(!0),t&&t.filterChanged){var i=_.invert,n=a.map(function(e){return e.map(i).sort(E.sorterAsc)}).sort(function(e,t){return e[0]-t[0]});t.filterChanged(y.key,o._index,n)}})}}),y}function y(e){e.classed(F.cn.axisExtentText,!0).attr("text-anchor","middle").style("cursor","default").style("user-select","none")}function f(){var e=!0,t=!1;return{linePickActive:function(t){return arguments.length?e=!!t:e},contextShown:function(e){return arguments.length?t=!!e:t}}}function x(e,t){var a="top"===t?1:-1,o=e*Math.PI/180,r=Math.sin(o),i=Math.cos(o);return{dir:a,dx:r,dy:i,degrees:e}}function _(e,t){for(var a=t.panels||(t.panels=[]),o=e.data(),r=0;r<o.length-1;r++){var n=a[r]||(a[r]={}),l=o[r],s=o[r+1];n.dim0=l,n.dim1=s,n.canvasX=l.canvasX,n.panelSizeX=s.canvasX-l.canvasX,n.panelSizeY=t.model.canvasHeight,n.y=0,n.canvasY=0}}function b(e){for(var t=0;t<e.length;t++)for(var a=0;a<e[t].length;a++)for(var r=e[t][a].trace,n=r.dimensions,l=0;l<n.length;l++){var s=n[l].values,d=n[l]._ax;d&&(d.range=d.range?i(d.range[0],d.range[1]):o(s,r._length),!d.dtick&&(d.dtick=.01*(T(d.range[1]-d.range[0])||1)),d.tickformat=n[l].tickformat,L.calcTicks(d),d.cleanRange())}}function w(e,t){return L.tickText(e._ax,t,!1).text}function k(e,t){if(e.ordinal)return"";var a=e.domainScale.domain(),o=a[t?a.length-1:0];return w(e.model.dimensions[e.visibleIndex],o)}var C=e("d3"),v=e("color-rgba"),L=e("../../plots/cartesian/axes"),E=e("../../lib"),I=e("../../lib/svg_text_utils"),P=e("../../components/drawing"),z=e("../../components/colorscale"),D=e("../../lib/gup"),O=D.keyFun,R=D.repeat,M=D.unwrap,B=e("./helpers"),F=e("./constants"),c=e("./axisbrush"),j=e("./lines");t.exports=function(t,e,a,o){var r=t._fullLayout,i=r._toppaper,n=r._glcontainer;b(e);var l=f(),s=e.filter(function(e){return M(e).trace.visible}).map(m.bind(0,a)).map(h.bind(0,l,o));n.each(function(e,t){return E.extendFlat(e,s[t])});var d=n.selectAll(".gl-canvas").each(function(e){e.viewModel=s[0],e.model=e.viewModel?e.viewModel.model:null}),p=null,u=d.filter(function(e){return e.pick});u.style("pointer-events","auto").on("mousemove",function(e){if(l.linePickActive()&&e.lineLayer&&o&&o.hover){var t=C.event,a=this.width,r=this.height,i=C.mouse(this),n=i[0],s=i[1];if(0>n||0>s||n>=a||s>=r)return;var d=e.lineLayer.readPixel(n,r-1-s),c=0!==d[3],u=c?d[2]+256*(d[1]+256*d[0]):null,g={x:n,y:s,clientX:t.clientX,clientY:t.clientY,dataIndex:e.model.key,curveNumber:u};u!==p&&(c?o.hover(g):o.unhover&&o.unhover(g),p=u)}}),d.style("opacity",function(e){return e.pick?0:1}),i.style("background","rgba(255, 255, 255, 0)");var v=i.selectAll("."+F.cn.parcoords).data(s,O);v.exit().remove(),v.enter().append("g").classed(F.cn.parcoords,!0).style("shape-rendering","crispEdges").style("pointer-events","none"),v.attr("transform",function(e){return"translate("+e.model.translateX+","+e.model.translateY+")"});var S=v.selectAll("."+F.cn.parcoordsControlView).data(R,O);S.enter().append("g").classed(F.cn.parcoordsControlView,!0),S.attr("transform",function(e){return"translate("+e.model.pad.l+","+e.model.pad.t+")"});var L=S.selectAll("."+F.cn.yAxis).data(function(e){return e.dimensions},O);L.enter().append("g").classed(F.cn.yAxis,!0),S.each(function(e){_(L,e)}),d.each(function(e){if(e.viewModel){!e.lineLayer||o?e.lineLayer=j(this,e):e.lineLayer.update(e),(e.key||0===e.key)&&(e.viewModel[e.key]=e.lineLayer);var t=!e.context||o;e.lineLayer.render(e.viewModel.panels,t)}}),L.attr("transform",function(e){return"translate("+e.xScale(e.xIndex)+", 0)"}),L.call(C.behavior.drag().origin(function(e){return e}).on("drag",function(t){var a=t.parent;l.linePickActive(!1),t.x=A(-F.overdrag,Math.min(t.model.width+F.overdrag,C.event.x)),t.canvasX=t.x*t.model.canvasPixelRatio,L.sort(function(e,t){return e.x-t.x}).each(function(a,e){a.xIndex=e,a.x=t===a?a.x:a.xScale(a.xIndex),a.canvasX=a.x*a.model.canvasPixelRatio}),_(L,a),L.filter(function(a){return 0!==T(t.xIndex-a.xIndex)}).attr("transform",function(e){return"translate("+e.xScale(e.xIndex)+", 0)"}),C.select(this).attr("transform","translate("+t.x+", 0)"),L.each(function(o,e,r){r===t.parent.key&&(a.dimensions[e]=o)}),a.contextLayer&&a.contextLayer.render(a.panels,!1,!g(a)),a.focusLayer.render&&a.focusLayer.render(a.panels)}).on("dragend",function(e){var t=e.parent;e.x=e.xScale(e.xIndex),e.canvasX=e.x*e.model.canvasPixelRatio,_(L,t),C.select(this).attr("transform",function(e){return"translate("+e.x+", 0)"}),t.contextLayer&&t.contextLayer.render(t.panels,!1,!g(t)),t.focusLayer&&t.focusLayer.render(t.panels),t.pickLayer&&t.pickLayer.render(t.panels,!0),l.linePickActive(!0),o&&o.axesMoved&&o.axesMoved(t.key,t.dimensions.map(function(t){return t.crossfilterDimensionIndex}))})),L.exit().remove();var z=L.selectAll("."+F.cn.axisOverlays).data(R,O);z.enter().append("g").classed(F.cn.axisOverlays,!0),z.selectAll("."+F.cn.axis).remove();var D=z.selectAll("."+F.cn.axis).data(R,O);D.enter().append("g").classed(F.cn.axis,!0),D.each(function(e){var t=e.model.height/e.model.tickDistance,a=e.domainScale,o=a.domain();C.select(this).call(C.svg.axis().orient("left").tickSize(4).outerTickSize(2).ticks(t,e.tickFormat).tickValues(e.ordinal?o:null).tickFormat(function(t){return B.isOrdinal(e)?t:w(e.model.dimensions[e.visibleIndex],t)}).scale(a)),P.font(D.selectAll("text"),e.model.tickFont)}),D.selectAll(".domain, .tick>line").attr("fill","none").attr("stroke","black").attr("stroke-opacity",.25).attr("stroke-width","1px"),D.selectAll("text").style("text-shadow","1px 1px 1px #fff, -1px -1px 1px #fff, 1px -1px 1px #fff, -1px 1px 1px #fff").style("cursor","default").style("user-select","none");var N=z.selectAll("."+F.cn.axisHeading).data(R,O);N.enter().append("g").classed(F.cn.axisHeading,!0);var V=N.selectAll("."+F.cn.axisTitle).data(R,O);V.enter().append("text").classed(F.cn.axisTitle,!0).attr("text-anchor","middle").style("cursor","ew-resize").style("user-select","none").style("pointer-events","auto"),V.text(function(e){return e.label}).each(function(a){var o=C.select(this);P.font(o,a.model.labelFont),I.convertToTspans(o,t)}).attr("transform",function(e){var t=x(e.model.labelAngle,e.model.labelSide),a=F.axisTitleOffset;return(0<t.dir?"":"translate(0,"+(2*a+e.model.height)+")")+"rotate("+t.degrees+")translate("+-a*t.dx+","+-a*t.dy+")"}).attr("text-anchor",function(e){var t=x(e.model.labelAngle,e.model.labelSide),a=T(t.dx),o=T(t.dy);return 2*a>o?0>t.dir*t.dx?"start":"end":"middle"});var U=z.selectAll("."+F.cn.axisExtent).data(R,O);U.enter().append("g").classed(F.cn.axisExtent,!0);var H=U.selectAll("."+F.cn.axisExtentTop).data(R,O);H.enter().append("g").classed(F.cn.axisExtentTop,!0),H.attr("transform","translate(0,"+-F.axisExtentOffset+")");var q=H.selectAll("."+F.cn.axisExtentTopText).data(R,O);q.enter().append("text").classed(F.cn.axisExtentTopText,!0).call(y),q.text(function(e){return k(e,!0)}).each(function(e){P.font(C.select(this),e.model.rangeFont)});var G=U.selectAll("."+F.cn.axisExtentBottom).data(R,O);G.enter().append("g").classed(F.cn.axisExtentBottom,!0),G.attr("transform",function(e){return"translate(0,"+(e.model.height+F.axisExtentOffset)+")"});var Y=G.selectAll("."+F.cn.axisExtentBottomText).data(R,O);Y.enter().append("text").classed(F.cn.axisExtentBottomText,!0).attr("dy","0.75em").call(y),Y.text(function(e){return k(e,!1)}).each(function(e){P.font(C.select(this),e.model.rangeFont)}),c.ensureAxisBrush(z)}},{"../../components/colorscale":536,"../../components/drawing":546,"../../lib":657,"../../lib/gup":655,"../../lib/svg_text_utils":681,"../../plots/cartesian/axes":705,"./axisbrush":1025,"./constants":1028,"./helpers":1030,"./lines":1032,"color-rgba":69,d3:108}],1035:[function(e,t){'use strict';function a(e,t,a){var o=t.indexOf(a),r=e.indexOf(o);return-1===r&&(r+=t.length),r}function o(e,t){return function(o,r){return a(e,t,o)-a(e,t,r)}}var r=e("./parcoords"),i=e("../../lib/prepare_regl"),n=e("./helpers").isVisible;t.exports=function(e,t){var a=e._fullLayout,l=i(e);if(l){var s={},c={},p={},u={},g=a._size;t.forEach(function(t,a){var o=t[0].trace;p[a]=o.index;var r=u[a]=o._fullInput.index;s[a]=e.data[r].dimensions,c[a]=e.data[r].dimensions.slice()});var m=function(t,o,r){var i=c[t][o],n=r.map(function(e){return e.slice()}),l="dimensions["+o+"].constraintrange",s=a._tracePreGUI[e._fullData[p[t]]._fullInput.uid];if(void 0===s[l]){var d=i.constraintrange;s[l]=d||null}var g=e._fullData[p[t]].dimensions[o];n.length?(1===n.length&&(n=n[0]),i.constraintrange=n,g.constraintrange=n.slice(),n=[n]):(delete i.constraintrange,delete g.constraintrange,n=null);var m={};m[l]=n,e.emit("plotly_restyle",[m,[u[t]]])},h=function(t){e.emit("plotly_hover",t)},y=function(t){e.emit("plotly_unhover",t)},f=function(t,a){var r=o(a,c[t].filter(n));s[t].sort(r),c[t].filter(function(e){return!n(e)}).sort(function(e){return c[t].indexOf(e)}).forEach(function(e){s[t].splice(s[t].indexOf(e),1),s[t].splice(c[t].indexOf(e),0,e)}),e.emit("plotly_restyle",[{dimensions:[s[t]]},[u[t]]])};r(e,t,{width:g.w,height:g.h,margin:{t:g.t,r:g.r,b:g.b,l:g.l}},{filterChanged:m,hover:h,unhover:y,axesMoved:f})}}},{"../../lib/prepare_regl":670,"./helpers":1030,"./parcoords":1034}],1036:[function(e,t){'use strict';var a=e("../../plots/attributes"),o=e("../../plots/domain").attributes,r=e("../../plots/font_attributes"),i=e("../../components/color/attributes"),n=e("../../plots/template_attributes").hovertemplateAttrs,l=e("../../plots/template_attributes").texttemplateAttrs,s=e("../../lib/extend").extendFlat,d=r({editType:"plot",arrayOk:!0,colorEditType:"plot"});t.exports={labels:{valType:"data_array",editType:"calc"},label0:{valType:"number",dflt:0,editType:"calc"},dlabel:{valType:"number",dflt:1,editType:"calc"},values:{valType:"data_array",editType:"calc"},marker:{colors:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:i.defaultLine,arrayOk:!0,editType:"style"},width:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"style"},editType:"calc"},editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},scalegroup:{valType:"string",dflt:"",editType:"calc"},textinfo:{valType:"flaglist",flags:["label","text","value","percent"],extras:["none"],editType:"calc"},hoverinfo:s({},a.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:n({},{keys:["label","color","value","percent","text"]}),texttemplate:l({editType:"plot"},{keys:["label","color","value","percent","text"]}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"plot"},textfont:s({},d,{}),insidetextorientation:{valType:"enumerated",values:["horizontal","radial","tangential","auto"],dflt:"auto",editType:"plot"},insidetextfont:s({},d,{}),outsidetextfont:s({},d,{}),automargin:{valType:"boolean",dflt:!1,editType:"plot"},title:{text:{valType:"string",dflt:"",editType:"plot"},font:s({},d,{}),position:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"plot"},editType:"plot"},domain:o({name:"pie",trace:!0,editType:"calc"}),hole:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},sort:{valType:"boolean",dflt:!0,editType:"calc"},direction:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"number",min:-360,max:360,dflt:0,editType:"calc"},pull:{valType:"number",min:0,max:1,dflt:0,arrayOk:!0,editType:"calc"},_deprecated:{title:{valType:"string",dflt:"",editType:"calc"},titlefont:s({},d,{}),titleposition:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"calc"}}}},{"../../components/color/attributes":523,"../../lib/extend":648,"../../plots/attributes":702,"../../plots/domain":732,"../../plots/font_attributes":733,"../../plots/template_attributes":783}],1037:[function(e,t,a){'use strict';var o=e("../../plots/plots");a.name="pie",a.plot=function(e,t,r,i){o.plotBasePlot(a.name,e,t,r,i)},a.clean=function(e,t,r,i){o.cleanBasePlot(a.name,e,t,r,i)}},{"../../plots/plots":768}],1038:[function(e,t){'use strict';function a(e){return function(t,a){return!!t&&(t=n(t),!!t.isValid())&&(t=l.addOpacity(t,t.getAlpha()),e[a]||(e[a]=t),t)}}function o(e,t){var a=JSON.stringify(e),o=t[a],r;if(!o){for(o=e.slice(),r=0;r<e.length;r++)o.push(n(e[r]).lighten(20).toHexString());for(r=0;r<e.length;r++)o.push(n(e[r]).darken(20).toHexString());t[a]=o}return o}var r=e("fast-isnumeric"),n=e("tinycolor2"),l=e("../../components/color"),s={};t.exports={calc:function(e,t){var o=[],n=e._fullLayout,l=n.hiddenlabels||[],s=t.labels,d=t.marker.colors||[],c=t.values,p=t._length,u=t._hasValues&&p,g,m;if(t.dlabel)for(s=Array(p),g=0;g<p;g++)s[g]=t.label0+g*t.dlabel+"";var h={},y=a(n["_"+t.type+"colormap"]),f=0,x=!1;for(g=0;g<p;g++){var _,b,w;if(u){if(_=c[g],!r(_))continue;if(_=+_,0>_)continue}else _=1;b=s[g],(void 0===b||""===b)&&(b=g),b+="";var k=h[b];void 0===k?(h[b]=o.length,w=-1!==l.indexOf(b),!w&&(f+=_),o.push({v:_,label:b,color:y(d[g],b),i:g,pts:[g],hidden:w})):(x=!0,m=o[k],m.v+=_,m.pts.push(g),!m.hidden&&(f+=_),!1===m.color&&d[g]&&(m.color=y(d[g],b)))}var T="funnelarea"===t.type?x:t.sort;return T&&o.sort(function(e,t){return t.v-e.v}),o[0]&&(o[0].vTotal=f),o},crossTraceCalc:function(e,t){var a=(t||{}).type;a||(a="pie");var r=e._fullLayout,n=e.calcdata,l=r[a+"colorway"],d=r["_"+a+"colormap"];r["extend"+a+"colors"]&&(l=o(l,s));for(var c=0,p=0;p<n.length;p++){var u=n[p],g=u[0].trace.type;if(g===a)for(var m=0,h;m<u.length;m++)h=u[m],!1===h.color&&(d[h.label]?h.color=d[h.label]:(d[h.label]=h.color=l[c%l.length],c++))}},makePullColorFn:a,generateExtendedColors:o}},{"../../components/color":524,"fast-isnumeric":201,tinycolor2:1309}],1039:[function(e,t){'use strict';var o=Math.min;function a(e,t){var a=Array.isArray(e),l=n.isArrayOrTypedArray(t),s=o(a?e.length:1/0,l?t.length:1/0);if(isFinite(s)||(s=0),s&&l){for(var d=0,c,p;d<s;d++)if(p=t[d],r(p)&&0<p){c=!0;break}c||(s=0)}return{hasLabels:a,hasValues:l,len:s}}var r=e("fast-isnumeric"),n=e("../../lib"),l=e("./attributes"),s=e("../../plots/domain").defaults,d=e("../bar/defaults").handleText;t.exports={handleLabelsAndValues:a,supplyDefaults:function(e,t,o,r){function i(a,o){return n.coerce(e,t,l,a,o)}var c=i("labels"),p=i("values"),u=a(c,p),g=u.len;if(t._hasLabels=u.hasLabels,t._hasValues=u.hasValues,!t._hasLabels&&t._hasValues&&(i("label0"),i("dlabel")),!g)return void(t.visible=!1);t._length=g;var m=i("marker.line.width");m&&i("marker.line.color"),i("marker.colors"),i("scalegroup");var h=i("text"),y=i("texttemplate"),f;if(y||(f=i("textinfo",Array.isArray(h)?"text+percent":"percent")),i("hovertext"),i("hovertemplate"),y||f&&"none"!==f){var x=i("textposition");d(e,t,r,i,x,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1});var _=Array.isArray(x)||"auto"===x;(_||"outside"===x)&&i("automargin"),("inside"===x||"auto"===x||Array.isArray(x))&&i("insidetextorientation")}s(t,r,i);var b=i("hole"),v=i("title.text");if(v){var w=i("title.position",b?"middle center":"top center");b||"middle center"!==w||(t.title.position="top center"),n.coerceFont(i,"title.font",r.font)}i("sort"),i("direction"),i("rotation"),i("pull")}}},{"../../lib":657,"../../plots/domain":732,"../bar/defaults":802,"./attributes":1036,"fast-isnumeric":201}],1040:[function(e,t){'use strict';var a=e("../../components/fx/helpers").appendArrayMultiPointValues;t.exports=function(e,t){var o={curveNumber:t.index,pointNumbers:e.pts,data:t._input,fullData:t,label:e.label,color:e.color,value:e.v,percent:e.percent,text:e.text,v:e.v};return 1===e.pts.length&&(o.pointNumber=o.i=e.pts[0]),a(o,t,e.pts),"funnelarea"===t.type&&(delete o.v,delete o.i),o}},{"../../components/fx/helpers":560}],1041:[function(e,t,a){'use strict';var o=e("../../lib");a.formatPiePercent=function(e,t){var a=(100*e).toPrecision(3);return-1!==a.lastIndexOf(".")&&(a=a.replace(/[.]?0+$/,"")),o.numSeparate(a,t)+"%"},a.formatPieValue=function(e,t){var a=e.toPrecision(10);return-1!==a.lastIndexOf(".")&&(a=a.replace(/[.]?0+$/,"")),o.numSeparate(a,t)},a.getFirstFilled=function(e,t){if(Array.isArray(e))for(var a=0,o;a<t.length;a++)if(o=e[t[a]],o||0===o||""===o)return o},a.castOption=function(e,t){if(Array.isArray(e))return a.getFirstFilled(e,t);return e?e:void 0}},{"../../lib":657}],1042:[function(e,t){'use strict';t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults").supplyDefaults,supplyLayoutDefaults:e("./layout_defaults"),layoutAttributes:e("./layout_attributes"),calc:e("./calc").calc,crossTraceCalc:e("./calc").crossTraceCalc,plot:e("./plot").plot,style:e("./style"),styleOne:e("./style_one"),moduleType:"trace",name:"pie",basePlotModule:e("./base_plot"),categories:["pie-like","pie","showLegend"],meta:{}}},{"./attributes":1036,"./base_plot":1037,"./calc":1038,"./defaults":1039,"./layout_attributes":1043,"./layout_defaults":1044,"./plot":1045,"./style":1046,"./style_one":1047}],1043:[function(e,t){'use strict';t.exports={hiddenlabels:{valType:"data_array",editType:"calc"},piecolorway:{valType:"colorlist",editType:"calc"},extendpiecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1044:[function(e,t){'use strict';var a=e("../../lib"),o=e("./layout_attributes");t.exports=function(e,t){function r(r,i){return a.coerce(e,t,o,r,i)}r("hiddenlabels"),r("piecolorway",t.colorway),r("extendpiecolors")}},{"../../lib":657,"./layout_attributes":1043}],1045:[function(e,t){'use strict';var E=Math.cos,I=Math.sqrt,P=Math.PI,z=Math.sin,D=Math.min,O=Math.abs,R=Math.max;function a(e,t){e.each(function(e){var a=M.select(this);if(!e.labelExtraX&&!e.labelExtraY)return void a.select("path.textline").remove();var o=a.select("g.slicetext text");e.transform.targetX+=e.labelExtraX,e.transform.targetY+=e.labelExtraY,o.attr("transform",N.getTextTransform(e.transform));var r=e.cxFinal+e.pxmid[0],i=e.cyFinal+e.pxmid[1],n="M"+r+","+i,l=(e.yLabelMax-e.yLabelMin)*(0>e.pxmid[0]?-1:1)/4;if(e.labelExtraX){var s=e.labelExtraX*e.pxmid[1]/e.pxmid[0],d=e.yLabelMid+e.labelExtraY-(e.cyFinal+e.pxmid[1]);n+=O(s)>O(d)?"l"+d*e.pxmid[0]/e.pxmid[1]+","+d+"H"+(r+e.labelExtraX+l):"l"+e.labelExtraX+","+s+"v"+(d-s)+"h"+l}else n+="V"+(e.yLabelMid+e.labelExtraY)+"h"+l;N.ensureSingle(a,"path","textline").call(B.stroke,t.outsidetextfont.color).attr({"stroke-width":D(2,t.outsidetextfont.size/8),d:n,fill:"none"})})}function o(e,t,a){var o=a[0],r=o.trace,i=o.cx,n=o.cy;"_hasHoverLabel"in r||(r._hasHoverLabel=!1),"_hasHoverEvent"in r||(r._hasHoverEvent=!1),e.on("mouseover",function(e){var a=t._fullLayout,l=t._fullData[r.index];if(!(t._dragging||!1===a.hovermode)){var s=l.hoverinfo;if(Array.isArray(s)&&(s=j.castHoverinfo({hoverinfo:[Y.castOption(s,e.pts)],_module:r._module},a,0)),"all"===s&&(s="label+text+value+percent+name"),l.hovertemplate||"none"!==s&&"skip"!==s&&s){var d=e.rInscribed||0,c=i+e.pxmid[0]*(1-d),p=n+e.pxmid[1]*(1-d),u=a.separators,g=[];if(s&&-1!==s.indexOf("label")&&g.push(e.label),e.text=Y.castOption(l.hovertext||l.text,e.pts),s&&-1!==s.indexOf("text")){var m=e.text;N.isValidTextValue(m)&&g.push(m)}e.value=e.v,e.valueLabel=Y.formatPieValue(e.v,u),s&&-1!==s.indexOf("value")&&g.push(e.valueLabel),e.percent=e.v/o.vTotal,e.percentLabel=Y.formatPiePercent(e.percent,u),s&&-1!==s.indexOf("percent")&&g.push(e.percentLabel);var h=l.hoverlabel,y=h.font;j.loneHover({trace:r,x0:c-d*o.r,x1:c+d*o.r,y:p,text:g.join("<br>"),name:l.hovertemplate||-1!==s.indexOf("name")?l.name:void 0,idealAlign:0>e.pxmid[0]?"left":"right",color:Y.castOption(h.bgcolor,e.pts)||e.color,borderColor:Y.castOption(h.bordercolor,e.pts),fontFamily:Y.castOption(y.family,e.pts),fontSize:Y.castOption(y.size,e.pts),fontColor:Y.castOption(y.color,e.pts),nameLength:Y.castOption(h.namelength,e.pts),textAlign:Y.castOption(h.align,e.pts),hovertemplate:Y.castOption(l.hovertemplate,e.pts),hovertemplateLabels:e,eventData:[W(e,l)]},{container:a._hoverlayer.node(),outerContainer:a._paper.node(),gd:t}),r._hasHoverLabel=!0}r._hasHoverEvent=!0,t.emit("plotly_hover",{points:[W(e,l)],event:M.event})}}),e.on("mouseout",function(e){var a=t._fullLayout,o=t._fullData[r.index],i=M.select(this).datum();r._hasHoverEvent&&(e.originalEvent=M.event,t.emit("plotly_unhover",{points:[W(i,o)],event:M.event}),r._hasHoverEvent=!1),r._hasHoverLabel&&(j.loneUnhover(a._hoverlayer.node()),r._hasHoverLabel=!1)}),e.on("click",function(e){var a=t._fullLayout,o=t._fullData[r.index];t._dragging||!1===a.hovermode||(t._hoverdata=[W(e,o)],j.click(t,M.event))})}function r(e,t,a){var o=Y.castOption(e.outsidetextfont.color,t.pts)||Y.castOption(e.textfont.color,t.pts)||a.color,r=Y.castOption(e.outsidetextfont.family,t.pts)||Y.castOption(e.textfont.family,t.pts)||a.family,i=Y.castOption(e.outsidetextfont.size,t.pts)||Y.castOption(e.textfont.size,t.pts)||a.size;return{color:o,family:r,size:i}}function n(e,t,a){var o=Y.castOption(e.insidetextfont.color,t.pts);!o&&e._input.textfont&&(o=Y.castOption(e._input.textfont.color,t.pts));var r=Y.castOption(e.insidetextfont.family,t.pts)||Y.castOption(e.textfont.family,t.pts)||a.family,i=Y.castOption(e.insidetextfont.size,t.pts)||Y.castOption(e.textfont.size,t.pts)||a.size;return{color:o||B.contrast(t.color),family:r,size:i}}function l(e,t){for(var a=0,o,r;a<e.length;a++)if(o=e[a][0],r=o.trace,r.title.text){var n=r.title.text;r._meta&&(n=N.templateString(n,r._meta));var l=F.tester.append("text").attr("data-notex",1).text(n).call(F.font,r.title.font).call(V.convertToTspans,t),s=F.bBox(l.node(),!0);o.titleBox={width:s.width,height:s.height},l.remove()}}function s(e,t,a){var o=a.r||t.rpx1,r=t.rInscribed,n=t.startangle===t.stopangle;if(n)return{rCenter:1-r,scale:0,rotate:0,textPosAngle:0};var l=t.ring,u=1===l&&O(t.startangle-t.stopangle)===2*P,g=t.halfangle,m=t.midangle,h=a.trace.insidetextorientation,y="horizontal"===h,f="tangential"===h,x="radial"===h,_="auto"===h,b=[],v;if(!_){var w=function(a,r){if(d(t,a)){var i=O(a-t.startangle),n=O(a-t.stopangle),s=i<n?i:n;v="tan"===r?p(e,o,l,s,0):c(e,o,l,s,P/2),v.textPosAngle=a,b.push(v)}},T;if(y||f){for(T=4;-4<=T;T-=2)w(P*T,"tan");for(T=4;-4<=T;T-=2)w(P*(T+1),"tan")}if(y||x){for(T=4;-4<=T;T-=2)w(P*(T+1.5),"rad");for(T=4;-4<=T;T-=2)w(P*(T+.5),"rad")}}if(u||_||y){var A=I(e.width*e.width+e.height*e.height);if(v={scale:2*(r*o)/A,rCenter:1-r,rotate:0},v.textPosAngle=(t.startangle+t.stopangle)/2,1<=v.scale)return v;b.push(v)}(_||x)&&(v=c(e,o,l,g,m),v.textPosAngle=(t.startangle+t.stopangle)/2,b.push(v)),(_||f)&&(v=p(e,o,l,g,m),v.textPosAngle=(t.startangle+t.stopangle)/2,b.push(v));for(var S=0,C=0,L=0,E;L<b.length&&(E=b[L].scale,C<E&&(C=E,S=L),_||!(1<=C));L++);return b[S]}function d(e,t){var a=e.startangle,o=e.stopangle;return a>t&&t>o||a<t&&t<o}function c(e,t,o,i,n){t=R(0,t-2*G);var l=e.width/e.height,a=m(l,i,t,o);return{scale:2*a/e.height,rCenter:u(l,a/t),rotate:g(n)}}function p(e,t,o,i,n){t=R(0,t-2*G);var l=e.height/e.width,a=m(l,i,t,o);return{scale:2*a/e.width,rCenter:u(l,a/t),rotate:g(n+P/2)}}function u(e,t){return E(t)-e*t}function g(e){return(180/P*e+720)%180-90}function m(e,t,a,o){var r=e+1/(2*Math.tan(t));return a*D(1/(I(r*r+.5)+r),o/(I(e*e+o/2)+e))}function h(e,t){return e.v!==t.vTotal||t.trace.hole?D(1/(1+1/z(e.halfangle)),e.ring/2):1}function y(e,t){var a=t.pxmid[0],o=t.pxmid[1],r=e.width/2,i=e.height/2;return 0>a&&(r*=-1),0>o&&(i*=-1),{scale:1,rCenter:1,rotate:0,x:r+O(i)*(0<r?1:-1)/2,y:i/(1+a*a/(o*o)),outside:!0}}function f(e){var t=I(e.titleBox.width*e.titleBox.width+e.titleBox.height*e.titleBox.height);return{x:e.cx,y:e.cy,scale:2*(e.trace.hole*e.r)/t,tx:0,ty:-e.titleBox.height/2+e.trace.title.font.size}}function x(e,t){var a=1,o=1,r=e.trace,i={x:e.cx,y:e.cy},n={tx:0,ty:0},l;n.ty+=r.title.font.size,l=v(r),-1===r.title.position.indexOf("top")?-1!==r.title.position.indexOf("bottom")&&(i.y+=(1+l)*e.r):(i.y-=(1+l)*e.r,n.ty-=e.titleBox.height);var s=_(e.r,e.trace.aspectratio),d=t.w*(r.domain.x[1]-r.domain.x[0])/2;return-1===r.title.position.indexOf("left")?-1===r.title.position.indexOf("center")?-1!==r.title.position.indexOf("right")&&(d+=s,i.x+=(1+l)*s,n.tx-=e.titleBox.width/2):d*=2:(d+=s,i.x-=(1+l)*s,n.tx+=e.titleBox.width/2),a=d/e.titleBox.width,o=b(e,t)/e.titleBox.height,{x:i.x,y:i.y,scale:D(a,o),tx:n.tx,ty:n.ty}}function _(e,t){return e/(t===void 0?1:t)}function b(e,t){var a=e.trace,o=t.h*(a.domain.y[1]-a.domain.y[0]);return D(e.titleBox.height,o/2)}function v(e){var t=e.pull;if(!t)return 0;var a;if(Array.isArray(t))for(t=0,a=0;a<e.pull.length;a++)e.pull[a]>t&&(t=e.pull[a]);return t}function w(e,t){function a(e,t){return e.pxmid[1]-t.pxmid[1]}function o(e,t){return t.pxmid[1]-e.pxmid[1]}function r(e,a){a||(a={});var o=a.labelExtraY+(l?a.yLabelMax:a.yLabelMin),r=l?e.yLabelMin:e.yLabelMax,n=l?e.yLabelMax:e.yLabelMin,s=e.cyFinal+c(e.px0[1],e.px1[1]),g=o-r,m,y,f,x,_,b;if(0<g*u&&(e.labelExtraY=g),!!Array.isArray(t.pull))for(y=0;y<h.length;y++)(f=h[y],!(f===e||(Y.castOption(t.pull,e.pts)||0)>=(Y.castOption(t.pull,f.pts)||0)))&&(0<(e.pxmid[1]-f.pxmid[1])*u?(x=f.cyFinal+c(f.px0[1],f.px1[1]),g=x-r-e.labelExtraY,0<g*u&&(e.labelExtraY+=g)):0<(n+e.labelExtraY-s)*u&&(m=3*p*O(y-h.indexOf(e)),_=f.cxFinal+d(f.px0[0],f.px1[0]),b=_+m-(e.cxFinal+e.pxmid[0])-e.labelExtraX,0<b*p&&(e.labelExtraX+=b)))}var n,l,s,d,c,p,u,g,m,h,y,f,x;for(l=0;2>l;l++)for(s=l?a:o,c=l?R:D,u=l?1:-1,n=0;2>n;n++){for(d=n?R:D,p=n?1:-1,g=e[l][n],g.sort(s),m=e[1-l][n],h=m.concat(g),f=[],y=0;y<g.length;y++)void 0!==g[y].yLabelMid&&f.push(g[y]);for(x=!1,y=0;l&&y<m.length;y++)if(void 0!==m[y].yLabelMid){x=m[y];break}for(y=0;y<f.length;y++){var _=y&&f[y-1];x&&!y&&(_=x),r(f[y],_)}}}function k(e,t){for(var a=[],o=0;o<e.length;o++){var r=e[o][0],n=r.trace,l=n.domain,s=t.w*(l.x[1]-l.x[0]),d=t.h*(l.y[1]-l.y[0]);n.title.text&&"middle center"!==n.title.position&&(d-=b(r,t));var c=d/2;"funnelarea"!==n.type||n.scalegroup||(c/=n.aspectratio),r.r=D(s/2,c)/(1+v(n)),r.cx=t.l+t.w*(n.domain.x[1]+n.domain.x[0])/2,r.cy=t.t+t.h*(1-n.domain.y[0])-d/2,n.title.text&&-1!==n.title.position.indexOf("bottom")&&(r.cy-=b(r,t)),n.scalegroup&&-1===a.indexOf(n.scalegroup)&&a.push(n.scalegroup)}T(e,a)}function T(e,t){for(var a=0,o,r,n;a<t.length;a++){var l=1/0,s=t[a];for(r=0;r<e.length;r++)if(o=e[r][0],n=o.trace,n.scalegroup===s){var d;if("pie"===n.type)d=o.r*o.r;else if("funnelarea"===n.type){var c,p;1<n.aspectratio?(c=o.r,p=c/n.aspectratio):(p=o.r,c=p*n.aspectratio),c*=(1+n.baseratio)/2,d=c*p}l=D(l,d/o.vTotal)}for(r=0;r<e.length;r++)if(o=e[r][0],n=o.trace,n.scalegroup===s){var u=l*o.vTotal;"funnelarea"===n.type&&(u/=(1+n.baseratio)/2,u/=n.aspectratio),o.r=I(u)}}}function A(e){var t=e[0],a=t.r,o=t.trace,r=o.rotation*P/180,n=2*P/t.vTotal,l="px0",s="px1",d,c,p;if("counterclockwise"===o.direction){for(d=0;d<e.length&&!!e[d].hidden;d++);if(d===e.length)return;r+=n*e[d].v,n*=-1,l="px1",s="px0"}for(p=S(a,r),d=0;d<e.length;d++)c=e[d],c.hidden||(c[l]=p,c.startangle=r,r+=n*c.v/2,c.pxmid=S(a,r),c.midangle=r,r+=n*c.v/2,p=S(a,r),c.stopangle=r,c[s]=p,c.largeArc=c.v>t.vTotal/2?1:0,c.halfangle=P*D(c.v/t.vTotal,.5),c.ring=1-o.hole,c.rInscribed=h(c,t))}function S(e,t){return[e*z(t),-e*E(t)]}function C(e,t,a){function o(e){return{label:e.label,value:e.v,valueLabel:Y.formatPieValue(e.v,r.separators),percent:e.v/a.vTotal,percentLabel:Y.formatPiePercent(e.v/a.vTotal,r.separators),color:e.color,text:e.text,customdata:N.castOption(i,e.i,"customdata")}}var r=e._fullLayout,i=a.trace,n=i.texttemplate,l=i.textinfo;if(!n&&l&&"none"!==l){var s=l.split("+"),d=function(e){return-1!==s.indexOf(e)},c=d("label"),p=d("text"),u=d("value"),g=d("percent"),m=r.separators,h;if(h=c?[t.label]:[],p){var y=Y.getFirstFilled(i.text,t.pts);X(y)&&h.push(y)}u&&h.push(Y.formatPieValue(t.v,m)),g&&h.push(Y.formatPiePercent(t.v/a.vTotal,m)),t.text=h.join("<br>")}if(n){var f=N.castOption(i,t.i,"texttemplate");if(!f)t.text="";else{var x=o(t),_=Y.getFirstFilled(i.text,t.pts);(X(_)||""===_)&&(x.text=_),t.text=N.texttemplateString(f,x,e._fullLayout._d3locale,x,i._meta||{})}}}function L(e,t){var o=e.rotate*P/180,a=E(o),r=z(o),i=(t.left+t.right)/2,n=(t.top+t.bottom)/2;e.textX=i*a-n*r,e.textY=i*r+n*a,e.noCenter=!0}var M=e("d3"),i=e("../../plots/plots"),j=e("../../components/fx"),B=e("../../components/color"),F=e("../../components/drawing"),N=e("../../lib"),V=e("../../lib/svg_text_utils"),U=e("../bar/uniform_text"),H=U.recordMinTextSize,q=U.clearMinTextSize,G=e("../bar/constants").TEXTPAD,Y=e("./helpers"),W=e("./event_data"),X=e("../../lib").isValidTextValue;t.exports={plot:function(e,t){var d=e._fullLayout,c=d._size;q("pie",d),l(t,e),k(t,c);var p=N.makeTraceGroups(d._pielayer,t,"trace").each(function(t){var l=M.select(this),p=t[0],u=p.trace;A(t),l.attr("stroke-linejoin","round"),l.each(function(){var g=M.select(this).selectAll("g.slice").data(t);g.enter().append("g").classed("slice",!0),g.exit().remove();var m=[[[],[]],[[],[]]],h=!1;g.each(function(a,l){function i(e,t,o,r){var i=r*(t[0]-e[0]),n=r*(t[1]-e[1]);return"a"+r*p.r+","+r*p.r+" 0 "+a.largeArc+(o?" 1 ":" 0 ")+i+","+n}if(a.hidden)return void M.select(this).selectAll("path,g").remove();a.pointNumber=a.i,a.curveNumber=u.index,m[0>a.pxmid[1]?0:1][0>a.pxmid[0]?0:1].push(a);var c=p.cx,g=p.cy,f=M.select(this),x=f.selectAll("path.surface").data([a]);if(x.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),f.call(o,e,t),u.pull){var _=+Y.castOption(u.pull,a.pts)||0;0<_&&(c+=_*a.pxmid[0],g+=_*a.pxmid[1])}a.cxFinal=c,a.cyFinal=g;var b=u.hole;if(a.v===p.vTotal){var v="M"+(c+a.px0[0])+","+(g+a.px0[1])+i(a.px0,a.pxmid,!0,1)+i(a.pxmid,a.px0,!0,1)+"Z";b?x.attr("d","M"+(c+b*a.px0[0])+","+(g+b*a.px0[1])+i(a.px0,a.pxmid,!1,b)+i(a.pxmid,a.px0,!1,b)+"Z"+v):x.attr("d",v)}else{var w=i(a.px0,a.px1,!0,1);if(b){var k=1-b;x.attr("d","M"+(c+b*a.px1[0])+","+(g+b*a.px1[1])+i(a.px1,a.px0,!1,b)+"l"+k*a.px0[0]+","+k*a.px0[1]+w+"Z")}else x.attr("d","M"+c+","+g+"l"+a.px0[0]+","+a.px0[1]+w+"Z")}C(e,a,p);var T=Y.castOption(u.textposition,a.pts),A=f.selectAll("g.slicetext").data(a.text&&"none"!==T?[0]:[]);A.enter().append("g").classed("slicetext",!0),A.exit().remove(),A.each(function(){var o=N.ensureSingle(M.select(this),"text","",function(e){e.attr("data-notex",1)}),i=N.ensureUniformFontSize(e,"outside"===T?r(u,a,d.font):n(u,a,d.font));o.text(a.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(F.font,i).call(V.convertToTspans,e);var m=F.bBox(o.node()),f;if("outside"===T)f=y(m,a);else if(f=s(m,a,p),"auto"===T&&1>f.scale){var x=N.ensureUniformFontSize(e,u.outsidetextfont);o.call(F.font,x),m=F.bBox(o.node()),f=y(m,a)}var _=f.textPosAngle,b=void 0===_?a.pxmid:S(p.r,_);if(f.targetX=c+b[0]*f.rCenter+(f.x||0),f.targetY=g+b[1]*f.rCenter+(f.y||0),L(f,m),f.outside){var v=f.targetY;a.yLabelMin=v-m.height/2,a.yLabelMid=v,a.yLabelMax=v+m.height/2,a.labelExtraX=0,a.labelExtraY=0,h=!0}f.fontSize=i.size,H(u.type,f,d),t[l].transform=f,o.attr("transform",N.getTextTransform(f))})});var _=M.select(this).selectAll("g.titletext").data(u.title.text?[0]:[]);if(_.enter().append("g").classed("titletext",!0),_.exit().remove(),_.each(function(){var t=N.ensureSingle(M.select(this),"text","",function(e){e.attr("data-notex",1)}),a=u.title.text;u._meta&&(a=N.templateString(a,u._meta)),t.text(a).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(F.font,u.title.font).call(V.convertToTspans,e);var o;o="middle center"===u.title.position?f(p):x(p,c),t.attr("transform","translate("+o.x+","+o.y+")"+(1>o.scale?"scale("+o.scale+")":"")+"translate("+o.tx+","+o.ty+")")}),h&&w(m,u),a(g,u),h&&u.automargin){var b=F.bBox(l.node()),v=u.domain,k=c.w*(v.x[1]-v.x[0]),T=c.h*(v.y[1]-v.y[0]),A=(.5*k-p.r)/c.w,E=(.5*T-p.r)/c.h;i.autoMargin(e,"pie."+u.uid+".automargin",{xl:v.x[0]-A,xr:v.x[1]+A,yb:v.y[0]-E,yt:v.y[1]+E,l:R(p.cx-p.r-b.left,0),r:R(b.right-(p.cx+p.r),0),b:R(b.bottom-(p.cy+p.r),0),t:R(p.cy-p.r-b.top,0),pad:5})}})});setTimeout(function(){p.selectAll("tspan").each(function(){var e=M.select(this);e.attr("dy")&&e.attr("dy",e.attr("dy"))})},0)},formatSliceLabel:C,transformInsideText:s,determineInsideTextFont:n,positionTitleOutside:x,prerenderTitles:l,layoutAreas:k,attachFxHandlers:o,computeTransform:L}},{"../../components/color":524,"../../components/drawing":546,"../../components/fx":564,"../../lib":657,"../../lib/svg_text_utils":681,"../../plots/plots":768,"../bar/constants":800,"../bar/uniform_text":814,"./event_data":1040,"./helpers":1041,d3:108}],1046:[function(e,t){'use strict';var a=e("d3"),o=e("./style_one"),r=e("../bar/uniform_text").resizeText;t.exports=function(e){var t=e._fullLayout._pielayer.selectAll(".trace");r(e,t,"pie"),t.each(function(e){var t=e[0],r=t.trace,i=a.select(this);i.style({opacity:r.opacity}),i.selectAll("path.surface").each(function(e){a.select(this).call(o,e,r)})})}},{"../bar/uniform_text":814,"./style_one":1047,d3:108}],1047:[function(e,t){'use strict';var a=e("../../components/color"),o=e("./helpers").castOption;t.exports=function(e,t,r){var i=r.marker.line,n=o(i.color,t.pts)||a.defaultLine,l=o(i.width,t.pts)||0;e.style("stroke-width",l).call(a.fill,t.color).call(a.stroke,n)}},{"../../components/color":524,"./helpers":1041}],1048:[function(e,t){'use strict';var a=e("../scatter/attributes");t.exports={x:a.x,y:a.y,xy:{valType:"data_array",editType:"calc"},indices:{valType:"data_array",editType:"calc"},xbounds:{valType:"data_array",editType:"calc"},ybounds:{valType:"data_array",editType:"calc"},text:a.text,marker:{color:{valType:"color",arrayOk:!1,editType:"calc"},opacity:{valType:"number",min:0,max:1,dflt:1,arrayOk:!1,editType:"calc"},blend:{valType:"boolean",dflt:null,editType:"calc"},sizemin:{valType:"number",min:.1,max:2,dflt:.5,editType:"calc"},sizemax:{valType:"number",min:.1,dflt:20,editType:"calc"},border:{color:{valType:"color",arrayOk:!1,editType:"calc"},arearatio:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},editType:"calc"},editType:"calc"},transforms:void 0}},{"../scatter/attributes":1062}],1049:[function(e,t){'use strict';function a(e,t){this.scene=e,this.uid=t,this.type="pointcloud",this.pickXData=[],this.pickYData=[],this.xData=[],this.yData=[],this.textLabels=[],this.color="rgb(0, 0, 0)",this.name="",this.hoverinfo="all",this.idToIndex=new Int32Array(0),this.bounds=[0,0,0,0],this.pointcloudOptions={positions:new Float32Array(0),idToIndex:this.idToIndex,sizemin:.5,sizemax:12,color:[0,0,0,1],areaRatio:1,borderColor:[0,0,0,1]},this.pointcloud=o(e.glplot,this.pointcloudOptions),this.pointcloud._trace=this}var o=e("gl-pointcloud2d"),r=e("../../lib/str2rgbarray"),n=e("../../plots/cartesian/autorange").findExtremes,l=e("../scatter/get_trace_color"),s=a.prototype;s.handlePick=function(e){var t=this.idToIndex[e.pointId];return{trace:this,dataCoord:e.dataCoord,traceCoord:this.pickXYData?[this.pickXYData[2*t],this.pickXYData[2*t+1]]:[this.pickXData[t],this.pickYData[t]],textLabel:Array.isArray(this.textLabels)?this.textLabels[t]:this.textLabels,color:this.color,name:this.name,pointIndex:t,hoverinfo:this.hoverinfo}},s.update=function(e){this.index=e.index,this.textLabels=e.text,this.name=e.name,this.hoverinfo=e.hoverinfo,this.bounds=[1/0,1/0,-Infinity,-Infinity],this.updateFast(e),this.color=l(e,{})},s.updateFast=function(e){var t=this.xData=this.pickXData=e.x,a=this.yData=this.pickYData=e.y,o=this.pickXYData=e.xy,l=e.xbounds&&e.ybounds,s=e.indices,d=this.bounds,c,p,u,g,m,h;if(o){if(u=o,c=o.length>>>1,l)d[0]=e.xbounds[0],d[2]=e.xbounds[1],d[1]=e.ybounds[0],d[3]=e.ybounds[1];else for(h=0;h<c;h++)g=u[2*h],m=u[2*h+1],g<d[0]&&(d[0]=g),g>d[2]&&(d[2]=g),m<d[1]&&(d[1]=m),m>d[3]&&(d[3]=m);if(s)p=s;else for(p=new Int32Array(c),h=0;h<c;h++)p[h]=h}else for(c=t.length,u=new Float32Array(2*c),p=new Int32Array(c),h=0;h<c;h++)g=t[h],m=a[h],p[h]=h,u[2*h]=g,u[2*h+1]=m,g<d[0]&&(d[0]=g),g>d[2]&&(d[2]=g),m<d[1]&&(d[1]=m),m>d[3]&&(d[3]=m);this.idToIndex=p,this.pointcloudOptions.idToIndex=p,this.pointcloudOptions.positions=u;var y=r(e.marker.color),f=r(e.marker.border.color),x=e.opacity*e.marker.opacity;y[3]*=x,this.pointcloudOptions.color=y;var _=e.marker.blend;if(null===_){_=t.length<100||a.length<100}this.pointcloudOptions.blend=_,f[3]*=x,this.pointcloudOptions.borderColor=f;var b=e.marker.sizemin,v=Math.max(e.marker.sizemax,e.marker.sizemin);this.pointcloudOptions.sizeMin=b,this.pointcloudOptions.sizeMax=v,this.pointcloudOptions.areaRatio=e.marker.border.arearatio,this.pointcloud.update(this.pointcloudOptions);var w=this.scene.xaxis,k=this.scene.yaxis,T=v/2||.5;e._extremes[w._id]=n(w,[d[0],d[2]],{ppad:T}),e._extremes[k._id]=n(k,[d[1],d[3]],{ppad:T})},s.dispose=function(){this.pointcloud.dispose()},t.exports=function(e,t){var o=new a(e,t.uid);return o.update(t),o}},{"../../lib/str2rgbarray":680,"../../plots/cartesian/autorange":704,"../scatter/get_trace_color":1072,"gl-pointcloud2d":268}],1050:[function(e,t){'use strict';var a=e("../../lib"),o=e("./attributes");t.exports=function(e,t,r){function i(r,i){return a.coerce(e,t,o,r,i)}i("x"),i("y"),i("xbounds"),i("ybounds"),e.xy&&e.xy instanceof Float32Array&&(t.xy=e.xy),e.indices&&e.indices instanceof Int32Array&&(t.indices=e.indices),i("text"),i("marker.color",r),i("marker.opacity"),i("marker.blend"),i("marker.sizemin"),i("marker.sizemax"),i("marker.border.color",r),i("marker.border.arearatio"),t._length=null}},{"../../lib":657,"./attributes":1048}],1051:[function(e,t){'use strict';t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("../scatter3d/calc"),plot:e("./convert"),moduleType:"trace",name:"pointcloud",basePlotModule:e("../../plots/gl2d"),categories:["gl","gl2d","showLegend"],meta:{}}},{"../../plots/gl2d":745,"../scatter3d/calc":1090,"./attributes":1048,"./convert":1049,"./defaults":1050}],1052:[function(e,t){'use strict';var a=e("../../plots/font_attributes"),o=e("../../plots/attributes"),r=e("../../components/color/attributes"),i=e("../../components/fx/attributes"),n=e("../../plots/domain").attributes,l=e("../../plots/template_attributes").hovertemplateAttrs,s=e("../../components/colorscale/attributes"),d=e("../../plot_api/plot_template").templatedArray,c=e("../../lib/extend").extendFlat,p=e("../../plot_api/edit_types").overrideAll,u=e("../../constants/docs").FORMAT_LINK,g=t.exports=p({hoverinfo:c({},o.hoverinfo,{flags:[],arrayOk:!1}),hoverlabel:i.hoverlabel,domain:n({name:"sankey",trace:!0}),orientation:{valType:"enumerated",values:["v","h"],dflt:"h"},valueformat:{valType:"string",dflt:".3s"},valuesuffix:{valType:"string",dflt:""},arrangement:{valType:"enumerated",values:["snap","perpendicular","freeform","fixed"],dflt:"snap"},textfont:a({}),customdata:void 0,node:{label:{valType:"data_array",dflt:[]},groups:{valType:"info_array",impliedEdits:{x:[],y:[]},dimensions:2,freeLength:!0,dflt:[],items:{valType:"number",editType:"calc"}},x:{valType:"data_array",dflt:[]},y:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:r.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:.5,arrayOk:!0}},pad:{valType:"number",arrayOk:!1,min:0,dflt:20},thickness:{valType:"number",arrayOk:!1,min:1,dflt:20},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:i.hoverlabel,hovertemplate:l({},{keys:["value","label"]})},link:{label:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:r.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:0,arrayOk:!0}},source:{valType:"data_array",dflt:[]},target:{valType:"data_array",dflt:[]},value:{valType:"data_array",dflt:[]},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:i.hoverlabel,hovertemplate:l({},{keys:["value","label"]}),colorscales:d("concentrationscales",{editType:"calc",label:{valType:"string",editType:"calc",dflt:""},cmax:{valType:"number",editType:"calc",dflt:1},cmin:{valType:"number",editType:"calc",dflt:0},colorscale:c(s().colorscale,{dflt:[[0,"white"],[1,"black"]]})})}},"calc","nested");g.transforms=void 0},{"../../components/color/attributes":523,"../../components/colorscale/attributes":531,"../../components/fx/attributes":555,"../../constants/docs":628,"../../lib/extend":648,"../../plot_api/edit_types":688,"../../plot_api/plot_template":695,"../../plots/attributes":702,"../../plots/domain":732,"../../plots/font_attributes":733,"../../plots/template_attributes":783}],1053:[function(e,t,a){'use strict';function o(e,t){var a=e._fullData[t],o=e._fullLayout,r=o.dragmode,i="pan"===o.dragmode?"move":"crosshair",n=a._bgRect;if("pan"!==r&&"zoom"!==r){s(n,i);var l={_id:"x",c2p:p.identity,_offset:a._sankey.translateX,_length:a._sankey.width},g={_id:"y",c2p:p.identity,_offset:a._sankey.translateY,_length:a._sankey.height},m={gd:e,element:n.node(),plotinfo:{id:t,xaxis:l,yaxis:g,fillRangeItems:p.noop},subplot:t,xaxes:[l],yaxes:[g],doneFnCompleted:function(a){function o(e){for(var t=r._sankey.graph.nodes,a=0;a<t.length;a++)if(t[a].pointNumber===e)return t[a]}for(var r=e._fullData[t],i=r.node.groups.slice(),n=[],l=0,s,d;l<a.length;l++)if(d=o(a[l].pointNumber),d)if(d.group){for(var c=0;c<d.childrenNodes.length;c++)n.push(d.childrenNodes[c].pointNumber);i[d.pointNumber-r.node._count]=!1}else n.push(d.pointNumber);s=i.filter(Boolean).concat([n]),u.call("_guiRestyle",e,{"node.groups":[s]},t)}};m.prepFn=function(t,e,a){c(t,e,a,m,r)},d.init(m)}}var r=e("../../plot_api/edit_types").overrideAll,i=e("../../plots/get_data").getModuleCalcData,n=e("./plot"),l=e("../../components/fx/layout_attributes"),s=e("../../lib/setcursor"),d=e("../../components/dragelement"),c=e("../../plots/cartesian/select").prepSelect,p=e("../../lib"),u=e("../../registry"),g="sankey";a.name=g,a.baseLayoutAttrOverrides=r({hoverlabel:l.hoverlabel},"plot","nested"),a.plot=function(e){var t=i(e.calcdata,g)[0];n(e,t),a.updateFx(e)},a.clean=function(e,t,a,o){var r=o._has&&o._has(g),i=t._has&&t._has(g);r&&!i&&(o._paperdiv.selectAll(".sankey").remove(),o._paperdiv.selectAll(".bgsankey").remove())},a.updateFx=function(e){for(var t=0;t<e._fullData.length;t++)o(e,t)}},{"../../components/dragelement":543,"../../components/fx/layout_attributes":565,"../../lib":657,"../../lib/setcursor":677,"../../plot_api/edit_types":688,"../../plots/cartesian/select":724,"../../plots/get_data":742,"../../registry":788,"./plot":1058}],1054:[function(e,t){'use strict';function a(e){var t=e.node,a=e.link,r=[],p=s(a.color),u=s(a.customdata),g={},m={},h=a.colorscales.length,y;for(y=0;y<h;y++){var f=a.colorscales[y],x=c.extractScale(f,{cLetter:"c"}),_=c.makeColorScaleFunc(x);m[f.label]=_}var b=0;for(y=0;y<a.value.length;y++)a.source[y]>b&&(b=a.source[y]),a.target[y]>b&&(b=a.target[y]);var v=b+1;e.node._count=v;var w=e.node.groups,k={},T;for(y=0;y<w.length;y++){var A=w[y];for(T=0;T<A.length;T++){var S=A[T],C=v+y;k.hasOwnProperty(S)?n.warn("Node "+S+" is already part of a group."):k[S]=C}}var L={source:[],target:[]};for(y=0;y<a.value.length;y++){var E=a.value[y],I=a.source[y],P=a.target[y];if(0<E&&d(I,v)&&d(P,v)&&!(k.hasOwnProperty(I)&&k.hasOwnProperty(P)&&k[I]===k[P])){k.hasOwnProperty(P)&&(P=k[P]),k.hasOwnProperty(I)&&(I=k[I]),I=+I,P=+P,g[I]=g[P]=!0;var z="";a.label&&a.label[y]&&(z=a.label[y]);var D=null;z&&m.hasOwnProperty(z)&&(D=m[z]),r.push({pointNumber:y,label:z,color:p?a.color[y]:a.color,customdata:u?a.customdata[y]:a.customdata,concentrationscale:D,source:I,target:P,value:+E}),L.source.push(I),L.target.push(P)}}var O=v+w.length,R=s(t.color),M=s(t.customdata),B=[];for(y=0;y<O;y++)if(g[y]){var F=t.label[y];B.push({group:y>v-1,childrenNodes:[],pointNumber:y,label:F,color:R?t.color[y]:t.color,customdata:M?t.customdata[y]:t.customdata})}var l=!1;return o(O,L.source,L.target)&&(l=!0),{circular:l,links:r,nodes:B,groups:w,groupLookup:k}}function o(e,t,a){for(var o=n.init2dArray(e,0),l=0;l<Math.min(t.length,a.length);l++)if(n.isIndex(t[l],e)&&n.isIndex(a[l],e)){if(t[l]===a[l])return!0;o[t[l]].push(a[l])}var s=r(o);return s.components.some(function(e){return 1<e.length})}var r=e("strongly-connected-components"),n=e("../../lib"),l=e("../../lib/gup").wrap,s=n.isArrayOrTypedArray,d=n.isIndex,c=e("../../components/colorscale");t.exports=function(e,t){var o=a(t);return l({circular:o.circular,_nodes:o.nodes,_links:o.links,_groups:o.groups,_groupLookup:o.groupLookup})}},{"../../components/colorscale":536,"../../lib":657,"../../lib/gup":655,"strongly-connected-components":1302}],1055:[function(e,t){'use strict';t.exports={nodeTextOffsetHorizontal:4,nodeTextOffsetVertical:3,nodePadAcross:10,sankeyIterations:50,forceIterations:5,forceTicksPerFrame:10,duration:500,ease:"linear",cn:{sankey:"sankey",sankeyLinks:"sankey-links",sankeyLink:"sankey-link",sankeyNodeSet:"sankey-node-set",sankeyNode:"sankey-node",nodeRect:"node-rect",nodeCapture:"node-capture",nodeCentered:"node-entered",nodeLabelGuide:"node-label-guide",nodeLabel:"node-label",nodeLabelTextPath:"node-label-text-path"}}},{}],1056:[function(e,t){'use strict';function a(e,t){function a(a,i){return o.coerce(e,t,r.link.colorscales,a,i)}a("label"),a("cmin"),a("cmax"),a("colorscale")}var o=e("../../lib"),r=e("./attributes"),n=e("../../components/color"),l=e("tinycolor2"),s=e("../../plots/domain").defaults,d=e("../../components/fx/hoverlabel_defaults"),c=e("../../plot_api/plot_template"),p=e("../../plots/array_container_defaults");t.exports=function(e,t,i,u){function g(a,i){return o.coerce(e,t,r,a,i)}function m(e,t){return o.coerce(f,x,r.node,e,t)}function h(e,t){return o.coerce(v,w,r.link,e,t)}var y=o.extendDeep(u.hoverlabel,e.hoverlabel),f=e.node,x=c.newContainer(t,"node");m("label"),m("groups"),m("x"),m("y"),m("pad"),m("thickness"),m("line.color"),m("line.width"),m("hoverinfo",e.hoverinfo),d(f,x,m,y),m("hovertemplate");var _=u.colorway,b=function(e){return _[e%_.length]};m("color",x.label.map(function(e,t){return n.addOpacity(b(t),.8)})),m("customdata");var v=e.link||{},w=c.newContainer(t,"link");h("label"),h("source"),h("target"),h("value"),h("line.color"),h("line.width"),h("hoverinfo",e.hoverinfo),d(v,w,h,y),h("hovertemplate");var k=.333>l(u.paper_bgcolor).getLuminance()?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.2)";h("color",o.repeat(k,w.value.length)),h("customdata"),p(v,w,{name:"colorscales",handleItemDefaults:a}),s(t,u,g),g("orientation"),g("valueformat"),g("valuesuffix");var T;x.x.length&&x.y.length&&(T="freeform"),g("arrangement",T),o.coerceFont(g,"textfont",o.extendFlat({},u.font)),t._length=null}},{"../../components/color":524,"../../components/fx/hoverlabel_defaults":562,"../../lib":657,"../../plot_api/plot_template":695,"../../plots/array_container_defaults":701,"../../plots/domain":732,"./attributes":1052,tinycolor2:1309}],1057:[function(e,t){'use strict';t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc"),plot:e("./plot"),moduleType:"trace",name:"sankey",basePlotModule:e("./base_plot"),selectPoints:e("./select.js"),categories:["noOpacity"],meta:{}}},{"./attributes":1052,"./base_plot":1053,"./calc":1054,"./defaults":1056,"./plot":1058,"./select.js":1060}],1058:[function(e,t){'use strict';function a(e){return""!==e}function o(e,t){return e.filter(function(e){return e.key===t.traceId})}function r(e,t){m.select(e).select("path").style("fill-opacity",t),m.select(e).select("rect").style("fill-opacity",t)}function i(e){m.select(e).select("text.name").style("fill","black")}function n(e){return function(t){return-1!==e.node.sourceLinks.indexOf(t.link)||-1!==e.node.targetLinks.indexOf(t.link)}}function l(e){return function(t){return-1!==t.node.sourceLinks.indexOf(e.link)||-1!==t.node.targetLinks.indexOf(e.link)}}function s(e,t,a){t&&a&&o(a,t).selectAll("."+x.sankeyLink).filter(n(t)).call(p.bind(0,t,a,!1))}function c(e,t,a){t&&a&&o(a,t).selectAll("."+x.sankeyLink).filter(n(t)).call(u.bind(0,t,a,!1))}function p(e,t,a,r){var i=r.datum().link.label;r.style("fill-opacity",function(e){if(!e.link.concentrationscale)return .4}),i&&o(t,e).selectAll("."+x.sankeyLink).filter(function(e){return e.link.label===i}).style("fill-opacity",function(e){if(!e.link.concentrationscale)return .4}),a&&o(t,e).selectAll("."+x.sankeyNode).filter(l(e)).call(s)}function u(e,t,a,r){var i=r.datum().link.label;r.style("fill-opacity",function(e){return e.tinyColorAlpha}),i&&o(t,e).selectAll("."+x.sankeyLink).filter(function(e){return e.link.label===i}).style("fill-opacity",function(e){return e.tinyColorAlpha}),a&&o(t,e).selectAll(x.sankeyNode).filter(l(e)).call(c)}function g(e,t){var a=e.hoverlabel||{},o=f.nestedProperty(a,t).get();return!Array.isArray(o)&&o}var m=e("d3"),d=e("./render"),h=e("../../components/fx"),y=e("../../components/color"),f=e("../../lib"),x=e("./constants").cn,b=f._;t.exports=function(e,t){for(var o=e._fullLayout,n=o._paper,l=o._size,f=0;f<e._fullData.length;f++)if(e._fullData[f].visible&&e._fullData[f].type===x.sankey&&!e._fullData[f]._viewInitial){var _=e._fullData[f].node;e._fullData[f]._viewInitial={node:{groups:_.groups.slice(),x:_.x.slice(),y:_.y.slice()}}}var v=b(e,"source:")+" ",w=b(e,"target:")+" ",k=b(e,"concentration:")+" ",T=b(e,"incoming flow count:")+" ",A=b(e,"outgoing flow count:")+" ",S=function(t,n){function l(e){var t,a;e.circular?(t=(e.circularPathData.leftInnerExtent+e.circularPathData.rightInnerExtent)/2,a=e.circularPathData.verticalFullExtent):(t=(e.source.x1+e.target.x0)/2,a=(e.y0+e.y1)/2);var o=[t,a];return"v"===e.trace.orientation&&o.reverse(),o[0]+=n.parent.translateX,o[1]+=n.parent.translateY,o}if(!1!==e._fullLayout.hovermode){var s=n.link.trace.link;if("none"!==s.hoverinfo&&"skip"!==s.hoverinfo){for(var d=[],c=0,p=0,u;p<n.flow.links.length;p++)if(u=n.flow.links[p],"closest"!==e._fullLayout.hovermode||n.link.pointNumber===u.pointNumber){n.link.pointNumber===u.pointNumber&&(c=p),u.fullData=u.trace,s=n.link.trace.link;var f=l(u),x={valueLabel:m.format(n.valueFormat)(u.value)+n.valueSuffix};d.push({x:f[0],y:f[1],name:x.valueLabel,text:[u.label||"",v+u.source.label,w+u.target.label,u.concentrationscale?k+m.format("%0.2f")(u.flow.labelConcentration):""].filter(a).join("<br>"),color:g(s,"bgcolor")||y.addOpacity(u.color,1),borderColor:g(s,"bordercolor"),fontFamily:g(s,"font.family"),fontSize:g(s,"font.size"),fontColor:g(s,"font.color"),nameLength:g(s,"namelength"),textAlign:g(s,"align"),idealAlign:m.event.x<f[0]?"right":"left",hovertemplate:s.hovertemplate,hovertemplateLabels:x,eventData:[u]})}var _=h.loneHover(d,{container:o._hoverlayer.node(),outerContainer:o._paper.node(),gd:e,anchorIndex:c});_.each(function(){var e=this;n.link.concentrationscale||r(e,.65),i(e)})}}};d(e,n,t,{width:l.w,height:l.h,margin:{t:l.t,r:l.r,b:l.b,l:l.l}},{linkEvents:{hover:function(t,a,o){!1===e._fullLayout.hovermode||(m.select(t).call(p.bind(0,a,o,!0)),"skip"!==a.link.trace.link.hoverinfo&&(a.link.fullData=a.link.trace,e.emit("plotly_hover",{event:m.event,points:[a.link]})))},follow:S,unhover:function(t,a,r){!1===e._fullLayout.hovermode||(m.select(t).call(u.bind(0,a,r,!0)),"skip"!==a.link.trace.link.hoverinfo&&(a.link.fullData=a.link.trace,e.emit("plotly_unhover",{event:m.event,points:[a.link]})),h.loneUnhover(o._hoverlayer.node()))},select:function(t,a){var o=a.link;o.originalEvent=m.event,e._hoverdata=[o],h.click(e,{target:!0})}},nodeEvents:{hover:function(t,a,o){!1===e._fullLayout.hovermode||(m.select(t).call(s,a,o),"skip"!==a.node.trace.node.hoverinfo&&(a.node.fullData=a.node.trace,e.emit("plotly_hover",{event:m.event,points:[a.node]})))},follow:function(t,n){if(!1!==e._fullLayout.hovermode){var l=n.node.trace.node;if("none"!==l.hoverinfo&&"skip"!==l.hoverinfo){var s=m.select(t).select("."+x.nodeRect),d=e._fullLayout._paperdiv.node().getBoundingClientRect(),c=s.node().getBoundingClientRect(),p=c.left-2-d.left,u=c.right+2-d.left,y=c.top+c.height/4-d.top,f={valueLabel:m.format(n.valueFormat)(n.node.value)+n.valueSuffix};n.node.fullData=n.node.trace;var _=h.loneHover({x0:p,x1:u,y:y,name:m.format(n.valueFormat)(n.node.value)+n.valueSuffix,text:[n.node.label,T+n.node.targetLinks.length,A+n.node.sourceLinks.length].filter(a).join("<br>"),color:g(l,"bgcolor")||n.tinyColorHue,borderColor:g(l,"bordercolor"),fontFamily:g(l,"font.family"),fontSize:g(l,"font.size"),fontColor:g(l,"font.color"),nameLength:g(l,"namelength"),textAlign:g(l,"align"),idealAlign:"left",hovertemplate:l.hovertemplate,hovertemplateLabels:f,eventData:[n.node]},{container:o._hoverlayer.node(),outerContainer:o._paper.node(),gd:e});r(_,.85),i(_)}}},unhover:function(t,a,r){!1===e._fullLayout.hovermode||(m.select(t).call(c,a,r),"skip"!==a.node.trace.node.hoverinfo&&(a.node.fullData=a.node.trace,e.emit("plotly_unhover",{event:m.event,points:[a.node]})),h.loneUnhover(o._hoverlayer.node()))},select:function(t,a,o){var r=a.node;r.originalEvent=m.event,e._hoverdata=[r],m.select(t).call(c,a,o),h.click(e,{target:!0})}}})}},{"../../components/color":524,"../../components/fx":564,"../../lib":657,"./constants":1055,"./render":1059,d3:108}],1059:[function(e,t){'use strict';var z=Math.ceil,D=Math.min,O=Math.abs,R=Math.max;function a(e,t,a){function o(){for(b=0;b<_.nodes.length;b++){var e=_.nodes[b],t={},a,o;for(v=0;v<e.targetLinks.length;v++)o=e.targetLinks[v],a=o.source.pointNumber+":"+o.target.pointNumber,t.hasOwnProperty(a)||(t[a]=[]),t[a].push(o);var r=Object.keys(t);for(v=0;v<r.length;v++){a=r[v];var i=t[a],n=0,l={};for(w=0;w<i.length;w++)o=i[w],l[o.label]||(l[o.label]=0),l[o.label]+=o.value,n+=o.value;for(w=0;w<i.length;w++)o=i[w],o.flow={value:n,labelConcentration:l[o.label]/n,concentration:o.value/n,links:i},o.concentrationscale&&(o.color=j(o.concentrationscale(o.flow.labelConcentration)))}var s=0;for(v=0;v<e.sourceLinks.length;v++)s+=e.sourceLinks[v].value;for(v=0;v<e.sourceLinks.length;v++)o=e.sourceLinks[v],o.concentrationOut=o.value/s;var d=0;for(v=0;v<e.targetLinks.length;v++)d+=e.targetLinks[v].value;for(v=0;v<e.targetLinks.length;v++)o=e.targetLinks[v],o.concenrationIn=o.value/d}}function r(e){e.forEach(function(e){var t=0,a=e.length,o,r,n;for(e.sort(function(e,t){return e.y0-t.y0}),n=0;n<a;++n)o=e[n],o.y0>=t||(r=t-o.y0,1e-6<r&&(o.y0+=r,o.y1+=r)),t=o.y1+p})}function n(e){var t=e.map(function(e,t){return{x0:e.x0,index:t}}).sort(function(e,t){return e.x0-t.x0}),a=[],o=-1,r=-Infinity,i,n;for(b=0;b<t.length;b++){var l=e[t[b].index];l.x0>r+u&&(o+=1,i=l.x0),r=l.x0,a[o]||(a[o]=[]),a[o].push(l),n=i-l.x0,l.x0+=n,l.x1+=n}return a}var l=W(t),s=l.trace,d=s.domain,c="h"===s.orientation,p=s.node.pad,u=s.node.thickness,g=e.width*(d.x[1]-d.x[0]),m=e.height*(d.y[1]-d.y[0]),h=l._nodes,y=l._links,f=l.circular,x;x=f?V.sankeyCircular().circularLinkGap(0):N.sankey(),x.iterations(M.sankeyIterations).size(c?[g,m]:[m,g]).nodeWidth(u).nodePadding(p).nodeId(function(e){return e.pointNumber}).nodes(h).links(y);var _=x();x.nodePadding()<p&&H.warn("node.pad was reduced to ",x.nodePadding()," to fit within the figure.");var b,v,w;for(var T in l._groupLookup){var A=parseInt(l._groupLookup[T]),S;for(b=0;b<_.nodes.length;b++)if(_.nodes[b].pointNumber===A){S=_.nodes[b];break}if(S){var C={pointNumber:parseInt(T),x0:S.x0,x1:S.x1,y0:S.y0,y1:S.y1,partOfGroup:!0,sourceLinks:[],targetLinks:[]};_.nodes.unshift(C),S.childrenNodes.unshift(C)}}if(o(),s.node.x.length&&s.node.y.length){for(b=0;b<D(s.node.x.length,s.node.y.length,_.nodes.length);b++)if(s.node.x[b]&&s.node.y[b]){var L=[s.node.x[b]*g,s.node.y[b]*m];_.nodes[b].x0=L[0]-u/2,_.nodes[b].x1=L[0]+u/2;var E=_.nodes[b].y1-_.nodes[b].y0;_.nodes[b].y0=L[1]-E/2,_.nodes[b].y1=L[1]+E/2}if("snap"===s.arrangement){h=_.nodes;var I=n(h);r(I)}x.update(_)}return{circular:f,key:a,trace:s,guid:H.randstr(),horizontal:c,width:g,height:m,nodePad:s.node.pad,nodeLineColor:s.node.line.color,nodeLineWidth:s.node.line.width,linkLineColor:s.link.line.color,linkLineWidth:s.link.line.width,valueFormat:s.valueformat,valueSuffix:s.valuesuffix,textFont:s.textfont,translateX:d.x[0]*e.width+e.margin.l,translateY:e.height-d.y[1]*e.height+e.margin.t,dragParallel:c?m:g,dragPerpendicular:c?g:m,arrangement:s.arrangement,sankey:x,graph:_,forceLayouts:{},interactionState:{dragInProgress:!1,hovered:!1}}}function o(e,t,a){var o=j(t.color),r=t.source.label+"|"+t.target.label;return t.trace=e.trace,t.curveNumber=e.trace.index,{circular:e.circular,key:r+"__"+a,traceId:e.key,pointNumber:t.pointNumber,link:t,tinyColorHue:B.tinyRGB(o),tinyColorAlpha:o.getAlpha(),linkPath:n,linkLineColor:e.linkLineColor,linkLineWidth:e.linkLineWidth,valueFormat:e.valueFormat,valueSuffix:e.valueSuffix,sankey:e.sankey,parent:e,interactionState:e.interactionState,flow:t.flow}}function r(e){var t="",a=e.width/2,o=e.circularPathData;return t="top"===e.circularLinkType?"M "+o.targetX+" "+(o.targetY+a)+" L"+o.rightInnerExtent+" "+(o.targetY+a)+"A"+(o.rightLargeArcRadius+a)+" "+(o.rightSmallArcRadius+a)+" 0 0 1 "+(o.rightFullExtent-a)+" "+(o.targetY-o.rightSmallArcRadius)+"L"+(o.rightFullExtent-a)+" "+o.verticalRightInnerExtent+"A"+(o.rightLargeArcRadius+a)+" "+(o.rightLargeArcRadius+a)+" 0 0 1 "+o.rightInnerExtent+" "+(o.verticalFullExtent-a)+"L"+o.leftInnerExtent+" "+(o.verticalFullExtent-a)+"A"+(o.leftLargeArcRadius+a)+" "+(o.leftLargeArcRadius+a)+" 0 0 1 "+(o.leftFullExtent+a)+" "+o.verticalLeftInnerExtent+"L"+(o.leftFullExtent+a)+" "+(o.sourceY-o.leftSmallArcRadius)+"A"+(o.leftLargeArcRadius+a)+" "+(o.leftSmallArcRadius+a)+" 0 0 1 "+o.leftInnerExtent+" "+(o.sourceY+a)+"L"+o.sourceX+" "+(o.sourceY+a)+"L"+o.sourceX+" "+(o.sourceY-a)+"L"+o.leftInnerExtent+" "+(o.sourceY-a)+"A"+(o.leftLargeArcRadius-a)+" "+(o.leftSmallArcRadius-a)+" 0 0 0 "+(o.leftFullExtent-a)+" "+(o.sourceY-o.leftSmallArcRadius)+"L"+(o.leftFullExtent-a)+" "+o.verticalLeftInnerExtent+"A"+(o.leftLargeArcRadius-a)+" "+(o.leftLargeArcRadius-a)+" 0 0 0 "+o.leftInnerExtent+" "+(o.verticalFullExtent+a)+"L"+o.rightInnerExtent+" "+(o.verticalFullExtent+a)+"A"+(o.rightLargeArcRadius-a)+" "+(o.rightLargeArcRadius-a)+" 0 0 0 "+(o.rightFullExtent+a)+" "+o.verticalRightInnerExtent+"L"+(o.rightFullExtent+a)+" "+(o.targetY-o.rightSmallArcRadius)+"A"+(o.rightLargeArcRadius-a)+" "+(o.rightSmallArcRadius-a)+" 0 0 0 "+o.rightInnerExtent+" "+(o.targetY-a)+"L"+o.targetX+" "+(o.targetY-a)+"Z":"M "+o.targetX+" "+(o.targetY-a)+" L"+o.rightInnerExtent+" "+(o.targetY-a)+"A"+(o.rightLargeArcRadius+a)+" "+(o.rightSmallArcRadius+a)+" 0 0 0 "+(o.rightFullExtent-a)+" "+(o.targetY+o.rightSmallArcRadius)+"L"+(o.rightFullExtent-a)+" "+o.verticalRightInnerExtent+"A"+(o.rightLargeArcRadius+a)+" "+(o.rightLargeArcRadius+a)+" 0 0 0 "+o.rightInnerExtent+" "+(o.verticalFullExtent+a)+"L"+o.leftInnerExtent+" "+(o.verticalFullExtent+a)+"A"+(o.leftLargeArcRadius+a)+" "+(o.leftLargeArcRadius+a)+" 0 0 0 "+(o.leftFullExtent+a)+" "+o.verticalLeftInnerExtent+"L"+(o.leftFullExtent+a)+" "+(o.sourceY+o.leftSmallArcRadius)+"A"+(o.leftLargeArcRadius+a)+" "+(o.leftSmallArcRadius+a)+" 0 0 0 "+o.leftInnerExtent+" "+(o.sourceY-a)+"L"+o.sourceX+" "+(o.sourceY-a)+"L"+o.sourceX+" "+(o.sourceY+a)+"L"+o.leftInnerExtent+" "+(o.sourceY+a)+"A"+(o.leftLargeArcRadius-a)+" "+(o.leftSmallArcRadius-a)+" 0 0 1 "+(o.leftFullExtent-a)+" "+(o.sourceY+o.leftSmallArcRadius)+"L"+(o.leftFullExtent-a)+" "+o.verticalLeftInnerExtent+"A"+(o.leftLargeArcRadius-a)+" "+(o.leftLargeArcRadius-a)+" 0 0 1 "+o.leftInnerExtent+" "+(o.verticalFullExtent-a)+"L"+o.rightInnerExtent+" "+(o.verticalFullExtent-a)+"A"+(o.rightLargeArcRadius-a)+" "+(o.rightLargeArcRadius-a)+" 0 0 1 "+(o.rightFullExtent+a)+" "+o.verticalRightInnerExtent+"L"+(o.rightFullExtent+a)+" "+(o.targetY+o.rightSmallArcRadius)+"A"+(o.rightLargeArcRadius-a)+" "+(o.rightSmallArcRadius-a)+" 0 0 1 "+o.rightInnerExtent+" "+(o.targetY+a)+"L"+o.targetX+" "+(o.targetY+a)+"Z",t}function n(){var e=.5;return function(t){if(t.link.circular)return r(t.link);var a=t.link.source.x1,o=t.link.target.x0,i=X(a,o),n=i(e),l=i(1-e),s=t.link.y0-t.link.width/2,d=t.link.y0+t.link.width/2,c=t.link.y1-t.link.width/2,p=t.link.y1+t.link.width/2;return"M"+a+","+s+"C"+n+","+s+" "+l+","+c+" "+o+","+c+"L"+o+","+p+"C"+l+","+p+" "+n+","+d+" "+a+","+d+"Z"}}function l(e,t){var a=j(t.color),o=M.nodePadAcross,r=e.nodePad/2;t.dx=t.x1-t.x0,t.dy=t.y1-t.y0;var i=t.dx,n=R(.5,t.dy),l="node_"+t.pointNumber;return t.group&&(l=H.randstr()),t.trace=e.trace,t.curveNumber=e.trace.index,{index:t.pointNumber,key:l,partOfGroup:t.partOfGroup||!1,group:t.group,traceId:e.key,trace:e.trace,node:t,nodePad:e.nodePad,nodeLineColor:e.nodeLineColor,nodeLineWidth:e.nodeLineWidth,textFont:e.textFont,size:e.horizontal?e.height:e.width,visibleWidth:z(i),visibleHeight:n,zoneX:-o,zoneY:-r,zoneWidth:i+2*o,zoneHeight:n+2*r,labelY:e.horizontal?t.dy/2+1:t.dx/2+1,left:1===t.originalLayer,sizeAcross:e.width,forceLayouts:e.forceLayouts,horizontal:e.horizontal,darkBackground:128>=a.getBrightness(),tinyColorHue:B.tinyRGB(a),tinyColorAlpha:a.getAlpha(),valueFormat:e.valueFormat,valueSuffix:e.valueSuffix,sankey:e.sankey,graph:e.graph,arrangement:e.arrangement,uniqueNodeLabelPathId:[e.guid,e.key,l].join("_"),interactionState:e.interactionState,figure:e}}function s(e){e.attr("transform",function(e){return"translate("+e.node.x0.toFixed(3)+", "+e.node.y0.toFixed(3)+")"})}function d(e){e.call(s)}function p(e,t){e.call(d),t.attr("d",n())}function u(e){e.attr("width",function(e){return e.node.x1-e.node.x0}).attr("height",function(e){return e.visibleHeight})}function g(e){return 1<e.link.width||0<e.linkLineWidth}function m(e){var t="translate("+e.translateX+","+e.translateY+")";return t+(e.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)")}function h(e){return"translate("+(e.horizontal?0:e.labelY)+" "+(e.horizontal?e.labelY:0)+")"}function y(e){return c.svg.line()([[e.horizontal?e.left?-e.sizeAcross:e.visibleWidth+M.nodeTextOffsetHorizontal:M.nodeTextOffsetHorizontal,0],[e.horizontal?e.left?-M.nodeTextOffsetHorizontal:e.sizeAcross:e.visibleHeight-M.nodeTextOffsetHorizontal,0]])}function f(e){return e.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)"}function x(e){return e.horizontal?"scale(1 1)":"scale(-1 1)"}function _(e){return e.darkBackground&&!e.horizontal?"rgb(255,255,255)":"rgb(0,0,0)"}function b(e){return e.horizontal&&e.left?"100%":"0%"}function v(e,t,a){e.on(".basic",null).on("mouseover.basic",function(e){e.interactionState.dragInProgress||e.partOfGroup||(a.hover(this,e,t),e.interactionState.hovered=[this,e])}).on("mousemove.basic",function(e){e.interactionState.dragInProgress||e.partOfGroup||(a.follow(this,e),e.interactionState.hovered=[this,e])}).on("mouseout.basic",function(e){e.interactionState.dragInProgress||e.partOfGroup||(a.unhover(this,e,t),e.interactionState.hovered=!1)}).on("click.basic",function(e){e.interactionState.hovered&&(a.unhover(this,e,t),e.interactionState.hovered=!1),e.interactionState.dragInProgress||e.partOfGroup||a.select(this,e,t)})}function w(e,t,a,o){var r=c.behavior.drag().origin(function(e){return{x:e.node.x0+e.visibleWidth/2,y:e.node.y0+e.visibleHeight/2}}).on("dragstart",function(r){if("fixed"!==r.arrangement&&(H.ensureSingle(o._fullLayout._infolayer,"g","dragcover",function(e){o._fullLayout._dragCover=e}),H.raiseToTop(this),r.interactionState.dragInProgress=r.node,L(r.node),r.interactionState.hovered&&(a.nodeEvents.unhover.apply(0,r.interactionState.hovered),r.interactionState.hovered=!1),"snap"===r.arrangement)){var i=r.traceId+"|"+r.key;r.forceLayouts[i]?r.forceLayouts[i].alpha(1):k(e,i,r,o),T(e,t,r,i,o)}}).on("drag",function(a){if("fixed"!==a.arrangement){var o=c.event.x,r=c.event.y;"snap"===a.arrangement?(a.node.x0=o-a.visibleWidth/2,a.node.x1=o+a.visibleWidth/2,a.node.y0=r-a.visibleHeight/2,a.node.y1=r+a.visibleHeight/2):("freeform"===a.arrangement&&(a.node.x0=o-a.visibleWidth/2,a.node.x1=o+a.visibleWidth/2),r=R(0,D(a.size-a.visibleHeight/2,r)),a.node.y0=r-a.visibleHeight/2,a.node.y1=r+a.visibleHeight/2),L(a.node),"snap"!==a.arrangement&&(a.sankey.update(a.graph),p(e.filter(E(a)),t))}}).on("dragend",function(e){if("fixed"!==e.arrangement){e.interactionState.dragInProgress=!1;for(var t=0;t<e.node.childrenNodes.length;t++)e.node.childrenNodes[t].x=e.node.x,e.node.childrenNodes[t].y=e.node.y;"snap"!==e.arrangement&&S(e,o)}});e.on(".drag",null).call(r)}function k(e,t,a,o){I(a.graph.nodes);var r=a.graph.nodes.filter(function(e){return e.originalX===a.node.originalX}).filter(function(e){return!e.partOfGroup});a.forceLayouts[t]=U.forceSimulation(r).alphaDecay(0).force("collide",U.forceCollide().radius(function(e){return e.dy/2+a.nodePad/2}).strength(1).iterations(M.forceIterations)).force("constrain",A(e,t,r,a,o)).stop()}function T(e,t,a,o,r){window.requestAnimationFrame(function n(){var l;for(l=0;l<M.forceTicksPerFrame;l++)a.forceLayouts[o].tick();var s=a.graph.nodes;if(P(s),a.sankey.update(a.graph),p(e.filter(E(a)),t),0<a.forceLayouts[o].alpha())window.requestAnimationFrame(n);else{var d=a.node.originalX;a.node.x0=d-a.visibleWidth/2,a.node.x1=d+a.visibleWidth/2,S(a,r)}})}function A(e,t,a,o){return function(){for(var e=0,r=0,l;r<a.length;r++)l=a[r],l===o.interactionState.dragInProgress?(l.x=l.lastDraggedX,l.y=l.lastDraggedY):(l.vx=(l.originalX-l.x)/M.forceTicksPerFrame,l.y=D(o.size-l.dy/2,R(l.dy/2,l.y))),e=R(e,O(l.vx),O(l.vy));!o.interactionState.dragInProgress&&.1>e&&0<o.forceLayouts[t].alpha()&&o.forceLayouts[t].alpha(0)}}function S(e,t){for(var a=[],o=[],r=0;r<e.graph.nodes.length;r++){var n=(e.graph.nodes[r].x0+e.graph.nodes[r].x1)/2,l=(e.graph.nodes[r].y0+e.graph.nodes[r].y1)/2;a.push(n/e.figure.width),o.push(l/e.figure.height)}Z.call("_guiRestyle",t,{"node.x":[a],"node.y":[o]},e.trace.index).then(function(){t._fullLayout._dragCover&&t._fullLayout._dragCover.remove()})}function C(e){var t=[],a;for(a=0;a<e.length;a++)e[a].originalX=(e[a].x0+e[a].x1)/2,e[a].originalY=(e[a].y0+e[a].y1)/2,-1===t.indexOf(e[a].originalX)&&t.push(e[a].originalX);for(t.sort(function(e,t){return e-t}),a=0;a<e.length;a++)e[a].originalLayerIndex=t.indexOf(e[a].originalX),e[a].originalLayer=e[a].originalLayerIndex/(t.length-1)}function L(e){e.lastDraggedX=e.x0+e.dx/2,e.lastDraggedY=e.y0+e.dy/2}function E(e){return function(t){return t.node.originalX===e.node.originalX}}function I(e){for(var t=0;t<e.length;t++)e[t].y=(e[t].y0+e[t].y1)/2,e[t].x=(e[t].x0+e[t].x1)/2}function P(e){for(var t=0;t<e.length;t++)e[t].y0=e[t].y-e[t].dy/2,e[t].y1=e[t].y0+e[t].dy,e[t].x0=e[t].x-e[t].dx/2,e[t].x1=e[t].x0+e[t].dx}var M=e("./constants"),c=e("d3"),j=e("tinycolor2"),B=e("../../components/color"),F=e("../../components/drawing"),N=e("@plotly/d3-sankey"),V=e("@plotly/d3-sankey-circular"),U=e("d3-force"),H=e("../../lib"),q=e("../../lib/gup"),G=q.keyFun,Y=q.repeat,W=q.unwrap,X=e("d3-interpolate").interpolateNumber,Z=e("../../registry");t.exports=function(e,t,r,i,d){var p=!1;H.ensureSingle(e._fullLayout._infolayer,"g","first-render",function(){p=!0});var k=e._fullLayout._dragCover,T=r.filter(function(e){return W(e).trace.visible}).map(a.bind(null,i)),A=t.selectAll("."+M.cn.sankey).data(T,G);A.exit().remove(),A.enter().append("g").classed(M.cn.sankey,!0).style("box-sizing","content-box").style("position","absolute").style("left",0).style("shape-rendering","geometricPrecision").style("pointer-events","auto").attr("transform",m),A.each(function(t,a){e._fullData[a]._sankey=t;var o="bgsankey-"+t.trace.uid+"-"+a;H.ensureSingle(e._fullLayout._draggers,"rect",o),e._fullData[a]._bgRect=c.select("."+o),e._fullData[a]._bgRect.style("pointer-events","all").attr("width",t.width).attr("height",t.height).attr("x",t.translateX).attr("y",t.translateY).classed("bgsankey",!0).style({fill:"transparent","stroke-width":0})}),A.transition().ease(M.ease).duration(M.duration).attr("transform",m);var S=A.selectAll("."+M.cn.sankeyLinks).data(Y,G);S.enter().append("g").classed(M.cn.sankeyLinks,!0).style("fill","none");var L=S.selectAll("."+M.cn.sankeyLink).data(function(e){var t=e.graph.links;return t.filter(function(e){return e.value}).map(o.bind(null,e))},G);L.enter().append("path").classed(M.cn.sankeyLink,!0).call(v,A,d.linkEvents),L.style("stroke",function(e){return g(e)?B.tinyRGB(j(e.linkLineColor)):e.tinyColorHue}).style("stroke-opacity",function(e){return g(e)?B.opacity(e.linkLineColor):e.tinyColorAlpha}).style("fill",function(e){return e.tinyColorHue}).style("fill-opacity",function(e){return e.tinyColorAlpha}).style("stroke-width",function(e){return g(e)?e.linkLineWidth:1}).attr("d",n()),L.style("opacity",function(){return e._context.staticPlot||p||k?1:0}).transition().ease(M.ease).duration(M.duration).style("opacity",1),L.exit().transition().ease(M.ease).duration(M.duration).style("opacity",0).remove();var E=A.selectAll("."+M.cn.sankeyNodeSet).data(Y,G);E.enter().append("g").classed(M.cn.sankeyNodeSet,!0),E.style("cursor",function(e){switch(e.arrangement){case"fixed":return"default";case"perpendicular":return"ns-resize";default:return"move";}});var I=E.selectAll("."+M.cn.sankeyNode).data(function(e){var t=e.graph.nodes;return C(t),t.map(l.bind(null,e))},G);I.enter().append("g").classed(M.cn.sankeyNode,!0).call(s).style("opacity",function(t){return(e._context.staticPlot||p)&&!t.partOfGroup?1:0}),I.call(v,A,d.nodeEvents).call(w,L,d,e),I.transition().ease(M.ease).duration(M.duration).call(s).style("opacity",function(e){return e.partOfGroup?0:1}),I.exit().transition().ease(M.ease).duration(M.duration).style("opacity",0).remove();var P=I.selectAll("."+M.cn.nodeRect).data(Y);P.enter().append("rect").classed(M.cn.nodeRect,!0).call(u),P.style("stroke-width",function(e){return e.nodeLineWidth}).style("stroke",function(e){return B.tinyRGB(j(e.nodeLineColor))}).style("stroke-opacity",function(e){return B.opacity(e.nodeLineColor)}).style("fill",function(e){return e.tinyColorHue}).style("fill-opacity",function(e){return e.tinyColorAlpha}),P.transition().ease(M.ease).duration(M.duration).call(u);var z=I.selectAll("."+M.cn.nodeCapture).data(Y);z.enter().append("rect").classed(M.cn.nodeCapture,!0).style("fill-opacity",0),z.attr("x",function(e){return e.zoneX}).attr("y",function(e){return e.zoneY}).attr("width",function(e){return e.zoneWidth}).attr("height",function(e){return e.zoneHeight});var D=I.selectAll("."+M.cn.nodeCentered).data(Y);D.enter().append("g").classed(M.cn.nodeCentered,!0).attr("transform",h),D.transition().ease(M.ease).duration(M.duration).attr("transform",h);var O=D.selectAll("."+M.cn.nodeLabelGuide).data(Y);O.enter().append("path").classed(M.cn.nodeLabelGuide,!0).attr("id",function(e){return e.uniqueNodeLabelPathId}).attr("d",y).attr("transform",f),O.transition().ease(M.ease).duration(M.duration).attr("d",y).attr("transform",f);var R=D.selectAll("."+M.cn.nodeLabel).data(Y);R.enter().append("text").classed(M.cn.nodeLabel,!0).attr("transform",x).style("user-select","none").style("cursor","default").style("fill","black"),R.style("text-shadow",function(e){return e.horizontal?"-1px 1px 1px #fff, 1px 1px 1px #fff, 1px -1px 1px #fff, -1px -1px 1px #fff":"none"}).each(function(e){F.font(R,e.textFont)}),R.transition().ease(M.ease).duration(M.duration).attr("transform",x);var N=R.selectAll("."+M.cn.nodeLabelTextPath).data(Y);N.enter().append("textPath").classed(M.cn.nodeLabelTextPath,!0).attr("alignment-baseline","middle").attr("xlink:href",function(e){return"#"+e.uniqueNodeLabelPathId}).attr("startOffset",b).style("fill",_),N.text(function(e){return e.horizontal||5<e.node.dy?e.node.label:""}).attr("text-anchor",function(e){return e.horizontal&&e.left?"end":"start"}),N.transition().ease(M.ease).duration(M.duration).attr("startOffset",b).style("fill",_)}},{"../../components/color":524,"../../components/drawing":546,"../../lib":657,"../../lib/gup":655,"../../registry":788,"./constants":1055,"@plotly/d3-sankey":8,"@plotly/d3-sankey-circular":7,d3:108,"d3-force":101,"d3-interpolate":103,tinycolor2:1309}],1060:[function(e,t){'use strict';t.exports=function(e,t){for(var a=e.cd,o=[],r=a[0].trace,n=r._sankey.graph.nodes,l=0,s;l<n.length;l++)if(s=n[l],!s.partOfGroup){var d=[(s.x0+s.x1)/2,(s.y0+s.y1)/2];"v"===r.orientation&&d.reverse(),t&&t.contains(d,!1,l,e)&&o.push({pointNumber:s.pointNumber})}return o}},{}],1061:[function(e,t){'use strict';var a=e("../../lib");t.exports=function(e,t){for(var o=0;o<e.length;o++)e[o].i=o;a.mergeArray(t.text,e,"tx"),a.mergeArray(t.texttemplate,e,"txt"),a.mergeArray(t.hovertext,e,"htx"),a.mergeArray(t.customdata,e,"data"),a.mergeArray(t.textposition,e,"tp"),t.textfont&&(a.mergeArrayCastPositive(t.textfont.size,e,"ts"),a.mergeArray(t.textfont.color,e,"tc"),a.mergeArray(t.textfont.family,e,"tf"));var r=t.marker;if(r){a.mergeArrayCastPositive(r.size,e,"ms"),a.mergeArrayCastPositive(r.opacity,e,"mo"),a.mergeArray(r.symbol,e,"mx"),a.mergeArray(r.color,e,"mc");var n=r.line;r.line&&(a.mergeArray(n.color,e,"mlc"),a.mergeArrayCastPositive(n.width,e,"mlw"));var l=r.gradient;l&&"none"!==l.type&&(a.mergeArray(l.type,e,"mgt"),a.mergeArray(l.color,e,"mgc"))}}},{"../../lib":657}],1062:[function(e,t){'use strict';var a=e("../../plots/template_attributes").texttemplateAttrs,o=e("../../plots/template_attributes").hovertemplateAttrs,r=e("../../components/colorscale/attributes"),i=e("../../plots/font_attributes"),n=e("../../components/drawing/attributes").dash,l=e("../../components/drawing"),s=e("./constants"),d=e("../../lib/extend").extendFlat;t.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dx:{valType:"number",dflt:1,editType:"calc",anim:!0},y:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dy:{valType:"number",dflt:1,editType:"calc",anim:!0},stackgroup:{valType:"string",dflt:"",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc"},groupnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},stackgaps:{valType:"enumerated",values:["infer zero","interpolate"],dflt:"infer zero",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},texttemplate:a({},{}),hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"],editType:"calc"},hoveron:{valType:"flaglist",flags:["points","fills"],editType:"style"},hovertemplate:o({},{keys:s.eventDataKeys}),line:{color:{valType:"color",editType:"style",anim:!0},width:{valType:"number",min:0,dflt:2,editType:"style",anim:!0},shape:{valType:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},smoothing:{valType:"number",min:0,max:1.3,dflt:1,editType:"plot"},dash:d({},n,{editType:"style"}),simplify:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},cliponaxis:{valType:"boolean",dflt:!0,editType:"plot"},fill:{valType:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx","toself","tonext"],editType:"calc"},fillcolor:{valType:"color",editType:"style",anim:!0},marker:d({symbol:{valType:"enumerated",values:l.symbolList,dflt:"circle",arrayOk:!0,editType:"style"},opacity:{valType:"number",min:0,max:1,arrayOk:!0,editType:"style",anim:!0},size:{valType:"number",min:0,dflt:6,arrayOk:!0,editType:"calc",anim:!0},maxdisplayed:{valType:"number",min:0,dflt:0,editType:"plot"},sizeref:{valType:"number",dflt:1,editType:"calc"},sizemin:{valType:"number",min:0,dflt:0,editType:"calc"},sizemode:{valType:"enumerated",values:["diameter","area"],dflt:"diameter",editType:"calc"},line:d({width:{valType:"number",min:0,arrayOk:!0,editType:"style",anim:!0},editType:"calc"},r("marker.line",{anim:!0})),gradient:{type:{valType:"enumerated",values:["radial","horizontal","vertical","none"],arrayOk:!0,dflt:"none",editType:"calc"},color:{valType:"color",arrayOk:!0,editType:"calc"},editType:"calc"},editType:"calc"},r("marker",{anim:!0})),selected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},unselected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:!0,editType:"calc"},textfont:i({editType:"calc",colorEditType:"style",arrayOk:!0}),r:{valType:"data_array",editType:"calc"},t:{valType:"data_array",editType:"calc"}}},{"../../components/colorscale/attributes":531,"../../components/drawing":546,"../../components/drawing/attributes":545,"../../lib/extend":648,"../../plots/font_attributes":733,"../../plots/template_attributes":783,"./constants":1066}],1063:[function(e,t){'use strict';var l=Math.sqrt,s=Math.max;function a(e,t,a,o,r,l,s){var d=t._length,c=e._fullLayout,u=a._id,m=o._id,h=c._firstScatter[i(t)]===t.uid,y=(n(t,c,a,o)||{}).orientation,f=t.fill;a._minDtick=0,o._minDtick=0;var x={padded:!0},_={padded:!0};s&&(x.ppad=_.ppad=s);var b=2>d||r[0]!==r[d-1]||l[0]!==l[d-1];b&&("tozerox"===f||"tonextx"===f&&(h||"h"===y))?x.tozero=!0:!(t.error_y||{}).visible&&("tonexty"===f||"tozeroy"===f||!g.hasMarkers(t)&&!g.hasText(t))&&(x.padded=!1,x.ppad=0),b&&("tozeroy"===f||"tonexty"===f&&(h||"v"===y))?_.tozero=!0:("tonextx"===f||"tozerox"===f)&&(_.padded=!1),u&&(t._extremes[u]=p.findExtremes(a,r,x)),m&&(t._extremes[m]=p.findExtremes(o,l,_))}function o(e,t){if(g.hasMarkers(e)){var a=e.marker,o=1.6*(e.marker.sizeref||1),r;if(r="area"===e.marker.sizemode?function(e){return s(l((e||0)/o),3)}:function(e){return s((e||0)/o,3)},c.isArrayOrTypedArray(a.size)){var n={type:"linear"};p.setConvert(n);for(var d=n.makeCalcdata(e.marker,"size"),u=Array(t),m=0;m<t;m++)u[m]=r(d[m]);return u}return r(a.size)}}function r(e,t){var a=i(t),o=e._firstScatter;o[a]||(o[a]=t.uid)}function i(e){var t=e.stackgroup;return e.xaxis+e.yaxis+e.type+(t?"-"+t:"")}function n(e,t,a,o){var r=e.stackgroup;if(r){var i=t._scatterStackOpts[a._id+o._id][r],n="v"===i.orientation?o:a;if("linear"===n.type||"log"===n.type)return i}}var d=e("fast-isnumeric"),c=e("../../lib"),p=e("../../plots/cartesian/axes"),u=e("../../constants/numerical").BADNUM,g=e("./subtypes"),h=e("./colorscale_calc"),f=e("./arrays_to_calcdata"),_=e("./calc_selection");t.exports={calc:function(e,t){var l=e._fullLayout,s=p.getFromId(e,t.xaxis||"x"),g=p.getFromId(e,t.yaxis||"y"),b=s.makeCalcdata(t,"x"),x=g.makeCalcdata(t,"y"),y=t._length,v=Array(y),w=t.ids,T=n(t,l,s,g),A=!1,S,C,L,E,I,P;r(l,t);var z="x",D="y",O;if(T)c.pushUnique(T.traceIndices,t._expandedIndex),S="v"===T.orientation,S?(D="s",O="x"):(z="s",O="y"),I="interpolate"===T.stackgaps;else{var R=o(t,y);a(e,t,s,g,b,x,R)}for(C=0;C<y;C++){var M=v[C]={},B=d(b[C]),F=d(x[C]);B&&F?(M[z]=b[C],M[D]=x[C]):T&&(S?B:F)?(M[O]=S?b[C]:x[C],M.gap=!0,I?(M.s=u,A=!0):M.s=0):M[z]=M[D]=u,w&&(M.id=w[C]+"")}if(f(v,t),h(e,t),_(v,t),T){for(C=0;C<v.length;)v[C][O]===u?v.splice(C,1):C++;if(c.sort(v,function(e,t){return e[O]-t[O]||e.i-t.i}),A){for(C=0;C<v.length-1&&v[C].gap;)C++;for(P=v[C].s,P||(P=v[C].s=0),L=0;L<C;L++)v[L].s=P;for(E=v.length-1;E>C&&v[E].gap;)E--;for(P=v[E].s,L=v.length-1;L>E;L--)v[L].s=P;for(;C<E;)if(C++,v[C].gap){for(L=C+1;v[L].gap;)L++;for(var N=v[C-1][O],V=v[C-1].s,U=(v[L].s-V)/(v[L][O]-N);C<L;)v[C].s=V+(v[C][O]-N)*U,C++}}}return v},calcMarkerSize:o,calcAxisExpansion:a,setFirstScatter:r,getStackOpts:n}},{"../../constants/numerical":633,"../../lib":657,"../../plots/cartesian/axes":705,"./arrays_to_calcdata":1061,"./calc_selection":1064,"./colorscale_calc":1065,"./subtypes":1086,"fast-isnumeric":201}],1064:[function(e,t){'use strict';var a=e("../../lib");t.exports=function(e,t){a.isArrayOrTypedArray(t.selectedpoints)&&a.tagSelected(e,t)}},{"../../lib":657}],1065:[function(e,t){'use strict';var a=e("../../components/colorscale/helpers").hasColorscale,o=e("../../components/colorscale/calc"),r=e("./subtypes");t.exports=function(e,t){r.hasLines(t)&&a(t,"line")&&o(e,t,{vals:t.line.color,containerStr:"line",cLetter:"c"}),r.hasMarkers(t)&&(a(t,"marker")&&o(e,t,{vals:t.marker.color,containerStr:"marker",cLetter:"c"}),a(t,"marker.line")&&o(e,t,{vals:t.marker.line.color,containerStr:"marker.line",cLetter:"c"}))}},{"../../components/colorscale/calc":532,"../../components/colorscale/helpers":535,"./subtypes":1086}],1066:[function(e,t){'use strict';t.exports={PTS_LINESONLY:20,minTolerance:.2,toleranceGrowth:10,maxScreensAway:20,eventDataKeys:[]}},{}],1067:[function(e,t){'use strict';function a(e,t,a,r,i,n,l){i[r]=!0;var s={i:null,gap:!0,s:0};if(s[l]=a,e.splice(t,0,s),t&&a===e[t-1][l]){var d=e[t-1];s.s=d.s,s.i=d.i,s.gap=d.gap}else n&&(s.s=o(e,t,a,l));t||(e[0].t=e[1].t,e[0].trace=e[1].trace,delete e[1].t,delete e[1].trace)}function o(e,t,a,o){var r=e[t-1],i=e[t+1];return i?r?r.s+(i.s-r.s)*(a-r[o])/(i[o]-r[o]):i.s:r.s}var r=e("./calc");t.exports=function(e,t){var o=t.xaxis,n=t.yaxis,l=o._id+n._id,s=e._fullLayout._scatterStackOpts[l];if(s){var d=e.calcdata,c,p,u,g,m,h,f,_,b,v,w,T,A,S,C;for(var L in s){v=s[L];var E=v.traceIndices;if(E.length){for(w="interpolate"===v.stackgaps,T=v.groupnorm,"v"===v.orientation?(A="x",S="y"):(A="y",S="x"),C=Array(E.length),c=0;c<C.length;c++)C[c]=!1;h=d[E[0]];var I=Array(h.length);for(c=0;c<h.length;c++)I[c]=h[c][A];for(c=1;c<E.length;c++){for(m=d[E[c]],p=u=0;p<m.length;p++){for(f=m[p][A];f>I[u]&&u<I.length;u++)a(m,p,I[u],c,C,w,A),p++;if(f!==I[u]){for(g=0;g<c;g++)a(d[E[g]],u,f,g,C,w,A);I.splice(u,0,f)}u++}for(;u<I.length;u++)a(m,p,I[u],c,C,w,A),p++}var P=I.length;for(p=0;p<h.length;p++){for(_=h[p][S]=h[p].s,c=1;c<E.length;c++)m=d[E[c]],m[0].trace._rawLength=m[0].trace._length,m[0].trace._length=P,_+=m[p].s,m[p][S]=_;if(T)for(b=("fraction"===T?_:_/100)||1,c=0;c<E.length;c++){var z=d[E[c]][p];z[S]/=b,z.sNorm=z.s/b}}for(c=0;c<E.length;c++){m=d[E[c]];var D=m[0].trace,O=r.calcMarkerSize(D,D._rawLength),R=Array.isArray(O);if(O&&C[c]||R){var M=O;for(O=Array(P),p=0;p<P;p++)O[p]=m[p].gap?0:R?M[m[p].i]:M}var B=Array(P),x=Array(P);for(p=0;p<P;p++)B[p]=m[p].x,x[p]=m[p].y;r.calcAxisExpansion(e,D,o,n,B,x,O),m[0].t.orientation=v.orientation}}}}}},{"./calc":1063}],1068:[function(e,t){'use strict';t.exports=function(e){for(var t=0,a;t<e.length;t++)if(a=e[t],"scatter"===a.type){var o=a.fill;if("none"!==o&&"toself"!==o&&(a.opacity=void 0,"tonexty"===o||"tonextx"===o))for(var r=t-1,n;0<=r;r--)if(n=e[r],"scatter"===n.type&&n.xaxis===a.xaxis&&n.yaxis===a.yaxis){n.opacity=void 0;break}}}},{}],1069:[function(e,t){'use strict';var a=e("../../lib"),o=e("../../registry"),r=e("./attributes"),i=e("./constants"),n=e("./subtypes"),l=e("./xy_defaults"),s=e("./stack_defaults"),d=e("./marker_defaults"),c=e("./line_defaults"),p=e("./line_shape_defaults"),u=e("./text_defaults"),g=e("./fillcolor_defaults");t.exports=function(e,t,m,h){function y(o,i){return a.coerce(e,t,r,o,i)}var f=l(e,t,h,y);if(f||(t.visible=!1),!!t.visible){var x=s(e,t,h,y),_=!x&&f<i.PTS_LINESONLY?"lines+markers":"lines";y("text"),y("hovertext"),y("mode",_),n.hasLines(t)&&(c(e,t,m,h,y),p(e,t,y),y("connectgaps"),y("line.simplify")),n.hasMarkers(t)&&d(e,t,m,h,y,{gradient:!0}),n.hasText(t)&&(y("texttemplate"),u(e,t,h,y));var b=[];(n.hasMarkers(t)||n.hasText(t))&&(y("cliponaxis"),y("marker.maxdisplayed"),b.push("points")),y("fill",x?x.fillDflt:"none"),"none"!==t.fill&&(g(e,t,m,y),!n.hasLines(t)&&p(e,t,y));var v=(t.line||{}).color,w=(t.marker||{}).color;("tonext"===t.fill||"toself"===t.fill)&&b.push("fills"),y("hoveron",b.join("+")||"points"),"fills"!==t.hoveron&&y("hovertemplate");var k=o.getComponentMethod("errorbars","supplyDefaults");k(e,t,v||w||m,{axis:"y"}),k(e,t,v||w||m,{axis:"x",inherit:"y"}),a.coerceSelectionMarkerOpacity(t,y)}}},{"../../lib":657,"../../registry":788,"./attributes":1062,"./constants":1066,"./fillcolor_defaults":1070,"./line_defaults":1075,"./line_shape_defaults":1077,"./marker_defaults":1081,"./stack_defaults":1084,"./subtypes":1086,"./text_defaults":1087,"./xy_defaults":1088}],1070:[function(e,t){'use strict';var a=e("../../components/color"),o=e("../../lib").isArrayOrTypedArray;t.exports=function(e,t,r,i){var n=!1;if(t.marker){var l=t.marker.color,s=(t.marker.line||{}).color;l&&!o(l)?n=l:s&&!o(s)&&(n=s)}i("fillcolor",a.addOpacity((t.line||{}).color||n||r,.5))}},{"../../components/color":524,"../../lib":657}],1071:[function(e,t){'use strict';var a=e("../../plots/cartesian/axes");t.exports=function(e,t,o){var r={},i={_fullLayout:o},n=a.getFromTrace(i,t,"x"),l=a.getFromTrace(i,t,"y");return r.xLabel=a.tickText(n,e.x,!0).text,r.yLabel=a.tickText(l,e.y,!0).text,r}},{"../../plots/cartesian/axes":705}],1072:[function(e,t){'use strict';var a=e("../../components/color"),o=e("./subtypes");t.exports=function(e,t){var r,i;if("lines"===e.mode)return r=e.line.color,r&&a.opacity(r)?r:e.fillcolor;if("none"===e.mode)return e.fill?e.fillcolor:"";var n=t.mcc||(e.marker||{}).color,l=t.mlcc||((e.marker||{}).line||{}).color;return i=n&&a.opacity(n)?n:l&&a.opacity(l)&&(t.mlw||((e.marker||{}).line||{}).width)?l:"",i?.3>a.opacity(i)?a.addOpacity(i,.3):i:(r=(e.line||{}).color,r&&a.opacity(r)&&o.hasLines(e)&&e.line.width?r:e.fillcolor)}},{"../../components/color":524,"./subtypes":1086}],1073:[function(e,t){'use strict';var a=Math.sqrt,o=Math.min,r=Math.abs,n=Math.max,l=e("../../lib"),s=e("../../components/fx"),i=e("../../registry"),d=e("./get_trace_color"),c=e("../../components/color"),p=l.fillText;t.exports=function(e,t,u,g){var m=e.cd,h=m[0].trace,y=e.xa,f=e.ya,x=y.c2p(t),_=f.c2p(u),b=[x,_],v=h.hoveron||"",w=-1===h.mode.indexOf("markers")?.5:3;if(-1!==v.indexOf("points")){var k=function(e){var t=n(3,e.mrc||0),a=1-1/t,o=r(y.c2p(e.x)-x),i=o<t?a*o/t:o-t+a;return i},T=function(e){var t=n(3,e.mrc||0),a=1-1/t,o=r(f.c2p(e.y)-_);return o<t?a*o/t:o-t+a},A=function(e){var t=n(w,e.mrc||0),o=y.c2p(e.x)-x,r=f.c2p(e.y)-_;return n(a(o*o+r*r)-t,1-w/t)},S=s.getDistanceFunction(g,k,T,A);if(s.getClosest(m,S,e),!1!==e.index){var C=m[e.index],L=y.c2p(C.x,!0),E=f.c2p(C.y,!0),I=C.mrc||1;e.index=C.i;var P=m[0].t.orientation,z=P&&(C.sNorm||C.s),D="h"===P?z:C.x,O="v"===P?z:C.y;return l.extendFlat(e,{color:d(h,C),x0:L-I,x1:L+I,xLabelVal:D,y0:E-I,y1:E+I,yLabelVal:O,spikeDistance:A(C),hovertemplate:h.hovertemplate}),p(C,h,e),i.getComponentMethod("errorbars","hoverInfo")(C,h,e),[e]}}if(-1!==v.indexOf("fills")&&h._polygons){var R=h._polygons,M=[],B=!1,F=1/0,N=-Infinity,V=1/0,U=-Infinity,H,q,G,Y,W,X,Z,K,$;for(H=0;H<R.length;H++)G=R[H],G.contains(b)&&(B=!B,M.push(G),V=o(V,G.ymin),U=n(U,G.ymax));if(B){V=n(V,0),U=o(U,f._length);var J=(V+U)/2;for(H=0;H<M.length;H++)for(Y=M[H].pts,q=1;q<Y.length;q++)K=Y[q-1][1],$=Y[q][1],K>J!=$>=J&&(X=Y[q-1][0],Z=Y[q][0],$-K&&(W=X+(Z-X)*(J-K)/($-K),F=o(F,W),N=n(N,W)));F=n(F,0),N=o(N,y._length);var Q=c.defaultLine;return c.opacity(h.fillcolor)?Q=h.fillcolor:c.opacity((h.line||{}).color)&&(Q=h.line.color),l.extendFlat(e,{distance:e.maxHoverDistance,x0:F,x1:N,y0:J,y1:J,color:Q,hovertemplate:!1}),delete e.index,e.text=h.text&&!Array.isArray(h.text)?h.text+"":h.name,[e]}}}},{"../../components/color":524,"../../components/fx":564,"../../lib":657,"../../registry":788,"./get_trace_color":1072}],1074:[function(e,t){'use strict';var a=e("./subtypes");t.exports={hasLines:a.hasLines,hasMarkers:a.hasMarkers,hasText:a.hasText,isBubble:a.isBubble,attributes:e("./attributes"),supplyDefaults:e("./defaults"),crossTraceDefaults:e("./cross_trace_defaults"),calc:e("./calc").calc,crossTraceCalc:e("./cross_trace_calc"),arraysToCalcdata:e("./arrays_to_calcdata"),plot:e("./plot"),colorbar:e("./marker_colorbar"),formatLabels:e("./format_labels"),style:e("./style").style,styleOnSelect:e("./style").styleOnSelect,hoverPoints:e("./hover"),selectPoints:e("./select"),animatable:!0,moduleType:"trace",name:"scatter",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","symbols","errorBarsOK","showLegend","scatter-like","zoomScale"],meta:{}}},{"../../plots/cartesian":718,"./arrays_to_calcdata":1061,"./attributes":1062,"./calc":1063,"./cross_trace_calc":1067,"./cross_trace_defaults":1068,"./defaults":1069,"./format_labels":1071,"./hover":1073,"./marker_colorbar":1080,"./plot":1082,"./select":1083,"./style":1085,"./subtypes":1086}],1075:[function(e,t){'use strict';var a=e("../../lib").isArrayOrTypedArray,o=e("../../components/colorscale/helpers").hasColorscale,r=e("../../components/colorscale/defaults");t.exports=function(e,t,i,n,l,s){var d=(e.marker||{}).color;if(l("line.color",i),o(e,"line"))r(e,t,n,l,{prefix:"line.",cLetter:"c"});else{var c=!a(d)&&d||i;l("line.color",c)}l("line.width"),(s||{}).noDash||l("line.dash")}},{"../../components/colorscale/defaults":534,"../../components/colorscale/helpers":535,"../../lib":657}],1076:[function(e,t){'use strict';var a=Math.min,o=Math.abs,r=Math.max,i=e("../../constants/numerical"),n=i.BADNUM,l=i.LOG_CLIP,s=l+.5,d=l-.5,c=e("../../lib"),p=c.segmentsIntersect,u=c.constrain,g=e("./constants");t.exports=function(e,t){function l(a){var r=e[a];if(!r)return!1;var i=t.linearized?S.l2p(r.x):S.c2p(r.x),l=t.linearized?C.l2p(r.y):C.c2p(r.y);if(i===n){if(L&&(i=S.c2p(r.x,!0)),i===n)return!1;E&&l===n&&(i*=o(S._m*P*(0<S._m?s:d)/(C._m*I*(0<C._m?s:d)))),i*=1e3}if(l===n){if(E&&(l=C.c2p(r.y,!0)),l===n)return!1;l*=1e3}return[i,l]}function m(e,t,a,o){var r=a-e,i=o-t,n=.5-e,l=.5-t,s=r*r+i*i,d=r*n+i*l;if(0<d&&d<s){var c=n*i-l*r;if(c*c<s)return!0}}function h(e,t){var a=e[0]/I,o=e[1]/P,i=r(0,-a,a-1,-o,o-1);return i&&void 0!==de&&m(a,o,de,ce)&&(i=0),i&&t&&m(a,o,t[0]/I,t[1]/P)&&(i=0),(1+g.toleranceGrowth*i)*D}function y(e,t){var a=e[0]-t[0],o=e[1]-t[1];return Math.sqrt(a*a+o*o)}function f(e,t){for(var a=[],r=0,n=0;4>n;n++){var l=Y[n],s=p(e[0],e[1],t[0],t[1],l[0],l[1],l[2],l[3]);s&&(!r||1<o(s.x-a[0][0])||1<o(s.y-a[0][1]))&&(s=[s.x,s.y],r&&y(s,e)<y(a[0],e)?a.unshift(s):a.push(s),r++)}return a}function x(e){if(e[0]<U||e[0]>H||e[1]<q||e[1]>G)return[u(e[0],U,H),u(e[1],q,G)]}function _(e,t){return!(e[0]!==t[0]||e[0]!==U&&e[0]!==H)||!(e[1]!==t[1]||e[1]!==q&&e[1]!==G)||void 0}function b(e,t){var a=[],o=x(e),r=x(t);return o&&r&&_(o,r)?a:(o&&a.push(o),r&&a.push(r),a)}function v(e,t,a){return function(o,r){var i=x(o),n=x(r),l=[];if(i&&n&&_(i,n))return l;i&&l.push(i),n&&l.push(n);var s=2*c.constrain((o[e]+r[e])/2,t,a)-((i||o)[e]+(n||r)[e]);if(s){var d;d=i&&n?0<s==i[e]>n[e]?i:n:i||n,d[e]+=s}return l}}function w(e,t){var a=t[0]-e[0],o=(t[1]-e[1])/a,r=(e[1]*t[0]-t[1]*e[0])/a;return 0<r?[0<o?U:H,G]:[0<o?H:U,q]}function k(e){var t=e[0],a=e[1],o=t===F[N-1][0],r=a===F[N-1][1];if(!(o&&r))if(1<N){var i=t===F[N-2][0],n=a===F[N-2][1];o&&(t===U||t===H)&&i?n?N--:F[N-1]=e:r&&(a===q||a===G)&&n?i?N--:F[N-1]=e:F[N++]=e}else F[N++]=e}function T(e){F[N-1][0]!==e[0]&&F[N-1][1]!==e[1]&&k([ge,me]),k(e),he=null,ge=me=0}function A(e){if(de=e[0]/I,ce=e[1]/P,pe=e[0]<U?U:e[0]>H?H:0,ue=e[1]<q?q:e[1]>G?G:0,pe||ue){if(!N)F[N++]=[pe||e[0],ue||e[1]];else if(he){var t=fe(he,e);1<t.length&&(T(t[0]),F[N++]=t[1])}else ye=fe(F[N-1],e)[0],F[N++]=ye;var a=F[N-1];pe&&ue&&(a[0]!==pe||a[1]!==ue)?(he&&(ge!==pe&&me!==ue?ge&&me?k(w(he,e)):k([ge||pe,me||ue]):ge&&me&&k([ge,me])),k([pe,ue])):ge-pe&&me-ue&&k([pe||ge,ue||me]),he=e,ge=pe,me=ue}else he&&T(fe(he,e)[0]),F[N++]=e}var S=t.xaxis,C=t.yaxis,L="log"===S.type,E="log"===C.type,I=S._length,P=C._length,z=t.connectGaps,D=t.baseTolerance,O=t.shape,R=t.fill&&"none"!==t.fill,M=[],j=g.minTolerance,B=e.length,F=Array(B),N=0,V=g.maxScreensAway,U=-I*V,H=I*(1+V),q=-P*V,G=P*(1+V),Y=[[U,q,H,q],[H,q,H,G],[H,G,U,G],[U,G,U,q]],W,X,Z,K,$,J,Q,ee,te,ae,oe,re,ie,ne,le,se,de,ce,pe,ue,ge,me,he,ye,fe;for("linear"===O||"spline"===O?fe=f:"hv"===O||"vh"===O?fe=b:"hvh"===O?fe=v(0,U,H):"vhv"===O&&(fe=v(1,q,G)),W=0;W<B;W++)if(X=l(W),X){for(N=0,he=null,A(X),W++;W<B;W++){if(K=l(W),!K)if(z)continue;else break;if(!("linear"===O)||!t.simplify){A(K);continue}var xe=l(W+1);if(ae=y(K,X),R&&(0===N||N===B-1)||!(ae<h(K,xe)*j)){for(ee=[(K[0]-X[0])/ae,(K[1]-X[1])/ae],$=X,oe=ae,re=ne=le=0,Q=!1,Z=K,W++;W<e.length;W++){if(J=xe,xe=l(W+1),!J)if(z)continue;else break;if(te=[J[0]-X[0],J[1]-X[1]],se=te[0]*ee[1]-te[1]*ee[0],ne=a(ne,se),le=r(le,se),le-ne>h(J,xe))break;Z=J,ie=te[0]*ee[0]+te[1]*ee[1],ie>oe?(oe=ie,K=J,Q=!1):ie<re&&(re=ie,$=J,Q=!0)}if(Q?(A(K),Z!==$&&A($)):($!==X&&A($),Z!==K&&A(K)),A(Z),W>=e.length||!J)break;A(J),X=J}}he&&k([ge||he[0],me||he[1]]),M.push(F.slice(0,N))}return M}},{"../../constants/numerical":633,"../../lib":657,"./constants":1066}],1077:[function(e,t){'use strict';t.exports=function(e,t,a){var o=a("line.shape");"spline"===o&&a("line.smoothing")}},{}],1078:[function(e,t){'use strict';var a={tonextx:1,tonexty:1,tonext:1};t.exports=function(e,t,o){var r={},n=!1,l=-1,s=0,d=-1,c,p,u,g,m;for(p=0;p<o.length;p++)c=o[p][0].trace,u=c.stackgroup||"",u?u in r?m=r[u]:(m=r[u]=s,s++):c.fill in a&&0<=d?m=d:(m=d=s,s++),m<l&&(n=!0),c._groupIndex=l=m;var h=o.slice();n&&h.sort(function(e,t){var a=e[0].trace,o=t[0].trace;return a._groupIndex-o._groupIndex||a.index-o.index});var y={};for(p=0;p<h.length;p++)c=h[p][0].trace,u=c.stackgroup||"",!0===c.visible?(c._nexttrace=null,c.fill in a&&(g=y[u],c._prevtrace=g||null,g&&(g._nexttrace=c)),c._ownfill=c.fill&&("tozero"===c.fill.substr(0,6)||"toself"===c.fill||"to"===c.fill.substr(0,2)&&!c._prevtrace),y[u]=c):c._prevtrace=c._nexttrace=c._ownfill=null;return h}},{}],1079:[function(e,t){'use strict';var a=e("fast-isnumeric");t.exports=function(e){var t=e.marker,o=t.sizeref||1,r=t.sizemin||0,i="area"===t.sizemode?function(e){return Math.sqrt(e/o)}:function(e){return e/o};return function(e){var t=i(e/2);return a(t)&&0<t?Math.max(t,r):0}}},{"fast-isnumeric":201}],1080:[function(e,t){'use strict';t.exports={container:"marker",min:"cmin",max:"cmax"}},{}],1081:[function(e,t){'use strict';var a=e("../../components/color"),o=e("../../components/colorscale/helpers").hasColorscale,r=e("../../components/colorscale/defaults"),i=e("./subtypes");t.exports=function(e,t,n,l,s,d){var c=i.isBubble(e),p=(e.line||{}).color,u;if(d=d||{},p&&(n=p),s("marker.symbol"),s("marker.opacity",c?.7:1),s("marker.size"),s("marker.color",n),o(e,"marker")&&r(e,t,l,s,{prefix:"marker.",cLetter:"c"}),d.noSelect||(s("selected.marker.color"),s("unselected.marker.color"),s("selected.marker.size"),s("unselected.marker.size")),d.noLine||(u=p&&!Array.isArray(p)&&t.marker.color!==p?p:c?a.background:a.defaultLine,s("marker.line.color",u),o(e,"marker.line")&&r(e,t,l,s,{prefix:"marker.line.",cLetter:"c"}),s("marker.line.width",c?1:0)),c&&(s("marker.sizeref"),s("marker.sizemin"),s("marker.sizemode")),d.gradient){var g=s("marker.gradient.type");"none"!==g&&s("marker.gradient.color")}}},{"../../components/color":524,"../../components/colorscale/defaults":534,"../../components/colorscale/helpers":535,"./subtypes":1086}],1082:[function(e,t){'use strict';var i=Math.ceil,n=Math.round,l=Math.max,s=Math.floor;function a(e,t,a){t.each(function(t){var o=u(c.select(this),"g","fills");m.setClipUrl(o,a.layerClipId,e);var r=t[0].trace,i=[];r._ownfill&&i.push("_ownFill"),r._nexttrace&&i.push("_nextFill");var n=o.selectAll("g").data(i,g);n.enter().append("g"),n.exit().each(function(e){r[e]=null}).remove(),n.order().each(function(e){r[e]=u(c.select(this),"path","js-fill")})})}function o(e,t,a,o,n,s,f){function _(e){return E?e.transition():e}function b(e){_(e).attr("d","M0,0Z")}function v(e){return e.filter(function(e){return!e.gap&&e.vis})}function w(e){return e.filter(function(e){return e.vis})}function k(e){return e.filter(function(e){return!e.gap})}function T(e){return e.id}function A(e){if(e.ids)return T}function S(){return!1}function C(t,o,r){var i=r[0].trace,n=h.hasMarkers(i),l=h.hasText(i),s=A(i),d=S,p=S,u,y,f;if(n||l){var x=g,b=i.stackgroup,T=b&&"infer zero"===e._fullLayout._scatterStackOpts[I._id+P._id][b].stackgaps;i.marker.maxdisplayed||i._needsCull?x=T?w:v:b&&!T&&(x=k),n&&(d=x),l&&(p=x)}y=t.selectAll("path.point"),u=y.data(d,s);var C=u.enter().append("path").classed("point",!0);E&&C.call(m.pointStyle,i,e).call(m.translatePoints,I,P).style("opacity",0).transition().style("opacity",1),u.order();var L;n&&(L=m.makePointStyleFns(i)),u.each(function(t){var o=c.select(this),r=_(o);f=m.translatePoint(t,r,I,P),f?(m.singlePointStyle(t,r,i,L,e),a.layerClipId&&m.hideOutsideRangePoint(t,r,I,P,i.xcalendar,i.ycalendar),i.customdata&&o.classed("plotly-customdata",null!==t.data&&void 0!==t.data)):r.remove()}),E?u.exit().transition().style("opacity",0).remove():u.exit().remove(),y=o.selectAll("g"),u=y.data(p,s),u.enter().append("g").classed("textpoint",!0).append("text"),u.order(),u.each(function(e){var t=c.select(this),o=_(t.select("text"));f=m.translatePoint(e,o,I,P),f?a.layerClipId&&m.hideOutsideRangePoint(e,t,I,P,i.xcalendar,i.ycalendar):t.remove()}),u.selectAll("text").call(m.textPointStyle,i,e).each(function(e){var t=I.c2p(e.x),a=P.c2p(e.y);c.select(this).selectAll("tspan.line").each(function(){_(c.select(this)).attr({x:t,y:a})})}),u.exit().remove()}var L;r(e,t,a,o,n);var E=!!f&&0<f.duration,I=a.xaxis,P=a.yaxis,z=o[0].trace,D=z.line,O=c.select(s),R=u(O,"g","errorbars"),M=u(O,"g","lines"),j=u(O,"g","points"),B=u(O,"g","text");if(d.getComponentMethod("errorbars","plot")(e,R,a,f),!0===z.visible){_(O).style("opacity",z.opacity);var F=z.fill.charAt(z.fill.length-1),N,V;"x"!==F&&"y"!==F&&(F=""),o[0][a.isRangePlot?"nodeRangePlot3":"node3"]=O;var U="",H=[],q=z._prevtrace;q&&(U=q._prevRevpath||"",V=q._nextFill,H=q._polygons);var G="",Y="",W=[],X=p.noop,Z,K,$,J,Q,ee,te,ae,oe;if(N=z._ownFill,h.hasLines(z)||"none"!==z.fill){for(V&&V.datum(o),-1===["hv","vh","hvh","vhv"].indexOf(D.shape)?"spline"===D.shape?$=J=function(e){var t=e[e.length-1];return 1<e.length&&e[0][0]===t[0]&&e[0][1]===t[1]?m.smoothclosed(e.slice(1),D.smoothing):m.smoothopen(e,D.smoothing)}:$=J=function(e){return"M"+e.join("L")}:($=m.steps(D.shape),J=m.steps(D.shape.split("").reverse().join(""))),Q=function(e){return J(e.reverse())},W=y(o,{xaxis:I,yaxis:P,connectGaps:z.connectgaps,baseTolerance:l(D.width||1,3)/4,shape:D.shape,simplify:D.simplify,fill:z.fill}),oe=z._polygons=Array(W.length),L=0;L<W.length;L++)z._polygons[L]=x(W[L]);W.length&&(ee=W[0][0],te=W[W.length-1],ae=te[te.length-1]),X=function(e){return function(t){if(Z=$(t),K=Q(t),G?F?(G+="L"+Z.substr(1),Y=K+("L"+Y.substr(1))):(G+="Z"+Z,Y=K+"Z"+Y):(G=Z,Y=K),h.hasLines(z)&&1<t.length){var a=c.select(this);if(a.datum(o),e)_(a.style("opacity",0).attr("d",Z).call(m.lineGroupStyle)).style("opacity",1);else{var r=_(a);r.attr("d",Z),m.singleLineStyle(o,r)}}}}}var re=M.selectAll(".js-line").data(W);_(re.exit()).style("opacity",0).remove(),re.each(X(!1)),re.enter().append("path").classed("js-line",!0).style("vector-effect","non-scaling-stroke").call(m.lineGroupStyle).each(X(!0)),m.setClipUrl(re,a.layerClipId,e),W.length?(N?(N.datum(o),ee&&ae&&(F?("y"===F?ee[1]=ae[1]=P.c2p(0,!0):"x"===F&&(ee[0]=ae[0]=I.c2p(0,!0)),_(N).attr("d","M"+ae+"L"+ee+"L"+G.substr(1)).call(m.singleFillStyle)):_(N).attr("d",G+"Z").call(m.singleFillStyle))):V&&("tonext"===z.fill.substr(0,6)&&G&&U?("tonext"===z.fill?_(V).attr("d",G+"Z"+U+"Z").call(m.singleFillStyle):_(V).attr("d",G+"L"+U.substr(1)+"Z").call(m.singleFillStyle),z._polygons=z._polygons.concat(H)):(b(V),z._polygons=null)),z._prevRevpath=Y,z._prevPolygons=oe):(N?b(N):V&&b(V),z._polygons=z._prevRevpath=z._prevPolygons=null),j.datum(o),B.datum(o),C(j,B,o);var ie=!1===z.cliponaxis,ne=ie?null:a.layerClipId;m.setClipUrl(j,ne,e),m.setClipUrl(B,ne,e)}}function r(e,t,a,o,r){var l=a.xaxis,d=a.yaxis,u=c.extent(p.simpleMap(l.range,l.r2c)),g=c.extent(p.simpleMap(d.range,d.r2c)),m=o[0].trace;if(h.hasMarkers(m)){var y=m.marker.maxdisplayed;if(0!==y){var f=o.filter(function(e){return e.x>=u[0]&&e.x<=u[1]&&e.y>=g[0]&&e.y<=g[1]}),x=i(f.length/y),_=0;r.forEach(function(e,a){var o=e[0].trace;h.hasMarkers(o)&&0<o.marker.maxdisplayed&&a<t&&_++});var b=n(_*x/3+s(_/3)*x/7.1);o.forEach(function(e){delete e.vis}),f.forEach(function(e,t){0===n((t+b)%x)&&(e.vis=!0)})}}}var c=e("d3"),d=e("../../registry"),p=e("../../lib"),u=p.ensureSingle,g=p.identity,m=e("../../components/drawing"),h=e("./subtypes"),y=e("./line_points"),f=e("./link_traces"),x=e("../../lib/polygon").tester;t.exports=function(e,t,r,i,n,l){var s=!!n&&0<n.duration,p=f(e,t,r),u,g;if(u=i.selectAll("g.trace").data(p,function(e){return e[0].trace.uid}),u.enter().append("g").attr("class",function(e){return"trace scatter trace"+e[0].trace.uid}).style("stroke-miterlimit",2),u.order(),a(e,u,t),s){l&&(g=l());var m=c.transition().duration(n.duration).ease(n.easing).each("end",function(){g&&g()}).each("interrupt",function(){g&&g()});m.each(function(){i.selectAll("g.trace").each(function(a,r){o(e,r,t,a,p,this,n)})})}else u.each(function(a,r){o(e,r,t,a,p,this,n)});!n&&u.exit().remove(),i.selectAll("path:not([d])").remove()}},{"../../components/drawing":546,"../../lib":657,"../../lib/polygon":669,"../../registry":788,"./line_points":1076,"./link_traces":1078,"./subtypes":1086,d3:108}],1083:[function(e,t){'use strict';var a=e("./subtypes");t.exports=function(e,t){var o=e.cd,r=e.xaxis,n=e.yaxis,l=[],s=o[0].trace,d=!a.hasMarkers(s)&&!a.hasText(s),c,p,u,g;if(d)return[];if(!1===t)for(c=0;c<o.length;c++)o[c].selected=0;else for(c=0;c<o.length;c++)p=o[c],u=r.c2p(p.x),g=n.c2p(p.y),null!==p.i&&t.contains([u,g],!1,c,e)?(l.push({pointNumber:p.i,x:r.c2d(p.x),y:n.c2d(p.y)}),p.selected=1):p.selected=0;return l}},{"./subtypes":1086}],1084:[function(e,t){'use strict';var a=["orientation","groupnorm","stackgaps"];t.exports=function(e,t,o,r){var n=o._scatterStackOpts,l=r("stackgroup");if(l){var s=t.xaxis+t.yaxis,d=n[s];d||(d=n[s]={});var c=d[l],p=!1;c?c.traces.push(t):(c=d[l]={traceIndices:[],traces:[t]},p=!0);for(var u={orientation:t.x&&!t.y?"h":"v"},g=0;g<a.length;g++){var m=a[g],h=m+"Found";if(!c[h]){var y=e[m]!==void 0,f="orientation"===m;if((y||p)&&(c[m]=r(m,u[m]),f&&(c.fillDflt="h"===c[m]?"tonextx":"tonexty"),y&&(c[h]=!0,!p&&(delete c.traces[0][m],f))))for(var x=0,_;x<c.traces.length-1;x++)_=c.traces[x],_._input.fill!==_.fill&&(_.fill=c.fillDflt)}}return c}}},{}],1085:[function(e,t){'use strict';function a(e,t,a){i.pointStyle(e.selectAll("path.point"),t,a)}function o(e,t,a){i.textPointStyle(e.selectAll("text"),t,a)}var r=e("d3"),i=e("../../components/drawing"),n=e("../../registry");t.exports={style:function(e){var t=r.select(e).selectAll("g.trace.scatter");t.style("opacity",function(e){return e[0].trace.opacity}),t.selectAll("g.points").each(function(t){var o=r.select(this),i=t.trace||t[0].trace;a(o,i,e)}),t.selectAll("g.text").each(function(t){var a=r.select(this),i=t.trace||t[0].trace;o(a,i,e)}),t.selectAll("g.trace path.js-line").call(i.lineGroupStyle),t.selectAll("g.trace path.js-fill").call(i.fillGroupStyle),n.getComponentMethod("errorbars","style")(t)},stylePoints:a,styleText:o,styleOnSelect:function(e,t,r){var n=t[0].trace;n.selectedpoints?(i.selectedPointStyle(r.selectAll("path.point"),n),i.selectedTextStyle(r.selectAll("text"),n)):(a(r,n,e),o(r,n,e))}}},{"../../components/drawing":546,"../../registry":788,d3:108}],1086:[function(e,t){'use strict';var a=e("../../lib");t.exports={hasLines:function(e){return e.visible&&e.mode&&-1!==e.mode.indexOf("lines")},hasMarkers:function(e){return e.visible&&(e.mode&&-1!==e.mode.indexOf("markers")||"splom"===e.type)},hasText:function(e){return e.visible&&e.mode&&-1!==e.mode.indexOf("text")},isBubble:function(e){return a.isPlainObject(e.marker)&&a.isArrayOrTypedArray(e.marker.size)}}},{"../../lib":657}],1087:[function(e,t){'use strict';var a=e("../../lib");t.exports=function(e,t,o,r,i){i=i||{},r("textposition"),a.coerceFont(r,"textfont",o.font),i.noSelect||(r("selected.textfont.color"),r("unselected.textfont.color"))}},{"../../lib":657}],1088:[function(e,t){'use strict';var a=Math.min,o=e("../../lib"),r=e("../../registry");t.exports=function(e,t,i,n){var l=n("x"),s=n("y"),d=r.getComponentMethod("calendars","handleTraceDefaults"),c;if(d(e,t,["x","y"],i),l){var p=o.minRowLength(l);s?c=a(p,o.minRowLength(s)):(c=p,n("y0"),n("dy"))}else{if(!s)return 0;c=o.minRowLength(s),n("x0"),n("dx")}return t._length=c,c}},{"../../lib":657,"../../registry":788}],1089:[function(e,t){'use strict';function a(){return{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}}}var o=e("../scatter/attributes"),r=e("../../components/colorscale/attributes"),i=e("../../plots/template_attributes").hovertemplateAttrs,n=e("../../plots/template_attributes").texttemplateAttrs,l=e("../../plots/attributes"),s=e("../../constants/gl3d_dashes"),d=e("../../constants/gl3d_markers"),c=e("../../lib/extend").extendFlat,p=e("../../plot_api/edit_types").overrideAll,u=o.line,g=o.marker,m=g.line,h=c({width:u.width,dash:{valType:"enumerated",values:Object.keys(s),dflt:"solid"}},r("line")),y=t.exports=p({x:o.x,y:o.y,z:{valType:"data_array"},text:c({},o.text,{}),texttemplate:n({},{}),hovertext:c({},o.hovertext,{}),hovertemplate:i(),mode:c({},o.mode,{dflt:"lines+markers"}),surfaceaxis:{valType:"enumerated",values:[-1,0,1,2],dflt:-1},surfacecolor:{valType:"color"},projection:{x:a("x"),y:a("y"),z:a("z")},connectgaps:o.connectgaps,line:h,marker:c({symbol:{valType:"enumerated",values:Object.keys(d),dflt:"circle",arrayOk:!0},size:c({},g.size,{dflt:8}),sizeref:g.sizeref,sizemin:g.sizemin,sizemode:g.sizemode,opacity:c({},g.opacity,{arrayOk:!1}),colorbar:g.colorbar,line:c({width:c({},m.width,{arrayOk:!1})},r("marker.line"))},r("marker")),textposition:c({},o.textposition,{dflt:"top center"}),textfont:{color:o.textfont.color,size:o.textfont.size,family:c({},o.textfont.family,{arrayOk:!1})},hoverinfo:c({},l.hoverinfo)},"calc","nested");y.x.editType=y.y.editType=y.z.editType="calc+clearAxisTypes"},{"../../components/colorscale/attributes":531,"../../constants/gl3d_dashes":630,"../../constants/gl3d_markers":631,"../../lib/extend":648,"../../plot_api/edit_types":688,"../../plots/attributes":702,"../../plots/template_attributes":783,"../scatter/attributes":1062}],1090:[function(e,t){'use strict';var a=e("../scatter/arrays_to_calcdata"),o=e("../scatter/colorscale_calc");t.exports=function(e,t){var r=[{x:!1,y:!1,trace:t,t:{}}];return a(r,t),o(e,t),r}},{"../scatter/arrays_to_calcdata":1061,"../scatter/colorscale_calc":1065}],1091:[function(e,t){'use strict';var r=Math.min;function a(e,t,a,o){if(!t||!t.visible)return null;for(var l=n.getComponentMethod("errorbars","makeComputeError")(t),s=Array(e.length),d=0,c;d<e.length;d++)if(c=l(+e[d],d),"log"===o.type){var p=o.c2l(e[d]),u=e[d]-c[0],g=e[d]+c[1];if(s[d]=[(o.c2l(u,!0)-p)*a,(o.c2l(g,!0)-p)*a],0<u){var m=o.c2l(u);o._lowerLogErrorBound||(o._lowerLogErrorBound=m),o._lowerErrorBound=r(o._lowerLogErrorBound,m)}}else s[d]=[-c[0]*a,c[1]*a];return s}function o(e){for(var t=0;t<e.length;t++)if(e[t])return e[t].length;return 0}var n=e("../../registry");t.exports=function(e,t,r){var l=[a(e.x,e.error_x,t[0],r.xaxis),a(e.y,e.error_y,t[1],r.yaxis),a(e.z,e.error_z,t[2],r.zaxis)],s=o(l);if(0===s)return null;for(var n=Array(s),d=0,c;d<s;d++){c=[[0,0,0],[0,0,0]];for(var p=0;3>p;p++)if(l[p])for(var u=0;2>u;u++)c[u][p]=l[p][d][u];n[d]=c}return n}},{"../../registry":788}],1092:[function(e,t){'use strict';var m=Math.round,h=Math.min;function a(e,t){this.scene=e,this.uid=t,this.linePlot=null,this.scatterPlot=null,this.errorBars=null,this.textMarkers=null,this.delaunayMesh=null,this.color=null,this.mode="",this.dataPoints=[],this.axesBounds=[[-Infinity,-Infinity,-Infinity],[1/0,1/0,1/0]],this.textLabels=null,this.data=null}function o(e,t,a){var o=(a+1)%3,r=(a+2)%3,n=[],l=[],s;for(s=0;s<e.length;++s){var d=e[s];!isNaN(d[o])&&isFinite(d[o])&&!isNaN(d[r])&&isFinite(d[r])&&(n.push([d[o],d[r]]),l.push(s))}var p=b(n);for(s=0;s<p.length;++s)for(var u=p[s],c=0;c<u.length;++c)u[c]=l[u[c]];return{positions:e,cells:p,meshColor:t}}function r(t){for(var a=[0,0,0],o=[[0,0,0],[0,0,0],[0,0,0]],r=[1,1,1],n=0,l;3>n;n++)l=t[n],l&&!1!==l.copy_zstyle&&!1!==t[2].visible&&(l=t[2]),!l||!l.visible||(a[n]=l.width/2,o[n]=w(l.color),r[n]=l.thickness);return{capSize:a,color:o,lineWidth:r}}function n(e){return null===e||void 0===e?0:-1<e.indexOf("left")?-1:-1<e.indexOf("right")?1:0}function l(e){return null===e||void 0===e?0:-1<e.indexOf("top")?-1:-1<e.indexOf("bottom")?1:0}function s(e){var t=0,a=[0,t];if(Array.isArray(e))for(var o=0;o<e.length;o++)a[o]=[0,t],e[o]&&(a[o][0]=n(e[o]),a[o][1]=l(e[o]));else a[0]=n(e),a[1]=l(e);return a}function d(e,t){return t(4*e)}function c(e){return S[e]}function p(e,t,a,o,r){var n=null;if(v.isArrayOrTypedArray(e)){n=[];for(var l=0;l<t;l++)n[l]=void 0===e[l]?o:a(e[l],r)}else n=a(e,v.identity);return n}function u(e,t){function a(e,t){var a=n[e];return C.tickText(a,a.d2l(t),!0).text}var o=[],n=e.fullSceneLayout,l=e.dataScale,u=n.xaxis,g=n.yaxis,m=n.zaxis,f=t.marker,_=t.line,b=t.x||[],x=t.y||[],y=t.z||[],A=b.length,S=t.xcalendar,I=t.ycalendar,P=t.zcalendar,z,D,O,R,M,j;for(M=0;M<A;M++)z=u.d2l(b[M],0,S)*l[0],D=g.d2l(x[M],0,I)*l[1],O=m.d2l(y[M],0,P)*l[2],o[M]=[z,D,O];if(Array.isArray(t.text))j=t.text;else if(void 0!==t.text)for(j=Array(A),M=0;M<A;M++)j[M]=t.text;var B=t.texttemplate;if(B){var F=e.fullLayout,V=F._d3locale,U=Array.isArray(B),H=U?h(B.length,A):A,N=U?function(e){return B[e]}:function(){return B};for(j=Array(H),M=0;M<H;M++){var q={x:b[M],y:x[M],z:y[M]},G={xLabel:a("xaxis",b[M]),yLabel:a("yaxis",x[M]),zLabel:a("zaxis",y[M])},Y={};L(Y,t,M);var W=t._meta||{};j[M]=v.texttemplateString(N(M),G,V,Y,q,W)}}if(R={position:o,mode:t.mode,text:j},"line"in t&&(R.lineColor=k(_,1,A),R.lineWidth=_.width,R.lineDashes=_.dash),"marker"in t){var X=T(t);R.scatterColor=k(f,1,A),R.scatterSize=p(f.size,A,d,20,X),R.scatterMarker=p(f.symbol,A,c,"\u25CF"),R.scatterLineWidth=f.line.width,R.scatterLineColor=k(f.line,1,A),R.scatterAngle=0}"textposition"in t&&(R.textOffset=s(t.textposition),R.textColor=k(t.textfont,1,A),R.textSize=p(t.textfont.size,A,v.identity,12),R.textFont=t.textfont.family,R.textAngle=0);var Z=["x","y","z"];for(R.project=[!1,!1,!1],R.projectScale=[1,1,1],R.projectOpacity=[1,1,1],M=0;3>M;++M){var K=t.projection[Z[M]];(R.project[M]=K.show)&&(R.projectOpacity[M]=K.opacity,R.projectScale[M]=K.scale)}R.errorBounds=E(t,l,n);var $=r([t.error_x,t.error_y,t.error_z]);return R.errorColor=$.color,R.errorLineWidth=$.lineWidth,R.errorCapSize=$.capSize,R.delaunayAxis=t.surfaceaxis,R.delaunayColor=w(t.surfacecolor),R}function g(e){if(Array.isArray(e)){var t=e[0];return Array.isArray(t)&&(e=t),"rgb("+e.slice(0,3).map(function(e){return m(255*e)})+")"}return null}var y=e("gl-line3d"),f=e("gl-scatter3d"),x=e("gl-error3d"),_=e("gl-mesh3d"),b=e("delaunay-triangulate"),v=e("../../lib"),w=e("../../lib/str2rgbarray"),k=e("../../lib/gl_format_color").formatColor,T=e("../scatter/make_bubble_size_func"),A=e("../../constants/gl3d_dashes"),S=e("../../constants/gl3d_markers"),C=e("../../plots/cartesian/axes"),L=e("../../components/fx/helpers").appendArrayPointValue,E=e("./calc_errors"),I=a.prototype;I.handlePick=function(e){if(e.object&&(e.object===this.linePlot||e.object===this.delaunayMesh||e.object===this.textMarkers||e.object===this.scatterPlot)){var t=e.index=e.data.index;return e.object.highlight&&e.object.highlight(null),this.scatterPlot&&(e.object=this.scatterPlot,this.scatterPlot.highlight(e.data)),e.textLabel="",this.textLabels&&(Array.isArray(this.textLabels)?(this.textLabels[t]||0===this.textLabels[t])&&(e.textLabel=this.textLabels[t]):e.textLabel=this.textLabels),e.traceCoordinate=[this.data.x[t],this.data.y[t],this.data.z[t]],!0}},I.update=function(e){var t=this.scene.glplot.gl,a=A.solid,r,i,n,l;this.data=e;var s=u(this.scene,e);"mode"in s&&(this.mode=s.mode),"lineDashes"in s&&s.lineDashes in A&&(a=A[s.lineDashes]),this.color=g(s.scatterColor)||g(s.lineColor),this.dataPoints=s.position,r={gl:this.scene.glplot.gl,position:s.position,color:s.lineColor,lineWidth:s.lineWidth||1,dashes:a[0],dashScale:a[1],opacity:e.opacity,connectGaps:e.connectgaps},-1===this.mode.indexOf("lines")?this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose(),this.linePlot=null):this.linePlot?this.linePlot.update(r):(this.linePlot=y(r),this.linePlot._trace=this,this.scene.glplot.add(this.linePlot));var d=e.opacity;if(e.marker&&e.marker.opacity&&(d*=e.marker.opacity),i={gl:this.scene.glplot.gl,position:s.position,color:s.scatterColor,size:s.scatterSize,glyph:s.scatterMarker,opacity:d,orthographic:!0,lineWidth:s.scatterLineWidth,lineColor:s.scatterLineColor,project:s.project,projectScale:s.projectScale,projectOpacity:s.projectOpacity},-1===this.mode.indexOf("markers")?this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose(),this.scatterPlot=null):this.scatterPlot?this.scatterPlot.update(i):(this.scatterPlot=f(i),this.scatterPlot._trace=this,this.scatterPlot.highlightScale=1,this.scene.glplot.add(this.scatterPlot)),l={gl:this.scene.glplot.gl,position:s.position,glyph:s.text,color:s.textColor,size:s.textSize,angle:s.textAngle,alignment:s.textOffset,font:s.textFont,orthographic:!0,lineWidth:0,project:!1,opacity:e.opacity},this.textLabels=e.hovertext||e.text,-1===this.mode.indexOf("text")?this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose(),this.textMarkers=null):this.textMarkers?this.textMarkers.update(l):(this.textMarkers=f(l),this.textMarkers._trace=this,this.textMarkers.highlightScale=1,this.scene.glplot.add(this.textMarkers)),n={gl:this.scene.glplot.gl,position:s.position,color:s.errorColor,error:s.errorBounds,lineWidth:s.errorLineWidth,capSize:s.errorCapSize,opacity:e.opacity},this.errorBars?s.errorBounds?this.errorBars.update(n):(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose(),this.errorBars=null):s.errorBounds&&(this.errorBars=x(n),this.errorBars._trace=this,this.scene.glplot.add(this.errorBars)),0<=s.delaunayAxis){var c=o(s.position,s.delaunayColor,s.delaunayAxis);c.opacity=e.opacity,this.delaunayMesh?this.delaunayMesh.update(c):(c.gl=t,this.delaunayMesh=_(c),this.delaunayMesh._trace=this,this.scene.glplot.add(this.delaunayMesh))}else this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose(),this.delaunayMesh=null)},I.dispose=function(){this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose()),this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose()),this.errorBars&&(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose()),this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose()),this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose())},t.exports=function(e,t){var o=new a(e,t.uid);return o.update(t),o}},{"../../components/fx/helpers":560,"../../constants/gl3d_dashes":630,"../../constants/gl3d_markers":631,"../../lib":657,"../../lib/gl_format_color":654,"../../lib/str2rgbarray":680,"../../plots/cartesian/axes":705,"../scatter/make_bubble_size_func":1079,"./calc_errors":1091,"delaunay-triangulate":111,"gl-error3d":226,"gl-line3d":233,"gl-mesh3d":257,"gl-scatter3d":273}],1093:[function(e,t){'use strict';var o=Math.min;function a(e,t,a,i){var n=0,l=a("x"),s=a("y"),d=a("z"),c=r.getComponentMethod("calendars","handleTraceDefaults");return c(e,t,["x","y","z"],i),l&&s&&d&&(n=o(l.length,s.length,d.length),t._length=t._xlength=t._ylength=t._zlength=n),n}var r=e("../../registry"),i=e("../../lib"),n=e("../scatter/subtypes"),l=e("../scatter/marker_defaults"),s=e("../scatter/line_defaults"),d=e("../scatter/text_defaults"),c=e("./attributes");t.exports=function(e,t,o,p){function u(a,o){return i.coerce(e,t,c,a,o)}var g=a(e,t,u,p);if(!g)return void(t.visible=!1);u("text"),u("hovertext"),u("hovertemplate"),u("mode"),n.hasLines(t)&&(u("connectgaps"),s(e,t,o,p,u)),n.hasMarkers(t)&&l(e,t,o,p,u,{noSelect:!0}),n.hasText(t)&&(u("texttemplate"),d(e,t,p,u,{noSelect:!0}));var m=(t.line||{}).color,h=(t.marker||{}).color;0<=u("surfaceaxis")&&u("surfacecolor",m||h);for(var y=["x","y","z"],f=0,x;3>f;++f)x="projection."+y[f],u(x+".show")&&(u(x+".opacity"),u(x+".scale"));var _=r.getComponentMethod("errorbars","supplyDefaults");_(e,t,m||h||o,{axis:"z"}),_(e,t,m||h||o,{axis:"y",inherit:"z"}),_(e,t,m||h||o,{axis:"x",inherit:"z"})}},{"../../lib":657,"../../registry":788,"../scatter/line_defaults":1075,"../scatter/marker_defaults":1081,"../scatter/subtypes":1086,"../scatter/text_defaults":1087,"./attributes":1089}],1094:[function(e,t){'use strict';t.exports={plot:e("./convert"),attributes:e("./attributes"),markerSymbols:e("../../constants/gl3d_markers"),supplyDefaults:e("./defaults"),colorbar:[{container:"marker",min:"cmin",max:"cmax"},{container:"line",min:"cmin",max:"cmax"}],calc:e("./calc"),moduleType:"trace",name:"scatter3d",basePlotModule:e("../../plots/gl3d"),categories:["gl3d","symbols","showLegend","scatter-like"],meta:{}}},{"../../constants/gl3d_markers":631,"../../plots/gl3d":747,"./attributes":1089,"./calc":1090,"./convert":1092,"./defaults":1093}],1095:[function(e,t){'use strict';var a=e("../scatter/attributes"),o=e("../../plots/attributes"),r=e("../../plots/template_attributes").hovertemplateAttrs,i=e("../../plots/template_attributes").texttemplateAttrs,n=e("../../components/colorscale/attributes"),l=e("../../lib/extend").extendFlat,s=a.marker,d=a.line,c=s.line;t.exports={carpet:{valType:"string",editType:"calc"},a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},mode:l({},a.mode,{dflt:"markers"}),text:l({},a.text,{}),texttemplate:i({editType:"plot"},{keys:["a","b","text"]}),hovertext:l({},a.hovertext,{}),line:{color:d.color,width:d.width,dash:d.dash,shape:l({},d.shape,{values:["linear","spline"]}),smoothing:d.smoothing,editType:"calc"},connectgaps:a.connectgaps,fill:l({},a.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:a.fillcolor,marker:l({symbol:s.symbol,opacity:s.opacity,maxdisplayed:s.maxdisplayed,size:s.size,sizeref:s.sizeref,sizemin:s.sizemin,sizemode:s.sizemode,line:l({width:c.width,editType:"calc"},n("marker.line")),gradient:s.gradient,editType:"calc"},n("marker")),textfont:a.textfont,textposition:a.textposition,selected:a.selected,unselected:a.unselected,hoverinfo:l({},o.hoverinfo,{flags:["a","b","text","name"]}),hoveron:a.hoveron,hovertemplate:r()}},{"../../components/colorscale/attributes":531,"../../lib/extend":648,"../../plots/attributes":702,"../../plots/template_attributes":783,"../scatter/attributes":1062}],1096:[function(e,t){'use strict';var o=e("fast-isnumeric"),r=e("../scatter/colorscale_calc"),n=e("../scatter/arrays_to_calcdata"),l=e("../scatter/calc_selection"),s=e("../scatter/calc").calcMarkerSize,d=e("../carpet/lookup_carpetid");t.exports=function(e,t){var c=t._carpetTrace=d(e,t);if(c&&c.visible&&"legendonly"!==c.visible){var p;t.xaxis=c.xaxis,t.yaxis=c.yaxis;var u=t._length,g=Array(u),m=!1,h,y;for(p=0;p<u;p++)if(h=t.a[p],y=t.b[p],o(h)&&o(y)){var f=c.ab2xy(+h,+y,!0),x=c.isVisible(+h,+y);x||(m=!0),g[p]={x:f[0],y:f[1],a:h,b:y,vis:x}}else g[p]={x:!1,y:!1};return t._needsCull=m,g[0].carpet=c,g[0].trace=t,s(t,u),r(e,t),n(g,t),l(g,t),g}}},{"../carpet/lookup_carpetid":858,"../scatter/arrays_to_calcdata":1061,"../scatter/calc":1063,"../scatter/calc_selection":1064,"../scatter/colorscale_calc":1065,"fast-isnumeric":201}],1097:[function(e,t){'use strict';var o=e("../../lib"),r=e("../scatter/constants"),i=e("../scatter/subtypes"),n=e("../scatter/marker_defaults"),l=e("../scatter/line_defaults"),s=e("../scatter/line_shape_defaults"),d=e("../scatter/text_defaults"),c=e("../scatter/fillcolor_defaults"),p=e("./attributes");t.exports=function(e,t,u,g){function m(a,r){return o.coerce(e,t,p,a,r)}m("carpet"),t.xaxis="x",t.yaxis="y";var h=m("a"),a=m("b"),y=Math.min(h.length,a.length);if(!y)return void(t.visible=!1);t._length=y,m("text"),m("texttemplate"),m("hovertext");var f=y<r.PTS_LINESONLY?"lines+markers":"lines";m("mode",f),i.hasLines(t)&&(l(e,t,u,g,m),s(e,t,m),m("connectgaps")),i.hasMarkers(t)&&n(e,t,u,g,m,{gradient:!0}),i.hasText(t)&&d(e,t,g,m);var x=[];(i.hasMarkers(t)||i.hasText(t))&&(m("marker.maxdisplayed"),x.push("points")),m("fill"),"none"!==t.fill&&(c(e,t,u,m),!i.hasLines(t)&&s(e,t,m)),("tonext"===t.fill||"toself"===t.fill)&&x.push("fills");var _=m("hoveron",x.join("+")||"points");"fills"!==_&&m("hovertemplate"),o.coerceSelectionMarkerOpacity(t,m)}},{"../../lib":657,"../scatter/constants":1066,"../scatter/fillcolor_defaults":1070,"../scatter/line_defaults":1075,"../scatter/line_shape_defaults":1077,"../scatter/marker_defaults":1081,"../scatter/subtypes":1086,"../scatter/text_defaults":1087,"./attributes":1095}],1098:[function(e,t){'use strict';t.exports=function(e,t,a,o,r){var i=o[r];return e.a=i.a,e.b=i.b,e.y=i.y,e}},{}],1099:[function(e,t){'use strict';var a=Math.floor;t.exports=function(e,t){var o={},r=t._carpet,i=r.ab2ij([e.a,e.b]),n=a(i[0]),l=i[0]-n,s=a(i[1]),d=i[1]-s,c=r.evalxy([],n,s,l,d);return o.yLabel=c[1].toFixed(3),o}},{}],1100:[function(e,t){'use strict';var a=Math.min,o=Math.max,r=e("../scatter/hover"),i=e("../../lib").fillText;t.exports=function(e,t,n,l){function s(e,t){var a;a=e.labelprefix&&0<e.labelprefix.length?e.labelprefix.replace(/ = $/,""):e._hovertitle,_.push(a+": "+t.toFixed(3)+e.labelsuffix)}var d=r(e,t,n,l);if(d&&!1!==d[0].index){var c=d[0];if(void 0===c.index){var p=1-c.y0/e.ya._length,u=e.xa._length,g=u*p/2,m=u-g;return c.x0=o(a(c.x0,m),g),c.x1=o(a(c.x1,m),g),d}var h=c.cd[c.index];c.a=h.a,c.b=h.b,c.xLabelVal=void 0,c.yLabelVal=void 0;var y=c.trace,f=y._carpet,x=y._module.formatLabels(h,y);c.yLabel=x.yLabel,delete c.text;var _=[];if(!y.hovertemplate){var b=h.hi||y.hoverinfo,v=b.split("+");-1!==v.indexOf("all")&&(v=["a","b","text"]),-1!==v.indexOf("a")&&s(f.aaxis,h.a),-1!==v.indexOf("b")&&s(f.baxis,h.b),_.push("y: "+c.yLabel),-1!==v.indexOf("text")&&i(h,y,_),c.extraText=_.join("<br>")}return d}}},{"../../lib":657,"../scatter/hover":1073}],1101:[function(e,t){'use strict';t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../scatter/marker_colorbar"),formatLabels:e("./format_labels"),calc:e("./calc"),plot:e("./plot"),style:e("../scatter/style").style,styleOnSelect:e("../scatter/style").styleOnSelect,hoverPoints:e("./hover"),selectPoints:e("../scatter/select"),eventData:e("./event_data"),moduleType:"trace",name:"scattercarpet",basePlotModule:e("../../plots/cartesian"),categories:["svg","carpet","symbols","showLegend","carpetDependent","zoomScale"],meta:{}}},{"../../plots/cartesian":718,"../scatter/marker_colorbar":1080,"../scatter/select":1083,"../scatter/style":1085,"./attributes":1095,"./calc":1096,"./defaults":1097,"./event_data":1098,"./format_labels":1099,"./hover":1100,"./plot":1102}],1102:[function(e,t){'use strict';var a=e("../scatter/plot"),o=e("../../plots/cartesian/axes"),r=e("../../components/drawing");t.exports=function(e,t,n,l){var s=n[0][0].carpet,d={xaxis:o.getFromId(e,s.xaxis||"x"),yaxis:o.getFromId(e,s.yaxis||"y"),plot:t.plot},c,p,u;for(a(e,d,n,l),c=0;c<n.length;c++)p=n[c][0].trace,u=l.selectAll("g.trace"+p.uid+" .js-line"),r.setClipUrl(u,n[c][0].carpet._clipPathId,e)}},{"../../components/drawing":546,"../../plots/cartesian/axes":705,"../scatter/plot":1082}],1103:[function(e,t){'use strict';var a=e("../../plots/template_attributes").hovertemplateAttrs,o=e("../../plots/template_attributes").texttemplateAttrs,r=e("../scatter/attributes"),i=e("../../plots/attributes"),n=e("../../components/colorscale/attributes"),l=e("../../components/drawing/attributes").dash,s=e("../../lib/extend").extendFlat,d=e("../../plot_api/edit_types").overrideAll,c=r.marker,p=r.line,u=c.line;t.exports=d({lon:{valType:"data_array"},lat:{valType:"data_array"},locations:{valType:"data_array"},locationmode:{valType:"enumerated",values:["ISO-3","USA-states","country names","geojson-id"],dflt:"ISO-3"},geojson:{valType:"any",editType:"calc"},featureidkey:{valType:"string",editType:"calc",dflt:"id"},mode:s({},r.mode,{dflt:"markers"}),text:s({},r.text,{}),texttemplate:o({editType:"plot"},{keys:["lat","lon","location","text"]}),hovertext:s({},r.hovertext,{}),textfont:r.textfont,textposition:r.textposition,line:{color:p.color,width:p.width,dash:l},connectgaps:r.connectgaps,marker:s({symbol:c.symbol,opacity:c.opacity,size:c.size,sizeref:c.sizeref,sizemin:c.sizemin,sizemode:c.sizemode,colorbar:c.colorbar,line:s({width:u.width},n("marker.line")),gradient:c.gradient},n("marker")),fill:{valType:"enumerated",values:["none","toself"],dflt:"none"},fillcolor:r.fillcolor,selected:r.selected,unselected:r.unselected,hoverinfo:s({},i.hoverinfo,{flags:["lon","lat","location","text","name"]}),hovertemplate:a()},"calc","nested")},{"../../components/colorscale/attributes":531,"../../components/drawing/attributes":545,"../../lib/extend":648,"../../plot_api/edit_types":688,"../../plots/attributes":702,"../../plots/template_attributes":783,"../scatter/attributes":1062}],1104:[function(e,t){'use strict';function a(e){return e&&"string"==typeof e}var o=e("fast-isnumeric"),r=e("../../constants/numerical").BADNUM,n=e("../scatter/colorscale_calc"),l=e("../scatter/arrays_to_calcdata"),s=e("../scatter/calc_selection"),d=e("../../lib")._;t.exports=function(e,t){var c=Array.isArray(t.locations),p=c?t.locations.length:t._length,u=Array(p),g;g=t.geojson?function(e){return a(e)||o(e)}:a;for(var m=0,h;m<p;m++)if(h=u[m]={},c){var y=t.locations[m];h.loc=g(y)?y:null}else{var f=t.lon[m],x=t.lat[m];h.lonlat=o(f)&&o(x)?[+f,+x]:[r,r]}return l(u,t),n(e,t),s(u,t),p&&(u[0].t={labels:{lat:d(e,"lat:")+" ",lon:d(e,"lon:")+" "}}),u}},{"../../constants/numerical":633,"../../lib":657,"../scatter/arrays_to_calcdata":1061,"../scatter/calc_selection":1064,"../scatter/colorscale_calc":1065,"fast-isnumeric":201}],1105:[function(e,t){'use strict';var a=e("../../lib"),o=e("../scatter/subtypes"),r=e("../scatter/marker_defaults"),i=e("../scatter/line_defaults"),n=e("../scatter/text_defaults"),l=e("../scatter/fillcolor_defaults"),s=e("./attributes");t.exports=function(e,t,d,c){function p(o,r){return a.coerce(e,t,s,o,r)}var u=p("locations"),g;if(u&&u.length){var m=p("geojson"),h;("string"==typeof m&&""!==m||a.isPlainObject(m))&&(h="geojson-id");var y=p("locationmode",h);"geojson-id"===y&&p("featureidkey"),g=u.length}else{var f=p("lon")||[],x=p("lat")||[];g=Math.min(f.length,x.length)}return g?void(t._length=g,p("text"),p("hovertext"),p("hovertemplate"),p("mode"),o.hasLines(t)&&(i(e,t,d,c,p),p("connectgaps")),o.hasMarkers(t)&&r(e,t,d,c,p,{gradient:!0}),o.hasText(t)&&(p("texttemplate"),n(e,t,c,p)),p("fill"),"none"!==t.fill&&l(e,t,d,p),a.coerceSelectionMarkerOpacity(t,p)):void(t.visible=!1)}},{"../../lib":657,"../scatter/fillcolor_defaults":1070,"../scatter/line_defaults":1075,"../scatter/marker_defaults":1081,"../scatter/subtypes":1086,"../scatter/text_defaults":1087,"./attributes":1103}],1106:[function(e,t){'use strict';t.exports=function(e,t,a,o,r){e.lon=t.lon,e.lat=t.lat,e.location=t.loc?t.loc:null;var i=o[r];return i.fIn&&i.fIn.properties&&(e.properties=i.fIn.properties),e}},{}],1107:[function(e,t){'use strict';var a=e("../../plots/cartesian/axes");t.exports=function(e,t,o){var r={},i=o[t.geo]._subplot,n=i.mockAxis,l=e.lonlat;return r.lonLabel=a.tickText(n,n.c2l(l[0]),!0).text,r.latLabel=a.tickText(n,n.c2l(l[1]),!0).text,r}},{"../../plots/cartesian/axes":705}],1108:[function(e,t){'use strict';var o=Math.sqrt,r=Math.abs,i=Math.max;function a(e,t,a,o){function r(e){return e+"\xB0"}if(!e.hovertemplate){var i=t.hi||e.hoverinfo,n="all"===i?c.hoverinfo.flags:i.split("+"),l=-1!==n.indexOf("location")&&Array.isArray(e.locations),s=-1!==n.indexOf("lon"),p=-1!==n.indexOf("lat"),u=-1!==n.indexOf("text"),g=[];return l?g.push(t.loc):s&&p?g.push("("+r(a.lonLabel)+", "+r(a.latLabel)+")"):s?g.push(o.lon+r(a.lonLabel)):p&&g.push(o.lat+r(a.latLabel)),u&&d(t,e,g),g.join("<br>")}}var n=e("../../components/fx"),l=e("../../constants/numerical").BADNUM,s=e("../scatter/get_trace_color"),d=e("../../lib").fillText,c=e("./attributes");t.exports=function(e,t,c){var p=e.cd,d=p[0].trace,u=e.xa,g=e.ya,m=e.subplot,h=m.projection.isLonLatOverEdges,y=m.project;if(n.getClosest(p,function(e){var a=e.lonlat;if(a[0]===l)return 1/0;if(h(a))return 1/0;var n=y(a),s=y([t,c]),d=r(n[0]-s[0]),p=r(n[1]-s[1]),u=i(3,e.mrc||0);return i(o(d*d+p*p)-u,1-3/u)},e),!1!==e.index){var f=p[e.index],x=f.lonlat,_=[u.c2p(x),g.c2p(x)],b=f.mrc||1;e.x0=_[0]-b,e.x1=_[0]+b,e.y0=_[1]-b,e.y1=_[1]+b,e.loc=f.loc,e.lon=x[0],e.lat=x[1];var v={};v[d.geo]={_subplot:m};var w=d._module.formatLabels(f,d,v);return e.lonLabel=w.lonLabel,e.latLabel=w.latLabel,e.color=s(d,f),e.extraText=a(d,f,e,p[0].t.labels),e.hovertemplate=d.hovertemplate,[e]}}},{"../../components/fx":564,"../../constants/numerical":633,"../../lib":657,"../scatter/get_trace_color":1072,"./attributes":1103}],1109:[function(e,t){'use strict';t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../scatter/marker_colorbar"),formatLabels:e("./format_labels"),calc:e("./calc"),calcGeoJSON:e("./plot").calcGeoJSON,plot:e("./plot").plot,style:e("./style"),styleOnSelect:e("../scatter/style").styleOnSelect,hoverPoints:e("./hover"),eventData:e("./event_data"),selectPoints:e("./select"),moduleType:"trace",name:"scattergeo",basePlotModule:e("../../plots/geo"),categories:["geo","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/geo":737,"../scatter/marker_colorbar":1080,"../scatter/style":1085,"./attributes":1103,"./calc":1104,"./defaults":1105,"./event_data":1106,"./format_labels":1107,"./hover":1108,"./plot":1110,"./select":1111,"./style":1112}],1110:[function(e,t){'use strict';var a=e("d3"),o=e("../../lib"),r=e("../../lib/topojson_utils").getTopojsonFeatures,i=e("../../lib/geojson_utils"),n=e("../../lib/geo_location_utils"),l=e("../../plots/cartesian/autorange").findExtremes,s=e("../../constants/numerical").BADNUM,d=e("../scatter/calc").calcMarkerSize,c=e("../scatter/subtypes"),p=e("./style");t.exports={calcGeoJSON:function(e,t){var a=e[0].trace,o=t[a.geo],c=o._subplot,p=a._length,u,g;if(Array.isArray(a.locations)){var m=a.locationmode,h="geojson-id"===m?n.extractTraceFeature(e):r(a,c.topojson);for(u=0;u<p;u++){g=e[u];var y="geojson-id"===m?g.fOut:n.locationToFeature(m,g.loc,h);g.lonlat=y?y.properties.ct:[s,s]}}var f={padded:!0},x,_;if("geojson"===o.fitbounds&&"geojson-id"===a.locationmode){var b=n.computeBbox(n.getTraceGeojson(a));x=[b[0],b[2]],_=[b[1],b[3]]}else{for(x=Array(p),_=Array(p),u=0;u<p;u++)g=e[u],x[u]=g.lonlat[0],_[u]=g.lonlat[1];f.ppad=d(a,p)}a._extremes.lon=l(o.lonaxis._ax,x,f),a._extremes.lat=l(o.lataxis._ax,_,f)},plot:function(e,t,r){function n(e,t){e.lonlat[0]===s&&a.select(t).remove()}var l=t.layers.frontplot.select(".scatterlayer"),d=o.makeTraceGroups(l,r,"trace scattergeo");d.selectAll("*").remove(),d.each(function(t){var r=a.select(this),l=t[0].trace;if(c.hasLines(l)||"none"!==l.fill){var s=i.calcTraceToLineCoords(t),d="none"===l.fill?i.makeLine(s):i.makePolygon(s);r.selectAll("path.js-line").data([{geojson:d,trace:l}]).enter().append("path").classed("js-line",!0).style("stroke-miterlimit",2)}c.hasMarkers(l)&&r.selectAll("path.point").data(o.identity).enter().append("path").classed("point",!0).each(function(e){n(e,this)}),c.hasText(l)&&r.selectAll("g").data(o.identity).enter().append("g").append("text").each(function(e){n(e,this)}),p(e,t)})}}},{"../../constants/numerical":633,"../../lib":657,"../../lib/geo_location_utils":651,"../../lib/geojson_utils":652,"../../lib/topojson_utils":684,"../../plots/cartesian/autorange":704,"../scatter/calc":1063,"../scatter/subtypes":1086,"./style":1112,d3:108}],1111:[function(e,t){'use strict';var a=e("../scatter/subtypes"),o=e("../../constants/numerical").BADNUM;t.exports=function(e,t){var r=e.cd,n=e.xaxis,l=e.yaxis,s=[],d=r[0].trace,c=!a.hasMarkers(d)&&!a.hasText(d),p,u,g,m,h;if(c)return[];if(!1===t)for(h=0;h<r.length;h++)r[h].selected=0;else for(h=0;h<r.length;h++)p=r[h],u=p.lonlat,u[0]===o||(g=n.c2p(u),m=l.c2p(u),t.contains([g,m],null,h,e)?(s.push({pointNumber:h,lon:u[0],lat:u[1]}),p.selected=1):p.selected=0);return s}},{"../../constants/numerical":633,"../scatter/subtypes":1086}],1112:[function(e,t){'use strict';function a(e,t){var a=t[0].trace,n=t[0].node3;n.style("opacity",t[0].trace.opacity),l(n,a,e),d(n,a,e),n.selectAll("path.js-line").style("fill","none").each(function(e){var t=o.select(this),a=e.trace,n=a.line||{};t.call(i.stroke,n.color).call(r.dashLine,n.dash||"",n.width||0),"none"!==a.fill&&t.call(i.fill,a.fillcolor)})}var o=e("d3"),r=e("../../components/drawing"),i=e("../../components/color"),n=e("../scatter/style"),l=n.stylePoints,d=n.styleText;t.exports=function(e,t){t&&a(e,t)}},{"../../components/color":524,"../../components/drawing":546,"../scatter/style":1085,d3:108}],1113:[function(e,t){'use strict';var a=e("../../plots/attributes"),o=e("../scatter/attributes"),r=e("../../components/colorscale/attributes"),i=e("../../lib/extend").extendFlat,n=e("../../plot_api/edit_types").overrideAll,l=e("./constants").DASHES,s=o.line,d=o.marker,c=d.line,p=t.exports=n({x:o.x,x0:o.x0,dx:o.dx,y:o.y,y0:o.y0,dy:o.dy,text:o.text,hovertext:o.hovertext,textposition:o.textposition,textfont:o.textfont,mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"]},line:{color:s.color,width:s.width,shape:{valType:"enumerated",values:["linear","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},dash:{valType:"enumerated",values:Object.keys(l),dflt:"solid"}},marker:i({},r("marker"),{symbol:d.symbol,size:d.size,sizeref:d.sizeref,sizemin:d.sizemin,sizemode:d.sizemode,opacity:d.opacity,colorbar:d.colorbar,line:i({},r("marker.line"),{width:c.width})}),connectgaps:o.connectgaps,fill:i({},o.fill,{dflt:"none"}),fillcolor:o.fillcolor,selected:{marker:o.selected.marker,textfont:o.selected.textfont},unselected:{marker:o.unselected.marker,textfont:o.unselected.textfont},opacity:a.opacity},"calc","nested");p.x.editType=p.y.editType=p.x0.editType=p.y0.editType="calc+clearAxisTypes",p.hovertemplate=o.hovertemplate,p.texttemplate=o.texttemplate},{"../../components/colorscale/attributes":531,"../../lib/extend":648,"../../plot_api/edit_types":688,"../../plots/attributes":702,"../scatter/attributes":1062,"./constants":1115}],1114:[function(e,t){'use strict';var r=Math.max;function a(e,t,a){var o=e._extremes[t._id],r=d(t,a._bnds,{padded:!0});o.min=o.min.concat(r.min),o.max=o.max.concat(r.max)}function o(e,t,a,o,r,i){var n=h.style(e,a);if(n.marker&&(n.marker.positions=o),n.line&&1<o.length&&l.extendFlat(n.line,h.linePositions(e,a,o)),n.errorX||n.errorY){var s=h.errorBarPositions(e,a,o,r,i);n.errorX&&l.extendFlat(n.errorX,s.x),n.errorY&&l.extendFlat(n.errorY,s.y)}return n.text&&(l.extendFlat(n.text,{positions:o},h.textPosition(e,a,n.text,n.marker)),l.extendFlat(n.textSel,{positions:o},h.textPosition(e,a,n.text,n.markerSel)),l.extendFlat(n.textUnsel,{positions:o},h.textPosition(e,a,n.text,n.markerUnsel))),n}var n=e("point-cluster"),l=e("../../lib"),s=e("../../plots/cartesian/axis_ids"),d=e("../../plots/cartesian/autorange").findExtremes,c=e("../scatter/calc"),p=c.calcMarkerSize,u=c.calcAxisExpansion,g=c.setFirstScatter,m=e("../scatter/colorscale_calc"),h=e("./convert"),f=e("./scene_update"),_=e("../../constants/numerical").BADNUM,b=e("./constants").TOO_MANY_POINTS;t.exports=function(e,t){var l=e._fullLayout,d=s.getFromId(e,t.xaxis),c=s.getFromId(e,t.yaxis),h=l._plots[t.xaxis+t.yaxis],v=t._length,w=v>=b,k=2*v,T={},A=t._x=d.makeCalcdata(t,"x"),x=t._y=c.makeCalcdata(t,"y"),y=Array(k),S,C,L;for(S=0;S<v;S++)C=A[S],L=x[S],y[2*S]=C===_?NaN:C,y[2*S+1]=L===_?NaN:L;if("log"===d.type)for(S=0;S<k;S+=2)y[S]=d.c2l(y[S]);if("log"===c.type)for(S=1;S<k;S+=2)y[S]=c.c2l(y[S]);if(w&&"log"!==d.type&&"log"!==c.type)T.tree=n(y);else{var E=T.ids=Array(v);for(S=0;S<v;S++)E[S]=S}m(e,t);var I=o(e,h,t,y,A,x),P=f(e,h);g(l,t);var z;return w?I.marker&&(z=2*(I.marker.sizeAvg||r(I.marker.size,3))):z=p(t,v),u(e,t,d,c,A,x,z),I.errorX&&a(t,d,I.errorX),I.errorY&&a(t,c,I.errorY),I.fill&&!P.fill2d&&(P.fill2d=!0),I.marker&&!P.scatter2d&&(P.scatter2d=!0),I.line&&!P.line2d&&(P.line2d=!0),(I.errorX||I.errorY)&&!P.error2d&&(P.error2d=!0),I.text&&!P.glText&&(P.glText=!0),I.marker&&(I.marker.snap=v),P.lineOptions.push(I.line),P.errorXOptions.push(I.errorX),P.errorYOptions.push(I.errorY),P.fillOptions.push(I.fill),P.markerOptions.push(I.marker),P.markerSelectedOptions.push(I.markerSel),P.markerUnselectedOptions.push(I.markerUnsel),P.textOptions.push(I.text),P.textSelectedOptions.push(I.textSel),P.textUnselectedOptions.push(I.textUnsel),P.selectBatch.push([]),P.unselectBatch.push([]),T._scene=P,T.index=P.count,T.x=A,T.y=x,T.positions=y,P.count++,[{x:!1,y:!1,t:T,trace:t}]}},{"../../constants/numerical":633,"../../lib":657,"../../plots/cartesian/autorange":704,"../../plots/cartesian/axis_ids":708,"../scatter/calc":1063,"../scatter/colorscale_calc":1065,"./constants":1115,"./convert":1116,"./scene_update":1124,"point-cluster":1245}],1115:[function(e,t){'use strict';t.exports={TOO_MANY_POINTS:1e5,SYMBOL_SDF_SIZE:200,SYMBOL_SIZE:20,SYMBOL_STROKE:1,DOT_RE:/-dot/,OPEN_RE:/-open/,DASHES:{solid:[1],dot:[1,1],dash:[4,1],longdash:[8,1],dashdot:[4,1,1,1],longdashdot:[8,1,1,1]}}},{}],1116:[function(e,t){'use strict';var c=Math.min,p=Math.max;function a(e,t){var a=e._fullLayout,o=t._length,r=t.textfont,n=t.textposition,l=Array.isArray(n)?n:[n],s=r.color,p=r.size,g=r.family,m={},h=t.texttemplate,f;if(h){m.text=[];var x=a._d3locale,_=Array.isArray(h),b=_?c(h.length,o):o,v=_?function(e){return h[e]}:function(){return h};for(f=0;f<b;f++){var w={i:f},d=t._module.formatLabels(w,t,a),k={};C(k,t,f);var T=t._meta||{};m.text.push(y.texttemplateString(v(f),d,x,k,w,T))}}else m.text=Array.isArray(t.text)&&t.text.length<o?t.text.slice():t.text;if(Array.isArray(m.text))for(f=m.text.length;f<o;f++)m.text[f]="";for(m.opacity=t.opacity,m.font={},m.align=[],m.baseline=[],f=0;f<l.length;f++){var A=l[f].split(/\s+/);switch(A[1]){case"left":m.align.push("right");break;case"right":m.align.push("left");break;default:m.align.push(A[1]);}switch(A[0]){case"top":m.baseline.push("bottom");break;case"bottom":m.baseline.push("top");break;default:m.baseline.push(A[0]);}}if(Array.isArray(s))for(m.color=Array(o),f=0;f<o;f++)m.color[f]=s[f];else m.color=s;if(y.isArrayOrTypedArray(p)||Array.isArray(g))for(m.font=Array(o),f=0;f<o;f++){var S=m.font[f]={};S.size=y.isTypedArray(p)?p[f]:Array.isArray(p)?u(p[f])?p[f]:0:p,S.family=Array.isArray(g)?g[f]:g}else m.font={size:p,family:g};return m}function o(e){var t=e._length,a=e.marker,o={},r=y.isArrayOrTypedArray(a.symbol),n=y.isArrayOrTypedArray(a.color),l=y.isArrayOrTypedArray(a.line.color),c=y.isArrayOrTypedArray(a.opacity),p=y.isArrayOrTypedArray(a.size),u=y.isArrayOrTypedArray(a.line.width),g,h;if(r||(h=k.isOpenSymbol(a.symbol)),r||n||l||c){o.colors=Array(t),o.borderColors=Array(t);var f=b(a,a.opacity,t),x=b(a.line,a.opacity,t);if(!Array.isArray(x[0])){var _=x;for(x=Array(t),g=0;g<t;g++)x[g]=_}if(!Array.isArray(f[0])){var v=f;for(f=Array(t),g=0;g<t;g++)f[g]=v}for(o.colors=f,o.borderColors=x,g=0;g<t;g++){if(r){var T=a.symbol[g];h=k.isOpenSymbol(T)}h&&(x[g]=f[g].slice(),f[g]=f[g].slice(),f[g][3]=0)}o.opacity=e.opacity}else h?(o.color=m(a.color,"uint8"),o.color[3]=0,o.borderColor=m(a.color,"uint8")):(o.color=m(a.color,"uint8"),o.borderColor=m(a.line.color,"uint8")),o.opacity=e.opacity*a.opacity;if(r)for(o.markers=Array(t),g=0;g<t;g++)o.markers[g]=d(a.symbol[g]);else o.marker=d(a.symbol);var A=w(e),S;if(p||u){var C=o.sizes=Array(t),L=o.borderSizes=Array(t),E=0,I;if(p){for(g=0;g<t;g++)C[g]=A(a.size[g]),E+=C[g];I=E/t}else for(S=A(a.size),g=0;g<t;g++)C[g]=S;if(u)for(g=0;g<t;g++)L[g]=a.line.width[g]/2;else for(S=a.line.width/2,g=0;g<t;g++)L[g]=S;o.sizeAvg=I}else o.size=A(a&&a.size||10),o.borderSizes=A(a.line.width);return o}function r(e,t){var a=e.marker,r={};return t?(t.marker&&t.marker.symbol?r=o(y.extendFlat({},a,t.marker)):t.marker&&(t.marker.size&&(r.size=t.marker.size/2),t.marker.color&&(r.colors=t.marker.color),void 0!==t.marker.opacity&&(r.opacity=t.marker.opacity)),r):r}function n(e,t,o){var r={};if(!o)return r;if(o.textfont){var i={opacity:1,text:t.text,texttemplate:t.texttemplate,textposition:t.textposition,textfont:y.extendFlat({},t.textfont)};o.textfont&&y.extendFlat(i.textfont,o.textfont),r=a(e,i)}return r}function l(e,t){var a={capSize:2*t.width,lineWidth:t.thickness,color:t.color};return t.copy_ystyle&&(a=e.error_y),a}function d(e){if("circle"===e)return null;var t=f.symbolNumber(e),a=f.symbolFuncs[t%100],o=!!f.symbolNoDot[t%100],r=!!f.symbolNoFill[t%100],i=k.isDotSymbol(e),n,l;return P[e]?P[e]:(n=i&&!o?a(1.1*E)+z:a(E),l=g(n,{w:L,h:L,viewBox:[-E,-E,E,E],stroke:r?I:-I}),P[e]=l,l||null)}var u=e("fast-isnumeric"),g=e("svg-path-sdf"),m=e("color-normalize"),h=e("../../registry"),y=e("../../lib"),f=e("../../components/drawing"),_=e("../../plots/cartesian/axis_ids"),b=e("../../lib/gl_format_color").formatColor,v=e("../scatter/subtypes"),w=e("../scatter/make_bubble_size_func"),k=e("./helpers"),T=e("./constants"),A=e("../../constants/interactions").DESELECTDIM,S={start:1,left:1,end:-1,right:-1,middle:0,center:0,bottom:1,top:-1},C=e("../../components/fx/helpers").appendArrayPointValue,L=T.SYMBOL_SDF_SIZE,E=T.SYMBOL_SIZE,I=T.SYMBOL_STROKE,P={},z=f.symbolFuncs[0](.05*E);t.exports={style:function(e,t){var s={marker:void 0,markerSel:void 0,markerUnsel:void 0,line:void 0,fill:void 0,errorX:void 0,errorY:void 0,text:void 0,textSel:void 0,textUnsel:void 0},d;if(!0!==t.visible)return s;if(v.hasText(t)&&(s.text=a(e,t),s.textSel=n(e,t,t.selected),s.textUnsel=n(e,t,t.unselected)),v.hasMarkers(t)&&(s.marker=o(t),s.markerSel=r(t,t.selected),s.markerUnsel=r(t,t.unselected),!t.unselected&&y.isArrayOrTypedArray(t.marker.opacity))){var c=t.marker.opacity;for(s.markerUnsel.opacity=Array(c.length),d=0;d<c.length;d++)s.markerUnsel.opacity[d]=A*c[d]}if(v.hasLines(t)){s.line={overlay:!0,thickness:t.line.width,color:t.line.color,opacity:t.opacity};var p=(T.DASHES[t.line.dash]||[1]).slice();for(d=0;d<p.length;++d)p[d]*=t.line.width;s.line.dashes=p}return t.error_x&&t.error_x.visible&&(s.errorX=l(t,t.error_x)),t.error_y&&t.error_y.visible&&(s.errorY=l(t,t.error_y)),!t.fill||"none"===t.fill||(s.fill={closed:!0,fill:t.fillcolor,thickness:0}),s},markerStyle:o,markerSelection:r,linePositions:function(e,t,a){var o=a.length,r=o/2,n,l;if(v.hasLines(t)&&r)if("hv"===t.line.shape){for(n=[],l=0;l<r-1;l++)isNaN(a[2*l])||isNaN(a[2*l+1])?n.push(NaN,NaN,NaN,NaN):(n.push(a[2*l],a[2*l+1]),isNaN(a[2*l+2])||isNaN(a[2*l+3])?n.push(NaN,NaN):n.push(a[2*l+2],a[2*l+1]));n.push(a[o-2],a[o-1])}else if("hvh"===t.line.shape){for(n=[],l=0;l<r-1;l++)if(isNaN(a[2*l])||isNaN(a[2*l+1])||isNaN(a[2*l+2])||isNaN(a[2*l+3]))isNaN(a[2*l])||isNaN(a[2*l+1])?n.push(NaN,NaN):n.push(a[2*l],a[2*l+1]),n.push(NaN,NaN);else{var s=(a[2*l]+a[2*l+2])/2;n.push(a[2*l],a[2*l+1],s,a[2*l+1],s,a[2*l+3])}n.push(a[o-2],a[o-1])}else if("vhv"===t.line.shape){for(n=[],l=0;l<r-1;l++)if(isNaN(a[2*l])||isNaN(a[2*l+1])||isNaN(a[2*l+2])||isNaN(a[2*l+3]))isNaN(a[2*l])||isNaN(a[2*l+1])?n.push(NaN,NaN):n.push(a[2*l],a[2*l+1]),n.push(NaN,NaN);else{var d=(a[2*l+1]+a[2*l+3])/2;n.push(a[2*l],a[2*l+1],a[2*l],d,a[2*l+2],d)}n.push(a[o-2],a[o-1])}else if("vh"===t.line.shape){for(n=[],l=0;l<r-1;l++)isNaN(a[2*l])||isNaN(a[2*l+1])?n.push(NaN,NaN,NaN,NaN):(n.push(a[2*l],a[2*l+1]),isNaN(a[2*l+2])||isNaN(a[2*l+3])?n.push(NaN,NaN):n.push(a[2*l],a[2*l+3]));n.push(a[o-2],a[o-1])}else n=a;var c=!1;for(l=0;l<n.length;l++)if(isNaN(n[l])){c=!0;break}var p=c||n.length>T.TOO_MANY_POINTS?"rect":v.hasMarkers(t)?"rect":"round";if(c&&t.connectgaps){var u=n[0],g=n[1];for(l=0;l<n.length;l+=2)isNaN(n[l])||isNaN(n[l+1])?(n[l]=u,n[l+1]=g):(u=n[l],g=n[l+1])}return{join:p,positions:n}},errorBarPositions:function(e,t,a,o,r){function i(e,o){var r=o._id.charAt(0),l=t["error_"+r];if(l&&l.visible&&("linear"===o.type||"log"===o.type)){for(var s=n(l),m={x:0,y:1}[r],h={x:[0,1,2,3],y:[2,3,0,1]}[r],y=new Float64Array(4*d),f=1/0,x=-Infinity,_=0,b=0,v;_<d;_++,b+=4)if(v=e[_],u(v)){var w=a[2*_+m],k=s(v,_),T=k[0],A=k[1];if(u(T)&&u(A)){var S=v-T,C=v+A;y[b+h[0]]=w-o.c2l(S),y[b+h[1]]=o.c2l(C)-w,y[b+h[2]]=0,y[b+h[3]]=0,f=c(f,v-T),x=p(x,v+A)}}g[r]={positions:a,errors:y,_bnds:[f,x]}}}var n=h.getComponentMethod("errorbars","makeComputeError"),l=_.getFromId(e,t.xaxis),s=_.getFromId(e,t.yaxis),d=a.length/2,g={};return i(o,l),i(r,s),g},textPosition:function(e,t,o,r){var n=t._length,l={},s;if(v.hasMarkers(t)){var d=o.font,c=o.align,p=o.baseline;for(l.offset=Array(n),s=0;s<n;s++){var u=r.sizes?r.sizes[s]:r.size,g=Array.isArray(d)?d[s].size:d.size,m=Array.isArray(c)?1<c.length?c[s]:c[0]:c,a=Array.isArray(p)?1<p.length?p[s]:p[0]:p,h=S[m],y=S[a],f=u?u/.8+1:0;l.offset[s]=[h*f/g,(-y*f-.5*y)/g]}}return l}}},{"../../components/drawing":546,"../../components/fx/helpers":560,"../../constants/interactions":632,"../../lib":657,"../../lib/gl_format_color":654,"../../plots/cartesian/axis_ids":708,"../../registry":788,"../scatter/make_bubble_size_func":1079,"../scatter/subtypes":1086,"./constants":1115,"./helpers":1120,"color-normalize":67,"fast-isnumeric":201,"svg-path-sdf":1307}],1117:[function(e,t){'use strict';var a=e("../../lib"),o=e("../../registry"),r=e("./helpers"),i=e("./attributes"),n=e("../scatter/constants"),l=e("../scatter/subtypes"),s=e("../scatter/xy_defaults"),d=e("../scatter/marker_defaults"),c=e("../scatter/line_defaults"),p=e("../scatter/fillcolor_defaults"),u=e("../scatter/text_defaults");t.exports=function(e,t,g,m){function h(o,r){return a.coerce(e,t,i,o,r)}var y=!!e.marker&&r.isOpenSymbol(e.marker.symbol),f=l.isBubble(e),x=s(e,t,m,h);if(!x)return void(t.visible=!1);var _=x<n.PTS_LINESONLY?"lines+markers":"lines";h("text"),h("hovertext"),h("hovertemplate"),h("mode",_),l.hasLines(t)&&(h("connectgaps"),c(e,t,g,m,h),h("line.shape")),l.hasMarkers(t)&&(d(e,t,g,m,h),h("marker.line.width",y||f?1:0)),l.hasText(t)&&(h("texttemplate"),u(e,t,m,h));var b=(t.line||{}).color,v=(t.marker||{}).color;h("fill"),"none"!==t.fill&&p(e,t,g,h);var w=o.getComponentMethod("errorbars","supplyDefaults");w(e,t,b||v||g,{axis:"y"}),w(e,t,b||v||g,{axis:"x",inherit:"y"}),a.coerceSelectionMarkerOpacity(t,h)}},{"../../lib":657,"../../registry":788,"../scatter/constants":1066,"../scatter/fillcolor_defaults":1070,"../scatter/line_defaults":1075,"../scatter/marker_defaults":1081,"../scatter/subtypes":1086,"../scatter/text_defaults":1087,"../scatter/xy_defaults":1088,"./attributes":1113,"./helpers":1120}],1118:[function(e,t){'use strict';var a=e("../../lib"),o=e("../../components/color"),r=e("../../constants/interactions").DESELECTDIM;t.exports={styleTextSelection:function(e){var t=e[0],n=t.trace,l=t.t,s=l._scene,d=l.index,c=s.selectBatch[d],p=s.unselectBatch[d],u=s.textOptions[d],g=s.textSelectedOptions[d]||{},m=s.textUnselectedOptions[d]||{},h=a.extendFlat({},u),y,f;if(c.length||p.length){var x=g.color,_=m.color,b=u.color,v=Array.isArray(b);for(h.color=Array(n._length),y=0;y<c.length;y++)f=c[y],h.color[f]=x||(v?b[f]:b);for(y=0;y<p.length;y++){f=p[y];var w=v?b[f]:b;h.color[f]=_?_:x?w:o.addOpacity(w,r)}}s.glText[d].update(h)}}},{"../../components/color":524,"../../constants/interactions":632,"../../lib":657}],1119:[function(e,t){'use strict';var a=e("../scatter/format_labels");t.exports=function(e,t,o){var r=e.i;return"x"in e||(e.x=t._x[r]),"y"in e||(e.y=t._y[r]),a(e,t,o)}},{"../scatter/format_labels":1071}],1120:[function(e,t,a){'use strict';var o=e("./constants");a.isOpenSymbol=function(e){return"string"==typeof e?o.OPEN_RE.test(e):100<e%200},a.isDotSymbol=function(e){return"string"==typeof e?o.DOT_RE.test(e):200<e}},{"./constants":1115}],1121:[function(e,t){'use strict';var o=Math.sqrt,r=Math.min,n=Math.abs,l=Math.max;function a(e,t,a,o){var r=e.xa,i=e.ya,n=e.distance,l=e.dxy,p=e.index,u={pointNumber:p,x:t[p],y:a[p]};u.tx=Array.isArray(o.text)?o.text[p]:o.text,u.htx=Array.isArray(o.hovertext)?o.hovertext[p]:o.hovertext,u.data=Array.isArray(o.customdata)?o.customdata[p]:o.customdata,u.tp=Array.isArray(o.textposition)?o.textposition[p]:o.textposition;var g=o.textfont;g&&(u.ts=d.isArrayOrTypedArray(g.size)?g.size[p]:g.size,u.tc=Array.isArray(g.color)?g.color[p]:g.color,u.tf=Array.isArray(g.family)?g.family[p]:g.family);var m=o.marker;m&&(u.ms=d.isArrayOrTypedArray(m.size)?m.size[p]:m.size,u.mo=d.isArrayOrTypedArray(m.opacity)?m.opacity[p]:m.opacity,u.mx=d.isArrayOrTypedArray(m.symbol)?m.symbol[p]:m.symbol,u.mc=d.isArrayOrTypedArray(m.color)?m.color[p]:m.color);var h=m&&m.line;h&&(u.mlc=Array.isArray(h.color)?h.color[p]:h.color,u.mlw=d.isArrayOrTypedArray(h.width)?h.width[p]:h.width);var y=m&&m.gradient;y&&"none"!==y.type&&(u.mgt=Array.isArray(y.type)?y.type[p]:y.type,u.mgc=Array.isArray(y.color)?y.color[p]:y.color);var f=r.c2p(u.x,!0),x=i.c2p(u.y,!0),_=u.mrc||1,b=o.hoverlabel;b&&(u.hbg=Array.isArray(b.bgcolor)?b.bgcolor[p]:b.bgcolor,u.hbc=Array.isArray(b.bordercolor)?b.bordercolor[p]:b.bordercolor,u.hts=d.isArrayOrTypedArray(b.font.size)?b.font.size[p]:b.font.size,u.htc=Array.isArray(b.font.color)?b.font.color[p]:b.font.color,u.htf=Array.isArray(b.font.family)?b.font.family[p]:b.font.family,u.hnl=d.isArrayOrTypedArray(b.namelength)?b.namelength[p]:b.namelength);var v=o.hoverinfo;v&&(u.hi=Array.isArray(v)?v[p]:v);var w=o.hovertemplate;w&&(u.ht=Array.isArray(w)?w[p]:w);var k={};k[e.index]=u;var T=d.extendFlat({},e,{color:c(o,u),x0:f-_,x1:f+_,xLabelVal:u.x,y0:x-_,y1:x+_,yLabelVal:u.y,cd:k,distance:n,spikeDistance:l,hovertemplate:u.ht});return u.htx?T.text=u.htx:u.tx?T.text=u.tx:o.text&&(T.text=o.text),d.fillText(u,o,T),s.getComponentMethod("errorbars","hoverInfo")(u,o,T),T}var s=e("../../registry"),d=e("../../lib"),c=e("../scatter/get_trace_color");t.exports={hoverPoints:function(e,t,s,d){var c=e.cd,p=c[0].t,u=c[0].trace,g=e.xa,m=e.ya,h=p.x,f=p.y,y=g.c2p(t),x=m.c2p(s),_=e.distance,b;if(p.tree){var v=g.p2c(y-_),w=g.p2c(y+_),k=m.p2c(x-_),T=m.p2c(x+_);b="x"===d?p.tree.range(r(v,w),r(m._rl[0],m._rl[1]),l(v,w),l(m._rl[0],m._rl[1])):p.tree.range(r(v,w),r(k,T),l(v,w),l(k,T))}else b=p.ids;var A=_,S,C,L,E,I,P,z,D;if("x"===d)for(E=0;E<b.length;E++)C=h[b[E]],I=n(g.c2p(C)-y),I<A&&(A=I,P=m.c2p(f[b[E]])-x,D=o(I*I+P*P),S=b[E]);else for(E=b.length-1;-1<E;E--)C=h[b[E]],L=f[b[E]],I=g.c2p(C)-y,P=m.c2p(L)-x,z=o(I*I+P*P),z<A&&(A=D=z,S=b[E]);return e.index=S,e.distance=A,e.dxy=D,void 0===S?[e]:[a(e,h,f,u)]},calcHover:a}},{"../../lib":657,"../../registry":788,"../scatter/get_trace_color":1072}],1122:[function(e,t){'use strict';var a=e("./hover");t.exports={moduleType:"trace",name:"scattergl",basePlotModule:e("../../plots/cartesian"),categories:["gl","regl","cartesian","symbols","errorBarsOK","showLegend","scatter-like"],attributes:e("./attributes"),supplyDefaults:e("./defaults"),crossTraceDefaults:e("../scatter/cross_trace_defaults"),colorbar:e("../scatter/marker_colorbar"),formatLabels:e("./format_labels"),calc:e("./calc"),plot:e("./plot"),hoverPoints:a.hoverPoints,selectPoints:e("./select"),meta:{}}},{"../../plots/cartesian":718,"../scatter/cross_trace_defaults":1068,"../scatter/marker_colorbar":1080,"./attributes":1113,"./calc":1114,"./defaults":1117,"./format_labels":1119,"./hover":1121,"./plot":1123,"./select":1125}],1123:[function(e,t){'use strict';var o=Math.floor;function a(e,t,a){var o=e._size,r=e.width,i=e.height;return[o.l+t.domain[0]*o.w,o.b+a.domain[0]*o.h,r-o.r-(1-t.domain[1])*o.w,i-o.t-(1-a.domain[1])*o.h]}var r=e("regl-scatter2d"),n=e("regl-line2d"),l=e("regl-error2d"),s=e("gl-text"),d=e("../../lib"),c=e("../../components/dragelement/helpers").selectMode,p=e("../../lib/prepare_regl"),u=e("../scatter/subtypes"),g=e("../scatter/link_traces"),m=e("./edit_style").styleTextSelection;t.exports=function(e,t,h){if(h.length){var f=e._fullLayout,_=t._scene,b=t.xaxis,v=t.yaxis,w,k;if(_){var T=p(e,["ANGLE_instanced_arrays","OES_element_index_uint"]);if(!T)return void _.init();var A=_.count,S=f._glcanvas.data()[0].regl;if(g(e,t,h),_.dirty){if(!0===_.error2d&&(_.error2d=l(S)),!0===_.line2d&&(_.line2d=n(S)),!0===_.scatter2d&&(_.scatter2d=r(S)),!0===_.fill2d&&(_.fill2d=n(S)),!0===_.glText)for(_.glText=Array(A),w=0;w<A;w++)_.glText[w]=new s(S);if(_.glText){if(A>_.glText.length){var C=A-_.glText.length;for(w=0;w<C;w++)_.glText.push(new s(S))}else if(A<_.glText.length){var L=_.glText.length-A,E=_.glText.splice(A,L);E.forEach(function(e){e.destroy()})}for(w=0;w<A;w++)_.glText[w].update(_.textOptions[w])}if(_.line2d&&(_.line2d.update(_.lineOptions),_.lineOptions=_.lineOptions.map(function(e){if(e&&e.positions){for(var t=e.positions,a=0;a<t.length&&(isNaN(t[a])||isNaN(t[a+1]));)a+=2;for(var o=t.length-2;o>a&&(isNaN(t[o])||isNaN(t[o+1]));)o-=2;e.positions=t.slice(a,o+2)}return e}),_.line2d.update(_.lineOptions)),_.error2d){var I=(_.errorXOptions||[]).concat(_.errorYOptions||[]);_.error2d.update(I)}_.scatter2d&&_.scatter2d.update(_.markerOptions),_.fillOrder=d.repeat(null,A),_.fill2d&&(_.fillOptions=_.fillOptions.map(function(e,t){var a=h[t];if(e&&a&&a[0]&&a[0].trace){var r=a[0],n=r.trace,l=r.t,s=_.lineOptions[t],d=[],c,p;n._ownfill&&d.push(t),n._nexttrace&&d.push(t+1),d.length&&(_.fillOrder[t]=d);var u=[],g=s&&s.positions||l.positions,m,y;if("tozeroy"===n.fill){for(m=0;m<g.length&&isNaN(g[m+1]);)m+=2;for(y=g.length-2;y>m&&isNaN(g[y+1]);)y-=2;0!==g[m+1]&&(u=[g[m],0]),u=u.concat(g.slice(m,y+2)),0!==g[y+1]&&(u=u.concat([g[y],0]))}else if("tozerox"===n.fill){for(m=0;m<g.length&&isNaN(g[m]);)m+=2;for(y=g.length-2;y>m&&isNaN(g[y]);)y-=2;0!==g[m]&&(u=[0,g[m+1]]),u=u.concat(g.slice(m,y+2)),0!==g[y]&&(u=u.concat([0,g[y+1]]))}else if("toself"===n.fill||"tonext"===n.fill){for(u=[],c=0,p=0;p<g.length;p+=2)(isNaN(g[p])||isNaN(g[p+1]))&&(u=u.concat(g.slice(c,p)),u.push(g[c],g[c+1]),c=p+2);u=u.concat(g.slice(c)),c&&u.push(g[c],g[c+1])}else{var f=n._nexttrace;if(f){var x=_.lineOptions[t+1];if(x){var b=x.positions;if("tonexty"===n.fill){for(u=g.slice(),t=o(b.length/2);t--;){var v=b[2*t],w=b[2*t+1];isNaN(v)||isNaN(w)||u.push(v,w)}e.fill=f.fillcolor}}}}if(n._prevtrace&&"tonext"===n._prevtrace.fill){var k=_.lineOptions[t-1].positions,T=u.length/2;c=T;var A=[c];for(p=0;p<k.length;p+=2)(isNaN(k[p])||isNaN(k[p+1]))&&(A.push(p/2+T+1),c=p+2);u=u.concat(k),e.hole=A}return e.fillmode=n.fill,e.opacity=n.opacity,e.positions=u,e}}),_.fill2d.update(_.fillOptions))}var P=f.dragmode,z=c(P),D=-1<f.clickmode.indexOf("select");for(w=0;w<A;w++){var O=h[w][0],R=O.trace,M=O.t,B=M.index,F=R._length,N=M.x,x=M.y;if(R.selectedpoints||z||D){if(z||(z=!0),R.selectedpoints){var y=_.selectBatch[B]=d.selIndices2selPoints(R),V={};for(k=0;k<y.length;k++)V[y[k]]=1;var U=[];for(k=0;k<F;k++)V[k]||U.push(k);_.unselectBatch[B]=U}var H=M.xpx=Array(F),q=M.ypx=Array(F);for(k=0;k<F;k++)H[k]=b.c2p(N[k]),q[k]=v.c2p(x[k])}else M.xpx=M.ypx=null}if(z){if(_.select2d||(_.select2d=r(f._glcanvas.data()[1].regl)),_.scatter2d){var G=Array(A);for(w=0;w<A;w++)G[w]=_.selectBatch[w].length||_.unselectBatch[w].length?_.markerUnselectedOptions[w]:{};_.scatter2d.update(G)}_.select2d&&(_.select2d.update(_.markerOptions),_.select2d.update(_.markerSelectedOptions)),_.glText&&h.forEach(function(e){var t=((e||[])[0]||{}).trace||{};u.hasText(t)&&m(e)})}else _.scatter2d&&_.scatter2d.update(_.markerOptions);var Y={viewport:a(f,b,v),range:[(b._rl||b.range)[0],(v._rl||v.range)[0],(b._rl||b.range)[1],(v._rl||v.range)[1]]},W=d.repeat(Y,_.count);_.fill2d&&_.fill2d.update(W),_.line2d&&_.line2d.update(W),_.error2d&&_.error2d.update(W.concat(W)),_.scatter2d&&_.scatter2d.update(W),_.select2d&&_.select2d.update(W),_.glText&&_.glText.forEach(function(e){e.update(Y)})}}}},{"../../components/dragelement/helpers":542,"../../lib":657,"../../lib/prepare_regl":670,"../scatter/link_traces":1078,"../scatter/subtypes":1086,"./edit_style":1118,"gl-text":291,"regl-error2d":1265,"regl-line2d":1266,"regl-scatter2d":1267}],1124:[function(e,t){'use strict';var a=e("../../lib");t.exports=function(e,t){var o=t._scene,r={count:0,dirty:!0,lineOptions:[],fillOptions:[],markerOptions:[],markerSelectedOptions:[],markerUnselectedOptions:[],errorXOptions:[],errorYOptions:[],textOptions:[],textSelectedOptions:[],textUnselectedOptions:[],selectBatch:[],unselectBatch:[]},i={fill2d:!1,scatter2d:!1,error2d:!1,line2d:!1,glText:!1,select2d:!1};return t._scene||(o=t._scene={},o.init=function(){a.extendFlat(o,i,r)},o.init(),o.update=function(e){var t=a.repeat(e,o.count);if(o.fill2d&&o.fill2d.update(t),o.scatter2d&&o.scatter2d.update(t),o.line2d&&o.line2d.update(t),o.error2d&&o.error2d.update(t.concat(t)),o.select2d&&o.select2d.update(t),o.glText)for(var r=0;r<o.count;r++)o.glText[r].update(e)},o.draw=function(){for(var e=o.count,t=o.fill2d,r=o.error2d,n=o.line2d,l=o.scatter2d,s=o.glText,d=o.select2d,c=o.selectBatch,p=o.unselectBatch,u=0;u<e;u++){if(t&&o.fillOrder[u]&&t.draw(o.fillOrder[u]),n&&o.lineOptions[u]&&n.draw(u),r&&(o.errorXOptions[u]&&r.draw(u),o.errorYOptions[u]&&r.draw(u+e)),l&&o.markerOptions[u])if(p[u].length){var g=a.repeat([],o.count);g[u]=p[u],l.draw(g)}else c[u].length||l.draw(u);s[u]&&o.textOptions[u]&&s[u].render()}d&&d.draw(c),o.dirty=!1},o.destroy=function(){o.fill2d&&o.fill2d.destroy&&o.fill2d.destroy(),o.scatter2d&&o.scatter2d.destroy&&o.scatter2d.destroy(),o.error2d&&o.error2d.destroy&&o.error2d.destroy(),o.line2d&&o.line2d.destroy&&o.line2d.destroy(),o.select2d&&o.select2d.destroy&&o.select2d.destroy(),o.glText&&o.glText.forEach(function(e){e.destroy&&e.destroy()}),o.lineOptions=null,o.fillOptions=null,o.markerOptions=null,o.markerSelectedOptions=null,o.markerUnselectedOptions=null,o.errorXOptions=null,o.errorYOptions=null,o.textOptions=null,o.textSelectedOptions=null,o.textUnselectedOptions=null,o.selectBatch=null,o.unselectBatch=null,t._scene=null}),o.dirty||a.extendFlat(o,r),o}},{"../../lib":657}],1125:[function(e,t){'use strict';var a=e("../scatter/subtypes"),o=e("./edit_style").styleTextSelection;t.exports=function(e,t){var r=e.cd,n=[],l=r[0].trace,s=r[0].t,d=l._length,c=s.x,p=s.y,u=s._scene,g=s.index;if(!u)return n;var m=a.hasText(l),h=a.hasMarkers(l);if(!0!==l.visible||!h&&!m)return n;var y=[],f=[];if(!1!==t&&!t.degenerate)for(var x=0;x<d;x++)t.contains([s.xpx[x],s.ypx[x]],!1,x,e)?(y.push(x),n.push({pointNumber:x,x:c[x],y:p[x]})):f.push(x);if(h){var _=u.scatter2d;if(!y.length&&!f.length){var b=Array(u.count);b[g]=u.markerOptions[g],_.update.apply(_,b)}else if(!u.selectBatch[g].length&&!u.unselectBatch[g].length){var v=Array(u.count);v[g]=u.markerUnselectedOptions[g],_.update.apply(_,v)}}return u.selectBatch[g]=y,u.unselectBatch[g]=f,m&&o(r),n}},{"../scatter/subtypes":1086,"./edit_style":1118}],1126:[function(e,t){'use strict';var a=e("../../plots/template_attributes").hovertemplateAttrs,o=e("../../plots/template_attributes").texttemplateAttrs,r=e("../scattergeo/attributes"),i=e("../scatter/attributes"),n=e("../../plots/mapbox/layout_attributes"),l=e("../../plots/attributes"),s=e("../../components/colorscale/attributes"),d=e("../../lib/extend").extendFlat,c=e("../../plot_api/edit_types").overrideAll,p=r.line,u=r.marker;t.exports=c({lon:r.lon,lat:r.lat,mode:d({},i.mode,{dflt:"markers"}),text:d({},i.text,{}),texttemplate:o({editType:"plot"},{keys:["lat","lon","text"]}),hovertext:d({},i.hovertext,{}),line:{color:p.color,width:p.width},connectgaps:i.connectgaps,marker:d({symbol:{valType:"string",dflt:"circle",arrayOk:!0},angle:{valType:"number",dflt:"auto",arrayOk:!0},allowoverlap:{valType:"boolean",dflt:!1},opacity:u.opacity,size:u.size,sizeref:u.sizeref,sizemin:u.sizemin,sizemode:u.sizemode},s("marker")),fill:r.fill,fillcolor:i.fillcolor,textfont:n.layers.symbol.textfont,textposition:n.layers.symbol.textposition,below:{valType:"string"},selected:{marker:i.selected.marker},unselected:{marker:i.unselected.marker},hoverinfo:d({},l.hoverinfo,{flags:["lon","lat","text","name"]}),hovertemplate:a()},"calc","nested")},{"../../components/colorscale/attributes":531,"../../lib/extend":648,"../../plot_api/edit_types":688,"../../plots/attributes":702,"../../plots/mapbox/layout_attributes":764,"../../plots/template_attributes":783,"../scatter/attributes":1062,"../scattergeo/attributes":1103}],1127:[function(e,t){'use strict';function a(){return{geojson:u.makeBlank(),layout:{visibility:"none"},paint:{}}}function o(e){function t(e){return a.opacity*e}var a=e[0].trace,o=a.marker,r=a.selectedpoints,n=c.isArrayOrTypedArray(o.color),l=c.isArrayOrTypedArray(o.size),p=c.isArrayOrTypedArray(o.opacity),u,y;n&&(g.hasColorscale(a,"marker")?y=g.makeColorScaleFuncFromTrace(o):y=c.identity);var f;l&&(f=h(a));var x;p&&(x=function(e){var a=d(e)?+c.constrain(e,0,1):0;return t(a)});var _=[];for(u=0;u<e.length;u++){var b=e[u],v=b.lonlat;if(!s(v)){var w={};y&&(w.mcc=b.mcc=y(b.mc)),f&&(w.mrc=b.mrc=f(b.ms)),x&&(w.mo=x(b.mo)),r&&(w.selected=b.selected||0),_.push({type:"Feature",geometry:{type:"Point",coordinates:v},properties:w})}}var k;if(r)for(k=m.makeSelectedPointStyleFns(a),u=0;u<_.length;u++){var T=_[u].properties;k.selectedOpacityFn&&(T.mo=t(k.selectedOpacityFn(T))),k.selectedColorFn&&(T.mcc=k.selectedColorFn(T)),k.selectedSizeFn&&(T.mrc=k.selectedSizeFn(T))}return{geojson:{type:"FeatureCollection",features:_},mcc:n||k&&k.selectedColorFn?{type:"identity",property:"mcc"}:o.color,mrc:l||k&&k.selectedSizeFn?{type:"identity",property:"mrc"}:function(e){return e/2}(o.size),mo:p||k&&k.selectedOpacityFn?{type:"identity",property:"mo"}:t(o.opacity)}}function r(e,t){for(var a=t._fullLayout,o=e[0].trace,r=o.marker||{},d=r.symbol,p=r.angle,u="circle"===d?l:n(d),g="auto"===p?l:n(p,!0),m=y.hasText(o)?n(o.text):l,h=[],f=0,v;f<e.length;f++)if(v=e[f],!s(v.lonlat)){var w=o.texttemplate,k;if(w){var T=Array.isArray(w)?w[f]||"":w,A=o._module.formatLabels(v,o,a),S={};x(S,o,v.i);var C=o._meta||{};k=c.texttemplateString(T,A,a._d3locale,S,v,C)}else k=m(f);k&&(k=k.replace(_,"").replace(b,"\n")),h.push({type:"Feature",geometry:{type:"Point",coordinates:v.lonlat},properties:{symbol:u(f),angle:g(f),text:k}})}return{type:"FeatureCollection",features:h}}function n(e,t){return c.isArrayOrTypedArray(e)?t?function(t){return d(e[t])?+e[t]:0}:function(t){return e[t]}:e?function(){return e}:l}function l(){return""}function s(e){return e[0]===p}var d=e("fast-isnumeric"),c=e("../../lib"),p=e("../../constants/numerical").BADNUM,u=e("../../lib/geojson_utils"),g=e("../../components/colorscale"),m=e("../../components/drawing"),h=e("../scatter/make_bubble_size_func"),y=e("../scatter/subtypes"),f=e("../../plots/mapbox/convert_text_opts"),x=e("../../components/fx/helpers").appendArrayPointValue,_=e("../../lib/svg_text_utils").NEWLINES,b=e("../../lib/svg_text_utils").BR_TAG_ALL;t.exports=function(e,t){var i=t[0].trace,n=!0===i.visible&&0!==i._length,l="none"!==i.fill,s=y.hasLines(i),d=y.hasMarkers(i),p=y.hasText(i),g=d&&"circle"===i.marker.symbol,m=d&&"circle"!==i.marker.symbol,h=a(),x=a(),_=a(),b=a(),v={fill:h,line:x,circle:_,symbol:b};if(!n)return v;var w;if((l||s)&&(w=u.calcTraceToLineCoords(t)),l&&(h.geojson=u.makePolygon(w),h.layout.visibility="visible",c.extendFlat(h.paint,{"fill-color":i.fillcolor})),s&&(x.geojson=u.makeLine(w),x.layout.visibility="visible",c.extendFlat(x.paint,{"line-width":i.line.width,"line-color":i.line.color,"line-opacity":i.opacity})),g){var k=o(t);_.geojson=k.geojson,_.layout.visibility="visible",c.extendFlat(_.paint,{"circle-color":k.mcc,"circle-radius":k.mrc,"circle-opacity":k.mo})}if((m||p)&&(b.geojson=r(t,e),c.extendFlat(b.layout,{visibility:"visible","icon-image":"{symbol}-15","text-field":"{text}"}),m&&(c.extendFlat(b.layout,{"icon-size":i.marker.size/10}),"angle"in i.marker&&"auto"!==i.marker.angle&&c.extendFlat(b.layout,{"icon-rotate":{type:"identity",property:"angle"},"icon-rotation-alignment":"map"}),b.layout["icon-allow-overlap"]=i.marker.allowoverlap,c.extendFlat(b.paint,{"icon-opacity":i.opacity*i.marker.opacity,"icon-color":i.marker.color})),p)){var T=(i.marker||{}).size,A=f(i.textposition,T);c.extendFlat(b.layout,{"text-size":i.textfont.size,"text-anchor":A.anchor,"text-offset":A.offset}),c.extendFlat(b.paint,{"text-color":i.textfont.color,"text-opacity":i.opacity})}return v}},{"../../components/colorscale":536,"../../components/drawing":546,"../../components/fx/helpers":560,"../../constants/numerical":633,"../../lib":657,"../../lib/geojson_utils":652,"../../lib/svg_text_utils":681,"../../plots/mapbox/convert_text_opts":761,"../scatter/make_bubble_size_func":1079,"../scatter/subtypes":1086,"fast-isnumeric":201}],1128:[function(e,t){'use strict';var o=Math.min;function a(e,t,a){var r=a("lon")||[],i=a("lat")||[],n=o(r.length,i.length);return t._length=n,n}var r=e("../../lib"),i=e("../scatter/subtypes"),n=e("../scatter/marker_defaults"),l=e("../scatter/line_defaults"),s=e("../scatter/text_defaults"),d=e("../scatter/fillcolor_defaults"),c=e("./attributes");t.exports=function(e,t,o,p){function u(a,o){return r.coerce(e,t,c,a,o)}var g=a(e,t,u);if(!g)return void(t.visible=!1);if(u("text"),u("texttemplate"),u("hovertext"),u("hovertemplate"),u("mode"),u("below"),i.hasLines(t)&&(l(e,t,o,p,u,{noDash:!0}),u("connectgaps")),i.hasMarkers(t)){n(e,t,o,p,u,{noLine:!0}),u("marker.allowoverlap"),u("marker.angle");var m=t.marker;"circle"!==m.symbol&&(r.isArrayOrTypedArray(m.size)&&(m.size=m.size[0]),r.isArrayOrTypedArray(m.color)&&(m.color=m.color[0]))}i.hasText(t)&&s(e,t,p,u,{noSelect:!0}),u("fill"),"none"!==t.fill&&d(e,t,o,u),r.coerceSelectionMarkerOpacity(t,u)}},{"../../lib":657,"../scatter/fillcolor_defaults":1070,"../scatter/line_defaults":1075,"../scatter/marker_defaults":1081,"../scatter/subtypes":1086,"../scatter/text_defaults":1087,"./attributes":1126}],1129:[function(e,t){'use strict';t.exports=function(e,t){return e.lon=t.lon,e.lat=t.lat,e}},{}],1130:[function(e,t){'use strict';var a=e("../../plots/cartesian/axes");t.exports=function(e,t,o){var r={},i=o[t.subplot]._subplot,n=i.mockAxis,l=e.lonlat;return r.lonLabel=a.tickText(n,n.c2l(l[0]),!0).text,r.latLabel=a.tickText(n,n.c2l(l[1]),!0).text,r}},{"../../plots/cartesian/axes":705}],1131:[function(e,t){'use strict';var o=Math.ceil,r=Math.sqrt,i=Math.max,n=Math.floor;function a(e,t,a){function o(e){return e+"\xB0"}if(!e.hovertemplate){var r=t.hi||e.hoverinfo,i=r.split("+"),n=-1!==i.indexOf("all"),l=-1!==i.indexOf("lon"),s=-1!==i.indexOf("lat"),d=t.lonlat,p=[];return n||l&&s?p.push("("+o(d[0])+", "+o(d[1])+")"):l?p.push(a.lon+o(d[0])):s&&p.push(a.lat+o(d[1])),(n||-1!==i.indexOf("text"))&&c(t,e,p),p.join("<br>")}}var l=e("../../components/fx"),s=e("../../lib"),d=e("../scatter/get_trace_color"),c=s.fillText,p=e("../../constants/numerical").BADNUM;t.exports=function(e,t,c){var u=e.cd,g=u[0].trace,m=e.xa,h=e.ya,y=e.subplot,f=0<=t?n((t+180)/360):o((t-180)/360),x=360*f;if(l.getClosest(u,function(e){var a=e.lonlat;if(a[0]===p)return 1/0;var o=s.modHalf(a[0],360),n=a[1],l=y.project([o,n]),d=l.x-m.c2p([t-x,n]),u=l.y-h.c2p([o,c]),g=i(3,e.mrc||0);return i(r(d*d+u*u)-g,1-3/g)},e),!1!==e.index){var _=u[e.index],b=_.lonlat,v=[s.modHalf(b[0],360)+x,b[1]],w=m.c2p(v),k=h.c2p(v),T=_.mrc||1;e.x0=w-T,e.x1=w+T,e.y0=k-T,e.y1=k+T;var A={};A[g.subplot]={_subplot:y};var S=g._module.formatLabels(_,g,A);return e.lonLabel=S.lonLabel,e.latLabel=S.latLabel,e.color=d(g,_),e.extraText=a(g,_,u[0].t.labels),e.hovertemplate=g.hovertemplate,[e]}}},{"../../components/fx":564,"../../constants/numerical":633,"../../lib":657,"../scatter/get_trace_color":1072}],1132:[function(e,t){'use strict';t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../scatter/marker_colorbar"),formatLabels:e("./format_labels"),calc:e("../scattergeo/calc"),plot:e("./plot"),hoverPoints:e("./hover"),eventData:e("./event_data"),selectPoints:e("./select"),styleOnSelect:function(e,t){if(t){var a=t[0].trace;a._glTrace.update(t)}},moduleType:"trace",name:"scattermapbox",basePlotModule:e("../../plots/mapbox"),categories:["mapbox","gl","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/mapbox":762,"../scatter/marker_colorbar":1080,"../scattergeo/calc":1104,"./attributes":1126,"./defaults":1128,"./event_data":1129,"./format_labels":1130,"./hover":1131,"./plot":1133,"./select":1134}],1133:[function(e,t){'use strict';function a(e,t){this.type="scattermapbox",this.subplot=e,this.uid=t,this.sourceIds={fill:"source-"+t+"-fill",line:"source-"+t+"-line",circle:"source-"+t+"-circle",symbol:"source-"+t+"-symbol"},this.layerIds={fill:r+t+"-fill",line:r+t+"-line",circle:r+t+"-circle",symbol:r+t+"-symbol"},this.below=null}var o=e("./convert"),r=e("../../plots/mapbox/constants").traceLayerPrefix,n=["fill","line","circle","symbol"],l=a.prototype;l.addSource=function(e,t){this.subplot.map.addSource(this.sourceIds[e],{type:"geojson",data:t.geojson})},l.setSourceData=function(e,t){this.subplot.map.getSource(this.sourceIds[e]).setData(t.geojson)},l.addLayer=function(e,t,a){this.subplot.addLayer({type:e,id:this.layerIds[e],source:this.sourceIds[e],layout:t.layout,paint:t.paint},a)},l.update=function(e){var t=this.subplot,a=t.map,r=o(t.gd,e),l=t.belowLookup["trace-"+this.uid],s,d,c;if(l!==this.below){for(s=n.length-1;0<=s;s--)d=n[s],a.removeLayer(this.layerIds[d]);for(s=0;s<n.length;s++)d=n[s],c=r[d],this.addLayer(d,c,l);this.below=l}for(s=0;s<n.length;s++)d=n[s],c=r[d],t.setOptions(this.layerIds[d],"setLayoutProperty",c.layout),"visible"===c.layout.visibility&&(this.setSourceData(d,c),t.setOptions(this.layerIds[d],"setPaintProperty",c.paint));e[0].trace._glTrace=this},l.dispose=function(){for(var e=this.subplot.map,t=n.length-1,a;0<=t;t--)a=n[t],e.removeLayer(this.layerIds[a]),e.removeSource(this.sourceIds[a])},t.exports=function(e,t){for(var r=t[0].trace,l=new a(e,r.uid),s=o(e.gd,t),d=l.below=e.belowLookup["trace-"+r.uid],c=0;c<n.length;c++){var p=n[c],u=s[p];l.addSource(p,u),l.addLayer(p,u,d)}return t[0].trace._glTrace=l,l}},{"../../plots/mapbox/constants":760,"./convert":1127}],1134:[function(e,t){'use strict';var a=e("../../lib"),o=e("../scatter/subtypes"),r=e("../../constants/numerical").BADNUM;t.exports=function(e,t){var n=e.cd,l=e.xaxis,s=e.yaxis,d=[],c=n[0].trace,p;if(!o.hasMarkers(c))return[];if(!1===t)for(p=0;p<n.length;p++)n[p].selected=0;else for(p=0;p<n.length;p++){var u=n[p],g=u.lonlat;if(g[0]!==r){var m=[a.modHalf(g[0],360),g[1]],h=[l.c2p(m),s.c2p(m)];t.contains(h,null,p,e)?(d.push({pointNumber:p,lon:g[0],lat:g[1]}),u.selected=1):u.selected=0}}return d}},{"../../constants/numerical":633,"../../lib":657,"../scatter/subtypes":1086}],1135:[function(e,t){'use strict';var a=e("../../plots/template_attributes").hovertemplateAttrs,o=e("../../plots/template_attributes").texttemplateAttrs,r=e("../../lib/extend").extendFlat,i=e("../scatter/attributes"),n=e("../../plots/attributes"),l=i.line;t.exports={mode:i.mode,r:{valType:"data_array",editType:"calc+clearAxisTypes"},theta:{valType:"data_array",editType:"calc+clearAxisTypes"},r0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dr:{valType:"number",dflt:1,editType:"calc"},theta0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dtheta:{valType:"number",editType:"calc"},thetaunit:{valType:"enumerated",values:["radians","degrees","gradians"],dflt:"degrees",editType:"calc+clearAxisTypes"},text:i.text,texttemplate:o({editType:"plot"},{keys:["r","theta","text"]}),hovertext:i.hovertext,line:{color:l.color,width:l.width,dash:l.dash,shape:r({},l.shape,{values:["linear","spline"]}),smoothing:l.smoothing,editType:"calc"},connectgaps:i.connectgaps,marker:i.marker,cliponaxis:r({},i.cliponaxis,{dflt:!1}),textposition:i.textposition,textfont:i.textfont,fill:r({},i.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:i.fillcolor,hoverinfo:r({},n.hoverinfo,{flags:["r","theta","text","name"]}),hoveron:i.hoveron,hovertemplate:a(),selected:i.selected,unselected:i.unselected}},{"../../lib/extend":648,"../../plots/attributes":702,"../../plots/template_attributes":783,"../scatter/attributes":1062}],1136:[function(e,t){'use strict';var a=e("fast-isnumeric"),o=e("../../constants/numerical").BADNUM,n=e("../../plots/cartesian/axes"),l=e("../scatter/colorscale_calc"),s=e("../scatter/arrays_to_calcdata"),d=e("../scatter/calc_selection"),c=e("../scatter/calc").calcMarkerSize;t.exports=function(e,t){for(var p=e._fullLayout,u=t.subplot,g=p[u].radialaxis,m=p[u].angularaxis,h=g.makeCalcdata(t,"r"),y=m.makeCalcdata(t,"theta"),f=t._length,x=Array(f),_=0;_<f;_++){var b=h[_],r=y[_],v=x[_]={};a(b)&&a(r)?(v.r=b,v.theta=r):v.r=o}var w=c(t,f);return t._extremes.x=n.findExtremes(g,h,{ppad:w}),l(e,t),s(x,t),d(x,t),x}},{"../../constants/numerical":633,"../../plots/cartesian/axes":705,"../scatter/arrays_to_calcdata":1061,"../scatter/calc":1063,"../scatter/calc_selection":1064,"../scatter/colorscale_calc":1065,"fast-isnumeric":201}],1137:[function(e,t){'use strict';var o=Math.min;function a(e,t,a,i){var n=i("r"),r=i("theta"),l;if(n)r?l=o(n.length,r.length):(l=n.length,i("theta0"),i("dtheta"));else{if(!r)return 0;l=t.theta.length,i("r0"),i("dr")}return t._length=l,l}var r=e("../../lib"),i=e("../scatter/subtypes"),n=e("../scatter/marker_defaults"),l=e("../scatter/line_defaults"),s=e("../scatter/line_shape_defaults"),d=e("../scatter/text_defaults"),c=e("../scatter/fillcolor_defaults"),p=e("../scatter/constants").PTS_LINESONLY,u=e("./attributes");t.exports={handleRThetaDefaults:a,supplyDefaults:function(e,t,o,g){function m(a,o){return r.coerce(e,t,u,a,o)}var h=a(e,t,g,m);if(!h)return void(t.visible=!1);m("thetaunit"),m("mode",h<p?"lines+markers":"lines"),m("text"),m("hovertext"),"fills"!==t.hoveron&&m("hovertemplate"),i.hasLines(t)&&(l(e,t,o,g,m),s(e,t,m),m("connectgaps")),i.hasMarkers(t)&&n(e,t,o,g,m,{gradient:!0}),i.hasText(t)&&(m("texttemplate"),d(e,t,g,m));var y=[];(i.hasMarkers(t)||i.hasText(t))&&(m("cliponaxis"),m("marker.maxdisplayed"),y.push("points")),m("fill"),"none"!==t.fill&&(c(e,t,o,m),!i.hasLines(t)&&s(e,t,m)),("tonext"===t.fill||"toself"===t.fill)&&y.push("fills"),m("hoveron",y.join("+")||"points"),r.coerceSelectionMarkerOpacity(t,m)}}},{"../../lib":657,"../scatter/constants":1066,"../scatter/fillcolor_defaults":1070,"../scatter/line_defaults":1075,"../scatter/line_shape_defaults":1077,"../scatter/marker_defaults":1081,"../scatter/subtypes":1086,"../scatter/text_defaults":1087,"./attributes":1135}],1138:[function(e,t){'use strict';var a=e("../../lib"),o=e("../../plots/cartesian/axes");t.exports=function(e,t,r){var i={},n=r[t.subplot]._subplot,l,s;n?(l=n.radialAxis,s=n.angularAxis):(n=r[t.subplot],l=n.radialaxis,s=n.angularaxis);var d=l.c2l(e.r);i.rLabel=o.tickText(l,d,!0).text;var c="degrees"===s.thetaunit?a.rad2deg(e.theta):e.theta;return i.thetaLabel=o.tickText(s,c,!0).text,i}},{"../../lib":657,"../../plots/cartesian/axes":705}],1139:[function(e,t){'use strict';function a(e,t,a,o){function r(e,t){c.push(e._hovertitle+": "+t)}var i=a.radialAxis,n=a.angularAxis;i._hovertitle="r",n._hovertitle="\u03B8";var l={};l[t.subplot]={_subplot:a};var s=t._module.formatLabels(e,t,l);o.rLabel=s.rLabel,o.thetaLabel=s.thetaLabel;var d=e.hi||t.hoverinfo,c=[];if(!t.hovertemplate){var p=d.split("+");-1!==p.indexOf("all")&&(p=["r","theta","text"]),-1!==p.indexOf("r")&&r(i,o.rLabel),-1!==p.indexOf("theta")&&r(n,o.thetaLabel),-1!==p.indexOf("text")&&o.text&&(c.push(o.text),delete o.text),o.extraText=c.join("<br>")}}var o=e("../scatter/hover");t.exports={hoverPoints:function(e,t,r,i){var n=o(e,t,r,i);if(n&&!1!==n[0].index){var l=n[0];if(void 0===l.index)return n;var s=e.subplot,d=l.cd[l.index],c=l.trace;if(s.isPtInside(d))return l.xLabelVal=void 0,l.yLabelVal=void 0,a(d,c,s,l),l.hovertemplate=c.hovertemplate,n}},makeHoverPointText:a}},{"../scatter/hover":1073}],1140:[function(e,t){'use strict';t.exports={moduleType:"trace",name:"scatterpolar",basePlotModule:e("../../plots/polar"),categories:["polar","symbols","showLegend","scatter-like"],attributes:e("./attributes"),supplyDefaults:e("./defaults").supplyDefaults,colorbar:e("../scatter/marker_colorbar"),formatLabels:e("./format_labels"),calc:e("./calc"),plot:e("./plot"),style:e("../scatter/style").style,styleOnSelect:e("../scatter/style").styleOnSelect,hoverPoints:e("./hover").hoverPoints,selectPoints:e("../scatter/select"),meta:{}}},{"../../plots/polar":771,"../scatter/marker_colorbar":1080,"../scatter/select":1083,"../scatter/style":1085,"./attributes":1135,"./calc":1136,"./defaults":1137,"./format_labels":1138,"./hover":1139,"./plot":1141}],1141:[function(e,t){'use strict';var a=e("../scatter/plot"),o=e("../../constants/numerical").BADNUM;t.exports=function(e,t,n){for(var l=t.layers.frontplot.select("g.scatterlayer"),s={xaxis:t.xaxis,yaxis:t.yaxis,plot:t.framework,layerClipId:t._hasClipOnAxisFalse?t.clipIds.forTraces:null},d=t.radialAxis,c=t.angularAxis,p=0,u;p<n.length;p++){u=n[p];for(var g=0;g<u.length;g++){var m=u[g],h=m.r;if(h===o)m.x=m.y=o;else{var r=d.c2g(h),y=c.c2g(m.theta);m.x=r*Math.cos(y),m.y=r*Math.sin(y)}}}a(e,s,n,l)}},{"../../constants/numerical":633,"../scatter/plot":1082}],1142:[function(e,t){'use strict';var a=e("../scatterpolar/attributes"),o=e("../scattergl/attributes"),r=e("../../plots/template_attributes").texttemplateAttrs;t.exports={mode:a.mode,r:a.r,theta:a.theta,r0:a.r0,dr:a.dr,theta0:a.theta0,dtheta:a.dtheta,thetaunit:a.thetaunit,text:a.text,texttemplate:r({editType:"plot"},{keys:["r","theta","text"]}),hovertext:a.hovertext,hovertemplate:a.hovertemplate,line:o.line,connectgaps:o.connectgaps,marker:o.marker,fill:o.fill,fillcolor:o.fillcolor,textposition:o.textposition,textfont:o.textfont,hoverinfo:a.hoverinfo,selected:a.selected,unselected:a.unselected}},{"../../plots/template_attributes":783,"../scattergl/attributes":1113,"../scatterpolar/attributes":1135}],1143:[function(e,t){'use strict';var a=Math.max,o=e("../scatter/colorscale_calc"),r=e("../scatter/calc").calcMarkerSize,i=e("../scattergl/convert"),n=e("../../plots/cartesian/axes"),l=e("../scattergl/constants").TOO_MANY_POINTS;t.exports=function(e,t){var s=e._fullLayout,d=t.subplot,c=s[d].radialaxis,p=s[d].angularaxis,u=t._r=c.makeCalcdata(t,"r"),g=t._theta=p.makeCalcdata(t,"theta"),m=t._length,h={};m<u.length&&(u=u.slice(0,m)),m<g.length&&(g=g.slice(0,m)),h.r=u,h.theta=g,o(e,t);var y=h.opts=i.style(e,t),f;return m<l?f=r(t,m):y.marker&&(f=2*(y.marker.sizeAvg||a(y.marker.size,3))),t._extremes.x=n.findExtremes(c,u,{ppad:f}),[{x:!1,y:!1,t:h,trace:t}]}},{"../../plots/cartesian/axes":705,"../scatter/calc":1063,"../scatter/colorscale_calc":1065,"../scattergl/constants":1115,"../scattergl/convert":1116}],1144:[function(e,t){'use strict';var a=e("../../lib"),o=e("../scatter/subtypes"),r=e("../scatterpolar/defaults").handleRThetaDefaults,i=e("../scatter/marker_defaults"),n=e("../scatter/line_defaults"),l=e("../scatter/text_defaults"),s=e("../scatter/fillcolor_defaults"),d=e("../scatter/constants").PTS_LINESONLY,c=e("./attributes");t.exports=function(e,t,p,u){function g(o,r){return a.coerce(e,t,c,o,r)}var m=r(e,t,u,g);return m?void(g("thetaunit"),g("mode",m<d?"lines+markers":"lines"),g("text"),g("hovertext"),"fills"!==t.hoveron&&g("hovertemplate"),o.hasLines(t)&&(n(e,t,p,u,g),g("connectgaps")),o.hasMarkers(t)&&i(e,t,p,u,g),o.hasText(t)&&(g("texttemplate"),l(e,t,u,g)),g("fill"),"none"!==t.fill&&s(e,t,p,g),a.coerceSelectionMarkerOpacity(t,g)):void(t.visible=!1)}},{"../../lib":657,"../scatter/constants":1066,"../scatter/fillcolor_defaults":1070,"../scatter/line_defaults":1075,"../scatter/marker_defaults":1081,"../scatter/subtypes":1086,"../scatter/text_defaults":1087,"../scatterpolar/defaults":1137,"./attributes":1142}],1145:[function(e,t){'use strict';var a=e("../scatterpolar/format_labels");t.exports=function(e,t,o){var r=e.i;return"r"in e||(e.r=t._r[r]),"theta"in e||(e.theta=t._theta[r]),a(e,t,o)}},{"../scatterpolar/format_labels":1138}],1146:[function(e,t){'use strict';var a=e("../scattergl/hover"),o=e("../scatterpolar/hover").makeHoverPointText;t.exports={hoverPoints:function(e,t,r,i){var n=e.cd,l=n[0].t,s=l.r,d=l.theta,c=a.hoverPoints(e,t,r,i);if(c&&!1!==c[0].index){var p=c[0];if(void 0===p.index)return c;var u=e.subplot,g=p.cd[p.index],m=p.trace;if(g.r=s[p.index],g.theta=d[p.index],!!u.isPtInside(g))return p.xLabelVal=void 0,p.yLabelVal=void 0,o(g,m,u,p),c}}}},{"../scattergl/hover":1121,"../scatterpolar/hover":1139}],1147:[function(e,t){'use strict';t.exports={moduleType:"trace",name:"scatterpolargl",basePlotModule:e("../../plots/polar"),categories:["gl","regl","polar","symbols","showLegend","scatter-like"],attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../scatter/marker_colorbar"),formatLabels:e("./format_labels"),calc:e("./calc"),plot:e("./plot"),hoverPoints:e("./hover").hoverPoints,selectPoints:e("../scattergl/select"),meta:{}}},{"../../plots/polar":771,"../scatter/marker_colorbar":1080,"../scattergl/select":1125,"./attributes":1142,"./calc":1143,"./defaults":1144,"./format_labels":1145,"./hover":1146,"./plot":1148}],1148:[function(e,t){'use strict';var a=Math.cos,o=Math.sin,n=e("point-cluster"),l=e("fast-isnumeric"),s=e("../scattergl/plot"),d=e("../scattergl/scene_update"),c=e("../scattergl/convert"),p=e("../../lib"),u=e("../scattergl/constants").TOO_MANY_POINTS;t.exports=function(e,t,r){if(r.length){var g=t.radialAxis,m=t.angularAxis,h=d(e,t);return r.forEach(function(s){if(s&&s[0]&&s[0].trace){var d=s[0],f=d.trace,_=d.t,b=f._length,v=_.r,w=_.theta,k=_.opts,T=v.slice(),A=w.slice(),S;for(S=0;S<v.length;S++)t.isPtInside({r:v[S],theta:w[S]})||(T[S]=NaN,A[S]=NaN);var C=Array(2*b),L=Array(b),x=Array(b);for(S=0;S<b;S++){var y=T[S],r,E;if(l(y)){var I=g.c2g(y),P=m.c2g(A[S],f.thetaunit);r=I*a(P),E=I*o(P)}else r=E=NaN;L[S]=C[2*S]=r,x[S]=C[2*S+1]=E}_.tree=n(C),k.marker&&b>=u&&(k.marker.cluster=_.tree),k.marker&&(k.markerSel.positions=k.markerUnsel.positions=k.marker.positions=C),k.line&&1<C.length&&p.extendFlat(k.line,c.linePositions(e,f,C)),k.text&&(p.extendFlat(k.text,{positions:C},c.textPosition(e,f,k.text,k.marker)),p.extendFlat(k.textSel,{positions:C},c.textPosition(e,f,k.text,k.markerSel)),p.extendFlat(k.textUnsel,{positions:C},c.textPosition(e,f,k.text,k.markerUnsel))),k.fill&&!h.fill2d&&(h.fill2d=!0),k.marker&&!h.scatter2d&&(h.scatter2d=!0),k.line&&!h.line2d&&(h.line2d=!0),k.text&&!h.glText&&(h.glText=!0),h.lineOptions.push(k.line),h.fillOptions.push(k.fill),h.markerOptions.push(k.marker),h.markerSelectedOptions.push(k.markerSel),h.markerUnselectedOptions.push(k.markerUnsel),h.textOptions.push(k.text),h.textSelectedOptions.push(k.textSel),h.textUnselectedOptions.push(k.textUnsel),h.selectBatch.push([]),h.unselectBatch.push([]),_.x=L,_.y=x,_.rawx=L,_.rawy=x,_.r=v,_.theta=w,_.positions=C,_._scene=h,_.index=h.count,h.count++}}),s(e,t,r)}}},{"../../lib":657,"../scattergl/constants":1115,"../scattergl/convert":1116,"../scattergl/plot":1123,"../scattergl/scene_update":1124,"fast-isnumeric":201,"point-cluster":1245}],1149:[function(e,t){'use strict';var a=e("../../plots/template_attributes").hovertemplateAttrs,o=e("../../plots/template_attributes").texttemplateAttrs,r=e("../scatter/attributes"),i=e("../../plots/attributes"),n=e("../../components/colorscale/attributes"),l=e("../../components/drawing/attributes").dash,s=e("../../lib/extend").extendFlat,d=r.marker,c=r.line,p=d.line;t.exports={a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},c:{valType:"data_array",editType:"calc"},sum:{valType:"number",dflt:0,min:0,editType:"calc"},mode:s({},r.mode,{dflt:"markers"}),text:s({},r.text,{}),texttemplate:o({editType:"plot"},{keys:["a","b","c","text"]}),hovertext:s({},r.hovertext,{}),line:{color:c.color,width:c.width,dash:l,shape:s({},c.shape,{values:["linear","spline"]}),smoothing:c.smoothing,editType:"calc"},connectgaps:r.connectgaps,cliponaxis:r.cliponaxis,fill:s({},r.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:r.fillcolor,marker:s({symbol:d.symbol,opacity:d.opacity,maxdisplayed:d.maxdisplayed,size:d.size,sizeref:d.sizeref,sizemin:d.sizemin,sizemode:d.sizemode,line:s({width:p.width,editType:"calc"},n("marker.line")),gradient:d.gradient,editType:"calc"},n("marker")),textfont:r.textfont,textposition:r.textposition,selected:r.selected,unselected:r.unselected,hoverinfo:s({},i.hoverinfo,{flags:["a","b","c","text","name"]}),hoveron:r.hoveron,hovertemplate:a()}},{"../../components/colorscale/attributes":531,"../../components/drawing/attributes":545,"../../lib/extend":648,"../../plots/attributes":702,"../../plots/template_attributes":783,"../scatter/attributes":1062}],1150:[function(e,t){'use strict';var o=e("fast-isnumeric"),r=e("../scatter/colorscale_calc"),n=e("../scatter/arrays_to_calcdata"),l=e("../scatter/calc_selection"),s=e("../scatter/calc").calcMarkerSize,d=["a","b","c"],c={a:["b","c"],b:["a","c"],c:["a","b"]};t.exports=function(e,t){var p=e._fullLayout[t.subplot],u=p.sum,g=t.sum||u,m={a:t.a,b:t.b,c:t.c},h,f,_,v,w,k;for(h=0;h<d.length;h++)if(_=d[h],!m[_]){for(w=m[c[_][0]],k=m[c[_][1]],v=Array(w.length),f=0;f<w.length;f++)v[f]=g-w[f]-k[f];m[_]=v}var T=t._length,A=Array(T),S,C,L,E,I,P;for(h=0;h<T;h++)S=m.a[h],C=m.b[h],L=m.c[h],o(S)&&o(C)&&o(L)?(S=+S,C=+C,L=+L,E=u/(S+C+L),1!==E&&(S*=E,C*=E,L*=E),P=S,I=L-C,A[h]={x:I,y:P,a:S,b:C,c:L}):A[h]={x:!1,y:!1};return s(t,T),r(e,t),n(A,t),l(A,t),A}},{"../scatter/arrays_to_calcdata":1061,"../scatter/calc":1063,"../scatter/calc_selection":1064,"../scatter/colorscale_calc":1065,"fast-isnumeric":201}],1151:[function(e,t){'use strict';var o=Math.min,r=e("../../lib"),i=e("../scatter/constants"),n=e("../scatter/subtypes"),l=e("../scatter/marker_defaults"),s=e("../scatter/line_defaults"),d=e("../scatter/line_shape_defaults"),p=e("../scatter/text_defaults"),u=e("../scatter/fillcolor_defaults"),g=e("./attributes");t.exports=function(e,t,m,h){function y(a,o){return r.coerce(e,t,g,a,o)}var f=y("a"),a=y("b"),x=y("c"),c;if(f?(c=f.length,a?(c=o(c,a.length),x&&(c=o(c,x.length))):x?c=o(c,x.length):c=0):a&&x&&(c=o(a.length,x.length)),!c)return void(t.visible=!1);t._length=c,y("sum"),y("text"),y("hovertext"),"fills"!==t.hoveron&&y("hovertemplate");var _=c<i.PTS_LINESONLY?"lines+markers":"lines";y("mode",_),n.hasLines(t)&&(s(e,t,m,h,y),d(e,t,y),y("connectgaps")),n.hasMarkers(t)&&l(e,t,m,h,y,{gradient:!0}),n.hasText(t)&&(y("texttemplate"),p(e,t,h,y));var b=[];(n.hasMarkers(t)||n.hasText(t))&&(y("cliponaxis"),y("marker.maxdisplayed"),b.push("points")),y("fill"),"none"!==t.fill&&(u(e,t,m,y),!n.hasLines(t)&&d(e,t,y)),("tonext"===t.fill||"toself"===t.fill)&&b.push("fills"),y("hoveron",b.join("+")||"points"),r.coerceSelectionMarkerOpacity(t,y)}},{"../../lib":657,"../scatter/constants":1066,"../scatter/fillcolor_defaults":1070,"../scatter/line_defaults":1075,"../scatter/line_shape_defaults":1077,"../scatter/marker_defaults":1081,"../scatter/subtypes":1086,"../scatter/text_defaults":1087,"./attributes":1149}],1152:[function(e,t){'use strict';t.exports=function(e,t,a,o,r){if(t.xa&&(e.xaxis=t.xa),t.ya&&(e.yaxis=t.ya),o[r]){var i=o[r];e.a=i.a,e.b=i.b,e.c=i.c}else e.a=t.a,e.b=t.b,e.c=t.c;return e}},{}],1153:[function(e,t){'use strict';var a=e("../../plots/cartesian/axes");t.exports=function(e,t,o){var r={},i=o[t.subplot]._subplot;return r.aLabel=a.tickText(i.aaxis,e.a,!0).text,r.bLabel=a.tickText(i.baxis,e.b,!0).text,r.cLabel=a.tickText(i.caxis,e.c,!0).text,r}},{"../../plots/cartesian/axes":705}],1154:[function(e,t){'use strict';var a=Math.min,o=Math.max,r=e("../scatter/hover");t.exports=function(e,t,i,n){function l(e,t){b.push(e._hovertitle+": "+t)}var s=r(e,t,i,n);if(s&&!1!==s[0].index){var d=s[0];if(void 0===d.index){var c=1-d.y0/e.ya._length,p=e.xa._length,u=p*c/2,g=p-u;return d.x0=o(a(d.x0,g),u),d.x1=o(a(d.x1,g),u),s}var m=d.cd[d.index],h=d.trace,y=d.subplot;d.a=m.a,d.b=m.b,d.c=m.c,d.xLabelVal=void 0,d.yLabelVal=void 0;var f={};f[h.subplot]={_subplot:y};var x=h._module.formatLabels(m,h,f);d.aLabel=x.aLabel,d.bLabel=x.bLabel,d.cLabel=x.cLabel;var _=m.hi||h.hoverinfo,b=[];if(!h.hovertemplate){var v=_.split("+");-1!==v.indexOf("all")&&(v=["a","b","c"]),-1!==v.indexOf("a")&&l(y.aaxis,d.aLabel),-1!==v.indexOf("b")&&l(y.baxis,d.bLabel),-1!==v.indexOf("c")&&l(y.caxis,d.cLabel)}return d.extraText=b.join("<br>"),d.hovertemplate=h.hovertemplate,s}}},{"../scatter/hover":1073}],1155:[function(e,t){'use strict';t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../scatter/marker_colorbar"),formatLabels:e("./format_labels"),calc:e("./calc"),plot:e("./plot"),style:e("../scatter/style").style,styleOnSelect:e("../scatter/style").styleOnSelect,hoverPoints:e("./hover"),selectPoints:e("../scatter/select"),eventData:e("./event_data"),moduleType:"trace",name:"scatterternary",basePlotModule:e("../../plots/ternary"),categories:["ternary","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/ternary":784,"../scatter/marker_colorbar":1080,"../scatter/select":1083,"../scatter/style":1085,"./attributes":1149,"./calc":1150,"./defaults":1151,"./event_data":1152,"./format_labels":1153,"./hover":1154,"./plot":1156}],1156:[function(e,t){'use strict';var a=e("../scatter/plot");t.exports=function(e,t,o){var r=t.plotContainer;r.select(".scatterlayer").selectAll("*").remove();var i={xaxis:t.xaxis,yaxis:t.yaxis,plot:r,layerClipId:t._hasClipOnAxisFalse?t.clipIdRelative:null},n=t.layers.frontplot.select("g.scatterlayer");a(e,i,o,n)}},{"../scatter/plot":1082}],1157:[function(e,t){'use strict';function a(e){return{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"subplotid",regex:l[e],editType:"plot"}}}var o=e("../scatter/attributes"),r=e("../../components/colorscale/attributes"),i=e("../../plots/template_attributes").hovertemplateAttrs,n=e("../scattergl/attributes"),l=e("../../plots/cartesian/constants").idRegex,s=e("../../plot_api/plot_template").templatedArray,d=e("../../lib/extend").extendFlat,c=o.marker,p=c.line,u=d(r("marker.line",{editTypeOverride:"calc"}),{width:d({},p.width,{editType:"calc"}),editType:"calc"}),g=d(r("marker"),{symbol:c.symbol,size:d({},c.size,{editType:"markerSize"}),sizeref:c.sizeref,sizemin:c.sizemin,sizemode:c.sizemode,opacity:c.opacity,colorbar:c.colorbar,line:u,editType:"calc"});g.color.editType=g.cmin.editType=g.cmax.editType="style",t.exports={dimensions:s("dimension",{visible:{valType:"boolean",dflt:!0,editType:"calc"},label:{valType:"string",editType:"calc"},values:{valType:"data_array",editType:"calc+clearAxisTypes"},axis:{type:{valType:"enumerated",values:["linear","log","date","category"],editType:"calc+clearAxisTypes"},matches:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc+clearAxisTypes"},editType:"calc+clearAxisTypes"}),text:d({},n.text,{}),hovertext:d({},n.hovertext,{}),hovertemplate:i(),marker:g,xaxes:a("x"),yaxes:a("y"),diagonal:{visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},showupperhalf:{valType:"boolean",dflt:!0,editType:"calc"},showlowerhalf:{valType:"boolean",dflt:!0,editType:"calc"},selected:{marker:n.selected.marker,editType:"calc"},unselected:{marker:n.unselected.marker,editType:"calc"},opacity:n.opacity}},{"../../components/colorscale/attributes":531,"../../lib/extend":648,"../../plot_api/plot_template":695,"../../plots/cartesian/constants":711,"../../plots/template_attributes":783,"../scatter/attributes":1062,"../scattergl/attributes":1113}],1158:[function(e,t){'use strict';function a(e,t,a){for(var o=a.matrixOptions.data.length,r=t._visibleDims,n=a.viewOpts.ranges=Array(o),l=0;l<r.length;l++){var s=r[l],i=n[l]=[,,,,],d=c(e,t._diag[s][0]);d&&(i[0]=d.r2l(d.range[0]),i[2]=d.r2l(d.range[1]));var p=c(e,t._diag[s][1]);p&&(i[1]=p.r2l(p.range[0]),i[3]=p.r2l(p.range[1]))}a.selectBatch.length||a.unselectBatch.length?a.matrix.update({ranges:n},{ranges:n}):a.matrix.update({ranges:n})}function o(e){var t=e._fullLayout,a=t._glcanvas.data()[0].regl,o=t._splomGrid;o||(o=t._splomGrid=i(a)),o.update(r(e))}function r(e){function t(e,t,a,o,n,l){var s=t[e+"color"],d=t[e+"width"],c=s+d+"";c in i?i[c].data.push(NaN,NaN,a,o,n,l):i[c]={data:[a,o,n,l],join:"rect",thickness:d,color:s,viewport:r,range:r,overlay:!1}}var a=e._fullLayout,o=a._size,r=[0,0,a.width,a.height],i={},n;for(n in a._splomSubplots){var l=a._plots[n],s=l.xaxis,d=l.yaxis,c=s._gridVals,u=d._gridVals,g=o.b+d.domain[0]*o.h,m=-d._m,h=-m*d.r2l(d.range[0],d.calendar),f,_;if(s.showgrid)for(n=0;n<c.length;n++)f=s._offset+s.l2p(c[n].x),t("grid",s,f,g,f,g+d._length);if(d.showgrid)for(n=0;n<u.length;n++)_=g+h+m*u[n].x,t("grid",d,s._offset,_,s._offset+s._length,_);p(e,s,d)&&(f=s._offset+s.l2p(0),t("zeroline",s,f,g,f,g+d._length)),p(e,d,s)&&(_=g+h+0,t("zeroline",d,s._offset,_,s._offset+s._length,_))}var b=[];for(n in i)b.push(i[n]);return b}var i=e("regl-line2d"),n=e("../../registry"),l=e("../../lib/prepare_regl"),s=e("../../plots/get_data").getModuleCalcData,d=e("../../plots/cartesian"),c=e("../../plots/cartesian/axis_ids").getFromId,p=e("../../plots/cartesian/axes").shouldShowZeroLine;t.exports={name:"splom",attr:d.attr,attrRegex:d.attrRegex,layoutAttributes:d.layoutAttributes,supplyLayoutDefaults:d.supplyLayoutDefaults,drawFramework:d.drawFramework,plot:function(e){var t=e._fullLayout,a=n.getModule("splom"),r=s(e.calcdata,a)[0],i=l(e,["ANGLE_instanced_arrays","OES_element_index_uint"]);i&&(t._hasOnlyLargeSploms&&o(e),a.plot(e,{},r))},drag:function(e){var t=e.calcdata,r=e._fullLayout;r._hasOnlyLargeSploms&&o(e);for(var n=0;n<t.length;n++){var l=t[n][0],s=l.trace,d=r._splomScenes[s.uid];"splom"===s.type&&d&&d.matrix&&a(e,s,d)}},updateGrid:o,clean:function(e,t,a,o){var r={},n;if(o._splomScenes){for(n=0;n<e.length;n++){var l=e[n];"splom"===l.type&&(r[l.uid]=1)}for(n=0;n<a.length;n++){var s=a[n];if(!r[s.uid]){var c=o._splomScenes[s.uid];c&&c.destroy&&c.destroy(),o._splomScenes[s.uid]=null,delete o._splomScenes[s.uid]}}}0===Object.keys(o._splomScenes||{}).length&&delete o._splomScenes,o._splomGrid&&!t._hasOnlyLargeSploms&&o._hasOnlyLargeSploms&&(o._splomGrid.destroy(),o._splomGrid=null,delete o._splomGrid),d.clean(e,t,a,o)},updateFx:d.updateFx,toSVG:d.toSVG}},{"../../lib/prepare_regl":670,"../../plots/cartesian":718,"../../plots/cartesian/axes":705,"../../plots/cartesian/axis_ids":708,"../../plots/get_data":742,"../../registry":788,"regl-line2d":1266}],1159:[function(e,t){'use strict';var a=Math.max,o=e("../../lib"),r=e("../../plots/cartesian/axis_ids"),n=e("../scatter/calc").calcMarkerSize,l=e("../scatter/calc").calcAxisExpansion,s=e("../scatter/colorscale_calc"),d=e("../scattergl/convert").markerSelection,c=e("../scattergl/convert").markerStyle,p=e("./scene_update"),u=e("../../constants/numerical").BADNUM,g=e("../scattergl/constants").TOO_MANY_POINTS;t.exports=function(e,t){function m(e,a){for(var r=e.makeCalcdata({v:a.values,vcalendar:t.calendar},"v"),i=0;i<r.length;i++)r[i]=r[i]===u?NaN:r[i];x.push(r),_.push("log"===e.type?o.simpleMap(r,e.c2l):r)}var h=t.dimensions,y=t._length,f={},x=f.cdata=[],_=f.data=[],b=t._visibleDims=[],v,w,T,A,S;for(v=0;v<h.length;v++)if(T=h[v],T.visible){if(A=r.getFromId(e,t._diag[v][0]),S=r.getFromId(e,t._diag[v][1]),A&&S&&A.type!==S.type){o.log("Skipping splom dimension "+v+" with conflicting axis types");continue}A?(m(A,T),S&&"category"===S.type&&(S._categories=A._categories.slice())):m(S,T),b.push(v)}s(e,t),o.extendFlat(f,c(t));var C=x.length,L;for(L=C*y>g?2*(f.sizeAvg||a(f.size,3)):n(t,y),w=0;w<b.length;w++)v=b[w],T=h[v],A=r.getFromId(e,t._diag[v][0])||{},S=r.getFromId(e,t._diag[v][1])||{},l(e,t,A,S,x[w],x[w],L);var E=p(e,t);return E.matrix||(E.matrix=!0),E.matrixOptions=f,E.selectedOptions=d(t,t.selected),E.unselectedOptions=d(t,t.unselected),[{x:!1,y:!1,t:{},trace:t}]}},{"../../constants/numerical":633,"../../lib":657,"../../plots/cartesian/axis_ids":708,"../scatter/calc":1063,"../scatter/colorscale_calc":1065,"../scattergl/constants":1115,"../scattergl/convert":1116,"./scene_update":1166}],1160:[function(e,t){'use strict';function a(e,t){function a(a,o){return r.coerce(e,t,n.dimensions,a,o)}a("label");var o=a("values");o&&o.length?a("visible"):t.visible=!1,a("axis.type"),a("axis.matches")}function o(e,t,a,o){function r(e,o,r,i){if(e){var n=e.charAt(0),l=a._splomAxes[n];if(t["_"+n+"axes"][e]=1,i.push(e),!(e in l)){var d=l[e]={};r&&(d.label=r.label||"",r.visible&&r.axis&&(r.axis.type&&(d.type=r.axis.type),r.axis.matches&&(d.matches=o)))}}}var n=t.dimensions,l=n.length,s=t.showupperhalf,d=t.showlowerhalf,c=t.diagonal.visible,p=Array(l),u=Array(l),g,m;for(g=0;g<l;g++){var h=g?g+1:"";p[g]="x"+h,u[g]="y"+h}var y=o("xaxes",p),f=o("yaxes",u),x=t._diag=Array(l);t._xaxes={},t._yaxes={};var _=[],b=[],v=!c&&!d,w=!c&&!s;for(t._axesDim={},g=0;g<l;g++){var k=n[g],T=0===g,A=g===l-1,S=T&&v||A&&w?void 0:y[g],C=T&&w||A&&v?void 0:f[g];r(S,C,k,_),r(C,S,k,b),x[g]=[S,C],t._axesDim[S]=g,t._axesDim[C]=g}for(g=0;g<_.length;g++)for(m=0;m<b.length;m++){var L=_[g]+b[m];g>m&&s?a._splomSubplots[L]=1:g<m&&d?a._splomSubplots[L]=1:g===m&&(c||!d||!s)&&(a._splomSubplots[L]=1)}(!d||!c&&s&&d)&&(a._splomGridDflt.xside="bottom",a._splomGridDflt.yside="left")}var r=e("../../lib"),i=e("../../plots/array_container_defaults"),n=e("./attributes"),l=e("../scatter/subtypes"),s=e("../scatter/marker_defaults"),d=e("../parcoords/merge_length"),c=e("../scattergl/helpers").isOpenSymbol;t.exports=function(e,t,p,u){function g(a,o){return r.coerce(e,t,n,a,o)}var m=i(e,t,{name:"dimensions",handleItemDefaults:a}),h=g("diagonal.visible"),y=g("showupperhalf"),f=g("showlowerhalf"),x=d(t,m,"values");if(!x||!h&&!y&&!f)return void(t.visible=!1);g("text"),g("hovertext"),g("hovertemplate"),s(e,t,p,u,g);var _=c(t.marker.symbol),b=l.isBubble(t);g("marker.line.width",_||b?1:0),o(e,t,u,g),r.coerceSelectionMarkerOpacity(t,g)}},{"../../lib":657,"../../plots/array_container_defaults":701,"../parcoords/merge_length":1033,"../scatter/marker_defaults":1081,"../scatter/subtypes":1086,"../scattergl/helpers":1120,"./attributes":1157}],1161:[function(e,t){'use strict';var a=e("../../lib"),o=e("../scatter/colorscale_calc"),r=e("../scattergl/convert").markerStyle;t.exports=function(e,t){var i=t.trace,n=e._fullLayout._splomScenes[i.uid];if(n){o(e,i),a.extendFlat(n.matrixOptions,r(i));var l=a.extendFlat({},n.matrixOptions,n.viewOpts);n.matrix.update(l,null)}}},{"../../lib":657,"../scatter/colorscale_calc":1065,"../scattergl/convert":1116}],1162:[function(e,t,a){'use strict';a.getDimIndex=function(e,t){for(var a=t._id,o=a.charAt(0),r={x:0,y:1}[o],n=e._visibleDims,l=0,s;l<n.length;l++)if(s=n[l],e._diag[s][r]===a)return l;return!1}},{}],1163:[function(e,t){'use strict';var a=Math.sqrt,o=e("./helpers"),r=e("../scattergl/hover").calcHover;t.exports={hoverPoints:function(e,t,n){var l=e.cd,s=l[0].trace,d=e.scene,c=d.matrixOptions.cdata,p=e.xa,u=e.ya,g=p.c2p(t),m=u.c2p(n),h=e.distance,f=o.getDimIndex(s,p),_=o.getDimIndex(s,u);if(!1===f||!1===_)return[e];for(var b=c[f],x=c[_],y=h,v=0,w,k;v<b.length;v++){var T=b[v],A=x[v],S=p.c2p(T)-g,C=u.c2p(A)-m,L=a(S*S+C*C);L<y&&(y=k=L,w=v)}return e.index=w,e.distance=y,e.dxy=k,void 0===w?[e]:[r(e,b,x,s)]}}},{"../scattergl/hover":1121,"./helpers":1162}],1164:[function(e,t){'use strict';var a=e("../../registry"),o=e("../../components/grid");t.exports={moduleType:"trace",name:"splom",basePlotModule:e("./base_plot"),categories:["gl","regl","cartesian","symbols","showLegend","scatter-like"],attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../scatter/marker_colorbar"),calc:e("./calc"),plot:e("./plot"),hoverPoints:e("./hover").hoverPoints,selectPoints:e("./select"),editStyle:e("./edit_style"),meta:{}},a.register(o)},{"../../components/grid":568,"../../registry":788,"../scatter/marker_colorbar":1080,"./attributes":1157,"./base_plot":1158,"./calc":1159,"./defaults":1160,"./edit_style":1161,"./hover":1163,"./plot":1165,"./select":1167}],1165:[function(e,t){'use strict';function a(e,t){var a=e._fullLayout,s=a._size,d=t.trace,c=t.t,p=a._splomScenes[d.uid],u=p.matrixOptions,g=u.cdata,m=a._glcanvas.data()[0].regl,h=a.dragmode,y,f,x,_,b;if(0!==g.length){u.lower=d.showupperhalf,u.upper=d.showlowerhalf,u.diagonal=d.diagonal.visible;var v=d._visibleDims,w=g.length,T=p.viewOpts={};for(T.ranges=Array(w),T.domains=Array(w),b=0;b<v.length;b++){x=v[b];var A=T.ranges[b]=[,,,,],S=T.domains[b]=[,,,,];y=n.getFromId(e,d._diag[x][0]),y&&(A[0]=y._rl[0],A[2]=y._rl[1],S[0]=y.domain[0],S[2]=y.domain[1]),f=n.getFromId(e,d._diag[x][1]),f&&(A[1]=f._rl[0],A[3]=f._rl[1],S[1]=f.domain[0],S[3]=f.domain[1])}T.viewport=[s.l,s.b,s.w+s.l,s.h+s.b],!0===p.matrix&&(p.matrix=o(m));var C=-1<a.clickmode.indexOf("select"),L=l(h)||!!d.selectedpoints||C,E=!0;if(L){var I=d._length;if(d.selectedpoints){p.selectBatch=d.selectedpoints;var P=d.selectedpoints,z={};for(x=0;x<P.length;x++)z[P[x]]=!0;var D=[];for(x=0;x<I;x++)z[x]||D.push(x);p.unselectBatch=D}var O=c.xpx=Array(w),R=c.ypx=Array(w);for(b=0;b<v.length;b++){if(x=v[b],y=n.getFromId(e,d._diag[x][0]),y)for(O[b]=Array(I),_=0;_<I;_++)O[b][_]=y.c2p(g[b][_]);if(f=n.getFromId(e,d._diag[x][1]),f)for(R[b]=Array(I),_=0;_<I;_++)R[b][_]=f.c2p(g[b][_])}if(p.selectBatch.length||p.unselectBatch.length){var M=r.extendFlat({},u,p.unselectedOptions,T),B=r.extendFlat({},u,p.selectedOptions,T);p.matrix.update(M,B),E=!1}}else c.xpx=c.ypx=null;if(E){var F=r.extendFlat({},u,T);p.matrix.update(F,null)}}}var o=e("regl-splom"),r=e("../../lib"),n=e("../../plots/cartesian/axis_ids"),l=e("../../components/dragelement/helpers").selectMode;t.exports=function(e,t,o){if(o.length)for(var r=0;r<o.length;r++)a(e,o[r][0])}},{"../../components/dragelement/helpers":542,"../../lib":657,"../../plots/cartesian/axis_ids":708,"regl-splom":1268}],1166:[function(e,t){'use strict';var a=e("../../lib");t.exports=function(e,t){var o=e._fullLayout,r=t.uid,i=o._splomScenes;i||(i=o._splomScenes={});var n={dirty:!0,selectBatch:[],unselectBatch:[]},l=i[t.uid];return l||(l=i[r]=a.extendFlat({},n,{matrix:!1,selectBatch:[],unselectBatch:[]}),l.draw=function(){l.matrix&&l.matrix.draw&&(l.selectBatch.length||l.unselectBatch.length?l.matrix.draw(l.unselectBatch,l.selectBatch):l.matrix.draw()),l.dirty=!1},l.destroy=function(){l.matrix&&l.matrix.destroy&&l.matrix.destroy(),l.matrixOptions=null,l.selectBatch=null,l.unselectBatch=null,l=null}),l.dirty||a.extendFlat(l,n),l}},{"../../lib":657}],1167:[function(e,t){'use strict';var a=e("../../lib"),o=e("../scatter/subtypes"),r=e("./helpers");t.exports=function(e,t){var n=e.cd,l=n[0].trace,s=n[0].t,d=e.scene,c=d.matrixOptions.cdata,p=e.xaxis,u=e.yaxis,g=[];if(!d)return g;var m=!o.hasMarkers(l)&&!o.hasText(l);if(!0!==l.visible||m)return g;var h=r.getDimIndex(l,p),f=r.getDimIndex(l,u);if(!1===h||!1===f)return g;var _=s.xpx[h],b=s.ypx[f],v=c[h],x=c[f],y=[],w=[];if(!1!==t&&!t.degenerate)for(var k=0;k<v.length;k++)t.contains([_[k],b[k]],null,k,e)?(y.push(k),g.push({pointNumber:k,x:v[k],y:x[k]})):w.push(k);var T=d.matrixOptions;return y.length||w.length?!d.selectBatch.length&&!d.unselectBatch.length&&d.matrix.update(d.unselectedOptions,a.extendFlat({},T,d.selectedOptions,d.viewOpts)):d.matrix.update(T,null),d.selectBatch=y,d.unselectBatch=w,g}},{"../../lib":657,"../scatter/subtypes":1086,"./helpers":1162}],1168:[function(e,t){'use strict';var a=e("../../components/colorscale/attributes"),o=e("../../plots/template_attributes").hovertemplateAttrs,r=e("../mesh3d/attributes"),i=e("../../plots/attributes"),n=e("../../lib/extend").extendFlat,l={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},starts:{x:{valType:"data_array",editType:"calc"},y:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},editType:"calc"},maxdisplayed:{valType:"integer",min:0,dflt:1e3,editType:"calc"},sizeref:{valType:"number",editType:"calc",min:0,dflt:1},text:{valType:"string",dflt:"",editType:"calc"},hovertext:{valType:"string",dflt:"",editType:"calc"},hovertemplate:o({editType:"calc"},{keys:["tubex","tubey","tubez","tubeu","tubev","tubew","norm","divergence"]}),showlegend:n({},i.showlegend,{dflt:!1})};n(l,a("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"}));["opacity","lightposition","lighting"].forEach(function(e){l[e]=r[e]}),l.hoverinfo=n({},i.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","divergence","text","name"],dflt:"x+y+z+norm+text+name"}),l.transforms=void 0,t.exports=l},{"../../components/colorscale/attributes":531,"../../lib/extend":648,"../../plots/attributes":702,"../../plots/template_attributes":783,"../mesh3d/attributes":1003}],1169:[function(e,t){'use strict';var n=Math.min,l=Math.max;function a(e){var t=e._x,a=e._y,r=e._z,d=e._len,c=-Infinity,p=1/0,u=-Infinity,g=1/0,m=-Infinity,h=1/0,y="",f,x,_,b,v,w,T,A,S,C,L,E;for(d&&(T=t[0],S=a[0],L=r[0]),1<d&&(A=t[d-1],C=a[d-1],E=r[d-1]),f=0;f<d;f++)c=l(c,t[f]),p=n(p,t[f]),u=l(u,a[f]),g=n(g,a[f]),m=l(m,r[f]),h=n(h,r[f]),b||t[f]===T||(b=!0,y+="x"),v||a[f]===S||(v=!0,y+="y"),w||r[f]===L||(w=!0,y+="z");b||(y+="x"),v||(y+="y"),w||(y+="z");var I=o(e._x),P=o(e._y),z=o(e._z);y=y.replace("x",(T>A?"-":"+")+"x"),y=y.replace("y",(S>C?"-":"+")+"y"),y=y.replace("z",(L>E?"-":"+")+"z");var D=function(){d=0,I=[],P=[],z=[]};(!d||d<I.length*P.length*z.length)&&D();var O=function(e){return"x"===e?t:"y"===e?a:r},R=function(e){return"x"===e?I:"y"===e?P:z},M=function(e){return e[d-1]<e[0]?-1:1},B=O(y[1]),F=O(y[3]),N=O(y[5]),V=R(y[1]).length,U=R(y[3]).length,H=R(y[5]).length,q=!1,G=function(e,t,a){return V*(U*e+t)+a},Y=M(O(y[1])),W=M(O(y[3])),X=M(O(y[5]));for(f=0;f<H-1;f++){for(x=0;x<U-1;x++){for(_=0;_<V-1;_++){var Z=G(f,x,_),K=G(f,x,_+1),$=G(f,x+1,_),J=G(f+1,x,_);if(B[Z]*Y<B[K]*Y&&F[Z]*W<F[$]*W&&N[Z]*X<N[J]*X||(q=!0),q)break}if(q)break}if(q)break}return q&&(s.warn("Encountered arbitrary coordinates! Unable to input data grid."),D()),{xMin:p,yMin:g,zMin:h,xMax:c,yMax:u,zMax:m,Xs:I,Ys:P,Zs:z,len:d,fill:y}}function o(e){return s.distinctVals(e).vals}function r(e,t){if(void 0===t&&(t=e.length),s.isTypedArray(e))return e.subarray(0,t);for(var a=[],o=0;o<t;o++)a[o]=+e[o];return a}var s=e("../../lib"),d=e("../../components/colorscale/calc");t.exports={calc:function(e,t){t._len=n(t.u.length,t.v.length,t.w.length,t.x.length,t.y.length,t.z.length),t._u=r(t.u,t._len),t._v=r(t.v,t._len),t._w=r(t.w,t._len),t._x=r(t.x,t._len),t._y=r(t.y,t._len),t._z=r(t.z,t._len);var o=a(t);t._gridFill=o.fill,t._Xs=o.Xs,t._Ys=o.Ys,t._Zs=o.Zs,t._len=o.len;var s=0,c,p,g;t.starts&&(c=r(t.starts.x||[]),p=r(t.starts.y||[]),g=r(t.starts.z||[]),s=n(c.length,p.length,g.length)),t._startsX=c||[],t._startsY=p||[],t._startsZ=g||[];var m=0,h=1/0,y;for(y=0;y<t._len;y++){var f=t._u[y],u=t._v[y],x=t._w[y],_=Math.sqrt(f*f+u*u+x*x);m=l(m,_),h=n(h,_)}for(d(e,t,{vals:[h,m],containerStr:"",cLetter:"c"}),y=0;y<s;y++){var b=c[y];o.xMax=l(o.xMax,b),o.xMin=n(o.xMin,b);var v=p[y];o.yMax=l(o.yMax,v),o.yMin=n(o.yMin,v);var w=g[y];o.zMax=l(o.zMax,w),o.zMin=n(o.zMin,w)}t._slen=s,t._normMax=m,t._xbnds=[o.xMin,o.xMax],t._ybnds=[o.yMin,o.yMax],t._zbnds=[o.zMin,o.zMax]},filter:r,processGrid:a}},{"../../components/colorscale/calc":532,"../../lib":657}],1170:[function(e,t){'use strict';function a(e,t){this.scene=e,this.uid=t,this.mesh=null,this.data=null}function o(e){var t=e.length,a;return a=2<t?e.slice(1,t-1):2===t?[(e[0]+e[1])/2]:e,a}function r(e){var t=e.length;return 1===t?[.5,.5]:[e[1]-e[0],e[t-1]-e[t-2]]}function i(e,t){function a(e,t){var a=l[t],o=g[u[t]];return s.simpleMap(e,function(e){return a.d2l(e)*o})}var l=e.fullSceneLayout,g=e.dataScale,h=t._len,y={};if(y.vectors=p(a(t._u,"xaxis"),a(t._v,"yaxis"),a(t._w,"zaxis"),h),!h)return{positions:[],cells:[]};var f=a(t._Xs,"xaxis"),x=a(t._Ys,"yaxis"),_=a(t._Zs,"zaxis");y.meshgrid=[f,x,_],y.gridFill=t._gridFill;var b=t._slen;if(b)y.startingPositions=p(a(t._startsX,"xaxis"),a(t._startsY,"yaxis"),a(t._startsZ,"zaxis"));else{for(var v=x[0],w=o(f),T=o(_),A=Array(w.length*T.length),S=0,C=0;C<w.length;C++)for(var L=0;L<T.length;L++)A[S++]=[w[C],v,T[L]];y.startingPositions=A}y.colormap=d(t),y.tubeSize=t.sizeref,y.maxLength=t.maxdisplayed;var E=a(t._xbnds,"xaxis"),I=a(t._ybnds,"yaxis"),P=a(t._zbnds,"zaxis"),z=r(f),D=r(x),O=r(_),R=[[E[0]-z[0],I[0]-D[0],P[0]-O[0]],[E[1]+z[1],I[1]+D[1],P[1]+O[1]]],M=n(y,R),j=c(t);M.vertexIntensityBounds=[j.min/t._normMax,j.max/t._normMax];var B=t.lightposition;return M.lightPosition=[B.x,B.y,B.z],M.ambient=t.lighting.ambient,M.diffuse=t.lighting.diffuse,M.specular=t.lighting.specular,M.roughness=t.lighting.roughness,M.fresnel=t.lighting.fresnel,M.opacity=t.opacity,t._pad=2*(M.tubeScale*t.sizeref),M}var n=e("gl-streamtube3d"),l=n.createTubeMesh,s=e("../../lib"),d=e("../../lib/gl_format_color").parseColorScale,c=e("../../components/colorscale").extractOpts,p=e("../../plots/gl3d/zip3"),u={xaxis:0,yaxis:1,zaxis:2},g=a.prototype;g.handlePick=function(e){function t(e,t){var r=a[t],i=o[u[t]];return r.l2c(e)/i}var a=this.scene.fullSceneLayout,o=this.scene.dataScale;if(e.object===this.mesh){var r=e.data.position,i=e.data.velocity;return e.traceCoordinate=[t(r[0],"xaxis"),t(r[1],"yaxis"),t(r[2],"zaxis"),t(i[0],"xaxis"),t(i[1],"yaxis"),t(i[2],"zaxis"),e.data.intensity*this.data._normMax,e.data.divergence],e.textLabel=this.data.hovertext||this.data.text,!0}},g.update=function(e){this.data=e;var t=i(this.scene,e);this.mesh.update(t)},g.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},t.exports=function(e,t){var o=e.glplot.gl,r=i(e,t),n=l(o,r),s=new a(e,t.uid);return s.mesh=n,s.data=t,n._trace=s,e.glplot.add(n),s}},{"../../components/colorscale":536,"../../lib":657,"../../lib/gl_format_color":654,"../../plots/gl3d/zip3":758,"gl-streamtube3d":288}],1171:[function(e,t){'use strict';var a=e("../../lib"),o=e("../../components/colorscale/defaults"),r=e("./attributes");t.exports=function(e,t,i,n){function l(o,i){return a.coerce(e,t,r,o,i)}var s=l("u"),d=l("v"),c=l("w"),p=l("x"),u=l("y"),g=l("z");return s&&s.length&&d&&d.length&&c&&c.length&&p&&p.length&&u&&u.length&&g&&g.length?void(l("starts.x"),l("starts.y"),l("starts.z"),l("maxdisplayed"),l("sizeref"),l("lighting.ambient"),l("lighting.diffuse"),l("lighting.specular"),l("lighting.roughness"),l("lighting.fresnel"),l("lightposition.x"),l("lightposition.y"),l("lightposition.z"),o(e,t,n,l,{prefix:"",cLetter:"c"}),l("text"),l("hovertext"),l("hovertemplate"),t._length=null):void(t.visible=!1)}},{"../../components/colorscale/defaults":534,"../../lib":657,"./attributes":1168}],1172:[function(e,t){'use strict';t.exports={moduleType:"trace",name:"streamtube",basePlotModule:e("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:e("./calc").calc,plot:e("./convert"),eventData:function(e,t){return e.tubex=e.x,e.tubey=e.y,e.tubez=e.z,e.tubeu=t.traceCoordinate[3],e.tubev=t.traceCoordinate[4],e.tubew=t.traceCoordinate[5],e.norm=t.traceCoordinate[6],e.divergence=t.traceCoordinate[7],delete e.x,delete e.y,delete e.z,e},meta:{}}},{"../../plots/gl3d":747,"./attributes":1168,"./calc":1169,"./convert":1170,"./defaults":1171}],1173:[function(e,t){'use strict';var a=e("../../plots/attributes"),o=e("../../plots/template_attributes").hovertemplateAttrs,r=e("../../plots/template_attributes").texttemplateAttrs,i=e("../../components/colorscale/attributes"),n=e("../../plots/domain").attributes,l=e("../pie/attributes"),s=e("./constants"),d=e("../../lib/extend").extendFlat;t.exports={labels:{valType:"data_array",editType:"calc"},parents:{valType:"data_array",editType:"calc"},values:{valType:"data_array",editType:"calc"},branchvalues:{valType:"enumerated",values:["remainder","total"],dflt:"remainder",editType:"calc"},count:{valType:"flaglist",flags:["branches","leaves"],dflt:"leaves",editType:"calc"},level:{valType:"any",editType:"plot",anim:!0},maxdepth:{valType:"integer",editType:"plot",dflt:-1},marker:d({colors:{valType:"data_array",editType:"calc"},line:{color:d({},l.marker.line.color,{dflt:null}),width:d({},l.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},i("marker",{colorAttr:"colors",anim:!1})),leaf:{opacity:{valType:"number",editType:"style",min:0,max:1},editType:"plot"},text:l.text,textinfo:{valType:"flaglist",flags:["label","text","value","current path","percent root","percent entry","percent parent"],extras:["none"],editType:"plot"},texttemplate:r({editType:"plot"},{keys:s.eventDataKeys.concat(["label","value"])}),hovertext:l.hovertext,hoverinfo:d({},a.hoverinfo,{flags:["label","text","value","name","current path","percent root","percent entry","percent parent"],dflt:"label+text+value+name"}),hovertemplate:o({},{keys:s.eventDataKeys}),textfont:l.textfont,insidetextorientation:l.insidetextorientation,insidetextfont:l.insidetextfont,outsidetextfont:d({},l.outsidetextfont,{}),domain:n({name:"sunburst",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":531,"../../lib/extend":648,"../../plots/attributes":702,"../../plots/domain":732,"../../plots/template_attributes":783,"../pie/attributes":1036,"./constants":1176}],1174:[function(e,t,a){'use strict';var o=e("../../plots/plots");a.name="sunburst",a.plot=function(e,t,r,i){o.plotBasePlot(a.name,e,t,r,i)},a.clean=function(e,t,r,i){o.cleanBasePlot(a.name,e,t,r,i)}},{"../../plots/plots":768}],1175:[function(e,t,a){'use strict';var r=Math.min;function o(e,t,a){var r=0,n=e.children;if(n){for(var l=n.length,s=0;s<l;s++)r+=o(n[s],t,a);a.branches&&r++}else a.leaves&&r++;return e.value=e.data.data.value=r,t._values||(t._values=[]),t._values[e.data.data.i]=r,r}var n=e("d3-hierarchy"),l=e("fast-isnumeric"),s=e("../../lib"),d=e("../../components/colorscale").makeColorScaleFuncFromTrace,c=e("../pie/calc").makePullColorFn,p=e("../pie/calc").generateExtendedColors,u=e("../../components/colorscale").calc,g=e("../../constants/numerical").ALMOST_EQUAL,m={},h={};a.calc=function(e,t){var a=e._fullLayout,p=t.ids,m=s.isArrayOrTypedArray(p),h=t.labels,y=t.parents,f=t.values,x=s.isArrayOrTypedArray(f),_=[],b={},w={},T=function(e,t){b[e]?b[e].push(t):b[e]=[t],w[t]=1},A=function(e){return e||"number"==typeof e},S=function(e){return!x||l(f[e])&&0<=f[e]},C,L,E;m?(C=r(p.length,y.length),L=function(e){return A(p[e])&&S(e)},E=function(e){return p[e]+""}):(C=r(h.length,y.length),L=function(e){return A(h[e])&&S(e)},E=function(e){return h[e]+""}),x&&(C=r(C,f.length));for(var I=0;I<C;I++)if(L(I)){var v=E(I),P=A(y[I])?y[I]+"":"",z={i:I,id:v,pid:P,label:A(h[I])?h[I]+"":""};x&&(z.v=+f[I]),_.push(z),T(P,v)}if(!b[""]){var D=[],O;for(O in b)w[O]||D.push(O);if(1===D.length)O=D[0],_.unshift({hasImpliedRoot:!0,id:O,pid:"",label:O});else return s.warn("Multiple implied roots, cannot build "+t.type+" hierarchy.")}else if(1<b[""].length){for(var R=s.randstr(),M=0;M<_.length;M++)""===_[M].pid&&(_[M].pid=R);_.unshift({hasMultipleRoots:!0,id:R,pid:"",label:""})}var B;try{B=n.stratify().id(function(e){return e.id}).parentId(function(e){return e.pid})(_)}catch(a){return s.warn("Failed to build "+t.type+" hierarchy. Error: "+a.message)}var F=n.hierarchy(B),N=!1;if(x)switch(t.branchvalues){case"remainder":F.sum(function(e){return e.data.v});break;case"total":F.each(function(e){var t=e.data.data,a=t.v;if(e.children){var o=e.children.reduce(function(e,t){return e+t.data.data.v},0);if((t.hasImpliedRoot||t.hasMultipleRoots)&&(a=o),a<o*g)return N=!0,s.warn(["Total value for node",e.data.data.id,"is smaller than the sum of its children.","\nparent value =",a,"\nchildren sum =",o].join(" "))}e.value=a});}else o(F,t,{branches:-1!==t.count.indexOf("branches"),leaves:-1!==t.count.indexOf("leaves")});if(!N){F.sort(function(e,t){return t.value-e.value});var V=t.marker.colors||[],U=!!V.length,H,q;return t._hasColorscale?(!U&&(V=x?t.values:t._values),u(e,t,{vals:V,containerStr:"marker",cLetter:"c"}),q=d(t.marker)):H=c(a["_"+t.type+"colormap"]),F.each(function(e){var a=e.data.data;a.color=t._hasColorscale?q(V[a.i]):H(V[a.i],a.id)}),_[0].hierarchy=F,_}},a._runCrossTraceCalc=function(e,t){function a(e){var t=e.data.data,a=t.id;!1===t.color&&(l[a]?t.color=l[a]:e.parent?e.parent.parent?t.color=e.parent.data.data.color:(l[a]=t.color=n[s%n.length],s++):t.color="rgba(0,0,0,0)")}var o=t._fullLayout,r=t.calcdata,n=o[e+"colorway"],l=o["_"+e+"colormap"];o["extend"+e+"colors"]&&(n=p(n,"treemap"===e?h:m));for(var s=0,d=0;d<r.length;d++){var c=r[d],u=c[0];u.trace.type===e&&u.hierarchy&&u.hierarchy.each(a)}},a.crossTraceCalc=function(e){return a._runCrossTraceCalc("sunburst",e)}},{"../../components/colorscale":536,"../../constants/numerical":633,"../../lib":657,"../pie/calc":1038,"d3-hierarchy":102,"fast-isnumeric":201}],1176:[function(e,t){'use strict';t.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"linear",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"]}},{}],1177:[function(e,t){'use strict';var a=e("../../lib"),o=e("./attributes"),r=e("../../plots/domain").defaults,i=e("../bar/defaults").handleText,n=e("../../components/colorscale"),l=n.hasColorscale,s=n.handleDefaults;t.exports=function(e,t,n,d){function c(r,i){return a.coerce(e,t,o,r,i)}var p=c("labels"),u=c("parents");if(!p||!p.length||!u||!u.length)return void(t.visible=!1);var g=c("values");g&&g.length?c("branchvalues"):c("count"),c("level"),c("maxdepth");var m=c("marker.line.width");m&&c("marker.line.color",d.paper_bgcolor),c("marker.colors");var h=t._hasColorscale=l(e,"marker","colors")||(e.marker||{}).coloraxis;h&&s(e,t,d,c,{prefix:"marker.",cLetter:"c"}),c("leaf.opacity",h?1:.7);var y=c("text");c("texttemplate"),t.texttemplate||c("textinfo",Array.isArray(y)?"text+label":"label"),c("hovertext"),c("hovertemplate");i(e,t,d,c,"auto",{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),c("insidetextorientation"),r(t,d,c),t._length=null}},{"../../components/colorscale":536,"../../lib":657,"../../plots/domain":732,"../bar/defaults":802,"./attributes":1173}],1178:[function(e,t){'use strict';function a(e,t,a){for(var o=e.data.data,r={curveNumber:t.index,pointNumber:o.i,data:t._input,fullData:t},l=0,s;l<a.length;l++)s=a[l],s in e&&(r[s]=e[s]);return"parentString"in e&&!d.isHierarchyRoot(e)&&(r.parent=e.parentString),n(r,t,o.i),r}var o=e("d3"),r=e("../../registry"),n=e("../../components/fx/helpers").appendArrayPointValue,l=e("../../components/fx"),i=e("../../lib"),s=e("../../lib/events"),d=e("./helpers"),c=e("../pie/helpers"),p=c.formatPieValue;t.exports=function(e,t,n,c,u){var g=c[0],m=g.trace,h=g.hierarchy,y="sunburst"===m.type,f="treemap"===m.type;"_hasHoverLabel"in m||(m._hasHoverLabel=!1),"_hasHoverEvent"in m||(m._hasHoverEvent=!1);e.on("mouseover",function(r){var s=n._fullLayout;if(!(n._dragging||!1===s.hovermode)){var c=n._fullData[m.index],x=r.data.data,_=x.i,b=d.isHierarchyRoot(r),v=d.getParent(h,r),w=d.getValue(r),k=function(e){return i.castOption(c,_,e)},T=k("hovertemplate"),A=l.castHoverinfo(c,s,_),S=s.separators;if(T||A&&"none"!==A&&"skip"!==A){var C,L;y&&(C=g.cx+r.pxmid[0]*(1-r.rInscribed),L=g.cy+r.pxmid[1]*(1-r.rInscribed)),f&&(C=r._hoverX,L=r._hoverY);var E={},I=[],P=[],z=function(e){return-1!==I.indexOf(e)};A&&(I="all"===A?c._module.attributes.hoverinfo.flags:A.split("+")),E.label=x.label,z("label")&&E.label&&P.push(E.label),x.hasOwnProperty("v")&&(E.value=x.v,E.valueLabel=p(E.value,S),z("value")&&P.push(E.valueLabel)),E.currentPath=r.currentPath=d.getPath(r.data),z("current path")&&!b&&P.push(E.currentPath);var D=[],O=function(){-1===D.indexOf(R)&&(P.push(R),D.push(R))},R;E.percentParent=r.percentParent=w/d.getValue(v),E.parent=r.parentString=d.getPtLabel(v),z("percent parent")&&(R=d.formatPercent(E.percentParent,S)+" of "+E.parent,O()),E.percentEntry=r.percentEntry=w/d.getValue(t),E.entry=r.entry=d.getPtLabel(t),!z("percent entry")||b||r.onPathbar||(R=d.formatPercent(E.percentEntry,S)+" of "+E.entry,O()),E.percentRoot=r.percentRoot=w/d.getValue(h),E.root=r.root=d.getPtLabel(h),z("percent root")&&!b&&(R=d.formatPercent(E.percentRoot,S)+" of "+E.root,O()),E.text=k("hovertext")||k("text"),z("text")&&(R=E.text,i.isValidTextValue(R)&&P.push(R));var M={trace:c,y:L,text:P.join("<br>"),name:T||z("name")?c.name:void 0,color:k("hoverlabel.bgcolor")||x.color,borderColor:k("hoverlabel.bordercolor"),fontFamily:k("hoverlabel.font.family"),fontSize:k("hoverlabel.font.size"),fontColor:k("hoverlabel.font.color"),nameLength:k("hoverlabel.namelength"),textAlign:k("hoverlabel.align"),hovertemplate:T,hovertemplateLabels:E,eventData:[a(r,c,u.eventDataKeys)]};y&&(M.x0=C-r.rInscribed*r.rpx1,M.x1=C+r.rInscribed*r.rpx1,M.idealAlign=0>r.pxmid[0]?"left":"right"),f&&(M.x=C,M.idealAlign=0>C?"left":"right"),l.loneHover(M,{container:s._hoverlayer.node(),outerContainer:s._paper.node(),gd:n}),m._hasHoverLabel=!0}if(f){var j=e.select("path.surface");u.styleOne(j,r,c,{hovered:!0})}m._hasHoverEvent=!0,n.emit("plotly_hover",{points:[a(r,c,u.eventDataKeys)],event:o.event})}}),e.on("mouseout",function(t){var r=n._fullLayout,i=n._fullData[m.index],s=o.select(this).datum();if(m._hasHoverEvent&&(t.originalEvent=o.event,n.emit("plotly_unhover",{points:[a(s,i,u.eventDataKeys)],event:o.event}),m._hasHoverEvent=!1),m._hasHoverLabel&&(l.loneUnhover(r._hoverlayer.node()),m._hasHoverLabel=!1),f){var d=e.select("path.surface");u.styleOne(d,s,i,{hovered:!1})}}),e.on("click",function(e){var t=n._fullLayout,i=n._fullData[m.index],c=y&&(d.isHierarchyRoot(e)||d.isLeaf(e)),p=d.getPtId(e),g=d.isEntry(e)?d.findEntryWithChild(h,p):d.findEntryWithLevel(h,p),f=d.getPtId(g),x={points:[a(e,i,u.eventDataKeys)],event:o.event};c||(x.nextLevel=f);var _=s.triggerHandler(n,"plotly_"+m.type+"click",x);if((!1!==_&&t.hovermode&&(n._hoverdata=[a(e,i,u.eventDataKeys)],l.click(n,o.event)),!c)&&!1!==_&&!n._dragging&&!n._transitioning){r.call("_storeDirectGUIEdit",i,t._tracePreGUI[i.uid],{level:i.level});var b={data:[{level:f}],traces:[m.index]},v={frame:{redraw:!1,duration:u.transitionTime},transition:{duration:u.transitionTime,easing:u.transitionEasing},mode:"immediate",fromcurrent:!0};l.loneUnhover(t._hoverlayer.node()),r.call("animate",n,b,v)}})}},{"../../components/fx":564,"../../components/fx/helpers":560,"../../lib":657,"../../lib/events":647,"../../registry":788,"../pie/helpers":1041,"./helpers":1179,d3:108}],1179:[function(e,t,a){'use strict';function o(e,t,o){return{color:a.getOutsideTextFontKey("color",e,t,o),family:a.getOutsideTextFontKey("family",e,t,o),size:a.getOutsideTextFontKey("size",e,t,o)}}function r(e,t,o,r){var i=(r||{}).onPathbar,s=t.data.data,d=s.i,c=n.castOption(e,d,(i?"pathbar.textfont":"insidetextfont")+".color");return!c&&e._input.textfont&&(c=n.castOption(e._input,d,"textfont.color")),{color:c||l.contrast(s.color),family:a.getInsideTextFontKey("family",e,t,o,r),size:a.getInsideTextFontKey("size",e,t,o,r)}}function i(e){return e.data.data.pid}var n=e("../../lib"),l=e("../../components/color"),s=e("../../lib/setcursor"),d=e("../pie/helpers");a.findEntryWithLevel=function(e,t){var o;return t&&e.eachAfter(function(e){if(a.getPtId(e)===t)return o=e.copy()}),o||e},a.findEntryWithChild=function(e,t){var o;return e.eachAfter(function(e){for(var r=e.children||[],n=0,l;n<r.length;n++)if(l=r[n],a.getPtId(l)===t)return o=e.copy()}),o||e},a.isEntry=function(e){return!e.parent},a.isLeaf=function(e){return!e.children},a.getPtId=function(e){return e.data.data.id},a.getPtLabel=function(e){return e.data.data.label},a.getValue=function(e){return e.value},a.isHierarchyRoot=function(e){return""===i(e)},a.setSliceCursor=function(e,t,o){var r=o.isTransitioning;if(!r){var i=e.datum();r=o.hideOnRoot&&a.isHierarchyRoot(i)||o.hideOnLeaves&&a.isLeaf(i)}s(e,r?null:"pointer")},a.getInsideTextFontKey=function(e,t,a,o,r){var i=(r||{}).onPathbar,l=i?"pathbar.textfont":"insidetextfont",s=a.data.data.i;return n.castOption(t,s,l+"."+e)||n.castOption(t,s,"textfont."+e)||o.size},a.getOutsideTextFontKey=function(e,t,a,o){var r=a.data.data.i;return n.castOption(t,r,"outsidetextfont."+e)||n.castOption(t,r,"textfont."+e)||o.size},a.isOutsideText=function(e,t){return!e._hasColorscale&&a.isHierarchyRoot(t)},a.determineTextFont=function(e,t,i,n){return a.isOutsideText(e,t)?o(e,t,i):r(e,t,i,n)},a.hasTransition=function(e){return!!(e&&0<e.duration)},a.getMaxDepth=function(e){return 0<=e.maxdepth?e.maxdepth:1/0},a.isHeader=function(e,t){return!(a.isLeaf(e)||e.depth===t._maxDepth-1)},a.getParent=function(e,t){return a.findEntryWithLevel(e,i(t))},a.listPath=function(e,t){var o=e.parent;if(!o)return[];var r=t?[o.data[t]]:[o];return a.listPath(o,t).concat(r)},a.getPath=function(e){return a.listPath(e,"label").join("/")+"/"},a.formatValue=d.formatPieValue,a.formatPercent=function(e,t){var a=n.formatPercent(e,0);return"0%"===a&&(a=d.formatPiePercent(e,t)),a}},{"../../components/color":524,"../../lib":657,"../../lib/setcursor":677,"../pie/helpers":1041}],1180:[function(e,t){'use strict';t.exports={moduleType:"trace",name:"sunburst",basePlotModule:e("./base_plot"),categories:[],animatable:!0,attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults"),supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc").calc,crossTraceCalc:e("./calc").crossTraceCalc,plot:e("./plot").plot,style:e("./style").style,colorbar:e("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":1080,"./attributes":1173,"./base_plot":1174,"./calc":1175,"./defaults":1177,"./layout_attributes":1181,"./layout_defaults":1182,"./plot":1183,"./style":1184}],1181:[function(e,t){'use strict';t.exports={sunburstcolorway:{valType:"colorlist",editType:"calc"},extendsunburstcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1182:[function(e,t){'use strict';var a=e("../../lib"),o=e("./layout_attributes");t.exports=function(e,t){function r(r,i){return a.coerce(e,t,o,r,i)}r("sunburstcolorway",t.colorway),r("extendsunburstcolors")}},{"../../lib":657,"./layout_attributes":1181}],1183:[function(e,t,a){'use strict';var s=Math.cos,d=Math.PI,c=Math.sin,p=Math.min,u=Math.max;function o(e,t,o,l){function u(e){var t=L.getPtId(e),o=q[t],r=q[L.getPtId(O)],i;if(r){var l=e.x1>r.x1?2*d:0;i=e.rpx1<r.rpx1?{rpx0:0,rpx1:0}:{x0:l,x1:l}}else{var a=L.getPtId(e.parent),s;I.each(function(e){if(L.getPtId(e)===a)return s=e});var c=s.children,p;c.forEach(function(e,a){if(L.getPtId(e)===t)return p=a});var u=c.length,n=g.interpolate(s.x0,s.x1);i={rpx0:N,rpx1:N,x0:n(p/u),x1:n((p+1)/u)}}return g.interpolate(o,i)}function m(e){var t=q[L.getPtId(e)],o={x0:e.x0,x1:e.x1,rpx0:e.rpx0,rpx1:e.rpx1},r;if(t)r=t;else if(!H)r={x0:0,x1:0};else if(!e.parent)r={rpx0:0,rpx1:0};else if(te){var i=e.x1>te?2*d:0;r={x0:i,x1:i}}else r={rpx0:N,rpx1:N},y.extendFlat(r,b(e));return g.interpolate(r,o)}function x(e){var t=q[L.getPtId(e)],o=e.transform,r;if(t)r=t;else if(r={rpx1:e.rpx1,transform:{textPosAngle:o.textPosAngle,scale:0,rotate:o.rotate,rCenter:o.rCenter,x:o.x,y:o.y}},!H)r.x0=r.x1=0;else if(!e.parent)r.x0=r.x1=0;else if(te){var i=e.x1>te?2*d:0;r.x0=r.x1=i}else y.extendFlat(r,b(e));var a=g.interpolate(r.transform.textPosAngle,e.transform.textPosAngle),n=g.interpolate(r.rpx1,e.rpx1),l=g.interpolate(r.x0,e.x0),s=g.interpolate(r.x1,e.x1),c=g.interpolate(r.transform.scale,o.scale),p=g.interpolate(r.transform.rotate,o.rotate),u=0===o.rCenter?3:0===r.transform.rCenter?1/3:1,m=g.interpolate(r.transform.rCenter,o.rCenter),h=function(e){return m(Math.pow(e,u))};return function(e){var t=n(e),r=l(e),i=s(e),u=h(e),g=$(t,(r+i)/2),m=a(e),y={pxmid:g,rpx1:t,transform:{textPosAngle:m,rCenter:u,x:o.x,y:o.y}};return _(z.type,o,v),{transform:{targetX:Q(y),targetY:ee(y),scale:c(e),rotate:p(e),rCenter:u}}}}function b(e){var t=e.parent,a=q[L.getPtId(t)],o={};if(a){var r=t.children,i=r.indexOf(e),l=r.length,n=g.interpolate(a.x0,a.x1);o.x0=n(i/l),o.x1=n(i/l)}else o.x0=o.x1=0;return o}var v=e._fullLayout,A=!v.uniformtext.mode&&L.hasTransition(l),E=g.select(o),I=E.selectAll("g.slice"),P=t[0],z=P.trace,D=P.hierarchy,O=L.findEntryWithLevel(D,z.level),R=L.getMaxDepth(z),M=v._size,j=z.domain,B=M.w*(j.x[1]-j.x[0]),F=M.h*(j.y[1]-j.y[0]),N=.5*p(B,F),V=P.cx=M.l+M.w*(j.x[1]+j.x[0])/2,U=P.cy=M.t+M.h*(1-j.y[0])-F/2;if(!O)return I.remove();var H=null,q={};A&&I.each(function(e){q[L.getPtId(e)]={rpx0:e.rpx0,rpx1:e.rpx1,x0:e.x0,x1:e.x1,transform:e.transform},!H&&L.isEntry(e)&&(H=e)});var G=r(O).descendants(),Y=O.height+1,W=0,X=R;P.hasMultipleRoots&&L.isHierarchyRoot(O)&&(G=G.slice(1),Y-=1,W=1,X+=1),G=G.filter(function(e){return e.y1<=X});var Z=p(Y,R),K=function(e){return(e-W)/Z*N},$=function(e,t){return[e*s(t),-e*c(t)]},J=function(e){return y.pathAnnulus(e.rpx0,e.rpx1,e.x0,e.x1,V,U)},Q=function(e){return V+n(e)[0]*(e.transform.rCenter||0)+(e.transform.x||0)},ee=function(e){return U+n(e)[1]*(e.transform.rCenter||0)+(e.transform.y||0)};I=I.data(G,L.getPtId),I.enter().append("g").classed("slice",!0),A?I.exit().transition().each(function(){var e=g.select(this),t=e.select("path.surface");t.transition().attrTween("d",function(e){var a=u(e);return function(e){return J(a(e))}});var a=e.select("g.slicetext");a.attr("opacity",0)}).remove():I.exit().remove(),I.order();var te=null;if(A&&H){var ae=L.getPtId(H);I.each(function(e){null===te&&L.getPtId(e)===ae&&(te=e.x1)})}var oe=I;A&&(oe=oe.transition().each("end",function(){var t=g.select(this);L.setSliceCursor(t,e,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:!1})})),oe.each(function(o){var r=g.select(this),n=y.ensureSingle(r,"path","surface",function(e){e.style("pointer-events","all")});o.rpx0=K(o.y0),o.rpx1=K(o.y1),o.xmid=(o.x0+o.x1)/2,o.pxmid=$(o.rpx1,o.xmid),o.midangle=-(o.xmid-d/2),o.startangle=-(o.x0-d/2),o.stopangle=-(o.x1-d/2),o.halfangle=.5*p(y.angleDelta(o.x0,o.x1)||d,Math.PI),o.ring=1-o.rpx0/o.rpx1,o.rInscribed=i(o,z),A?n.transition().attrTween("d",function(e){var a=m(e);return function(e){return J(a(e))}}):n.attr("d",J),r.call(S,O,e,t,{eventDataKeys:C.eventDataKeys,transitionTime:C.CLICK_TRANSITION_TIME,transitionEasing:C.CLICK_TRANSITION_EASING}).call(L.setSliceCursor,e,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:e._transitioning}),n.call(T,o,z);var l=y.ensureSingle(r,"g","slicetext"),s=y.ensureSingle(l,"text","",function(e){e.attr("data-notex",1)}),c=y.ensureUniformFontSize(e,L.determineTextFont(z,o,v.font));s.text(a.formatSliceLabel(o,O,z,t,v)).classed("slicetext",!0).attr("text-anchor","middle").call(h.font,c).call(f.convertToTspans,e);var u=h.bBox(s.node());o.transform=k(u,o,P),o.transform.targetX=Q(o),o.transform.targetY=ee(o);var b=function(e,t){var a=e.transform;return w(a,t),a.fontSize=c.size,_(z.type,a,v),y.getTextTransform(a)};A?s.transition().attrTween("transform",function(e){var a=x(e);return function(e){return b(a(e),u)}}):s.attr("transform",b(o,u))})}function r(e){return m.partition().size([2*d,e.height+1])(e)}function i(e){return 0===e.rpx0&&y.isFullCircle([e.x0,e.x1])?1:u(0,p(1/(1+1/c(e.halfangle)),e.ring/2))}function n(e){return l(e.rpx1,e.transform.textPosAngle)}function l(e,t){return[e*c(t),-e*s(t)]}var g=e("d3"),m=e("d3-hierarchy"),h=e("../../components/drawing"),y=e("../../lib"),f=e("../../lib/svg_text_utils"),x=e("../bar/uniform_text"),_=x.recordMinTextSize,b=x.clearMinTextSize,v=e("../pie/plot"),w=v.computeTransform,k=v.transformInsideText,T=e("./style").styleOne,A=e("../bar/style").resizeText,S=e("./fx"),C=e("./constants"),L=e("./helpers");a.plot=function(e,t,a,r){var i=e._fullLayout,n=i._sunburstlayer,l=!i.uniformtext.mode&&L.hasTransition(a),s,d;if(b("sunburst",i),s=n.selectAll("g.trace.sunburst").data(t,function(e){return e[0].trace.uid}),s.enter().append("g").classed("trace",!0).classed("sunburst",!0).attr("stroke-linejoin","round"),s.order(),l){r&&(d=r());var c=g.transition().duration(a.duration).ease(a.easing).each("end",function(){d&&d()}).each("interrupt",function(){d&&d()});c.each(function(){n.selectAll("g.trace").each(function(t){o(e,t,this,a)})})}else s.each(function(t){o(e,t,this,a)}),i.uniformtext.mode&&A(e,i._sunburstlayer.selectAll(".trace"),"sunburst");!a&&s.exit().remove()},a.formatSliceLabel=function(e,t,a,o,r){var i=a.texttemplate,n=a.textinfo;if(!i&&(!n||"none"===n))return"";var l=r.separators,s=o[0],d=e.data.data,c=s.hierarchy,p=L.isHierarchyRoot(e),u=L.getParent(c,e),g=L.getValue(e);if(!i){var m=n.split("+"),h=function(e){return-1!==m.indexOf(e)},f=[],x;if(h("label")&&d.label&&f.push(d.label),d.hasOwnProperty("v")&&h("value")&&f.push(L.formatValue(d.v,l)),!p){h("current path")&&f.push(L.getPath(e.data));var _=0;h("percent parent")&&_++,h("percent entry")&&_++,h("percent root")&&_++;var b=1<_;if(_){var v=function(e){x=L.formatPercent(w,l),b&&(x+=" of "+e),f.push(x)},w;h("percent parent")&&!p&&(w=g/L.getValue(u),v("parent")),h("percent entry")&&(w=g/L.getValue(t),v("entry")),h("percent root")&&(w=g/L.getValue(c),v("root"))}}return h("text")&&(x=y.castOption(a,d.i,"text"),y.isValidTextValue(x)&&f.push(x)),f.join("<br>")}var k=y.castOption(a,d.i,"texttemplate");if(!k)return"";var T={};d.label&&(T.label=d.label),d.hasOwnProperty("v")&&(T.value=d.v,T.valueLabel=L.formatValue(d.v,l)),T.currentPath=L.getPath(e.data),p||(T.percentParent=g/L.getValue(u),T.percentParentLabel=L.formatPercent(T.percentParent,l),T.parent=L.getPtLabel(u)),T.percentEntry=g/L.getValue(t),T.percentEntryLabel=L.formatPercent(T.percentEntry,l),T.entry=L.getPtLabel(t),T.percentRoot=g/L.getValue(c),T.percentRootLabel=L.formatPercent(T.percentRoot,l),T.root=L.getPtLabel(c),d.hasOwnProperty("color")&&(T.color=d.color);var A=y.castOption(a,d.i,"text");return(y.isValidTextValue(A)||""===A)&&(T.text=A),T.customdata=y.castOption(a,d.i,"customdata"),y.texttemplateString(k,T,r._d3locale,T,a._meta||{})}},{"../../components/drawing":546,"../../lib":657,"../../lib/svg_text_utils":681,"../bar/style":812,"../bar/uniform_text":814,"../pie/plot":1045,"./constants":1176,"./fx":1178,"./helpers":1179,"./style":1184,d3:108,"d3-hierarchy":102}],1184:[function(e,t){'use strict';function a(e,t,a){var o=t.data.data,n=!t.children,l=o.i,s=i.castOption(a,l,"marker.line.color")||r.defaultLine,d=i.castOption(a,l,"marker.line.width")||0;e.style("stroke-width",d).call(r.fill,o.color).call(r.stroke,s).style("opacity",n?a.leaf.opacity:null)}var o=e("d3"),r=e("../../components/color"),i=e("../../lib"),n=e("../bar/uniform_text").resizeText;t.exports={style:function(e){var t=e._fullLayout._sunburstlayer.selectAll(".trace");n(e,t,"sunburst"),t.each(function(e){var t=o.select(this),r=e[0],i=r.trace;t.style("opacity",i.opacity),t.selectAll("path.surface").each(function(e){o.select(this).call(a,e,i)})})},styleOne:a}},{"../../components/color":524,"../../lib":657,"../bar/uniform_text":814,d3:108}],1185:[function(e,t){'use strict';function a(){return{valType:"boolean",dflt:!1}}function o(){return{show:{valType:"boolean",dflt:!1},start:{valType:"number",dflt:null,editType:"plot"},end:{valType:"number",dflt:null,editType:"plot"},size:{valType:"number",dflt:null,min:0,editType:"plot"},project:{x:a("x"),y:a("y"),z:a("z")},color:{valType:"color",dflt:r.defaultLine},usecolormap:{valType:"boolean",dflt:!1},width:{valType:"number",min:1,max:16,dflt:2},highlight:{valType:"boolean",dflt:!0},highlightcolor:{valType:"color",dflt:r.defaultLine},highlightwidth:{valType:"number",min:1,max:16,dflt:2}}}var r=e("../../components/color"),i=e("../../components/colorscale/attributes"),n=e("../../plots/template_attributes").hovertemplateAttrs,l=e("../../plots/attributes"),s=e("../../lib/extend").extendFlat,d=e("../../plot_api/edit_types").overrideAll,c=t.exports=d(s({z:{valType:"data_array"},x:{valType:"data_array"},y:{valType:"data_array"},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:n(),connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},surfacecolor:{valType:"data_array"}},i("",{colorAttr:"z or surfacecolor",showScaleDflt:!0,autoColorDflt:!1,editTypeOverride:"calc"}),{contours:{x:o("x"),y:o("y"),z:o("z")},hidesurface:{valType:"boolean",dflt:!1},lightposition:{x:{valType:"number",min:-1e5,max:1e5,dflt:10},y:{valType:"number",min:-1e5,max:1e5,dflt:1e4},z:{valType:"number",min:-1e5,max:1e5,dflt:0}},lighting:{ambient:{valType:"number",min:0,max:1,dflt:.8},diffuse:{valType:"number",min:0,max:1,dflt:.8},specular:{valType:"number",min:0,max:2,dflt:.05},roughness:{valType:"number",min:0,max:1,dflt:.5},fresnel:{valType:"number",min:0,max:5,dflt:.2}},opacity:{valType:"number",min:0,max:1,dflt:1},opacityscale:{valType:"any",editType:"calc"},_deprecated:{zauto:s({},i.zauto,{}),zmin:s({},i.zmin,{}),zmax:s({},i.zmax,{})},hoverinfo:s({},l.hoverinfo),showlegend:s({},l.showlegend,{dflt:!1})}),"calc","nested");c.x.editType=c.y.editType=c.z.editType="calc+clearAxisTypes",c.transforms=void 0},{"../../components/color":524,"../../components/colorscale/attributes":531,"../../lib/extend":648,"../../plot_api/edit_types":688,"../../plots/attributes":702,"../../plots/template_attributes":783}],1186:[function(e,t){'use strict';var a=e("../../components/colorscale/calc");t.exports=function(e,t){t.surfacecolor?a(e,t,{vals:t.surfacecolor,containerStr:"",cLetter:"c"}):a(e,t,{vals:t.z,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":532}],1187:[function(e,t){'use strict';var p=Math.round,u=Math.min,g=Math.pow,m=Math.abs,h=Math.max,y=Math.floor;function a(e,t,a){this.scene=e,this.uid=a,this.surface=t,this.data=null,this.showContour=[!1,!1,!1],this.contourStart=[null,null,null],this.contourEnd=[null,null,null],this.contourSize=[0,0,0],this.minValues=[1/0,1/0,1/0],this.maxValues=[-Infinity,-Infinity,-Infinity],this.dataScaleX=1,this.dataScaleY=1,this.refineData=!0,this.objectOffset=[0,0,0]}function o(e){var t=e[0].rgb,a=e[e.length-1].rgb;return t[0]===a[0]&&t[1]===a[1]&&t[2]===a[2]&&t[3]===a[3]}function r(e,t){if(e<t)return 0;for(var o=0;0===y(e%t);)e/=t,o++;return o}function n(e){for(var t=[],a=0,o;a<I.length;a++)o=I[a],t.push(r(e,o));return t}function l(e){for(var t=n(e),a=e,o=0;o<I.length;o++)if(0<t[o]){a=I[o];break}return a}function s(e,t){if(!(1>e||1>t)){for(var a=n(e),o=n(t),r=1,l=0;l<I.length;l++)r*=g(I[l],h(a[l],o[l]));return r}}function d(e){if(0!==e.length){for(var t=1,a=0;a<e.length;a++)t=s(t,e[a]);return t}}function c(e,t){for(var a=!1,o=0;o<e.length;o++)if(t===e[o]){a=!0;break}!1===a&&e.push(t)}var f=e("gl-surface3d"),x=e("ndarray"),_=e("ndarray-homography"),b=e("ndarray-fill"),w=e("../../lib").isArrayOrTypedArray,T=e("../../lib/gl_format_color").parseColorScale,A=e("../../lib/str2rgbarray"),S=e("../../components/colorscale").extractOpts,C=e("../heatmap/interp2d"),L=e("../heatmap/find_empties"),E=a.prototype;E.getXat=function(e,t,a,o){var r=w(this.data.x)?w(this.data.x[0])?this.data.x[t][e]:this.data.x[e]:e;return a===void 0?r:o.d2l(r,0,a)},E.getYat=function(e,t,a,o){var r=w(this.data.y)?w(this.data.y[0])?this.data.y[t][e]:this.data.y[t]:t;return a===void 0?r:o.d2l(r,0,a)},E.getZat=function(e,t,a,o){var r=this.data.z[t][e];return null===r&&this.data.connectgaps&&this.data._interpolatedZ&&(r=this.data._interpolatedZ[t][e]),void 0===a?r:o.d2l(r,0,a)},E.handlePick=function(e){if(e.object===this.surface){var t=(e.data.index[0]-1)/this.dataScaleX-1,a=(e.data.index[1]-1)/this.dataScaleY-1,o=h(u(p(t),this.data.z[0].length-1),0),r=h(u(p(a),this.data._ylength-1),0);e.index=[o,r],e.traceCoordinate=[this.getXat(o,r),this.getYat(o,r),this.getZat(o,r)],e.dataCoordinate=[this.getXat(o,r,this.data.xcalendar,this.scene.fullSceneLayout.xaxis),this.getYat(o,r,this.data.ycalendar,this.scene.fullSceneLayout.yaxis),this.getZat(o,r,this.data.zcalendar,this.scene.fullSceneLayout.zaxis)];for(var n=0,l;3>n;n++)l=e.dataCoordinate[n],null!==l&&void 0!==l&&(e.dataCoordinate[n]*=this.scene.dataScale[n]);var s=this.data.hovertext||this.data.text;return e.textLabel=Array.isArray(s)&&s[r]&&void 0!==s[r][o]?s[r][o]:s?s:"",e.data.dataCoordinate=e.dataCoordinate.slice(),this.surface.highlight(e.data),this.scene.glplot.spikes.position=e.dataCoordinate,!0}};var I=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999];E.calcXnums=function(e){var t=[],o;for(o=1;o<e;o++){var r=this.getXat(o-1,0),a=this.getXat(o,0);t[o-1]=a!==r&&void 0!==r&&null!==r&&void 0!==a&&null!==a?m(a-r):0}var n=0;for(o=1;o<e;o++)n+=t[o-1];for(o=1;o<e;o++)t[o-1]=0===t[o-1]?1:p(n/t[o-1]);return t},E.calcYnums=function(e){var t=[],o;for(o=1;o<e;o++){var r=this.getYat(0,o-1),a=this.getYat(0,o);t[o-1]=a!==r&&void 0!==r&&null!==r&&void 0!==a&&null!==a?m(a-r):0}var n=0;for(o=1;o<e;o++)n+=t[o-1];for(o=1;o<e;o++)t[o-1]=0===t[o-1]?1:p(n/t[o-1]);return t};var P=[1,2,4,6,12,24,36,48,60,120,180,240,360,720,840,1260],z=P[9],D=P[13];E.estimateScale=function(e,t){for(var a=0===t?this.calcXnums(e):this.calcYnums(e),o=1+d(a);o<z;)o*=2;for(;o>D;)o--,o/=l(o),o++,o<z&&(o=D);var r=p(o/e);return 1<r?r:1},E.refineCoords=function(e){for(var t=this.dataScaleX,a=this.dataScaleY,o=e[0].shape[0],r=e[0].shape[1],n=0|y(e[0].shape[0]*t+1),l=0|y(e[0].shape[1]*a+1),s=1+o+1,d=1+r+1,c=x(new Float32Array(s*d),[s,d]),p=0;p<e.length;++p){this.surface.padField(c,e[p]);var u=x(new Float32Array(n*l),[n,l]);_(u,c,[t,0,0,0,a,0,0,0,1]),e[p]=u}},E.setContourLevels=function(){var e=[[],[],[]],t=[!1,!1,!1],a=!1,o,r,n;for(o=0;3>o;++o)if(this.showContour[o]&&(a=!0,0<this.contourSize[o]&&null!==this.contourStart[o]&&null!==this.contourEnd[o]&&this.contourEnd[o]>this.contourStart[o]))for(t[o]=!0,r=this.contourStart[o];r<this.contourEnd[o];r+=this.contourSize[o])n=r*this.scene.dataScale[o],c(e[o],n);if(a){var l=[[],[],[]];for(o=0;3>o;++o)this.showContour[o]&&(l[o]=t[o]?e[o]:this.scene.contourLevels[o]);this.surface.update({levels:l})}},E.update=function(e){var t=this.scene,a=t.fullSceneLayout,r=this.surface,n=e.opacity,l=T(e,n),s=t.dataScale,d=e.z[0].length,c=e._ylength,p=t.contourLevels;this.data=e;var u=[],g,m,h,y;for(g=0;3>g;g++)for(u[g]=[],m=0;m<d;m++)u[g][m]=[];for(m=0;m<d;m++)for(h=0;h<c;h++)u[0][m][h]=this.getXat(m,h,e.xcalendar,a.xaxis),u[1][m][h]=this.getYat(m,h,e.ycalendar,a.yaxis),u[2][m][h]=this.getZat(m,h,e.zcalendar,a.zaxis);if(e.connectgaps)for(e._emptypoints=L(u[2]),C(u[2],e._emptypoints),e._interpolatedZ=[],m=0;m<d;m++)for(e._interpolatedZ[m]=[],h=0;h<c;h++)e._interpolatedZ[m][h]=u[2][m][h];for(g=0;3>g;g++)for(m=0;m<d;m++)for(h=0;h<c;h++)y=u[g][m][h],null===y||void 0===y?u[g][m][h]=NaN:y=u[g][m][h]*=s[g];for(g=0;3>g;g++)for(m=0;m<d;m++)for(h=0;h<c;h++)y=u[g][m][h],null!==y&&void 0!==y&&(this.minValues[g]>y&&(this.minValues[g]=y),this.maxValues[g]<y&&(this.maxValues[g]=y));for(g=0;3>g;g++)this.objectOffset[g]=.5*(this.minValues[g]+this.maxValues[g]);for(g=0;3>g;g++)for(m=0;m<d;m++)for(h=0;h<c;h++)y=u[g][m][h],null!==y&&void 0!==y&&(u[g][m][h]-=this.objectOffset[g]);var f=[x(new Float32Array(d*c),[d,c]),x(new Float32Array(d*c),[d,c]),x(new Float32Array(d*c),[d,c])];b(f[0],function(e,t){return u[0][e][t]}),b(f[1],function(e,t){return u[1][e][t]}),b(f[2],function(e,t){return u[2][e][t]}),u=[];var _={colormap:l,levels:[[],[],[]],showContour:[!0,!0,!0],showSurface:!e.hidesurface,contourProject:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],contourWidth:[1,1,1],contourColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],contourTint:[1,1,1],dynamicColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],dynamicWidth:[1,1,1],dynamicTint:[1,1,1],opacityscale:e.opacityscale,opacity:e.opacity},w=S(e);if(_.intensityBounds=[w.min,w.max],e.surfacecolor){var E=x(new Float32Array(d*c),[d,c]);b(E,function(t,a){return e.surfacecolor[a][t]}),f.push(E)}else _.intensityBounds[0]*=s[2],_.intensityBounds[1]*=s[2];(D<f[0].shape[0]||D<f[0].shape[1])&&(this.refineData=!1),!0===this.refineData&&(this.dataScaleX=this.estimateScale(f[0].shape[0],0),this.dataScaleY=this.estimateScale(f[0].shape[1],1),(1!==this.dataScaleX||1!==this.dataScaleY)&&this.refineCoords(f)),e.surfacecolor&&(_.intensity=f.pop());var I=[!0,!0,!0],P=["x","y","z"];for(g=0;3>g;++g){var z=e.contours[P[g]];I[g]=z.highlight,_.showContour[g]=z.show||z.highlight,_.showContour[g]&&(_.contourProject[g]=[z.project.x,z.project.y,z.project.z],z.show?(this.showContour[g]=!0,_.levels[g]=p[g],r.highlightColor[g]=_.contourColor[g]=A(z.color),r.highlightTint[g]=z.usecolormap?_.contourTint[g]=0:_.contourTint[g]=1,_.contourWidth[g]=z.width,this.contourStart[g]=z.start,this.contourEnd[g]=z.end,this.contourSize[g]=z.size):(this.showContour[g]=!1,this.contourStart[g]=null,this.contourEnd[g]=null,this.contourSize[g]=0),z.highlight&&(_.dynamicColor[g]=A(z.highlightcolor),_.dynamicWidth[g]=z.highlightwidth))}o(l)&&(_.vertexColor=!0),_.objectOffset=this.objectOffset,_.coords=f,r.update(_),r.visible=e.visible,r.enableDynamic=I,r.enableHighlight=I,r.snapToData=!0,"lighting"in e&&(r.ambientLight=e.lighting.ambient,r.diffuseLight=e.lighting.diffuse,r.specularLight=e.lighting.specular,r.roughness=e.lighting.roughness,r.fresnel=e.lighting.fresnel),"lightposition"in e&&(r.lightPosition=[e.lightposition.x,e.lightposition.y,e.lightposition.z]),n&&1>n&&(r.supportsTransparency=!0)},E.dispose=function(){this.scene.glplot.remove(this.surface),this.surface.dispose()},t.exports=function(e,t){var o=e.glplot.gl,r=f({gl:o}),i=new a(e,r,t.uid);return r._trace=i,i.update(t),e.glplot.add(r),i}},{"../../components/colorscale":536,"../../lib":657,"../../lib/gl_format_color":654,"../../lib/str2rgbarray":680,"../heatmap/find_empties":948,"../heatmap/interp2d":951,"gl-surface3d":290,ndarray:425,"ndarray-fill":415,"ndarray-homography":417}],1188:[function(e,t){'use strict';function a(e,t){for(var a=[],o=32,r=0;r<o;r++){var n=r/(o-1),l=t+(1-t)*(1-Math.pow(Math.sin(e*n*Math.PI),2));a.push([n,Math.max(0,Math.min(1,l))])}return a}function o(e){var t=0;if(!Array.isArray(e)||2>e.length)return!1;if(!e[0]||!e[e.length-1])return!1;if(0!=+e[0][0]||1!=+e[e.length-1][0])return!1;for(var a=0,o;a<e.length;a++){if(o=e[a],2!==o.length||+o[0]<t)return!1;t=+o[0]}return!0}function r(e,t,r,i){var n=i("opacityscale");"max"===n?t.opacityscale=[[0,p],[1,1]]:"min"===n?t.opacityscale=[[0,1],[1,p]]:"extremes"===n?t.opacityscale=a(1,p):!o(n)&&(t.opacityscale=void 0)}function n(e,t,a){t in e&&!(a in e)&&(e[a]=e[t])}var l=e("../../registry"),s=e("../../lib"),d=e("../../components/colorscale/defaults"),c=e("./attributes"),p=.1;t.exports={supplyDefaults:function(e,t,a,o){function p(a,o){return s.coerce(e,t,c,a,o)}var u=p("x"),g=p("y"),m=p("z"),h,y;if(!m||!m.length||!!u&&1>u.length||!!g&&1>g.length)return void(t.visible=!1);t._xlength=Array.isArray(u)&&s.isArrayOrTypedArray(u[0])?m.length:m[0].length,t._ylength=m.length;var f=l.getComponentMethod("calendars","handleTraceDefaults");f(e,t,["x","y","z"],o),p("text"),p("hovertext"),p("hovertemplate"),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lightposition.x","lightposition.y","lightposition.z","hidesurface","connectgaps","opacity"].forEach(function(e){p(e)});var x=p("surfacecolor"),_=["x","y","z"];for(h=0;3>h;++h){var b="contours."+_[h],v=p(b+".show"),w=p(b+".highlight");if(v||w)for(y=0;3>y;++y)p(b+".project."+_[y]);v&&(p(b+".color"),p(b+".width"),p(b+".usecolormap")),w&&(p(b+".highlightcolor"),p(b+".highlightwidth")),p(b+".start"),p(b+".end"),p(b+".size")}x||(n(e,"zmin","cmin"),n(e,"zmax","cmax"),n(e,"zauto","cauto")),d(e,t,o,p,{prefix:"",cLetter:"c"}),r(e,t,o,p),t._length=null},opacityscaleDefaults:r}},{"../../components/colorscale/defaults":534,"../../lib":657,"../../registry":788,"./attributes":1185}],1189:[function(e,t){'use strict';t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults").supplyDefaults,colorbar:{min:"cmin",max:"cmax"},calc:e("./calc"),plot:e("./convert"),moduleType:"trace",name:"surface",basePlotModule:e("../../plots/gl3d"),categories:["gl3d","2dMap","showLegend"],meta:{}}},{"../../plots/gl3d":747,"./attributes":1185,"./calc":1186,"./convert":1187,"./defaults":1188}],1190:[function(e,t){'use strict';var a=e("../../components/annotations/attributes"),o=e("../../lib/extend").extendFlat,r=e("../../plot_api/edit_types").overrideAll,i=e("../../plots/font_attributes"),n=e("../../plots/domain").attributes,l=e("../../constants/docs").FORMAT_LINK,s=t.exports=r({domain:n({name:"table",trace:!0}),columnwidth:{valType:"number",arrayOk:!0,dflt:null},columnorder:{valType:"data_array"},header:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[]},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:28},align:o({},a.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:o({},i({arrayOk:!0}))},cells:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[]},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:20},align:o({},a.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:o({},i({arrayOk:!0}))}},"calc","from-root");s.transforms=void 0},{"../../components/annotations/attributes":507,"../../constants/docs":628,"../../lib/extend":648,"../../plot_api/edit_types":688,"../../plots/domain":732,"../../plots/font_attributes":733}],1191:[function(e,t,a){'use strict';var o=e("../../plots/get_data").getModuleCalcData,r=e("./plot"),i="table";a.name=i,a.plot=function(e){var t=o(e.calcdata,i)[0];t.length&&r(e,t)},a.clean=function(e,t,a,o){var r=o._has&&o._has(i),n=t._has&&t._has(i);r&&!n&&o._paperdiv.selectAll(".table").remove()}},{"../../plots/get_data":742,"./plot":1198}],1192:[function(e,t){'use strict';var a=e("../../lib/gup").wrap;t.exports=function(){return a({})}},{"../../lib/gup":655}],1193:[function(e,t){'use strict';t.exports={cellPad:8,columnExtentOffset:10,columnTitleOffset:28,emptyHeaderHeight:16,latexCheck:/^\$.*\$$/,goldenRatio:1.618,lineBreaker:"<br>",maxDimensionCount:60,overdrag:45,releaseTransitionDuration:120,releaseTransitionEase:"cubic-out",scrollbarCaptureWidth:18,scrollbarHideDelay:1e3,scrollbarHideDuration:1e3,scrollbarOffset:5,scrollbarWidth:8,transitionDuration:100,transitionEase:"cubic-out",uplift:5,wrapSpacer:" ",wrapSplitCharacter:" ",cn:{table:"table",tableControlView:"table-control-view",scrollBackground:"scroll-background",yColumn:"y-column",columnBlock:"column-block",scrollAreaClip:"scroll-area-clip",scrollAreaClipRect:"scroll-area-clip-rect",columnBoundary:"column-boundary",columnBoundaryClippath:"column-boundary-clippath",columnBoundaryRect:"column-boundary-rect",columnCells:"column-cells",columnCell:"column-cell",cellRect:"cell-rect",cellText:"cell-text",cellTextHolder:"cell-text-holder",scrollbarKit:"scrollbar-kit",scrollbar:"scrollbar",scrollbarSlider:"scrollbar-slider",scrollbarGlyph:"scrollbar-glyph",scrollbarCaptureZone:"scrollbar-capture-zone"}}},{}],1194:[function(e,t){'use strict';var u=Math.min,g=Math.max,m=Math.floor;function a(e){if(Array.isArray(e)){for(var t=0,o=0;o<e.length;o++)t=g(t,a(e[o]));return t}return e}function o(e,t){return e+t}function r(e){var t=e.slice(),a=1/0,o=0,r;for(r=0;r<t.length;r++)Array.isArray(t[r])||(t[r]=[t[r]]),a=u(a,t[r].length),o=g(o,t[r].length);if(a!==o)for(r=0;r<t.length;r++){var l=o-t[r].length;l&&(t[r]=t[r].concat(n(l)))}return t}function n(e){for(var t=Array(e),a=0;a<e;a++)t[a]="";return t}function l(e){return e.calcdata.columns.reduce(function(t,a){return a.xIndex<e.xIndex?t+a.columnWidth:t},0)}function s(e,t){var a=Object.keys(e);return a.map(function(a){return i({},e[a],{auxiliaryBlocks:t})})}function d(e,t){for(var a={},o=0,r=0,n=p(),l=0,s=0,d=0,c;d<e.length;d++)c=e[d],n.rows.push({rowIndex:d,rowHeight:c}),r+=c,(r>=t||d===e.length-1)&&(a[o]=n,n.key=s++,n.firstRowIndex=l,n.lastRowIndex=d,n=p(),o+=r,l=d+1,r=0);return a}function p(){return{firstRowIndex:null,lastRowIndex:null,rows:[]}}var h=e("./constants"),i=e("../../lib/extend").extendFlat,c=e("fast-isnumeric");t.exports=function(e,t){var p=r(t.cells.values),y=function(e){return e.slice(t.header.values.length,e.length)},f=r(t.header.values);f.length&&!f[0].length&&(f[0]=[""],f=r(f));var x=f.concat(y(p).map(function(){return n((f[0]||[""]).length)})),_=t.domain,b=m(e._fullLayout._size.w*(_.x[1]-_.x[0])),v=m(e._fullLayout._size.h*(_.y[1]-_.y[0])),w=t.header.values.length?x[0].map(function(){return t.header.height}):[h.emptyHeaderHeight],k=p.length?p[0].map(function(){return t.cells.height}):[],T=w.reduce(o,0),A=v-T+h.uplift,S=d(k,A),C=d(w,T),L=s(C,[]),E=s(S,L),I={},P=t._fullInput.columnorder.concat(y(p.map(function(e,t){return t}))),z=x.map(function(e,a){var o=Array.isArray(t.columnwidth)?t.columnwidth[u(a,t.columnwidth.length-1)]:t.columnwidth;return c(o)?+o:1}),D=z.reduce(o,0);z=z.map(function(e){return e/D*b});var O=g(a(t.header.line.width),a(t.cells.line.width)),R={key:t.uid+e._context.staticPlot,translateX:_.x[0]*e._fullLayout._size.w,translateY:e._fullLayout._size.h*(1-_.y[1]),size:e._fullLayout._size,width:b,maxLineWidth:O,height:v,columnOrder:P,groupHeight:v,rowBlocks:E,headerRowBlocks:L,scrollY:0,cells:i({},t.cells,{values:p}),headerCells:i({},t.header,{values:x}),gdColumns:x.map(function(e){return e[0]}),gdColumnsOriginalOrder:x.map(function(e){return e[0]}),prevPages:[0,0],scrollbarState:{scrollbarScrollInProgress:!1},columns:x.map(function(e,t){var a=I[e];I[e]=(a||0)+1;var o=e+"__"+I[e];return{key:o,label:e,specIndex:t,xIndex:P[t],xScale:l,x:void 0,calcdata:void 0,columnWidth:z[t]}})};return R.columns.forEach(function(e){e.calcdata=R,e.x=l(e)}),R}},{"../../lib/extend":648,"./constants":1193,"fast-isnumeric":201}],1195:[function(e,t,a){'use strict';function o(e){var t=e.rowBlocks[e.page],a=t?t.rows[0].rowIndex:0,o=t?a+t.rows.length:0;return[a,o]}var r=e("../../lib/extend").extendFlat;a.splitToPanels=function(e){var t=[0,0],a=r({},e,{key:"header",type:"header",page:0,prevPages:t,currentRepaint:[null,null],dragHandle:!0,values:e.calcdata.headerCells.values[e.specIndex],rowBlocks:e.calcdata.headerRowBlocks,calcdata:r({},e.calcdata,{cells:e.calcdata.headerCells})}),o=r({},e,{key:"cells1",type:"cells",page:0,prevPages:t,currentRepaint:[null,null],dragHandle:!1,values:e.calcdata.cells.values[e.specIndex],rowBlocks:e.calcdata.rowBlocks}),i=r({},e,{key:"cells2",type:"cells",page:1,prevPages:t,currentRepaint:[null,null],dragHandle:!1,values:e.calcdata.cells.values[e.specIndex],rowBlocks:e.calcdata.rowBlocks});return[o,i,a]},a.splitToCells=function(e){var t=o(e);return(e.values||[]).slice(t[0],t[1]).map(function(a,o){var r="string"==typeof a&&a.match(/[<$&> ]/)?"_keybuster_"+Math.random():"";return{keyWithinBlock:o+r,key:t[0]+o,column:e,calcdata:e.calcdata,page:e.page,rowBlocks:e.rowBlocks,value:a}})}},{"../../lib/extend":648}],1196:[function(e,t){'use strict';function a(e,t){for(var a=e.columnorder||[],o=e.header.values.length,r=a.slice(0,o),n=r.slice().sort(function(e,t){return e-t}),l=r.map(function(e){return n.indexOf(e)}),s=l.length;s<o;s++)l.push(s);t("columnorder",l)}var o=e("../../lib"),r=e("./attributes"),i=e("../../plots/domain").defaults;t.exports=function(e,t,n,l){function s(a,i){return o.coerce(e,t,r,a,i)}i(t,l,s),s("columnwidth"),s("header.values"),s("header.format"),s("header.align"),s("header.prefix"),s("header.suffix"),s("header.height"),s("header.line.width"),s("header.line.color"),s("header.fill.color"),o.coerceFont(s,"header.font",o.extendFlat({},l.font)),a(t,s),s("cells.values"),s("cells.format"),s("cells.align"),s("cells.prefix"),s("cells.suffix"),s("cells.height"),s("cells.line.width"),s("cells.line.color"),s("cells.fill.color"),o.coerceFont(s,"cells.font",o.extendFlat({},l.font)),t._length=null}},{"../../lib":657,"../../plots/domain":732,"./attributes":1190}],1197:[function(e,t){'use strict';t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc"),plot:e("./plot"),moduleType:"trace",name:"table",basePlotModule:e("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1190,"./base_plot":1191,"./calc":1192,"./defaults":1196,"./plot":1198}],1198:[function(e,t){'use strict';var F=Math.min,N=Math.max;function a(e){return Math.ceil(e.calcdata.maxLineWidth/2)}function o(e,t){return"clip"+e._fullLayout._uid+"_scrollAreaBottomClip_"+t.key}function r(e,t){return"clip"+e._fullLayout._uid+"_columnBoundaryClippath_"+t.calcdata.key+"_"+t.specIndex}function i(e){return[].concat.apply([],e.map(function(e){return e})).map(function(e){return e.__data__})}function n(e,t,a){function o(e){var t=e.rowBlocks;return O(t,t.length-1)+(t.length?R(t[t.length-1],1/0):1)}var r=e.selectAll("."+V.cn.scrollbarKit).data(U.repeat,U.keyFun);r.enter().append("g").classed(V.cn.scrollbarKit,!0).style("shape-rendering","geometricPrecision"),r.each(function(e){var t=e.scrollbarState;t.totalHeight=o(e),t.scrollableAreaHeight=e.groupHeight-A(e),t.currentlyVisibleHeight=F(t.totalHeight,t.scrollableAreaHeight),t.ratio=t.currentlyVisibleHeight/t.totalHeight,t.barLength=N(t.ratio*t.currentlyVisibleHeight,V.goldenRatio*V.scrollbarWidth),t.barWiggleRoom=t.currentlyVisibleHeight-t.barLength,t.wiggleRoom=N(0,t.totalHeight-t.scrollableAreaHeight),t.topY=0===t.barWiggleRoom?0:e.scrollY/t.wiggleRoom*t.barWiggleRoom,t.bottomY=t.topY+t.barLength,t.dragMultiplier=t.wiggleRoom/t.barWiggleRoom}).attr("transform",function(e){var t=e.width+V.scrollbarWidth/2+V.scrollbarOffset;return"translate("+t+" "+A(e)+")"});var i=r.selectAll("."+V.cn.scrollbar).data(U.repeat,U.keyFun);i.enter().append("g").classed(V.cn.scrollbar,!0);var n=i.selectAll("."+V.cn.scrollbarSlider).data(U.repeat,U.keyFun);n.enter().append("g").classed(V.cn.scrollbarSlider,!0),n.attr("transform",function(e){return"translate(0 "+(e.scrollbarState.topY||0)+")"});var l=n.selectAll("."+V.cn.scrollbarGlyph).data(U.repeat,U.keyFun);l.enter().append("line").classed(V.cn.scrollbarGlyph,!0).attr("stroke","black").attr("stroke-width",V.scrollbarWidth).attr("stroke-linecap","round").attr("y1",V.scrollbarWidth/2),l.attr("y2",function(e){return e.scrollbarState.barLength-V.scrollbarWidth/2}).attr("stroke-opacity",function(e){return e.columnDragInProgress||!e.scrollbarState.barWiggleRoom||a?0:.4}),l.transition().delay(0).duration(0),l.transition().delay(V.scrollbarHideDelay).duration(V.scrollbarHideDuration).attr("stroke-opacity",0);var s=i.selectAll("."+V.cn.scrollbarCaptureZone).data(U.repeat,U.keyFun);s.enter().append("line").classed(V.cn.scrollbarCaptureZone,!0).attr("stroke","white").attr("stroke-opacity",.01).attr("stroke-width",V.scrollbarCaptureWidth).attr("stroke-linecap","butt").attr("y1",0).on("mousedown",function(a){var o=c.event.y,r=this.getBoundingClientRect(),i=a.scrollbarState,n=o-r.top,l=c.scale.linear().domain([0,i.scrollableAreaHeight]).range([0,i.totalHeight]).clamp(!0);i.topY<=n&&n<=i.bottomY||L(t,e,null,l(n-i.barLength/2))(a)}).call(c.behavior.drag().origin(function(e){return c.event.stopPropagation(),e.scrollbarState.scrollbarScrollInProgress=!0,e}).on("drag",L(t,e)).on("dragend",function(){})),s.attr("y2",function(e){return e.scrollbarState.scrollableAreaHeight}),t._context.staticPlot&&(l.remove(),s.remove())}function l(e,t,a,o){var r=s(a),i=d(r);m(i);var n=p(i);y(n);var l=g(i),c=u(l);h(c),f(c,t,o,e),D(i)}function s(e){var t=e.selectAll("."+V.cn.columnCells).data(U.repeat,U.keyFun);return t.enter().append("g").classed(V.cn.columnCells,!0),t.exit().remove(),t}function d(e){var t=e.selectAll("."+V.cn.columnCell).data(X.splitToCells,function(e){return e.keyWithinBlock});return t.enter().append("g").classed(V.cn.columnCell,!0),t.exit().remove(),t}function p(e){var t=e.selectAll("."+V.cn.cellRect).data(U.repeat,function(e){return e.keyWithinBlock});return t.enter().append("rect").classed(V.cn.cellRect,!0),t}function u(e){var t=e.selectAll("."+V.cn.cellText).data(U.repeat,function(e){return e.keyWithinBlock});return t.enter().append("text").classed(V.cn.cellText,!0).style("cursor",function(){return"auto"}).on("mousedown",function(){c.event.stopPropagation()}),t}function g(e){var t=e.selectAll("."+V.cn.cellTextHolder).data(U.repeat,function(e){return e.keyWithinBlock});return t.enter().append("g").classed(V.cn.cellTextHolder,!0).style("shape-rendering","geometricPrecision"),t}function m(e){e.each(function(e,t){var a=e.calcdata.cells.font,o=e.column.specIndex,r={size:v(a.size,o,t),color:v(a.color,o,t),family:v(a.family,o,t)};e.rowNumber=e.key,e.align=v(e.calcdata.cells.align,o,t),e.cellBorderWidth=v(e.calcdata.cells.line.width,o,t),e.font=r})}function h(e){e.each(function(e){H.font(c.select(this),e.font)})}function y(e){e.attr("width",function(e){return e.column.columnWidth}).attr("stroke-width",function(e){return e.cellBorderWidth}).each(function(e){var t=c.select(this);Z.stroke(t,v(e.calcdata.cells.line.color,e.column.specIndex,e.rowNumber)),Z.fill(t,v(e.calcdata.cells.fill.color,e.column.specIndex,e.rowNumber))})}function f(e,t,a,o){e.text(function(e){var t=e.column.specIndex,a=e.rowNumber,o=e.value,r="string"==typeof o,i=r&&o.match(/<br>/i);e.mayHaveMarkup=r&&o.match(/[<&>]/);var n=x(o);e.latex=n;var l=n?"":v(e.calcdata.cells.prefix,t,a)||"",s=n?"":v(e.calcdata.cells.suffix,t,a)||"",d=n?null:v(e.calcdata.cells.format,t,a)||null,p=l+(d?c.format(d)(e.value):e.value)+s,u;e.wrappingNeeded=!e.wrapped&&!(!r||i)&&!n&&(u=_(p)),e.cellHeightMayIncrease=i||n||e.mayHaveMarkup||(void 0===u?_(p):u),e.needsConvertToTspans=e.mayHaveMarkup||e.wrappingNeeded||e.latex;var g;if(e.wrappingNeeded){var m=" "===V.wrapSplitCharacter?p.replace(/<a href=/ig,"<a_href="):p,h=m.split(V.wrapSplitCharacter),y=" "===V.wrapSplitCharacter?h.map(function(e){return e.replace(/<a_href=/ig,"<a href=")}):h;e.fragments=y.map(function(e){return{text:e,width:null}}),e.fragments.push({fragment:V.wrapSpacer,width:null}),g=y.join(V.lineBreaker)+V.lineBreaker+V.wrapSpacer}else delete e.fragments,g=p;return g}).attr("dy",function(e){return e.needsConvertToTspans?0:"0.75em"}).each(function(e){var r=this,i=c.select(r),n=e.wrappingNeeded?I:P;e.needsConvertToTspans?q.convertToTspans(i,o,n(a,r,t,o,e)):c.select(r.parentNode).attr("transform",function(e){return"translate("+z(e)+" "+V.cellPad+")"}).attr("text-anchor",function(e){return{left:"start",center:"middle",right:"end"}[e.align]})})}function x(e){return"string"==typeof e&&e.match(V.latexCheck)}function _(e){return-1!==e.indexOf(V.wrapSplitCharacter)}function b(e,t,r){var i=t.gdColumnsOriginalOrder;t.gdColumns.sort(function(e,t){return r[i.indexOf(e)]-r[i.indexOf(t)]}),t.columnorder=r,e.emit("plotly_restyle")}function v(e,t,a){if(Array.isArray(e)){var o=e[F(t,e.length-1)];return Array.isArray(o)?o[F(a,o.length-1)]:o}return e}function w(e,t,a){e.transition().ease(V.releaseTransitionEase).duration(V.releaseTransitionDuration).attr("transform","translate("+t.x+" "+a+")")}function k(e){return"cells"===e.type}function T(e){return"header"===e.type}function A(e){var t=e.rowBlocks.length?e.rowBlocks[0].auxiliaryBlocks:[];return t.reduce(function(e,t){return e+R(t,1/0)},0)}function S(e,t,a){for(var o=[],r=0,n=0;n<e.length;n++){for(var l=e[n],s=l.rows,d=0,c=0;c<s.length;c++)d+=s[c].rowHeight;l.allRowsHeight=d;var p=r+d,u=t;u<p&&u+a>r&&o.push(n),r+=d}return o}function C(e,t,a){var o=i(t)[0];if(void 0!==o){var r=o.rowBlocks,l=o.calcdata,s=O(r,r.length),d=o.calcdata.groupHeight-A(o),c=l.scrollY=N(0,F(s-d,l.scrollY)),p=S(r,c,d);1===p.length&&(p[0]===r.length-1?p.unshift(p[0]-1):p.push(p[0]+1)),p[0]%2&&p.reverse(),t.each(function(e,t){e.page=p[t],e.scrollY=c}),t.attr("transform",function(e){var t=O(e.rowBlocks,e.page)-e.scrollY;return"translate(0 "+t+")"}),e&&(E(e,a,t,p,o.prevPages,o,0),E(e,a,t,p,o.prevPages,o,1),n(a,e))}}function L(e,t,a,o){return function(r){var i=r.calcdata?r.calcdata:r,n=t.filter(function(e){return i.key===e.key}),l=a||i.scrollbarState.dragMultiplier,s=i.scrollY;i.scrollY=void 0===o?i.scrollY+l*c.event.dy:o;var d=n.selectAll("."+V.cn.yColumn).selectAll("."+V.cn.columnBlock).filter(k);return C(e,d,n),i.scrollY===s}}function E(e,t,a,o,r,i,n){var s=o[n]!==r[n];s&&(clearTimeout(i.currentRepaint[n]),i.currentRepaint[n]=setTimeout(function(){var i=a.filter(function(e,t){return t===n&&o[t]!==r[t]});l(e,t,i,a),r[n]=o[n]}))}function I(e,t,a,o){return function(){var r=c.select(t.parentNode);r.each(function(e){var t=e.fragments;r.selectAll("tspan.line").each(function(e,a){t[a].width=this.getComputedTextLength()});var a=t[t.length-1].width,o=t.slice(0,-1),i=[],n=0,l=e.column.columnWidth-2*V.cellPad,s,d;for(e.value="";o.length;)s=o.shift(),d=s.width+a,n+d>l&&(e.value+=i.join(V.wrapSpacer)+V.lineBreaker,i=[],n=0),i.push(s.text),n+=d;n&&(e.value+=i.join(V.wrapSpacer)),e.wrapped=!0}),r.selectAll("tspan.line").remove(),f(r.select("."+V.cn.cellText),a,e,o),c.select(t.parentNode.parentNode).call(D)}}function P(e,t,a,o,r){return function(){if(!r.settledY){var i=c.select(t.parentNode),s=j(r),l=r.key-s.firstRowIndex,d=s.rows[l].rowHeight,p=r.cellHeightMayIncrease?t.parentNode.getBoundingClientRect().height+2*V.cellPad:d,u=N(p,d),g=u-s.rows[l].rowHeight;g&&(s.rows[l].rowHeight=u,e.selectAll("."+V.cn.columnCell).call(D),C(null,e.filter(k),0),n(a,o,!0)),i.attr("transform",function(){var e=this,t=e.parentNode,a=t.getBoundingClientRect(),o=c.select(e.parentNode).select("."+V.cn.cellRect).node().getBoundingClientRect(),i=e.transform.baseVal.consolidate(),n=o.top-a.top+(i?i.matrix.f:V.cellPad);return"translate("+z(r,c.select(e.parentNode).select("."+V.cn.cellTextHolder).node().getBoundingClientRect().width)+" "+n+")"}),r.settledY=!0}}}function z(e,t){switch(e.align){case"left":return V.cellPad;case"right":return e.column.columnWidth-(t||0)-V.cellPad;case"center":return(e.column.columnWidth-(t||0))/2;default:return V.cellPad;}}function D(e){e.attr("transform",function(e){var t=e.rowBlocks[0].auxiliaryBlocks.reduce(function(e,t){return e+R(t,1/0)},0),a=j(e),o=R(a,e.key);return"translate(0 "+(o+t)+")"}).selectAll("."+V.cn.cellRect).attr("height",function(e){return B(j(e),e.key).rowHeight})}function O(e,t){for(var a=0,o=t-1;0<=o;o--)a+=M(e[o]);return a}function R(e,t){for(var a=0,o=0;o<e.rows.length&&e.rows[o].rowIndex<t;o++)a+=e.rows[o].rowHeight;return a}function M(e){var t=e.allRowsHeight;if(void 0!==t)return t;for(var a=0,o=0;o<e.rows.length;o++)a+=e.rows[o].rowHeight;return e.allRowsHeight=a,a}function j(e){return e.rowBlocks[e.page]}function B(e,t){return e.rows[t-e.firstRowIndex]}var V=e("./constants"),c=e("d3"),U=e("../../lib/gup"),H=e("../../components/drawing"),q=e("../../lib/svg_text_utils"),G=e("../../lib").raiseToTop,Y=e("../../lib").cancelTransition,W=e("./data_preparation_helper"),X=e("./data_split_helpers"),Z=e("../../components/color");t.exports=function(e,t){var s=!e._context.staticPlot,d=e._fullLayout._paper.selectAll("."+V.cn.table).data(t.map(function(t){var a=U.unwrap(t),o=a.trace;return W(e,o)}),U.keyFun);d.exit().remove(),d.enter().append("g").classed(V.cn.table,!0).attr("overflow","visible").style("box-sizing","content-box").style("position","absolute").style("left",0).style("overflow","visible").style("shape-rendering","crispEdges").style("pointer-events","all"),d.attr("width",function(e){return e.width+e.size.l+e.size.r}).attr("height",function(e){return e.height+e.size.t+e.size.b}).attr("transform",function(e){return"translate("+e.translateX+","+e.translateY+")"});var p=d.selectAll("."+V.cn.tableControlView).data(U.repeat,U.keyFun),u=p.enter().append("g").classed(V.cn.tableControlView,!0).style("box-sizing","content-box");s&&u.on("mousemove",function(t){p.filter(function(e){return t===e}).call(n,e)}).on("mousewheel",function(t){if(!t.scrollbarState.wheeling){t.scrollbarState.wheeling=!0;var a=t.scrollY+c.event.deltaY,o=L(e,p,null,a)(t);o||(c.event.stopPropagation(),c.event.preventDefault()),t.scrollbarState.wheeling=!1}}).call(n,e,!0),p.attr("transform",function(e){return"translate("+e.size.l+" "+e.size.t+")"});var g=p.selectAll("."+V.cn.scrollBackground).data(U.repeat,U.keyFun);g.enter().append("rect").classed(V.cn.scrollBackground,!0).attr("fill","none"),g.attr("width",function(e){return e.width}).attr("height",function(e){return e.height}),p.each(function(t){H.setClipUrl(c.select(this),o(e,t),e)});var m=p.selectAll("."+V.cn.yColumn).data(function(e){return e.columns},U.keyFun);m.enter().append("g").classed(V.cn.yColumn,!0),m.exit().remove(),m.attr("transform",function(e){return"translate("+e.x+" 0)"}),s&&m.call(c.behavior.drag().origin(function(t){var a=c.select(this);return w(a,t,-V.uplift),G(this),t.calcdata.columnDragInProgress=!0,n(p.filter(function(e){return t.calcdata.key===e.key}),e),t}).on("drag",function(e){var t=c.select(this),o=function(t){return(e===t?c.event.x:t.x)+t.columnWidth/2};e.x=N(-V.overdrag,F(e.calcdata.width+V.overdrag-e.columnWidth,c.event.x));var r=i(m).filter(function(t){return t.calcdata.key===e.calcdata.key}),n=r.sort(function(e,t){return o(e)-o(t)});n.forEach(function(t,a){t.xIndex=a,t.x=e===t?t.x:t.xScale(t)}),m.filter(function(t){return e!==t}).transition().ease(V.transitionEase).duration(V.transitionDuration).attr("transform",function(e){return"translate("+e.x+" 0)"}),t.call(Y).attr("transform","translate("+e.x+" -"+V.uplift+" )")}).on("dragend",function(t){var a=c.select(this),o=t.calcdata;t.x=t.xScale(t),t.calcdata.columnDragInProgress=!1,w(a,t,0),b(e,o,o.columns.map(function(e){return e.xIndex}))})),m.each(function(t){H.setClipUrl(c.select(this),r(e,t),e)});var h=m.selectAll("."+V.cn.columnBlock).data(X.splitToPanels,U.keyFun);h.enter().append("g").classed(V.cn.columnBlock,!0).attr("id",function(e){return e.key}),h.style("cursor",function(e){return e.dragHandle?"ew-resize":e.calcdata.scrollbarState.barWiggleRoom?"ns-resize":"default"});var y=h.filter(T),f=h.filter(k);s&&f.call(c.behavior.drag().origin(function(e){return c.event.stopPropagation(),e}).on("drag",L(e,p,-1)).on("dragend",function(){})),l(e,p,y,h),l(e,p,f,h);var x=p.selectAll("."+V.cn.scrollAreaClip).data(U.repeat,U.keyFun);x.enter().append("clipPath").classed(V.cn.scrollAreaClip,!0).attr("id",function(t){return o(e,t)});var _=x.selectAll("."+V.cn.scrollAreaClipRect).data(U.repeat,U.keyFun);_.enter().append("rect").classed(V.cn.scrollAreaClipRect,!0).attr("x",-V.overdrag).attr("y",-V.uplift).attr("fill","none"),_.attr("width",function(e){return e.width+2*V.overdrag}).attr("height",function(e){return e.height+V.uplift});var v=m.selectAll("."+V.cn.columnBoundary).data(U.repeat,U.keyFun);v.enter().append("g").classed(V.cn.columnBoundary,!0);var A=m.selectAll("."+V.cn.columnBoundaryClippath).data(U.repeat,U.keyFun);A.enter().append("clipPath").classed(V.cn.columnBoundaryClippath,!0),A.attr("id",function(t){return r(e,t)});var S=A.selectAll("."+V.cn.columnBoundaryRect).data(U.repeat,U.keyFun);S.enter().append("rect").classed(V.cn.columnBoundaryRect,!0).attr("fill","none"),S.attr("width",function(e){return e.columnWidth+2*a(e)}).attr("height",function(e){return e.calcdata.height+2*a(e)+V.uplift}).attr("x",function(e){return-a(e)}).attr("y",function(e){return-a(e)}),C(null,f,p)}},{"../../components/color":524,"../../components/drawing":546,"../../lib":657,"../../lib/gup":655,"../../lib/svg_text_utils":681,"./constants":1193,"./data_preparation_helper":1194,"./data_split_helpers":1195,d3:108}],1199:[function(e,t){'use strict';var a=e("../../plots/template_attributes").hovertemplateAttrs,o=e("../../plots/template_attributes").texttemplateAttrs,r=e("../../components/colorscale/attributes"),i=e("../../plots/domain").attributes,n=e("../pie/attributes"),l=e("../sunburst/attributes"),s=e("./constants"),d=e("../../lib/extend").extendFlat;t.exports={labels:l.labels,parents:l.parents,values:l.values,branchvalues:l.branchvalues,count:l.count,level:l.level,maxdepth:l.maxdepth,tiling:{packing:{valType:"enumerated",values:["squarify","binary","dice","slice","slice-dice","dice-slice"],dflt:"squarify",editType:"plot"},squarifyratio:{valType:"number",min:1,dflt:1,editType:"plot"},flip:{valType:"flaglist",flags:["x","y"],dflt:"",editType:"plot"},pad:{valType:"number",min:0,dflt:3,editType:"plot"},editType:"calc"},marker:d({pad:{t:{valType:"number",min:0,editType:"plot"},l:{valType:"number",min:0,editType:"plot"},r:{valType:"number",min:0,editType:"plot"},b:{valType:"number",min:0,editType:"plot"},editType:"calc"},colors:l.marker.colors,depthfade:{valType:"enumerated",values:[!0,!1,"reversed"],editType:"style"},line:l.marker.line,editType:"calc"},r("marker",{colorAttr:"colors",anim:!1})),pathbar:{visible:{valType:"boolean",dflt:!0,editType:"plot"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},edgeshape:{valType:"enumerated",values:[">","<","|","/","\\"],dflt:">",editType:"plot"},thickness:{valType:"number",min:12,editType:"plot"},textfont:d({},n.textfont,{}),editType:"calc"},text:n.text,textinfo:l.textinfo,texttemplate:o({editType:"plot"},{keys:s.eventDataKeys.concat(["label","value"])}),hovertext:n.hovertext,hoverinfo:l.hoverinfo,hovertemplate:a({},{keys:s.eventDataKeys}),textfont:n.textfont,insidetextfont:n.insidetextfont,outsidetextfont:d({},n.outsidetextfont,{}),textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"top left",editType:"plot"},domain:i({name:"treemap",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":531,"../../lib/extend":648,"../../plots/domain":732,"../../plots/template_attributes":783,"../pie/attributes":1036,"../sunburst/attributes":1173,"./constants":1202}],1200:[function(e,t,a){'use strict';var o=e("../../plots/plots");a.name="treemap",a.plot=function(e,t,r,i){o.plotBasePlot(a.name,e,t,r,i)},a.clean=function(e,t,r,i){o.cleanBasePlot(a.name,e,t,r,i)}},{"../../plots/plots":768}],1201:[function(e,t,a){'use strict';var o=e("../sunburst/calc");a.calc=function(e,t){return o.calc(e,t)},a.crossTraceCalc=function(e){return o._runCrossTraceCalc("treemap",e)}},{"../sunburst/calc":1175}],1202:[function(e,t){'use strict';t.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"poly",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"],gapWithPathbar:1}},{}],1203:[function(e,t){'use strict';var a=e("../../lib"),o=e("./attributes"),r=e("../../components/color"),i=e("../../plots/domain").defaults,n=e("../bar/defaults").handleText,l=e("../bar/constants").TEXTPAD,s=e("../../components/colorscale"),d=s.hasColorscale,c=s.handleDefaults;t.exports=function(e,t,s,p){function u(r,i){return a.coerce(e,t,o,r,i)}var g=u("labels"),m=u("parents");if(!g||!g.length||!m||!m.length)return void(t.visible=!1);var h=u("values");h&&h.length?u("branchvalues"):u("count"),u("level"),u("maxdepth");var y=u("tiling.packing");"squarify"===y&&u("tiling.squarifyratio"),u("tiling.flip"),u("tiling.pad");var f=u("text");u("texttemplate"),t.texttemplate||u("textinfo",Array.isArray(f)?"text+label":"label"),u("hovertext"),u("hovertemplate");var x=u("pathbar.visible");n(e,t,p,u,"auto",{hasPathbar:x,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),u("textposition");var _=-1!==t.textposition.indexOf("bottom"),b=u("marker.line.width");b&&u("marker.line.color",p.paper_bgcolor);var v=u("marker.colors"),w=t._hasColorscale=d(e,"marker","colors")||(e.marker||{}).coloraxis;w?c(e,t,p,u,{prefix:"marker.",cLetter:"c"}):u("marker.depthfade",!(v||[]).length);var k=2*t.textfont.size;u("marker.pad.t",_?k/4:k),u("marker.pad.l",k/4),u("marker.pad.r",k/4),u("marker.pad.b",_?k:k/4),w&&c(e,t,p,u,{prefix:"marker.",cLetter:"c"}),t._hovered={marker:{line:{width:2,color:r.contrast(p.paper_bgcolor)}}},x&&(u("pathbar.thickness",t.pathbar.textfont.size+2*l),u("pathbar.side"),u("pathbar.edgeshape")),i(t,p,u),t._length=null}},{"../../components/color":524,"../../components/colorscale":536,"../../lib":657,"../../plots/domain":732,"../bar/constants":800,"../bar/defaults":802,"./attributes":1199}],1204:[function(e,t){'use strict';var a=e("d3"),o=e("../../lib"),r=e("../../components/drawing"),i=e("../../lib/svg_text_utils"),n=e("./partition"),l=e("./style").styleOne,s=e("./constants"),d=e("../sunburst/helpers"),c=e("../sunburst/fx"),p=!0;t.exports=function(e,t,u,g,m){var h=m.barDifY,y=m.width,f=m.height,x=m.viewX,_=m.viewY,b=m.pathSlice,v=m.toMoveInsideSlice,w=m.strTransform,k=m.hasTransition,T=m.handleSlicesExit,A=m.makeUpdateSliceInterpolator,S=m.makeUpdateTextInterpolator,C={},L=e._fullLayout,E=t[0],I=E.trace,P=E.hierarchy,z=y/I._entryDepth,D=d.listPath(u.data,"id"),O=n(P.copy(),[y,f],{packing:"dice",pad:{inner:0,top:0,left:0,right:0,bottom:0}}).descendants();O=O.filter(function(e){var t=D.indexOf(e.data.id);return-1!==t&&(e.x0=z*t,e.x1=z*(t+1),e.y0=h,e.y1=h+f,e.onPathbar=!0,!0)}),O.reverse(),g=g.data(O,d.getPtId),g.enter().append("g").classed("pathbar",!0),T(g,p,C,[y,f],b),g.order();var R=g;k&&(R=R.transition().each("end",function(){var t=a.select(this);d.setSliceCursor(t,e,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:!1})})),R.each(function(n){n._hoverX=x(n.x1-Math.min(y,f)/2),n._hoverY=_(n.y1-f/2);var g=a.select(this),m=o.ensureSingle(g,"path","surface",function(e){e.style("pointer-events","all")});k?m.transition().attrTween("d",function(e){var a=A(e,p,C,[y,f]);return function(e){return b(a(e))}}):m.attr("d",b),g.call(c,u,e,t,{styleOne:l,eventDataKeys:s.eventDataKeys,transitionTime:s.CLICK_TRANSITION_TIME,transitionEasing:s.CLICK_TRANSITION_EASING}).call(d.setSliceCursor,e,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:e._transitioning}),m.call(l,n,I,{hovered:!1}),n._text=(d.getPtLabel(n)||"").split("<br>").join(" ")||"";var h=o.ensureSingle(g,"g","slicetext"),T=o.ensureSingle(h,"text","",function(e){e.attr("data-notex",1)}),E=o.ensureUniformFontSize(e,d.determineTextFont(I,n,L.font,{onPathbar:!0}));T.text(n._text||" ").classed("slicetext",!0).attr("text-anchor","start").call(r.font,E).call(i.convertToTspans,e),n.textBB=r.bBox(T.node()),n.transform=v(n,{fontSize:E.size,onPathbar:!0}),n.transform.fontSize=E.size,k?T.transition().attrTween("transform",function(e){var a=S(e,p,C,[y,f]);return function(e){return w(a(e))}}):T.attr("transform",w(n))})}},{"../../components/drawing":546,"../../lib":657,"../../lib/svg_text_utils":681,"../sunburst/fx":1178,"../sunburst/helpers":1179,"./constants":1202,"./partition":1209,"./style":1211,d3:108}],1205:[function(e,t){'use strict';var a=Math.min,o=Math.max,r=e("d3"),i=e("../../lib"),n=e("../../components/drawing"),l=e("../../lib/svg_text_utils"),s=e("./partition"),d=e("./style").styleOne,c=e("./constants"),p=e("../sunburst/helpers"),u=e("../sunburst/fx"),g=e("../sunburst/plot").formatSliceLabel,m=!1;t.exports=function(e,t,h,y,f){var x=f.width,_=f.height,b=f.viewX,v=f.viewY,w=f.pathSlice,k=f.toMoveInsideSlice,T=f.strTransform,A=f.hasTransition,S=f.handleSlicesExit,C=f.makeUpdateSliceInterpolator,L=f.makeUpdateTextInterpolator,E=f.prevEntry,I=e._fullLayout,P=t[0],z=P.trace,D=-1!==z.textposition.indexOf("left"),O=-1!==z.textposition.indexOf("right"),R=-1!==z.textposition.indexOf("bottom"),M=!R&&!z.marker.pad.t||R&&!z.marker.pad.b,j=s(h,[x,_],{packing:z.tiling.packing,squarifyratio:z.tiling.squarifyratio,flipX:-1<z.tiling.flip.indexOf("x"),flipY:-1<z.tiling.flip.indexOf("y"),pad:{inner:z.tiling.pad,top:z.marker.pad.t,left:z.marker.pad.l,right:z.marker.pad.r,bottom:z.marker.pad.b}}),B=j.descendants(),F=1/0,N=-Infinity;B.forEach(function(e){var t=e.depth;t>=z._maxDepth?(e.x0=e.x1=(e.x0+e.x1)/2,e.y0=e.y1=(e.y0+e.y1)/2):(F=a(F,t),N=o(N,t))}),y=y.data(B,p.getPtId),z._maxVisibleLayers=isFinite(N)?N-F+1:0,y.enter().append("g").classed("slice",!0),S(y,m,{},[x,_],w),y.order();var V=null;if(A&&E){var U=p.getPtId(E);y.each(function(e){null===V&&p.getPtId(e)===U&&(V={x0:e.x0,x1:e.x1,y0:e.y0,y1:e.y1})})}var H=function(){return V||{x0:0,x1:x,y0:0,y1:_}},q=y;return A&&(q=q.transition().each("end",function(){var t=r.select(this);p.setSliceCursor(t,e,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),q.each(function(a){var o=p.isHeader(a,z);a._hoverX=b(a.x1-z.marker.pad.r),a._hoverY=R?v(a.y1-z.marker.pad.b/2):v(a.y0+z.marker.pad.t/2);var s=r.select(this),y=i.ensureSingle(s,"path","surface",function(e){e.style("pointer-events","all")});A?y.transition().attrTween("d",function(e){var a=C(e,m,H(),[x,_]);return function(e){return w(a(e))}}):y.attr("d",w),s.call(u,h,e,t,{styleOne:d,eventDataKeys:c.eventDataKeys,transitionTime:c.CLICK_TRANSITION_TIME,transitionEasing:c.CLICK_TRANSITION_EASING}).call(p.setSliceCursor,e,{isTransitioning:e._transitioning}),y.call(d,a,z,{hovered:!1}),a._text=a.x0===a.x1||a.y0===a.y1?"":o?M?"":p.getPtLabel(a)||"":g(a,h,z,t,I)||"";var f=i.ensureSingle(s,"g","slicetext"),S=i.ensureSingle(f,"text","",function(e){e.attr("data-notex",1)}),E=i.ensureUniformFontSize(e,p.determineTextFont(z,a,I.font));S.text(a._text||" ").classed("slicetext",!0).attr("text-anchor",O?"end":D||o?"start":"middle").call(n.font,E).call(l.convertToTspans,e),a.textBB=n.bBox(S.node()),a.transform=k(a,{fontSize:E.size,isHeader:o}),a.transform.fontSize=E.size,A?S.transition().attrTween("transform",function(e){var a=L(e,m,H(),[x,_]);return function(e){return T(a(e))}}):S.attr("transform",T(a))}),V}},{"../../components/drawing":546,"../../lib":657,"../../lib/svg_text_utils":681,"../sunburst/fx":1178,"../sunburst/helpers":1179,"../sunburst/plot":1183,"./constants":1202,"./partition":1209,"./style":1211,d3:108}],1206:[function(e,t){'use strict';t.exports={moduleType:"trace",name:"treemap",basePlotModule:e("./base_plot"),categories:[],animatable:!0,attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults"),supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc").calc,crossTraceCalc:e("./calc").crossTraceCalc,plot:e("./plot"),style:e("./style").style,colorbar:e("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":1080,"./attributes":1199,"./base_plot":1200,"./calc":1201,"./defaults":1203,"./layout_attributes":1207,"./layout_defaults":1208,"./plot":1210,"./style":1211}],1207:[function(e,t){'use strict';t.exports={treemapcolorway:{valType:"colorlist",editType:"calc"},extendtreemapcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1208:[function(e,t){'use strict';var a=e("../../lib"),o=e("./layout_attributes");t.exports=function(e,t){function r(r,i){return a.coerce(e,t,o,r,i)}r("treemapcolorway",t.colorway),r("extendtreemapcolors")}},{"../../lib":657,"./layout_attributes":1207}],1209:[function(e,t){'use strict';function a(e,t){return"squarify"===e?r.treemapSquarify.ratio(t):"binary"===e?r.treemapBinary:"dice"===e?r.treemapDice:"slice"===e?r.treemapSlice:r.treemapSliceDice}function o(e,t,a){var r;a.swapXY&&(r=e.x0,e.x0=e.y0,e.y0=r,r=e.x1,e.x1=e.y1,e.y1=r),a.flipX&&(r=e.x0,e.x0=t[0]-e.x1,e.x1=t[0]-r),a.flipY&&(r=e.y0,e.y0=t[1]-e.y1,e.y1=t[1]-r);var n=e.children;if(n)for(var l=0;l<n.length;l++)o(n[l],t,a)}var r=e("d3-hierarchy");t.exports=function(e,t,i){var n=i.flipX,l=i.flipY,s="dice-slice"===i.packing,d=i.pad[l?"bottom":"top"],c=i.pad[n?"right":"left"],p=i.pad[n?"left":"right"],u=i.pad[l?"top":"bottom"],g;s&&(g=c,c=d,d=g,g=p,p=u,u=g);var m=r.treemap().tile(a(i.packing,i.squarifyratio)).paddingInner(i.pad.inner).paddingLeft(c).paddingRight(p).paddingTop(d).paddingBottom(u).size(s?[t[1],t[0]]:t)(e);return(s||n||l)&&o(m,t,{swapXY:s,flipX:n,flipY:l}),m}},{"d3-hierarchy":102}],1210:[function(e,t){'use strict';var r=Math.min,i=Math.max;function a(e){return l.isHierarchyRoot(e)?"":l.getPtId(e)}function o(e,t,o,c){function u(e,t){return e+","+t}var m=e._fullLayout,h=t[0],_=h.trace,b=h.hierarchy,v=l.findEntryWithLevel(b,_.level),w=n.select(o),k=w.selectAll("g.pathbar"),T=w.selectAll("g.slice");if(!v)return k.remove(),void T.remove();var A=l.isHierarchyRoot(v),S=!m.uniformtext.mode&&l.hasTransition(c),C=l.getMaxDepth(_),L=function(e){return e.data.depth-v.data.depth<C},E=m._size,I=_.domain,P=E.w*(I.x[1]-I.x[0]),z=E.h*(I.y[1]-I.y[0]),D=P,O=_.pathbar.thickness,R=_.marker.line.width+y.gapWithPathbar,M=_.pathbar.visible?-1<_.pathbar.side.indexOf("bottom")?z+R:-(O+R):0,j={x0:D,x1:D,y0:M,y1:M+O},B=function(t,a,o){var r=_.tiling.pad,e=function(e){return e-r<=a.x0},i=function(e){return e+r>=a.x1},n=function(e){return e-r<=a.y0},l=function(e){return e+r>=a.y1};return{x0:e(t.x0-r)?0:i(t.x0-r)?o[0]:t.x0,x1:e(t.x1+r)?0:i(t.x1+r)?o[0]:t.x1,y0:n(t.y0-r)?0:l(t.y0-r)?o[1]:t.y0,y1:n(t.y1+r)?0:l(t.y1+r)?o[1]:t.y1}},F=null,N={},V={},U=null,H=function(e,t){return t?N[a(e)]:V[a(e)]},q=function(e,t,o,r){if(t)return N[a(b)]||j;var i=V[_.level]||o;return L(e)?B(e,i,r):{}};h.hasMultipleRoots&&A&&C++,_._maxDepth=C,_._backgroundColor=m.paper_bgcolor,_._entryDepth=v.data.depth,_._atRootLevel=A;var G=-P/2+E.l+E.w*(I.x[1]+I.x[0])/2,Y=-z/2+E.t+E.h*(1-(I.y[1]+I.y[0])/2),W=function(e){return G+e},X=function(e){return Y+e},Z=X(0),K=W(0),$=function(e){return K+e},J=function(e){return Z+e},Q=$(0),ee=function(e){e.x=i(Q,e.x)},te=_.pathbar.edgeshape,ae=function(e,t){var a=e.x0,o=e.x1,r=e.y0,i=e.y1,n=e.textBB,l=function(e){return-1!==_.textposition.indexOf(e)},s=l("bottom"),c=l("top")||t.isHeader&&!s,u=c?"start":s?"end":"middle",h=l("right"),y=l("left")||t.onPathbar,f=y?-1:h?1:0,x=_.marker.pad;if(t.isHeader){if(a+=x.l-d,o-=x.r-d,a>=o){var b=(a+o)/2;a=b,o=b}var v;s?(v=i-x.b,r<v&&v<i&&(r=v)):(v=r+x.t,r<v&&v<i&&(i=v))}var w=p(a,o,r,i,n,{isHorizontal:!1,constrained:!0,angle:0,anchor:u,leftToRight:f});return(w.fontSize=t.fontSize,w.targetX=W(w.targetX),w.targetY=X(w.targetY),isNaN(w.targetX)||isNaN(w.targetY))?{}:(a!==o&&r!==i&&g(_.type,w,m),{scale:w.scale,rotate:w.rotate,textX:w.textX,textY:w.textY,anchorX:w.anchorX,anchorY:w.anchorY,targetX:w.targetX,targetY:w.targetY})},oe=function(e,t){for(var a=0,o=e,r;!r&&a<C;)a++,o=o.parent,o?r=H(o,t):a=C;return r||{}},re=function(e,t,a,o){var r=H(e,t),i;if(t)i=j;else{var l=H(v,t);i=l?B(e,l,o):{}}return n.interpolate(r,i)},ie=function(e,t,a,o){var r=H(e,t),i;if(r)i=r;else if(t)i=j;else if(!F)i={};else if(e.parent){var l=U||a;l&&!t?i=B(e,l,o):(i={},s.extendFlat(i,oe(e,t)))}else i=e;return n.interpolate(i,{x0:e.x0,x1:e.x1,y0:e.y0,y1:e.y1})},ne=function(e,t,a,o){var r=H(e,t),i={},d=q(e,t,a,o);s.extendFlat(i,{transform:ae({x0:d.x0,x1:d.x1,y0:d.y0,y1:d.y1,textBB:e.textBB,_text:e._text},{isHeader:l.isHeader(e,_)})}),r?i=r:e.parent&&s.extendFlat(i,oe(e,t));var c=e.transform;return e.x0!==e.x1&&e.y0!==e.y1&&g(_.type,c,m),n.interpolate(i,{transform:{scale:c.scale,rotate:c.rotate,textX:c.textX,textY:c.textY,anchorX:c.anchorX,anchorY:c.anchorY,targetX:c.targetX,targetY:c.targetY}})},le=function(e,t,a,o,r){var i=o[0],l=o[1];S?e.exit().transition().each(function(){var e=n.select(this),o=e.select("path.surface");o.transition().attrTween("d",function(e){var o=re(e,t,a,[i,l]);return function(e){return r(o(e))}});var s=e.select("g.slicetext");s.attr("opacity",0)}).remove():e.exit().remove()},se=function(e){var t=e.transform;return e.x0!==e.x1&&e.y0!==e.y1&&g(_.type,t,m),s.getTextTransform({textX:t.textX,textY:t.textY,anchorX:t.anchorX,anchorY:t.anchorY,targetX:t.targetX,targetY:t.targetY,scale:t.scale,rotate:t.rotate})};S&&(k.each(function(e){N[a(e)]={x0:e.x0,x1:e.x1,y0:e.y0,y1:e.y1},e.transform&&(N[a(e)].transform={textX:e.transform.textX,textY:e.transform.textY,anchorX:e.transform.anchorX,anchorY:e.transform.anchorY,targetX:e.transform.targetX,targetY:e.transform.targetY,scale:e.transform.scale,rotate:e.transform.rotate})}),T.each(function(e){V[a(e)]={x0:e.x0,x1:e.x1,y0:e.y0,y1:e.y1},e.transform&&(V[a(e)].transform={textX:e.transform.textX,textY:e.transform.textY,anchorX:e.transform.anchorX,anchorY:e.transform.anchorY,targetX:e.transform.targetX,targetY:e.transform.targetY,scale:e.transform.scale,rotate:e.transform.rotate}),!F&&l.isEntry(e)&&(F=e)})),U=f(e,t,v,T,{width:P,height:z,viewX:W,viewY:X,pathSlice:function(e){var t=W(e.x0),a=W(e.x1),o=X(e.y0),i=X(e.y1),n=a-t,l=i-o;if(!n||!l)return"";var s=n>0&&l>0?0:0,r=function(e,t){return s?"a"+u(s,s)+" 0 0 1 "+u(e,t):""};return"M"+u(t,o+s)+r(s,-s)+"L"+u(a-s,o)+r(s,s)+"L"+u(a,i-s)+r(-s,s)+"L"+u(t+s,i)+r(-s,-s)+"Z"},toMoveInsideSlice:ae,prevEntry:F,makeUpdateSliceInterpolator:ie,makeUpdateTextInterpolator:ne,handleSlicesExit:le,hasTransition:S,strTransform:se}),_.pathbar.visible?x(e,t,v,k,{barDifY:M,width:D,height:O,viewX:$,viewY:J,pathSlice:function(e){var t=$(i(r(e.x0,e.x0),0)),a=$(r(i(e.x1,e.x1),D)),o=J(e.y0),n=J(e.y1),l=O/2,s={},d={};s.x=t,d.x=a,s.y=d.y=(o+n)/2;var c={x:t,y:o},p={x:a,y:o},g={x:a,y:n},m={x:t,y:n};return">"===te?(c.x-=l,p.x-=l,g.x-=l,m.x-=l):"/"===te?(g.x-=l,m.x-=l,s.x-=l/2,d.x-=l/2):"\\"===te?(c.x-=l,p.x-=l,s.x-=l/2,d.x-=l/2):"<"===te&&(s.x-=l,d.x-=l),ee(c),ee(m),ee(s),ee(p),ee(g),ee(d),"M"+u(c.x,c.y)+"L"+u(p.x,p.y)+"L"+u(d.x,d.y)+"L"+u(g.x,g.y)+"L"+u(m.x,m.y)+"L"+u(s.x,s.y)+"Z"},toMoveInsideSlice:ae,makeUpdateSliceInterpolator:ie,makeUpdateTextInterpolator:ne,handleSlicesExit:le,hasTransition:S,strTransform:se}):k.remove()}var n=e("d3"),l=e("../sunburst/helpers"),s=e("../../lib"),d=e("../bar/constants").TEXTPAD,c=e("../bar/plot"),p=c.toMoveInsideBar,u=e("../bar/uniform_text"),g=u.recordMinTextSize,m=u.clearMinTextSize,h=e("../bar/style").resizeText,y=e("./constants"),f=e("./draw_descendants"),x=e("./draw_ancestors");t.exports=function(e,t,a,r){var i=e._fullLayout,s=i._treemaplayer,d,c;if(m("treemap",i),d=s.selectAll("g.trace.treemap").data(t,function(e){return e[0].trace.uid}),d.enter().append("g").classed("trace",!0).classed("treemap",!0),d.order(),!i.uniformtext.mode&&l.hasTransition(a)){r&&(c=r());var p=n.transition().duration(a.duration).ease(a.easing).each("end",function(){c&&c()}).each("interrupt",function(){c&&c()});p.each(function(){s.selectAll("g.trace").each(function(t){o(e,t,this,a)})})}else d.each(function(t){o(e,t,this,a)}),i.uniformtext.mode&&h(e,i._treemaplayer.selectAll(".trace"),"treemap");!a&&d.exit().remove()}},{"../../lib":657,"../bar/constants":800,"../bar/plot":809,"../bar/style":812,"../bar/uniform_text":814,"../sunburst/helpers":1179,"./constants":1202,"./draw_ancestors":1204,"./draw_descendants":1205,d3:108}],1211:[function(e,t){'use strict';function a(e,t,a,o){var s=(o||{}).hovered,c=t.data.data,p=c.i,u=c.color,g=d.isHierarchyRoot(t),m=1,h,y;if(s)h=a._hovered.marker.line.color,y=a._hovered.marker.line.width;else if(g&&"rgba(0,0,0,0)"===u)m=0,h="rgba(0,0,0,0)",y=0;else if(h=l.castOption(a,p,"marker.line.color")||r.defaultLine,y=l.castOption(a,p,"marker.line.width")||0,!a._hasColorscale&&!t.onPathbar){var f=a.marker.depthfade;if(f){var x=r.combine(r.addOpacity(a._backgroundColor,.75),u),_;if(!0===f){var b=d.getMaxDepth(a);_=isFinite(b)?d.isLeaf(t)?0:a._maxVisibleLayers-(t.data.depth-a._entryDepth):t.data.height+1}else _=t.data.depth-a._entryDepth,a._atRootLevel||_++;if(0<_)for(var v=0,w;v<_;v++)w=.5*v/_,u=r.combine(r.addOpacity(x,w),u)}}e.style("stroke-width",y).call(r.fill,u).call(r.stroke,h).style("opacity",m)}var o=e("d3"),r=e("../../components/color"),l=e("../../lib"),d=e("../sunburst/helpers"),c=e("../bar/uniform_text").resizeText;t.exports={style:function(e){var t=e._fullLayout._treemaplayer.selectAll(".trace");c(e,t,"treemap"),t.each(function(e){var t=o.select(this),r=e[0],i=r.trace;t.style("opacity",i.opacity),t.selectAll("path.surface").each(function(e){o.select(this).call(a,e,i,{hovered:!1})})})},styleOne:a}},{"../../components/color":524,"../../lib":657,"../bar/uniform_text":814,"../sunburst/helpers":1179,d3:108}],1212:[function(e,t){'use strict';var a=e("../box/attributes"),o=e("../../lib/extend").extendFlat;t.exports={y:a.y,x:a.x,x0:a.x0,y0:a.y0,name:o({},a.name,{}),orientation:o({},a.orientation,{}),bandwidth:{valType:"number",min:0,editType:"calc"},scalegroup:{valType:"string",dflt:"",editType:"calc"},scalemode:{valType:"enumerated",values:["width","count"],dflt:"width",editType:"calc"},spanmode:{valType:"enumerated",values:["soft","hard","manual"],dflt:"soft",editType:"calc"},span:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:a.fillcolor,points:o({},a.boxpoints,{}),jitter:o({},a.jitter,{}),pointpos:o({},a.pointpos,{}),width:o({},a.width,{}),marker:a.marker,text:a.text,hovertext:a.hovertext,hovertemplate:a.hovertemplate,box:{visible:{valType:"boolean",dflt:!1,editType:"plot"},width:{valType:"number",min:0,max:1,dflt:.25,editType:"plot"},fillcolor:{valType:"color",editType:"style"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"style"},editType:"plot"},meanline:{visible:{valType:"boolean",dflt:!1,editType:"plot"},color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"plot"},side:{valType:"enumerated",values:["both","positive","negative"],dflt:"both",editType:"calc"},offsetgroup:a.offsetgroup,alignmentgroup:a.alignmentgroup,selected:a.selected,unselected:a.unselected,hoveron:{valType:"flaglist",flags:["violins","points","kde"],dflt:"violins+points+kde",extras:["all"],editType:"style"}}},{"../../lib/extend":648,"../box/attributes":823}],1213:[function(e,t){'use strict';var i=Math.ceil,l=Math.min,s=Math.max;function a(e,t,o){var r=l(t,o/1.349);return 1.059*r*Math.pow(e,-.2)}function o(e,t,o){var r=t.max-t.min;if(!r)return e.bandwidth?e.bandwidth:0;if(e.bandwidth)return s(e.bandwidth,r/1e4);var i=o.length,n=d.stdev(o,i-1,t.mean);return s(a(i,n,t.q3-t.q1),r/100)}function r(e,t,a,o){function r(o){var r=n[o],i="multicategory"===a.type?a.r2c(r):a.d2c(r,0,e[t.valLetter+"calendar"]);return i===g?d[o]:i}var i=e.spanmode,n=e.span||[],l=[t.min,t.max],d=[t.min-2*o,t.max+2*o],p;p="soft"===i?d:"hard"===i?l:[r(0),r(1)];var u={type:"linear",range:p};return c.setConvert(u),u.cleanRange(),p}var d=e("../../lib"),c=e("../../plots/cartesian/axes"),p=e("../box/calc"),u=e("./helpers"),g=e("../../constants/numerical").BADNUM;t.exports=function(e,a){var g=p(e,a);if(g[0].t.empty)return g;for(var m=e._fullLayout,h=c.getFromId(e,a["h"===a.orientation?"xaxis":"yaxis"]),y=1/0,f=-Infinity,x=0,_=0,b=0;b<g.length;b++){var w=g[b],T=w.pts.map(u.extractVal),A=w.bandwidth=o(a,w,T),S=w.span=r(a,w,h,A);if(w.min===w.max&&0===A)S=w.span=[w.min,w.max],w.density=[{v:1,t:S[0]}],w.bandwidth=A,x=s(x,1);else{var C=S[1]-S[0],L=i(C/(A/3)),n=C/L;if(!isFinite(n)||!isFinite(L))return d.error("Something went wrong with computing the violin span"),g[0].t.empty=!0,g;var E=u.makeKDE(w,a,T);w.density=Array(L);for(var I=0,P=S[0],z;P<S[1]+n/2;I++,P+=n)z=E(P),w.density[I]={v:z,t:P},x=s(x,z)}_=s(_,T.length),y=l(y,S[0]),f=s(f,S[1])}var D=c.findExtremes(h,[y,f],{padded:!0});if(a._extremes[h._id]=D,a.width)g[0].t.maxKDE=x;else{var O=m._violinScaleGroupStats,R=a.scalegroup,M=O[R];M?(M.maxKDE=s(M.maxKDE,x),M.maxCount=s(M.maxCount,_)):O[R]={maxKDE:x,maxCount:_}}return g[0].t.labels.kde=d._(e,"kde:"),g}},{"../../constants/numerical":633,"../../lib":657,"../../plots/cartesian/axes":705,"../box/calc":824,"./helpers":1216}],1214:[function(e,t){'use strict';var a=e("../box/cross_trace_calc").setPositionOffset,o=["v","h"];t.exports=function(e,r){for(var n=e.calcdata,l=r.xaxis,s=r.yaxis,d=0;d<o.length;d++){for(var c=o[d],p="h"===c?s:l,u=[],g=0;g<n.length;g++){var m=n[g],h=m[0].t,t=m[0].trace;!0!==t.visible||"violin"!==t.type||h.empty||t.orientation!==c||t.xaxis!==l._id||t.yaxis!==s._id||u.push(g)}a("violin",e,u,p)}}},{"../box/cross_trace_calc":825}],1215:[function(e,t){'use strict';var a=e("../../lib"),o=e("../../components/color"),r=e("../box/defaults"),i=e("./attributes");t.exports=function(e,t,n,l){function s(o,r){return a.coerce(e,t,i,o,r)}function d(o,r){return a.coerce2(e,t,i,o,r)}if(r.handleSampleDefaults(e,t,s,l),!1!==t.visible){s("bandwidth"),s("side");var c=s("width");c||(s("scalegroup",t.name),s("scalemode"));var p=s("span"),u;Array.isArray(p)&&(u="manual"),s("spanmode",u);var g=s("line.color",(e.marker||{}).color||n),m=s("line.width"),h=s("fillcolor",o.addOpacity(t.line.color,.5));r.handlePointsDefaults(e,t,s,{prefix:""});var y=d("box.width"),f=d("box.fillcolor",h),x=d("box.line.color",g),_=d("box.line.width",m),b=s("box.visible",!!(y||f||x||_));b||(t.box={visible:!1});var v=d("meanline.color",g),w=d("meanline.width",m),k=s("meanline.visible",!!(v||w));k||(t.meanline={visible:!1})}}},{"../../components/color":524,"../../lib":657,"../box/defaults":826,"./attributes":1212}],1216:[function(e,t,a){'use strict';var o=e("../../lib"),r={gaussian:function(e){return 1/Math.sqrt(2*Math.PI)*Math.exp(-.5*e*e)}};a.makeKDE=function(e,t,a){var o=a.length,n=r.gaussian,l=e.bandwidth;return function(e){for(var t=0,r=0;r<o;r++)t+=n((e-a[r])/l);return 1/(o*l)*t}},a.getPositionOnKdePath=function(e,t,a){var r,i;"h"===t.orientation?(r="y",i="x"):(r="x",i="y");var n=o.findPointOnPath(e.path,a,i,{pathLength:e.pathLength}),l=e.posCenterPx,s=n[r],d="both"===t.side?2*l-s:l;return[s,d]},a.getKdeValue=function(e,t,o){var r=e.pts.map(a.extractVal),i=a.makeKDE(e,t,r);return i(o)/e.posDensityScale},a.extractVal=function(e){return e.v}},{"../../lib":657}],1217:[function(e,t){'use strict';var a=e("../../lib"),o=e("../../plots/cartesian/axes"),r=e("../box/hover"),i=e("./helpers");t.exports=function(e,t,n,l,s){var d=e.cd,c=d[0].trace,p=c.hoveron,u=-1!==p.indexOf("violins"),g=-1!==p.indexOf("kde"),m=[],h,y;if(u||g){var f=r.hoverOnBoxes(e,t,n,l);if(g&&0<f.length){var x=e.xa,_=e.ya,b,v,w,k,T;"h"===c.orientation?(T=t,b="y",w=_,v="x",k=x):(T=n,b="x",w=x,v="y",k=_);var A=d[e.index];if(T>=A.span[0]&&T<=A.span[1]){var S=a.extendFlat({},e),C=k.c2p(T,!0),L=i.getKdeValue(A,c,T),E=i.getPositionOnKdePath(A,c,C),I=w._offset,P=w._length;S[b+"0"]=E[0],S[b+"1"]=E[1],S[v+"0"]=S[v+"1"]=C,S[v+"Label"]=v+": "+o.hoverLabelText(k,T)+", "+d[0].t.labels.kde+" "+L.toFixed(3),S.spikeDistance=f[0].spikeDistance;var z=b+"Spike";S[z]=f[0][z],f[0].spikeDistance=void 0,f[0][z]=void 0,S.hovertemplate=!1,m.push(S),y={stroke:e.color},y[b+"1"]=a.constrain(I+E[0],I,I+P),y[b+"2"]=a.constrain(I+E[1],I,I+P),y[v+"1"]=y[v+"2"]=k._offset+C}}u&&(m=m.concat(f))}-1!==p.indexOf("points")&&(h=r.hoverOnPoints(e,t,n));var D=s.selectAll(".violinline-"+c.uid).data(y?[0]:[]);return D.enter().append("line").classed("violinline-"+c.uid,!0).attr("stroke-width",1.5),D.exit().remove(),D.attr(y),"closest"===l?h?[h]:m:h?(m.push(h),m):m}},{"../../lib":657,"../../plots/cartesian/axes":705,"../box/hover":828,"./helpers":1216}],1218:[function(e,t){'use strict';t.exports={attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults"),crossTraceDefaults:e("../box/defaults").crossTraceDefaults,supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc"),crossTraceCalc:e("./cross_trace_calc"),plot:e("./plot"),style:e("./style"),styleOnSelect:e("../scatter/style").styleOnSelect,hoverPoints:e("./hover"),selectPoints:e("../box/select"),moduleType:"trace",name:"violin",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","violinLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":718,"../box/defaults":826,"../box/select":833,"../scatter/style":1085,"./attributes":1212,"./calc":1213,"./cross_trace_calc":1214,"./defaults":1215,"./hover":1217,"./layout_attributes":1219,"./layout_defaults":1220,"./plot":1221,"./style":1222}],1219:[function(e,t){'use strict';var a=e("../box/layout_attributes"),o=e("../../lib").extendFlat;t.exports={violinmode:o({},a.boxmode,{}),violingap:o({},a.boxgap,{}),violingroupgap:o({},a.boxgroupgap,{})}},{"../../lib":657,"../box/layout_attributes":830}],1220:[function(e,t){'use strict';var a=e("../../lib"),o=e("./layout_attributes"),r=e("../box/layout_defaults");t.exports=function(e,t,i){r._supply(e,t,i,function(r,i){return a.coerce(e,t,o,r,i)},"violin")}},{"../../lib":657,"../box/layout_defaults":831,"./layout_attributes":1219}],1221:[function(e,t){'use strict';var a=e("d3"),o=e("../../lib"),r=e("../../components/drawing"),i=e("../box/plot"),n=e("../scatter/line_points"),l=e("./helpers");t.exports=function(e,s,d,c){function p(e){var t=n(e,{xaxis:g,yaxis:m,connectGaps:!0,baseTolerance:.75,shape:"spline",simplify:!0,linearized:!0});return r.smoothopen(t[0],1)}var u=e._fullLayout,g=s.xaxis,m=s.yaxis;o.makeTraceGroups(c,d,"trace violins").each(function(e){var r=a.select(this),n=e[0],c=n.t,t=n.trace;if(!0!==t.visible||c.empty)return void r.remove();var h=c.bPos,y=c.bdPos,f=s[c.valLetter+"axis"],x=s[c.posLetter+"axis"],_="both"===t.side,b=_||"positive"===t.side,v=_||"negative"===t.side,w=r.selectAll("path.violin").data(o.identity);w.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","violin"),w.exit().remove(),w.each(function(e){var o=a.select(this),r=e.density,n=r.length,l=x.c2l(e.pos+h,!0),s=x.l2p(l),d;if(t.width)d=c.maxKDE/y;else{var g=u._violinScaleGroupStats[t.scalegroup];d="count"===t.scalemode?g.maxKDE/y*(g.maxCount/e.pts.length):g.maxKDE/y}var m,w,T,A,S,C,L;if(b){for(C=Array(n),A=0;A<n;A++)L=C[A]={},L[c.posLetter]=l+r[A].v/d,L[c.valLetter]=f.c2l(r[A].t,!0);m=p(C)}if(v){for(C=Array(n),S=0,A=n-1;S<n;S++,A--)L=C[S]={},L[c.posLetter]=l-r[A].v/d,L[c.valLetter]=f.c2l(r[A].t,!0);w=p(C)}if(_)T=m+"L"+w.substr(1)+"Z";else{var E=[s,f.c2p(r[0].t)],I=[s,f.c2p(r[n-1].t)];"h"===t.orientation&&(E.reverse(),I.reverse()),T=b?"M"+E+"L"+m.substr(1)+"L"+I:"M"+I+"L"+w.substr(1)+"L"+E}o.attr("d",T),e.posCenterPx=s,e.posDensityScale=d*y,e.path=o.node(),e.pathLength=e.path.getTotalLength()/(_?2:1)});var k=t.box,T=k.width,A=(k.line||{}).width,S,C;_?(S=y*T,C=0):b?(S=[0,y*T/2],C=A*{x:1,y:-1}[c.posLetter]):(S=[y*T/2,0],C=A*{x:-1,y:1}[c.posLetter]),i.plotBoxAndWhiskers(r,{pos:x,val:f},t,{bPos:h,bdPos:S,bPosPxOffset:C}),i.plotBoxMean(r,{pos:x,val:f},t,{bPos:h,bdPos:S,bPosPxOffset:C});var L;!t.box.visible&&t.meanline.visible&&(L=o.identity);var d=r.selectAll("path.meanline").data(L||[]);d.enter().append("path").attr("class","meanline").style("fill","none").style("vector-effect","non-scaling-stroke"),d.exit().remove(),d.each(function(e){var o=f.c2p(e.mean,!0),r=l.getPositionOnKdePath(e,t,o);a.select(this).attr("d","h"===t.orientation?"M"+o+","+r[0]+"V"+r[1]:"M"+r[0]+","+o+"H"+r[1])}),i.plotPoints(r,{x:g,y:m},t,c)})}},{"../../components/drawing":546,"../../lib":657,"../box/plot":832,"../scatter/line_points":1076,"./helpers":1216,d3:108}],1222:[function(e,t){'use strict';var a=e("d3"),o=e("../../components/color"),r=e("../scatter/style").stylePoints;t.exports=function(e){var t=a.select(e).selectAll("g.trace.violins");t.style("opacity",function(e){return e[0].trace.opacity}),t.each(function(t){var i=t[0].trace,n=a.select(this),l=i.box||{},s=l.line||{},d=i.meanline||{},c=d.width;n.selectAll("path.violin").style("stroke-width",i.line.width+"px").call(o.stroke,i.line.color).call(o.fill,i.fillcolor),n.selectAll("path.box").style("stroke-width",s.width+"px").call(o.stroke,s.color).call(o.fill,l.fillcolor);var p={"stroke-width":c+"px","stroke-dasharray":2*c+"px,"+c+"px"};n.selectAll("path.mean").style(p).call(o.stroke,d.color),n.selectAll("path.meanline").style(p).call(o.stroke,d.color),r(n,i,e)})}},{"../../components/color":524,"../scatter/style":1085,d3:108}],1223:[function(e,t){'use strict';var a=e("../../components/colorscale/attributes"),o=e("../isosurface/attributes"),r=e("../surface/attributes"),i=e("../../plots/attributes"),n=e("../../lib/extend").extendFlat,l=e("../../plot_api/edit_types").overrideAll,s=t.exports=l(n({x:o.x,y:o.y,z:o.z,value:o.value,isomin:o.isomin,isomax:o.isomax,surface:o.surface,spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:1}},slices:o.slices,caps:o.caps,text:o.text,hovertext:o.hovertext,hovertemplate:o.hovertemplate},a("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{colorbar:o.colorbar,opacity:o.opacity,opacityscale:r.opacityscale,lightposition:o.lightposition,lighting:o.lighting,flatshading:o.flatshading,contour:o.contour,hoverinfo:n({},i.hoverinfo),showlegend:n({},i.showlegend,{dflt:!1})}),"calc","nested");s.x.editType=s.y.editType=s.z.editType=s.value.editType="calc+clearAxisTypes",s.transforms=void 0},{"../../components/colorscale/attributes":531,"../../lib/extend":648,"../../plot_api/edit_types":688,"../../plots/attributes":702,"../isosurface/attributes":998,"../surface/attributes":1185}],1224:[function(e,t){'use strict';function a(e,t,a){this.scene=e,this.uid=a,this.mesh=t,this.name="",this.data=null,this.showContour=!1}var o=e("gl-mesh3d"),r=e("../../lib/gl_format_color").parseColorScale,i=e("../../lib/str2rgbarray"),n=e("../../components/colorscale").extractOpts,l=e("../../plots/gl3d/zip3"),s=e("../isosurface/convert").findNearestOnAxis,d=e("../isosurface/convert").generateIsoMeshes,c=a.prototype;c.handlePick=function(e){if(e.object===this.mesh){var t=e.data.index,a=this.data._meshX[t],o=this.data._meshY[t],r=this.data._meshZ[t],n=this.data._Ys.length,l=this.data._Zs.length,d=s(a,this.data._Xs).id,i=s(o,this.data._Ys).id,c=s(r,this.data._Zs).id,p=e.index=c+l*i+l*n*d;e.traceCoordinate=[this.data._meshX[p],this.data._meshY[p],this.data._meshZ[p],this.data._value[p]];var u=this.data.hovertext||this.data.text;return Array.isArray(u)&&void 0!==u[p]?e.textLabel=u[p]:u&&(e.textLabel=u),!0}},c.update=function(e){function t(e,t,a,o){return t.map(function(t){return e.d2l(t,0,o)*a})}var a=this.scene,o=a.fullSceneLayout;this.data=d(e);var s=l(t(o.xaxis,e._meshX,a.dataScale[0],e.xcalendar),t(o.yaxis,e._meshY,a.dataScale[1],e.ycalendar),t(o.zaxis,e._meshZ,a.dataScale[2],e.zcalendar)),c=l(e._meshI,e._meshJ,e._meshK),p={positions:s,cells:c,lightPosition:[e.lightposition.x,e.lightposition.y,e.lightposition.z],ambient:e.lighting.ambient,diffuse:e.lighting.diffuse,specular:e.lighting.specular,roughness:e.lighting.roughness,fresnel:e.lighting.fresnel,vertexNormalsEpsilon:e.lighting.vertexnormalsepsilon,faceNormalsEpsilon:e.lighting.facenormalsepsilon,opacity:e.opacity,opacityscale:e.opacityscale,contourEnable:e.contour.show,contourColor:i(e.contour.color).slice(0,3),contourWidth:e.contour.width,useFacetNormals:e.flatshading},u=n(e);p.vertexIntensity=e._meshIntensity,p.vertexIntensityBounds=[u.min,u.max],p.colormap=r(e),this.mesh.update(p)},c.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},t.exports=function(e,t){var r=e.glplot.gl,i=o({gl:r}),n=new a(e,i,t.uid);return i._trace=n,n.update(t),e.glplot.add(i),n}},{"../../components/colorscale":536,"../../lib/gl_format_color":654,"../../lib/str2rgbarray":680,"../../plots/gl3d/zip3":758,"../isosurface/convert":1e3,"gl-mesh3d":257}],1225:[function(e,t){'use strict';var a=e("../../lib"),o=e("./attributes"),r=e("../isosurface/defaults").supplyIsoDefaults,i=e("../surface/defaults").opacityscaleDefaults;t.exports=function(e,t,n,l){function s(r,i){return a.coerce(e,t,o,r,i)}r(e,t,n,l,s),i(e,t,l,s)}},{"../../lib":657,"../isosurface/defaults":1001,"../surface/defaults":1188,"./attributes":1223}],1226:[function(e,t){'use strict';t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("../isosurface/calc"),colorbar:{min:"cmin",max:"cmax"},plot:e("./convert"),moduleType:"trace",name:"volume",basePlotModule:e("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":747,"../isosurface/calc":999,"./attributes":1223,"./convert":1224,"./defaults":1225}],1227:[function(e,t){'use strict';function a(){return{marker:{color:d({},o.marker.color,{arrayOk:!1,editType:"style"}),line:{color:d({},o.marker.line.color,{arrayOk:!1,editType:"style"}),width:d({},o.marker.line.width,{arrayOk:!1,editType:"style"}),editType:"style"},editType:"style"},editType:"style"}}var o=e("../bar/attributes"),r=e("../scatter/attributes").line,i=e("../../plots/attributes"),n=e("../../plots/template_attributes").hovertemplateAttrs,l=e("../../plots/template_attributes").texttemplateAttrs,s=e("./constants"),d=e("../../lib/extend").extendFlat,c=e("../../components/color");t.exports={measure:{valType:"data_array",dflt:[],editType:"calc"},base:{valType:"number",dflt:null,arrayOk:!1,editType:"calc"},x:o.x,x0:o.x0,dx:o.dx,y:o.y,y0:o.y0,dy:o.dy,hovertext:o.hovertext,hovertemplate:n({},{keys:s.eventDataKeys}),hoverinfo:d({},i.hoverinfo,{flags:["name","x","y","text","initial","delta","final"]}),textinfo:{valType:"flaglist",flags:["label","text","initial","delta","final"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:l({editType:"plot"},{keys:s.eventDataKeys.concat(["label"])}),text:o.text,textposition:o.textposition,insidetextanchor:o.insidetextanchor,textangle:o.textangle,textfont:o.textfont,insidetextfont:o.insidetextfont,outsidetextfont:o.outsidetextfont,constraintext:o.constraintext,cliponaxis:o.cliponaxis,orientation:o.orientation,offset:o.offset,width:o.width,increasing:a("increasing"),decreasing:a("decreasing"),totals:a("intermediate sums and total"),connector:{line:{color:d({},r.color,{dflt:c.defaultLine}),width:d({},r.width,{editType:"plot"}),dash:r.dash,editType:"plot"},mode:{valType:"enumerated",values:["spanning","between"],dflt:"between",editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:o.offsetgroup,alignmentgroup:o.alignmentgroup}},{"../../components/color":524,"../../lib/extend":648,"../../plots/attributes":702,"../../plots/template_attributes":783,"../bar/attributes":798,"../scatter/attributes":1062,"./constants":1229}],1228:[function(e,t){'use strict';var r=Math.min;function a(e){return"a"===e||"absolute"===e}function o(e){return"t"===e||"total"===e}var n=e("../../plots/cartesian/axes"),l=e("../../lib").mergeArray,s=e("../scatter/calc_selection"),d=e("../../constants/numerical").BADNUM;t.exports=function(e,t){var c=n.getFromId(e,t.xaxis||"x"),p=n.getFromId(e,t.yaxis||"y"),u,g;"h"===t.orientation?(u=c.makeCalcdata(t,"x"),g=p.makeCalcdata(t,"y")):(u=p.makeCalcdata(t,"y"),g=c.makeCalcdata(t,"x"));for(var m=r(g.length,u.length),h=Array(m),y=0,f=!1,x=0,_;x<m;x++){var b=u[x]||0,v=!1;(u[x]!==d||o(t.measure[x])||a(t.measure[x]))&&x+1<m&&(u[x+1]!==d||o(t.measure[x+1])||a(t.measure[x+1]))&&(v=!0);var w=h[x]={i:x,p:g[x],s:b,rawS:b,cNext:v};a(t.measure[x])?(y=w.s,w.isSum=!0,w.dir="totals",w.s=y):o(t.measure[x])?(w.isSum=!0,w.dir="totals",w.s=y):(w.isSum=!1,w.dir=0>w.rawS?"decreasing":"increasing",_=w.s,w.s=y+_,y+=_),"totals"===w.dir&&(f=!0),t.ids&&(w.id=t.ids[x]+""),w.v=(t.base||0)+y}return h.length&&(h[0].hasTotals=f),l(t.text,h,"tx"),l(t.hovertext,h,"htx"),s(h,t),h}},{"../../constants/numerical":633,"../../lib":657,"../../plots/cartesian/axes":705,"../scatter/calc_selection":1064}],1229:[function(e,t){'use strict';t.exports={eventDataKeys:["initial","delta","final"]}},{}],1230:[function(e,t){'use strict';var a=e("../bar/cross_trace_calc").setGroupPositions;t.exports=function(e,t){var o=e._fullLayout,r=e._fullData,n=e.calcdata,l=t.xaxis,s=t.yaxis,d=[],c=[],p=[],u,g;for(g=0;g<r.length;g++){var m=r[g];!0===m.visible&&m.xaxis===l._id&&m.yaxis===s._id&&"waterfall"===m.type&&(u=n[g],"h"===m.orientation?p.push(u):c.push(u),d.push(u))}var h={mode:o.waterfallmode,norm:o.waterfallnorm,gap:o.waterfallgap,groupgap:o.waterfallgroupgap};for(a(e,l,s,c,h),a(e,s,l,p,h),g=0;g<d.length;g++){u=d[g];for(var y=0,f;y<u.length;y++)f=u[y],!1===f.isSum&&(f.s0+=0===y?0:u[y-1].s),y+1<u.length&&(u[y].nextP0=u[y+1].p0,u[y].nextS0=u[y+1].s0)}}},{"../bar/cross_trace_calc":801}],1231:[function(e,t){'use strict';function a(e,t,a){e(t+".marker.color",a),e(t+".marker.line.color",s.defaultLine),e(t+".marker.line.width")}var o=e("../../lib"),r=e("../bar/defaults").handleGroupingDefaults,i=e("../bar/defaults").handleText,n=e("../scatter/xy_defaults"),l=e("./attributes"),s=e("../../components/color"),d=e("../../constants/delta.js"),c=d.INCREASING.COLOR,p=d.DECREASING.COLOR;t.exports={supplyDefaults:function(e,t,r,s){function d(a,r){return o.coerce(e,t,l,a,r)}var u=n(e,t,s,d);if(!u)return void(t.visible=!1);d("measure"),d("orientation",t.x&&!t.y?"h":"v"),d("base"),d("offset"),d("width"),d("text"),d("hovertext"),d("hovertemplate");var g=d("textposition");i(e,t,s,d,g,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),"none"!==t.textposition&&(d("texttemplate"),!t.texttemplate&&d("textinfo")),a(d,"increasing",c),a(d,"decreasing",p),a(d,"totals","#4499FF");var m=d("connector.visible");if(m){d("connector.mode");var h=d("connector.line.width");h&&(d("connector.line.color"),d("connector.line.dash"))}},crossTraceDefaults:function(e,t){function a(e){return o.coerce(s._input,s,l,e)}var n,s;if("group"===t.waterfallmode)for(var d=0;d<e.length;d++)s=e[d],n=s._input,r(n,s,t,a)}}},{"../../components/color":524,"../../constants/delta.js":627,"../../lib":657,"../bar/defaults":802,"../scatter/xy_defaults":1088,"./attributes":1227}],1232:[function(e,t){'use strict';t.exports=function(e,t){return e.x="xVal"in t?t.xVal:t.x,e.y="yVal"in t?t.yVal:t.y,"initial"in t&&(e.initial=t.initial),"delta"in t&&(e.delta=t.delta),"final"in t&&(e.final=t.final),t.xa&&(e.xaxis=t.xa),t.ya&&(e.yaxis=t.ya),e}},{}],1233:[function(e,t){'use strict';var o=Math.abs;function a(e,t){var a=e[t.dir].marker,o=a.color,r=a.line.color,n=a.line.width;if(i(o))return o;return i(r)&&n?r:void 0}var r=e("../../plots/cartesian/axes").hoverLabelText,i=e("../../components/color").opacity,n=e("../bar/hover").hoverOnBars,l=e("../../constants/delta.js"),s={increasing:l.INCREASING.SYMBOL,decreasing:l.DECREASING.SYMBOL};t.exports=function(e,t,i,l){function d(e){return r(m,e)}var c=n(e,t,i,l);if(c){var p=c.cd,u=p[0].trace,g="h"===u.orientation,m=g?e.xa:e.ya,h=c.index,y=p[h],f=y.isSum?y.b+y.s:y.rawS;if(!y.isSum){c.initial=y.b+y.s-f,c.delta=f,c.final=c.initial+c.delta;var x=d(o(c.delta));c.deltaLabel=0>f?"("+x+")":x,c.finalLabel=d(c.final),c.initialLabel=d(c.initial)}var _=y.hi||u.hoverinfo,b=[];if(_&&"none"!==_&&"skip"!==_){var v=_.split("+"),w=function(e){return"all"===_||-1!==v.indexOf(e)};y.isSum||(w("final")&&(g?!w("x"):!w("y"))&&b.push(c.finalLabel),w("delta")&&(0>f?b.push(c.deltaLabel+" "+s.decreasing):b.push(c.deltaLabel+" "+s.increasing)),w("initial")&&b.push("Initial: "+c.initialLabel))}return b.length&&(c.extraText=b.join("<br>")),c.color=a(u,y),[c]}}},{"../../components/color":524,"../../constants/delta.js":627,"../../plots/cartesian/axes":705,"../bar/hover":805}],1234:[function(e,t){'use strict';t.exports={attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults").supplyDefaults,crossTraceDefaults:e("./defaults").crossTraceDefaults,supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc"),crossTraceCalc:e("./cross_trace_calc"),plot:e("./plot"),style:e("./style").style,hoverPoints:e("./hover"),eventData:e("./event_data"),selectPoints:e("../bar/select"),moduleType:"trace",name:"waterfall",basePlotModule:e("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":718,"../bar/select":810,"./attributes":1227,"./calc":1228,"./cross_trace_calc":1230,"./defaults":1231,"./event_data":1232,"./hover":1233,"./layout_attributes":1235,"./layout_defaults":1236,"./plot":1237,"./style":1238}],1235:[function(e,t){'use strict';t.exports={waterfallmode:{valType:"enumerated",values:["group","overlay"],dflt:"group",editType:"calc"},waterfallgap:{valType:"number",min:0,max:1,editType:"calc"},waterfallgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1236:[function(e,t){'use strict';var a=e("../../lib"),o=e("./layout_attributes");t.exports=function(e,t,r){function n(r,i){return a.coerce(e,t,o,r,i)}for(var l=!1,s=0,d;s<r.length;s++)if(d=r[s],d.visible&&"waterfall"===d.type){l=!0;break}l&&(n("waterfallmode"),n("waterfallgap",.2),n("waterfallgroupgap"))}},{"../../lib":657,"./layout_attributes":1235}],1237:[function(e,t){'use strict';function a(e,t,a,i){var d=t.xaxis,c=t.yaxis;n.makeTraceGroups(i,a,"trace bars").each(function(a){var i=r.select(this),p=a[0].trace,u=n.ensureSingle(i,"g","lines");if(!p.connector||!p.connector.visible)return void u.remove();var g="h"===p.orientation,m=p.connector.mode,h=u.selectAll("g.line").data(n.identity);h.enter().append("g").classed("line",!0),h.exit().remove();var f=h.size();h.each(function(a,p){if(p===f-1||a.cNext){var i=o(a,d,c,g),u=i[0],h=i[1],y="";u[0]!==s&&h[0]!==s&&u[1]!==s&&h[1]!==s&&("spanning"===m&&!a.isSum&&0<p&&(g?y+="M"+u[0]+","+h[1]+"V"+h[0]:y+="M"+u[1]+","+h[0]+"H"+u[0]),"between"!==m&&(a.isSum||p<f-1)&&(g?y+="M"+u[1]+","+h[0]+"V"+h[1]:y+="M"+u[0]+","+h[1]+"H"+u[1]),u[2]!==s&&h[2]!==s&&(g?y+="M"+u[1]+","+h[1]+"V"+h[2]:y+="M"+u[1]+","+h[1]+"H"+u[2])),""===y&&(y="M0,0Z"),n.ensureSingle(r.select(this),"path").attr("d",y).call(l.setClipUrl,t.layerClipId,e)}})})}function o(e,t,a,o){var r=[],i=[],n=o?t:a,l=o?a:t;return r[0]=n.c2p(e.s0,!0),i[0]=l.c2p(e.p0,!0),r[1]=n.c2p(e.s1,!0),i[1]=l.c2p(e.p1,!0),r[2]=n.c2p(e.nextS0,!0),i[2]=l.c2p(e.nextP0,!0),o?[r,i]:[i,r]}var r=e("d3"),n=e("../../lib"),l=e("../../components/drawing"),s=e("../../constants/numerical").BADNUM,d=e("../bar/plot"),c=e("../bar/uniform_text").clearMinTextSize;t.exports=function(e,t,o,r){var i=e._fullLayout;c("waterfall",i),d.plot(e,t,o,r,{mode:i.waterfallmode,norm:i.waterfallmode,gap:i.waterfallgap,groupgap:i.waterfallgroupgap}),a(e,t,o,r)}},{"../../components/drawing":546,"../../constants/numerical":633,"../../lib":657,"../bar/plot":809,"../bar/uniform_text":814,d3:108}],1238:[function(e,t){'use strict';var a=e("d3"),o=e("../../components/drawing"),r=e("../../components/color"),i=e("../../constants/interactions").DESELECTDIM,n=e("../bar/style"),l=e("../bar/uniform_text").resizeText,s=n.styleTextPoints;t.exports={style:function(e,t,n){var d=n?n:a.select(e).selectAll("g.waterfalllayer").selectAll("g.trace");l(e,d,"waterfall"),d.style("opacity",function(e){return e[0].trace.opacity}),d.each(function(t){var n=a.select(this),l=t[0].trace;n.selectAll(".point > path").each(function(e){if(!e.isBlank){var t=l[e.dir].marker;a.select(this).call(r.fill,t.color).call(r.stroke,t.line.color).call(o.dashLine,t.line.dash,t.line.width).style("opacity",l.selectedpoints&&!e.selected?i:1)}}),s(n,l,e),n.selectAll(".lines").each(function(){var e=l.connector.line;o.lineGroupStyle(a.select(this).selectAll("path"),e.width,e.color,e.dash)})})}}},{"../../components/color":524,"../../components/drawing":546,"../../constants/interactions":632,"../bar/style":812,"../bar/uniform_text":814,d3:108}],1239:[function(e,t,a){'use strict';var s=Math.ceil,d=Math.sqrt,c=Math.min,p=Math.max,u=Math.floor;function o(e,t,a,o){if(o.enabled){for(var n=o.target,l=m.nestedProperty(t,n),s=l.get(),d=g.getDataConversions(e,t,n,s),c=r(o,d),p=Array(a.length),u=0;u<a.length;u++)p[u]=c(s,a[u]);l.set(p),"count"===o.func&&m.pushUnique(t._arrayAttrs,n)}}function r(e,t){var a=e.func,o=t.d2c,r=t.c2d;return"count"===a?i:"first"===a?n:"last"===a?l:"sum"===a?function(e,t){for(var a=0,n=0,l;n<t.length;n++)l=o(e[t[n]]),l!==f&&(a+=l);return r(a)}:"avg"===a?function(e,t){for(var a=0,n=0,l=0,s;l<t.length;l++)s=o(e[t[l]]),s!==f&&(a+=s,n++);return n?r(a/n):f}:"min"===a?function(e,t){for(var a=1/0,n=0,l;n<t.length;n++)l=o(e[t[n]]),l!==f&&(a=c(a,l));return a===1/0?f:r(a)}:"max"===a?function(e,t){for(var a=-Infinity,n=0,l;n<t.length;n++)l=o(e[t[n]]),l!==f&&(a=p(a,l));return a===-Infinity?f:r(a)}:"range"===a?function(e,t){for(var a=1/0,n=-Infinity,l=0,s;l<t.length;l++)s=o(e[t[l]]),s!==f&&(a=c(a,s),n=p(n,s));return n===-Infinity||a===1/0?f:r(n-a)}:"change"===a?function(e,t){var a=o(e[t[0]]),i=o(e[t[t.length-1]]);return a===f||i===f?f:r(i-a)}:"median"===a?function(e,t){for(var a=[],n=0,l;n<t.length;n++)l=o(e[t[n]]),l!==f&&a.push(l);if(!a.length)return f;a.sort();var d=(a.length-1)/2;return r((a[u(d)]+a[s(d)])/2)}:"mode"===a?function(e,t){for(var a={},n=0,l=f,s=0,d;s<t.length;s++)if(d=o(e[t[s]]),d!==f){var c=a[d]=(a[d]||0)+1;c>n&&(n=c,l=d)}return n?r(l):f}:"rms"===a?function(e,t){for(var a=0,n=0,l=0,s;l<t.length;l++)s=o(e[t[l]]),s!==f&&(a+=s*s,n++);return n?r(d(a/n)):f}:"stddev"===a?function(t,a){var r=0,n=0,l=1,s=f,c;for(c=0;c<a.length&&s===f;c++)s=o(t[a[c]]);if(s===f)return f;for(;c<a.length;c++){var p=o(t[a[c]]);if(p!==f){var u=p-s;r+=u,n+=u*u,l++}}var g="sample"===e.funcmode?l-1:l;return g?d((n-r*r/l)/g):0}:void 0}function i(e,t){return t.length}function n(e,t){return e[t[0]]}function l(e,t){return e[t[t.length-1]]}var g=e("../plots/cartesian/axes"),m=e("../lib"),h=e("../plot_api/plot_schema"),y=e("./helpers").pointsAccessorFunction,f=e("../constants/numerical").BADNUM;a.moduleType="transform",a.name="aggregate";var x=a.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},aggregations:{_isLinkedToArray:"aggregation",target:{valType:"string",editType:"calc"},func:{valType:"enumerated",values:["count","sum","avg","median","mode","rms","stddev","min","max","first","last","change","range"],dflt:"first",editType:"calc"},funcmode:{valType:"enumerated",values:["sample","population"],dflt:"sample",editType:"calc"},enabled:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},editType:"calc"},_=x.aggregations;a.supplyDefaults=function(e,t){function a(t,a){return m.coerce(e,r,x,t,a)}function o(e,t){return m.coerce(p[l],g,_,e,t)}var r={},n=a("enabled"),l;if(!n)return r;var s=h.findArrayAttributes(t),d={};for(l=0;l<s.length;l++)d[s[l]]=1;var c=a("groups");if(!Array.isArray(c)){if(!d[c])return r.enabled=!1,r;d[c]=0}var p=e.aggregations||[],u=r.aggregations=Array(p.length),g;for(l=0;l<p.length;l++){g={_index:l};var y=o("target"),f=o("func"),b=o("enabled");b&&y&&(d[y]||"count"===f&&d[y]===void 0)?("stddev"===f&&o("funcmode"),d[y]=0,u[l]=g):u[l]={enabled:!1,_index:l}}for(l=0;l<s.length;l++)d[s[l]]&&u.push({target:s[l],func:_.func.dflt,enabled:!0,_index:-1});return r},a.calcTransform=function(e,t,a){if(a.enabled){var r=a.groups,n=m.getTargetArray(t,{target:r});if(n){var l={},s={},d=[],p=y(t.transforms,a),u=n.length,g,h,f,x;for(t._length&&(u=c(u,t._length)),g=0;g<u;g++)h=n[g],f=l[h],void 0===f?(l[h]=d.length,x=[g],d.push(x),s[l[h]]=p(g)):(d[f].push(g),s[l[h]]=(s[l[h]]||[]).concat(p(g)));a._indexToPoints=s;var _=a.aggregations;for(g=0;g<_.length;g++)o(e,t,d,_[g]);"string"==typeof r&&o(e,t,d,{target:r,func:"first",enabled:!0}),t._length=d.length}}}},{"../constants/numerical":633,"../lib":657,"../plot_api/plot_schema":694,"../plots/cartesian/axes":705,"./helpers":1242}],1240:[function(e,t,a){'use strict';var r=Math.min;function o(e,t,a){function o(e){return-1!==e.indexOf(r)}var r=e.operation,i=e.value,n=Array.isArray(i),l=function(a){return t(a,0,e.valuecalendar)},s=function(e){return t(e,0,a)},d;return o(p)?d=n?l(i[0]):l(i):o(u)?d=n?[l(i[0]),l(i[1])]:[l(i),l(i)]:o(g)&&(d=n?i.map(l):[l(i)]),"="===r?function(e){return s(e)===d}:"!="===r?function(e){return s(e)!==d}:"<"===r?function(e){return s(e)<d}:"<="===r?function(e){return s(e)<=d}:">"===r?function(e){return s(e)>d}:">="===r?function(e){return s(e)>=d}:"[]"===r?function(e){var t=s(e);return t>=d[0]&&t<=d[1]}:"()"===r?function(e){var t=s(e);return t>d[0]&&t<d[1]}:"[)"===r?function(e){var t=s(e);return t>=d[0]&&t<d[1]}:"(]"===r?function(e){var t=s(e);return t>d[0]&&t<=d[1]}:"]["===r?function(e){var t=s(e);return t<=d[0]||t>=d[1]}:")("===r?function(e){var t=s(e);return t<d[0]||t>d[1]}:"]("===r?function(e){var t=s(e);return t<=d[0]||t>d[1]}:")["===r?function(e){var t=s(e);return t<d[0]||t>=d[1]}:"{}"===r?function(e){return-1!==d.indexOf(s(e))}:"}{"===r?function(e){return-1===d.indexOf(s(e))}:void 0}var n=e("../lib"),l=e("../registry"),s=e("../plots/cartesian/axes"),d=e("./helpers").pointsAccessorFunction,c=e("../constants/filter_ops"),p=c.COMPARISON_OPS,u=c.INTERVAL_OPS,g=c.SET_OPS;a.moduleType="transform",a.name="filter",a.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},operation:{valType:"enumerated",values:[].concat(p).concat(u).concat(g),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},preservegaps:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc"},a.supplyDefaults=function(e){function t(t,r){return n.coerce(e,o,a.attributes,t,r)}var o={},r=t("enabled");if(r){var i=t("target");if(n.isArrayOrTypedArray(i)&&0===i.length)return o.enabled=!1,o;t("preservegaps"),t("operation"),t("value");var s=l.getComponentMethod("calendars","handleDefaults");s(e,o,"valuecalendar",null),s(e,o,"targetcalendar",null)}return o},a.calcTransform=function(e,t,a){function l(e,a){for(var o=0,r;o<m.length;o++)r=n.nestedProperty(t,m[o]),e(r,a)}if(a.enabled){var c=n.getTargetArray(t,a);if(c){var p=a.target,u=c.length;t._length&&(u=r(u,t._length));var g=a.targetcalendar,m=t._arrayAttrs,h=a.preservegaps;if("string"==typeof p){var y=n.nestedProperty(t,p+"calendar").get();y&&(g=y)}var f=s.getDataToCoordFunc(e,t,p,c),x=o(a,f,g),_={},b={},v=0,w,k;h?(w=function(e){_[e.astr]=n.extendDeep([],e.get()),e.set(Array(u))},k=function(e,t){var a=_[e.astr][t];e.get()[t]=a}):(w=function(e){_[e.astr]=n.extendDeep([],e.get()),e.set([])},k=function(e,t){var a=_[e.astr][t];e.get().push(a)}),l(w);for(var T=d(t.transforms,a),A=0,S;A<u;A++)S=x(c[A]),S?(l(k,A),b[v++]=T(A)):h&&v++;a._indexToPoints=b,t._length=v}}}},{"../constants/filter_ops":629,"../lib":657,"../plots/cartesian/axes":705,"../registry":788,"./helpers":1242}],1241:[function(e,t,a){'use strict';function o(e,t){var a=t.transform,o=t.transformIndex,d=e.transforms[o].groups,c=s(e.transforms,a),p,u,g,m,h,y,f,x,_,b;if(!r.isArrayOrTypedArray(d)||0===d.length)return[e];var v=r.filterUnique(d),w=Array(v.length),T=d.length,A=n.findArrayAttributes(e),S=a.styles||[],C={};for(p=0;p<S.length;p++)C[S[p].target]=S[p].value;a.styles&&(b=r.keyedContainer(a,"styles","target","value.name"));var L={},E={};for(p=0;p<v.length;p++){y=v[p],L[y]=p,E[y]=0,f=w[p]=r.extendDeepNoArrays({},e),f._group=y,f.transforms[o]._indexToPoints={};var I=null;for(b&&(I=b.get(y)),f.name=I||""===I?I:r.templateString(a.nameformat,{trace:e.name,group:y}),x=f.transforms,f.transforms=[],u=0;u<x.length;u++)f.transforms[u]=r.extendDeepNoArrays({},x[u]);for(u=0;u<A.length;u++)r.nestedProperty(f,A[u]).set([])}for(g=0;g<A.length;g++){for(m=A[g],u=0,_=[];u<v.length;u++)_[u]=r.nestedProperty(w[u],m).get();for(h=r.nestedProperty(e,m).get(),u=0;u<T;u++)_[L[d[u]]].push(h[u])}for(u=0;u<T;u++){f=w[L[d[u]]];var P=f.transforms[o]._indexToPoints;P[E[d[u]]]=c(u),E[d[u]]++}for(p=0;p<v.length;p++)y=v[p],f=w[p],l.clearExpandedTraceDefaultColors(f),f=r.extendDeepNoArrays(f,C[y]||{});return w}var r=e("../lib"),n=e("../plot_api/plot_schema"),l=e("../plots/plots"),s=e("./helpers").pointsAccessorFunction;a.moduleType="transform",a.name="groupby",a.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"data_array",dflt:[],editType:"calc"},nameformat:{valType:"string",editType:"calc"},styles:{_isLinkedToArray:"style",target:{valType:"string",editType:"calc"},value:{valType:"any",dflt:{},editType:"calc",_compareAsJSON:!0},editType:"calc"},editType:"calc"},a.supplyDefaults=function(e,t,o){function n(t,o){return r.coerce(e,l,a.attributes,t,o)}var l={},s=n("enabled"),d;if(!s)return l;n("groups"),n("nameformat",1<o._dataLength?"%{group} (%{trace})":"%{group}");var c=e.styles,p=l.styles=[];if(c)for(d=0;d<c.length;d++){var u=p[d]={};r.coerce(c[d],p[d],a.attributes.styles,"target");var g=r.coerce(c[d],p[d],a.attributes.styles,"value");r.isPlainObject(g)?u.value=r.extendDeep({},g):g&&delete u.value}return l},a.transform=function(e,t){var a=[],r,n,l;for(n=0;n<e.length;n++)for(r=o(e[n],t),l=0;l<r.length;l++)a.push(r[l]);return a}},{"../lib":657,"../plot_api/plot_schema":694,"../plots/plots":768,"./helpers":1242}],1242:[function(e,t,a){'use strict';a.pointsAccessorFunction=function(e,t){for(var a=0,o,r;a<e.length&&(o=e[a],o!==t);a++)!o._indexToPoints||!1===o.enabled||(r=o._indexToPoints);var n=r?function(e){return r[e]}:function(e){return[e]};return n}},{}],1243:[function(e,t,a){'use strict';var n=Math.min;function o(e,t,a,o){var n=Array(o),l=Array(o),s;for(s=0;s<o;s++)n[s]={v:t[s],i:s};for(n.sort(r(e,a)),s=0;s<o;s++)l[s]=n[s].i;return l}function r(e,t){switch(e.order){case"ascending":return function(e,a){var o=t(e.v),r=t(a.v);return o===c?1:r===c?-1:o-r};case"descending":return function(e,a){var o=t(e.v),r=t(a.v);return o===c?1:r===c?-1:r-o};}}var l=e("../lib"),s=e("../plots/cartesian/axes"),d=e("./helpers").pointsAccessorFunction,c=e("../constants/numerical").BADNUM;a.moduleType="transform",a.name="sort",a.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},order:{valType:"enumerated",values:["ascending","descending"],dflt:"ascending",editType:"calc"},editType:"calc"},a.supplyDefaults=function(e){function t(t,r){return l.coerce(e,o,a.attributes,t,r)}var o={},r=t("enabled");return r&&(t("target"),t("order")),o},a.calcTransform=function(e,t,a){if(a.enabled){var r=l.getTargetArray(t,a);if(r){var c=a.target,p=r.length;t._length&&(p=n(p,t._length));var u=t._arrayAttrs,g=s.getDataToCoordFunc(e,t,c,r),m=o(a,r,g,p),h=d(t.transforms,a),y={},f,x;for(f=0;f<u.length;f++){var _=l.nestedProperty(t,u[f]),b=_.get(),v=Array(p);for(x=0;x<p;x++)v[x]=b[m[x]];_.set(v)}for(x=0;x<p;x++)y[x]=h(m[x]);a._indexToPoints=y,t._length=p}}}},{"../constants/numerical":633,"../lib":657,"../plots/cartesian/axes":705,"./helpers":1242}],1244:[function(e,t,a){'use strict';a.version="1.54.0"},{}],1245:[function(e,t){'use strict';t.exports=e("./quad")},{"./quad":1246}],1246:[function(e,t){'use strict';var o=Math.ceil,r=Math.min,i=Math.abs,n=Math.max;function a(e,t){for(var a=t[0],o=t[1],r=t[2],l=t[3],d=Array(e.length),c=0,p=e.length/2;c<p;c++)d[2*c]=s((e[2*c]-a)*(1/(r-a)),0,1),d[2*c+1]=s((e[2*c+1]-o)*(1/(l-o)),0,1);return d}var l=e("binary-search-bounds"),s=e("clamp"),c=e("parse-rect"),p=e("array-bounds"),u=e("pick-by-alias"),g=e("defined"),m=e("flatten-vertex-data"),h=e("is-obj"),y=e("dtype"),f=e("math-log2");t.exports=function(e,t){function s(e,t,a,o,r,n){if(!o.length)return null;var d=S[r]||(S[r]=[]),c=L[r]||(L[r]=[]),p=C[r]||(C[r]=[]),u=d.length;if(r++,r>b||n>1073741824){for(var g=0;g<o.length;g++)d.push(o[g]),c.push(n),p.push(null,null,null,null);return u}if(d.push(o[0]),c.push(n),1>=o.length)return p.push(null,null,null,null),u;for(var m=.5*a,h=e+m,y=t+m,f=[],x=[],_=[],v=[],k=1,T=o.length;k<T;k++){var l=o[k],A=w[2*l],E=w[2*l+1];A<h?E<y?f.push(l):x.push(l):E<y?_.push(l):v.push(l)}return n<<=2,p.push(s(e,t,m,f,r,n),s(e,y,m,x,r,n+1),s(h,t,m,_,r,n+2),s(h,y,m,v,r,n+3)),u}function d(){function t(a,o,r,n,s,d){if(null!==s&&null!==d){if(!(E>a+r||I>o+r||P<a||z<o)&&!(n>=D)&&s!==d){var c=S[n];void 0===d&&(d=c.length);for(var p=s;p<d;p++){var u=c[p],g=e[2*u],m=e[2*u+1];g>=w&&g<=T&&m>=k&&m<=A&&R.push(u)}var h=C[n],y=h[4*s+0],f=h[4*s+1],x=h[4*s+2],_=h[4*s+3],b=l(h,s+1),v=.5*r,L=n+1;t(a,o,v,L,y,f||x||_||b),t(a,o+v,v,L,f,x||_||b),t(a+v,o,v,L,x,_||b),t(a+v,o+v,v,L,_,b)}}}function l(e,t){for(var a=null,o=0;null===a;)if(a=e[4*t+o],o++,o>e.length)return null;return a}for(var s=[],p=arguments.length;p--;)s[p]=arguments[p];var m;if(h(s[s.length-1])){var y=s.pop();s.length||null==y.x&&null==y.l&&null==y.left||(s=[y],m={}),m=u(y,{level:"level maxLevel",d:"d diam diameter r radius px pxSize pixel pixelSize maxD size minSize",lod:"lod details ranges offsets"})}else m={};s.length||(s=v);var _=c.apply(void 0,s),b=[r(_.x,_.x+_.width),r(_.y,_.y+_.height),n(_.x,_.x+_.width),n(_.y,_.y+_.height)],w=b[0],k=b[1],T=b[2],A=b[3],L=a([w,k,T,A],v),E=L[0],I=L[1],P=L[2],z=L[3],D=g(m.level,S.length);if(null!=m.d){var O;"number"==typeof m.d?O=[m.d,m.d]:m.d.length&&(O=m.d),D=r(n(o(-f(i(O[0])/(v[2]-v[0]))),o(-f(i(O[1])/(v[3]-v[1])))),D)}if(D=r(D,S.length),m.lod)return x(E,I,P,z,D);var R=[];return t(0,0,1,0,0,1),R}function x(e,t,a,o,r){for(var i=[],n=0;n<r;n++){var s=L[n],d=E[n][0],c=_(e,t,n),p=_(a,o,n),u=l.ge(s,c),g=l.gt(s,p,u,s.length-1);i[n]=[u+d,g+d]}return i}function _(e,t,a){for(var o=1,r=.5,n=.5,l=.5,s=0;s<a;s++)o<<=2,o+=e<r?t<n?0:1:t<n?2:3,l*=.5,r+=e<r?-l:l,n+=t<n?-l:l;return o}t||(t={}),e=m(e,"float64"),t=u(t,{bounds:"range bounds dataBox databox",maxDepth:"depth maxDepth maxdepth level maxLevel maxlevel levels",dtype:"type dtype format out dst output destination"});var b=g(t.maxDepth,255),v=g(t.bounds,p(e,2));v[0]===v[2]&&v[2]++,v[1]===v[3]&&v[3]++;var w=a(e,v),k=e.length>>>1,T;t.dtype||(t.dtype="array"),"string"==typeof t.dtype?T=new(y(t.dtype))(k):t.dtype&&(T=t.dtype,Array.isArray(T)&&(T.length=k));for(var A=0;A<k;++A)T[A]=A;var S=[],C=[],L=[],E=[];s(0,0,1,T,0,1);for(var I=0,P=0,z;P<S.length;P++){if(z=S[P],T.set)T.set(z,I);else for(var D=0,O=z.length;D<O;D++)T[D+I]=z[D];var R=I+S[P].length;E[P]=[I,R],I=R}return T.range=d,T}},{"array-bounds":21,"binary-search-bounds":42,clamp:62,defined:110,dtype:115,"flatten-vertex-data":205,"is-obj":390,"math-log2":402,"parse-rect":443,"pick-by-alias":449}],1247:[function(e,t,a){arguments[4][204][0].apply(a,arguments)},{dup:204}],1248:[function(e,t){function a(){return!0}function o(e){return function(t,o){var r=e[t];return!!r&&!!r.queryPoint(o,a)}}function r(e){for(var t={},a=0;a<e.length;++a){var r=e[a],n=r[0][0],l=r[0][1],s=r[1][1],d=[Math.min(l,s),Math.max(l,s)];n in t?t[n].push(d):t[n]=[d]}for(var c={},p=Object.keys(t),a=0,u;a<p.length;++a)u=t[p[a]],c[p[a]]=m(u);return o(c)}function n(e,t){return function(a){var r=h.le(t,a[0]);if(0>r)return 1;var i=e[r];if(!i)if(0<r&&t[r]===a[0])i=e[r-1];else return 1;for(var n=1;i;){var l=i.key,s=u(a,l[0],l[1]);if(l[0][0]<l[1][0]){if(0>s)i=i.left;else if(0<s)n=-1,i=i.right;else return 0;}else if(0<s)i=i.left;else if(0>s)n=1,i=i.right;else return 0}return n}}function l(){return 1}function d(e){return function(t){return e(t[0],t[1])?0:1}}function c(e,t){return function(a){return e(a[0],a[1])?0:t(a)}}t.exports=function(e){for(var o=e.length,p=[],u=[],m=0;m<o;++m)for(var h=e[m],y=h.length,f=y-1,x=0;x<y;f=x++){var _=h[f],a=h[x];_[0]===a[0]?u.push([_,a]):p.push([_,a])}if(0===p.length)return 0===u.length?l:d(r(u));var b=g(p),v=n(b.slabs,b.coordinates);return 0===u.length?v:c(r(u),v)};var u=e("robust-orientation")[3],g=e("slab-decomposition"),m=e("interval-tree-1d"),h=e("binary-search-bounds")},{"binary-search-bounds":1247,"interval-tree-1d":382,"robust-orientation":1277,"slab-decomposition":1298}],1249:[function(e,t){function a(e,t,a){var o=u.segments(e),r=u.segments(t),i=u.combine(o,r),n=a(i);return u.polygon(n)}/*
 * @copyright 2016 Sean Connelly (@voidqk), http://syntheti.cc
 * @license MIT
 * @preserve Project Home: https://github.com/voidqk/polybooljs
 */var o=e("./lib/build-log"),r=e("./lib/epsilon"),n=e("./lib/intersecter"),l=e("./lib/segment-chainer"),s=e("./lib/segment-selector"),d=e("./lib/geojson"),c=!1,p=r(),u;u={buildLog:function(e){return!0===e?c=o():!1==e&&(c=!1),!1!==c&&c.list},epsilon:function(e){return p.epsilon(e)},segments:function(e){var t=n(!0,p,c);return e.regions.forEach(t.addRegion),{segments:t.calculate(e.inverted),inverted:e.inverted}},combine:function(e,t){var a=n(!1,p,c);return{combined:a.calculate(e.segments,e.inverted,t.segments,t.inverted),inverted1:e.inverted,inverted2:t.inverted}},selectUnion:function(e){return{segments:s.union(e.combined,c),inverted:e.inverted1||e.inverted2}},selectIntersect:function(e){return{segments:s.intersect(e.combined,c),inverted:e.inverted1&&e.inverted2}},selectDifference:function(e){return{segments:s.difference(e.combined,c),inverted:e.inverted1&&!e.inverted2}},selectDifferenceRev:function(e){return{segments:s.differenceRev(e.combined,c),inverted:!e.inverted1&&e.inverted2}},selectXor:function(e){return{segments:s.xor(e.combined,c),inverted:e.inverted1!==e.inverted2}},polygon:function(e){return{regions:l(e.segments,p,c),inverted:e.inverted}},polygonFromGeoJSON:function(e){return d.toPolygon(u,e)},polygonToGeoJSON:function(e){return d.fromPolygon(u,p,e)},union:function(e,t){return a(e,t,u.selectUnion)},intersect:function(e,t){return a(e,t,u.selectIntersect)},difference:function(e,t){return a(e,t,u.selectDifference)},differenceRev:function(e,t){return a(e,t,u.selectDifferenceRev)},xor:function(e,t){return a(e,t,u.selectXor)}},"object"==typeof window&&(window.PolyBool=u),t.exports=u},{"./lib/build-log":1250,"./lib/epsilon":1251,"./lib/geojson":1252,"./lib/intersecter":1253,"./lib/segment-chainer":1255,"./lib/segment-selector":1256}],1250:[function(e,t){t.exports=function(){function e(e,t){return o.list.push({type:e,data:t?JSON.parse(JSON.stringify(t)):void 0}),o}var t=0,a=!1,o;return o={list:[],segmentId:function(){return t++},checkIntersection:function(t,a){return e("check",{seg1:t,seg2:a})},segmentChop:function(t,a){return e("div_seg",{seg:t,pt:a}),e("chop",{seg:t,pt:a})},statusRemove:function(t){return e("pop_seg",{seg:t})},segmentUpdate:function(t){return e("seg_update",{seg:t})},segmentNew:function(t,a){return e("new_seg",{seg:t,primary:a})},segmentRemove:function(t){return e("rem_seg",{seg:t})},tempStatus:function(t,a,o){return e("temp_status",{seg:t,above:a,below:o})},rewind:function(t){return e("rewind",{seg:t})},status:function(t,a,o){return e("status",{seg:t,above:a,below:o})},vert:function(t){return t===a?o:(a=t,e("vert",{x:t}))},log:function(t){return"string"!=typeof t&&(t=JSON.stringify(t,!1,"  ")),e("log",{txt:t})},reset:function(){return e("reset")},selected:function(t){return e("selected",{segs:t})},chainStart:function(t){return e("chain_start",{seg:t})},chainRemoveHead:function(t,a){return e("chain_rem_head",{index:t,pt:a})},chainRemoveTail:function(t,a){return e("chain_rem_tail",{index:t,pt:a})},chainNew:function(t,a){return e("chain_new",{pt1:t,pt2:a})},chainMatch:function(t){return e("chain_match",{index:t})},chainClose:function(t){return e("chain_close",{index:t})},chainAddHead:function(t,a){return e("chain_add_head",{index:t,pt:a})},chainAddTail:function(t,a){return e("chain_add_tail",{index:t,pt:a})},chainConnect:function(t,a){return e("chain_con",{index1:t,index2:a})},chainReverse:function(t){return e("chain_rev",{index:t})},chainJoin:function(t,a){return e("chain_join",{index1:t,index2:a})},done:function(){return e("done")}},o}},{}],1251:[function(e,t){var a=Math.abs;t.exports=function(e){"number"!=typeof e&&(e=1e-10);var t={epsilon:function(t){return"number"==typeof t&&(e=t),e},pointAboveOrOnLine:function(t,a,o){var r=a[0],i=a[1],n=o[0],l=o[1],s=t[0],d=t[1];return(n-r)*(d-i)-(l-i)*(s-r)>=-e},pointBetween:function(t,a,o){var r=t[1]-a[1],i=o[0]-a[0],n=t[0]-a[0],l=o[1]-a[1],s=n*i+r*l;if(s<e)return!1;return!(s-(i*i+l*l)>-e)},pointsSameX:function(t,o){return a(t[0]-o[0])<e},pointsSameY:function(t,o){return a(t[1]-o[1])<e},pointsSame:function(e,a){return t.pointsSameX(e,a)&&t.pointsSameY(e,a)},pointsCompare:function(e,a){return t.pointsSameX(e,a)?t.pointsSameY(e,a)?0:e[1]<a[1]?-1:1:e[0]<a[0]?-1:1},pointsCollinear:function(t,o,r){var i=t[0]-o[0],n=t[1]-o[1],l=o[0]-r[0],s=o[1]-r[1];return a(i*s-l*n)<e},linesIntersect:function(t,o,r,i){var n=o[0]-t[0],l=o[1]-t[1],s=i[0]-r[0],d=i[1]-r[1],c=n*d-l*s;if(a(c)<e)return!1;var p=t[0]-r[0],u=t[1]-r[1],g=(s*u-d*p)/c,m=(n*u-l*p)/c,h={alongA:0,alongB:0,pt:[t[0]+g*n,t[1]+g*l]};return h.alongA=g<=-e?-2:g<e?-1:g-1<=-e?0:g-1<e?1:2,h.alongB=m<=-e?-2:m<e?-1:m-1<=-e?0:m-1<e?1:2,h},pointInsideRegion:function(t,a){for(var o=t[0],r=t[1],n=a[a.length-1][0],l=a[a.length-1][1],s=!1,d=0;d<a.length;d++){var c=a[d][0],p=a[d][1];p-r>e!=l-r>e&&(n-c)*(r-p)/(l-p)+c-o>e&&(s=!s),n=c,l=p}return s}};return t}},{}],1252:[function(e,t){t.exports={toPolygon:function(e,t){function a(t){function a(t){var a=t.slice(0,t.length-1);return e.segments({inverted:!1,regions:[a]})}if(0>=t.length)return e.segments({inverted:!1,regions:[]});for(var o=a(t[0]),r=1;r<t.length;r++)o=e.selectDifference(e.combine(o,a(t[r])));return o}if("Polygon"===t.type)return e.polygon(a(t.coordinates));if("MultiPolygon"===t.type){for(var o=e.segments({inverted:!1,regions:[]}),r=0;r<t.coordinates.length;r++)o=e.selectUnion(e.combine(o,a(t.coordinates[r])));return e.polygon(o)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(e,t,a){function o(e,a){return t.pointInsideRegion([.5*(e[0][0]+e[1][0]),.5*(e[0][1]+e[1][1])],a)}function r(e){return{region:e,children:[]}}function n(e,t){for(var a=0,l;a<e.children.length;a++)if(l=e.children[a],o(t,l.region))return void n(l,t);for(var s=r(t),a=0,l;a<e.children.length;a++)l=e.children[a],o(l.region,t)&&(s.children.push(l),e.children.splice(a,1),a--);e.children.push(s)}function l(e,t){for(var a=0,o=e[e.length-1][0],r=e[e.length-1][1],n=[],l=0;l<e.length;l++){var s=e[l][0],d=e[l][1];n.push([s,d]),a+=d*o-s*r,o=s,r=d}var c=0>a;return c!==t&&n.reverse(),n.push([n[0][0],n[0][1]]),n}function s(e){var t=[l(e.region,!1)];g.push(t);for(var a=0;a<e.children.length;a++)t.push(d(e.children[a]))}function d(e){for(var t=0;t<e.children.length;t++)s(e.children[t]);return l(e.region,!0)}a=e.polygon(e.segments(a));for(var c=r(null),p=0,u;p<a.regions.length;p++)u=a.regions[p],3>u.length||n(c,u);for(var g=[],p=0;p<c.children.length;p++)s(c.children[p]);return 0>=g.length?{type:"Polygon",coordinates:[]}:1==g.length?{type:"Polygon",coordinates:g[0]}:{type:"MultiPolygon",coordinates:g}}}},{}],1253:[function(e,t){var a=e("./linked-list");t.exports=function(e,t,o){function r(e,t){return{id:o?o.segmentId():-1,start:e,end:t,myFill:{above:null,below:null},otherFill:null}}function i(e,t,a){return{id:o?o.segmentId():-1,start:e,end:t,myFill:{above:a.myFill.above,below:a.myFill.below},otherFill:null}}function n(e,a,o,r,i,n){var l=t.pointsCompare(a,i);return 0===l?t.pointsSame(o,n)?0:e===r?t.pointAboveOrOnLine(o,r?i:n,r?n:i)?1:-1:e?1:-1:l}function l(e,t){m.insertBefore(e,function(a){var o=n(e.isStart,e.pt,t,a.isStart,a.pt,a.other.pt);return 0>o})}function s(e,t){var o=a.node({isStart:!0,pt:e.start,seg:e,primary:t,other:null,status:null});return l(o,e.end),o}function d(e,t,o){var r=a.node({isStart:!1,pt:t.end,seg:t,primary:o,other:e,status:null});e.other=r,l(r,e.pt)}function c(e,t){var a=s(e,t);return d(a,e,t),a}function p(e,t){o&&o.segmentChop(e.seg,t),e.other.remove(),e.seg.end=t,e.other.pt=t,l(e.other,e.pt)}function u(e,t){var a=i(t,e.seg.end,e.seg);return p(e,t),c(a,e.primary)}function g(r,i){function n(e,a){var o=e.seg.start,r=e.seg.end,i=a.seg.start,n=a.seg.end;return t.pointsCollinear(o,i,n)?t.pointsCollinear(r,i,n)?1:t.pointAboveOrOnLine(r,i,n)?1:-1:t.pointAboveOrOnLine(o,i,n)?1:-1}function l(e){return c.findTransition(function(t){var a=n(e,t.ev);return 0<a})}function d(e,a){var r=e.seg,n=a.seg,l=r.start,s=r.end,d=n.start,c=n.end;o&&o.checkIntersection(r,n);var p=t.linesIntersect(l,s,d,c);if(!1===p){if(!t.pointsCollinear(l,s,d))return!1;if(t.pointsSame(l,c)||t.pointsSame(s,d))return!1;var i=t.pointsSame(l,d),g=t.pointsSame(s,c);if(i&&g)return a;var m=!i&&t.pointBetween(l,d,c),h=!g&&t.pointBetween(s,d,c);if(i)return h?u(a,s):u(e,c),a;m&&(g||(h?u(a,s):u(e,c)),u(a,l))}else 0===p.alongA&&(-1===p.alongB?u(e,d):0===p.alongB?u(e,p.pt):1===p.alongB&&u(e,c)),0===p.alongB&&(-1===p.alongA?u(a,l):0===p.alongA?u(a,p.pt):1===p.alongA&&u(a,s));return!1}for(var c=a.create(),p=[],g;!m.isEmpty();){if(g=m.getHead(),o&&o.vert(g.pt[0]),g.isStart){function t(){if(y){var e=d(g,y);if(e)return e}return!!f&&d(g,f)}o&&o.segmentNew(g.seg,g.primary);var h=l(g),y=h.before?h.before.ev:null,f=h.after?h.after.ev:null;o&&o.tempStatus(g.seg,!!y&&y.seg,!!f&&f.seg);var x=t();if(x){if(e){var _;_=null===g.seg.myFill.below||g.seg.myFill.above!==g.seg.myFill.below,_&&(x.seg.myFill.above=!x.seg.myFill.above)}else x.seg.otherFill=g.seg.myFill;o&&o.segmentUpdate(x.seg),g.other.remove(),g.remove()}if(m.getHead()!==g){o&&o.rewind(g.seg);continue}if(e){var _;_=null===g.seg.myFill.below||g.seg.myFill.above!==g.seg.myFill.below,g.seg.myFill.below=f?f.seg.myFill.above:r,g.seg.myFill.above=_?!g.seg.myFill.below:g.seg.myFill.below}else if(null===g.seg.otherFill){var b;b=f?g.primary===f.primary?f.seg.otherFill.above:f.seg.myFill.above:g.primary?i:r,g.seg.otherFill={above:b,below:b}}o&&o.status(g.seg,!!y&&y.seg,!!f&&f.seg),g.other.status=h.insert(a.node({ev:g}))}else{var v=g.status;if(null===v)throw new Error("PolyBool: Zero-length segment detected; your epsilon is probably too small or too large");if(c.exists(v.prev)&&c.exists(v.next)&&d(v.prev.ev,v.next.ev),o&&o.statusRemove(v.ev.seg),v.remove(),!g.primary){var w=g.seg.myFill;g.seg.myFill=g.seg.otherFill,g.seg.otherFill=w}p.push(g.seg)}m.getHead().remove()}return o&&o.done(),p}var m=a.create();return e?{addRegion:function(e){for(var a=e[e.length-1],o=0,n;o<e.length;o++){n=a,a=e[o];var l=t.pointsCompare(n,a);0===l||c(r(0>l?n:a,0>l?a:n),!0)}},calculate:function(e){return g(e,!1)}}:{calculate:function(e,t,a,o){return e.forEach(function(e){c(i(e.start,e.end,e),!0)}),a.forEach(function(e){c(i(e.start,e.end,e),!1)}),g(t,o)}}}},{"./linked-list":1254}],1254:[function(e,t){t.exports={create:function(){var e={root:{root:!0,next:null},exists:function(t){return null!==t&&t!==e.root},isEmpty:function(){return null===e.root.next},getHead:function(){return e.root.next},insertBefore:function(t,a){for(var o=e.root,r=e.root.next;null!==r;){if(a(r))return t.prev=r.prev,t.next=r,r.prev.next=t,void(r.prev=t);o=r,r=r.next}o.next=t,t.prev=o,t.next=null},findTransition:function(t){for(var a=e.root,o=e.root.next;null!==o&&!t(o);)a=o,o=o.next;return{before:a===e.root?null:a,after:o,insert:function(e){return e.prev=a,e.next=o,a.next=e,null!==o&&(o.prev=e),e}}}};return e},node:function(e){return e.prev=null,e.next=null,e.remove=function(){e.prev.next=e.next,e.next&&(e.next.prev=e.prev),e.prev=null,e.next=null},e}}},{}],1255:[function(e,t){t.exports=function(e,t,a){var o=[],r=[];return e.forEach(function(e){function n(e,t,a){return(g.index=e,g.matches_head=t,g.matches_pt1=a,g===p)?(g=u,!1):(g=null,!0)}function l(e){a&&a.chainReverse(e),o[e].reverse()}function s(e,r){var i=o[e],n=o[r],l=i[i.length-1],s=i[i.length-2],d=n[0],c=n[1];t.pointsCollinear(s,l,d)&&(a&&a.chainRemoveTail(e,l),i.pop(),l=s),t.pointsCollinear(l,d,c)&&(a&&a.chainRemoveHead(r,d),n.shift()),a&&a.chainJoin(e,r),o[e]=i.concat(n),o.splice(r,1)}var d=e.start,c=e.end;if(t.pointsSame(d,c))return void console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is probably too small or too large");a&&a.chainStart(e);for(var p={index:0,matches_head:!1,matches_pt1:!1},u={index:0,matches_head:!1,matches_pt1:!1},g=p,m=0;m<o.length;m++){var h=o[m],y=h[0],f=h[1],x=h[h.length-1],_=h[h.length-2];if(t.pointsSame(y,d)){if(n(m,!0,!0))break;}else if(t.pointsSame(y,c)){if(n(m,!0,!1))break;}else if(t.pointsSame(x,d)){if(n(m,!1,!0))break;}else if(t.pointsSame(x,c)&&n(m,!1,!1))break}if(g===p)return o.push([d,c]),void(a&&a.chainNew(d,c));if(g===u){a&&a.chainMatch(p.index);var b=p.index,v=p.matches_pt1?c:d,w=p.matches_head,h=o[b],k=w?h[0]:h[h.length-1],T=w?h[1]:h[h.length-2],A=w?h[h.length-1]:h[0],C=w?h[h.length-2]:h[1];return(t.pointsCollinear(T,k,v)&&(w?(a&&a.chainRemoveHead(p.index,v),h.shift()):(a&&a.chainRemoveTail(p.index,v),h.pop()),k=T),t.pointsSame(A,v))?(o.splice(b,1),t.pointsCollinear(C,A,k)&&(w?(a&&a.chainRemoveTail(p.index,k),h.pop()):(a&&a.chainRemoveHead(p.index,k),h.shift())),a&&a.chainClose(p.index),void r.push(h)):void(w?(a&&a.chainAddHead(p.index,v),h.unshift(v)):(a&&a.chainAddTail(p.index,v),h.push(v)))}var L=p.index,E=u.index;a&&a.chainConnect(L,E);var S=o[L].length<o[E].length;p.matches_head?u.matches_head?S?(l(L),s(L,E)):(l(E),s(E,L)):s(E,L):u.matches_head?s(L,E):S?(l(L),s(E,L)):(l(E),s(L,E))}),r}},{}],1256:[function(e,t){function a(e,t,a){var o=[];return e.forEach(function(e){var r=(e.myFill.above?8:0)+(e.myFill.below?4:0)+(e.otherFill&&e.otherFill.above?2:0)+(e.otherFill&&e.otherFill.below?1:0);0!==t[r]&&o.push({id:a?a.segmentId():-1,start:e.start,end:e.end,myFill:{above:1===t[r],below:2===t[r]},otherFill:null})}),a&&a.selected(o),o}t.exports={union:function(e,t){return a(e,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],t)},intersect:function(e,t){return a(e,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],t)},difference:function(e,t){return a(e,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],t)},differenceRev:function(e,t){return a(e,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],t)},xor:function(e,t){return a(e,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],t)}}},{}],1257:[function(e,t){"use strict";function a(e,a,l,p,g){o.length<p.length&&(o=new Float64Array(p.length),r=new Float64Array(p.length),n=new Float64Array(p.length));for(var m=0;m<p.length;++m)o[m]=e[m]-p[m],r[m]=a[m]-e[m],n[m]=l[m]-e[m];for(var h=0,y=0,f=0,x=0,_=0,b=0,m=0;m<p.length;++m){var v=r[m],w=n[m],k=o[m];h+=v*v,y+=v*w,f+=w*w,x+=k*v,_+=k*w,b+=k*k}var d=Math.abs(h*f-y*y),T=y*_-f*x,A=y*x-h*_,S;if(!(T+A<=d)){var C,L,E,I;0>T?(C=y+x,L=f+_,L>C?(E=L-C,I=h-2*y+f,E>=I?(T=1,A=0,S=h+2*x+b):(T=E/I,A=1-T,S=T*(h*T+y*A+2*x)+A*(y*T+f*A+2*_)+b)):(T=0,0>=L?(A=1,S=f+2*_+b):0<=_?(A=0,S=b):(A=-_/f,S=_*A+b))):0>A?(C=y+_,L=h+x,L>C?(E=L-C,I=h-2*y+f,E>=I?(A=1,T=0,S=f+2*_+b):(A=E/I,T=1-A,S=T*(h*T+y*A+2*x)+A*(y*T+f*A+2*_)+b)):(A=0,0>=L?(T=1,S=h+2*x+b):0<=x?(T=0,S=b):(T=-x/h,S=x*T+b))):(E=f+_-y-x,0>=E?(T=0,A=1,S=f+2*_+b):(I=h-2*y+f,E>=I?(T=1,A=0,S=h+2*x+b):(T=E/I,A=1-T,S=T*(h*T+y*A+2*x)+A*(y*T+f*A+2*_)+b)))}else if(0>T)0>A?0>x?(A=0,-x>=h?(T=1,S=h+2*x+b):(T=-x/h,S=x*T+b)):(T=0,0<=_?(A=0,S=b):-_>=f?(A=1,S=f+2*_+b):(A=-_/f,S=_*A+b)):(T=0,0<=_?(A=0,S=b):-_>=f?(A=1,S=f+2*_+b):(A=-_/f,S=_*A+b));else if(0>A)A=0,0<=x?(T=0,S=b):-x>=h?(T=1,S=h+2*x+b):(T=-x/h,S=x*T+b);else{var P=1/d;T*=P,A*=P,S=T*(h*T+y*A+2*x)+A*(y*T+f*A+2*_)+b}for(var z=1-T-A,m=0;m<p.length;++m)g[m]=z*e[m]+T*a[m]+A*l[m];return 0>S?0:S}var o=new Float64Array(4),r=new Float64Array(4),n=new Float64Array(4);t.exports=a},{}],1258:[function(e,t){t.exports=e("gl-quat/slerp")},{"gl-quat/slerp":269}],1259:[function(e,t){var a=Math.round,o=Math.max;(function(r){for(var n=e("performance-now"),l="undefined"==typeof window?r:window,s=["moz","webkit"],d="AnimationFrame",c=l["request"+d],p=l["cancel"+d]||l["cancelRequest"+d],u=0;!c&&u<s.length;u++)c=l[s[u]+"Request"+d],p=l[s[u]+"Cancel"+d]||l[s[u]+"CancelRequest"+d];if(!c||!p){var g=0,m=0,h=[];c=function(e){if(0===h.length){var t=n(),r=o(0,1e3/60-(t-g));g=r+t,setTimeout(function(){var e=h.slice(0);h.length=0;for(var t=0;t<e.length;t++)if(!e[t].cancelled)try{e[t].callback(g)}catch(t){setTimeout(function(){throw t},0)}},a(r))}return h.push({handle:++m,callback:e,cancelled:!1}),m},p=function(e){for(var t=0;t<h.length;t++)h[t].handle===e&&(h[t].cancelled=!0)}}t.exports=function(e){return c.call(l,e)},t.exports.cancel=function(){p.apply(l,arguments)},t.exports.polyfill=function(e){e||(e=l),e.requestAnimationFrame=c,e.cancelAnimationFrame=p}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"performance-now":446}],1260:[function(e,t){'use strict';var o=e("big-rat/add");t.exports=function(e,t){for(var a=e.length,n=Array(a),r=0;r<a;++r)n[r]=o(e[r],t[r]);return n}},{"big-rat/add":26}],1261:[function(e,t){'use strict';t.exports=function(e){for(var t=Array(e.length),o=0;o<e.length;++o)t[o]=a(e[o]);return t};var a=e("big-rat")},{"big-rat":29}],1262:[function(e,t){'use strict';var o=e("big-rat"),l=e("big-rat/mul");t.exports=function(e,t){for(var a=o(t),s=e.length,n=Array(s),r=0;r<s;++r)n[r]=l(e[r],a);return n}},{"big-rat":29,"big-rat/mul":38}],1263:[function(e,t){'use strict';var o=e("big-rat/sub");t.exports=function(e,t){for(var a=e.length,n=Array(a),r=0;r<a;++r)n[r]=o(e[r],t[r]);return n}},{"big-rat/sub":40}],1264:[function(e,t){'use strict';var a=e("compare-cell"),r=e("compare-oriented-cell"),n=e("cell-orientation");t.exports=function(e){e.sort(r);for(var t=e.length,l=0,s=0;s<t;++s){var d=e[s],c=n(d);if(0!==c){if(0<l){var o=e[l-1];if(0===a(d,o)&&n(o)!==c){l-=1;continue}}e[l++]=d}}return e.length=l,e}},{"cell-orientation":59,"compare-cell":75,"compare-oriented-cell":76}],1265:[function(e,t){'use strict';var a=Math.floor,o=e("array-bounds"),r=e("color-normalize"),n=e("update-diff"),l=e("pick-by-alias"),s=e("object-assign"),d=e("flatten-vertex-data"),c=e("to-float32"),p=c.float32,u=c.fract32;t.exports=function(e,t){function i(e){e?h(e):null===e&&y(),c()}function c(t){return"number"==typeof t?m(t):void(t&&!Array.isArray(t)&&(t=[t]),e._refresh(),_.forEach(function(e,a){if(e)return t&&(t[a]?e.draw=!0:e.draw=!1),e.draw?void m(a):void(e.draw=!0)}))}function m(e){"number"==typeof e&&(e=_[e]),null!=e&&e&&e.count&&e.color&&e.opacity&&e.positions&&1<e.positions.length&&(e.scaleRatio=[e.scale[0]*e.viewport.width,e.scale[1]*e.viewport.height],b(e),e.after&&e.after(e))}function h(e){if(e){null==e.length?!Array.isArray(e)&&(e=[e]):"number"==typeof e[0]&&(e=[{positions:e}]);var t=0,c=0;if(i.groups=_=e.map(function(e,p){var i=_[p];return e?("function"==typeof e?e={after:e}:"number"==typeof e[0]&&(e={positions:e}),e=l(e,{color:"color colors fill",capSize:"capSize cap capsize cap-size",lineWidth:"lineWidth line-width width line thickness",opacity:"opacity alpha",range:"range dataBox",viewport:"viewport viewBox",errors:"errors error",positions:"positions position data points"}),i||(_[p]=i={id:p,scale:null,translate:null,scaleFract:null,translateFract:null,draw:!0},e=s({},x,e)),n(i,e,[{lineWidth:function(e){return .5*+e},capSize:function(e){return .5*+e},opacity:parseFloat,errors:function(e){return e=d(e),c+=e.length,e},positions:function(e,r){return e=d(e,"float64"),r.count=a(e.length/2),r.bounds=o(e,2),r.offset=t,t+=r.count,e}},{color:function(e,t){var a=t.count;if(e||(e="transparent"),!Array.isArray(e)||"number"==typeof e[0]){var o=e;e=Array(a);for(var n=0;n<a;n++)e[n]=o}if(e.length<a)throw Error("Not enough colors");for(var l=new Uint8Array(4*a),s=0,d;s<a;s++)d=r(e[s],"uint8"),l.set(d,4*s);return l},range:function(e,t){var a=t.bounds;return e||(e=a),t.scale=[1/(e[2]-e[0]),1/(e[3]-e[1])],t.translate=[-e[0],-e[1]],t.scaleFract=u(t.scale),t.translateFract=u(t.translate),e},viewport:function(e){var t;return Array.isArray(e)?t={x:e[0],y:e[1],width:e[2]-e[0],height:e[3]-e[1]}:e?(t={x:e.x||e.left||0,y:e.y||e.top||0},t.width=e.right?e.right-t.x:e.w||e.width||0,t.height=e.bottom?e.bottom-t.y:e.h||e.height||0):t={x:0,y:0,width:f.drawingBufferWidth,height:f.drawingBufferHeight},t}}]),i):i}),t||c){var g=_.reduce(function(e,t){return e+(t?t.count:0)},0),m=new Float64Array(2*g),h=new Uint8Array(4*g),y=new Float32Array(4*g);_.forEach(function(e){if(e){var t=e.positions,a=e.count,o=e.offset,r=e.color,i=e.errors;a&&(h.set(r,4*o),y.set(i,4*o),m.set(t,2*o))}}),v(p(m)),w(u(m)),k(h),T(y)}}}function y(){v.destroy(),w.destroy(),k.destroy(),T.destroy(),A.destroy()}if("function"==typeof e?(!t&&(t={}),t.regl=e):t=e,t.length&&(t.positions=t),e=t.regl,!e.hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");var f=e._gl,x={color:"black",capSize:5,lineWidth:1,opacity:1,viewport:null,range:null,offset:0,count:0,bounds:null,positions:[],errors:[]},_=[],b,v,w,k,T,A;return k=e.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array(0)}),v=e.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),w=e.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),T=e.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),A=e.buffer({usage:"static",type:"float",data:g}),h(t),b=e({vert:"\n\t\tprecision highp float;\n\n\t\tattribute vec2 position, positionFract;\n\t\tattribute vec4 error;\n\t\tattribute vec4 color;\n\n\t\tattribute vec2 direction, lineOffset, capOffset;\n\n\t\tuniform vec4 viewport;\n\t\tuniform float lineWidth, capSize;\n\t\tuniform vec2 scale, scaleFract, translate, translateFract;\n\n\t\tvarying vec4 fragColor;\n\n\t\tvoid main() {\n\t\t\tfragColor = color / 255.;\n\n\t\t\tvec2 pixelOffset = lineWidth * lineOffset + (capSize + lineWidth) * capOffset;\n\n\t\t\tvec2 dxy = -step(.5, direction.xy) * error.xz + step(direction.xy, vec2(-.5)) * error.yw;\n\n\t\t\tvec2 position = position + dxy;\n\n\t\t\tvec2 pos = (position + translate) * scale\n\t\t\t\t+ (positionFract + translateFract) * scale\n\t\t\t\t+ (position + translate) * scaleFract\n\t\t\t\t+ (positionFract + translateFract) * scaleFract;\n\n\t\t\tpos += pixelOffset / viewport.zw;\n\n\t\t\tgl_Position = vec4(pos * 2. - 1., 0, 1);\n\t\t}\n\t\t",frag:"\n\t\tprecision highp float;\n\n\t\tvarying vec4 fragColor;\n\n\t\tuniform float opacity;\n\n\t\tvoid main() {\n\t\t\tgl_FragColor = fragColor;\n\t\t\tgl_FragColor.a *= opacity;\n\t\t}\n\t\t",uniforms:{range:e.prop("range"),lineWidth:e.prop("lineWidth"),capSize:e.prop("capSize"),opacity:e.prop("opacity"),scale:e.prop("scale"),translate:e.prop("translate"),scaleFract:e.prop("scaleFract"),translateFract:e.prop("translateFract"),viewport:function(e,t){return[t.viewport.x,t.viewport.y,e.viewportWidth,e.viewportHeight]}},attributes:{color:{buffer:k,offset:function(e,t){return 4*t.offset},divisor:1},position:{buffer:v,offset:function(e,t){return 8*t.offset},divisor:1},positionFract:{buffer:w,offset:function(e,t){return 8*t.offset},divisor:1},error:{buffer:T,offset:function(e,t){return 16*t.offset},divisor:1},direction:{buffer:A,stride:24,offset:0},lineOffset:{buffer:A,stride:24,offset:8},capOffset:{buffer:A,stride:24,offset:16}},primitive:"triangles",blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:!1},scissor:{enable:!0,box:e.prop("viewport")},viewport:e.prop("viewport"),stencil:!1,instances:e.prop("count"),count:g.length}),s(i,{update:h,draw:c,destroy:y,regl:e,gl:f,canvas:f.canvas,groups:_}),i};var g=[[1,0,0,1,0,0],[1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,1,0,0],[1,0,0,1,0,0],[1,0,-1,0,0,1],[1,0,-1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,1],[1,0,-1,0,0,1],[-1,0,-1,0,0,1],[-1,0,-1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,1],[-1,0,-1,0,0,1],[0,1,1,0,0,0],[0,1,-1,0,0,0],[0,-1,-1,0,0,0],[0,-1,-1,0,0,0],[0,1,1,0,0,0],[0,-1,1,0,0,0],[0,1,0,-1,1,0],[0,1,0,-1,-1,0],[0,1,0,1,-1,0],[0,1,0,1,1,0],[0,1,0,-1,1,0],[0,1,0,1,-1,0],[0,-1,0,-1,1,0],[0,-1,0,-1,-1,0],[0,-1,0,1,-1,0],[0,-1,0,1,1,0],[0,-1,0,-1,1,0],[0,-1,0,1,-1,0]]},{"array-bounds":21,"color-normalize":67,"flatten-vertex-data":205,"object-assign":438,"pick-by-alias":449,"to-float32":1310,"update-diff":1334}],1266:[function(e,t){'use strict';var r=Math.max,i=Math.floor;function a(e,t){if(!(this instanceof a))return new a(e,t);if("function"==typeof e?(!t&&(t={}),t.regl=e):t=e,t.length&&(t.positions=t),e=t.regl,!e.hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");this.gl=e._gl,this.regl=e,this.passes=[],this.shaders=a.shaders.has(e)?a.shaders.get(e):a.shaders.set(e,a.createShaders(e)).get(e),this.update(t)}var n=e("color-normalize"),s=e("array-bounds"),d=e("object-assign"),c=e("glslify"),p=e("pick-by-alias"),u=e("flatten-vertex-data"),g=e("earcut"),m=e("array-normalize"),h=e("to-float32"),f=h.float32,_=h.fract32,b=e("es6-weak-map"),v=e("parse-rect");t.exports=a,a.dashMult=2,a.maxPatternLength=256,a.precisionThreshold=3e6,a.maxPoints=1e4,a.maxLines=2048,a.shaders=new b,a.createShaders=function(e){var t=e.buffer({usage:"static",type:"float",data:[0,1,0,0,1,1,1,0]}),a={primitive:"triangle strip",instances:e.prop("count"),count:4,offset:0,uniforms:{miterMode:function(e,t){return"round"===t.join?2:1},miterLimit:e.prop("miterLimit"),scale:e.prop("scale"),scaleFract:e.prop("scaleFract"),translateFract:e.prop("translateFract"),translate:e.prop("translate"),thickness:e.prop("thickness"),dashPattern:e.prop("dashTexture"),opacity:e.prop("opacity"),pixelRatio:e.context("pixelRatio"),id:e.prop("id"),dashSize:e.prop("dashLength"),viewport:function(e,t){return[t.viewport.x,t.viewport.y,e.viewportWidth,e.viewportHeight]},depth:e.prop("depth")},blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:function(e,t){return!t.overlay}},stencil:{enable:!1},scissor:{enable:!0,box:e.prop("viewport")},viewport:e.prop("viewport")},o=e(d({vert:c(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aCoord, bCoord, aCoordFract, bCoordFract;\nattribute vec4 color;\nattribute float lineEnd, lineTop;\n\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float thickness, pixelRatio, id, depth;\nuniform vec4 viewport;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\n\nvec2 project(vec2 position, vec2 positionFract, vec2 scale, vec2 scaleFract, vec2 translate, vec2 translateFract) {\n\t// the order is important\n\treturn position * scale + translate\n       + positionFract * scale + translateFract\n       + position * scaleFract\n       + positionFract * scaleFract;\n}\n\nvoid main() {\n\tfloat lineStart = 1. - lineEnd;\n\tfloat lineOffset = lineTop * 2. - 1.;\n\n\tvec2 diff = (bCoord + bCoordFract - aCoord - aCoordFract);\n\ttangent = normalize(diff * scale * viewport.zw);\n\tvec2 normal = vec2(-tangent.y, tangent.x);\n\n\tvec2 position = project(aCoord, aCoordFract, scale, scaleFract, translate, translateFract) * lineStart\n\t\t+ project(bCoord, bCoordFract, scale, scaleFract, translate, translateFract) * lineEnd\n\n\t\t+ thickness * normal * .5 * lineOffset / viewport.zw;\n\n\tgl_Position = vec4(position * 2.0 - 1.0, depth, 1);\n\n\tfragColor = color / 255.;\n}\n"]),frag:c(["precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D dashPattern;\n\nuniform float dashSize, pixelRatio, thickness, opacity, id;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\n\nvoid main() {\n\tfloat alpha = 1.;\n\n\tfloat t = fract(dot(tangent, gl_FragCoord.xy) / dashSize) * .5 + .25;\n\tfloat dash = texture2D(dashPattern, vec2(t, .5)).r;\n\n\tgl_FragColor = fragColor;\n\tgl_FragColor.a *= alpha * opacity * dash;\n}\n"]),attributes:{lineEnd:{buffer:t,divisor:0,stride:8,offset:0},lineTop:{buffer:t,divisor:0,stride:8,offset:4},aCoord:{buffer:e.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:e.prop("positionBuffer"),stride:8,offset:16,divisor:1},aCoordFract:{buffer:e.prop("positionFractBuffer"),stride:8,offset:8,divisor:1},bCoordFract:{buffer:e.prop("positionFractBuffer"),stride:8,offset:16,divisor:1},color:{buffer:e.prop("colorBuffer"),stride:4,offset:0,divisor:1}}},a)),r;try{r=e(d({cull:{enable:!0,face:"back"},vert:c(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aCoord, bCoord, nextCoord, prevCoord;\nattribute vec4 aColor, bColor;\nattribute float lineEnd, lineTop;\n\nuniform vec2 scale, translate;\nuniform float thickness, pixelRatio, id, depth;\nuniform vec4 viewport;\nuniform float miterLimit, miterMode;\n\nvarying vec4 fragColor;\nvarying vec4 startCutoff, endCutoff;\nvarying vec2 tangent;\nvarying vec2 startCoord, endCoord;\nvarying float enableStartMiter, enableEndMiter;\n\nconst float REVERSE_THRESHOLD = -.875;\nconst float MIN_DIFF = 1e-6;\n\n// TODO: possible optimizations: avoid overcalculating all for vertices and calc just one instead\n// TODO: precalculate dot products, normalize things beforehead etc.\n// TODO: refactor to rectangular algorithm\n\nfloat distToLine(vec2 p, vec2 a, vec2 b) {\n\tvec2 diff = b - a;\n\tvec2 perp = normalize(vec2(-diff.y, diff.x));\n\treturn dot(p - a, perp);\n}\n\nbool isNaN( float val ){\n  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;\n}\n\nvoid main() {\n\tvec2 aCoord = aCoord, bCoord = bCoord, prevCoord = prevCoord, nextCoord = nextCoord;\n\n  vec2 adjustedScale;\n  adjustedScale.x = (abs(scale.x) < MIN_DIFF) ? MIN_DIFF : scale.x;\n  adjustedScale.y = (abs(scale.y) < MIN_DIFF) ? MIN_DIFF : scale.y;\n\n  vec2 scaleRatio = adjustedScale * viewport.zw;\n\tvec2 normalWidth = thickness / scaleRatio;\n\n\tfloat lineStart = 1. - lineEnd;\n\tfloat lineBot = 1. - lineTop;\n\n\tfragColor = (lineStart * aColor + lineEnd * bColor) / 255.;\n\n\tif (isNaN(aCoord.x) || isNaN(aCoord.y) || isNaN(bCoord.x) || isNaN(bCoord.y)) return;\n\n\tif (aCoord == prevCoord) prevCoord = aCoord + normalize(bCoord - aCoord);\n\tif (bCoord == nextCoord) nextCoord = bCoord - normalize(bCoord - aCoord);\n\n\tvec2 prevDiff = aCoord - prevCoord;\n\tvec2 currDiff = bCoord - aCoord;\n\tvec2 nextDiff = nextCoord - bCoord;\n\n\tvec2 prevTangent = normalize(prevDiff * scaleRatio);\n\tvec2 currTangent = normalize(currDiff * scaleRatio);\n\tvec2 nextTangent = normalize(nextDiff * scaleRatio);\n\n\tvec2 prevNormal = vec2(-prevTangent.y, prevTangent.x);\n\tvec2 currNormal = vec2(-currTangent.y, currTangent.x);\n\tvec2 nextNormal = vec2(-nextTangent.y, nextTangent.x);\n\n\tvec2 startJoinDirection = normalize(prevTangent - currTangent);\n\tvec2 endJoinDirection = normalize(currTangent - nextTangent);\n\n\t// collapsed/unidirectional segment cases\n\t// FIXME: there should be more elegant solution\n\tvec2 prevTanDiff = abs(prevTangent - currTangent);\n\tvec2 nextTanDiff = abs(nextTangent - currTangent);\n\tif (max(prevTanDiff.x, prevTanDiff.y) < MIN_DIFF) {\n\t\tstartJoinDirection = currNormal;\n\t}\n\tif (max(nextTanDiff.x, nextTanDiff.y) < MIN_DIFF) {\n\t\tendJoinDirection = currNormal;\n\t}\n\tif (aCoord == bCoord) {\n\t\tendJoinDirection = startJoinDirection;\n\t\tcurrNormal = prevNormal;\n\t\tcurrTangent = prevTangent;\n\t}\n\n\ttangent = currTangent;\n\n\t//calculate join shifts relative to normals\n\tfloat startJoinShift = dot(currNormal, startJoinDirection);\n\tfloat endJoinShift = dot(currNormal, endJoinDirection);\n\n\tfloat startMiterRatio = abs(1. / startJoinShift);\n\tfloat endMiterRatio = abs(1. / endJoinShift);\n\n\tvec2 startJoin = startJoinDirection * startMiterRatio;\n\tvec2 endJoin = endJoinDirection * endMiterRatio;\n\n\tvec2 startTopJoin, startBotJoin, endTopJoin, endBotJoin;\n\tstartTopJoin = sign(startJoinShift) * startJoin * .5;\n\tstartBotJoin = -startTopJoin;\n\n\tendTopJoin = sign(endJoinShift) * endJoin * .5;\n\tendBotJoin = -endTopJoin;\n\n\tvec2 aTopCoord = aCoord + normalWidth * startTopJoin;\n\tvec2 bTopCoord = bCoord + normalWidth * endTopJoin;\n\tvec2 aBotCoord = aCoord + normalWidth * startBotJoin;\n\tvec2 bBotCoord = bCoord + normalWidth * endBotJoin;\n\n\t//miter anti-clipping\n\tfloat baClipping = distToLine(bCoord, aCoord, aBotCoord) / dot(normalize(normalWidth * endBotJoin), normalize(normalWidth.yx * vec2(-startBotJoin.y, startBotJoin.x)));\n\tfloat abClipping = distToLine(aCoord, bCoord, bTopCoord) / dot(normalize(normalWidth * startBotJoin), normalize(normalWidth.yx * vec2(-endBotJoin.y, endBotJoin.x)));\n\n\t//prevent close to reverse direction switch\n\tbool prevReverse = dot(currTangent, prevTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, prevNormal)) * min(length(prevDiff), length(currDiff)) <  length(normalWidth * currNormal);\n\tbool nextReverse = dot(currTangent, nextTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, nextNormal)) * min(length(nextDiff), length(currDiff)) <  length(normalWidth * currNormal);\n\n\tif (prevReverse) {\n\t\t//make join rectangular\n\t\tvec2 miterShift = normalWidth * startJoinDirection * miterLimit * .5;\n\t\tfloat normalAdjust = 1. - min(miterLimit / startMiterRatio, 1.);\n\t\taBotCoord = aCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;\n\t\taTopCoord = aCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;\n\t}\n\telse if (!nextReverse && baClipping > 0. && baClipping < length(normalWidth * endBotJoin)) {\n\t\t//handle miter clipping\n\t\tbTopCoord -= normalWidth * endTopJoin;\n\t\tbTopCoord += normalize(endTopJoin * normalWidth) * baClipping;\n\t}\n\n\tif (nextReverse) {\n\t\t//make join rectangular\n\t\tvec2 miterShift = normalWidth * endJoinDirection * miterLimit * .5;\n\t\tfloat normalAdjust = 1. - min(miterLimit / endMiterRatio, 1.);\n\t\tbBotCoord = bCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;\n\t\tbTopCoord = bCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;\n\t}\n\telse if (!prevReverse && abClipping > 0. && abClipping < length(normalWidth * startBotJoin)) {\n\t\t//handle miter clipping\n\t\taBotCoord -= normalWidth * startBotJoin;\n\t\taBotCoord += normalize(startBotJoin * normalWidth) * abClipping;\n\t}\n\n\tvec2 aTopPosition = (aTopCoord) * adjustedScale + translate;\n\tvec2 aBotPosition = (aBotCoord) * adjustedScale + translate;\n\n\tvec2 bTopPosition = (bTopCoord) * adjustedScale + translate;\n\tvec2 bBotPosition = (bBotCoord) * adjustedScale + translate;\n\n\t//position is normalized 0..1 coord on the screen\n\tvec2 position = (aTopPosition * lineTop + aBotPosition * lineBot) * lineStart + (bTopPosition * lineTop + bBotPosition * lineBot) * lineEnd;\n\n\tstartCoord = aCoord * scaleRatio + translate * viewport.zw + viewport.xy;\n\tendCoord = bCoord * scaleRatio + translate * viewport.zw + viewport.xy;\n\n\tgl_Position = vec4(position  * 2.0 - 1.0, depth, 1);\n\n\tenableStartMiter = step(dot(currTangent, prevTangent), .5);\n\tenableEndMiter = step(dot(currTangent, nextTangent), .5);\n\n\t//bevel miter cutoffs\n\tif (miterMode == 1.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tvec2 startMiterWidth = vec2(startJoinDirection) * thickness * miterLimit * .5;\n\t\t\tstartCutoff = vec4(aCoord, aCoord);\n\t\t\tstartCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;\n\t\t\tstartCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tstartCutoff += viewport.xyxy;\n\t\t\tstartCutoff += startMiterWidth.xyxy;\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tvec2 endMiterWidth = vec2(endJoinDirection) * thickness * miterLimit * .5;\n\t\t\tendCutoff = vec4(bCoord, bCoord);\n\t\t\tendCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;\n\t\t\tendCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tendCutoff += viewport.xyxy;\n\t\t\tendCutoff += endMiterWidth.xyxy;\n\t\t}\n\t}\n\n\t//round miter cutoffs\n\telse if (miterMode == 2.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tvec2 startMiterWidth = vec2(startJoinDirection) * thickness * abs(dot(startJoinDirection, currNormal)) * .5;\n\t\t\tstartCutoff = vec4(aCoord, aCoord);\n\t\t\tstartCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;\n\t\t\tstartCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tstartCutoff += viewport.xyxy;\n\t\t\tstartCutoff += startMiterWidth.xyxy;\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tvec2 endMiterWidth = vec2(endJoinDirection) * thickness * abs(dot(endJoinDirection, currNormal)) * .5;\n\t\t\tendCutoff = vec4(bCoord, bCoord);\n\t\t\tendCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;\n\t\t\tendCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tendCutoff += viewport.xyxy;\n\t\t\tendCutoff += endMiterWidth.xyxy;\n\t\t}\n\t}\n}\n"]),frag:c(["precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D dashPattern;\nuniform float dashSize, pixelRatio, thickness, opacity, id, miterMode;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\nvarying vec4 startCutoff, endCutoff;\nvarying vec2 startCoord, endCoord;\nvarying float enableStartMiter, enableEndMiter;\n\nfloat distToLine(vec2 p, vec2 a, vec2 b) {\n\tvec2 diff = b - a;\n\tvec2 perp = normalize(vec2(-diff.y, diff.x));\n\treturn dot(p - a, perp);\n}\n\nvoid main() {\n\tfloat alpha = 1., distToStart, distToEnd;\n\tfloat cutoff = thickness * .5;\n\n\t//bevel miter\n\tif (miterMode == 1.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tdistToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);\n\t\t\tif (distToStart < -1.) {\n\t\t\t\tdiscard;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\talpha *= min(max(distToStart + 1., 0.), 1.);\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tdistToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);\n\t\t\tif (distToEnd < -1.) {\n\t\t\t\tdiscard;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\talpha *= min(max(distToEnd + 1., 0.), 1.);\n\t\t}\n\t}\n\n\t// round miter\n\telse if (miterMode == 2.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tdistToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);\n\t\t\tif (distToStart < 0.) {\n\t\t\t\tfloat radius = length(gl_FragCoord.xy - startCoord);\n\n\t\t\t\tif(radius > cutoff + .5) {\n\t\t\t\t\tdiscard;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\talpha -= smoothstep(cutoff - .5, cutoff + .5, radius);\n\t\t\t}\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tdistToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);\n\t\t\tif (distToEnd < 0.) {\n\t\t\t\tfloat radius = length(gl_FragCoord.xy - endCoord);\n\n\t\t\t\tif(radius > cutoff + .5) {\n\t\t\t\t\tdiscard;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\talpha -= smoothstep(cutoff - .5, cutoff + .5, radius);\n\t\t\t}\n\t\t}\n\t}\n\n\tfloat t = fract(dot(tangent, gl_FragCoord.xy) / dashSize) * .5 + .25;\n\tfloat dash = texture2D(dashPattern, vec2(t, .5)).r;\n\n\tgl_FragColor = fragColor;\n\tgl_FragColor.a *= alpha * opacity * dash;\n}\n"]),attributes:{lineEnd:{buffer:t,divisor:0,stride:8,offset:0},lineTop:{buffer:t,divisor:0,stride:8,offset:4},aColor:{buffer:e.prop("colorBuffer"),stride:4,offset:0,divisor:1},bColor:{buffer:e.prop("colorBuffer"),stride:4,offset:4,divisor:1},prevCoord:{buffer:e.prop("positionBuffer"),stride:8,offset:0,divisor:1},aCoord:{buffer:e.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:e.prop("positionBuffer"),stride:8,offset:16,divisor:1},nextCoord:{buffer:e.prop("positionBuffer"),stride:8,offset:24,divisor:1}}},a))}catch(t){r=o}var i=e({primitive:"triangle",elements:function(e,t){return t.triangles},offset:0,vert:c(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 position, positionFract;\n\nuniform vec4 color;\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float pixelRatio, id;\nuniform vec4 viewport;\nuniform float opacity;\n\nvarying vec4 fragColor;\n\nconst float MAX_LINES = 256.;\n\nvoid main() {\n\tfloat depth = (MAX_LINES - 4. - id) / (MAX_LINES);\n\n\tvec2 position = position * scale + translate\n       + positionFract * scale + translateFract\n       + position * scaleFract\n       + positionFract * scaleFract;\n\n\tgl_Position = vec4(position * 2.0 - 1.0, depth, 1);\n\n\tfragColor = color / 255.;\n\tfragColor.a *= opacity;\n}\n"]),frag:c(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n\tgl_FragColor = fragColor;\n}\n"]),uniforms:{scale:e.prop("scale"),color:e.prop("fill"),scaleFract:e.prop("scaleFract"),translateFract:e.prop("translateFract"),translate:e.prop("translate"),opacity:e.prop("opacity"),pixelRatio:e.context("pixelRatio"),id:e.prop("id"),viewport:function(e,t){return[t.viewport.x,t.viewport.y,e.viewportWidth,e.viewportHeight]}},attributes:{position:{buffer:e.prop("positionBuffer"),stride:8,offset:8},positionFract:{buffer:e.prop("positionFractBuffer"),stride:8,offset:8}},blend:a.blend,depth:{enable:!1},scissor:a.scissor,stencil:a.stencil,viewport:a.viewport});return{fill:i,rect:o,miter:r}},a.defaults={dashes:null,join:"miter",miterLimit:1,thickness:10,cap:"square",color:"black",opacity:1,overlay:!1,viewport:null,range:null,close:!1,fill:null},a.prototype.render=function(){for(var e=[],t=arguments.length,a;t--;)e[t]=arguments[t];e.length&&(a=this).update.apply(a,e),this.draw()},a.prototype.draw=function(){for(var e=this,t=[],o=arguments.length;o--;)t[o]=arguments[o];return(t.length?t:this.passes).forEach(function(t){var o;return t&&Array.isArray(t)?(o=e).draw.apply(o,t):void(("number"==typeof t&&(t=e.passes[t]),!!(t&&1<t.count&&t.opacity))&&(e.regl._refresh(),t.fill&&t.triangles&&2<t.triangles.length&&e.shaders.fill(t),t.thickness&&(t.scale[0]*t.viewport.width>a.precisionThreshold||t.scale[1]*t.viewport.height>a.precisionThreshold?e.shaders.rect(t):"rect"===t.join||!t.join&&(2>=t.thickness||t.count>=a.maxPoints)?e.shaders.rect(t):e.shaders.miter(t))))}),this},a.prototype.update=function(e){var t=this;if(e){null==e.length?!Array.isArray(e)&&(e=[e]):"number"==typeof e[0]&&(e=[{positions:e}]);var o=this,h=o.regl,b=o.gl;if(e.forEach(function(e,w){var T=t.passes[w];if(void 0!==e){if(null===e)return void(t.passes[w]=null);if("number"==typeof e[0]&&(e={positions:e}),e=p(e,{positions:"positions points data coords",thickness:"thickness lineWidth lineWidths line-width linewidth width stroke-width strokewidth strokeWidth",join:"lineJoin linejoin join type mode",miterLimit:"miterlimit miterLimit",dashes:"dash dashes dasharray dash-array dashArray",color:"color colour stroke colors colours stroke-color strokeColor",fill:"fill fill-color fillColor",opacity:"alpha opacity",overlay:"overlay crease overlap intersect",close:"closed close closed-path closePath",range:"range dataBox",viewport:"viewport viewBox",hole:"holes hole hollow"}),T||(t.passes[w]=T={id:w,scale:null,scaleFract:null,translate:null,translateFract:null,count:0,hole:[],depth:0,dashLength:1,dashTexture:h.texture({channels:1,data:new Uint8Array([255]),width:1,height:1,mag:"linear",min:"linear"}),colorBuffer:h.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array}),positionBuffer:h.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),positionFractBuffer:h.buffer({usage:"dynamic",type:"float",data:new Uint8Array})},e=d({},a.defaults,e)),null!=e.thickness&&(T.thickness=parseFloat(e.thickness)),null!=e.opacity&&(T.opacity=parseFloat(e.opacity)),null!=e.miterLimit&&(T.miterLimit=parseFloat(e.miterLimit)),null!=e.overlay&&(T.overlay=!!e.overlay,w<a.maxLines&&(T.depth=2*(a.maxLines-1-w%a.maxLines)/a.maxLines-1)),null!=e.join&&(T.join=e.join),null!=e.hole&&(T.hole=e.hole),null!=e.fill&&(T.fill=e.fill?n(e.fill,"uint8"):null),null!=e.viewport&&(T.viewport=v(e.viewport)),T.viewport||(T.viewport=v([b.drawingBufferWidth,b.drawingBufferHeight])),null!=e.close&&(T.close=e.close),null===e.positions&&(e.positions=[]),e.positions){var A,S;if(e.positions.x&&e.positions.y){var C=e.positions.x,L=e.positions.y;S=T.count=r(C.length,L.length),A=new Float64Array(2*S);for(var E=0;E<S;E++)A[2*E]=C[E],A[2*E+1]=L[E]}else A=u(e.positions,"float64"),S=T.count=i(A.length/2);var I=T.bounds=s(A,2);if(T.fill){for(var P=[],z={},D=0,O=0,R=0,M=T.count;O<M;O++){var l=A[2*O],B=A[2*O+1];isNaN(l)||isNaN(B)||null==l||null==B?(l=A[2*D],B=A[2*D+1],z[O]=D):D=O,P[R++]=l,P[R++]=B}for(var F=g(P,T.hole||[]),N=0,V=F.length;N<V;N++)null!=z[F[N]]&&(F[N]=z[F[N]]);T.triangles=F}var U=new Float64Array(A);m(U,2,I);var H=new Float64Array(2*S+6);T.close?A[0]===A[2*S-2]&&A[1]===A[2*S-1]?(H[0]=U[2*S-4],H[1]=U[2*S-3]):(H[0]=U[2*S-2],H[1]=U[2*S-1]):(H[0]=U[0],H[1]=U[1]),H.set(U,2),T.close?A[0]===A[2*S-2]&&A[1]===A[2*S-1]?(H[2*S+2]=U[2],H[2*S+3]=U[3],T.count-=1):(H[2*S+2]=U[0],H[2*S+3]=U[1],H[2*S+4]=U[2],H[2*S+5]=U[3]):(H[2*S+2]=U[2*S-2],H[2*S+3]=U[2*S-1],H[2*S+4]=U[2*S-2],H[2*S+5]=U[2*S-1]),T.positionBuffer(f(H)),T.positionFractBuffer(_(H))}if(e.range?T.range=e.range:!T.range&&(T.range=T.bounds),(e.range||e.positions)&&T.count){var q=T.bounds,G=q[2]-q[0],Y=q[3]-q[1],W=T.range[2]-T.range[0],X=T.range[3]-T.range[1];T.scale=[G/W,Y/X],T.translate=[-T.range[0]/W+q[0]/W||0,-T.range[1]/X+q[1]/X||0],T.scaleFract=_(T.scale),T.translateFract=_(T.translate)}if(e.dashes){var Z=0,K;if(!e.dashes||2>e.dashes.length)Z=1,K=new Uint8Array([255,255,255,255,255,255,255,255]);else{Z=0;for(var $=0;$<e.dashes.length;++$)Z+=e.dashes[$];K=new Uint8Array(Z*a.dashMult);for(var J=0,Q=255,ee=0;2>ee;ee++)for(var te=0;te<e.dashes.length;++te){for(var ae=0,oe=.5*(e.dashes[te]*a.dashMult);ae<oe;++ae)K[J++]=Q;Q^=255}}T.dashLength=Z,T.dashTexture({channels:1,data:K,width:K.length,height:1,mag:"linear",min:"linear"},0,0)}if(e.color){var re=T.count,ie=e.color;ie||(ie="transparent");var ne=new Uint8Array(4*re+4);if(!Array.isArray(ie)||"number"==typeof ie[0])for(var le=n(ie,"uint8"),c=0;c<re+1;c++)ne.set(le,4*c);else{for(var se=0,de;se<re;se++)de=n(ie[se],"uint8"),ne.set(de,4*se);ne.set(n(ie[0],"uint8"),4*re)}T.colorBuffer({usage:"dynamic",type:"uint8",data:ne})}}}),e.length<this.passes.length){for(var l=e.length,c;l<this.passes.length;l++)(c=this.passes[l],!!c)&&(c.colorBuffer.destroy(),c.positionBuffer.destroy(),c.dashTexture.destroy());this.passes.length=e.length}for(var y=[],x=0;x<this.passes.length;x++)null!==this.passes[x]&&y.push(this.passes[x]);return this.passes=y,this}},a.prototype.destroy=function(){return this.passes.forEach(function(e){e.colorBuffer.destroy(),e.positionBuffer.destroy(),e.dashTexture.destroy()}),this.passes.length=0,this}},{"array-bounds":21,"array-normalize":22,"color-normalize":67,earcut:117,"es6-weak-map":184,"flatten-vertex-data":205,glslify:378,"object-assign":438,"parse-rect":443,"pick-by-alias":449,"to-float32":1310}],1267:[function(e,t){'use strict';var m=Math.ceil,h=Math.sqrt,y=Math.round,f=Math.min,x=Math.max,_=Math.floor;function a(e,t){return n(e)||s(e,t)||d(e,t)||u()}function o(e){return r(e)||l(e)||d(e)||p()}function r(e){if(Array.isArray(e))return c(e)}function n(e){if(Array.isArray(e))return e}function l(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function s(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var a=[],o=!0,r=!1,i=void 0;try{for(var n=e[Symbol.iterator](),l;!(o=(l=n.next()).done)&&(a.push(l.value),!(t&&a.length===t));o=!0);}catch(e){r=!0,i=e}finally{try{o||null==n["return"]||n["return"]()}finally{if(r)throw i}}return a}}function d(e,t){if(e){if("string"==typeof e)return c(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(a):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,o=Array(t);a<t;a++)o[a]=e[a];return o}function p(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function g(e,t){var a=this;if(!(this instanceof g))return new g(e,t);"function"==typeof e?(!t&&(t={}),t.regl=e):(t=e,e=null),t&&t.length&&(t.positions=t),e=t.regl;var o=e._gl,r=[],i=255,n;this.tooManyColors=E,n=e.texture({data:new Uint8Array(4*i),width:i,height:1,type:"uint8",format:"rgba",wrapS:"clamp",wrapT:"clamp",mag:"nearest",min:"nearest"}),T(this,{regl:e,gl:o,groups:[],markerCache:[null],markerTextures:[null],palette:r,paletteIds:{},paletteTexture:n,maxColors:i,maxSize:100,canvas:o.canvas}),this.update(t);var l={uniforms:{pixelRatio:e.context("pixelRatio"),palette:n,paletteSize:function(){return[a.tooManyColors?0:i,n.height]},scale:e.prop("scale"),scaleFract:e.prop("scaleFract"),translate:e.prop("translate"),translateFract:e.prop("translateFract"),opacity:e.prop("opacity"),marker:e.prop("markerTexture")},attributes:{x:function(e,t){return t.xAttr||{buffer:t.positionBuffer,stride:8,offset:0}},y:function(e,t){return t.yAttr||{buffer:t.positionBuffer,stride:8,offset:4}},xFract:function(e,t){return t.xAttr?{constant:[0,0]}:{buffer:t.positionFractBuffer,stride:8,offset:0}},yFract:function(e,t){return t.yAttr?{constant:[0,0]}:{buffer:t.positionFractBuffer,stride:8,offset:4}},size:function(e,t){return t.size.length?{buffer:t.sizeBuffer,stride:2,offset:0}:{constant:[y(255*t.size/a.maxSize)]}},borderSize:function(e,t){return t.borderSize.length?{buffer:t.sizeBuffer,stride:2,offset:1}:{constant:[y(255*t.borderSize/a.maxSize)]}},colorId:function(e,t){return t.color.length?{buffer:t.colorBuffer,stride:a.tooManyColors?8:4,offset:0}:{constant:a.tooManyColors?r.slice(4*t.color,4*t.color+4):[t.color]}},borderColorId:function(e,t){return t.borderColor.length?{buffer:t.colorBuffer,stride:a.tooManyColors?8:4,offset:a.tooManyColors?4:2}:{constant:a.tooManyColors?r.slice(4*t.borderColor,4*t.borderColor+4):[t.borderColor]}},isActive:function(e,t){return!0===t.activation?{constant:[1]}:t.activation?t.activation:{constant:[0]}}},blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},scissor:{enable:!0,box:e.prop("viewport")},viewport:e.prop("viewport"),stencil:{enable:!1},depth:{enable:!1},elements:e.prop("elements"),count:e.prop("count"),offset:e.prop("offset"),primitive:"points"},s=T({},l);s.frag=A(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragWidth, fragBorderColorLevel, fragColorLevel;\n\nuniform sampler2D marker;\nuniform float pixelRatio, opacity;\n\nfloat smoothStep(float x, float y) {\n  return 1.0 / (1.0 + exp(50.0*(x - y)));\n}\n\nvoid main() {\n  float dist = texture2D(marker, gl_PointCoord).r, delta = fragWidth;\n\n  // max-distance alpha\n  if (dist < 0.003) discard;\n\n  // null-border case\n  if (fragBorderColorLevel == fragColorLevel || fragBorderColor.a == 0.) {\n    float colorAmt = smoothstep(.5 - delta, .5 + delta, dist);\n    gl_FragColor = vec4(fragColor.rgb, colorAmt * fragColor.a * opacity);\n  }\n  else {\n    float borderColorAmt = smoothstep(fragBorderColorLevel - delta, fragBorderColorLevel + delta, dist);\n    float colorAmt = smoothstep(fragColorLevel - delta, fragColorLevel + delta, dist);\n\n    vec4 color = fragBorderColor;\n    color.a *= borderColorAmt;\n    color = mix(color, fragColor, colorAmt);\n    color.a *= opacity;\n\n    gl_FragColor = color;\n  }\n\n}\n"]),s.vert=A(["precision highp float;\n#define GLSLIFY 1\n\nattribute float x, y, xFract, yFract;\nattribute float size, borderSize;\nattribute vec4 colorId, borderColorId;\nattribute float isActive;\n\nuniform vec2 scale, scaleFract, translate, translateFract, paletteSize;\nuniform float pixelRatio;\nuniform sampler2D palette;\n\nconst float maxSize = 100.;\nconst float borderLevel = .5;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragPointSize, fragBorderRadius, fragWidth, fragBorderColorLevel, fragColorLevel;\n\nbool isDirect = (paletteSize.x < 1.);\n\nvec4 getColor(vec4 id) {\n  return isDirect ? id / 255. : texture2D(palette,\n    vec2(\n      (id.x + .5) / paletteSize.x,\n      (id.y + .5) / paletteSize.y\n    )\n  );\n}\n\nvoid main() {\n  if (isActive == 0.) return;\n\n  vec2 position = vec2(x, y);\n  vec2 positionFract = vec2(xFract, yFract);\n\n  vec4 color = getColor(colorId);\n  vec4 borderColor = getColor(borderColorId);\n\n  float size = size * maxSize / 255.;\n  float borderSize = borderSize * maxSize / 255.;\n\n  gl_PointSize = 2. * size * pixelRatio;\n  fragPointSize = size * pixelRatio;\n\n  vec2 pos = (position + translate) * scale\n      + (positionFract + translateFract) * scale\n      + (position + translate) * scaleFract\n      + (positionFract + translateFract) * scaleFract;\n\n  gl_Position = vec4(pos * 2. - 1., 0, 1);\n\n  fragColor = color;\n  fragBorderColor = borderColor;\n  fragWidth = 1. / gl_PointSize;\n\n  fragBorderColorLevel = clamp(borderLevel - borderLevel * borderSize / size, 0., 1.);\n  fragColorLevel = clamp(borderLevel + (1. - borderLevel) * borderSize / size, 0., 1.);\n}"]),this.drawMarker=e(s);var d=T({},l);d.frag=A(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor, fragBorderColor;\n\nuniform float opacity;\nvarying float fragBorderRadius, fragWidth;\n\nfloat smoothStep(float edge0, float edge1, float x) {\n\tfloat t;\n\tt = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n\treturn t * t * (3.0 - 2.0 * t);\n}\n\nvoid main() {\n\tfloat radius, alpha = 1.0, delta = fragWidth;\n\n\tradius = length(2.0 * gl_PointCoord.xy - 1.0);\n\n\tif (radius > 1.0 + delta) {\n\t\tdiscard;\n\t}\n\n\talpha -= smoothstep(1.0 - delta, 1.0 + delta, radius);\n\n\tfloat borderRadius = fragBorderRadius;\n\tfloat ratio = smoothstep(borderRadius - delta, borderRadius + delta, radius);\n\tvec4 color = mix(fragColor, fragBorderColor, ratio);\n\tcolor.a *= alpha * opacity;\n\tgl_FragColor = color;\n}\n"]),d.vert=A(["precision highp float;\n#define GLSLIFY 1\n\nattribute float x, y, xFract, yFract;\nattribute float size, borderSize;\nattribute vec4 colorId, borderColorId;\nattribute float isActive;\n\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float pixelRatio;\nuniform sampler2D palette;\nuniform vec2 paletteSize;\n\nconst float maxSize = 100.;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragBorderRadius, fragWidth;\n\nbool isDirect = (paletteSize.x < 1.);\n\nvec4 getColor(vec4 id) {\n  return isDirect ? id / 255. : texture2D(palette,\n    vec2(\n      (id.x + .5) / paletteSize.x,\n      (id.y + .5) / paletteSize.y\n    )\n  );\n}\n\nvoid main() {\n  // ignore inactive points\n  if (isActive == 0.) return;\n\n  vec2 position = vec2(x, y);\n  vec2 positionFract = vec2(xFract, yFract);\n\n  vec4 color = getColor(colorId);\n  vec4 borderColor = getColor(borderColorId);\n\n  float size = size * maxSize / 255.;\n  float borderSize = borderSize * maxSize / 255.;\n\n  gl_PointSize = (size + borderSize) * pixelRatio;\n\n  vec2 pos = (position + translate) * scale\n      + (positionFract + translateFract) * scale\n      + (position + translate) * scaleFract\n      + (positionFract + translateFract) * scaleFract;\n\n  gl_Position = vec4(pos * 2. - 1., 0, 1);\n\n  fragBorderRadius = 1. - 2. * borderSize / (size + borderSize);\n  fragColor = color;\n  fragBorderColor = borderColor.a == 0. || borderSize == 0. ? vec4(color.rgb, 0.) : borderColor;\n  fragWidth = 1. / gl_PointSize;\n}\n"]),E&&(d.frag=d.frag.replace("smoothstep","smoothStep"),s.frag=s.frag.replace("smoothstep","smoothStep")),this.drawCircle=e(d)}var b=e("color-normalize"),v=e("array-bounds"),w=e("color-id"),k=e("point-cluster"),T=e("object-assign"),A=e("glslify"),S=e("pick-by-alias"),C=e("update-diff"),L=e("flatten-vertex-data"),E=e("is-iexplorer"),i=e("to-float32"),I=e("parse-rect");g.defaults={color:"black",borderColor:"transparent",borderSize:0,size:12,opacity:1,marker:void 0,viewport:null,range:null,pixelSize:null,count:0,offset:0,bounds:null,positions:[],snap:1e4},g.prototype.render=function(){return arguments.length&&this.update.apply(this,arguments),this.draw(),this},g.prototype.draw=function(){for(var e=this,t=arguments.length,a=Array(t),o=0;o<t;o++)a[o]=arguments[o];var r=this.groups;if(1===a.length&&Array.isArray(a[0])&&(null===a[0][0]||Array.isArray(a[0][0]))&&(a=a[0]),this.regl._refresh(),a.length)for(var n=0;n<a.length;n++)this.drawItem(n,a[n]);else r.forEach(function(t,a){e.drawItem(a)});return this},g.prototype.drawItem=function(e,t){var a=this.groups,r=a[e];if("number"==typeof t&&(e=t,r=a[t],t=null),!!(r&&r.count&&r.opacity)){r.activation[0]&&this.drawCircle(this.getMarkerDrawOptions(0,r,t));for(var n=[],l=1;l<r.activation.length;l++)r.activation[l]&&(!0===r.activation[l]||r.activation[l].data.length)&&n.push.apply(n,o(this.getMarkerDrawOptions(l,r,t)));n.length&&this.drawMarker(n)}},g.prototype.getMarkerDrawOptions=function(e,t,o){var r=t.range,n=t.tree,s=t.viewport,d=t.activation,c=t.selectionBuffer,p=t.count,u=this.regl;if(!n)return o?[T({},t,{markerTexture:this.markerTextures[e],activation:d[e],count:o.length,elements:o,offset:0})]:[T({},t,{markerTexture:this.markerTextures[e],activation:d[e],offset:0})];var g=[],m=n.range(r,{lod:!0,px:[(r[2]-r[0])/s.width,(r[3]-r[1])/s.height]});if(o){for(var h=d[e],y=h.data,f=new Uint8Array(p),x=0,_;x<o.length;x++)_=o[x],f[_]=y?y[_]:1;c.subdata(f)}for(var b=m.length;b--;){var v=a(m[b],2),w=v[0],k=v[1];g.push(T({},t,{markerTexture:this.markerTextures[e],activation:o?c:d[e],offset:w,count:k-w}))}return g},g.prototype.update=function(){for(var e=this,t=arguments.length,a=Array(t),o=0;o<t;o++)a[o]=arguments[o];if(a.length){1===a.length&&Array.isArray(a[0])&&(a=a[0]);var r=this.groups,n=this.gl,l=this.regl,s=this.maxSize,d=this.maxColors,c=this.palette;this.groups=r=a.map(function(t,a){var o=r[a];if(void 0===t)return o;null===t?t={positions:null}:"function"==typeof t?t={ondraw:t}:"number"==typeof t[0]&&(t={positions:t}),t=S(t,{positions:"positions data points",snap:"snap cluster lod tree",size:"sizes size radius",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",color:"colors color fill fill-color fillColor",borderColor:"borderColors borderColor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range dataBox databox",viewport:"viewport viewPort viewBox viewbox",opacity:"opacity alpha transparency",bounds:"bound bounds boundaries limits",tooManyColors:"tooManyColors palette paletteMode optimizePalette enablePalette"}),null===t.positions&&(t.positions=[]),null!=t.tooManyColors&&(e.tooManyColors=t.tooManyColors),o||(r[a]=o={id:a,scale:null,translate:null,scaleFract:null,translateFract:null,activation:[],selectionBuffer:l.buffer({data:new Uint8Array(0),usage:"stream",type:"uint8"}),sizeBuffer:l.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),colorBuffer:l.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),positionBuffer:l.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"}),positionFractBuffer:l.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"})},t=T({},g.defaults,t)),t.positions&&!("marker"in t)&&(t.marker=o.marker,delete o.marker),t.marker&&!("positions"in t)&&(t.positions=o.positions,delete o.positions);var p=0,u=0;if(C(o,t,[{snap:!0,size:function(e){return null==e&&(e=g.defaults.size),p+=e&&e.length?1:0,e},borderSize:function(e){return null==e&&(e=g.defaults.borderSize),p+=e&&e.length?1:0,e},opacity:parseFloat,color:function(t){return null==t&&(t=g.defaults.color),t=e.updateColor(t),u++,t},borderColor:function(t){return null==t&&(t=g.defaults.borderColor),t=e.updateColor(t),u++,t},bounds:function(e,t,a){return"range"in a||(a.range=null),e},positions:function(e,t,a){var o=t.snap,r=t.positionBuffer,n=t.positionFractBuffer,s=t.selectionBuffer;if(e.x||e.y)return t.xAttr=e.x.length?{buffer:l.buffer(e.x),offset:0,stride:4,count:e.x.length}:{buffer:e.x.buffer,offset:4*e.x.offset||0,stride:4*(e.x.stride||1),count:e.x.count},t.yAttr=e.y.length?{buffer:l.buffer(e.y),offset:0,stride:4,count:e.y.length}:{buffer:e.y.buffer,offset:4*e.y.offset||0,stride:4*(e.y.stride||1),count:e.y.count},t.count=x(t.xAttr.count,t.yAttr.count),e;e=L(e,"float64");var d=t.count=_(e.length/2),c=t.bounds=d?v(e,2):null;if(a.range||t.range||(delete t.range,a.range=c),a.marker||t.marker||(delete t.marker,a.marker=null),o&&(!0===o||d>o)?t.tree=k(e,{bounds:c}):o&&o.length&&(t.tree=o),t.tree){var p={primitive:"points",usage:"static",data:t.tree,type:"uint32"};t.elements?t.elements(p):t.elements=l.elements(p)}return r({data:i.float(e),usage:"dynamic"}),n({data:i.fract(e),usage:"dynamic"}),s({data:new Uint8Array(d),type:"uint8",usage:"stream"}),e}},{marker:function(t,a){var o=a.activation;if(o.forEach(function(e){return e&&e.destroy&&e.destroy()}),o.length=0,!t||"number"==typeof t[0]){var r=e.addMarker(t);o[r]=!0}else{for(var i=[],n=0,s=f(t.length,a.count),d;n<s;n++)d=e.addMarker(t[n]),i[d]||(i[d]=new Uint8Array(a.count)),i[d][n]=1;for(var c=0;c<i.length;c++)if(i[c]){var p={data:i[c],type:"uint8",usage:"static"};o[c]?o[c](p):o[c]=l.buffer(p),o[c].data=i[c]}}return t},range:function(e,t){var a=t.bounds;if(a)return e||(e=a),t.scale=[1/(e[2]-e[0]),1/(e[3]-e[1])],t.translate=[-e[0],-e[1]],t.scaleFract=i.fract(t.scale),t.translateFract=i.fract(t.translate),e},viewport:function(e){var t=I(e||[n.drawingBufferWidth,n.drawingBufferHeight]);return t}}]),p){var m=o,h=m.count,b=m.size,w=m.borderSize,A=m.sizeBuffer,E=new Uint8Array(2*h);if(b.length||w.length)for(var P=0;P<h;P++)E[2*P]=y(255*(null==b[P]?b:b[P])/s),E[2*P+1]=y(255*(null==w[P]?w:w[P])/s);A({data:E,usage:"dynamic"})}if(u){var z=o,D=z.count,O=z.color,R=z.borderColor,M=z.colorBuffer,j;if(e.tooManyColors){if(O.length||R.length){j=new Uint8Array(8*D);for(var B=0,F;B<D;B++){F=O[B],j[8*B]=c[4*F],j[8*B+1]=c[4*F+1],j[8*B+2]=c[4*F+2],j[8*B+3]=c[4*F+3];var N=R[B];j[8*B+4]=c[4*N],j[8*B+5]=c[4*N+1],j[8*B+6]=c[4*N+2],j[8*B+7]=c[4*N+3]}}}else if(O.length||R.length){j=new Uint8Array(4*D+2);for(var V=0;V<D;V++)null!=O[V]&&(j[4*V]=O[V]%d,j[4*V+1]=_(O[V]/d)),null!=R[V]&&(j[4*V+2]=R[V]%d,j[4*V+3]=_(R[V]/d))}M({data:j||new Uint8Array(0),type:"uint8",usage:"dynamic"})}return o})}},g.prototype.addMarker=function(e){var t=this.markerTextures,a=this.regl,o=this.markerCache,r=null==e?0:o.indexOf(e);if(0<=r)return r;var n;if(e instanceof Uint8Array||e instanceof Uint8ClampedArray)n=e;else{n=new Uint8Array(e.length);for(var s=0,d=e.length;s<d;s++)n[s]=255*e[s]}var l=_(h(n.length));return r=t.length,o.push(e),t.push(a.texture({channels:1,data:n,radius:l,mag:"linear",min:"linear"})),r},g.prototype.updateColor=function(e){var t=this.paletteIds,a=this.palette,o=this.maxColors;Array.isArray(e)||(e=[e]);var r=[];if("number"==typeof e[0]){var n=[];if(Array.isArray(e))for(var l=0;l<e.length;l+=4)n.push(e.slice(l,l+4));else for(var s=0;s<e.length;s+=4)n.push(e.subarray(s,s+4));e=n}for(var d=0,c;d<e.length;d++){c=e[d],c=b(c,"uint8");var p=w(c,!1);if(null==t[p]){var u=a.length;t[p]=_(u/4),a[u]=c[0],a[u+1]=c[1],a[u+2]=c[2],a[u+3]=c[3]}r[d]=t[p]}return!this.tooManyColors&&a.length>4*o&&(this.tooManyColors=!0),this.updatePalette(a),1===r.length?r[0]:r},g.prototype.updatePalette=function(e){if(!this.tooManyColors){var t=this.maxColors,a=this.paletteTexture,o=m(.25*e.length/t);if(1<o){e=e.slice();for(var r=.25*e.length%t;r<o*t;r++)e.push(0,0,0,0)}a.height<o&&a.resize(t,o),a.subimage({width:f(.25*e.length,t),height:o,data:e},0,0)}},g.prototype.destroy=function(){return this.groups.forEach(function(e){e.sizeBuffer.destroy(),e.positionBuffer.destroy(),e.positionFractBuffer.destroy(),e.colorBuffer.destroy(),e.activation.forEach(function(e){return e&&e.destroy&&e.destroy()}),e.selectionBuffer.destroy(),e.elements&&e.elements.destroy()}),this.groups.length=0,this.paletteTexture.destroy(),this.markerTextures.forEach(function(e){return e&&e.destroy&&e.destroy()}),this};var P=e("object-assign");t.exports=function(e,t){var a=new g(e,t),o=a.render.bind(a);return P(o,{render:o,update:a.update.bind(a),draw:a.draw.bind(a),destroy:a.destroy.bind(a),regl:a.regl,gl:a.gl,canvas:a.gl.canvas,groups:a.groups,markers:a.markerCache,palette:a.palette}),o}},{"array-bounds":21,"color-id":65,"color-normalize":67,"flatten-vertex-data":205,glslify:378,"is-iexplorer":388,"object-assign":438,"parse-rect":443,"pick-by-alias":449,"point-cluster":1245,"to-float32":1310,"update-diff":1334}],1268:[function(e,t){'use strict';function a(e,t){return this instanceof a?void(this.traces=[],this.passes={},this.regl=e,this.scatter=s(e),this.canvas=this.scatter.canvas):new a(e,t)}function r(e,t,a){var o=null==e.id?e:e.id;return o<<16|(255&t)<<8|255&a}function i(e,t,a){var o=e[t],r=e[a],i,n,l,s,d,c,p,u;return 2<o.length?(i=o[0],l=o[2],n=o[1],s=o[3]):o.length?(i=n=o[0],l=s=o[1]):(i=o.x,n=o.y,l=o.x+o.width,s=o.y+o.height),2<r.length?(d=r[0],p=r[2],c=r[1],u=r[3]):r.length?(d=c=r[0],p=u=r[1]):(d=r.x,c=r.y,p=r.x+r.width,u=r.y+r.height),[d,n,p,s]}function l(e){if("number"==typeof e)return[e,e,e,e];if(2===e.length)return[e[0],e[1],e[0],e[1]];var t=g(e);return[t.x,t.y,t.x+t.width,t.y+t.height]}var s=e("regl-scatter2d"),d=e("pick-by-alias"),c=e("array-bounds"),p=e("raf"),u=e("array-range"),g=e("parse-rect"),m=e("flatten-vertex-data");t.exports=a,a.prototype.render=function(){for(var e=this,t=[],a=arguments.length,o;a--;)t[a]=arguments[a];return(t.length&&(o=this).update.apply(o,t),this.regl.attributes.preserveDrawingBuffer)?this.draw():(this.dirty?null==this.planned&&(this.planned=p(function(){e.draw(),e.dirty=!0,e.planned=null})):(this.draw(),this.dirty=!0,p(function(){e.dirty=!1})),this)},a.prototype.update=function(){for(var e=[],t=arguments.length,a;t--;)e[t]=arguments[t];if(e.length){for(var o=0;o<e.length;o++)this.updateItem(o,e[o]);this.traces=this.traces.filter(Boolean);for(var r=[],n=0,l=0;l<this.traces.length;l++){for(var s=this.traces[l],d=this.traces[l].passes,c=0;c<d.length;c++)r.push(this.passes[d[c]]);s.passOffset=n,n+=s.passes.length}return(a=this.scatter).update.apply(a,r),this}},a.prototype.updateItem=function(e,t){var a=this,s=a.regl;if(null===t)return this.traces[e]=null,this;if(!t)return this;var p=d(t,{data:"data items columns rows values dimensions samples x",snap:"snap cluster",size:"sizes size radius",color:"colors color fill fill-color fillColor",opacity:"opacity alpha transparency opaque",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",borderColor:"borderColors borderColor bordercolor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range ranges databox dataBox",viewport:"viewport viewBox viewbox",domain:"domain domains area areas",padding:"pad padding paddings pads margin margins",transpose:"transpose transposed",diagonal:"diagonal diag showDiagonal",upper:"upper up top upperhalf upperHalf showupperhalf showUpper showUpperHalf",lower:"lower low bottom lowerhalf lowerHalf showlowerhalf showLowerHalf showLower"}),o=this.traces[e]||(this.traces[e]={id:e,buffer:s.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),color:"black",marker:null,size:12,borderColor:"transparent",borderSize:1,viewport:g([s._gl.drawingBufferWidth,s._gl.drawingBufferHeight]),padding:[0,0,0,0],opacity:1,diagonal:!0,upper:!0,lower:!0});if(null!=p.color&&(o.color=p.color),null!=p.size&&(o.size=p.size),null!=p.marker&&(o.marker=p.marker),null!=p.borderColor&&(o.borderColor=p.borderColor),null!=p.borderSize&&(o.borderSize=p.borderSize),null!=p.opacity&&(o.opacity=p.opacity),p.viewport&&(o.viewport=g(p.viewport)),null!=p.diagonal&&(o.diagonal=p.diagonal),null!=p.upper&&(o.upper=p.upper),null!=p.lower&&(o.lower=p.lower),p.data){o.buffer(m(p.data)),o.columns=p.data.length,o.count=p.data[0].length,o.bounds=[];for(var u=0;u<o.columns;u++)o.bounds[u]=c(p.data[u],1)}var y;p.range&&(o.range=p.range,y=o.range&&"number"!=typeof o.range[0]),p.domain&&(o.domain=p.domain);var f=!1;null!=p.padding&&(Array.isArray(p.padding)&&p.padding.length===o.columns&&"number"==typeof p.padding[p.padding.length-1]?(o.padding=p.padding.map(l),f=!0):o.padding=l(p.padding));var x=o.columns,_=o.count,n=o.viewport.width,b=o.viewport.height,h=o.viewport.x,v=o.viewport.y,w=n/x,k=b/x;o.passes=[];for(var T=0;T<x;T++)for(var A=0;A<x;A++)if((o.diagonal||A!==T)&&(o.upper||!(T>A))&&(o.lower||!(T<A))){var S=r(o.id,T,A),C=this.passes[S]||(this.passes[S]={});if(p.data&&(C.positions=p.transpose?{x:{buffer:o.buffer,offset:A,count:_,stride:x},y:{buffer:o.buffer,offset:T,count:_,stride:x}}:{x:{buffer:o.buffer,offset:A*_,count:_},y:{buffer:o.buffer,offset:T*_,count:_}},C.bounds=i(o.bounds,T,A)),p.domain||p.viewport||p.data){var L=f?i(o.padding,T,A):o.padding;if(o.domain){var E=i(o.domain,T,A),I=E[0],P=E[1],z=E[2],D=E[3];C.viewport=[h+I*n+L[0],v+P*b+L[1],h+z*n-L[2],v+D*b-L[3]]}else C.viewport=[h+A*w+w*L[0],v+T*k+k*L[1],h+(A+1)*w-w*L[2],v+(T+1)*k-k*L[3]]}p.color&&(C.color=o.color),p.size&&(C.size=o.size),p.marker&&(C.marker=o.marker),p.borderSize&&(C.borderSize=o.borderSize),p.borderColor&&(C.borderColor=o.borderColor),p.opacity&&(C.opacity=o.opacity),p.range&&(C.range=y?i(o.range,T,A):o.range||C.bounds),o.passes.push(S)}return this},a.prototype.draw=function(){for(var e=[],t=arguments.length,a;t--;)e[t]=arguments[t];if(!e.length)this.scatter.draw();else{for(var o=[],r=0;r<e.length;r++)if("number"==typeof e[r]){var n=this.traces[e[r]],l=n.passes,s=n.passOffset;o.push.apply(o,u(s,s+l.length))}else if(e[r].length){var d=e[r],c=this.traces[r],p=c.passes,g=c.passOffset;p=p.map(function(e,t){o[g+t]=d})}(a=this.scatter).draw.apply(a,o)}return this},a.prototype.destroy=function(){return this.traces.forEach(function(e){e.buffer&&e.buffer.destroy&&e.buffer.destroy()}),this.traces=null,this.passes=null,this.scatter.destroy(),this}},{"array-bounds":21,"array-range":23,"flatten-vertex-data":205,"parse-rect":443,"pick-by-alias":449,raf:1259,"regl-scatter2d":1267}],1269:[function(e,t,a){var o=Math.pow,i=Math.max;(function(e,o){"object"==typeof a&&"undefined"!=typeof t?t.exports=o():"function"==typeof define&&define.amd?define(o):e.createREGL=o()})(this,function(){function e(e,t){this.id=H++,this.type=e,this.data=t}function t(e){if(0===e.length)return[];var o=e.charAt(0),r=e.charAt(e.length-1);if(1<e.length&&o===r&&("\""===o||"'"===o))return["\""+e.substr(1,e.length-2).replace(/\\/g,"\\\\").replace(/"/g,"\\\"")+"\""];if(o=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(e))return t(e.substr(0,o.index)).concat(t(o[1])).concat(t(e.substr(o.index+o[0].length)));if(o=e.split("."),1===o.length)return["\""+e.replace(/\\/g,"\\\\").replace(/"/g,"\\\"")+"\""];for(e=[],r=0;r<o.length;++r)e=e.concat(t(o[r]));return e}function r(e){return"["+t(e).join("][")+"]"}function s(){var t={"":0},o=[""];return{id:function(a){var r=t[a];return r?r:(r=t[a]=o.length,o.push(a),r)},str:function(e){return o[e]}}}function a(t,a,o){function r(){var a=window.innerWidth,r=window.innerHeight;t!==document.body&&(r=t.getBoundingClientRect(),a=r.right-r.left,r=r.bottom-r.top),i.width=o*a,i.height=o*r,oe(i.style,{width:a+"px",height:r+"px"})}var i=document.createElement("canvas");return oe(i.style,{border:0,margin:0,padding:0,top:0,left:0}),t.appendChild(i),t===document.body&&(i.style.position="absolute",oe(t.style,{margin:0,padding:0})),window.addEventListener("resize",r,!1),r(),{canvas:i,onDestroy:function(){window.removeEventListener("resize",r),t.removeChild(i)}}}function n(e,t){function a(a){try{return e.getContext(a,t)}catch(e){return null}}return a("webgl")||a("experimental-webgl")||a("webgl-experimental")}function p(e){return"string"==typeof e?e.split():e}function m(e){return"string"==typeof e?document.querySelector(e):e}function y(o){var i=o||{},s,h,y,f;o={};var x=[],_=[],b="undefined"==typeof window?1:window.devicePixelRatio,v=!1,w=function(){},k=function(){};if("string"==typeof i?s=document.querySelector(i):"object"==typeof i&&("string"==typeof i.nodeName&&"function"==typeof i.appendChild&&"function"==typeof i.getBoundingClientRect?s=i:"function"==typeof i.drawArrays||"function"==typeof i.drawElements?(f=i,y=f.canvas):("gl"in i?f=i.gl:"canvas"in i?y=m(i.canvas):"container"in i&&(h=m(i.container)),"attributes"in i&&(o=i.attributes),"extensions"in i&&(x=p(i.extensions)),"optionalExtensions"in i&&(_=p(i.optionalExtensions)),"onDone"in i&&(w=i.onDone),"profile"in i&&(v=!!i.profile),"pixelRatio"in i&&(b=+i.pixelRatio))),s&&("canvas"===s.nodeName.toLowerCase()?y=s:h=s),!f){if(!y){if(s=a(h||document.body,w,b),!s)return null;y=s.canvas,k=s.onDestroy}o.premultipliedAlpha=o.premultipliedAlpha||!1,f=n(y,o)}return f?{gl:f,canvas:y,container:h,extensions:x,optionalExtensions:_,pixelRatio:b,profile:v,onDone:w,onDestroy:k}:(k(),w("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function _(t,a){function o(e){e=e.toLowerCase();var a;try{a=r[e]=t.getExtension(e)}catch(e){}return!!a}for(var r={},e=0,i;e<a.extensions.length;++e)if(i=a.extensions[e],!o(i))return a.onDestroy(),a.onDone("\""+i+"\" extension is not supported by the current WebGL context, try upgrading your system or a different browser"),null;return a.optionalExtensions.forEach(o),{extensions:r,restore:function(){Object.keys(r).forEach(function(e){if(r[e]&&!o(e))throw Error("(regl): error restoring extension "+e)})}}}function j(t,a){for(var o=Array(t),r=0;r<t;++r)o[r]=a(r);return o}function l(e){var t,o;return t=(65535<e)<<4,e>>>=t,o=(255<e)<<3,e>>>=o,t|=o,o=(15<e)<<2,e>>>=o,t|=o,o=(3<e)<<1,t|o|e>>>o>>1}function d(){function e(e){a:{for(var t=16;268435456>=t;t*=16)if(e<=t){e=t;break a}e=0}return t=o[l(e)>>2],0<t.length?t.pop():new ArrayBuffer(e)}function t(e){o[l(e.byteLength)>>2].push(e)}var o=j(8,function(){return[]});return{alloc:e,free:t,allocType:function(t,a){var o=null;switch(t){case 5120:o=new Int8Array(e(a),0,a);break;case 5121:o=new Uint8Array(e(a),0,a);break;case 5122:o=new Int16Array(e(2*a),0,a);break;case 5123:o=new Uint16Array(e(2*a),0,a);break;case 5124:o=new Int32Array(e(4*a),0,a);break;case 5125:o=new Uint32Array(e(4*a),0,a);break;case 5126:o=new Float32Array(e(4*a),0,a);break;default:return null;}return o.length===a?o:o.subarray(0,a)},freeType:function(e){t(e.buffer)}}}function u(e){return!!e&&"object"==typeof e&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"==typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||z(e.data))}function h(o,a,i,l,e,s){for(var d=0;d<a;++d)for(var c=o[d],n=0;n<i;++n)for(var p=c[n],m=0;m<l;++m)e[s++]=p[m]}function f(t,a,o,i,e){for(var l=1,s=o+1;s<a.length;++s)l*=a[s];var c=a[o];if(4==a.length-o){var n=a[o+1],p=a[o+2];for(a=a[o+3],s=0;s<c;++s)h(t[s],n,p,a,i,e),e+=l}else for(s=0;s<c;++s)f(t[s],a,o+1,i,e),e+=l}function x(e){return 0|de[Object.prototype.toString.call(e)]}function k(e,t){for(var a=0;a<t.length;++a)e[a]=t[a]}function T(t,a,o,i,e,l,s){for(var r=0,d=0;d<o;++d)for(var c=0;c<i;++c)t[r++]=a[e*d+l*c+s]}function I(o,a,i,l){function s(e){this.id=r++,this.buffer=o.createBuffer(),this.type=e,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,i.profile&&(this.stats={size:0})}function y(e,t,a){e.byteLength=t.byteLength,o.bufferData(e.type,t,a)}function m(t,a,o,r,i,l){if(t.usage=o,Array.isArray(a)){if(t.dtype=r||5126,0<a.length)if(Array.isArray(a[0])){i=ge(a);for(var s=r=1;s<i.length;++s)r*=i[s];t.dimension=r,a=ue(a,i,t.dtype),y(t,a,o),l?t.persistentData=a:le.freeType(a)}else"number"==typeof a[0]?(t.dimension=i,i=le.allocType(t.dtype,a.length),k(i,a),y(t,i,o),l?t.persistentData=i:le.freeType(i)):z(a[0])&&(t.dimension=a[0].length,t.dtype=r||x(a[0])||5126,a=ue(a,[a.length,a[0].length],t.dtype),y(t,a,o),l?t.persistentData=a:le.freeType(a));}else if(z(a))t.dtype=r||x(a),t.dimension=i,y(t,a,o),l&&(t.persistentData=new Uint8Array(new Uint8Array(a.buffer)));else if(u(a)){i=a.shape;var c=a.stride,s=a.offset,p=0,g=0,_=0,v=0;1===i.length?(p=i[0],g=1,_=c[0],v=0):2===i.length&&(p=i[0],g=i[1],_=c[0],v=c[1]),t.dtype=r||x(a.data)||5126,t.dimension=g,i=le.allocType(t.dtype,p*g),T(i,a.data,p,g,_,v,s),y(t,i,o),l?t.persistentData=i:le.freeType(i)}else a instanceof ArrayBuffer&&(t.dtype=5121,t.dimension=i,y(t,a,o),l&&(t.persistentData=new Uint8Array(new Uint8Array(a))))}function e(e){a.bufferCount--,l(e),o.deleteBuffer(e.buffer),e.buffer=null,delete n[e.id]}var r=0,n={};s.prototype.bind=function(){o.bindBuffer(this.type,this.buffer)},s.prototype.destroy=function(){e(this)};var d=[];return i.profile&&(a.getTotalBufferSize=function(){var e=0;return Object.keys(n).forEach(function(t){e+=n[t].stats.size}),e}),{create:function(t,r,l,c){function y(t){var a=35044,r=null,n=0,s=0,p=1;return Array.isArray(t)||z(t)||u(t)||t instanceof ArrayBuffer?r=t:"number"==typeof t?n=0|t:t&&("data"in t&&(r=t.data),"usage"in t&&(a=pe[t.usage]),"type"in t&&(s=ce[t.type]),"dimension"in t&&(p=0|t.dimension),"length"in t&&(n=0|t.length)),f.bind(),r?m(f,r,a,s,p,c):(n&&o.bufferData(f.type,n,a),f.dtype=s||5121,f.usage=a,f.dimension=p,f.byteLength=n),i.profile&&(f.stats.size=f.byteLength*me[f.dtype]),y}a.bufferCount++;var f=new s(r);return n[f.id]=f,l||y(t),y._reglType="buffer",y._buffer=f,y.subdata=function(t,a){var r=0|(a||0),i;if(f.bind(),z(t)||t instanceof ArrayBuffer)o.bufferSubData(f.type,r,t);else if(Array.isArray(t)){if(0<t.length)if("number"==typeof t[0]){var n=le.allocType(f.dtype,t.length);k(n,t),o.bufferSubData(f.type,r,n),le.freeType(n)}else(Array.isArray(t[0])||z(t[0]))&&(i=ge(t),n=ue(t,i,f.dtype),o.bufferSubData(f.type,r,n),le.freeType(n));}else if(u(t)){i=t.shape;var l=t.stride,s=n=0,d=0,c=0;1===i.length?(n=i[0],s=1,d=l[0],c=0):2===i.length&&(n=i[0],s=i[1],d=l[0],c=l[1]),i=Array.isArray(t.data)?f.dtype:x(t.data),i=le.allocType(i,n*s),T(i,t.data,n,s,d,c,t.offset),o.bufferSubData(f.type,r,i),le.freeType(i)}return y},i.profile&&(y.stats=f.stats),y.destroy=function(){e(f)},y},createStream:function(e,t){var a=d.pop();return a||(a=new s(e)),a.bind(),m(a,t,35040,0,1,!1),a},destroyStream:function(e){d.push(e)},clear:function(){G(n).forEach(e),d.forEach(e)},getBuffer:function(e){return e&&e._buffer instanceof s?e._buffer:null},restore:function(){G(n).forEach(function(e){e.buffer=o.createBuffer(),o.bindBuffer(e.type,e.buffer),o.bufferData(e.type,e.persistentData||e.byteLength,e.usage)})},_initBuffer:m}}function M(o,a,i,l){function e(e){this.id=n++,r[this.id]=this,this.buffer=e,this.primType=4,this.type=this.vertCount=0}function s(t,e,r,n,l,s,c){t.buffer.bind();var p;if(e?((p=c)||z(e)&&(!u(e)||z(e.data))||(p=a.oes_element_index_uint?5125:5123),i._initBuffer(t.buffer,e,r,p,3)):(o.bufferData(34963,s,r),t.buffer.dtype=p||5121,t.buffer.usage=r,t.buffer.dimension=3,t.buffer.byteLength=s),p=c,!c){switch(t.buffer.dtype){case 5121:case 5120:p=5121;break;case 5123:case 5122:p=5123;break;case 5125:case 5124:p=5125;}t.buffer.dtype=p}t.type=p,e=l,0>e&&(e=t.buffer.byteLength,5123===p?e>>=1:5125===p&&(e>>=2)),t.vertCount=e,e=n,0>n&&(e=4,n=t.buffer.dimension,1===n&&(e=0),2===n&&(e=1),3===n&&(e=4)),t.primType=e}function d(e){l.elementsCount--,delete r[e.id],e.buffer.destroy(),e.buffer=null}var r={},n=0,p={uint8:5121,uint16:5123};a.oes_element_index_uint&&(p.uint32=5125),e.prototype.bind=function(){this.buffer.bind()};var c=[];return{create:function(t){function o(t){if(!t)r(),g.primType=4,g.vertCount=0,g.type=5121;else if("number"==typeof t)r(t),g.primType=4,g.vertCount=0|t,g.type=5121;else{var a=null,i=35044,m=-1,h=-1,y=0,f=0;Array.isArray(t)||z(t)||u(t)?a=t:("data"in t&&(a=t.data),"usage"in t&&(i=pe[t.usage]),"primitive"in t&&(m=he[t.primitive]),"count"in t&&(h=0|t.count),"type"in t&&(f=p[t.type]),"length"in t)?y=0|t.length:(y=h,5123===f||5122===f)?y*=2:(5125===f||5124===f)&&(y*=4),s(g,a,i,m,h,y,f)}return o}var r=i.create(null,34963,!0),g=new e(r._buffer);return l.elementsCount++,o(t),o._reglType="elements",o._elements=g,o.subdata=function(e,t){return r.subdata(e,t),o},o.destroy=function(){d(g)},o},createStream:function(t){var a=c.pop();return a||(a=new e(i.create(null,34963,!0,!1)._buffer)),s(a,t,35040,-1,-1,0,0),a},destroyStream:function(e){c.push(e)},getElements:function(t){return"function"==typeof t&&t._elements instanceof e?t._elements:null},clear:function(){G(r).forEach(d)}}}function g(t){for(var a=le.allocType(5123,t.length),o=0;o<t.length;++o)if(isNaN(t[o]))a[o]=65535;else if(1/0===t[o])a[o]=31744;else if(-Infinity===t[o])a[o]=64512;else{ye[0]=t[o];var r=fe[0],i=r>>>31<<15,n=(r<<1>>>24)-127,r=1023&r>>13;a[o]=-24>n?i:-14>n?i+(r+1024>>-14-n):15<n?i+31744:i+(n+15<<10)+r}return a}function v(e){return Array.isArray(e)||z(e)}function c(e){return"[object "+e+"]"}function A(e){return Array.isArray(e)&&(0===e.length||"number"==typeof e[0])}function D(e){return!!(Array.isArray(e)&&0!==e.length&&v(e[0]))}function O(e){return Object.prototype.toString.call(e)}function R(e){if(!e)return!1;var t=O(e);return!!(0<=Se.indexOf(t))||A(e)||D(e)||u(e)}function b(e,t){36193===e.type?(e.data=g(t),le.freeType(t)):e.data=t}function B(t,o,r,i,n,l){if(t="undefined"==typeof Z[t]?be[t]*Ce[o]:Z[t],l&&(t*=6),n){for(i=0;1<=r;)i+=t*r*r,r/=2;return i}return t*r*i}function F(o,i,a,s,c,y,_){function e(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function r(e,t){e.internalformat=t.internalformat,e.format=t.format,e.type=t.type,e.compressed=t.compressed,e.premultiplyAlpha=t.premultiplyAlpha,e.flipY=t.flipY,e.unpackAlignment=t.unpackAlignment,e.colorSpace=t.colorSpace,e.width=t.width,e.height=t.height,e.channels=t.channels}function n(t,a){if("object"==typeof a&&a){"premultiplyAlpha"in a&&(t.premultiplyAlpha=a.premultiplyAlpha),"flipY"in a&&(t.flipY=a.flipY),"alignment"in a&&(t.unpackAlignment=a.alignment),"colorSpace"in a&&(t.colorSpace=ee[a.colorSpace]),"type"in a&&(t.type=te[a.type]);var o=t.width,r=t.height,i=t.channels,n=!1;"shape"in a?(o=a.shape[0],r=a.shape[1],3===a.shape.length&&(i=a.shape[2],n=!0)):("radius"in a&&(o=r=a.radius),"width"in a&&(o=a.width),"height"in a&&(r=a.height),"channels"in a&&(i=a.channels,n=!0)),t.width=0|o,t.height=0|r,t.channels=0|i,o=!1,"format"in a&&(o=a.format,r=t.internalformat=K[o],t.format=pe[r],o in te&&!("type"in a)&&(t.type=te[o]),o in ae&&(t.compressed=!0),o=!0),!n&&o?t.channels=be[t.format]:n&&!o&&t.channels!==_e[t.format]&&(t.format=t.internalformat=_e[t.channels])}}function j(e){o.pixelStorei(37440,e.flipY),o.pixelStorei(37441,e.premultiplyAlpha),o.pixelStorei(37443,e.colorSpace),o.pixelStorei(3317,e.unpackAlignment)}function t(){e.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function I(t,a){var o=null;if(R(a)?o=a:a&&(n(t,a),"x"in a&&(t.xOffset=0|a.x),"y"in a&&(t.yOffset=0|a.y),R(a.data)&&(o=a.data)),a.copy){var r=c.viewportWidth,i=c.viewportHeight;t.width=t.width||r-t.xOffset,t.height=t.height||i-t.yOffset,t.needsCopy=!0}else if(!o)t.width=t.width||1,t.height=t.height||1,t.channels=t.channels||4;else if(z(o))t.channels=t.channels||4,t.data=o,"type"in a||5121!==t.type||(t.type=0|de[Object.prototype.toString.call(o)]);else if(A(o)){switch(t.channels=t.channels||4,r=o,i=r.length,t.type){case 5121:case 5123:case 5125:case 5126:i=le.allocType(t.type,i),i.set(r),t.data=i;break;case 36193:t.data=g(r);}t.alignment=1,t.needsFree=!0}else if(u(o)){r=o.data,Array.isArray(r)||5121!==t.type||(t.type=0|de[Object.prototype.toString.call(r)]);var i=o.shape,l=o.stride,s,d,x,_;3===i.length?(x=i[2],_=l[2]):_=x=1,s=i[0],d=i[1],i=l[0],l=l[1],t.alignment=1,t.width=s,t.height=d,t.channels=x,t.format=t.internalformat=_e[x],t.needsFree=!0,s=_,o=o.offset,x=t.width,_=t.height,d=t.channels;for(var w=le.allocType(36193===t.type?5126:t.type,x*_*d),y=0,T=0;T<_;++T)for(var C=0;C<x;++C)for(var L=0;L<d;++L)w[y++]=r[i*C+l*T+s*L+o];b(t,w)}else if(O(o)===S||O(o)===ve||O(o)===we)t.element=O(o)===S||O(o)===ve?o:o.canvas,t.width=t.element.width,t.height=t.element.height,t.channels=4;else if(O(o)===ke)t.element=o,t.width=o.width,t.height=o.height,t.channels=4;else if(O(o)===Te)t.element=o,t.width=o.naturalWidth,t.height=o.naturalHeight,t.channels=4;else if(O(o)===Ae)t.element=o,t.width=o.videoWidth,t.height=o.videoHeight,t.channels=4;else if(D(o)){for(r=t.width||o[0].length,i=t.height||o.length,l=t.channels,l=v(o[0][0])?l||o[0][0].length:l||1,s=J.shape(o),x=1,_=0;_<s.length;++_)x*=s[_];x=le.allocType(36193===t.type?5126:t.type,x),J.flatten(o,s,"",x),b(t,x),t.alignment=1,t.width=r,t.height=i,t.channels=l,t.format=t.internalformat=_e[l],t.needsFree=!0}}function F(e,t,a,r,i){var n=e.element,l=e.data,d=e.internalformat,c=e.format,p=e.type,u=e.width,g=e.height;j(e),n?o.texSubImage2D(t,i,a,r,c,p,n):e.compressed?o.compressedTexSubImage2D(t,i,a,r,d,u,g,l):e.needsCopy?(s(),o.copyTexSubImage2D(t,i,a,r,e.xOffset,e.yOffset,u,g)):o.texSubImage2D(t,i,a,r,u,g,c,p,l)}function k(){return M.pop()||new t}function h(e){e.needsFree&&le.freeType(e.data),t.call(e),M.push(e)}function l(){e.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function p(e,t,a){var o=e.images[0]=k();e.mipmask=1,o.width=e.width=t,o.height=e.height=a,o.channels=e.channels=4}function m(t,a){var o=null;if(R(a))o=t.images[0]=k(),r(o,t),I(o,a),t.mipmask=1;else if(n(t,a),Array.isArray(a.mipmap))for(var i=a.mipmap,l=0;l<i.length;++l)o=t.images[l]=k(),r(o,t),o.width>>=l,o.height>>=l,I(o,i[l]),t.mipmask|=1<<l;else o=t.images[0]=k(),r(o,t),I(o,a),t.mipmask=1;r(t,t.images[0])}function N(e,t){for(var a=e.images,r=0;r<a.length&&a[r];++r){var i=a[r],n=t,l=r,d=i.element,c=i.data,p=i.internalformat,u=i.format,g=i.type,m=i.width,y=i.height;j(i),d?o.texImage2D(n,l,u,u,g,d):i.compressed?o.compressedTexImage2D(n,l,p,m,y,0,c):i.needsCopy?(s(),o.copyTexImage2D(n,l,u,i.xOffset,i.yOffset,m,y,0)):o.texImage2D(n,l,u,m,y,0,u,g,c||null)}}function U(){var t=L.pop()||new l;e.call(t);for(var a=t.mipmask=0;16>a;++a)t.images[a]=null;return t}function C(e){for(var t=e.images,a=0;a<t.length;++a)t[a]&&h(t[a]),t[a]=null;L.push(e)}function H(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function q(t,a){"min"in a&&(t.minFilter=T[a.min],0<=xe.indexOf(t.minFilter)&&!("faces"in a)&&(t.genMipmaps=!0)),"mag"in a&&(t.magFilter=Q[a.mag]);var o=t.wrapS,r=t.wrapT;if("wrap"in a){var i=a.wrap;"string"==typeof i?o=r=x[i]:Array.isArray(i)&&(o=x[i[0]],r=x[i[1]])}else"wrapS"in a&&(o=x[a.wrapS]),"wrapT"in a&&(r=x[a.wrapT]);if(t.wrapS=o,t.wrapT=r,"anisotropic"in a&&(t.anisotropic=a.anisotropic),"mipmap"in a){switch(o=!1,typeof a.mipmap){case"string":t.mipmapHint=$[a.mipmap],o=t.genMipmaps=!0;break;case"boolean":o=t.genMipmaps=a.mipmap;break;case"object":t.genMipmaps=!1,o=!0;}!o||"min"in a||(t.minFilter=9984)}}function Y(e,t){o.texParameteri(t,10241,e.minFilter),o.texParameteri(t,10240,e.magFilter),o.texParameteri(t,10242,e.wrapS),o.texParameteri(t,10243,e.wrapT),i.ext_texture_filter_anisotropic&&o.texParameteri(t,34046,e.anisotropic),e.genMipmaps&&(o.hint(33170,e.mipmapHint),o.generateMipmap(t))}function f(t){e.call(this),this.mipmask=0,this.internalformat=6408,this.id=ue++,this.refCount=1,this.target=t,this.texture=o.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new H,_.profile&&(this.stats={size:0})}function X(e){o.activeTexture(33984),o.bindTexture(e.target,e.texture)}function Z(){var e=me[0];e?o.bindTexture(e.target,e.texture):o.bindTexture(3553,null)}function d(t){var a=t.texture,r=t.unit,i=t.target;0<=r&&(o.activeTexture(33984+r),o.bindTexture(i,null),me[r]=null),o.deleteTexture(a),t.texture=null,t.params=null,t.pixels=null,t.refCount=0,delete ge[t.id],y.textureCount--}var $={"don't care":4352,"dont care":4352,nice:4354,fast:4353},x={repeat:10497,clamp:33071,mirror:33648},Q={nearest:9728,linear:9729},T=oe({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},Q),ee={none:0,browser:37444},te={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},K={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},ae={};i.ext_srgb&&(K.srgb=35904,K.srgba=35906),i.oes_texture_float&&(te.float32=te.float=5126),i.oes_texture_half_float&&(te.float16=te["half float"]=36193),i.webgl_depth_texture&&(oe(K,{depth:6402,"depth stencil":34041}),oe(te,{uint16:5123,uint32:5125,"depth stencil":34042})),i.webgl_compressed_texture_s3tc&&oe(ae,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),i.webgl_compressed_texture_atc&&oe(ae,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),i.webgl_compressed_texture_pvrtc&&oe(ae,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),i.webgl_compressed_texture_etc1&&(ae["rgb etc1"]=36196);var V=Array.prototype.slice.call(o.getParameter(34467));Object.keys(ae).forEach(function(e){var t=ae[e];0<=V.indexOf(t)&&(K[e]=t)});var w=Object.keys(K);a.textureFormats=w;var re=[];Object.keys(K).forEach(function(e){re[K[e]]=e});var ie=[];Object.keys(te).forEach(function(e){ie[te[e]]=e});var ne=[];Object.keys(Q).forEach(function(e){ne[Q[e]]=e});var se=[];Object.keys(T).forEach(function(e){se[T[e]]=e});var ce=[];Object.keys(x).forEach(function(e){ce[x[e]]=e});var pe=w.reduce(function(e,t){var a=K[t];return e[a]=6409===a||6406===a||6409===a||6410===a||6402===a||34041===a||i.ext_srgb&&(35904===a||35906===a)?a:32855===a||0<=t.indexOf("rgba")?6408:6407,e},{}),M=[],L=[],ue=0,ge={},E=a.maxTextureUnits,me=Array(E).map(function(){return null});return oe(f.prototype,{bind:function(){this.bindCount+=1;var e=this.unit;if(0>e){for(var t=0,a;t<E;++t){if(a=me[t],a){if(0<a.bindCount)continue;a.unit=-1}me[t]=this,e=t;break}_.profile&&y.maxTextureUnits<e+1&&(y.maxTextureUnits=e+1),this.unit=e,o.activeTexture(33984+e),o.bindTexture(this.target,this.texture)}return e},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&d(this)}}),_.profile&&(y.getTotalTextureSize=function(){var e=0;return Object.keys(ge).forEach(function(t){e+=ge[t].stats.size}),e}),{create2D:function(t,a){function i(t,a){var o=e.texInfo;H.call(o);var n=U();return"number"==typeof t?"number"==typeof a?p(n,0|t,0|a):p(n,0|t,0|t):t?(q(o,t),m(n,t)):p(n,1,1),o.genMipmaps&&(n.mipmask=(n.width<<1)-1),e.mipmask=n.mipmask,r(e,n),e.internalformat=n.internalformat,i.width=n.width,i.height=n.height,X(e),N(n,3553),Y(o,3553),Z(),C(n),_.profile&&(e.stats.size=B(e.internalformat,e.type,n.width,n.height,o.genMipmaps,!1)),i.format=re[e.internalformat],i.type=ie[e.type],i.mag=ne[o.magFilter],i.min=se[o.minFilter],i.wrapS=ce[o.wrapS],i.wrapT=ce[o.wrapT],i}var e=new f(3553);return ge[e.id]=e,y.textureCount++,i(t,a),i.subimage=function(t,a,o,n){a|=0,o|=0,n|=0;var l=k();return r(l,e),l.width=0,l.height=0,I(l,t),l.width=l.width||(e.width>>n)-a,l.height=l.height||(e.height>>n)-o,X(e),F(l,3553,a,o,n),Z(),h(l),i},i.resize=function(t,a){var r=0|t,n=0|a||r;if(r===e.width&&n===e.height)return i;i.width=e.width=r,i.height=e.height=n,X(e);for(var l=0;e.mipmask>>l;++l){var s=r>>l,d=n>>l;if(!s||!d)break;o.texImage2D(3553,l,e.format,s,d,0,e.format,e.type,null)}return Z(),_.profile&&(e.stats.size=B(e.internalformat,e.type,r,n,!1,!1)),i},i._reglType="texture2d",i._texture=e,_.profile&&(i.stats=e.stats),i.destroy=function(){e.decRef()},i},createCube:function(t,a,i,e,s,d){function u(t,o,i,s,c,e){var d=l.texInfo,y;for(H.call(d),y=0;6>y;++y)g[y]=U();if("number"==typeof t||!t)for(t=0|t||1,y=0;6>y;++y)p(g[y],t,t);else if("object"==typeof t)if(o)m(g[0],t),m(g[1],o),m(g[2],i),m(g[3],s),m(g[4],c),m(g[5],e);else if(q(d,t),n(l,t),"faces"in t)for(t=t.faces,y=0;6>y;++y)r(g[y],l),m(g[y],t[y]);else for(y=0;6>y;++y)m(g[y],t);for(r(l,g[0]),l.mipmask=d.genMipmaps?(g[0].width<<1)-1:g[0].mipmask,l.internalformat=g[0].internalformat,u.width=g[0].width,u.height=g[0].height,X(l),y=0;6>y;++y)N(g[y],34069+y);for(Y(d,34067),Z(),_.profile&&(l.stats.size=B(l.internalformat,l.type,u.width,u.height,d.genMipmaps,!0)),u.format=re[l.internalformat],u.type=ie[l.type],u.mag=ne[d.magFilter],u.min=se[d.minFilter],u.wrapS=ce[d.wrapS],u.wrapT=ce[d.wrapT],y=0;6>y;++y)C(g[y]);return u}var l=new f(34067);ge[l.id]=l,y.cubeCount++;var g=[,,,,,,];return u(t,a,i,e,s,d),u.subimage=function(t,a,o,i,n){o|=0,i|=0,n|=0;var s=k();return r(s,l),s.width=0,s.height=0,I(s,a),s.width=s.width||(l.width>>n)-o,s.height=s.height||(l.height>>n)-i,X(l),F(s,34069+t,o,i,n),Z(),h(s),u},u.resize=function(e){if(e|=0,e!==l.width){u.width=l.width=e,u.height=l.height=e,X(l);for(var t=0;6>t;++t)for(var a=0;l.mipmask>>a;++a)o.texImage2D(34069+t,a,l.format,e>>a,e>>a,0,l.format,l.type,null);return Z(),_.profile&&(l.stats.size=B(l.internalformat,l.type,u.width,u.height,!1,!0)),u}},u._reglType="textureCube",u._texture=l,_.profile&&(u.stats=l.stats),u.destroy=function(){l.decRef()},u},clear:function(){for(var e=0;e<E;++e)o.activeTexture(33984+e),o.bindTexture(3553,null),me[e]=null;G(ge).forEach(d),y.cubeCount=0,y.textureCount=0},getTexture:function(){return null},restore:function(){for(var e=0,t;e<E;++e)t=me[e],t&&(t.bindCount=0,t.unit=-1,me[e]=null);G(ge).forEach(function(e){e.texture=o.createTexture(),o.bindTexture(e.target,e.texture);for(var t=0;32>t;++t)if(0!=(e.mipmask&1<<t))if(3553===e.target)o.texImage2D(3553,t,e.internalformat,e.width>>t,e.height>>t,0,e.internalformat,e.type,null);else for(var a=0;6>a;++a)o.texImage2D(34069+a,t,e.internalformat,e.width>>t,e.height>>t,0,e.internalformat,e.type,null);Y(e.texInfo,e.target)})}}}function U(o,a,s,y,e,d){function g(e,t,o){this.target=e,this.texture=t,this.renderbuffer=o;var r=e=0;t?(e=t.width,r=t.height):o&&(e=o.width,r=o.height),this.width=e,this.height=r}function r(e){e&&(e.texture&&e.texture._texture.decRef(),e.renderbuffer&&e.renderbuffer._renderbuffer.decRef())}function x(e){e&&(e.texture?e.texture._texture.refCount+=1:e.renderbuffer._renderbuffer.refCount+=1)}function n(e,t){t&&(t.texture?o.framebufferTexture2D(36160,e,t.target,t.texture._texture.texture,0):o.framebufferRenderbuffer(36160,e,36161,t.renderbuffer._renderbuffer.renderbuffer))}function u(t){var o=3553,r=null,i=null,n=t;return"object"==typeof t&&(n=t.data,"target"in t&&(o=0|t.target)),t=n._reglType,"texture2d"===t?r=n:"textureCube"===t?r=n:"renderbuffer"===t&&(i=n,o=36161),new g(o,r,i)}function t(t,o,r,i,n){return r?(t=y.create2D({width:t,height:o,format:i,type:n}),t._texture.refCount=0,new g(3553,t,null)):(t=e.create({width:t,height:o,format:i}),t._renderbuffer.refCount=0,new g(36161,null,t))}function l(e){return e&&(e.texture||e.renderbuffer)}function _(e,t,a){e&&(e.texture?e.texture.resize(t,a):e.renderbuffer&&e.renderbuffer.resize(t,a),e.width=t,e.height=a)}function k(){this.id=b++,v[this.id]=this,this.framebuffer=o.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function T(e){e.colorAttachments.forEach(r),r(e.depthAttachment),r(e.stencilAttachment),r(e.depthStencilAttachment)}function c(e){o.deleteFramebuffer(e.framebuffer),e.framebuffer=null,d.framebufferCount--,delete v[e.id]}function A(t){var a;o.bindFramebuffer(36160,t.framebuffer);var r=t.colorAttachments;for(a=0;a<r.length;++a)n(36064+a,r[a]);for(a=r.length;a<s.maxColorAttachments;++a)o.framebufferTexture2D(36160,36064+a,3553,null,0);o.framebufferTexture2D(36160,33306,3553,null,0),o.framebufferTexture2D(36160,36096,3553,null,0),o.framebufferTexture2D(36160,36128,3553,null,0),n(36096,t.depthAttachment),n(36128,t.stencilAttachment),n(33306,t.depthStencilAttachment),o.checkFramebufferStatus(36160),o.isContextLost(),o.bindFramebuffer(36160,m.next?m.next.framebuffer:null),m.cur=m.next,o.getError()}function p(o,a){function s(e,a){var o=0,i=0,c=!0,m=!0,_;_=null;var b=!0,C="rgba",L="uint8",I=1,P=null,D=null,O=null,j=!1;"number"==typeof e?(o=0|e,i=0|a||o):e?("shape"in e?(i=e.shape,o=i[0],i=i[1]):("radius"in e&&(o=i=e.radius),"width"in e&&(o=e.width),"height"in e&&(i=e.height)),("color"in e||"colors"in e)&&(_=e.color||e.colors,Array.isArray(_)),!_&&("colorCount"in e&&(I=0|e.colorCount),"colorTexture"in e&&(b=!!e.colorTexture,C="rgba4"),"colorType"in e&&(L=e.colorType,!b)&&("half float"===L||"float16"===L?C="rgba16f":("float"===L||"float32"===L)&&(C="rgba32f")),"colorFormat"in e&&(C=e.colorFormat,0<=f.indexOf(C)?b=!0:0<=S.indexOf(C)&&(b=!1))),("depthTexture"in e||"depthStencilTexture"in e)&&(j=e.depthTexture||e.depthStencilTexture),"depth"in e&&("boolean"==typeof e.depth?c=e.depth:(P=e.depth,m=!1)),"stencil"in e&&("boolean"==typeof e.stencil?m=e.stencil:(D=e.stencil,c=!1)),"depthStencil"in e&&("boolean"==typeof e.depthStencil?c=m=e.depthStencil:(O=e.depthStencil,m=c=!1))):o=i=1;var B=null,F=null,N=null,V=null;if(Array.isArray(_))B=_.map(u);else if(_)B=[u(_)];else for(B=Array(I),_=0;_<I;++_)B[_]=t(o,i,b,C,L);for(o=o||B[0].width,i=i||B[0].height,P?F=u(P):c&&!m&&(F=t(o,i,j,"depth","uint32")),D?N=u(D):m&&!c&&(N=t(o,i,!1,"stencil","uint8")),O?V=u(O):!P&&!D&&m&&c&&(V=t(o,i,j,"depth stencil","depth stencil")),c=null,_=0;_<B.length;++_)x(B[_],o,i),B[_]&&B[_].texture&&(m=E[B[_].texture._texture.format]*Ee[B[_].texture._texture.type],null===c&&(c=m));return x(F,o,i),x(N,o,i),x(V,o,i),T(y),y.width=o,y.height=i,y.colorAttachments=B,y.depthAttachment=F,y.stencilAttachment=N,y.depthStencilAttachment=V,s.color=B.map(l),s.depth=l(F),s.stencil=l(N),s.depthStencil=l(V),s.width=y.width,s.height=y.height,A(y),s}var y=new k;return d.framebufferCount++,s(o,a),oe(s,{resize:function(e,t){var a=i(0|e,1),o=i(0|t||a,1);if(a===y.width&&o===y.height)return s;for(var r=y.colorAttachments,n=0;n<r.length;++n)_(r[n],a,o);return _(y.depthAttachment,a,o),_(y.stencilAttachment,a,o),_(y.depthStencilAttachment,a,o),y.width=s.width=a,y.height=s.height=o,A(y),s},_reglType:"framebuffer",_framebuffer:y,destroy:function(){c(y),T(y)},use:function(e){m.setFBO({framebuffer:s},e)}})}var m={cur:null,next:null,dirty:!1,setFBO:null},f=["rgba"],S=["rgba4","rgb565","rgb5 a1"];a.ext_srgb&&S.push("srgba"),a.ext_color_buffer_half_float&&S.push("rgba16f","rgb16f"),a.webgl_color_buffer_float&&S.push("rgba32f");var h=["uint8"];a.oes_texture_half_float&&h.push("half float","float16"),a.oes_texture_float&&h.push("float","float32");var b=0,v={};return oe(m,{getFramebuffer:function(e){return"function"==typeof e&&"framebuffer"===e._reglType&&(e=e._framebuffer,e instanceof k)?e:null},create:p,createCube:function(e){function t(e){var r={color:null},i=0,n=null,l;l="rgba";var s="uint8",d=1;if("number"==typeof e?i=0|e:e?("shape"in e?i=e.shape[0]:("radius"in e&&(i=0|e.radius),"width"in e?i=0|e.width:"height"in e&&(i=0|e.height)),("color"in e||"colors"in e)&&(n=e.color||e.colors,Array.isArray(n)),n||("colorCount"in e&&(d=0|e.colorCount),"colorType"in e&&(s=e.colorType),"colorFormat"in e&&(l=e.colorFormat)),"depth"in e&&(r.depth=e.depth),"stencil"in e&&(r.stencil=e.stencil),"depthStencil"in e&&(r.depthStencil=e.depthStencil)):i=1,!n)for(e=Array(d),n={radius:i,format:l,type:s},l=0;l<d;++l)e[l]=y.createCube(n);else if(Array.isArray(n))for(e=[],l=0;l<n.length;++l)e[l]=n[l];else e=[n];for(r.color=Array(e.length),l=0;l<e.length;++l)d=e[l],i=i||d.width,r.color[l]={target:34069,data:e[l]};for(l=0;6>l;++l){for(d=0;d<e.length;++d)r.color[d].target=34069+l;0<l&&(r.depth=o[0].depth,r.stencil=o[0].stencil,r.depthStencil=o[0].depthStencil),o[l]?o[l](r):o[l]=p(r)}return oe(t,{width:i,height:i,color:e})}var o=[,,,,,,];return t(e),oe(t,{faces:o,resize:function(e){var r=0|e;if(r===t.width)return t;var i=t.color;for(e=0;e<i.length;++e)i[e].resize(r);for(e=0;6>e;++e)o[e].resize(r);return t.width=t.height=r,t},_reglType:"framebufferCube",destroy:function(){o.forEach(function(e){e.destroy()})}})},clear:function(){G(v).forEach(c)},restore:function(){m.cur=null,m.next=null,m.dirty=!0,G(v).forEach(function(e){e.framebuffer=o.createFramebuffer(),A(e)})}})}function N(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function W(o,i,a,n,s){function e(e){if(e!==m.currentVAO){var t=i.oes_vertex_array_object;e?t.bindVertexArrayOES(e.vao):t.bindVertexArrayOES(null),m.currentVAO=e}}function d(a){if(a!==m.currentVAO){if(a)a.bindAttrs();else for(var r=i.angle_instanced_arrays,n=0,l;n<t.length;++n)l=t[n],l.buffer?(o.enableVertexAttribArray(n),o.vertexAttribPointer(n,l.size,l.type,l.normalized,l.stride,l.offfset),r&&r.vertexAttribDivisorANGLE(n,l.divisor)):(o.disableVertexAttribArray(n),o.vertexAttrib4f(n,l.x,l.y,l.z,l.w));m.currentVAO=a}}function r(){this.id=++l,this.attributes=[];var e=i.oes_vertex_array_object;this.vao=e?e.createVertexArrayOES():null,g[this.id]=this,this.buffers=[]}var p=a.maxAttributes,t=Array(p);for(a=0;a<p;++a)t[a]=new N;var l=0,g={},m={Record:N,scope:{},state:t,currentVAO:null,targetVAO:null,restore:i.oes_vertex_array_object?function(){i.oes_vertex_array_object&&G(g).forEach(function(e){e.refresh()})}:function(){},createVAO:function(e){function t(r){for(var a=0;a<o.buffers.length;++a)o.buffers[a].destroy();o.buffers.length=0,a=o.attributes,a.length=r.length;for(var i=0;i<r.length;++i){var n=r[i],l=a[i]=new N;Array.isArray(n)||z(n)||u(n)?(n=s.create(n,34962,!1,!0),l.buffer=s.getBuffer(n),l.size=0|l.buffer.dimension,l.normalized=!1,l.type=l.buffer.dtype,l.offset=0,l.stride=0,l.divisor=0,l.state=1,o.buffers.push(n)):s.getBuffer(n)?(l.buffer=s.getBuffer(n),l.size=0|l.buffer.dimension,l.normalized=!1,l.type=l.buffer.dtype,l.offset=0,l.stride=0,l.divisor=0,l.state=1):s.getBuffer(n.buffer)?(l.buffer=s.getBuffer(n.buffer),l.size=0|(+n.size||l.buffer.dimension),l.normalized=!!n.normalized||!1,l.type="type"in n?ce[n.type]:l.buffer.dtype,l.offset=0|(n.offset||0),l.stride=0|(n.stride||0),l.divisor=0|(n.divisor||0),l.state=1):"x"in n&&(l.x=+n.x||0,l.y=+n.y||0,l.z=+n.z||0,l.w=+n.w||0,l.state=2)}return o.refresh(),t}var o=new r;return n.vaoCount+=1,t.destroy=function(){o.destroy()},t._vao=o,t._reglType="vao",t(e)},getVAO:function(e){return"function"==typeof e&&e._vao?e._vao:null},destroyBuffer:function(a){for(var r=0,i;r<t.length;++r)i=t[r],i.buffer===a&&(o.disableVertexAttribArray(r),i.buffer=null)},setVAO:i.oes_vertex_array_object?e:d,clear:i.oes_vertex_array_object?function(){G(g).forEach(function(e){e.destroy()})}:function(){}};return r.prototype.bindAttrs=function(){for(var t=i.angle_instanced_arrays,a=this.attributes,e=0,r;e<a.length;++e)r=a[e],r.buffer?(o.enableVertexAttribArray(e),o.bindBuffer(34962,r.buffer.buffer),o.vertexAttribPointer(e,r.size,r.type,r.normalized,r.stride,r.offset),t&&t.vertexAttribDivisorANGLE(e,r.divisor)):(o.disableVertexAttribArray(e),o.vertexAttrib4f(e,r.x,r.y,r.z,r.w));for(t=a.length;t<p;++t)o.disableVertexAttribArray(t)},r.prototype.refresh=function(){var e=i.oes_vertex_array_object;e&&(e.bindVertexArrayOES(this.vao),this.bindAttrs(),m.currentVAO=this)},r.prototype.destroy=function(){if(this.vao){var e=i.oes_vertex_array_object;this===m.currentVAO&&(m.currentVAO=null,e.bindVertexArrayOES(null)),e.deleteVertexArrayOES(this.vao),this.vao=null}g[this.id]&&(delete g[this.id],--n.vaoCount)},m}function $(o,a,i,s){function e(t,a,o,r){this.name=t,this.id=a,this.location=o,this.info=r}function d(e,t){for(var a=0;a<e.length;++a)if(e[a].id===t.id)return void(e[a].location=t.location);e.push(t)}function p(t,r,i){i=35632===t?u:m;var n=i[r];if(!n){var l=a.str(r),n=o.createShader(t);o.shaderSource(n,l),o.compileShader(n),i[r]=n}return n}function r(e,t){this.id=g++,this.fragId=e,this.vertId=t,this.program=null,this.uniforms=[],this.attributes=[],s.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function n(r,i,g){var m=p(35632,r.fragId);var h=p(35633,r.vertId);if(i=r.program=o.createProgram(),o.attachShader(i,m),o.attachShader(i,h),g)for(m=0;m<g.length;++m)h=g[m],o.bindAttribLocation(i,h[0],h[1]);o.linkProgram(i),h=o.getProgramParameter(i,35718),s.profile&&(r.stats.uniformsCount=h);var y=r.uniforms;for(g=0;g<h;++g)if(m=o.getActiveUniform(i,g))if(1<m.size)for(var x=0,_;x<m.size;++x)_=m.name.replace("[0]","["+x+"]"),d(y,new e(_,a.id(_),o.getUniformLocation(i,_),m));else d(y,new e(m.name,a.id(m.name),o.getUniformLocation(i,m.name),m));for(h=o.getProgramParameter(i,35721),s.profile&&(r.stats.attributesCount=h),r=r.attributes,g=0;g<h;++g)(m=o.getActiveAttrib(i,g))&&d(r,new e(m.name,a.id(m.name),o.getAttribLocation(i,m.name),m))}var u={},m={},c={},h=[],g=0;return s.profile&&(i.getMaxUniformsCount=function(){var e=0;return h.forEach(function(t){t.stats.uniformsCount>e&&(e=t.stats.uniformsCount)}),e},i.getMaxAttributesCount=function(){var e=0;return h.forEach(function(t){t.stats.attributesCount>e&&(e=t.stats.attributesCount)}),e}),{clear:function(){var e=o.deleteShader.bind(o);G(u).forEach(e),u={},G(m).forEach(e),m={},h.forEach(function(e){o.deleteProgram(e.program)}),h.length=0,c={},i.shaderCount=0},program:function(t,a,o,e){var l=c[a];l||(l=c[a]={});var s=l[t];return s&&!e?s:(a=new r(a,t),i.shaderCount++,n(a,o,e),s||(l[t]=a),h.push(a),a)},restore:function(){u={},m={};for(var e=0;e<h.length;++e)n(h[e],null,h[e].attributes.map(function(e){return[e.location,e.name]}))},shader:p,frag:-1,vert:-1}}function Q(t,o,a,r){function e(e){var i=null===o.next?5121:o.next.colorAttachments[0].texture._texture.type;var s=0,c=0,p=r.framebufferWidth,u=r.framebufferHeight,g=null;return z(e)?g=e:e&&(s=0|e.x,c=0|e.y,p=0|(e.width||r.framebufferWidth-s),u=0|(e.height||r.framebufferHeight-c),g=e.data||null),a(),e=4*(p*u),g||(5121===i?g=new Uint8Array(e):5126===i&&(g=g||new Float32Array(e))),t.pixelStorei(3333,4),t.readPixels(s,c,p,u,6408,i,g),g}function i(t){var a;return o.setFBO({framebuffer:t.framebuffer},function(){a=e(t)}),a}return function(t){return t&&"framebuffer"in t?i(t):e(t)}}function V(e){return Array.prototype.slice.call(e)}function q(e){return V(e).join("")}function Y(){function t(){var e=[],t=[];return oe(function(){e.push.apply(e,V(arguments))},{def:function(){var a="v"+i++;return t.push(a),0<arguments.length&&(e.push(a,"="),e.push.apply(e,V(arguments)),e.push(";")),a},toString:function(){return q([0<t.length?"var "+t.join(",")+";":"",q(e)])}})}function o(){function o(t,a){i(t,a,"=",r.def(t,a),";")}var r=t(),i=t(),a=r.toString,e=i.toString;return oe(function(){r.apply(r,V(arguments))},{def:r.def,entry:r,exit:i,save:o,set:function(t,a,i){o(t,a),r(t,a,"=",i,";")},toString:function(){return a()+e()}})}var i=0,n=[],e=[],l=t(),s={};return{global:l,link:function(t){for(var a=0;a<e.length;++a)if(e[a]===t)return n[a];return a="g"+i++,n.push(a),e.push(t),a},block:t,proc:function(t,a){function r(){var e="a"+i.length;return i.push(e),e}var i=[];a=a||0;for(var e=0;e<a;++e)r();var e=o(),n=e.toString;return s[t]=oe(e,{arg:r,toString:function(){return q(["function(",i.join(),"){",n(),"}"])}})},scope:o,cond:function(){var t=q(arguments),a=o(),r=o(),i=a.toString,e=r.toString;return oe(a,{then:function(){return a.apply(a,V(arguments)),this},else:function(){return r.apply(r,V(arguments)),this},toString:function(){var a=e();return a&&(a="else{"+a+"}"),q(["if(",t,"){",i(),"}",a])}})},compile:function(){var t=["\"use strict\";",l,"return {"];Object.keys(s).forEach(function(e){t.push("\"",e,"\":",s[e].toString(),",")}),t.push("}");var a=q(t).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,n.concat(a)).apply(null,e)}}}function ee(e){return Array.isArray(e)||z(e)||u(e)}function X(e){return e.sort(function(e,t){return"viewport"===e?-1:"viewport"===t?1:e<t?-1:1})}function K(t,a,o,r){this.thisDep=t,this.contextDep=a,this.propDep=o,this.append=r}function P(e){return e&&!(e.thisDep||e.contextDep||e.propDep)}function te(e){return new K(!1,!1,!1,e)}function C(e,t){var a=e.type;return 0===a?(a=e.data.length,new K(!0,1<=a,2<=a,t)):4===a?(a=e.data,new K(a.thisDep,a.contextDep,a.propDep,t)):new K(3===a,2===a,1===a,t)}function ae(s,_,y,c,b,e,a,r,n,u,A,t,l,g,d){function L(e){return e.replace(".","_")}function h(e,t,a){var o=L(e);ye.push(e),me[o]=ge[o]=!!a,fe[o]=t}function p(e,t,a){var o=L(e);ye.push(e),Array.isArray(a)?(ge[o]=a.slice(),me[o]=a.slice()):ge[o]=me[o]=a,xe[o]=t}function I(){var t=Y(),o=t.link,r=t.global;t.id=Z++,t.batchId="0";var n=o(_e),l=t.shared={props:"a0"};Object.keys(_e).forEach(function(e){l[e]=r.def(n,".",e)});var e=t.next={},s=t.current={};Object.keys(xe).forEach(function(t){Array.isArray(ge[t])&&(e[t]=r.def(l.next,".",t),s[t]=r.def(l.current,".",t))});var d=t.constants={};Object.keys(be).forEach(function(e){d[e]=r.def(JSON.stringify(be[e]))}),t.invoke=function(a,r){switch(r.type){case 0:var n=["this",l.context,l.props,t.batchId];return a.def(o(r.data),".call(",n.slice(0,i(r.data.length+1,4)),")");case 1:return a.def(l.props,r.data);case 2:return a.def(l.context,r.data);case 3:return a.def("this",r.data);case 4:return r.data.append(t,a),r.data.ref;}},t.attribCache={};var c={};return t.scopeAttrib=function(e){if(e=_.id(e),e in c)return c[e];var t=u.scope[e];return t||(t=u.scope[e]=new de),c[e]=o(t)},t}function f(t){var o=t["static"];t=t.dynamic;var r;if("profile"in o){var i=!!o.profile;r=te(function(){return i}),r.enable=i}else if("profile"in t){var n=t.profile;r=C(n,function(e,t){return e.invoke(t,n)})}return r}function F(t){var a=t["static"],o=t.dynamic;if("framebuffer"in a){var i=a.framebuffer;return i?(i=r.getFramebuffer(i),te(function(e,t){var a=e.link(i),o=e.shared;return t.set(o.framebuffer,".next",a),o=o.context,t.set(o,".framebufferWidth",a+".width"),t.set(o,".framebufferHeight",a+".height"),a})):te(function(e,t){var a=e.shared;return t.set(a.framebuffer,".next","null"),a=a.context,t.set(a,".framebufferWidth",a+".drawingBufferWidth"),t.set(a,".framebufferHeight",a+".drawingBufferHeight"),"null"})}if("framebuffer"in o){var n=o.framebuffer;return C(n,function(t,a){var o=t.invoke(a,n),r=t.shared,i=r.framebuffer,o=a.def(i,".getFramebuffer(",o,")");return a.set(i,".next",o),r=r.context,a.set(r,".framebufferWidth",o+"?"+o+".width:"+r+".drawingBufferWidth"),a.set(r,".framebufferHeight",o+"?"+o+".height:"+r+".drawingBufferHeight"),o})}return null}function z(t,o){function r(t){if(t in i){var r=i[t];t=!0;var n=0|r.x,l=0|r.y,s,c;return"width"in r?s=0|r.width:t=!1,"height"in r?c=0|r.height:t=!1,new K(!t&&o&&o.thisDep,!t&&o&&o.contextDep,!t&&o&&o.propDep,function(t,a){var o=t.shared.context,i=s;"width"in r||(i=a.def(o,".","framebufferWidth","-",n));var d=c;return"height"in r||(d=a.def(o,".","framebufferHeight","-",l)),[n,l,i,d]})}if(t in e){var p=e[t];return t=C(p,function(t,a){var o=t.invoke(a,p),r=t.shared.context,i=a.def(o,".x|0"),e=a.def(o,".y|0"),n=a.def("\"width\" in ",o,"?",o,".width|0:","(",r,".","framebufferWidth","-",i,")"),o=a.def("\"height\" in ",o,"?",o,".height|0:","(",r,".","framebufferHeight","-",e,")");return[i,e,n,o]}),o&&(t.thisDep=t.thisDep||o.thisDep,t.contextDep=t.contextDep||o.contextDep,t.propDep=t.propDep||o.propDep),t}return o?new K(o.thisDep,o.contextDep,o.propDep,function(e,t){var a=e.shared.context;return[0,0,t.def(a,".","framebufferWidth"),t.def(a,".","framebufferHeight")]}):null}var i=t["static"],e=t.dynamic;if(t=r("viewport")){var n=t;t=new K(t.thisDep,t.contextDep,t.propDep,function(e,t){var a=n.append(e,t),o=e.shared.context;return t.set(o,".viewportWidth",a[2]),t.set(o,".viewportHeight",a[3]),a})}return{viewport:t,scissor_box:r("scissor.box")}}function w(t,a){var o=t["static"];if("string"==typeof o.frag&&"string"==typeof o.vert){if(0<Object.keys(a.dynamic).length)return null;var o=a["static"],r=Object.keys(o);if(0<r.length&&"number"==typeof o[r[0]]){for(var i=[],e=0;e<r.length;++e)i.push([0|o[r[e]],r[e]]);return i}}return null}function U(t,o,r){function i(t){if(t in e){var o=_.id(e[t]);return t=te(function(){return o}),t.id=o,t}if(t in n){var r=n[t];return C(r,function(e,t){var a=e.invoke(t,r);return t.def(e.shared.strings,".id(",a,")")})}return null}var e=t["static"],n=t.dynamic,l=i("frag"),s=i("vert"),d=null;return P(l)&&P(s)?(d=A.program(s.id,l.id,null,r),t=te(function(e){return e.link(d)})):t=new K(l&&l.thisDep||s&&s.thisDep,l&&l.contextDep||s&&s.contextDep,l&&l.propDep||s&&s.propDep,function(t,a){var o=t.shared.shader,r;r=l?l.append(t,a):a.def(o,".","frag");var i;return i=s?s.append(t,a):a.def(o,".","vert"),a.def(o+".program("+i+","+r+")")}),{frag:l,vert:s,progVar:t,program:d}}function E(t){function a(e,t){if(e in o){var n=0|o[e];return te(function(e){return t&&(e.OFFSET=n),n})}if(e in r){var l=r[e];return C(l,function(e,a){var o=e.invoke(a,l);return t&&(e.OFFSET=o),o})}return t&&i?te(function(e){return e.OFFSET="0",0}):null}var o=t["static"],r=t.dynamic,i=function(){if("elements"in o){var t=o.elements;ee(t)?t=e.getElements(e.create(t,!0)):t&&(t=e.getElements(t));var i=te(function(e){if(t){var a=e.link(t);return e.ELEMENTS=a}return e.ELEMENTS=null});return i.value=t,i}if("elements"in r){var n=r.elements;return C(n,function(t,a){var o=t.shared,r=o.isBufferArgs,o=o.elements,i=t.invoke(a,n),l=a.def("null"),r=a.def(r,"(",i,")"),i=t.cond(r).then(l,"=",o,".createStream(",i,");")["else"](l,"=",o,".getElements(",i,");");return a.entry(i),a.exit(t.cond(r).then(o,".destroyStream(",l,");")),t.ELEMENTS=l})}return null}(),n=a("offset",!0);return{elements:i,primitive:function(){if("primitive"in o){var e=o.primitive;return te(function(){return he[e]})}if("primitive"in r){var t=r.primitive;return C(t,function(o,a){var r=o.constants.primTypes,i=o.invoke(a,t);return a.def(r,"[",i,"]")})}return i?P(i)?i.value?te(function(e,t){return t.def(e.ELEMENTS,".primType")}):te(function(){return 4}):new K(i.thisDep,i.contextDep,i.propDep,function(e,t){var a=e.ELEMENTS;return t.def(a,"?",a,".primType:",4)}):null}(),count:function(){if("count"in o){var e=0|o.count;return te(function(){return e})}if("count"in r){var t=r.count;return C(t,function(e,a){return e.invoke(a,t)})}return i?P(i)?i?n?new K(n.thisDep,n.contextDep,n.propDep,function(e,t){return t.def(e.ELEMENTS,".vertCount-",e.OFFSET)}):te(function(e,t){return t.def(e.ELEMENTS,".vertCount")}):te(function(){return-1}):new K(i.thisDep||n.thisDep,i.contextDep||n.contextDep,i.propDep||n.propDep,function(e,t){var a=e.ELEMENTS;return e.OFFSET?t.def(a,"?",a,".vertCount-",e.OFFSET,":-1"):t.def(a,"?",a,".vertCount:-1")}):null}(),instances:a("instances",!1),offset:n}}function H(t){var o=t["static"],r=t.dynamic,i={};return ye.forEach(function(t){function e(e,n){if(t in o){var l=e(o[t]);i[a]=te(function(){return l})}else if(t in r){var s=r[t];i[a]=C(s,function(e,t){return n(e,t,e.invoke(t,s))})}}var a=L(t);return"cull.enable"===t||"blend.enable"===t||"dither"===t||"stencil.enable"===t||"depth.enable"===t||"scissor.enable"===t||"polygonOffset.enable"===t||"sample.alpha"===t||"sample.enable"===t||"depth.mask"===t?e(function(e){return e},function(e,t,a){return a}):"depth.func"===t?e(function(e){return De[e]},function(e,t,a){return t.def(e.constants.compareFuncs,"[",a,"]")}):"depth.range"===t?e(function(e){return e},function(e,t,o){return e=t.def("+",o,"[0]"),t=t.def("+",o,"[1]"),[e,t]}):"blend.func"===t?e(function(e){return[ze["srcRGB"in e?e.srcRGB:e.src],ze["dstRGB"in e?e.dstRGB:e.dst],ze["srcAlpha"in e?e.srcAlpha:e.src],ze["dstAlpha"in e?e.dstAlpha:e.dst]]},function(t,o,r){function i(t,a){return o.def("\"",t,a,"\" in ",r,"?",r,".",t,a,":",r,".",t)}t=t.constants.blendFuncs;var n=i("src","RGB"),l=i("dst","RGB"),n=o.def(t,"[",n,"]"),s=o.def(t,"[",i("src","Alpha"),"]"),l=o.def(t,"[",l,"]");return t=o.def(t,"[",i("dst","Alpha"),"]"),[n,l,s,t]}):"blend.equation"===t?e(function(e){return"string"==typeof e?[pe[e],pe[e]]:"object"==typeof e?[pe[e.rgb],pe[e.alpha]]:void 0},function(t,o,r){var i=t.constants.blendEquations,n=o.def(),e=o.def();return t=t.cond("typeof ",r,"===\"string\""),t.then(n,"=",e,"=",i,"[",r,"];"),t["else"](n,"=",i,"[",r,".rgb];",e,"=",i,"[",r,".alpha];"),o(t),[n,e]}):"blend.color"===t?e(function(e){return j(4,function(t){return+e[t]})},function(e,t,o){return j(4,function(e){return t.def("+",o,"[",e,"]")})}):"stencil.mask"===t?e(function(e){return 0|e},function(e,t,a){return t.def(a,"|0")}):"stencil.func"===t?e(function(e){return[De[e.cmp||"keep"],e.ref||0,"mask"in e?e.mask:-1]},function(e,t,o){e=t.def("\"cmp\" in ",o,"?",e.constants.compareFuncs,"[",o,".cmp]",":",7680);var r=t.def(o,".ref|0");return t=t.def("\"mask\" in ",o,"?",o,".mask|0:-1"),[e,r,t]}):"stencil.opFront"===t||"stencil.opBack"===t?e(function(e){return["stencil.opBack"===t?1029:1028,Oe[e.fail||"keep"],Oe[e.zfail||"keep"],Oe[e.zpass||"keep"]]},function(a,o,r){function i(t){return o.def("\"",t,"\" in ",r,"?",e,"[",r,".",t,"]:",7680)}var e=a.constants.stencilOps;return["stencil.opBack"===t?1029:1028,i("fail"),i("zfail"),i("zpass")]}):"polygonOffset.offset"===t?e(function(e){return[0|e.factor,0|e.units]},function(e,t,o){return e=t.def(o,".factor|0"),t=t.def(o,".units|0"),[e,t]}):"cull.face"===t?e(function(e){var t=0;return"front"===e?t=1028:"back"==e&&(t=1029),t},function(e,t,a){return t.def(a,"===\"front\"?",1028,":",1029)}):"lineWidth"===t?e(function(e){return e},function(e,t,a){return a}):"frontFace"===t?e(function(e){return Re[e]},function(e,t,a){return t.def(a+"===\"cw\"?2304:2305")}):"colorMask"===t?e(function(e){return e.map(function(e){return!!e})},function(e,t,o){return j(4,function(e){return"!!"+o+"["+e+"]"})}):"sample.coverage"===t?e(function(e){return["value"in e?e.value:1,!!e.invert]},function(e,t,o){return e=t.def("\"value\" in ",o,"?+",o,".value:1"),t=t.def("!!",o,".invert"),[e,t]}):void 0}),i}function R(t){var o=t["static"],r=t.dynamic,i={};return Object.keys(o).forEach(function(e){var t=o[e],a;if("number"==typeof t||"boolean"==typeof t)a=te(function(){return t});else if("function"==typeof t){var r=t._reglType;"texture2d"===r||"textureCube"===r?a=te(function(e){return e.link(t)}):("framebuffer"===r||"framebufferCube"===r)&&(a=te(function(e){return e.link(t.color[0])}))}else v(t)&&(a=te(function(e){return e.global.def("[",j(t.length,function(e){return t[e]}),"]")}));a.value=t,i[e]=a}),Object.keys(r).forEach(function(e){var t=r[e];i[e]=C(t,function(e,a){return e.invoke(a,t)})}),i}function q(t){var o=t["static"],e=t.dynamic,r={};return Object.keys(o).forEach(function(e){var t=o[e],i=_.id(e),s=new de;if(ee(t))s.state=1,s.buffer=b.getBuffer(b.create(t,34962,!1,!0)),s.type=0;else{var a=b.getBuffer(t);if(a)s.state=1,s.buffer=a,s.type=0;else if("constant"in t){var d=t.constant;s.buffer="null",s.state=2,"number"==typeof d?s.x=d:Ie.forEach(function(e,t){t<d.length&&(s[e]=d[t])})}else{var a=ee(t.buffer)?b.getBuffer(b.create(t.buffer,34962,!1,!0)):b.getBuffer(t.buffer),p=0|t.offset,u=0|t.stride,l=0|t.size,g=!!t.normalized,n=0;"type"in t&&(n=ce[t.type]),t=0|t.divisor,s.buffer=a,s.state=1,s.size=l,s.normalized=g,s.type=n||a.dtype,s.offset=p,s.stride=u,s.divisor=t}}r[e]=te(function(e){var t=e.attribCache;if(i in t)return t[i];var o={isStream:!1};return Object.keys(s).forEach(function(e){o[e]=s[e]}),s.buffer&&(o.buffer=e.link(s.buffer),o.type=o.type||o.buffer+".dtype"),t[i]=o})}),Object.keys(e).forEach(function(t){var o=e[t];r[t]=C(o,function(t,r){function a(e){r(s[e],"=",i,".",e,"|0;")}var i=t.invoke(r,o),e=t.shared,n=t.constants,l=e.isBufferArgs,e=e.buffer,s={isStream:r.def(!1)},d=new de;d.state=1,Object.keys(d).forEach(function(e){s[e]=r.def(""+d[e])});var c=s.buffer,p=s.type;return r("if(",l,"(",i,")){",s.isStream,"=true;",c,"=",e,".createStream(",34962,",",i,");",p,"=",c,".dtype;","}else{",c,"=",e,".getBuffer(",i,");","if(",c,"){",p,"=",c,".dtype;","}else if(\"constant\" in ",i,"){",s.state,"=",2,";","if(typeof "+i+".constant === \"number\"){",s[Ie[0]],"=",i,".constant;",Ie.slice(1).map(function(e){return s[e]}).join("="),"=0;","}else{",Ie.map(function(e,t){return s[e]+"="+i+".constant.length>"+t+"?"+i+".constant["+t+"]:0;"}).join(""),"}}else{","if(",l,"(",i,".buffer)){",c,"=",e,".createStream(",34962,",",i,".buffer);","}else{",c,"=",e,".getBuffer(",i,".buffer);","}",p,"=\"type\" in ",i,"?",n.glTypes,"[",i,".type]:",c,".dtype;",s.normalized,"=!!",i,".normalized;"),a("size"),a("offset"),a("stride"),a("divisor"),r("}}"),r.exit("if(",s.isStream,"){",e,".destroyStream(",c,");","}"),s})}),r}function G(t){var a=t["static"],o=t.dynamic;if("vao"in a){var r=a.vao;return null!==r&&null===u.getVAO(r)&&(r=u.createVAO(r)),te(function(e){return e.link(u.getVAO(r))})}if("vao"in o){var i=o.vao;return C(i,function(e,t){var a=e.invoke(t,i);return t.def(e.shared.vao+".getVAO("+a+")")})}return null}function D(e){var t=e["static"],o=e.dynamic,r={};return Object.keys(t).forEach(function(e){var o=t[e];r[e]=te(function(e){return"number"==typeof o||"boolean"==typeof o?""+o:e.link(o)})}),Object.keys(o).forEach(function(e){var t=o[e];r[e]=C(t,function(e,a){return e.invoke(a,t)})}),r}function m(o,i,s,d,e){function c(e){var t=x[e];t&&(m[e]=t)}var g=w(o,i),h=F(o,e),x=z(o,h,e),n=E(o,e),m=H(o,e),_=U(o,e,g);c("viewport"),c(L("scissor.box"));var p=0<Object.keys(m).length,h={framebuffer:h,draw:n,shader:_,state:m,dirty:p,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(h.profile=f(o,e),h.uniforms=R(s,e),h.drawVAO=h.scopeVAO=G(o,e),!h.drawVAO&&_.program&&!g&&y.angle_instanced_arrays){var r=!0;if(o=_.program.attributes.map(function(e){return e=i["static"][e],r=r&&!!e,e}),r&&0<o.length){var b=u.getVAO(u.createVAO(o));h.drawVAO=new K(null,null,null,function(e){return e.link(b)}),h.useVAO=!0}}return g?h.useVAO=!0:h.attributes=q(i,e),h.context=D(d,e),h}function x(t,a,o){var r=t.shared.context,i=t.scope();Object.keys(o).forEach(function(e){a.save(r,"."+e),i(r,".",e,"=",o[e].append(t,a),";")}),a(i)}function T(t,o,r,i){var n=t.shared,l=n.gl,s=n.framebuffer,d;ue&&(d=o.def(n.extensions,".webgl_draw_buffers"));var c=t.constants,n=c.drawBuffer,c=c.backBuffer;t=r?r.append(t,o):o.def(s,".next"),i||o("if(",t,"!==",s,".cur){"),o("if(",t,"){",l,".bindFramebuffer(",36160,",",t,".framebuffer);"),ue&&o(d,".drawBuffersWEBGL(",n,"[",t,".colorAttachments.length]);"),o("}else{",l,".bindFramebuffer(",36160,",null);"),ue&&o(d,".drawBuffersWEBGL(",c,");"),o("}",s,".cur=",t,";"),i||o("}")}function O(t,a,o){var r=t.shared,i=r.gl,e=t.current,s=t.next,c=r.current,p=r.next,l=t.cond(c,".dirty");ye.forEach(function(a){if(a=L(a),!(a in o.state)){var r,n;if(a in s){r=s[a],n=e[a];var u=j(ge[a].length,function(e){return l.def(r,"[",e,"]")});l(t.cond(u.map(function(e,t){return e+"!=="+n+"["+t+"]"}).join("||")).then(i,".",xe[a],"(",u,");",u.map(function(e,t){return n+"["+t+"]="+e}).join(";"),";"))}else r=l.def(p,".",a),u=t.cond(r,"!==",c,".",a),l(u),a in fe?u(t.cond(r).then(i,".enable(",fe[a],");")["else"](i,".disable(",fe[a],");"),c,".",a,"=",r,";"):u(i,".",xe[a],"(",r,");",c,".",a,"=",r,";")}}),0===Object.keys(o.state).length&&l(c,".dirty=false;"),a(l)}function S(t,a,o,r){var i=t.shared,n=t.current,s=i.current,d=i.gl;X(Object.keys(o)).forEach(function(i){var e=o[i];if(!r||r(e)){var c=e.append(t,a);if(fe[i]){var l=fe[i];P(e)?c?a(d,".enable(",l,");"):a(d,".disable(",l,");"):a(t.cond(c).then(d,".enable(",l,");")["else"](d,".disable(",l,");")),a(s,".",i,"=",c,";")}else if(v(c)){var p=n[i];a(d,".",xe[i],"(",c,");",c.map(function(e,t){return p+"["+t+"]="+e}).join(";"),";")}else a(d,".",xe[i],"(",c,");",s,".",i,"=",c,";")}})}function $(e,t){W&&(e.instancing=t.def(e.shared.extensions,".angle_instanced_arrays"))}function B(o,i,s,u,d){function e(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function y(t){r=i.def(),t(r,"=",e(),";"),"string"==typeof d?t(x,".count+=",d,";"):t(x,".count++;"),g&&(u?(_=i.def(),t(_,"=",p,".getNumPendingQueries();")):t(p,".beginQuery(",x,");"))}function f(t){t(x,".cpuTime+=",e(),"-",r,";"),g&&(u?t(p,".pushScopeStats(",_,",",p,".getNumPendingQueries(),",x,");"):t(p,".endQuery();"))}function h(e){var t=i.def(m,".profile");i(m,".profile=",e,";"),i.exit(m,".profile=",t,";")}var l=o.shared,x=o.stats,m=l.current,p=l.timer;s=s.profile;var r,_;if(s){if(P(s))return void(s.enable?(y(i),f(i.exit),h("true")):h("false"));s=s.append(o,i),h(s)}else s=i.def(m,".profile");l=o.block(),y(l),i("if(",s,"){",l,"}"),o=o.block(),f(o),i.exit("if(",s,"){",o,"}")}function V(t,o,a,r,i){function e(e){return 35664===e||35667===e||35671===e?2:35665===e||35668===e||35672===e?3:35666===e||35669===e||35673===e?4:1}function s(a,r,i){function e(){o("if(!",n,".buffer){",d,".enableVertexAttribArray(",l,");}");var e=i.type,a;a=i.size?o.def(i.size,"||",r):r,o("if(",n,".type!==",e,"||",n,".size!==",a,"||",p.map(function(e){return n+"."+e+"!=="+i[e]}).join("||"),"){",d,".bindBuffer(",34962,",",m,".buffer);",d,".vertexAttribPointer(",[l,a,e,i.normalized,i.stride,i.offset],");",n,".type=",e,";",n,".size=",a,";",p.map(function(e){return n+"."+e+"="+i[e]+";"}).join(""),"}"),W&&(e=i.divisor,o("if(",n,".divisor!==",e,"){",t.instancing,".vertexAttribDivisorANGLE(",[l,e],");",n,".divisor=",e,";}"))}function s(){o("if(",n,".buffer){",d,".disableVertexAttribArray(",l,");",n,".buffer=null;","}if(",Ie.map(function(e,t){return n+"."+e+"!=="+g[t]}).join("||"),"){",d,".vertexAttrib4f(",l,",",g,");",Ie.map(function(e,t){return n+"."+e+"="+g[t]+";"}).join(""),"}")}var d=u.gl,l=o.def(a,".location"),n=o.def(u.attributes,"[",l,"]");a=i.state;var m=i.buffer,g=[i.x,i.y,i.z,i.w],p=["buffer","normalized","offset","stride"];1===a?e():2===a?s():(o("if(",a,"===",1,"){"),e(),o("}else{"),s(),o("}"))}var u=t.shared;r.forEach(function(r){var d=r.name,c=a.attributes[d],p;if(c){if(!i(c))return;p=c.append(t,o)}else{if(!i(Me))return;var u=t.scopeAttrib(d);p={},Object.keys(new de).forEach(function(e){p[e]=o.def(u,".",e)})}s(t.link(r),e(r.info.type),p)})}function N(i,a,s,d,e){for(var c=i.shared,u=c.gl,g=0,h;g<d.length;++g){var y=d[g],f=y.name,x=y.info.type,b=s.uniforms[f],y=i.link(y)+".location",w;if(b){if(!e(b))continue;if(P(b)){f=b.value,35678===x||35680===x?(x=i.link(f._texture||f.color[0]._texture),a(u,".uniform1i(",y,",",x+".bind());"),a.exit(x,".unbind();")):35674===x||35675===x||35676===x?(f=i.global.def("new Float32Array(["+Array.prototype.slice.call(f)+"])"),b=2,35675===x?b=3:35676===x&&(b=4),a(u,".uniformMatrix",b,"fv(",y,",false,",f,");")):(5126===x?h="1f":35664===x?h="2f":35665===x?h="3f":35666===x?h="4f":35670===x?h="1i":5124===x?h="1i":35671===x?h="2i":35667===x?h="2i":35672===x?h="3i":35668===x?h="3i":35673===x?h="4i":35669===x?h="4i":void 0,a(u,".uniform",h,"(",y,",",v(f)?Array.prototype.slice.call(f):f,");"));continue}else w=b.append(i,a)}else{if(!e(Me))continue;w=a.def(c.uniforms,"[",_.id(f),"]")}switch(35678===x?a("if(",w,"&&",w,"._reglType===\"framebuffer\"){",w,"=",w,".color[0];","}"):35680===x&&a("if(",w,"&&",w,"._reglType===\"framebufferCube\"){",w,"=",w,".color[0];","}"),f=1,x){case 35678:case 35680:x=a.def(w,"._texture"),a(u,".uniform1i(",y,",",x,".bind());"),a.exit(x,".unbind();");continue;case 5124:case 35670:h="1i";break;case 35667:case 35671:h="2i",f=2;break;case 35668:case 35672:h="3i",f=3;break;case 35669:case 35673:h="4i",f=4;break;case 5126:h="1f";break;case 35664:h="2f",f=2;break;case 35665:h="3f",f=3;break;case 35666:h="4f",f=4;break;case 35674:h="Matrix2fv";break;case 35675:h="Matrix3fv";break;case 35676:h="Matrix4fv";}if(a(u,".uniform",h,"(",y,","),"M"===h.charAt(0)){var y=o(x-35674+2,2),T=i.global.def("new Float32Array(",y,")");a("false,(Array.isArray(",w,")||",w," instanceof Float32Array)?",w,":(",j(y,function(e){return T+"["+e+"]="+w+"["+e+"]"}),",",T,")")}else 1<f?a(j(f,function(e){return w+"["+e+"]"})):a(w);a(");")}}function J(o,a,i,s){function d(e){var t=l[e];return t?t.contextDep&&s.contextDynamic||t.propDep?t.append(o,i):t.append(o,a):a.def(y,".",e)}function e(){function e(){i(x,".drawElementsInstancedANGLE(",[n,f,_,p+"<<(("+_+"-5121)>>1)",r],");")}function t(){i(x,".drawArraysInstancedANGLE(",[n,p,f,r],");")}m?u?e():(i("if(",m,"){"),e(),i("}else{"),t(),i("}")):t()}function c(){function e(){i(h+".drawElements("+[n,f,_,p+"<<(("+_+"-5121)>>1)"]+");")}function t(){i(h+".drawArrays("+[n,p,f]+");")}m?u?e():(i("if(",m,"){"),e(),i("}else{"),t(),i("}")):t()}var g=o.shared,h=g.gl,y=g.draw,l=s.draw,m=function(){var t=l.elements,r=a;return t?((t.contextDep&&s.contextDynamic||t.propDep)&&(r=i),t=t.append(o,r)):t=r.def(y,".","elements"),t&&r("if("+t+")"+h+".bindBuffer(34963,"+t+".buffer.buffer);"),t}(),n=d("primitive"),p=d("offset"),f=function(){var t=l.count,r=a;return t?((t.contextDep&&s.contextDynamic||t.propDep)&&(r=i),t=t.append(o,r)):t=r.def(y,".","count"),t}();if(!("number"==typeof f))i("if(",f,"){"),i.exit("}");else if(0===f)return;var r,x;W&&(r=d("instances"),x=o.instancing);var _=m+".type",u=l.elements&&P(l.elements);W&&("number"!=typeof r||0<=r)?"string"==typeof r?(i("if(",r,">0){"),e(),i("}else if(",r,"<0){"),c(),i("}")):e():c()}function k(t,a,o,r,i){return a=I(),i=a.proc("body",i),W&&(a.instancing=i.def(a.shared.extensions,".angle_instanced_arrays")),t(a,i,o,r),a.compile().body}function Q(e,t,a,o){$(e,t),a.useVAO?a.drawVAO?t(e.shared.vao,".setVAO(",a.drawVAO.append(e,t),");"):t(e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"):(t(e.shared.vao,".setVAO(null);"),V(e,t,a,o.attributes,function(){return!0})),N(e,t,a,o.uniforms,function(){return!0}),J(e,t,t,a)}function ae(t,a){var o=t.proc("draw",1);$(t,o),x(t,o,a.context),T(t,o,a.framebuffer),O(t,o,a),S(t,o,a.state),B(t,o,a,!1,!0);var r=a.shader.progVar.append(t,o);if(o(t.shared.gl,".useProgram(",r,".program);"),a.shader.program)Q(t,o,a,a.shader.program);else{o(t.shared.vao,".setVAO(null);");var i=t.global.def("{}"),e=o.def(r,".id"),n=o.def(i,"[",e,"]");o(t.cond(n).then(n,".call(this,a0);")["else"](n,"=",i,"[",e,"]=",t.link(function(e){return k(Q,t,a,e,1)}),"(",r,");",n,".call(this,a0);"))}0<Object.keys(a.state).length&&o(t.shared.current,".dirty=true;")}function oe(t,a,o,r){function i(){return!0}t.batchId="a1",$(t,a),V(t,a,o,r.attributes,i),N(t,a,o,r.uniforms,i),J(t,a,a,o)}function ie(t,a,o,r){function i(e){return e.contextDep&&n||e.propDep}function e(e){return!i(e)}$(t,a);var n=o.contextDep,s=a.def(),c=a.def();t.shared.props=c,t.batchId=s;var p=t.scope(),u=t.scope();a(p.entry,"for(",s,"=0;",s,"<","a1",";++",s,"){",c,"=","a0","[",s,"];",u,"}",p.exit),o.needsContext&&x(t,u,o.context),o.needsFramebuffer&&T(t,u,o.framebuffer),S(t,u,o.state,i),o.profile&&i(o.profile)&&B(t,u,o,!1,!0),r?(o.useVAO?o.drawVAO?i(o.drawVAO)?u(t.shared.vao,".setVAO(",o.drawVAO.append(t,u),");"):p(t.shared.vao,".setVAO(",o.drawVAO.append(t,p),");"):p(t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"):(p(t.shared.vao,".setVAO(null);"),V(t,p,o,r.attributes,e),V(t,u,o,r.attributes,i)),N(t,p,o,r.uniforms,e),N(t,u,o,r.uniforms,i),J(t,p,u,o)):(a=t.global.def("{}"),r=o.shader.progVar.append(t,u),c=u.def(r,".id"),p=u.def(a,"[",c,"]"),u(t.shared.gl,".useProgram(",r,".program);","if(!",p,"){",p,"=",a,"[",c,"]=",t.link(function(e){return k(oe,t,o,e,2)}),"(",r,");}",p,".call(this,a0[",s,"],",s,");"))}function M(t,o){function r(e){return e.contextDep&&i||e.propDep}var a=t.proc("batch",2);t.batchId="0",$(t,a);var i=!1,n=!0;Object.keys(o.context).forEach(function(e){i=i||o.context[e].propDep}),i||(x(t,a,o.context),n=!1);var l=o.framebuffer,s=!1;if(l?(l.propDep?i=s=!0:l.contextDep&&i&&(s=!0),s||T(t,a,l)):T(t,a,null),o.state.viewport&&o.state.viewport.propDep&&(i=!0),O(t,a,o),S(t,a,o.state,function(e){return!r(e)}),o.profile&&r(o.profile)||B(t,a,o,!1,"a1"),o.contextDep=i,o.needsContext=n,o.needsFramebuffer=s,n=o.shader.progVar,n.contextDep&&i||n.propDep)ie(t,a,o,null);else if(n=n.append(t,a),a(t.shared.gl,".useProgram(",n,".program);"),o.shader.program)ie(t,a,o,o.shader.program);else{a(t.shared.vao,".setVAO(null);");var l=t.global.def("{}"),s=a.def(n,".id"),d=a.def(l,"[",s,"]");a(t.cond(d).then(d,".call(this,a0,a1);")["else"](d,"=",l,"[",s,"]=",t.link(function(e){return k(ie,t,o,e,2)}),"(",n,");",d,".call(this,a0,a1);"))}0<Object.keys(o.state).length&&a(t.shared.current,".dirty=true;")}function ne(t,a){function o(o){var i=a.shader[o];i&&r.set(e.shader,"."+o,i.append(t,r))}var r=t.proc("scope",3);t.batchId="a2";var e=t.shared,i=e.current;x(t,r,a.context),a.framebuffer&&a.framebuffer.append(t,r),X(Object.keys(a.state)).forEach(function(o){var i=a.state[o].append(t,r);v(i)?i.forEach(function(e,a){r.set(t.next[o],"["+a+"]",e)}):r.set(e.next,"."+o,i)}),B(t,r,a,!0,!0),["elements","offset","count","instances","primitive"].forEach(function(o){var i=a.draw[o];i&&r.set(e.draw,"."+o,""+i.append(t,r))}),Object.keys(a.uniforms).forEach(function(o){r.set(e.uniforms,"["+_.id(o)+"]",a.uniforms[o].append(t,r))}),Object.keys(a.attributes).forEach(function(e){var o=a.attributes[e].append(t,r),i=t.scopeAttrib(e);Object.keys(new de).forEach(function(e){r.set(i,"."+e,o[e])})}),a.scopeVAO&&r.set(e.vao,".targetVAO",a.scopeVAO.append(t,r)),o("vert"),o("frag"),0<Object.keys(a.state).length&&(r(i,".dirty=true;"),r.exit(i,".dirty=true;")),r("a1(",t.shared.context,",a0,",t.batchId,");")}function le(e){if("object"==typeof e&&!v(e)){for(var t=Object.keys(e),a=0;a<t.length;++a)if(re.isDynamic(e[t[a]]))return!0;return!1}}function se(t,a,o){function r(e,t){n.forEach(function(a){var o=i[a];re.isDynamic(o)&&(o=e.invoke(t,o),t(u,".",a,"=",o,";"))})}var i=a["static"][o];if(i&&le(i)){var e=t.global,n=Object.keys(i),s=!1,d=!1,p=!1,u=t.global.def("{}");n.forEach(function(a){var o=i[a];if(re.isDynamic(o))"function"==typeof o&&(o=i[a]=re.unbox(o)),a=C(o,null),s=s||a.thisDep,p=p||a.propDep,d=d||a.contextDep;else{switch(e(u,".",a,"="),typeof o){case"number":e(o);break;case"string":e("\"",o,"\"");break;case"object":Array.isArray(o)&&e("[",o.join(),"]");break;default:e(t.link(o));}e(";")}}),a.dynamic[o]=new re.DynamicVariable(4,{thisDep:s,contextDep:d,propDep:p,ref:u,append:r}),delete a["static"][o]}}var de=u.Record,pe={add:32774,subtract:32778,"reverse subtract":32779};y.ext_blend_minmax&&(pe.min=32775,pe.max=32776);var W=y.angle_instanced_arrays,ue=y.webgl_draw_buffers,ge={dirty:!0,profile:d.profile},me={},ye=[],fe={},xe={};h("dither",3024),h("blend.enable",3042),p("blend.color","blendColor",[0,0,0,0]),p("blend.equation","blendEquationSeparate",[32774,32774]),p("blend.func","blendFuncSeparate",[1,0,1,0]),h("depth.enable",2929,!0),p("depth.func","depthFunc",513),p("depth.range","depthRange",[0,1]),p("depth.mask","depthMask",!0),p("colorMask","colorMask",[!0,!0,!0,!0]),h("cull.enable",2884),p("cull.face","cullFace",1029),p("frontFace","frontFace",2305),p("lineWidth","lineWidth",1),h("polygonOffset.enable",32823),p("polygonOffset.offset","polygonOffset",[0,0]),h("sample.alpha",32926),h("sample.enable",32928),p("sample.coverage","sampleCoverage",[1,!1]),h("stencil.enable",2960),p("stencil.mask","stencilMask",-1),p("stencil.func","stencilFunc",[519,0,-1]),p("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),p("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),h("scissor.enable",3089),p("scissor.box","scissor",[0,0,s.drawingBufferWidth,s.drawingBufferHeight]),p("viewport","viewport",[0,0,s.drawingBufferWidth,s.drawingBufferHeight]);var _e={gl:s,context:l,strings:_,next:me,current:ge,draw:t,elements:e,buffer:b,shader:A,attributes:u.state,vao:u,uniforms:n,framebuffer:r,extensions:y,timer:g,isBufferArgs:ee},be={primTypes:he,compareFuncs:De,blendFuncs:ze,blendEquations:pe,stencilOps:Oe,glTypes:ce,orientationType:Re};ue&&(be.backBuffer=[1029],be.drawBuffer=j(c.maxDrawbuffers,function(e){return 0===e?[0]:j(e,function(e){return 36064+e})}));var Z=0;return{next:me,current:ge,procs:function(){var t=I(),a=t.proc("poll"),o=t.proc("refresh"),r=t.block();a(r),o(r);var e=t.shared,i=e.gl,s=e.next,d=e.current;r(d,".dirty=false;"),T(t,a),T(t,o,null,!0);var l;W&&(l=t.link(W)),y.oes_vertex_array_object&&o(t.link(y.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var u=0;u<c.maxAttributes;++u){var g=o.def(e.attributes,"[",u,"]"),p=t.cond(g,".buffer");p.then(i,".enableVertexAttribArray(",u,");",i,".bindBuffer(",34962,",",g,".buffer.buffer);",i,".vertexAttribPointer(",u,",",g,".size,",g,".type,",g,".normalized,",g,".stride,",g,".offset);")["else"](i,".disableVertexAttribArray(",u,");",i,".vertexAttrib4f(",u,",",g,".x,",g,".y,",g,".z,",g,".w);",g,".buffer=null;"),o(p),W&&o(l,".vertexAttribDivisorANGLE(",u,",",g,".divisor);")}return o(t.shared.vao,".currentVAO=null;",t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"),Object.keys(fe).forEach(function(n){var l=fe[n],e=r.def(s,".",n),c=t.block();c("if(",e,"){",i,".enable(",l,")}else{",i,".disable(",l,")}",d,".",n,"=",e,";"),o(c),a("if(",e,"!==",d,".",n,"){",c,"}")}),Object.keys(xe).forEach(function(l){var c=xe[l],u=ge[l],g=t.block(),p,h;g(i,".",c,"("),v(u)?(c=u.length,p=t.global.def(s,".",l),h=t.global.def(d,".",l),g(j(c,function(e){return p+"["+e+"]"}),");",j(c,function(e){return h+"["+e+"]="+p+"["+e+"];"}).join("")),a("if(",j(c,function(e){return p+"["+e+"]!=="+h+"["+e+"]"}).join("||"),"){",g,"}")):(p=r.def(s,".",l),h=r.def(d,".",l),g(p,");",d,".",l,"=",p,";"),a("if(",p,"!==",h,"){",g,"}")),o(g)}),t.compile()}(),compile:function(t,o,a,r,i){var e=I();return e.stats=e.link(i),Object.keys(o["static"]).forEach(function(t){se(e,o,t)}),Pe.forEach(function(a){se(e,t,a)}),a=m(t,o,a,r,e),ae(e,a),ne(e,a),M(e,a),e.compile()}}}function L(e,t){for(var a=0;a<e.length;++a)if(e[a]===t)return a;return-1}var oe=function(t,a){for(var o=Object.keys(a),r=0;r<o.length;++r)t[o[r]]=a[o[r]];return t},H=0,re={DynamicVariable:e,define:function(t,a){return new e(t,r(a+""))},isDynamic:function(t){return"function"==typeof t&&!t._reglType||t instanceof e},unbox:function(t){return"function"==typeof t?new e(0,t):t},accessor:r},ie={next:"function"==typeof requestAnimationFrame?function(e){return requestAnimationFrame(e)}:function(e){return setTimeout(e,16)},cancel:"function"==typeof cancelAnimationFrame?function(e){return cancelAnimationFrame(e)}:clearTimeout},ne="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date},le=d();le.zero=d();var se=function(t,o){var a=1;o.ext_texture_filter_anisotropic&&(a=t.getParameter(34047));var i=1,l=1;o.webgl_draw_buffers&&(i=t.getParameter(34852),l=t.getParameter(36063));var s=!!o.oes_texture_float;if(s){s=t.createTexture(),t.bindTexture(3553,s),t.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var p=t.createFramebuffer();if(t.bindFramebuffer(36160,p),t.framebufferTexture2D(36160,36064,3553,s,0),t.bindTexture(3553,null),36053!==t.checkFramebufferStatus(36160))s=!1;else{t.viewport(0,0,1,1),t.clearColor(1,0,0,1),t.clear(16384);var u=le.allocType(5126,4);t.readPixels(0,0,1,1,6408,5126,u),t.getError()?s=!1:(t.deleteFramebuffer(p),t.deleteTexture(s),s=1===u[0]),le.freeType(u)}}return u=!0,"undefined"!=typeof navigator&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))||(u=t.createTexture(),p=le.allocType(5121,36),t.activeTexture(33984),t.bindTexture(34067,u),t.texImage2D(34069,0,6408,3,3,0,6408,5121,p),le.freeType(p),t.bindTexture(34067,null),t.deleteTexture(u),u=!t.getError()),{colorBits:[t.getParameter(3410),t.getParameter(3411),t.getParameter(3412),t.getParameter(3413)],depthBits:t.getParameter(3414),stencilBits:t.getParameter(3415),subpixelBits:t.getParameter(3408),extensions:Object.keys(o).filter(function(e){return!!o[e]}),maxAnisotropic:a,maxDrawbuffers:i,maxColorAttachments:l,pointSizeDims:t.getParameter(33901),lineWidthDims:t.getParameter(33902),maxViewportDims:t.getParameter(3386),maxCombinedTextureUnits:t.getParameter(35661),maxCubeMapSize:t.getParameter(34076),maxRenderbufferSize:t.getParameter(34024),maxTextureUnits:t.getParameter(34930),maxTextureSize:t.getParameter(3379),maxAttributes:t.getParameter(34921),maxVertexUniforms:t.getParameter(36347),maxVertexTextureUnits:t.getParameter(35660),maxVaryingVectors:t.getParameter(36348),maxFragmentUniforms:t.getParameter(36349),glsl:t.getParameter(35724),renderer:t.getParameter(7937),vendor:t.getParameter(7936),version:t.getParameter(7938),readFloat:s,npotTextureCube:u}},z=function(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array||e instanceof Uint8ClampedArray},G=function(e){return Object.keys(e).map(function(t){return e[t]})},J={shape:function(e){for(var t=[];e.length;e=e[0])t.push(e.length);return t},flatten:function(t,a,o,i){var l=1;if(a.length)for(var s=0;s<a.length;++s)l*=a[s];else l=0;switch(o=i||le.allocType(o,l),a.length){case 0:break;case 1:for(i=a[0],a=0;a<i;++a)o[a]=t[a];break;case 2:for(i=a[0],a=a[1],s=l=0;s<i;++s)for(var p=t[s],r=0;r<a;++r)o[l++]=p[r];break;case 3:h(t,a[0],a[1],a[2],o,0);break;default:f(t,a,0,o,0);}return o}},de={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},ce={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},pe={dynamic:35048,stream:35040,static:35044},ue=J.flatten,ge=J.shape,me=[];me[5120]=1,me[5122]=2,me[5124]=4,me[5121]=1,me[5123]=2,me[5125]=4,me[5126]=4;var he={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},ye=new Float32Array(1),fe=new Uint32Array(ye.buffer),xe=[9984,9986,9985,9987],_e=[0,6409,6410,6407,6408],be={};be[6409]=be[6406]=be[6402]=1,be[34041]=be[6410]=2,be[6407]=be[35904]=3,be[6408]=be[35906]=4;var S=c("HTMLCanvasElement"),ve=c("OffscreenCanvas"),we=c("CanvasRenderingContext2D"),ke=c("ImageBitmap"),Te=c("HTMLImageElement"),Ae=c("HTMLVideoElement"),Se=Object.keys(de).concat([S,ve,we,ke,Te,Ae]),Ce=[];Ce[5121]=1,Ce[5126]=4,Ce[36193]=2,Ce[5123]=2,Ce[5125]=4;var Z=[];Z[32854]=2,Z[32855]=2,Z[36194]=2,Z[34041]=4,Z[33776]=.5,Z[33777]=.5,Z[33778]=1,Z[33779]=1,Z[35986]=.5,Z[35987]=1,Z[34798]=1,Z[35840]=.5,Z[35841]=.25,Z[35842]=.5,Z[35843]=.25,Z[36196]=.5;var w=[];w[32854]=2,w[32855]=2,w[36194]=2,w[33189]=2,w[36168]=1,w[34041]=4,w[35907]=4,w[34836]=16,w[34842]=8,w[34843]=6;var Le=function(o,a,i,l,s){function e(e){this.id=c++,this.refCount=1,this.renderbuffer=e,this.format=32854,this.height=this.width=0,s.profile&&(this.stats={size:0})}function d(e){var t=e.renderbuffer;o.bindRenderbuffer(36161,null),o.deleteRenderbuffer(t),e.renderbuffer=null,e.refCount=0,delete p[e.id],l.renderbufferCount--}var r={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};a.ext_srgb&&(r.srgba=35907),a.ext_color_buffer_half_float&&(r.rgba16f=34842,r.rgb16f=34843),a.webgl_color_buffer_float&&(r.rgba32f=34836);var n=[];Object.keys(r).forEach(function(e){n[r[e]]=e});var c=0,p={};return e.prototype.decRef=function(){0>=--this.refCount&&d(this)},s.profile&&(l.getTotalRenderbufferSize=function(){var e=0;return Object.keys(p).forEach(function(t){e+=p[t].stats.size}),e}),{create:function(t,a){function i(t,a){var c=0,p=0,u=32854;if("object"==typeof t&&t?("shape"in t?(p=t.shape,c=0|p[0],p=0|p[1]):("radius"in t&&(c=p=0|t.radius),"width"in t&&(c=0|t.width),"height"in t&&(p=0|t.height)),"format"in t&&(u=r[t.format])):"number"==typeof t?(c=0|t,p="number"==typeof a?0|a:c):t||(c=p=1),c!==d.width||p!==d.height||u!==d.format)return i.width=d.width=c,i.height=d.height=p,d.format=u,o.bindRenderbuffer(36161,d.renderbuffer),o.renderbufferStorage(36161,u,c,p),s.profile&&(d.stats.size=w[d.format]*d.width*d.height),i.format=n[d.format],i}var d=new e(o.createRenderbuffer());return p[d.id]=d,l.renderbufferCount++,i(t,a),i.resize=function(t,a){var r=0|t,e=0|a||r;return r===d.width&&e===d.height?i:(i.width=d.width=r,i.height=d.height=e,o.bindRenderbuffer(36161,d.renderbuffer),o.renderbufferStorage(36161,d.format,r,e),s.profile&&(d.stats.size=w[d.format]*d.width*d.height),i)},i._reglType="renderbuffer",i._renderbuffer=d,s.profile&&(i.stats=d.stats),i.destroy=function(){d.decRef()},i},clear:function(){G(p).forEach(d)},restore:function(){G(p).forEach(function(e){e.renderbuffer=o.createRenderbuffer(),o.bindRenderbuffer(36161,e.renderbuffer),o.renderbufferStorage(36161,e.format,e.width,e.height)}),o.bindRenderbuffer(36161,null)}}},E=[];E[6408]=4,E[6407]=3;var Ee=[];Ee[5121]=1,Ee[5126]=4,Ee[36193]=2;var Ie=["x","y","z","w"],Pe=["blend.func","blend.equation","stencil.func","stencil.opFront","stencil.opBack","sample.coverage","viewport","scissor.box","polygonOffset.offset"],ze={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},De={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Oe={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Re={cw:2304,ccw:2305},Me=new K(!1,!1,!1,function(){}),je=function(t,o){function l(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null}function s(t,a,o){var i=g.pop()||new l;i.startQueryIndex=t,i.endQueryIndex=a,i.sum=0,i.stats=o,r.push(i)}if(!o.ext_disjoint_timer_query)return null;var p=[],d=[],g=[],r=[],n=[],u=[];return{beginQuery:function(e){var t=p.pop()||o.ext_disjoint_timer_query.createQueryEXT();o.ext_disjoint_timer_query.beginQueryEXT(35007,t),d.push(t),s(d.length-1,d.length,e)},endQuery:function(){o.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:s,update:function(){var t,l;if(t=d.length,0!==t){u.length=i(u.length,t+1),n.length=i(n.length,t+1),n[0]=0;var s=u[0]=0;for(l=t=0;l<d.length;++l){var m=d[l];o.ext_disjoint_timer_query.getQueryObjectEXT(m,34919)?(s+=o.ext_disjoint_timer_query.getQueryObjectEXT(m,34918),p.push(m)):d[t++]=m,n[l+1]=s,u[l+1]=t}for(d.length=t,l=t=0;l<r.length;++l){var s=r[l],y=s.startQueryIndex,m=s.endQueryIndex;s.sum+=n[m]-n[y],y=u[y],m=u[m],m===y?(s.stats.gpuTime+=s.sum/1E6,g.push(s)):(s.startQueryIndex=y,s.endQueryIndex=m,r[t++]=s)}r.length=t}},getNumPendingQueries:function(){return d.length},clear:function(){p.push.apply(p,d);for(var e=0;e<p.length;e++)o.ext_disjoint_timer_query.deleteQueryEXT(p[e]);d.length=0,p.length=0},restore:function(){d.length=0,p.length=0}}};return function(o){function i(){if(0===K.length)v&&v.update(),Y=null;else{Y=ie.next(i),j();for(var e=K.length-1,t;0<=e;--e)t=K[e],t&&t(ee,null,0);z.flush(),v&&v.update()}}function b(){!Y&&0<K.length&&(Y=ie.next(i))}function c(){Y&&(ie.cancel(i),Y=null)}function e(e){e.preventDefault(),c(),B.forEach(function(e){e()})}function d(){z.getError(),H.restore(),P.restore(),G.restore(),D.restore(),x.restore(),N.restore(),R.restore(),v&&v.restore(),T.procs.refresh(),b(),V.forEach(function(e){e()})}function g(t){function o(t){var a={},o={};return Object.keys(t).forEach(function(r){var i=t[r];re.isDynamic(i)?o[r]=re.unbox(i,r):a[r]=i}),{dynamic:o,static:a}}function r(e){for(;l.length<e;)l.push(null);return l}var i=o(t.context||{}),n=o(t.uniforms||{}),e=o(t.attributes||{}),s=o(function(e){function t(e){if(e in o){var t=o[e];delete o[e],Object.keys(t).forEach(function(a){o[e+"."+a]=t[a]})}}var o=oe({},e);return delete o.uniforms,delete o.attributes,delete o.context,delete o.vao,"stencil"in o&&o.stencil.op&&(o.stencil.opBack=o.stencil.opFront=o.stencil.op,delete o.stencil.op),t("blend"),t("depth"),t("cull"),t("stencil"),t("polygonOffset"),t("scissor"),t("sample"),"vao"in e&&(o.vao=e.vao),o}(t));t={gpuTime:0,cpuTime:0,count:0};var i=T.compile(s,e,n,i,t),c=i.draw,p=i.batch,u=i.scope,l=[];return oe(function(e,t){var a;if("function"==typeof e)return u.call(this,null,e,0);if("function"==typeof t){if("number"==typeof e)for(a=0;a<e;++a)u.call(this,null,t,a);else if(Array.isArray(e))for(a=0;a<e.length;++a)u.call(this,e[a],t,a);else return u.call(this,e,t,0);}else if("number"!=typeof e){if(!Array.isArray(e))return c.call(this,e);if(e.length)return p.call(this,e,e.length)}else if(0<e)return p.call(this,r(0|e),0|e)},{stats:t})}function r(e,t){var a=0;T.procs.poll();var o=t.color;o&&(z.clearColor(+o[0]||0,+o[1]||0,+o[2]||0,+o[3]||0),a|=16384),"depth"in t&&(z.clearDepth(+t.depth),a|=256),"stencil"in t&&(z.clearStencil(0|t.stencil),a|=1024),z.clear(a)}function n(e){return K.push(e),b(),{cancel:function(){function t(){var e=L(K,t);K[e]=K[K.length-1],--K.length,0>=K.length&&c()}var a=L(K,e);K[a]=t}}}function u(){var e=O.viewport,t=O.scissor_box;e[0]=e[1]=t[0]=t[1]=0,ee.viewportWidth=ee.framebufferWidth=ee.drawingBufferWidth=e[2]=t[2]=z.drawingBufferWidth,ee.viewportHeight=ee.framebufferHeight=ee.drawingBufferHeight=e[3]=t[3]=z.drawingBufferHeight}function j(){ee.tick+=1,ee.time=l(),u(),T.procs.poll()}function t(){u(),T.procs.refresh(),v&&v.update()}function l(){return(ne()-w)/1E3}if(o=y(o),!o)return null;var z=o.gl,k=z.getContextAttributes();z.isContextLost();var H=_(z,o);if(!H)return null;var f=s(),q={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},m=H.extensions,v=je(z,m),w=ne(),C=z.drawingBufferWidth,E=z.drawingBufferHeight,ee={tick:0,time:0,viewportWidth:C,viewportHeight:E,framebufferWidth:C,framebufferHeight:E,drawingBufferWidth:C,drawingBufferHeight:E,pixelRatio:o.pixelRatio},A=se(z,m),G=I(z,q,o,function(e){return R.destroyBuffer(e)}),R=W(z,m,A,q,G),J=M(z,m,G,q),P=$(z,f,q,o),D=F(z,m,A,function(){T.procs.poll()},ee,q,o),x=Le(z,m,A,q,o),N=U(z,m,A,D,x,q),T=ae(z,f,m,A,G,J,D,N,{},R,P,{elements:null,primitive:4,count:-1,offset:0,instances:-1},ee,v,o),f=Q(z,N,T.procs.poll,ee,k,m,A),O=T.next,S=z.canvas,K=[],B=[],V=[],X=[o.onDestroy],Y=null;S&&(S.addEventListener("webglcontextlost",e,!1),S.addEventListener("webglcontextrestored",d,!1));var te=N.setFBO=g({framebuffer:re.define.call(null,1,"framebuffer")});return t(),k=oe(g,{clear:function(e){if(!("framebuffer"in e))r(null,e);else if(e.framebuffer&&"framebufferCube"===e.framebuffer_reglType)for(var t=0;6>t;++t)te(oe({framebuffer:e.framebuffer.faces[t]},e),r);else te(e,r)},prop:re.define.bind(null,1),context:re.define.bind(null,2),this:re.define.bind(null,3),draw:g({}),buffer:function(e){return G.create(e,34962,!1,!1)},elements:function(e){return J.create(e,!1)},texture:D.create2D,cube:D.createCube,renderbuffer:x.create,framebuffer:N.create,framebufferCube:N.createCube,vao:R.createVAO,attributes:k,frame:n,on:function(e,t){var o;switch(e){case"frame":return n(t);case"lost":o=B;break;case"restore":o=V;break;case"destroy":o=X;}return o.push(t),{cancel:function(){for(var e=0;e<o.length;++e)if(o[e]===t){o[e]=o[o.length-1],o.pop();break}}}},limits:A,hasExtension:function(e){return 0<=A.extensions.indexOf(e.toLowerCase())},read:f,destroy:function(){K.length=0,c(),S&&(S.removeEventListener("webglcontextlost",e),S.removeEventListener("webglcontextrestored",d)),P.clear(),N.clear(),x.clear(),D.clear(),J.clear(),G.clear(),R.clear(),v&&v.clear(),X.forEach(function(e){e()})},_gl:z,_refresh:t,poll:function(){j(),v&&v.update()},now:l,stats:q}),o.onDone(null,k),k}})},{}],1270:[function(e,t){/*!
 * repeat-string <https://github.com/jonschlinkert/repeat-string>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */'use strict';function a(e,t){if("string"!=typeof e)throw new TypeError("expected a string");if(1===t)return e;if(2===t)return e+e;var a=e.length*t;if(r!==e||"undefined"==typeof r)r=e,o="";else if(o.length>=a)return o.substr(0,a);for(;a>o.length&&1<t;)1&t&&(o+=e),t>>=1,e+=e;return o+=e,o=o.substr(0,a),o}var o="",r;t.exports=a},{}],1271:[function(e,t){(function(e){t.exports=e.performance&&e.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{}],1272:[function(e,t){"use strict";t.exports=function(t){for(var e=t.length,o=t[t.length-1],r=e,n=e-2;0<=n;--n){var l=o,s=t[n];o=l+s;var d=o-l,c=s-d;c&&(t[--r]=o,o=c)}for(var p=0,n=r;n<e;++n){var l=t[n],s=o;o=l+s;var d=o-l,c=s-d;c&&(t[p++]=c)}return t[p++]=o,t.length=p,t}},{}],1273:[function(e,t){"use strict";function a(e,t){for(var a=Array(e.length-1),o=1,n;o<e.length;++o){n=a[o-1]=Array(e.length-1);for(var l=0,s=0;l<e.length;++l)l!==t&&(n[s++]=e[o][l])}return a}function o(e){for(var t=Array(e),a=0;a<e;++a){t[a]=Array(e);for(var o=0;o<e;++o)t[a][o]=["m[",a,"][",o,"]"].join("")}return t}function r(e){return 1&e?"-":""}function n(e){if(1===e.length)return e[0];if(2===e.length)return["sum(",e[0],",",e[1],")"].join("");var t=e.length>>1;return["sum(",n(e.slice(0,t)),",",n(e.slice(t)),")"].join("")}function l(e){if(2===e.length)return["sum(prod(",e[0][0],",",e[1][1],"),prod(-",e[0][1],",",e[1][0],"))"].join("");for(var t=[],o=0;o<e.length;++o)t.push(["scale(",l(a(e,o)),",",r(o),e[0][o],")"].join(""));return n(t)}function s(e){var t=new Function("sum","scale","prod","compress",["function robustDeterminant",e,"(m){return compress(",l(o(e)),")};return robustDeterminant",e].join(""));return t(c,p,d,u)}var d=e("two-product"),c=e("robust-sum"),p=e("robust-scale"),u=e("robust-compress"),g=[function(){return[0]},function(e){return[e[0][0]]}];(function(){for(;g.length<6;)g.push(s(g.length));for(var e=[],a=["function robustDeterminant(m){switch(m.length){"],o=0;o<6;++o)e.push("det"+o),a.push("case ",o,":return det",o,"(m);");a.push("}var det=CACHE[m.length];if(!det)det=CACHE[m.length]=gen(m.length);return det(m);}return robustDeterminant"),e.push("CACHE","gen",a.join(""));var r=Function.apply(void 0,e);t.exports=r.apply(void 0,g.concat([g,s]));for(var o=0;o<g.length;++o)t.exports[o]=g[o]})()},{"robust-compress":1272,"robust-scale":1279,"robust-sum":1282,"two-product":1315}],1274:[function(e,t){"use strict";var o=e("two-product"),n=e("robust-sum");t.exports=function(e,t){for(var a=o(e[0],t[0]),l=1;l<e.length;++l)a=n(a,o(e[l],t[l]));return a}},{"robust-sum":1282,"two-product":1315}],1275:[function(e,t){"use strict";function a(e,t){for(var a=Array(e.length-1),o=1,n;o<e.length;++o){n=a[o-1]=Array(e.length-1);for(var l=0,s=0;l<e.length;++l)l!==t&&(n[s++]=e[o][l])}return a}function o(e){for(var t=Array(e),a=0;a<e;++a){t[a]=Array(e);for(var o=0;o<e;++o)t[a][o]=["m",o,"[",e-a-2,"]"].join("")}return t}function r(e){if(1===e.length)return e[0];if(2===e.length)return["sum(",e[0],",",e[1],")"].join("");var t=e.length>>1;return["sum(",r(e.slice(0,t)),",",r(e.slice(t)),")"].join("")}function n(e,t){if("m"===e.charAt(0)){if("w"===t.charAt(0)){var a=e.split("[");return["w",t.substr(1),"m",a[0].substr(1)].join("")}return["prod(",e,",",t,")"].join("")}return n(t,e)}function l(e){return!0&e?"-":""}function s(e){if(2===e.length)return[["diff(",n(e[0][0],e[1][1]),",",n(e[1][0],e[0][1]),")"].join("")];for(var t=[],o=0;o<e.length;++o)t.push(["scale(",r(s(a(e,o))),",",l(o),e[0][o],")"].join(""));return t}function d(e,t){for(var a=[],o=0;o<t-2;++o)a.push(["prod(m",e,"[",o,"],m",e,"[",o,"])"].join(""));return r(a)}function c(e){for(var t=[],n=[],l=o(e),c=0;c<e;++c)l[0][c]="1",l[e-1][c]="w"+c;for(var c=0;c<e;++c)0==(1&c)?t.push.apply(t,s(a(l,c))):n.push.apply(n,s(a(l,c)));for(var p=r(t),m=r(n),f="exactInSphere"+e,x=[],c=0;c<e;++c)x.push("m"+c);for(var _=["function ",f,"(",x.join(),"){"],c=0;c<e;++c){_.push("var w",c,"=",d(c,e),";");for(var b=0;b<e;++b)b!==c&&_.push("var w",c,"m",b,"=scale(w",c,",m",b,"[0]);")}_.push("var p=",p,",n=",m,",d=diff(p,n);return d[d.length-1];}return ",f);var v=new Function("sum","diff","prod","scale",_.join(""));return v(g,h,u,y)}function p(e){var t=f[e.length];return t||(t=f[e.length]=c(e.length)),t.apply(void 0,e)}var u=e("two-product"),g=e("robust-sum"),h=e("robust-subtract"),y=e("robust-scale"),f=[function(){return 0},function(){return 0},function(){return 0}];(function(){for(;f.length<=6;)f.push(c(f.length));for(var e=[],a=["slow"],o=0;o<=6;++o)e.push("a"+o),a.push("o"+o);for(var r=["function testInSphere(",e.join(),"){switch(arguments.length){case 0:case 1:return 0;"],o=2;o<=6;++o)r.push("case ",o,":return o",o,"(",e.slice(0,o).join(),");");r.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return testInSphere"),a.push(r.join(""));var n=Function.apply(void 0,a);t.exports=n.apply(void 0,[p].concat(f));for(var o=0;o<=6;++o)t.exports[o]=f[o]})()},{"robust-scale":1279,"robust-subtract":1281,"robust-sum":1282,"two-product":1315}],1276:[function(e,t){"use strict";function a(e){for(var t="robustLinearSolve"+e+"d",a=["function ",t,"(A,b){return ["],r=0;r<e;++r){a.push("det([");for(var n=0;n<e;++n){0<n&&a.push(","),a.push("[");for(var l=0;l<e;++l)0<l&&a.push(","),l===r?a.push("+b[",n,"]"):a.push("+A[",n,"][",l,"]");a.push("]")}a.push("]),")}a.push("det(A)]}return ",t);var s=new Function("det",a.join(""));return 6>e?s(o[e]):s(o)}var o=e("robust-determinant"),r=[function(){return[0]},function(e,t){return[[t[0]],[e[0][0]]]}];(function(){for(;r.length<6;)r.push(a(r.length));for(var e=[],o=["function dispatchLinearSolve(A,b){switch(A.length){"],n=0;n<6;++n)e.push("s"+n),o.push("case ",n,":return s",n,"(A,b);");o.push("}var s=CACHE[A.length];if(!s)s=CACHE[A.length]=g(A.length);return s(A,b)}return dispatchLinearSolve"),e.push("CACHE","g",o.join(""));var l=Function.apply(void 0,e);t.exports=l.apply(void 0,r.concat([r,a]));for(var n=0;n<6;++n)t.exports[n]=r[n]})()},{"robust-determinant":1273}],1277:[function(e,t){"use strict";var p=Math.abs;function a(e,t){for(var a=Array(e.length-1),o=1,n;o<e.length;++o){n=a[o-1]=Array(e.length-1);for(var l=0,s=0;l<e.length;++l)l!==t&&(n[s++]=e[o][l])}return a}function o(e){for(var t=Array(e),a=0;a<e;++a){t[a]=Array(e);for(var o=0;o<e;++o)t[a][o]=["m",o,"[",e-a-1,"]"].join("")}return t}function r(e){return 1&e?"-":""}function l(e){if(1===e.length)return e[0];if(2===e.length)return["sum(",e[0],",",e[1],")"].join("");var t=e.length>>1;return["sum(",l(e.slice(0,t)),",",l(e.slice(t)),")"].join("")}function s(e){if(2===e.length)return[["sum(prod(",e[0][0],",",e[1][1],"),prod(-",e[0][1],",",e[1][0],"))"].join("")];for(var t=[],o=0;o<e.length;++o)t.push(["scale(",l(s(a(e,o))),",",r(o),e[0][o],")"].join(""));return t}function d(e){for(var t=[],r=[],n=o(e),d=[],c=0;c<e;++c)0==(1&c)?t.push.apply(t,s(a(n,c))):r.push.apply(r,s(a(n,c))),d.push("m"+c);var p=l(t),m=l(r),f="orientation"+e+"Exact",x=["function ",f,"(",d.join(),"){var p=",p,",n=",m,",d=sub(p,n);return d[d.length-1];};return ",f].join(""),_=new Function("sum","prod","scale","sub",x);return _(g,u,h,y)}function c(e){var t=b[e.length];return t||(t=b[e.length]=d(e.length)),t.apply(void 0,e)}var u=e("two-product"),g=e("robust-sum"),h=e("robust-scale"),y=e("robust-subtract"),f=11102230246251565e-32,x=d(3),_=d(4),b=[function(){return 0},function(){return 0},function(e,t){return t[0]-e[0]},function(e,t,a){var o=(e[1]-a[1])*(t[0]-a[0]),i=(e[0]-a[0])*(t[1]-a[1]),r=o-i,n;if(0<o){if(0>=i)return r;n=o+i}else if(0>o){if(0<=i)return r;n=-(o+i)}else return r;var l=(3+16*f)*f*n;return r>=l||r<=-l?r:x(e,t,a)},function(e,t,a,o){var r=e[0]-o[0],i=t[0]-o[0],n=a[0]-o[0],l=e[1]-o[1],s=t[1]-o[1],d=a[1]-o[1],c=e[2]-o[2],u=t[2]-o[2],g=a[2]-o[2],m=i*d,h=n*s,y=n*l,x=r*d,b=r*s,v=i*l,w=c*(m-h)+u*(y-x)+g*(b-v),k=(p(m)+p(h))*p(c)+(p(y)+p(x))*p(u)+(p(b)+p(v))*p(g),T=(7+56*f)*f*k;return w>T||-w>T?w:_(e,t,a,o)}];(function(){for(;b.length<=5;)b.push(d(b.length));for(var e=[],a=["slow"],o=0;o<=5;++o)e.push("a"+o),a.push("o"+o);for(var r=["function getOrientation(",e.join(),"){switch(arguments.length){case 0:case 1:return 0;"],o=2;o<=5;++o)r.push("case ",o,":return o",o,"(",e.slice(0,o).join(),");");r.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"),a.push(r.join(""));var n=Function.apply(void 0,a);t.exports=n.apply(void 0,[c].concat(b));for(var o=0;o<=5;++o)t.exports[o]=b[o]})()},{"robust-scale":1279,"robust-subtract":1281,"robust-sum":1282,"two-product":1315}],1278:[function(e,t){"use strict";var o=e("robust-sum"),n=e("robust-scale");t.exports=function(e,t){if(1===e.length)return n(t,e[0]);if(1===t.length)return n(e,t[0]);if(0===e.length||0===t.length)return[0];var a=[0];if(e.length<t.length)for(var l=0;l<e.length;++l)a=o(a,n(t,e[l]));else for(var l=0;l<t.length;++l)a=o(a,n(e,t[l]));return a}},{"robust-scale":1279,"robust-sum":1282}],1279:[function(e,t){"use strict";var o=e("two-product"),r=e("two-sum");t.exports=function(l,e){var s=l.length;if(1===s){var n=o(l[0],e);return n[0]?n:[n[1]]}var d=Array(2*s),c=[.1,.1],p=[.1,.1],t=0;o(l[0],e,c),c[0]&&(d[t++]=c[0]);for(var u=1;u<s;++u){o(l[u],e,p);var g=c[1];r(g,p[0],c),c[0]&&(d[t++]=c[0]);var m=p[1],a=c[1],h=m+a,f=a-(h-m);c[1]=h,f&&(d[t++]=f)}return c[1]&&(d[t++]=c[1]),0===t&&(d[t++]=0),d.length=t,d}},{"two-product":1315,"two-sum":1316}],1280:[function(e,t){"use strict";var o=Math.min,r=Math.max;function a(e,t,a,i){for(var n=0;2>n;++n){var l=e[n],s=t[n],c=o(l,s),p=r(l,s),u=a[n],g=i[n],m=o(u,g),h=r(u,g);if(h<c||p<m)return!1}return!0}t.exports=function(e,t,o,r){var n=i(e,o,r),l=i(t,o,r);if(0<n&&0<l||0>n&&0>l)return!1;var s=i(o,e,t),d=i(r,e,t);return!(0<s&&0<d||0>s&&0>d)&&(0!==n||0!==l||0!==s||0!==d||a(e,t,o,r))};var i=e("robust-orientation")[3]},{"robust-orientation":1277}],1281:[function(e,t){"use strict";var r=Math.abs;function o(e,t){var a=e+t,o=a-e,r=e-(a-o)+(t-o);return r?[r,a]:[a]}t.exports=function(t,e){var i=0|t.length,n=0|e.length;if(1==i&&1===n)return o(t[0],-e[0]);var l=Array(i+n),s=0,d=0,c=0,p=r,u=t[d],g=p(u),m=-e[c],h=p(m),f,_;g<h?(_=u,d+=1,d<i&&(u=t[d],g=p(u))):(_=m,c+=1,c<n&&(m=-e[c],h=p(m))),d<i&&g<h||c>=n?(f=u,d+=1,d<i&&(u=t[d],g=p(u))):(f=m,c+=1,c<n&&(m=-e[c],h=p(m)));for(var v=f+_,w=v-f,k=_-w,T=k,A=v,S,C,L,E,I;d<i&&c<n;)g<h?(f=u,d+=1,d<i&&(u=t[d],g=p(u))):(f=m,c+=1,c<n&&(m=-e[c],h=p(m))),_=T,v=f+_,w=v-f,k=_-w,k&&(l[s++]=k),S=A+v,C=S-A,L=S-C,E=v-C,I=A-L,T=I+E,A=S;for(;d<i;)f=u,_=T,v=f+_,w=v-f,k=_-w,k&&(l[s++]=k),S=A+v,C=S-A,L=S-C,E=v-C,I=A-L,T=I+E,A=S,d+=1,d<i&&(u=t[d]);for(;c<n;)f=m,_=T,v=f+_,w=v-f,k=_-w,k&&(l[s++]=k),S=A+v,C=S-A,L=S-C,E=v-C,I=A-L,T=I+E,A=S,c+=1,c<n&&(m=-e[c]);return T&&(l[s++]=T),A&&(l[s++]=A),s||(l[s++]=0),l.length=s,l}},{}],1282:[function(e,t){"use strict";var r=Math.abs;function o(e,t){var a=e+t,o=a-e,r=e-(a-o)+(t-o);return r?[r,a]:[a]}t.exports=function(t,e){var i=0|t.length,n=0|e.length;if(1==i&&1===n)return o(t[0],e[0]);var l=Array(i+n),s=0,d=0,c=0,p=r,u=t[d],g=p(u),m=e[c],h=p(m),f,_;g<h?(_=u,d+=1,d<i&&(u=t[d],g=p(u))):(_=m,c+=1,c<n&&(m=e[c],h=p(m))),d<i&&g<h||c>=n?(f=u,d+=1,d<i&&(u=t[d],g=p(u))):(f=m,c+=1,c<n&&(m=e[c],h=p(m)));for(var v=f+_,w=v-f,k=_-w,T=k,A=v,S,C,L,E,I;d<i&&c<n;)g<h?(f=u,d+=1,d<i&&(u=t[d],g=p(u))):(f=m,c+=1,c<n&&(m=e[c],h=p(m))),_=T,v=f+_,w=v-f,k=_-w,k&&(l[s++]=k),S=A+v,C=S-A,L=S-C,E=v-C,I=A-L,T=I+E,A=S;for(;d<i;)f=u,_=T,v=f+_,w=v-f,k=_-w,k&&(l[s++]=k),S=A+v,C=S-A,L=S-C,E=v-C,I=A-L,T=I+E,A=S,d+=1,d<i&&(u=t[d]);for(;c<n;)f=m,_=T,v=f+_,w=v-f,k=_-w,k&&(l[s++]=k),S=A+v,C=S-A,L=S-C,E=v-C,I=A-L,T=I+E,A=S,c+=1,c<n&&(m=e[c]);return T&&(l[s++]=T),A&&(l[s++]=A),s||(l[s++]=0),l.length=s,l}},{}],1283:[function(e,t){"use strict";t.exports=function(e){return 0>e?-1:0<e?1:0}},{}],1284:[function(e,t){function a(e,t){var a=o(e);if(t===void 0)return a;for(var r=Object.keys(t),n=0;n<r.length;++n){var l=r[n],s=t[l];"link"===l?a.link(s):a.attr(l,s)}return a}function o(e){function t(e){return u||(u=r(p)),u.link(e),p}function o(e,t,a){return i.addEventListener(p,e,t,a),p}function n(e,t,a){return i.removeEventListener(p,e,t,a),p}function l(e){var t=a(e);return p.appendChild(t),t}function s(e,t){return 2===arguments.length?(null===t?p.removeAttributeNS(null,e):p.setAttributeNS(null,e,t),p):p.getAttributeNS(null,e)}function d(e){return arguments.length?(p.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e),p):p.getAttributeNS("http://www.w3.org/1999/xlink","xlink:href")}function c(e){return void 0===e?p.textContent:(p.textContent=e,p)}var p=e;if("string"==typeof e)p=window.document.createElementNS("http://www.w3.org/2000/svg",e);else if(e.simplesvg)return e;var u;return p.simplesvg=!0,p.attr=s,p.append=l,p.link=d,p.text=c,p.on=o,p.off=n,p.dataSource=t,p}t.exports=a,a.compile=e("./lib/compile");var r=a.compileTemplate=e("./lib/compile_template"),i=e("add-event-listener")},{"./lib/compile":1285,"./lib/compile_template":1286,"add-event-listener":16}],1285:[function(e,t){function a(e){if(e){var t=e.match(/^<\w+/);if(t){var a=t[0].length;return e.substr(0,a)+" xmlns:svg=\"http://www.w3.org/2000/svg\" xmlns=\"http://www.w3.org/2000/svg\" "+e.substr(a)}throw new Error("Cannot parse input text: invalid xml?")}}var o=e("./domparser.js"),r=e("../");t.exports=function(e){try{return e=a(e),r(o.parseFromString(e,"text/xml").documentElement)}catch(t){throw t}}},{"../":1284,"./domparser.js":1287}],1286:[function(e,t){function a(e,t){var n=e.nodeType;if(1===n||3===n){var l;if(e.hasChildNodes()){var s=e.childNodes;for(l=0;l<s.length;++l)a(s[l],t)}if(3===n&&r(e,t),!!e.attributes){var d=e.attributes;for(l=0;l<d.length;++l)o(d[l],e,t)}}}function o(e,t,a){function o(e){t.setAttributeNS(null,l,e[s])}var r=e.value;if(r){var n=r.match(i);if(n){var l=e.localName,s=n[1],d=0>s.indexOf(".");if(!d)throw new Error("simplesvg currently does not support nested bindings");var c=a[s];c?c.push(o):c=a[s]=[o]}}}function r(e,t){function a(t){e.nodeValue=t[n]}var o=e.nodeValue;if(o){var r=o.match(i);if(r){var n=r[1],l=0>n.indexOf("."),s=t[n];s?s.push(a):s=t[n]=[a]}}}t.exports=function(e){var t=Object.create(null);return a(e,t),{link:function(e){function a(t){t(e)}Object.keys(t).forEach(function(e){var o=t[e];o.forEach(a)})}}};var i=/{{(.+?)}}/},{}],1287:[function(e,t){function a(){throw new Error("DOMParser is not supported by this platform. Please open issue here https://github.com/anvaka/simplesvg")}t.exports=function(){return"undefined"==typeof DOMParser?{parseFromString:a}:new DOMParser}()},{}],1288:[function(e,t){'use strict';t.exports=function(e){return o(a(e))};var a=e("boundary-cells"),o=e("reduce-simplicial-complex")},{"boundary-cells":46,"reduce-simplicial-complex":1264}],1289:[function(e,t){'use strict';var s=Math.min,p=Math.max;function a(e){for(var t=e.length,a=0,o=0;o<t;++o)a=0|p(a,e[o].length);return a-1}function o(e,t){for(var a=e.length,o=g.mallocUint8(a),r=0;r<a;++r)o[r]=0|e[r]<t;return o}function r(e,t){for(var o=e.length,r=0|t*(t+1)/2*o,n=g.mallocUint32(2*r),l=0,h=0;h<o;++h)for(var y=e[h],t=y.length,c=0;c<t;++c)for(var f=0;f<c;++f){var x=y[f],a=y[c];n[l++]=0|s(x,a),n[l++]=0|p(x,a)}var _=0|l/2;m(u(n,[_,2]));for(var b=2,h=2;h<l;h+=2)(n[h-2]!==n[h]||n[h-1]!==n[h+1])&&(n[b++]=n[h],n[b++]=n[h+1]);return u(n,[0|b/2,2])}function i(e,t,o,r){for(var n=e.data,l=e.shape[0],s=g.mallocDouble(l),d=0,c=0;c<l;++c){var p=n[2*c],a=n[2*c+1];if(o[p]!==o[a]){var m=t[p],h=t[a];n[2*d]=p,n[2*d+1]=a,s[d++]=(h-r)/(h-m)}}return e.shape[0]=d,u(s,[d])}function n(e,t){var o=g.mallocInt32(2*t),r=e.shape[0],n=e.data;o[0]=0;for(var l=0,s=0,d;s<r;++s)if(d=n[2*s],d!==l){for(o[2*l+1]=s;++l<d;)o[2*l]=s,o[2*l+1]=s;o[2*l]=s}for(o[2*l+1]=r;++l<t;)o[2*l]=o[2*l+1]=r;return o}function l(e){for(var t=0|e.shape[0],a=e.data,o=Array(t),r=0;r<t;++r)o[r]=[a[2*r],a[2*r+1]];return o}t.exports=function(e,t,s,c){s=s||0,"undefined"==typeof c&&(c=a(e));var p=e.length;if(0===p||1>c)return{cells:[],vertexIds:[],vertexWeights:[]};var u=o(t,+s),m=r(e,c),y=i(m,t,u,+s),f=n(m,0|t.length),x=h(c)(e,m.data,f,u),_=l(m),b=[].slice.call(y.data,0,y.shape[0]);return g.free(u),g.free(m.data),g.free(y.data),g.free(f),{cells:x,vertexIds:_,vertexWeights:b}};var u=e("ndarray"),g=e("typedarray-pool"),m=e("ndarray-sort"),h=e("./lib/codegen")},{"./lib/codegen":1290,ndarray:425,"ndarray-sort":423,"typedarray-pool":1328}],1290:[function(e,t){'use strict';function a(e){function t(e){if(!(0>=e.length)){c.push("R.push(");for(var t=0,a;t<e.length;++t){a=e[t],0<t&&c.push(","),c.push("[");for(var o=0,r;o<a.length;++o)r=a[o],0<o&&c.push(","),c.push("B(C,E,c[",r[0],"],c[",r[1],"])");c.push("]")}c.push(");")}}var a=0,n=Array(e+1);n[0]=[[]];for(var l=1,s;l<=e;++l){s=n[l]=r(l);for(var d=0;d<s.length;++d)a=Math.max(a,s[l].length)}for(var c=["function B(C,E,i,j){","var a=Math.min(i,j)|0,b=Math.max(i,j)|0,l=C[2*a],h=C[2*a+1];","while(l<h){","var m=(l+h)>>1,v=E[2*m+1];","if(v===b){return m}","if(b<v){h=m}else{l=m+1}","}","return l;","};","function getContour",e,"d(F,E,C,S){","var n=F.length,R=[];","for(var i=0;i<n;++i){var c=F[i],l=c.length;"],l=e+1;1<l;--l){l<e+1&&c.push("else "),c.push("if(l===",l,"){");for(var p=[],d=0;d<l;++d)p.push("(S[c["+d+"]]<<"+d+")");c.push("var M=",p.join("+"),";if(M===0||M===",(1<<l)-1,"){continue}switch(M){");for(var s=n[l-1],d=0;d<s.length;++d)c.push("case ",d,":"),t(s[d]),c.push("break;");c.push("}}")}c.push("}return R;};return getContour",e,"d");var u=new Function("pool",c.join(""));return u(o)}t.exports=function(e){var t=i[e];return t||(t=i[e]=a(e)),t};var o=e("typedarray-pool"),r=e("marching-simplex-table"),i={}},{"marching-simplex-table":397,"typedarray-pool":1328}],1291:[function(e,t,a){"use strict";"use restrict";var y=Math.max;function o(e,a){var o=e.length,r=e.length-a.length,n=Math.min;if(r)return r;switch(o){case 0:return 0;case 1:return e[0]-a[0];case 2:var l=e[0]+e[1]-a[0]-a[1];return l?l:n(e[0],e[1])-n(a[0],a[1]);case 3:var s=e[0]+e[1],c=a[0]+a[1];if(l=s+e[2]-(c+a[2]),l)return l;var p=n(e[0],e[1]),u=n(a[0],a[1]),l=n(p,e[2])-n(u,a[2]);return l?l:n(p+e[2],s)-n(u+a[2],c);default:var g=e.slice(0);g.sort();var m=a.slice(0);m.sort();for(var h=0;h<o;++h)if(r=g[h]-m[h],r)return r;return 0;}}function r(e,t){return o(e[0],t[0])}function s(e,t){if(t){for(var a=e.length,n=Array(a),l=0;l<a;++l)n[l]=[e[l],t[l]];n.sort(r);for(var l=0;l<a;++l)e[l]=n[l][0],t[l]=n[l][1];return e}return e.sort(o),e}function d(e){if(0===e.length)return[];for(var t=1,r=e.length,n=1,l;n<r;++n)if(l=e[n],o(l,e[n-1])){if(n===t){t++;continue}e[t++]=l}return e.length=t,e}function p(e,t){for(var a=0,i=e.length-1,n=-1;a<=i;){var l=a+i>>1,d=o(e[l],t);0>=d?(0===d&&(n=l),a=l+1):0<d&&(i=l-1)}return n}function u(e,t){for(var a=Array(e.length),r=0,s=a.length;r<s;++r)a[r]=[];for(var d=[],r=0,u=t.length;r<u;++r)for(var n=t[r],c=n.length,g=1;g<1<<c;++g){d.length=f.popCount(g);for(var m=0,h=0;h<c;++h)g&1<<h&&(d[m++]=n[h]);var y=p(e,d);if(!(0>y))for(;a[y++].push(r),!(y>=e.length||0!==o(e[y],d)););}return a}function g(e,t){if(0>t)return[];for(var a=[],o=0,r;o<e.length;++o){r=e[o];for(var n=(1<<t+1)-1;n<1<<r.length;n=f.nextCombination(n)){for(var d=Array(t+1),p=0,u=0;u<r.length;++u)n&1<<u&&(d[p++]=r[u]);a.push(d)}}return s(a)}function m(e,t){for(var a=new x(t),o=0,r;o<e.length;++o){r=e[o];for(var n=0;n<r.length;++n)for(var s=n+1;s<r.length;++s)a.link(r[n],r[s])}for(var d=[],p=a.ranks,o=0;o<p.length;++o)p[o]=-1;for(var o=0,u;o<e.length;++o)u=a.find(e[o][0]),0>p[u]?(p[u]=d.length,d.push([e[o].slice(0)])):d[p[u]].push(e[o].slice(0));return d}function h(e){for(var t=d(s(g(e,0))),a=new x(t.length),o=0,r;o<e.length;++o){r=e[o];for(var n=0,u;n<r.length;++n){u=p(t,[r[n]]);for(var m=n+1;m<r.length;++m)a.link(u,p(t,[r[m]]))}}for(var h=[],y=a.ranks,o=0;o<y.length;++o)y[o]=-1;for(var o=0,f;o<e.length;++o)f=a.find(p(t,[e[o][0]])),0>y[f]?(y[f]=h.length,h.push([e[o].slice(0)])):h[y[f]].push(e[o].slice(0));return h}var f=e("bit-twiddle"),x=e("union-find");a.dimension=function(e){for(var t=0,a=0,o=e.length;a<o;++a)t=y(t,e[a].length);return t-1},a.countVertices=function(e){for(var t=-1,a=0,o=e.length,r;a<o;++a){r=e[a];for(var n=0,l=r.length;n<l;++n)t=y(t,r[n])}return t+1},a.cloneCells=function(e){for(var t=Array(e.length),a=0,o=e.length;a<o;++a)t[a]=e[a].slice(0);return t},a.compareCells=o,a.normalize=s,a.unique=d,a.findCell=p,a.incidence=u,a.dual=function(e,t){if(!t)return u(d(g(e,0)),e,0);for(var a=Array(t),o=0;o<t;++o)a[o]=[];for(var o=0,r=e.length,n;o<r;++o){n=e[o];for(var l=0,s=n.length;l<s;++l)a[n[l]].push(o)}return a},a.explode=function(e){for(var t=[],a=0,o=e.length;a<o;++a)for(var r=e[a],n=0|r.length,l=1,d;l<1<<n;++l){d=[];for(var c=0;c<n;++c)1&l>>>c&&d.push(r[c]);t.push(d)}return s(t)},a.skeleton=g,a.boundary=function(e){for(var t=[],a=0,o=e.length,r;a<o;++a){r=e[a];for(var n=0,d=r.length,p;n<d;++n){p=Array(r.length-1);for(var u=0,g=0;u<d;++u)u!==n&&(p[g++]=r[u]);t.push(p)}}return s(t)},a.connectedComponents=function(e,t){return t?m(e,t):h(e)}},{"bit-twiddle":43,"union-find":1330}],1292:[function(e,t,a){arguments[4][43][0].apply(a,arguments)},{dup:43}],1293:[function(e,t,a){arguments[4][1291][0].apply(a,arguments)},{"bit-twiddle":1292,dup:1291,"union-find":1294}],1294:[function(e,t){"use strict";"use restrict";function a(e){this.roots=Array(e),this.ranks=Array(e);for(var t=0;t<e;++t)this.roots[t]=t,this.ranks[t]=0}t.exports=a,a.prototype.length=function(){return this.roots.length},a.prototype.makeSet=function(){var e=this.roots.length;return this.roots.push(e),this.ranks.push(0),e},a.prototype.find=function(e){for(var t=this.roots;t[e]!==e;){var a=t[e];t[e]=t[a],e=a}return e},a.prototype.link=function(e,t){var a=this.find(e),o=this.find(t);if(a!==o){var r=this.ranks,i=this.roots,n=r[a],l=r[o];n<l?i[a]=o:l<n?i[o]=a:(i[o]=a,++r[a])}}},{}],1295:[function(e,t){"use strict";var o=Math.pow;function a(e,t,a){var i=Math.abs(r(e,t,a)),n=Math.sqrt(o(t[0]-a[0],2)+o(t[1]-a[1],2));return i/n}t.exports=function(e,o,r){function d(e){if(A[e])return 1/0;var r=v[e],i=k[e];return 0>r||0>i?1/0:a(o[e],o[r],o[i])}function p(e,o){var r=t[e],a=t[o];t[e]=a,t[o]=r,E[r]=o,E[a]=e}function u(e){return T[t[e]]}function g(e){return 1&e?e-1>>1:(e>>1)-1}function m(e){for(var t=u(e);;){var a=t,o=2*e+1,r=2*(e+1),n=e;if(o<P){var l=u(o);l<a&&(n=o,a=l)}if(r<P){var s=u(r);s<a&&(n=r)}if(n===e)return e;p(e,n),e=n}}function h(e){for(var t=u(e),a;0<e;){if(a=g(e),0<=a){var o=u(a);if(t<o){p(e,a),e=a;continue}}return e}}function y(){if(0<P){var e=t[0];return p(0,P-1),P-=1,m(0),e}return-1}function f(e,o){var r=t[e];return T[r]===o?e:(T[r]=-Infinity,h(e),y(),T[r]=o,P+=1,h(P-1))}function x(e){if(!A[e]){A[e]=!0;var a=v[e],o=k[e];0<=v[o]&&(v[o]=a),0<=k[a]&&(k[a]=o),0<=E[a]&&f(E[a],d(a)),0<=E[o]&&f(E[o],d(o))}}function _(e,a){if(0>e[a])return a;var o=a,r=a;do{var i=e[r];if(!A[r]||0>i||i===r)break;if(r=i,i=e[r],!A[r]||0>i||i===r)break;r=i,o=e[o]}while(o!==r);for(var n=a;n!==r;n=e[n])e[n]=r;return r}for(var b=o.length,n=e.length,v=Array(b),k=Array(b),T=Array(b),A=Array(b),S=0;S<b;++S)v[S]=k[S]=-1,T[S]=1/0,A[S]=!1;for(var S=0,C;S<n;++S){if(C=e[S],2!==C.length)throw new Error("Input must be a graph");var L=C[1],s=C[0];k[s]=-1===k[s]?L:-2,v[L]=-1===v[L]?s:-2}for(var t=[],E=Array(b),S=0,I;S<b;++S)I=T[S]=d(S),I<1/0?(E[S]=t.length,t.push(S)):E[S]=-1;for(var P=t.length,S=P>>1;0<=S;--S)m(S);for(;;){var z=y();if(0>z||T[z]>r)break;x(z)}for(var D=[],S=0;S<b;++S)A[S]||(E[S]=D.length,D.push(o[S].slice()));var O=D.length,R=[];return e.forEach(function(e){var t=_(v,e[0]),a=_(k,e[1]);if(0<=t&&0<=a&&t!==a){var o=E[t],r=E[a];o!==r&&R.push([o,r])}}),l.unique(l.normalize(R)),{positions:D,edges:R}};var r=e("robust-orientation"),l=e("simplicial-complex")},{"robust-orientation":1277,"simplicial-complex":1293}],1296:[function(e,t){"use strict";var r=Math.min,i=Math.max;function o(e,t){var a,o;if(t[0][0]<t[1][0])a=t[0],o=t[1];else if(t[0][0]>t[1][0])a=t[1],o=t[0];else{var l=r(e[0][1],e[1][1]),s=i(e[0][1],e[1][1]),c=r(t[0][1],t[1][1]),p=i(t[0][1],t[1][1]);return s<c?s-c:l>p?l-p:s-p}var u,g;e[0][1]<e[1][1]?(u=e[0],g=e[1]):(u=e[1],g=e[0]);var m=n(o,a,u);return m?m:(m=n(o,a,g),m?m:g-o)}t.exports=function(e,t){var a,r;if(t[0][0]<t[1][0])a=t[0],r=t[1];else if(t[0][0]>t[1][0])a=t[1],r=t[0];else return o(t,e);var i,l;if(e[0][0]<e[1][0])i=e[0],l=e[1];else if(e[0][0]>e[1][0])i=e[1],l=e[0];else return-o(e,t);var s=n(a,r,l),d=n(a,r,i);if(0>s){if(0>=d)return s;}else if(0<s){if(0<=d)return s;}else if(d)return d;if(s=n(l,i,r),d=n(l,i,a),0>s){if(0>=d)return s;}else if(0<s){if(0<=d)return s;}else if(d)return d;return r[0]-l[0]};var n=e("robust-orientation")},{"robust-orientation":1277}],1297:[function(e,t,a){arguments[4][204][0].apply(a,arguments)},{dup:204}],1298:[function(e,t){"use strict";var s=Math.min;function a(e,t,a){this.slabs=e,this.coordinates=t,this.horizontal=a}function r(t,e){return t.y-e}function i(e,t){for(var a=null;e;){var n=e.key,s,d;n[0][0]<n[1][0]?(s=n[0],d=n[1]):(s=n[1],d=n[0]);var c=u(s,d,t);if(0>c)e=e.left;else if(!(0<c)){if(t[0]!==n[1][0])return e;var o=i(e.right,t);if(o)return o;e=e.left}else if(t[0]!==n[1][0])a=e,e=e.right;else{var o=i(e.right,t);if(o)return o;e=e.left}}return a}function n(e,t,a,o){this.y=e,this.index=t,this.start=a,this.closed=o}function l(e,t,a,o){this.x=e,this.segment=t,this.create=a,this.index=o}t.exports=function(t){for(var o=t.length,r=2*o,d=Array(r),p=0;p<o;++p){var u=t[p],m=u[0][0]<u[1][0];d[2*p]=new l(u[0][0],u,m,p),d[2*p+1]=new l(u[1][0],u,!m,p)}d.sort(function(e,t){var a=e.x-t.x;return a?a:(a=e.create-t.create,a?a:s(e.segment[0][1],e.segment[1][1])-s(t.segment[0][1],t.segment[1][1]))});for(var h=c(g),y=[],f=[],_=[],b=-Infinity,p=0;p<r;){for(var v=d[p].x,x=[];p<r;){var w=d[p];if(w.x!==v)break;p+=1,w.segment[0][0]===w.x&&w.segment[1][0]===w.x?w.create&&(w.segment[0][1]<w.segment[1][1]?(x.push(new n(w.segment[0][1],w.index,!0,!0)),x.push(new n(w.segment[1][1],w.index,!1,!1))):(x.push(new n(w.segment[1][1],w.index,!0,!1)),x.push(new n(w.segment[0][1],w.index,!1,!0)))):w.create?h=h.insert(w.segment,w.index):h=h.remove(w.segment)}y.push(h.root),f.push(v),_.push(x)}return new a(y,f,_)};var d=e("binary-search-bounds"),c=e("functional-red-black-tree"),u=e("robust-orientation"),g=e("./lib/order-segments"),m=a.prototype;m.castUp=function(t){var a=d.le(this.coordinates,t[0]);if(0>a)return-1;var n=this.slabs[a],l=i(this.slabs[a],t),s=-1;if(l&&(s=l.value),this.coordinates[a]===t[0]){var c=null;if(l&&(c=l.key),0<a){var p=i(this.slabs[a-1],t);p&&(c?0<g(p.key,c)&&(c=p.key,s=p.value):(s=p.value,c=p.key))}var m=this.horizontal[a];if(0<m.length){var h=d.ge(m,t[1],r);if(h<m.length){var y=m[h];if(t[1]===y.y){if(y.closed)return y.index;for(;h<m.length-1&&m[h+1].y===t[1];)if(++h,y=m[h],y.closed)return y.index;if(y.y===t[1]&&!y.start){if(++h,h>=m.length)return s;y=m[h]}}if(!y.start)y.y!==t[1]&&(s=y.index);else if(c){var f=u(c[0],c[1],[t[0],y.y]);c[0][0]>c[1][0]&&(f=-f),0<f&&(s=y.index)}else s=y.index}}}return s}},{"./lib/order-segments":1296,"binary-search-bounds":1297,"functional-red-black-tree":208,"robust-orientation":1277}],1299:[function(e,t){"use strict";function o(e,t){var a=n(i(e,t),[t[t.length-1]]);return a[a.length-1]}function r(e,a,o,l){var s=-a/(l-a);0>s?s=0:1<s&&(s=1);for(var d=1-s,c=e.length,n=Array(c),r=0;r<c;++r)n[r]=s*e[r]+d*o[r];return n}var i=e("robust-dot-product"),n=e("robust-sum");t.exports=function(e,n){for(var l=[],d=[],c=o(e[e.length-1],n),u=e[e.length-1],g=e[0],m=0;m<e.length;++m,u=g){g=e[m];var h=o(g,n);if(0>c&&0<h||0<c&&0>h){var y=r(u,h,g,c);l.push(y),d.push(y.slice())}0>h?d.push(g.slice()):0<h?l.push(g.slice()):(l.push(g.slice()),d.push(g.slice())),c=h}return{positive:l,negative:d}},t.exports.positive=function(e,n){for(var l=[],d=o(e[e.length-1],n),c=e[e.length-1],p=e[0],u=0;u<e.length;++u,c=p){p=e[u];var g=o(p,n);(0>d&&0<g||0<d&&0>g)&&l.push(r(c,g,p,d)),0<=g&&l.push(p.slice()),d=g}return l},t.exports.negative=function(e,n){for(var l=[],d=o(e[e.length-1],n),c=e[e.length-1],p=e[0],u=0;u<e.length;++u,c=p){p=e[u];var g=o(p,n);(0>d&&0<g||0<d&&0>g)&&l.push(r(c,g,p,d)),0>=g&&l.push(p.slice()),d=g}return l}},{"robust-dot-product":1274,"robust-sum":1282}],1300:[function(e,t,a){var o=String.fromCharCode;!function(){'use strict';function e(e){return r(i(e),arguments)}function t(t,a){return e.apply(null,[t].concat(a||[]))}function r(t,a){var r=1,l=t.length,s="",d,c,p,u,g,m,h,y,f;for(c=0;c<l;c++)if("string"==typeof t[c])s+=t[c];else if("object"==typeof t[c]){if(u=t[c],u.keys)for(d=a[r],p=0;p<u.keys.length;p++){if(null==d)throw new Error(e("[sprintf] Cannot access property \"%s\" of undefined value \"%s\"",u.keys[p],u.keys[p-1]));d=d[u.keys[p]]}else d=u.param_no?a[u.param_no]:a[r++];if(n.not_type.test(u.type)&&n.not_primitive.test(u.type)&&d instanceof Function&&(d=d()),n.numeric_arg.test(u.type)&&"number"!=typeof d&&isNaN(d))throw new TypeError(e("[sprintf] expecting number but found %T",d));switch(n.number.test(u.type)&&(y=0<=d),u.type){case"b":d=parseInt(d,10).toString(2);break;case"c":d=o(parseInt(d,10));break;case"d":case"i":d=parseInt(d,10);break;case"j":d=JSON.stringify(d,null,u.width?parseInt(u.width):0);break;case"e":d=u.precision?parseFloat(d).toExponential(u.precision):parseFloat(d).toExponential();break;case"f":d=u.precision?parseFloat(d).toFixed(u.precision):parseFloat(d);break;case"g":d=u.precision?+d.toPrecision(u.precision)+"":parseFloat(d);break;case"o":d=(parseInt(d,10)>>>0).toString(8);break;case"s":d+="",d=u.precision?d.substring(0,u.precision):d;break;case"t":d=!!d+"",d=u.precision?d.substring(0,u.precision):d;break;case"T":d=Object.prototype.toString.call(d).slice(8,-1).toLowerCase(),d=u.precision?d.substring(0,u.precision):d;break;case"u":d=parseInt(d,10)>>>0;break;case"v":d=d.valueOf(),d=u.precision?d.substring(0,u.precision):d;break;case"x":d=(parseInt(d,10)>>>0).toString(16);break;case"X":d=(parseInt(d,10)>>>0).toString(16).toUpperCase();}n.json.test(u.type)?s+=d:(n.number.test(u.type)&&(!y||u.sign)?(f=y?"+":"-",d=d.toString().replace(n.sign,"")):f="",m=u.pad_char?"0"===u.pad_char?"0":u.pad_char.charAt(1):" ",h=u.width-(f+d).length,g=u.width?0<h?m.repeat(h):"":"",s+=u.align?f+d+g:"0"===m?f+g+d:g+f+d)}return s}function i(e){if(l[e])return l[e];for(var t=e,a=[],o=0,r;t;){if(null!==(r=n.text.exec(t)))a.push(r[0]);else if(null!==(r=n.modulo.exec(t)))a.push("%");else if(null!==(r=n.placeholder.exec(t))){if(r[2]){o|=1;var i=[],s=r[2],d=[];if(null!==(d=n.key.exec(s))){for(i.push(d[1]);""!==(s=s.substring(d[0].length));)if(null!==(d=n.key_access.exec(s)))i.push(d[1]);else if(null!==(d=n.index_access.exec(s)))i.push(d[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");}else throw new SyntaxError("[sprintf] failed to parse named argument key");r[2]=i}else o|=2;if(3===o)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");a.push({placeholder:r[0],param_no:r[1],keys:r[2],sign:r[3],pad_char:r[4],align:r[5],width:r[6],precision:r[7],type:r[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");t=t.substring(r[0].length)}return l[e]=a}var n={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/},l=Object.create(null);"undefined"!=typeof a&&(a.sprintf=e,a.vsprintf=t),"undefined"!=typeof window&&(window.sprintf=e,window.vsprintf=t,"function"==typeof define&&define.amd&&define(function(){return{sprintf:e,vsprintf:t}}))}()},{}],1301:[function(e,t){'use strict';var a=e("parenthesis");t.exports=function(e,t,r){if(null==e)throw Error("First argument should be a string");if(null==t)throw Error("Separator should be a string or a RegExp");r?("string"==typeof r||Array.isArray(r))&&(r={ignore:r}):r={},null==r.escape&&(r.escape=!0),null==r.ignore?r.ignore=["[]","()","{}","<>","\"\"","''","``","\u201C\u201D","\xAB\xBB"]:("string"==typeof r.ignore&&(r.ignore=[r.ignore]),r.ignore=r.ignore.map(function(e){return 1===e.length&&(e+=e),e}));var n=a.parse(e,{flat:!0,brackets:r.ignore}),l=n[0],s=l.split(t);if(r.escape){for(var d=[],c=0;c<s.length;c++){var p=s[c],u=s[c+1];"\\"===p[p.length-1]&&"\\"!==p[p.length-2]?(d.push(p+t+u),c++):d.push(p)}s=d}for(var c=0;c<s.length;c++)n[0]=s[c],s[c]=a.stringify(n,{flat:!0});return s}},{parenthesis:442}],1302:[function(e,t){"use strict";var a=Math.min;t.exports=function(t){function o(o){var r=[o],y=[o];for(n[o]=l[o]=g,s[o]=!0,g+=1;0<y.length;){o=y[y.length-1];var f=t[o];if(d[o]<f.length){for(var e=d[o],x;e<f.length;++e){if(x=f[e],0>n[x]){n[x]=l[x]=g,s[x]=!0,g+=1,r.push(x),y.push(x);break}else s[x]&&(l[o]=0|a(l[o],l[x]));0<=c[x]&&p[o].push(c[x])}d[o]=e}else{if(l[o]===n[o]){for(var _=[],b=[],k=0,e=r.length-1,T;0<=e;--e)if(T=r[e],s[T]=!1,_.push(T),b.push(p[T]),k+=p[T].length,c[T]=m.length,T===o){r.length=e;break}m.push(_);for(var A=Array(k),e=0;e<b.length;e++)for(var S=0;S<b[e].length;S++)A[--k]=b[e][S];h.push(A)}y.pop()}}}for(var r=t.length,n=Array(r),l=Array(r),s=Array(r),d=Array(r),c=Array(r),p=Array(r),u=0;u<r;++u)n[u]=-1,l[u]=0,s[u]=!1,d[u]=0,c[u]=-1,p[u]=[];for(var g=0,m=[],h=[],u=0;u<r;++u)0>n[u]&&o(u);for(var u=0,y,f;u<h.length;u++)if(f=h[u],0!==f.length){f.sort(function(e,t){return e-t}),y=[f[0]];for(var x=1;x<f.length;x++)f[x]!==f[x-1]&&y.push(f[x]);h[u]=y}return{components:m,adjacencyList:h}}},{}],1303:[function(e,t){"use strict";function a(e,t){var a=e.length,o=["'use strict';"],s="surfaceNets"+e.join("_")+"d"+t;o.push("var contour=genContour({","order:[",e.join(),"],","scalarArguments: 3,","phase:function phaseFunc(p,a,b,c) { return (p > c)|0 },"),"generic"===t&&o.push("getters:[0],");for(var d=[],c=[],p=0;p<a;++p)d.push("d"+p),c.push("d"+p);for(var p=0;p<1<<a;++p)d.push("v"+p),c.push("v"+p);for(var p=0;p<1<<a;++p)d.push("p"+p),c.push("p"+p);d.push("a","b","c"),c.push("a","c"),o.push("vertex:function vertexFunc(",d.join(),"){");for(var g=[],p=0;p<1<<a;++p)g.push("(p"+p+"<<"+p+")");o.push("var m=(",g.join("+"),")|0;if(m===0||m===",(1<<(1<<a))-1,"){return}");var m=[],h=[];128>=1<<(1<<a)?(o.push("switch(m){"),h=o):o.push("switch(m>>>7){");for(var p=0;p<1<<(1<<a);++p){if(128<1<<(1<<a)&&0==p%128){0<m.length&&h.push("}}");var y="vExtra"+m.length;o.push("case ",p>>>7,":",y,"(m&0x7f,",c.join(),");break;"),h=["function ",y,"(m,",c.join(),"){switch(m){"],m.push(h)}h.push("case ",127&p,":");for(var f=Array(a),x=Array(a),_=Array(a),b=Array(a),v=0,w=0;w<a;++w)f[w]=[],x[w]=[],_[w]=0,b[w]=0;for(var w=0;w<1<<a;++w)for(var T=0,A;T<a;++T)if((A=w^1<<T,!(A>w))&&!(p&1<<A)!=!(p&1<<w)){var S=1;p&1<<A?x[T].push("v"+A+"-v"+w):(x[T].push("v"+w+"-v"+A),S=-S),0>S?(f[T].push("-v"+w+"-v"+A),_[T]+=2):(f[T].push("v"+w+"+v"+A),_[T]-=2),v+=1;for(var C=0;C<a;++C)C!==T&&(A&1<<C?b[C]+=1:b[C]-=1)}for(var L=[],T=0;T<a;++T)if(0===f[T].length)L.push("d"+T+"-0.5");else{var E="";0>_[T]?E=_[T]+"*c":0<_[T]&&(E="+"+_[T]+"*c");var I=.5*(f[T].length/v),P=.5+.5*(b[T]/v);L.push("d"+T+"-"+P+"-"+I+"*("+f[T].join("+")+E+")/("+x[T].join("+")+")")}h.push("a.push([",L.join(),"]);","break;")}o.push("}},"),0<m.length&&h.push("}}");for(var z=[],p=0;p<1<<a-1;++p)z.push("v"+p);z.push("c0","c1","p0","p1","a","b","c"),o.push("cell:function cellFunc(",z.join(),"){");var D=n(a-1);o.push("if(p0){b.push(",D.map(function(e){return"["+e.map(function(e){return"v"+e})+"]"}).join(),")}else{b.push(",D.map(function(t){var a=t.slice();return a.reverse(),"["+a.map(function(e){return"v"+e})+"]"}).join(),")}}});function ",s,"(array,level){var verts=[],cells=[];contour(array,verts,cells,level);return {positions:verts,cells:cells};} return ",s,";");for(var p=0;p<m.length;++p)o.push(m[p].join(""));var O=new Function("genContour",o.join(""));return O(r)}function o(e,t){for(var a=l(e,t),o=a.length,r=Array(o),n=Array(o),s=0;s<o;++s)r[s]=[a[s]],n[s]=[s];return{positions:r,cells:n}}t.exports=function(e,t){if(0>=e.dimension)return{positions:[],cells:[]};if(1===e.dimension)return o(e,t);var r=e.order.join()+"-"+e.dtype,i=s[r],t=+t||0;return i||(i=s[r]=a(e.order,e.dtype)),i(e,t)};var r=e("ndarray-extract-contour"),n=e("triangulate-hypercube"),l=e("zero-crossings"),s={}},{"ndarray-extract-contour":414,"triangulate-hypercube":1313,"zero-crossings":1412}],1304:[function(e,t,a){"use strict";var o=Math.acos,r=Math.cos,n=Math.sqrt,l=Math.sin,s=Math.pow,d=Math.abs;Object.defineProperty(a,"__esModule",{value:!0});var c=function(){function e(e,t){var a=[],o=!0,r=!1,i=void 0;try{for(var n=e[Symbol.iterator](),l;!(o=(l=n.next()).done)&&(a.push(l.value),!(t&&a.length===t));o=!0);}catch(e){r=!0,i=e}finally{try{!o&&n["return"]&&n["return"]()}finally{if(r)throw i}}return a}return function(t,a){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),p=2*Math.PI,u=function(e,t,a,o,r,i,n){var l=e.x,s=e.y;l*=t,s*=a;var d=o*l-r*s,c=r*l+o*s;return{x:d+i,y:c+n}},g=function(e,t){var o=1.5707963267948966===t?.551915024494:-1.5707963267948966===t?-.551915024494:4/3*Math.tan(t/4),a=r(e),i=l(e),n=r(e+t),s=l(e+t);return[{x:a-i*o,y:i+a*o},{x:n+s*o,y:s-n*o},{x:n,y:s}]},m=function(e,t,a,r){var i=0>e*r-t*a?-1:1,n=e*a+t*r;return 1<n&&(n=1),-1>n&&(n=-1),i*o(n)},h=function(e,t,a,o,r,i,l,d,c,u,g,h){var y=s(r,2),f=s(i,2),x=s(g,2),_=s(h,2),b=y*f-y*_-f*x;0>b&&(b=0),b/=y*_+f*x,b=n(b)*(l===d?-1:1);var v=b*r/i*h,w=b*-i/r*g,k=(g-v)/r,T=(h-w)/i,A=m(1,0,k,T),S=m(k,T,(-g-v)/r,(-h-w)/i);return 0===d&&0<S&&(S-=p),1===d&&0>S&&(S+=p),[u*v-c*w+(e+a)/2,c*v+u*w+(t+o)/2,A,S]};a.default=function(e){var t=e.px,a=e.py,o=e.cx,m=e.cy,f=e.rx,_=e.ry,y=e.xAxisRotation,x=y===void 0?0:y,b=e.largeArcFlag,v=b===void 0?0:b,w=e.sweepFlag,k=w===void 0?0:w,T=[];if(0===f||0===_)return[];var A=l(x*p/360),S=r(x*p/360),C=S*(t-o)/2+A*(a-m)/2,L=-A*(t-o)/2+S*(a-m)/2;if(0===C&&0===L)return[];f=d(f),_=d(_);var E=s(C,2)/s(f,2)+s(L,2)/s(_,2);1<E&&(f*=n(E),_*=n(E));var I=h(t,a,o,m,f,_,v,k,A,S,C,L),P=c(I,4),z=P[0],D=P[1],O=P[2],R=P[3],M=d(R)/(p/4);1e-7>d(1-M)&&(M=1);var j=Math.max(Math.ceil(M),1);R/=j;for(var B=0;B<j;B++)T.push(g(O,R)),O+=R;return T.map(function(e){var t=u(e[0],f,_,S,A,z,D),a=t.x,o=t.y,r=u(e[1],f,_,S,A,z,D),i=r.x,n=r.y,l=u(e[2],f,_,S,A,z,D),s=l.x,d=l.y;return{x1:a,y1:o,x2:i,y2:n,x:s,y:d}})},t.exports=a.default},{}],1305:[function(e,t){'use strict';var a=e("parse-svg-path"),o=e("abs-svg-path"),r=e("normalize-svg-path"),n=e("is-svg-path"),s=e("assert");t.exports=function(e){if(Array.isArray(e)&&1===e.length&&"string"==typeof e[0]&&(e=e[0]),"string"==typeof e&&(s(n(e),"String is not an SVG path."),e=a(e)),s(Array.isArray(e),"Argument should be a string or an array of path segments."),e=o(e),e=r(e),!e.length)return[0,0,0,0];for(var t=[1/0,1/0,-Infinity,-Infinity],d=0,c=e.length,l;d<c;d++){l=e[d].slice(1);for(var p=0;p<l.length;p+=2)l[p+0]<t[0]&&(t[0]=l[p+0]),l[p+1]<t[1]&&(t[1]=l[p+1]),l[p+0]>t[2]&&(t[2]=l[p+0]),l[p+1]>t[3]&&(t[3]=l[p+1])}return t}},{"abs-svg-path":15,assert:1414,"is-svg-path":393,"normalize-svg-path":1306,"parse-svg-path":444}],1306:[function(e,t){'use strict';function a(e,t,a,o){return["C",e,t,a,o,a,o]}function o(e,t,a,o,r,i){return["C",e/3+2/3*a,t/3+2/3*o,r/3+2/3*a,i/3+2/3*o,r,i]}t.exports=function(e){for(var t=[],n=0,l=0,s=0,d=0,p=null,u=null,g=0,m=0,h=0,f=e.length,_;h<f;h++){var b=e[h],v=b[0];switch(v){case"M":s=b[1],d=b[2];break;case"A":var w=r({px:g,py:m,cx:b[6],cy:b[7],rx:b[1],ry:b[2],xAxisRotation:b[3],largeArcFlag:b[4],sweepFlag:b[5]});if(!w.length)continue;for(var k=0,T;k<w.length;k++)T=w[k],b=["C",T.x1,T.y1,T.x2,T.y2,T.x,T.y],k<w.length-1&&t.push(b);break;case"S":var A=g,S=m;("C"==_||"S"==_)&&(A+=A-n,S+=S-l),b=["C",A,S,b[1],b[2],b[3],b[4]];break;case"T":"Q"==_||"T"==_?(p=2*g-p,u=2*m-u):(p=g,u=m),b=o(g,m,p,u,b[1],b[2]);break;case"Q":p=b[1],u=b[2],b=o(g,m,b[1],b[2],b[3],b[4]);break;case"L":b=a(g,m,b[1],b[2]);break;case"H":b=a(g,m,b[1],m);break;case"V":b=a(g,m,g,b[1]);break;case"Z":b=a(g,m,s,d);}_=v,g=b[b.length-2],m=b[b.length-1],4<b.length?(n=b[b.length-4],l=b[b.length-3]):(n=g,l=m),t.push(b)}return t};var r=e("svg-arc-to-cubic-bezier")},{"svg-arc-to-cubic-bezier":1304}],1307:[function(e,t){'use strict';var o=Math.min,r=Math.abs;function a(){if(null!=u)return u;var e=document.createElement("canvas").getContext("2d");if(e.canvas.width=e.canvas.height=1,!window.Path2D)return u=!1;var t=new Path2D("M0,0h1v1h-1v-1Z");e.fillStyle="black",e.fill(t);var a=e.getImageData(0,0,1,1);return u=a&&a.data&&255===a.data[3]}var i=e("svg-path-bounds"),n=e("parse-svg-path"),l=e("draw-svg-path"),s=e("is-svg-path"),d=e("bitmap-sdf"),c=document.createElement("canvas"),p=c.getContext("2d");t.exports=function(e,t){if(!s(e))throw Error("Argument should be valid svg path string");t||(t={});var u,g;t.shape?(u=t.shape[0],g=t.shape[1]):(u=c.width=t.w||t.width||200,g=c.height=t.h||t.height||200);var m=o(u,g),y=t.stroke||0,f=t.viewbox||t.viewBox||i(e),x=[u/(f[2]-f[0]),g/(f[3]-f[1])],_=o(x[0]||0,x[1]||0)/2;if(p.fillStyle="black",p.fillRect(0,0,u,g),p.fillStyle="white",y&&("number"!=typeof y&&(y=1),p.strokeStyle=0<y?"white":"black",p.lineWidth=r(y)),p.translate(.5*u,.5*g),p.scale(_,_),a()){var b=new Path2D(e);p.fill(b),y&&p.stroke(b)}else{var v=n(e);l(p,v),p.fill(),y&&p.stroke()}p.setTransform(1,0,0,1,0,0);var k=d(p,{cutoff:null==t.cutoff?.5:t.cutoff,radius:null==t.radius?.5*m:t.radius});return k};var u},{"bitmap-sdf":44,"draw-svg-path":114,"is-svg-path":393,"parse-svg-path":444,"svg-path-bounds":1305}],1308:[function(e,t){var a=Math.max;(function(o){'use strict';function r(e){for(var t=e.cells,o=e.positions,r=new Float32Array(6*t.length),n=0,l=0,s=0,d;s<t.length;++s){d=t[s];for(var c=0,p;3>c;++c)p=o[d[c]],r[n++]=p[0],r[n++]=p[1]+1.4,l=a(p[0],l)}return{data:r,shape:l}}function n(e,t,a){var a=a||{},o=d[e];o||(o=d[e]={" ":{data:new Float32Array(0),shape:.2}});var s=o[t];if(!s)if(1>=t.length||!/\d/.test(t))s=o[t]=r(l(t,{triangles:!0,font:e,textAlign:a.textAlign||"left",textBaseline:"alphabetic",styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0}}));else{for(var c=t.split(/(\d|\s)/),p=Array(c.length),u=0,g=0,m=0;m<c.length;++m)p[m]=n(e,c[m]),u+=p[m].data.length,g+=p[m].shape,0<m&&(g+=.02);for(var h=new Float32Array(u),y=0,f=-.5*g,m=0,x;m<p.length;++m){x=p[m].data;for(var _=0;_<x.length;_+=2)h[y++]=x[_]+f,h[y++]=x[_+1];f+=p[m].shape+.02}s=o[t]={data:h,shape:g}}return s}t.exports=n;var l=e("vectorize-text"),s=window||o.global||{},d=s.__TEXT_CACHE||{};s.__TEXT_CACHE={}}).call(this,e("_process"))},{_process:1425,"vectorize-text":1335}],1309:[function(e,t){var a=Math.round,o=Math.min,r=Math.pow,i=Math.abs,n=Math.max;(function(e){function l(e,t){if(e=e?e:"",t=t||{},e instanceof l)return e;if(!(this instanceof l))return new l(e,t);var a=s(e);this._originalInput=e,this._r=a.r,this._g=a.g,this._b=a.b,this._a=a.a,this._roundA=Y(100*this._a)/100,this._format=t.format||a.format,this._gradientType=t.gradientType,1>this._r&&(this._r=Y(this._r)),1>this._g&&(this._g=Y(this._g)),1>this._b&&(this._b=Y(this._b)),this._ok=a.ok,this._tc_id=G++}function s(e){var t={r:0,g:0,b:0},o=1,r=null,i=null,n=null,c=!1,u=!1;return"string"==typeof e&&(e=V(e)),"object"==typeof e&&(N(e.r)&&N(e.g)&&N(e.b)?(t=d(e.r,e.g,e.b),c=!0,u="%"===(e.r+"").substr(-1)?"prgb":"rgb"):N(e.h)&&N(e.s)&&N(e.v)?(r=j(e.s),i=j(e.v),t=g(e.h,r,i),c=!0,u="hsv"):N(e.h)&&N(e.s)&&N(e.l)&&(r=j(e.s),n=j(e.l),t=p(e.h,r,n),c=!0,u="hsl"),e.hasOwnProperty("a")&&(o=e.a)),o=I(o),{ok:c,format:e.format||u,r:W(255,X(t.r,0)),g:W(255,X(t.g,0)),b:W(255,X(t.b,0)),a:o}}function d(e,t,a){return{r:255*P(e,255),g:255*P(t,255),b:255*P(a,255)}}function c(e,t,a){e=P(e,255),t=P(t,255),a=P(a,255);var o=X(e,t,a),i=W(e,t,a),n=(o+i)/2,l,c;if(o==i)l=c=0;else{var p=o-i;c=.5<n?p/(2-o-i):p/(o+i);o===e?l=(t-a)/p+(t<a?6:0):o===t?l=(a-e)/p+2:o===a?l=(e-t)/p+4:void 0;l/=6}return{h:l,s:c,l:n}}function p(e,t,a){function o(e,a,o){return 0>o&&(o+=1),1<o&&(o-=1),o<1/6?e+6*(a-e)*o:o<1/2?a:o<2/3?e+6*((a-e)*(2/3-o)):e}var i,n,d;if(e=P(e,360),t=P(t,100),a=P(a,100),0===t)i=n=d=a;else{var c=.5>a?a*(1+t):a+t-a*t,u=2*a-c;i=o(u,c,e+1/3),n=o(u,c,e),d=o(u,c,e-1/3)}return{r:255*i,g:255*n,b:255*d}}function u(e,t,a){e=P(e,255),t=P(t,255),a=P(a,255);var o=X(e,t,a),i=W(e,t,a),n=o-i,l,d;return d=0===o?0:n/o,o==i?l=0:(o===e?l=(t-a)/n+(t<a?6:0):o===t?l=(a-e)/n+2:o===a?l=(e-t)/n+4:void 0,l/=6),{h:l,s:d,v:o}}function g(a,o,n){a=6*P(a,360),o=P(o,100),n=P(n,100);var l=e.floor(a),i=a-l,d=n*(1-o),c=n*(1-i*o),p=n*(1-(1-i)*o),t=l%6,u=[n,c,d,d,p,n][t],r=[p,n,n,c,d,d][t],g=[d,d,p,n,n,c][t];return{r:255*u,g:255*r,b:255*g}}function m(e,t,a,o){var r=[M(Y(e).toString(16)),M(Y(t).toString(16)),M(Y(a).toString(16))];return o&&r[0].charAt(0)==r[0].charAt(1)&&r[1].charAt(0)==r[1].charAt(1)&&r[2].charAt(0)==r[2].charAt(1)?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0):r.join("")}function h(e,t,o,r,a){var i=[M(Y(e).toString(16)),M(Y(t).toString(16)),M(Y(o).toString(16)),M(B(r))];return a&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)&&i[3].charAt(0)==i[3].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0)+i[3].charAt(0):i.join("")}function y(e,t,o,r){var a=[M(B(r)),M(Y(e).toString(16)),M(Y(t).toString(16)),M(Y(o).toString(16))];return a.join("")}function f(e,t){t=0===t?0:t||10;var a=l(e).toHsl();return a.s-=t/100,a.s=z(a.s),l(a)}function x(e,t){t=0===t?0:t||10;var a=l(e).toHsl();return a.s+=t/100,a.s=z(a.s),l(a)}function _(e){return l(e).desaturate(100)}function b(e,t){t=0===t?0:t||10;var a=l(e).toHsl();return a.l+=t/100,a.l=z(a.l),l(a)}function v(e,t){t=0===t?0:t||10;var a=l(e).toRgb();return a.r=X(0,W(255,a.r-Y(255*-(t/100)))),a.g=X(0,W(255,a.g-Y(255*-(t/100)))),a.b=X(0,W(255,a.b-Y(255*-(t/100)))),l(a)}function w(e,t){t=0===t?0:t||10;var a=l(e).toHsl();return a.l-=t/100,a.l=z(a.l),l(a)}function k(e,t){var a=l(e).toHsl(),o=(a.h+t)%360;return a.h=0>o?360+o:o,l(a)}function T(e){var t=l(e).toHsl();return t.h=(t.h+180)%360,l(t)}function A(e){var t=l(e).toHsl(),a=t.h;return[l(e),l({h:(a+120)%360,s:t.s,l:t.l}),l({h:(a+240)%360,s:t.s,l:t.l})]}function S(e){var t=l(e).toHsl(),a=t.h;return[l(e),l({h:(a+90)%360,s:t.s,l:t.l}),l({h:(a+180)%360,s:t.s,l:t.l}),l({h:(a+270)%360,s:t.s,l:t.l})]}function C(e){var t=l(e).toHsl(),a=t.h;return[l(e),l({h:(a+72)%360,s:t.s,l:t.l}),l({h:(a+216)%360,s:t.s,l:t.l})]}function L(e,t,a){t=t||6,a=a||30;var o=l(e).toHsl(),r=360/a,i=[l(e)];for(o.h=(o.h-(r*t>>1)+720)%360;--t;)o.h=(o.h+r)%360,i.push(l(o));return i}function E(e,t){t=t||6;for(var a=l(e).toHsv(),o=a.h,r=a.s,i=a.v,n=[],s=1/t;t--;)n.push(l({h:o,s:r,v:i})),i=(i+s)%1;return n}function I(e){return e=parseFloat(e),(isNaN(e)||0>e||1<e)&&(e=1),e}function P(e,t){O(e)&&(e="100%");var a=R(e);return e=W(t,X(0,parseFloat(e))),a&&(e=parseInt(e*t,10)/100),1e-6>i(e-t)?1:e%t/parseFloat(t)}function z(e){return W(1,X(0,e))}function D(e){return parseInt(e,16)}function O(e){return"string"==typeof e&&-1!=e.indexOf(".")&&1===parseFloat(e)}function R(e){return"string"==typeof e&&-1!=e.indexOf("%")}function M(e){return 1==e.length?"0"+e:""+e}function j(e){return 1>=e&&(e=100*e+"%"),e}function B(e){return a(255*parseFloat(e)).toString(16)}function F(e){return D(e)/255}function N(e){return!!J.CSS_UNIT.exec(e)}function V(e){e=e.replace(H,"").replace(q,"").toLowerCase();var t=!1;if(K[e])e=K[e],t=!0;else if("transparent"==e)return{r:0,g:0,b:0,a:0,format:"name"};var a;return(a=J.rgb.exec(e))?{r:a[1],g:a[2],b:a[3]}:(a=J.rgba.exec(e))?{r:a[1],g:a[2],b:a[3],a:a[4]}:(a=J.hsl.exec(e))?{h:a[1],s:a[2],l:a[3]}:(a=J.hsla.exec(e))?{h:a[1],s:a[2],l:a[3],a:a[4]}:(a=J.hsv.exec(e))?{h:a[1],s:a[2],v:a[3]}:(a=J.hsva.exec(e))?{h:a[1],s:a[2],v:a[3],a:a[4]}:(a=J.hex8.exec(e))?{r:D(a[1]),g:D(a[2]),b:D(a[3]),a:F(a[4]),format:t?"name":"hex8"}:(a=J.hex6.exec(e))?{r:D(a[1]),g:D(a[2]),b:D(a[3]),format:t?"name":"hex"}:(a=J.hex4.exec(e))?{r:D(a[1]+""+a[1]),g:D(a[2]+""+a[2]),b:D(a[3]+""+a[3]),a:F(a[4]+""+a[4]),format:t?"name":"hex8"}:!!(a=J.hex3.exec(e))&&{r:D(a[1]+""+a[1]),g:D(a[2]+""+a[2]),b:D(a[3]+""+a[3]),format:t?"name":"hex"}}function U(e){var t,a;return e=e||{level:"AA",size:"small"},t=(e.level||"AA").toUpperCase(),a=(e.size||"small").toLowerCase(),"AA"!==t&&"AAA"!==t&&(t="AA"),"small"!==a&&"large"!==a&&(a="small"),{level:t,size:a}}var H=/^\s+/,q=/\s+$/,G=0,Y=a,W=o,X=n,Z=e.random;l.prototype={isDark:function(){return 128>this.getBrightness()},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},getLuminance:function(){var e=this.toRgb(),t,a,o,i,n,l;return t=e.r/255,a=e.g/255,o=e.b/255,i=.03928>=t?t/12.92:r((t+.055)/1.055,2.4),n=.03928>=a?a/12.92:r((a+.055)/1.055,2.4),l=.03928>=o?o/12.92:r((o+.055)/1.055,2.4),.2126*i+.7152*n+.0722*l},setAlpha:function(e){return this._a=I(e),this._roundA=Y(100*this._a)/100,this},toHsv:function(){var e=u(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=u(this._r,this._g,this._b),t=Y(360*e.h),a=Y(100*e.s),o=Y(100*e.v);return 1==this._a?"hsv("+t+", "+a+"%, "+o+"%)":"hsva("+t+", "+a+"%, "+o+"%, "+this._roundA+")"},toHsl:function(){var e=c(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=c(this._r,this._g,this._b),t=Y(360*e.h),a=Y(100*e.s),o=Y(100*e.l);return 1==this._a?"hsl("+t+", "+a+"%, "+o+"%)":"hsla("+t+", "+a+"%, "+o+"%, "+this._roundA+")"},toHex:function(e){return m(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return h(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Y(this._r),g:Y(this._g),b:Y(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+Y(this._r)+", "+Y(this._g)+", "+Y(this._b)+")":"rgba("+Y(this._r)+", "+Y(this._g)+", "+Y(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Y(100*P(this._r,255))+"%",g:Y(100*P(this._g,255))+"%",b:Y(100*P(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+Y(100*P(this._r,255))+"%, "+Y(100*P(this._g,255))+"%, "+Y(100*P(this._b,255))+"%)":"rgba("+Y(100*P(this._r,255))+"%, "+Y(100*P(this._g,255))+"%, "+Y(100*P(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(1>this._a)&&($[m(this._r,this._g,this._b,!0)]||!1)},toFilter:function(e){var t="#"+y(this._r,this._g,this._b,this._a),a=t,o=this._gradientType?"GradientType = 1, ":"";if(e){var r=l(e);a="#"+y(r._r,r._g,r._b,r._a)}return"progid:DXImageTransform.Microsoft.gradient("+o+"startColorstr="+t+",endColorstr="+a+")"},toString:function(e){var t=!!e;e=e||this._format;var a=!1,o=1>this._a&&0<=this._a,r=!t&&o&&("hex"===e||"hex6"===e||"hex3"===e||"hex4"===e||"hex8"===e||"name"===e);return r?"name"===e&&0===this._a?this.toName():this.toRgbString():("rgb"===e&&(a=this.toRgbString()),"prgb"===e&&(a=this.toPercentageRgbString()),("hex"===e||"hex6"===e)&&(a=this.toHexString()),"hex3"===e&&(a=this.toHexString(!0)),"hex4"===e&&(a=this.toHex8String(!0)),"hex8"===e&&(a=this.toHex8String()),"name"===e&&(a=this.toName()),"hsl"===e&&(a=this.toHslString()),"hsv"===e&&(a=this.toHsvString()),a||this.toHexString())},clone:function(){return l(this.toString())},_applyModification:function(e,t){var a=e.apply(null,[this].concat([].slice.call(t)));return this._r=a._r,this._g=a._g,this._b=a._b,this.setAlpha(a._a),this},lighten:function(){return this._applyModification(b,arguments)},brighten:function(){return this._applyModification(v,arguments)},darken:function(){return this._applyModification(w,arguments)},desaturate:function(){return this._applyModification(f,arguments)},saturate:function(){return this._applyModification(x,arguments)},greyscale:function(){return this._applyModification(_,arguments)},spin:function(){return this._applyModification(k,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(L,arguments)},complement:function(){return this._applyCombination(T,arguments)},monochromatic:function(){return this._applyCombination(E,arguments)},splitcomplement:function(){return this._applyCombination(C,arguments)},triad:function(){return this._applyCombination(A,arguments)},tetrad:function(){return this._applyCombination(S,arguments)}},l.fromRatio=function(e,t){if("object"==typeof e){var a={};for(var o in e)e.hasOwnProperty(o)&&(a[o]="a"===o?e[o]:j(e[o]));e=a}return l(e,t)},l.equals=function(e,t){return!!(e&&t)&&l(e).toRgbString()==l(t).toRgbString()},l.random=function(){return l.fromRatio({r:Z(),g:Z(),b:Z()})},l.mix=function(e,t,a){a=0===a?0:a||50;var o=l(e).toRgb(),r=l(t).toRgb(),i=a/100,n={r:(r.r-o.r)*i+o.r,g:(r.g-o.g)*i+o.g,b:(r.b-o.b)*i+o.b,a:(r.a-o.a)*i+o.a};return l(n)},l.readability=function(e,t){var a=l(e),r=l(t);return(n(a.getLuminance(),r.getLuminance())+.05)/(o(a.getLuminance(),r.getLuminance())+.05)},l.isReadable=function(e,t,a){var o=l.readability(e,t),r,i;switch(i=!1,r=U(a),r.level+r.size){case"AAsmall":case"AAAlarge":i=4.5<=o;break;case"AAlarge":i=3<=o;break;case"AAAsmall":i=7<=o;}return i},l.mostReadable=function(e,t,a){var o=null,r=0,n,s,d,c;a=a||{},s=a.includeFallbackColors,d=a.level,c=a.size;for(var p=0;p<t.length;p++)n=l.readability(e,t[p]),n>r&&(r=n,o=l(t[p]));return l.isReadable(e,o,{level:d,size:c})||!s?o:(a.includeFallbackColors=!1,l.mostReadable(e,["#fff","#000"],a))};var K=l.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},$=l.hexNames=function(e){var t={};for(var a in e)e.hasOwnProperty(a)&&(t[e[a]]=a);return t}(K),J=function(){var e="(?:"+"[-\\+]?\\d*\\.\\d+%?"+")|(?:"+"[-\\+]?\\d+%?"+")",t="[\\s|\\(]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")\\s*\\)?",a="[\\s|\\(]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")\\s*\\)?";return{CSS_UNIT:new RegExp(e),rgb:new RegExp("rgb"+t),rgba:new RegExp("rgba"+a),hsl:new RegExp("hsl"+t),hsla:new RegExp("hsla"+a),hsv:new RegExp("hsv"+t),hsva:new RegExp("hsva"+a),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();"undefined"!=typeof t&&t.exports?t.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):window.tinycolor=l})(Math)},{}],1310:[function(e,t){'use strict';function a(e){if(e.length){if(e instanceof Float32Array)return e;var t=new Float32Array(e);return t.set(e),t}return o[0]=e,o[0]}t.exports=a,t.exports.float32=t.exports.float=a,t.exports.fract32=t.exports.fract=function(e){if(e.length){for(var t=a(e),o=0,r=t.length;o<r;o++)t[o]=e[o]-t[o];return t}return a(e-a(e))};var o=new Float32Array(1)},{}],1311:[function(e,t){'use strict';var i=Math.min,n=Math.max;function a(e,t){var a=l(getComputedStyle(e).getPropertyValue(t));return a[0]*r(a[1],e)}function o(e,t){var o=document.createElement("div");o.style.height="128"+e,t.appendChild(o);var r=a(o,"height")/128;return t.removeChild(o),r}function r(e,t){if(!e)return null;switch(t=t||document.body,e=(e+""||"px").trim().toLowerCase(),(t===window||t===document)&&(t=document.body),e){case"%":return t.clientHeight/100;case"ch":case"ex":return o(e,t);case"em":return a(t,"font-size");case"rem":return a(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return i(window.innerWidth,window.innerHeight)/100;case"vmax":return n(window.innerWidth,window.innerHeight)/100;case"in":return s;case"cm":return s/2.54;case"mm":return s/25.4;case"pt":return s/72;case"pc":return s/6;case"px":return 1;}var d=l(e);if(!isNaN(d[0])&&d[1]){var c=r(d[1],t);return"number"==typeof c?d[0]*c:null}return null}var l=e("parse-unit");t.exports=r;var s=o("in",document.body)},{"parse-unit":445}],1312:[function(e,t,a){var o=Math.round,r=Math.floor;(function(e,o){"object"==typeof a&&"undefined"!=typeof t?o(a):"function"==typeof define&&define.amd?define(["exports"],o):(e=e||self,o(e.topojson=e.topojson||{}))})(this,function(e){'use strict';function t(e){return e}function a(e){if(null==e)return t;var a=e.scale[0],o=e.scale[1],r=e.translate[0],i=e.translate[1],l,s;return function(e,t){t||(l=s=0);var d=2,c=e.length,n=Array(c);for(n[0]=(l+=e[0])*a+r,n[1]=(s+=e[1])*o+i;d<c;)n[d]=e[d],++d;return n}}function i(e){function r(e){e=l(e),e[0]<t&&(t=e[0]),e[0]>s&&(s=e[0]),e[1]<o&&(o=e[1]),e[1]>d&&(d=e[1])}function i(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(i);break;case"Point":r(e.coordinates);break;case"MultiPoint":e.coordinates.forEach(r);}}var l=a(e.transform),t=1/0,o=t,s=-t,d=-t,n;for(n in e.arcs.forEach(function(e){for(var a=-1,r=e.length,n;++a<r;)n=l(e[a],a),n[0]<t&&(t=n[0]),n[0]>s&&(s=n[0]),n[1]<o&&(o=n[1]),n[1]>d&&(d=n[1])}),e.objects)i(e.objects[n]);return[t,o,s,d]}function l(e,a){for(var o=e.length,r=o-a,n;r<--o;)n=e[r],e[r++]=e[o],e[o]=n}function s(e,t){var a=t.id,o=t.bbox,r=null==t.properties?{}:t.properties,i=d(e,t);return null==a&&null==o?{type:"Feature",properties:r,geometry:i}:null==o?{type:"Feature",id:a,properties:r,geometry:i}:{type:"Feature",id:a,bbox:o,properties:r,geometry:i}}function d(e,t){function o(e,t){t.length&&t.pop();for(var o=p[0>e?~e:e],a=0,r=o.length;a<r;++a)t.push(c(o[a],a));0>e&&l(t,r)}function r(e){return c(e)}function i(e){for(var t=[],a=0,r=e.length;a<r;++a)o(e[a],t);return 2>t.length&&t.push(t[0]),t}function n(e){for(var t=i(e);4>t.length;)t.push(t[0]);return t}function s(e){return e.map(n)}function d(e){var t=e.type,a;switch(t){case"GeometryCollection":return{type:t,geometries:e.geometries.map(d)};case"Point":a=r(e.coordinates);break;case"MultiPoint":a=e.coordinates.map(r);break;case"LineString":a=i(e.arcs);break;case"MultiLineString":a=e.arcs.map(i);break;case"Polygon":a=s(e.arcs);break;case"MultiPolygon":a=e.arcs.map(s);break;default:return null;}return{type:t,coordinates:a}}var c=a(e.transform),p=e.arcs;return d(t)}function c(e,a){function o(t){var a=e.arcs[0>t?~t:t],o=a[0],r;return e.transform?(r=[0,0],a.forEach(function(e){r[0]+=e[0],r[1]+=e[1]})):r=a[a.length-1],0>t?[r,o]:[o,r]}function r(e,t){for(var a in e){var o=e[a];delete t[o.start],delete o.start,delete o.end,o.forEach(function(e){n[0>e?~e:e]=1}),d.push(o)}}var n={},l={},s={},d=[],c=-1;return a.forEach(function(o,r){var i=e.arcs[0>o?~o:o],n;!(3>i.length)||i[1][0]||i[1][1]||(n=a[++c],a[c]=o,a[r]=n)}),a.forEach(function(t){var a=o(t),e=a[0],r=a[1],i,n;if(i=s[e]){if(delete s[i.end],i.push(t),i.end=r,n=l[r]){delete l[n.start];var d=n===i?i:i.concat(n);l[d.start=i.start]=s[d.end=n.end]=d}else l[i.start]=s[i.end]=i;}else if(!(i=l[r]))i=[t],l[i.start=e]=s[i.end=r]=i;else if(delete l[i.start],i.unshift(t),i.start=e,n=s[e]){delete s[n.end];var c=n===i?i:n.concat(i);l[c.start=n.start]=s[c.end=i.end]=c}else l[i.start]=s[i.end]=i}),r(s,l),r(l,s),a.forEach(function(e){n[0>e?~e:e]||d.push([e])}),d}function p(e,t,a){var o,r,l;if(1<arguments.length)o=u(e,t,a);else for(r=0,o=Array(l=e.arcs.length);r<l;++r)o[r]=r;return{type:"MultiLineString",arcs:c(e,o)}}function u(e,t,a){function o(e){var t=0>e?~e:e;(d[t]||(d[t]=[])).push({i:e,g:c})}function r(e){e.forEach(o)}function i(e){e.forEach(r)}function n(e){e.forEach(i)}function l(e){switch(c=e,e.type){case"GeometryCollection":e.geometries.forEach(l);break;case"LineString":r(e.arcs);break;case"MultiLineString":case"Polygon":i(e.arcs);break;case"MultiPolygon":n(e.arcs);}}var s=[],d=[],c;return l(t),d.forEach(null==a?function(e){s.push(e[0].i)}:function(e){a(e[0].g,e[e.length-1].g)&&s.push(e[0].i)}),s}function g(e){for(var t=-1,o=e.length,r=e[o-1],n=0,l;++t<o;)l=r,r=e[t],n+=l[0]*r[1]-l[1]*r[0];return Math.abs(n)}function m(e,t){function a(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(a);break;case"Polygon":r(e.arcs);break;case"MultiPolygon":e.arcs.forEach(r);}}function r(e){e.forEach(function(t){t.forEach(function(t){(s[t=0>t?~t:t]||(s[t]=[])).push(e)})}),p.push(e)}function l(t){return g(d(e,{type:"Polygon",arcs:[t]}).coordinates[0])}var s={},p=[],u=[];return t.forEach(a),p.forEach(function(e){if(!e._){var t=[],a=[e];for(e._=1,u.push(t);e=a.pop();)t.push(e),e.forEach(function(e){e.forEach(function(e){s[0>e?~e:e].forEach(function(e){e._||(e._=1,a.push(e))})})})}}),p.forEach(function(e){delete e._}),{type:"MultiPolygon",arcs:u.map(function(a){var o=[],r;if(a.forEach(function(e){e.forEach(function(e){e.forEach(function(e){2>s[0>e?~e:e].length&&o.push(e)})})}),o=c(e,o),1<(r=o.length))for(var d=1,p=l(o[0]),u,g;d<r;++d)(u=l(o[d]))>p&&(g=o[0],o[0]=o[d],o[d]=g,p=u);return o}).filter(function(e){return 0<e.length})}}function h(e,t){for(var a=0,o=e.length;a<o;){var r=a+o>>>1;e[r]<t?a=r+1:o=r}return a}function y(e){function t(e,t){e.forEach(function(e){0>e&&(e=~e);var r=l[e];r?r.push(t):l[e]=[t]})}function a(e,a){e.forEach(function(e){t(e,a)})}function r(e,t){"GeometryCollection"===e.type?e.geometries.forEach(function(e){r(e,t)}):e.type in d&&d[e.type](e.arcs,t)}var l={},s=e.map(function(){return[]}),d={LineString:t,MultiLineString:a,Polygon:a,MultiPolygon:function(e,t){e.forEach(function(e){a(e,t)})}};for(var c in e.forEach(r),l)for(var o=l[c],p=o.length,u=0;u<p;++u)for(var g=u+1;g<p;++g){var m=o[u],y=o[g],f;(f=s[m])[c=h(f,y)]!==y&&f.splice(c,0,y),(f=s[y])[c=h(f,m)]!==m&&f.splice(c,0,m)}return s}function f(e){if(null==e)return t;var a=e.scale[0],r=e.scale[1],l=e.translate[0],s=e.translate[1],d,c;return function(e,t){t||(d=c=0);var i=2,p=e.length,n=Array(p),u=o((e[0]-l)/a),g=o((e[1]-s)/r);for(n[0]=u-d,d=u,n[1]=g-c,c=g;i<p;)n[i]=e[i],++i;return n}}e.bbox=i,e.feature=function(e,t){return"string"==typeof t&&(t=e.objects[t]),"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map(function(t){return s(e,t)})}:s(e,t)},e.merge=function(e){return d(e,m.apply(this,arguments))},e.mergeArcs=m,e.mesh=function(e){return d(e,p.apply(this,arguments))},e.meshArcs=p,e.neighbors=y,e.quantize=function(e,a){function o(e){return m(e)}function l(e){var t;switch(e.type){case"GeometryCollection":t={type:"GeometryCollection",geometries:e.geometries.map(l)};break;case"Point":t={type:"Point",coordinates:o(e.coordinates)};break;case"MultiPoint":t={type:"MultiPoint",coordinates:e.coordinates.map(o)};break;default:return e;}return null!=e.id&&(t.id=e.id),null!=e.bbox&&(t.bbox=e.bbox),null!=e.properties&&(t.properties=e.properties),t}function s(e){var t=0,a=1,o=e.length,r=Array(o),n;for(r[0]=m(e[0],0);++t<o;)((n=m(e[t],t))[0]||n[1])&&(r[a++]=n);return 1==a&&(r[a++]=[0,0]),r.length=a,r}if(e.transform)throw new Error("already quantized");if(!a||!a.scale){if(!(2<=(g=r(a))))throw new Error("n must be \u22652");y=e.bbox||i(e);var d=y[0],c=y[1],p=y[2],u=y[3],g;a={scale:[p-d?(p-d)/(g-1):1,u-c?(u-c)/(g-1):1],translate:[d,c]}}else y=e.bbox;var m=f(a),t=e.objects,h={},y,x;for(x in t)h[x]=l(t[x]);return{type:"Topology",bbox:y,transform:a,objects:h,arcs:e.arcs.map(s)}},e.transform=a,e.untransform=f,Object.defineProperty(e,"__esModule",{value:!0})})},{}],1313:[function(e,t){"use strict";t.exports=function(e){if(0>e)return[];if(0===e)return[[0]];for(var t=0|Math.round(r(e+1)),n=[],l=0;l<t;++l){for(var s=a.unrank(e,l),d=[0],c=0,p=0;p<s.length;++p)c+=1<<s[p],d.push(c);1>o(s)&&(d[0]=c,d[e]=0),n.push(d)}return n};var a=e("permutation-rank"),o=e("permutation-parity"),r=e("gamma")},{gamma:209,"permutation-parity":447,"permutation-rank":448}],1314:[function(e,t){'use strict';var l=Math.asin,s=Math.acos,d=Math.exp,c=Math.atan2,p=Math.log,u=Math.cos,g=Math.sqrt,m=Math.PI,h=Math.sin,f=Math.pow,x=Math.abs,_=Math.max;function a(e,t,a){return g(f(e,2)+f(t,2)+f(a,2))}function o(e){return Math.min(1,_(-1,e))}function r(e){var t=x(e[0]),a=x(e[1]),o=x(e[2]),r=[0,0,0];t>_(a,o)?r[2]=1:a>_(t,o)?r[0]=1:r[1]=1;for(var n=0,l=0,s=0;3>s;++s)n+=e[s]*e[s],l+=r[s]*e[s];for(var s=0;3>s;++s)r[s]-=l/n*e[s];return T(r,r),r}function i(e,t,a,o,r,n,l,s){this.center=b(a),this.up=b(o),this.right=b(r),this.radius=b([n]),this.angle=b([l,s]),this.angle.bounds=[[-Infinity,-m/2],[1/0,m/2]],this.setDistanceLimits(e,t),this.computedCenter=this.center.curve(0),this.computedUp=this.up.curve(0),this.computedRight=this.right.curve(0),this.computedRadius=this.radius.curve(0),this.computedAngle=this.angle.curve(0),this.computedToward=[0,0,0],this.computedEye=[0,0,0],this.computedMatrix=Array(16);for(var d=0;16>d;++d)this.computedMatrix[d]=.5;this.recalcMatrix(0)}function n(e){e=e||{};var t=e.center||[0,0,0],o=e.up||[0,1,0],n=e.right||r(o),l=e.radius||1,d=e.theta||0,c=e.phi||0;if(t=[].slice.call(t,0,3),o=[].slice.call(o,0,3),T(o,o),n=[].slice.call(n,0,3),T(n,n),"eye"in e){var u=e.eye,g=[u[0]-t[0],u[1]-t[1],u[2]-t[2]];k(n,g,o),1e-6>a(n[0],n[1],n[2])?n=r(o):T(n,n),l=a(g[0],g[1],g[2]);var m=A(o,g)/l,h=A(n,g)/l;c=s(m),d=s(h)}return l=p(l),new i(e.zoomMin,e.zoomMax,t,o,n,l,d,c)}t.exports=n;var b=e("filtered-vector"),v=e("gl-mat4/invert"),w=e("gl-mat4/rotate"),k=e("gl-vec3/cross"),T=e("gl-vec3/normalize"),A=e("gl-vec3/dot"),S=i.prototype;S.setDistanceLimits=function(e,t){e=0<e?p(e):-Infinity,t=0<t?p(t):1/0,t=_(t,e),this.radius.bounds[0][0]=e,this.radius.bounds[1][0]=t},S.getDistanceLimits=function(e){var t=this.radius.bounds[0];return e?(e[0]=d(t[0][0]),e[1]=d(t[1][0]),e):[d(t[0][0]),d(t[1][0])]},S.recalcMatrix=function(e){this.center.curve(e),this.up.curve(e),this.right.curve(e),this.radius.curve(e),this.angle.curve(e);for(var t=this.computedUp,o=this.computedRight,r=0,n=0,l=0;3>l;++l)n+=t[l]*o[l],r+=t[l]*t[l];for(var s=g(r),c=0,l=0;3>l;++l)o[l]-=t[l]*n/r,c+=o[l]*o[l],t[l]/=s;for(var p=g(c),l=0;3>l;++l)o[l]/=p;var m=this.computedToward;k(m,t,o),T(m,m);for(var y=d(this.computedRadius[0]),f=this.computedAngle[0],_=this.computedAngle[1],b=u(f),v=h(f),w=u(_),A=h(_),S=this.computedCenter,C=this.computedEye,L=this.computedMatrix,l=0,E;3>l;++l)E=b*w*o[l]+v*w*m[l]+A*t[l],L[4*l+1]=-b*A*o[l]+-v*A*m[l]+w*t[l],L[4*l+2]=E,L[4*l+3]=0;var I=L[1],P=L[5],z=L[9],D=L[2],O=L[6],R=L[10],M=P*R-z*O,B=z*D-I*R,F=I*O-P*D,N=a(M,B,F);M/=N,B/=N,F/=N,L[0]=M,L[4]=B,L[8]=F;for(var l=0;3>l;++l)C[l]=S[l]+L[2+4*l]*y;for(var l=0,c;3>l;++l){c=0;for(var V=0;3>V;++V)c+=L[l+4*V]*C[V];L[12+l]=-c}L[15]=1},S.getMatrix=function(e,t){this.recalcMatrix(e);var a=this.computedMatrix;if(t){for(var o=0;16>o;++o)t[o]=a[o];return t}return a};var C=[0,0,0];S.rotate=function(e,t,a,o){if(this.angle.move(e,t,a),o){this.recalcMatrix(e);var r=this.computedMatrix;C[0]=r[2],C[1]=r[6],C[2]=r[10];for(var n=this.computedUp,l=this.computedRight,s=this.computedToward,d=0;3>d;++d)r[4*d]=n[d],r[4*d+1]=l[d],r[4*d+2]=s[d];w(r,r,o,C);for(var d=0;3>d;++d)n[d]=r[4*d],l[d]=r[4*d+1];this.up.set(e,n[0],n[1],n[2]),this.right.set(e,l[0],l[1],l[2])}},S.pan=function(e,t,o,r){t=t||0,o=o||0,r=r||0,this.recalcMatrix(e);var i=this.computedMatrix,n=d(this.computedRadius[0]),l=i[1],s=i[5],c=i[9],u=a(l,s,c);l/=u,s/=u,c/=u;var g=i[0],m=i[4],h=i[8],y=g*l+m*s+h*c;g-=l*y,m-=s*y,h-=c*y;var f=a(g,m,h);g/=f,m/=f,h/=f;var x=g*t+l*o,b=m*t+s*o,v=h*t+c*o;this.center.move(e,x,b,v);var w=d(this.computedRadius[0]);w=_(1e-4,w+r),this.radius.set(e,p(w))},S.translate=function(e,t,a,o){this.center.move(e,t||0,a||0,o||0)},S.setMatrix=function(e,t,r,i){var n=1;"number"==typeof r&&(n=0|r),(0>n||3<n)&&(n=1);var s=(n+2)%3;t||(this.recalcMatrix(e),t=this.computedMatrix);var p=t[n],u=t[n+4],g=t[n+8];if(!i){var h=a(p,u,g);p/=h,u/=h,g/=h}else{var y=x(p),f=x(u),b=x(g),k=_(y,f,b);y===k?(p=0>p?-1:1,u=g=0):b===k?(g=0>g?-1:1,p=u=0):(u=0>u?-1:1,p=g=0)}var T=t[s],A=t[s+4],S=t[s+8],C=T*p+A*u+S*g;T-=p*C,A-=u*C,S-=g*C;var L=a(T,A,S);T/=L,A/=L,S/=L;var E=u*S-g*A,I=g*T-p*S,P=p*A-u*T,z=a(E,I,P);E/=z,I/=z,P/=z,this.center.jump(e,void 0,void 0,void 0),this.radius.idle(e),this.up.jump(e,p,u,g),this.right.jump(e,T,A,S);var D,O;if(2==n){var R=t[1],M=t[5],j=t[9],B=R*T+M*A+j*S,F=R*E+M*I+j*P;D=0>H?-m/2:m/2,O=c(F,B)}else{var N=t[2],V=t[6],U=t[10],H=N*p+V*u+U*g,q=N*T+V*A+U*S,G=N*E+V*I+U*P;D=l(o(H)),O=c(G,q)}this.angle.jump(e,O,D),this.recalcMatrix(e);var Y=t[2],W=t[6],X=t[10],Z=this.computedMatrix;v(Z,t);var K=Z[15],w=Z[12]/K,$=Z[13]/K,J=Z[14]/K,Q=d(this.computedRadius[0]);this.center.jump(e,w-Y*Q,$-W*Q,J-X*Q)},S.lastT=function(){return _(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())},S.idle=function(e){this.center.idle(e),this.up.idle(e),this.right.idle(e),this.radius.idle(e),this.angle.idle(e)},S.flush=function(e){this.center.flush(e),this.up.flush(e),this.right.flush(e),this.radius.flush(e),this.angle.flush(e)},S.setDistance=function(e,t){0<t&&this.radius.set(e,p(t))},S.lookAt=function(e,t,r,i){this.recalcMatrix(e),t=t||this.computedEye,r=r||this.computedCenter,i=i||this.computedUp;var n=i[0],s=i[1],d=i[2],u=a(n,s,d);if(!(1e-6>u)){n/=u,s/=u,d/=u;var g=t[0]-r[0],h=t[1]-r[1],y=t[2]-r[2],f=a(g,h,y);if(!(1e-6>f)){g/=f,h/=f,y/=f;var _=this.computedRight,b=_[0],v=_[1],w=_[2],k=n*b+s*v+d*w;b-=k*n,v-=k*s,w-=k*d;var T=a(b,v,w);if(!(.01>T&&(b=s*y-d*h,v=d*g-n*y,w=n*h-s*g,T=a(b,v,w),1e-6>T))){b/=T,v/=T,w/=T,this.up.set(e,n,s,d),this.right.set(e,b,v,w),this.center.set(e,r[0],r[1],r[2]),this.radius.set(e,p(f));var A=s*w-d*v,S=d*b-n*w,C=n*v-s*b,L=a(A,S,C);A/=L,S/=L,C/=L;var E=n*g+s*h+d*y,I=b*g+v*h+w*y,P=A*g+S*h+C*y,z=l(o(E)),D=c(P,I),O=this.angle._state,R=O[O.length-1],M=O[O.length-2];R%=2*m;var j=x(R+2*m-D),B=x(R-D),F=x(R-2*m-D);j<B&&(R+=2*m),F<B&&(R-=2*m),this.angle.jump(this.angle.lastT(),R,M),this.angle.set(e,D,z)}}}}},{"filtered-vector":203,"gl-mat4/invert":242,"gl-mat4/rotate":247,"gl-vec3/cross":304,"gl-vec3/dot":309,"gl-vec3/normalize":326}],1315:[function(e,t){"use strict";t.exports=function(e,t,a){var o=e*t,r=134217729*e,i=r-(r-e),n=e-i,l=134217729*t,s=l-(l-t),d=t-s,c=n*d-(o-i*s-n*s-i*d);return a?(a[0]=c,a[1]=o,a):[c,o]};+(Math.pow(2,27)+1)},{}],1316:[function(e,t){"use strict";t.exports=function(e,t,a){var o=e+t,r=o-e,i=t-r,n=e-(o-r);return a?(a[0]=n+i,a[1]=o,a):[n+i,o]}},{}],1317:[function(e,t){"use strict";var a=e("../prototype/is");t.exports=function(e){if("function"!=typeof e)return!1;if(!hasOwnProperty.call(e,"length"))return!1;try{if("number"!=typeof e.length)return!1;if("function"!=typeof e.call)return!1;if("function"!=typeof e.apply)return!1}catch(e){return!1}return!a(e)}},{"../prototype/is":1324}],1318:[function(e,t){"use strict";var a=e("../value/is"),o=e("../object/is"),r=e("../string/coerce"),i=e("./to-short-string"),n=function(e,t){return e.replace("%v",i(t))};t.exports=function(e,t,i){if(!o(i))throw new TypeError(n(t,e));if(!a(e)){if("default"in i)return i["default"];if(i.isOptional)return null}var l=r(i.errorMessage);throw a(l)||(l=t),new TypeError(n(l,e))}},{"../object/is":1321,"../string/coerce":1325,"../value/is":1327,"./to-short-string":1320}],1319:[function(e,t){"use strict";t.exports=function(e){try{return e.toString()}catch(t){try{return e+""}catch(e){return null}}}},{}],1320:[function(e,t){"use strict";var a=e("./safe-to-string");t.exports=function(e){var t=a(e);return null===t?"<Non-coercible to string value>":(100<t.length&&(t=t.slice(0,99)+"\u2026"),t=t.replace(/[\n\r\u2028\u2029]/g,function(e){switch(e){case"\n":return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw new Error("Unexpected character");}}),t)}},{"./safe-to-string":1319}],1321:[function(e,t){"use strict";var a=e("../value/is"),o={object:!0,function:!0,undefined:!0};t.exports=function(e){return!!a(e)&&hasOwnProperty.call(o,typeof e)}},{"../value/is":1327}],1322:[function(e,t){"use strict";var a=e("../lib/resolve-exception"),o=e("./is");t.exports=function(e){return o(e)?e:a(e,"%v is not a plain function",arguments[1])}},{"../lib/resolve-exception":1318,"./is":1323}],1323:[function(e,t){"use strict";var a=e("../function/is"),o=Function.prototype.toString;t.exports=function(e){return!!a(e)&&!/^\s*class[\s{/}]/.test(o.call(e))}},{"../function/is":1317}],1324:[function(e,t){"use strict";var a=e("../object/is");t.exports=function(e){if(!a(e))return!1;try{return!!e.constructor&&e.constructor.prototype===e}catch(e){return!1}}},{"../object/is":1321}],1325:[function(e,t){"use strict";var a=e("../value/is"),o=e("../object/is"),r=Object.prototype.toString;t.exports=function(e){if(!a(e))return null;if(o(e)){var t=e.toString;if("function"!=typeof t)return null;if(t===r)return null}try{return""+e}catch(e){return null}}},{"../object/is":1321,"../value/is":1327}],1326:[function(e,t){"use strict";var a=e("../lib/resolve-exception"),o=e("./is");t.exports=function(e){return o(e)?e:a(e,"Cannot use %v",arguments[1])}},{"../lib/resolve-exception":1318,"./is":1327}],1327:[function(e,t){"use strict";var a;t.exports=function(e){return e!==a&&null!==e}},{}],1328:[function(e,t,a){(function(t){'use strict';function o(e){if(e){var t=e.length||e.byteLength,a=_.log2(t);S[a].push(e)}}function r(e){var e=_.nextPow2(e),t=_.log2(e),a=S[t];return 0<a.length?a.pop():new ArrayBuffer(e)}function i(e){return new Uint8Array(r(e),0,e)}function l(e){return new Uint16Array(r(2*e),0,e)}function s(e){return new Uint32Array(r(4*e),0,e)}function d(e){return new Int8Array(r(e),0,e)}function c(e){return new Int16Array(r(2*e),0,e)}function p(e){return new Int32Array(r(4*e),0,e)}function u(e){return new Float32Array(r(4*e),0,e)}function g(e){return new Float64Array(r(8*e),0,e)}function m(e){return w?new Uint8ClampedArray(r(e),0,e):i(e)}function h(e){return k?new BigUint64Array(r(8*e),0,e):null}function y(e){return T?new BigInt64Array(r(8*e),0,e):null}function f(e){return new DataView(r(e),0,e)}function x(e){e=_.nextPow2(e);var t=_.log2(e),a=C[t];return 0<a.length?a.pop():new v(e)}var _=e("bit-twiddle"),b=e("dup"),v=e("buffer").Buffer;t.__TYPEDARRAY_POOL||(t.__TYPEDARRAY_POOL={UINT8:b([32,0]),UINT16:b([32,0]),UINT32:b([32,0]),BIGUINT64:b([32,0]),INT8:b([32,0]),INT16:b([32,0]),INT32:b([32,0]),BIGINT64:b([32,0]),FLOAT:b([32,0]),DOUBLE:b([32,0]),DATA:b([32,0]),UINT8C:b([32,0]),BUFFER:b([32,0])});var w="undefined"!=typeof Uint8ClampedArray,k="undefined"!=typeof BigUint64Array,T="undefined"!=typeof BigInt64Array,A=t.__TYPEDARRAY_POOL;A.UINT8C||(A.UINT8C=b([32,0])),A.BIGUINT64||(A.BIGUINT64=b([32,0])),A.BIGINT64||(A.BIGINT64=b([32,0])),A.BUFFER||(A.BUFFER=b([32,0]));var S=A.DATA,C=A.BUFFER;a.free=function(e){if(v.isBuffer(e))C[_.log2(e.length)].push(e);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(e)&&(e=e.buffer),!e)return;var t=e.length||e.byteLength,a=0|_.log2(t);S[a].push(e)}},a.freeUint8=a.freeUint16=a.freeUint32=a.freeBigUint64=a.freeInt8=a.freeInt16=a.freeInt32=a.freeBigInt64=a.freeFloat32=a.freeFloat=a.freeFloat64=a.freeDouble=a.freeUint8Clamped=a.freeDataView=function(e){o(e.buffer)},a.freeArrayBuffer=o,a.freeBuffer=function(e){C[_.log2(e.length)].push(e)},a.malloc=function(e,t){return void 0===t||"arraybuffer"===t?r(e):"uint8"===t?i(e):"uint16"===t?l(e):"uint32"===t?s(e):"int8"===t?d(e):"int16"===t?c(e):"int32"===t?p(e):"float"===t||"float32"===t?u(e):"double"===t||"float64"===t?g(e):"uint8_clamped"===t?m(e):"bigint64"===t?y(e):"biguint64"===t?h(e):"buffer"===t?x(e):"data"===t||"dataview"===t?f(e):null},a.mallocArrayBuffer=r,a.mallocUint8=i,a.mallocUint16=l,a.mallocUint32=s,a.mallocInt8=d,a.mallocInt16=c,a.mallocInt32=p,a.mallocFloat32=a.mallocFloat=u,a.mallocFloat64=a.mallocDouble=g,a.mallocUint8Clamped=m,a.mallocBigUint64=h,a.mallocBigInt64=y,a.mallocDataView=f,a.mallocBuffer=x,a.clearCache=function(){for(var e=0;32>e;++e)A.UINT8[e].length=0,A.UINT16[e].length=0,A.UINT32[e].length=0,A.INT8[e].length=0,A.INT16[e].length=0,A.INT32[e].length=0,A.FLOAT[e].length=0,A.DOUBLE[e].length=0,A.BIGUINT64[e].length=0,A.BIGINT64[e].length=0,A.UINT8C[e].length=0,S[e].length=0,C[e].length=0}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"bit-twiddle":43,buffer:1420,dup:116}],1329:[function(e,t,a){var o=String.prototype,r=Math.cos,n=Math.ceil,l=Math.round,s=Math.PI,d=Math.min,c=Math.pow,u=Math.abs,g=Math.max,m=Math.floor;(function(e){/*! UIkit 3.4.2 | https://www.getuikit.com | (c) 2014 - 2020 YOOtheme | MIT License */(function(e,o){"object"==typeof a&&"undefined"!=typeof t?t.exports=o():"function"==typeof define&&define.amd?define("uikit",o):(e=e||self,e.UIkit=o())})(this,function(){'use strict';function t(e,t){return zo.call(e,t)}function a(e){return e in Do||(Do[e]=e.replace(Oo,"$1-$2").toLowerCase()),Do[e]}function i(e){return e.replace(Ro,h)}function h(e,t){return t?t.toUpperCase():""}function y(e){return e.length?h(null,e.charAt(0))+e.slice(1):""}function f(e,t){return jo.call(e,t)}function _(e,t){return Bo.call(e,t)}function b(e,t){return e&&(z(e)?Vo:Uo).call(e,t)}function v(e,t){return Ho.call(e,t)}function w(e){return"function"==typeof e}function k(e){return null!==e&&"object"==typeof e}function T(e){return"[object Object]"===Go.call(e)}function A(e){return k(e)&&e===e.window}function S(e){return k(e)&&9===e.nodeType}function C(e){return k(e)&&!!e.jquery}function L(e){return k(e)&&1<=e.nodeType}function E(e){return k(e)&&1===e.nodeType}function I(e){return Go.call(e).match(/^\[object (NodeList|HTMLCollection)\]$/)}function P(e){return"boolean"==typeof e}function z(e){return"string"==typeof e}function D(e){return"number"==typeof e}function O(e){return D(e)||z(e)&&!isNaN(e-parseFloat(e))}function R(e){return qo(e)?!e.length:!k(e)||!Object.keys(e).length}function M(e){return void 0===e}function j(e){return P(e)?e:"true"===e||"1"===e||""===e||"false"!==e&&"0"!==e&&e}function B(e){var t=+e;return!isNaN(t)&&t}function F(e){return parseFloat(e)||0}function N(e){return L(e)?e:I(e)||C(e)?e[0]:qo(e)?N(e[0]):null}function V(e){return L(e)?[e]:I(e)?Fo.slice.call(e):qo(e)?e.map(N).filter(Boolean):C(e)?e.toArray():[]}function U(e){return A(e)?e:(e=N(e),e?(S(e)?e:e.ownerDocument).defaultView:window)}function H(e){return qo(e)?e:z(e)?e.split(/,(?![^(]*\))/).map(function(e){return O(e)?B(e):j(e.trim())}):[e]}function q(e){return e?_(e,"ms")?F(e):1e3*F(e):0}function G(e,t){return e===t||k(e)&&k(t)&&Object.keys(e).length===Object.keys(t).length&&X(e,function(e,a){return e===t[a]})}function Y(e,t,a){return e.replace(new RegExp(t+"|"+a,"g"),function(e){return e===t?a:t})}function W(e){return e[e.length-1]}function X(e,t){for(var a in e)if(!1===t(e[a],a))return!1;return!0}function Z(e,t){return e.sort(function(e,a){var o=e[t];void 0===o&&(o=0);var r=a[t];return void 0===r&&(r=0),o>r?1:r>o?-1:0})}function K(e,t){var a=new Set;return e.filter(function(e){var o=e[t];return!a.has(o)&&(a.add(o)||!0)})}function J(e,t,a){return void 0===t&&(t=0),void 0===a&&(a=1),d(g(B(e)||0,t),a)}function Q(){}function ee(e,t){return e.left<t.right&&e.right>t.left&&e.top<t.bottom&&e.bottom>t.top}function te(e,t){return e.x<=t.right&&e.x>=t.left&&e.y<=t.bottom&&e.y>=t.top}function ae(e,t,a){if(k(t)){for(var o in t)ae(e,o,t[o]);return}return M(a)?(e=N(e),e&&e.getAttribute(t)):void V(e).forEach(function(e){w(a)&&(a=a.call(e,ae(e,t))),null===a?re(e,t):e.setAttribute(t,a)})}function oe(e,t){return V(e).some(function(e){return e.hasAttribute(t)})}function re(e,t){e=V(e),t.split(" ").forEach(function(t){return e.forEach(function(e){return e.hasAttribute(t)&&e.removeAttribute(t)})})}function ie(e,t){for(var a=0,o=[t,"data-"+t];a<o.length;a++)if(oe(e,o[a]))return ae(e,o[a])}function ne(e,t){return N(e)||de(e,se(e,t))}function le(e,t){var a=V(e);return a.length&&a||ce(e,se(e,t))}function se(e,t){return void 0===t&&(t=document),ue(e)||S(t)?t:t.ownerDocument}function de(e,t){return N(pe(e,t,"querySelector"))}function ce(e,t){return V(pe(e,t,"querySelectorAll"))}function pe(e,t,a){if(void 0===t&&(t=document),!e||!z(e))return null;e=e.replace(nr,"$1 *");var o;ue(e)&&(o=[],e=ge(e).map(function(e,a){var r=t;if("!"===e[0]){var i=e.substr(1).trim().split(" ");r=he(ye(t),i[0]),e=i.slice(1).join(" ").trim()}if("-"===e[0]){var n=e.substr(1).trim().split(" "),l=(r||t).previousElementSibling;r=me(l,e.substr(1))?l:null,e=n.slice(1).join(" ")}return r?(r.id||(r.id="uk-"+Date.now()+a,o.push(function(){return re(r,"id")})),"#"+fe(r.id)+" "+e):null}).filter(Boolean).join(","),t=document);try{return t[a](e)}catch(t){return null}finally{o&&o.forEach(function(e){return e()})}}function ue(e){return z(e)&&e.match(ir)}function ge(e){return e.match(lr).map(function(e){return e.replace(/,$/,"").trim()})}function me(e,t){return V(e).some(function(e){return dr.call(e,t)})}function he(e,t){return f(t,">")&&(t=t.slice(1)),E(e)?cr.call(e,t):V(e).map(function(e){return he(e,t)}).filter(Boolean)}function ye(e){return e=N(e),e&&E(e.parentNode)&&e.parentNode}function fe(e){return z(e)?pr.call(null,e):""}function xe(e){return V(e).some(function(e){return ur[e.tagName.toLowerCase()]})}function _e(e){return V(e).some(function(e){return e.offsetWidth||e.offsetHeight||e.getClientRects().length})}function be(e){return V(e).some(function(e){return me(e,"input,select,textarea,button")})}function ve(e,t){return V(e).filter(function(e){return me(e,t)})}function we(e,t){return z(t)?me(e,t)||he(e,t):e===t||(S(t)?t.documentElement:N(t)).contains(N(e))}function ke(e,t){for(var a=[];e=ye(e);)(!t||me(e,t))&&a.push(e);return a}function Te(e,t){e=N(e);var a=e?V(e.children):[];return t?ve(a,t):a}function Ae(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var a=Ee(e),o=a[0],r=a[1],i=a[2],n=a[3],l=a[4];return o=Me(o),1<n.length&&(n=Pe(n)),l&&l.self&&(n=ze(n)),i&&(n=Ie(o,i,n)),l=De(l),r.split(" ").forEach(function(e){return o.forEach(function(t){return t.addEventListener(e,n,l)})}),function(){return x(o,r,n,l)}}function x(e,t,a,o){void 0===o&&(o=!1),o=De(o),e=Me(e),t.split(" ").forEach(function(t){return e.forEach(function(e){return e.removeEventListener(t,a,o)})})}function Se(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var a=Ee(e),o=a[0],r=a[1],i=a[2],n=a[3],l=a[4],s=a[5],d=Ae(o,r,i,function(t){var e=!s||s(t);e&&(d(),n(t,e))},l);return d}function Ce(e,t,a){return Me(e).reduce(function(e,o){return e&&o.dispatchEvent(Le(t,!0,!0,a))},!0)}function Le(t,a,o,r){if(void 0===a&&(a=!0),void 0===o&&(o=!1),z(t)){var i=document.createEvent("CustomEvent");i.initCustomEvent(t,a,o,r),t=i}return t}function Ee(e){return w(e[2])&&e.splice(2,0,!1),e}function Ie(t,a,o){var r=this;return function(i){t.forEach(function(e){var t=">"===a[0]?ce(a,e).reverse().filter(function(e){return we(i.target,e)})[0]:he(i.target,a);t&&(i.delegate=e,i.current=t,o.call(r,i))})}}function Pe(t){return function(a){return qo(a.detail)?t.apply(void 0,[a].concat(a.detail)):t(a)}}function ze(t){return function(a){if(a.target===a.currentTarget||a.target===a.current)return t.call(null,a)}}function De(e){return e&&Xo&&!P(e)?!!e.capture:e}function Oe(e){return e&&"addEventListener"in e}function Re(e){return Oe(e)?e:N(e)}function Me(e){return qo(e)?e.map(Re).filter(Boolean):z(e)?ce(e):Oe(e)?[e]:V(e)}function je(t){return"touch"===t.pointerType||!!t.touches}function Be(t){var e=t.touches,a=t.changedTouches,o=e&&e[0]||a&&a[0]||t,r=o.clientX,i=o.clientY;return{x:r,y:i}}function Fe(e){this.state=2,this.value=void 0,this.deferred=[];var t=this;try{e(function(e){t.resolve(e)},function(e){t.reject(e)})}catch(a){t.reject(a)}}function Ne(e,t){return new mr(function(a,o){var r=Yo({data:null,method:"GET",headers:{},xhr:new XMLHttpRequest,beforeSend:Q,responseType:""},t);r.beforeSend(r);var i=r.xhr;for(var n in r)if(n in i)try{i[n]=r[n]}catch(t){}for(var l in i.open(r.method.toUpperCase(),e),r.headers)i.setRequestHeader(l,r.headers[l]);Ae(i,"load",function(){0===i.status||200<=i.status&&300>i.status||304===i.status?a(i):o(Yo(Error(i.statusText),{xhr:i,status:i.status}))}),Ae(i,"error",function(){return o(Yo(Error("Network Error"),{xhr:i}))}),Ae(i,"timeout",function(){return o(Yo(Error("Network Timeout"),{xhr:i}))}),i.send(r.data)})}function Ve(e,t,a){return new mr(function(o,r){var i=new Image;i.onerror=r,i.onload=function(){return o(i)},a&&(i.sizes=a),t&&(i.srcset=t),i.src=e})}function Ue(e){if("loading"!==document.readyState)return void e();var t=Ae(document,"DOMContentLoaded",function(){t(),e()})}function He(e,t){return t?V(e).indexOf(N(t)):Te(ye(e)).indexOf(e)}function qe(e,t,a,o){void 0===a&&(a=0),void 0===o&&(o=!1),t=V(t);var r=t.length;return(e=O(e)?B(e):"next"===e?a+1:"previous"===e?a-1:He(t,e),o)?J(e,0,r-1):(e%=r,0>e?e+r:e)}function Ge(e){return e=ot(e),e.innerHTML="",e}function Ye(e,t){return e=ot(e),M(t)?e.innerHTML:We(e.hasChildNodes()?Ge(e):e,t)}function We(e,t){return e=ot(e),Ke(t,function(t){return e.appendChild(t)})}function Xe(e,t){return e=ot(e),Ke(t,function(t){return e.parentNode.insertBefore(t,e)})}function Ze(e,t){return e=ot(e),Ke(t,function(t){return e.nextSibling?Xe(e.nextSibling,t):We(e.parentNode,t)})}function Ke(e,t){return e=z(e)?tt(e):e,e?"length"in e?V(e).map(t):t(e):null}function $e(e){V(e).map(function(e){return e.parentNode&&e.parentNode.removeChild(e)})}function Je(e,t){for(t=N(Xe(e,t));t.firstChild;)t=t.firstChild;return We(t,e),t}function Qe(e,t){return V(V(e).map(function(e){return e.hasChildNodes?Je(V(e.childNodes),t):We(e,t)}))}function et(e){V(e).map(ye).filter(function(e,t,a){return a.indexOf(e)===t}).forEach(function(e){Xe(e,e.childNodes),$e(e)})}function tt(e){var t=vr.exec(e);if(t)return document.createElement(t[1]);var a=document.createElement("div");return p.test(e)?a.insertAdjacentHTML("beforeend",e.trim()):a.textContent=e,1<a.childNodes.length?V(a.childNodes):a.firstChild}function at(e,t){if(E(e))for(t(e),e=e.firstElementChild;e;){var a=e.nextElementSibling;at(e,t),e=a}}function ot(e,t){return z(e)?rt(e)?N(tt(e)):de(e,t):N(e)}function $(e,t){return z(e)?rt(e)?V(tt(e)):ce(e,t):V(e)}function rt(e){return"<"===e[0]||e.match(/^\s*</)}function it(e){for(var t=[],a=arguments.length-1;0<a--;)t[a]=arguments[a+1];pt(e,t,"add")}function nt(e){for(var t=[],a=arguments.length-1;0<a--;)t[a]=arguments[a+1];pt(e,t,"remove")}function lt(e,t){ae(e,"class",function(e){return(e||"").replace(new RegExp("\\b"+t+"\\b","g"),"")})}function st(e){for(var t=[],a=arguments.length-1;0<a--;)t[a]=arguments[a+1];t[0]&&nt(e,t[0]),t[1]&&it(e,t[1])}function dt(e,t){return t&&V(e).some(function(e){return e.classList.contains(t.split(" ")[0])})}function ct(e){for(var t=[],a=arguments.length-1;0<a--;)t[a]=arguments[a+1];if(t.length){t=ut(t);var o=z(W(t))?[]:t.pop();t=t.filter(Boolean),V(e).forEach(function(e){for(var a=e.classList,r=0;r<t.length;r++)wr.Force?a.toggle.apply(a,[t[r]].concat(o)):a[(M(o)?!a.contains(t[r]):o)?"add":"remove"](t[r])})}}function pt(e,t,a){t=ut(t).filter(Boolean),t.length&&V(e).forEach(function(e){var o=e.classList;wr.Multiple?o[a].apply(o,t):t.forEach(function(e){return o[a](e)})})}function ut(e){return e.reduce(function(e,t){return e.concat.call(e,z(t)&&b(t," ")?t.trim().split(" "):t)},[])}function gt(e,t,a){return V(e).map(function(e){if(z(t)){if(t=ft(t),M(a))return ht(e,t);a||D(a)?e.style[t]=O(a)&&!kr[t]?a+"px":a:e.style.removeProperty(t)}else{if(qo(t)){var o=mt(e);return t.reduce(function(e,t){return e[t]=o[ft(t)],e},{})}k(t)&&X(t,function(t,a){return gt(e,a,t)})}return e})[0]}function mt(e,t){return e=N(e),e.ownerDocument.defaultView.getComputedStyle(e,t)}function ht(e,t,a){return mt(e,a)[t]}function yt(e){var t=document.documentElement;if(!Xo)return mt(t).getPropertyValue("--uk-"+e);if(!(e in Tr)){var a=We(t,document.createElement("div"));it(a,"uk-"+e),Tr[e]=ht(a,"content",":before").replace(/^["'](.*)["']$/,"$1"),$e(a)}return Tr[e]}function ft(e){var t=Ar[e];return t||(t=Ar[e]=xt(e)||e),t}function xt(e){e=a(e);var t=document.documentElement,o=t.style;if(e in o)return e;for(var r=Sr.length,n;r--;)if(n="-"+Sr[r]+"-"+e,n in o)return n}function _t(e,t,a,o){return void 0===a&&(a=400),void 0===o&&(o="linear"),mr.all(V(e).map(function(e){return new mr(function(r,i){for(var n in t){var l=gt(e,n);""===l&&gt(e,n,l)}var s=setTimeout(function(){return Ce(e,"transitionend")},a);Se(e,"transitionend transitioncanceled",function(t){var a=t.type;clearTimeout(s),nt(e,"uk-transition"),gt(e,{transitionProperty:"",transitionDuration:"",transitionTimingFunction:""}),"transitioncanceled"===a?i():r()},{self:!0}),it(e,"uk-transition"),gt(e,Yo({transitionProperty:Object.keys(t).map(ft).join(","),transitionDuration:a+"ms",transitionTimingFunction:o},t))})}))}function bt(e,t,a,o,r){var i=arguments;return void 0===a&&(a=200),mr.all(V(e).map(function(e){return new mr(function(n,l){function s(){gt(e,"animationDuration",""),lt(e,"uk-animation-\\S*")}if(dt(e,"uk-cancel-animation"))return void requestAnimationFrame(function(){return mr.resolve().then(function(){return bt.apply(void 0,i).then(n,l)})});var d=t+" uk-animation-"+(r?"leave":"enter");f(t,"uk-animation-")&&(o&&(d+=" uk-transform-origin-"+o),r&&(d+=" uk-animation-reverse")),s(),Se(e,"animationend animationcancel",function(t){var a=t.type,o=!1;"animationcancel"===a?(l(),s()):(n(),mr.resolve().then(function(){o=!0,s()})),requestAnimationFrame(function(){o||(it(e,"uk-cancel-animation"),requestAnimationFrame(function(){return nt(e,"uk-cancel-animation")}))})},{self:!0}),gt(e,"animationDuration",a+"ms"),it(e,d)})}))}function vt(e,t,a,o,r,i,n,l){a=Et(a),o=Et(o);var s={element:a,target:o};if(!e||!t)return s;var d=kt(e),c=kt(t),p=c;if(Lt(p,a,d,-1),Lt(p,o,c,1),r=It(r,d.width,d.height),i=It(i,c.width,c.height),r.x+=i.x,r.y+=i.y,p.left+=r.x,p.top+=r.y,n){var u=[kt(U(e))];l&&u.unshift(kt(l)),X(Ir,function(e,t){var i=e[0],l=e[1],g=e[2];(!0===n||b(n,i))&&u.some(function(e){function n(a,o){var n=p[l]+a+o-2*r[i];if(n>=e[l]&&n+d[t]<=e[g])return p[l]=n,["element","target"].forEach(function(e){s[e][i]=a?s[e][i]===Ir[t][1]?Ir[t][2]:Ir[t][1]:s[e][i]}),!0}var u=a[i]===l?-d[t]:a[i]===g?d[t]:0,m=o[i]===l?c[t]:o[i]===g?-c[t]:0;if(p[l]<e[l]||p[l]+d[t]>e[g]){var h=d[t]/2,y="center"===o[i]?-c[t]/2:0;return"center"===a[i]&&(n(h,y)||n(-h,-y))||n(u,m)}})})}return wt(e,p),s}function wt(e,t){if(!t)return kt(e);var a=wt(e),o=gt(e,"position");["left","top"].forEach(function(r){if(r in t){var i=gt(e,r);gt(e,r,t[r]-a[r]+F("absolute"===o&&"auto"===i?Tt(e)[r]:i))}})}function kt(e){if(!e)return{};var t=U(e),a=t.pageYOffset,o=t.pageXOffset;if(A(e)){var r=e.innerHeight,i=e.innerWidth;return{top:a,left:o,height:r,width:i,bottom:a+r,right:o+i}}var n,l;_e(e)||"none"!==gt(e,"display")||(n=ae(e,"style"),l=ae(e,"hidden"),ae(e,{style:(n||"")+";display:block !important;",hidden:null})),e=N(e);var s=e.getBoundingClientRect();return M(n)||ae(e,{style:n,hidden:l}),{height:s.height,width:s.width,top:s.top+a,left:s.left+o,bottom:s.bottom+a,right:s.right+o}}function Tt(e,t){t=t||N(e).offsetParent||U(e).document.documentElement;var a=wt(e),o=wt(t);return{top:a.top-o.top-F(gt(t,"borderTopWidth")),left:a.left-o.left-F(gt(t,"borderLeftWidth"))}}function At(e){var t=[0,0];e=N(e);do if(t[0]+=e.offsetTop,t[1]+=e.offsetLeft,"fixed"===gt(e,"position")){var a=U(e);return t[0]+=a.pageYOffset,t[1]+=a.pageXOffset,t}while(e=e.offsetParent);return t}function St(e){var t=y(e);return function(a,o){if(M(o)){if(A(a))return a["inner"+t];if(S(a)){var r=a.documentElement;return g(r["offset"+t],r["scroll"+t])}return a=N(a),o=gt(a,e),o="auto"===o?a["offset"+t]:F(o)||0,o-Ct(a,e)}gt(a,e,o||0===o?+o+Ct(a,e)+"px":"")}}function Ct(e,t,a){return void 0===a&&(a="border-box"),gt(e,"boxSizing")===a?Ir[t].slice(1).map(y).reduce(function(t,a){return t+F(gt(e,"padding"+a))+F(gt(e,"border"+a+"Width"))},0):0}function Lt(e,t,a,o){X(Ir,function(r,i){var n=r[0],l=r[1],s=r[2];t[n]===s?e[l]+=a[i]*o:"center"===t[n]&&(e[l]+=a[i]*o/2)})}function Et(e){var t=/left|center|right/,a=/top|center|bottom/;return e=(e||"").split(" "),1===e.length&&(e=t.test(e[0])?e.concat("center"):a.test(e[0])?["center"].concat(e):["center","center"]),{x:t.test(e[0])?e[0]:"center",y:a.test(e[1])?e[1]:"center"}}function It(e,t,a){var o=(e||"").split(" "),r=o[0],i=o[1];return{x:r?F(r)*(_(r,"%")?t/100:1):0,y:i?F(i)*(_(i,"%")?a/100:1):0}}function Pt(e){return"left"===e?"right":"right"===e?"left":"top"===e?"bottom":"bottom"===e?"top":e}function zt(e,t,a){return void 0===t&&(t="width"),void 0===a&&(a=window),O(e)?+e:_(e,"vh")?Dt(Pr(U(a)),e):_(e,"vw")?Dt(zr(U(a)),e):_(e,"%")?Dt(kt(a)[t],e):F(e)}function Dt(e,t){return e*F(t)/100}function Ot(e){void 0===e&&(e=1),Mt(Dr.reads),Mt(Dr.writes.splice(0,Dr.writes.length)),Dr.scheduled=!1,(Dr.reads.length||Dr.writes.length)&&Rt(e+1)}function Rt(e){if(!Dr.scheduled)if(Dr.scheduled=!0,5<e)throw new Error("Maximum recursion limit reached.");else e?mr.resolve().then(function(){return Ot(e)}):requestAnimationFrame(function(){return Ot()})}function Mt(e){for(var t;t=e.shift();)t()}function jt(e,t){var a=e.indexOf(t);return!!~a&&!!e.splice(a,1)}function Bt(){}function Ft(e,t){var a=e[0],o=a.x,r=a.y,i=e[1],n=i.x,l=i.y,s=t[0],d=s.x,c=s.y,p=t[1],u=p.x,g=p.y,m=(g-c)*(n-o)-(u-d)*(l-r);if(0===m)return!1;var h=((u-d)*(r-c)-(g-c)*(o-d))/m;return!(0>h)&&{x:o+h*(n-o),y:r+h*(l-r)}}function Nt(e,t,a){return Or.computed(w(e)?e.call(a,a):e,w(t)?t.call(a,a):t)}function Vt(e,t){return e=e&&!qo(e)?[e]:e,t?e?e.concat(t):qo(t)?t:[t]:e}function Ut(e,t){return M(t)?e:t}function Ht(e,a,o){function r(t){n[t]=(Or[t]||Ut)(e[t],a[t],o)}var n={};if(w(a)&&(a=a.options),a.extends&&(e=Ht(e,a.extends,o)),a.mixins)for(var s=0,d=a.mixins.length;s<d;s++)e=Ht(e,a.mixins[s],o);for(var l in e)r(l);for(var c in a)t(e,c)||r(c);return n}function qt(e,t){var a;void 0===t&&(t=[]);try{return e?f(e,"{")?JSON.parse(e):t.length&&!b(e,":")?(a={},a[t[0]]=e,a):e.split(";").reduce(function(e,t){var a=t.split(/:(.*)/),o=a[0],r=a[1];return o&&!M(r)&&(e[o.trim()]=r.trim()),e},{}):{}}catch(t){return{}}}function Gt(e,t){try{e.contentWindow.postMessage(JSON.stringify(Yo({event:"command"},t)),"*")}catch(t){}}function Yt(e){return new mr(function(t){return Se(window,"message",function(e,a){return t(a)},!1,function(t){var a=t.data;if(a&&z(a)){try{a=JSON.parse(a)}catch(t){return}return a&&e(a)}})})}function Wt(e,t,a){if(void 0===t&&(t=0),void 0===a&&(a=0),!_e(e))return!1;for(var o=Qt(e).concat(e),r=0;r<o.length-1;r++){var n=wt(Jt(o[r])),l=n.top,s=n.left,d=n.bottom,c=n.right,p={top:l-t,left:s-a,bottom:d+t,right:c+a},u=wt(o[r+1]);if(!ee(u,p)&&!te({x:u.left,y:u.top},p))return!1}return!0}function Xt(e,t){e=A(e)||S(e)?ea(e):N(e),e.scrollTop=t}function Zt(e,t){function a(e){return 40*c(e,.375)}function o(e){return .5*(1-r(s*e))}void 0===t&&(t={});var l=t.offset;if(void 0===l&&(l=0),!!_e(e)){for(var d=Qt(e).concat(e),p=mr.resolve(),g=function(e){p=p.then(function(){return new mr(function(t){var r=d[e],i=d[e+1],s=r.scrollTop,c=n(Tt(i,Jt(r)).top-l),p=a(u(c)),g=Date.now(),m=function(){var e=o(J((Date.now()-g)/p));Xt(r,s+c*e),1===e?t():requestAnimationFrame(m)};m()})})},m=0;m<d.length-1;m++)g(m);return p}}function Kt(e,t){if(void 0===t&&(t=0),!_e(e))return 0;var a=W($t(e)),o=a.scrollHeight,r=a.scrollTop,i=Jt(a),n=wt(i).height,l=At(e)[0]-r-At(a)[0],s=d(n,l+r),c=d(wt(e).height+t+s,o-(l+r),o-n);return J(-1*(l-s)/c)}function $t(e,t){void 0===t&&(t=/auto|scroll/);var a=ea(e),o=ke(e).filter(function(e){return e===a||t.test(gt(e,"overflow"))&&e.scrollHeight>l(wt(e).height)}).reverse();return o.length?o:[a]}function Jt(e){return e===ea(e)?window:e}function Qt(e){return $t(e,/auto|scroll|hidden/)}function ea(e){var t=U(e),a=t.document;return a.scrollingElement||a.documentElement}function ta(e){return!!(f(e,"uk-")||f(e,"data-uk-"))&&i(e.replace("data-uk-","").replace("uk-",""))}function aa(e,t,a,o){return u(e-a)>=u(t-o)?0<e-a?"Left":"Right":0<t-o?"Up":"Down"}function oa(e){function t(e,t){var r=e.target,i=e.type,n="attributes"===i?a(e):o(e);n&&!t.some(function(e){return e.contains(r)})&&t.push(r.contains?r:r.parentNode)}function a(t){var a=t.target,o=t.attributeName;if("href"===o)return!0;var r=ta(o);if(r&&r in e){if(oe(a,o))return e[r](a),!0;var i=e.getComponent(a,r);if(i)return i.$destroy(),!0}}function o(e){for(var t=e.addedNodes,a=e.removedNodes,o=0;o<t.length;o++)at(t[o],r);for(var n=0;n<a.length;n++)at(a[n],i);return!0}var r=e.connect,i=e.disconnect;"MutationObserver"in window&&Dr.read(function(){document.body&&at(document.body,r),new MutationObserver(function(a){var o=[];a.forEach(function(e){return t(e,o)}),o.forEach(function(t){return e.update(t)})}).observe(document,{childList:!0,subtree:!0,characterData:!0,attributes:!0}),e._initialized=!0})}function ra(e){var t=e.isToggled,a=e.duration,o=e.initProps,r=e.hideProps,i=e.transition,n=e._toggle;return function(e,s){var d=Cr.inProgress(e),c=e.hasChildNodes?F(gt(e.firstElementChild,"marginTop"))+F(gt(e.lastElementChild,"marginBottom")):0,p=_e(e)?Pr(e)+(d?0:c):0;Cr.cancel(e),t(e)||n(e,!0),Pr(e,""),Dr.flush();var u=Pr(e)+(d?0:c);return Pr(e,p),(s?Cr.start(e,Yo({},o,{overflow:"hidden",height:u}),l(a*(1-p/u)),i):Cr.start(e,r,l(a*(p/u)),i).then(function(){return n(e,!1)})).then(function(){return gt(e,o)})}}function ia(e){return function(t,a){Er.cancel(t);var o=e.animation,r=e.duration,i=e._toggle;return a?(i(t,!0),Er.in(t,o[0],r,e.origin)):Er.out(t,o[1]||o[0],r,e.origin).then(function(){return i(t,!1)})}}function na(e,t){ae(e,"hidden",t?"":null)}function la(e){for(;e=ye(e);)if("static"!==gt(e,"position"))return e}function sa(e){var t=[];return at(e,function(e){return"static"!==gt(e,"position")&&t.push(e)}),t}function da(e){for(var t=[[]],a=0,o;a<e.length;a++)if(o=e[a],!!_e(o))for(var r=ca(o),n=t.length-1,l;0<=n;n--){if(l=t[n],!l[0]){l.push(o);break}var s=void 0;if(l[0].offsetParent===o.offsetParent?s=ca(l[0]):(r=ca(o,!0),s=ca(l[0],!0)),r.top>=s.bottom-1&&r.top!==s.top){t.push([o]);break}if(r.bottom>s.top||r.top===s.top){if(r.left<s.left&&!Zo){l.unshift(o);break}l.push(o);break}if(0==n){t.unshift([o]);break}}return t}function ca(e,t){var a;void 0===t&&(t=!1);var o=e.offsetTop,r=e.offsetLeft,i=e.offsetHeight;return t&&(a=At(e),o=a[0],r=a[1]),{top:o,left:r,height:i,bottom:o+i}}function pa(e,t,a){for(var o=0,r=0,n=0,l=t.length-1;0<=l;l--)for(var s=o;s<t[l].length;s++){var d=t[l][s],c=d.offsetTop+Pr(d)+(a&&-a[l][s]);r=g(r,c),n=g(n,c+(s%2?e:e/8)),o++}return n-r}function ua(e,t){var a=Te(e),o=a.filter(function(e){return dt(e,t)}),r=o[0];return F(r?gt(r,"marginTop"):gt(a[0],"paddingLeft"))}function ga(e){return g.apply(Math,e.reduce(function(e,t){return t.forEach(function(t,a){return e[a]=(e[a]||0)+t.offsetHeight}),e},[]))}function ma(e){var t;if(2>e.length)return{heights:[""],elements:e};var a=ha(e),o=a.heights,r=a.max,i=e.some(function(e){return e.style.minHeight}),n=e.some(function(e,t){return!e.style.minHeight&&o[t]<r});return i&&n&&(gt(e,"minHeight",""),t=ha(e),o=t.heights,r=t.max),o=e.map(function(e,t){return o[t]===r&&F(e.style.minHeight).toFixed(2)!==r.toFixed(2)?"":r}),{heights:o,elements:e}}function ha(e){var t=e.map(function(e){return wt(e).height-Ct(e,"height","content-box")}),a=g.apply(null,t);return{heights:t,max:a}}function ya(e){return e&&wt(e).height||0}function fa(e){return ti[e]?ti[e]:ti[e]=new mr(function(t,a){return e?void(f(e,"data:")?t(decodeURIComponent(e.split(",")[1])):Ne(e).then(function(e){return t(e.response)},function(){return a("SVG not found.")})):void a()})}function xa(e,t){return t&&b(e,"<symbol")&&(e=_a(e,t)||e),e=ot(e.substr(e.indexOf("<svg"))),e&&e.hasChildNodes()&&e}function _a(e,t){if(!oi[e]){oi[e]={},ai.lastIndex=0;for(var a;a=ai.exec(e);)oi[e][a[3]]="<svg xmlns=\"http://www.w3.org/2000/svg\""+a[1]+"svg>"}return oi[e][t]}function ba(e){var t=va(e);t&&e.style.setProperty("--uk-animation-stroke",t)}function va(e){return n(g.apply(Math,[0].concat($("[stroke]",e).map(function(e){try{return e.getTotalLength()}catch(t){return 0}}))))}function wa(e,t){if(xe(t)||"CANVAS"===t.tagName){ae(t,"hidden",!0);var a=t.nextElementSibling;return ka(e,a)?a:Ze(t,e)}var o=t.lastElementChild;return ka(e,o)?o:We(t,e)}function ka(e,t){return ae(e,"data-svg")===ae(t,"data-svg")}function Ta(e){return ri[e]?(si[e]||(si[e]=ot((ri[Aa(e)]||ri[e]).trim())),si[e].cloneNode(!0)):null}function Aa(e){return Zo?Y(Y(e,"left","right"),"previous","next"):e}function Sa(e,t,a,o){if(Pa(e))o&&(e.sizes=o),a&&(e.srcset=a),t&&(e.src=t);else if(t){var r=!b(e.style.backgroundImage,t);r&&(gt(e,"backgroundImage","url("+fe(t)+")"),Ce(e,Le("load",!1)))}}function Ca(e,t,a){var o;return a&&(o=Wo.ratio({width:e,height:t},"width",zt(La(a))),e=o.width,t=o.height),"data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\""+e+"\" height=\""+t+"\"></svg>"}function La(e){var t;for(ci.lastIndex=0;t=ci.exec(e);)if(!t[1]||window.matchMedia(t[1]).matches){t=Ea(t[2]);break}return t||"100vw"}function Ea(e){return f(e,"calc")?e.substring(5,e.length-1).replace(pi,function(e){return zt(e)}).replace(/ /g,"").match(ui).reduce(function(e,t){return e+ +t},0):e}function Ia(e,t){var a=zt(La(t)),o=(e.match(gi)||[]).map(F).sort(function(e,t){return e-t});return o.filter(function(e){return e>=a})[0]||o.pop()||""}function Pa(e){return"IMG"===e.tagName}function za(e){return e.currentSrc||e.src}function Da(e){if(z(e))if("@"===e[0]){var t="breakpoint-"+e.substr(1);e=F(yt(t))}else if(isNaN(e))return e;return e&&!isNaN(e)&&"(min-width: "+e+"px)"}function Oa(e){var t=e.transitionElement,a=e._toggle;return function(e,o){return new mr(function(r,i){return Se(e,"show hide",function(){e._reject&&e._reject(),e._reject=i,a(e,o);var n=Se(t,"transitionstart",function(){Se(t,"transitionend transitioncancel",r,{self:!0}),clearTimeout(l)},{self:!0}),l=setTimeout(function(){n(),r()},q(gt(t,"transitionDuration")))})})}}function Ra(){ja().content+=",user-scalable=0"}function Ma(){var e=ja();e.content=e.content.replace(/,user-scalable=0$/,"")}function ja(){return ot("meta[name=\"viewport\"]",document.head)||We(document.head,"<meta name=\"viewport\">")}function Ba(e,t){var a=t.$props,o=t.$el,r=t[e+"Offset"],i=a[e];return i?z(i)&&i.match(/^-?\d/)?r+zt(i):wt(!0===i?o.parentNode:ne(i,o)).bottom:void 0}function Fa(e){var t=e-Date.now();return{total:t,seconds:t/1e3%60,minutes:t/1e3/60%60,hours:t/1e3/60/60%24,days:t/1e3/60/60/24}}function Na(e,t){var a=gt(e,"zIndex");return!!_e(e)&&Yo({display:"",opacity:t?gt(e,"opacity"):"0",pointerEvents:"none",position:"absolute",zIndex:"auto"===a?He(e):a},Ua(e))}function Va(e){gt(e.children,{height:"",left:"",opacity:"",pointerEvents:"",position:"",top:"",width:""}),nt(e,"uk-animation-target"),gt(e,{height:"",display:""})}function Ua(e){var t=wt(e),a=t.height,o=t.width,r=Tt(e),i=r.top,n=r.left;return{top:i,left:n,height:a,width:o}}function Ha(){rn||(rn=We(document.head,"<style>").sheet,rn.insertRule(".uk-animation-target > * {\n            margin-top: 0 !important;\n            transform: none !important;\n        }",0))}function qa(e,t){return qt(ie(e,t),["filter"])}function Ga(e,t,a){var o=qa(e,t),r=o.filter,i=o.group,n=o.sort,l=o.order;return void 0===l&&(l="asc"),(r||M(n))&&(i?r?(delete a.filter[""],a.filter[i]=r):(delete a.filter[i],(R(a.filter)||""in a.filter)&&(a.filter={"":r||""})):a.filter={"":r||""}),M(n)||(a.sort=[n,l]),a}function Ya(e,t,a){var o=a.filter;void 0===o&&(o={"":""});var r=a.sort,i=r[0],n=r[1],l=qa(e,t),s=l.filter;void 0===s&&(s="");var d=l.group;void 0===d&&(d="");var c=l.sort,p=l.order;return void 0===p&&(p="asc"),M(c)?d in o&&s===o[d]||!s&&d&&!(d in o)&&!o[""]:i===c&&n===p}function Wa(e,t){return e.length===t.length&&e.every(function(e){return~t.indexOf(e)})}function Xa(e){var t=e.filter,a="";return X(t,function(e){return a+=e||""}),a}function Za(e,t,o){return Yo([],e).sort(function(e,a){return ie(e,t).localeCompare(ie(a,t),void 0,{numeric:!0})*("asc"===o||-1)})}function Ka(e){return u(gt(e,"transform").split(",")[4]/e.offsetWidth)||0}function $a(e,t){return void 0===e&&(e=0),void 0===t&&(t="%"),e+=e?t:"",Xo?"translateX("+e+")":"translate3d("+e+", 0, 0)"}function Ja(e){return"scale3d("+e+", "+e+", 1)"}function Qa(e,t,a){Ce(e,Le(t,!1,!1,a))}function eo(e){return!e.children.length&&e.childNodes.length}function to(e,t){return"next"===e?1:"previous"===e?-1:e<t?-1:1}function ao(e){return .5*e+300}function oo(e,t){var a=tt("<"+e+">");return ae(a,t),a}function ro(e){var t={};return["href","caption","type","poster","alt","attrs"].forEach(function(a){t["href"===a?"source":a]=ie(e,a)}),t.attrs=qt(t.attrs),t}function io(e,t){return gt(gt(e,"color",t),"color").split(/[(),]/g).slice(1,-1).concat(1).slice(0,4).map(F)}function no(e,t){var a=e.length-1,o=d(m(a*t),a-1),r=e.slice(o,o+2);return r.push(1===t?1:t%(1/a)*a),r}function lo(e,t,a){void 0===a&&(a=2);var o=no(e,t),r=o[0],i=o[1],n=o[2];return(D(r)?r+u(r-i)*n*(r<i?1:-1):+i).toFixed(a)}function so(e){return e.reduce(function(e,t){return z(t)&&t.replace(/-|\d/g,"").trim()||e},"")}function co(e){var t=e.style,a=t.backgroundSize,o="cover"===gt(gt(e,"backgroundSize",""),"backgroundSize");return e.style.backgroundSize=a,o}function po(e,t){return J(e*(1-(t-t*e)))}function uo(e){return e?"offsetTop"in e?e:uo(e.parentNode):document.body}function go(e,t,a){var o=xo(e,t);return a?o-fo(e,t):d(o,mo(t))}function mo(e){return g(0,ho(e)-wt(e).width)}function ho(e){return bo(e).reduce(function(e,t){return wt(t).width+e},0)}function yo(e){return bo(e).reduce(function(e,t){return g(e,wt(t).width)},0)}function fo(e,t){return wt(t).width/2-wt(e).width/2}function xo(e,t){return(Tt(e).left+(Zo?wt(e).width-wt(t).width:0))*(Zo?-1:1)}function _o(e,t,a){Ce(e,Le(t,!1,!1,a))}function bo(e){return Te(e)}function vo(e){return _(e,"in")}function wo(e,t,a){return a/=2,vo(e)?0>t?1-a:a:0>t?a:1-a}function ko(e,t){return e.parentNode===t.parentNode&&He(e)>He(t)}function To(e){var t=Date.now();ln=setInterval(function(){var a=e.x,o=e.y;o+=window.pageYOffset;var r=.3*(Date.now()-t);t=Date.now(),$t(document.elementFromPoint(a,e.y)).some(function(e){var t=e.scrollTop,a=e.scrollHeight,i=wt(Jt(e)),n=i.top,l=i.bottom,s=i.height;if(n<o&&n+30>o)t-=r;else if(l>o&&l-30<o)t+=r;else return;return 0<t&&t<a-s?(Xt(e,t),!0):void 0})},15)}function Ao(){clearInterval(ln)}function So(e,t){var a=We(e,t.outerHTML.replace(/(^<)(?:li|tr)|(?:li|tr)(\/>$)/g,"$1div$2"));return ae(a,"style",ae(a,"style")+";margin:0!important"),gt(a,Yo({boxSizing:"border-box",width:t.offsetWidth,height:t.offsetHeight,overflow:"hidden"},gt(t,["paddingLeft","paddingRight","paddingTop","paddingBottom"]))),Pr(a.firstElementChild,Pr(t.firstElementChild)),a}function Co(e,t){return t.match(new RegExp("^"+e.replace(/\//g,"\\/").replace(/\*\*/g,"(\\/[^\\/]+)*").replace(/\*/g,"[^\\/]+").replace(/((?!\\))\?/g,"$1.")+"$","i"))}function Lo(e,t){for(var a=[],o=0,r;o<e.length;o+=t){r=[];for(var n=0;n<t;n++)r.push(e[o+n]);a.push(r)}return a}function Eo(t){t.preventDefault(),t.stopPropagation()}function Io(e,t){Fr.component(t,e)}var Po=Object.prototype,zo=Po.hasOwnProperty,Do={},Oo=/([a-z\d])([A-Z])/g,Ro=/-(\w)/g,Mo=o,jo=Mo.startsWith||function(e){return 0===this.lastIndexOf(e,0)},Bo=Mo.endsWith||function(e){return this.substr(-e.length)===e},Fo=Array.prototype,No=function(e,t){return!!~this.indexOf(e,t)},Vo=Mo.includes||No,Uo=Fo.includes||No,Ho=Fo.findIndex||function(e){for(var t=arguments,a=0;a<this.length;a++)if(e.call(t[1],this[a],a,this))return a;return-1},qo=Array.isArray,Go=Po.toString,Yo=Object.assign||function(e){for(var a=[],o=arguments.length-1;0<o--;)a[o]=arguments[o+1];e=Object(e);for(var r=0,n;r<a.length;r++)if(n=a[r],null!==n)for(var l in n)t(n,l)&&(e[l]=n[l]);return e},Wo={ratio:function(e,t,a){var o="width"===t?"height":"width",r;return r={},r[o]=e[t]?l(a*e[o]/e[t]):e[o],r[t]=a,r},contain:function(e,t){var a=this;return e=Yo({},e),X(e,function(o,r){return e=e[r]>t[r]?a.ratio(e,r,t[r]):e}),e},cover:function(e,t){var a=this;return e=this.contain(e,t),X(e,function(o,r){return e=e[r]<t[r]?a.ratio(e,r,t[r]):e}),e}},Xo=/msie|trident/i.test(window.navigator.userAgent),Zo="rtl"===ae(document.documentElement,"dir"),Ko=("ontouchstart"in window),$o=window.PointerEvent,Jo=Ko||window.DocumentTouch&&document instanceof DocumentTouch||navigator.maxTouchPoints,Qo=$o?"pointerdown":Ko?"touchstart":"mousedown",er=$o?"pointermove":Ko?"touchmove":"mousemove",tr=$o?"pointerup":Ko?"touchend":"mouseup",ar=$o?"pointerenter":Ko?"":"mouseenter",or=$o?"pointerleave":Ko?"":"mouseleave",rr=$o?"pointercancel":"touchcancel",ir=/(^|[^\\],)\s*[!>+~-]/,nr=/([!>+~-])(?=\s+[!>+~-]|\s*$)/g,lr=/.*?[^\\](?:,|$)/g,sr=Element.prototype,dr=sr.matches||sr.webkitMatchesSelector||sr.msMatchesSelector,cr=sr.closest||function(e){var t=this;do if(me(t,e))return t;while(t=ye(t))},pr=window.CSS&&CSS.escape||function(e){return e.replace(/([^\x7f-\uFFFF\w-])/g,function(e){return"\\"+e})},ur={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,menuitem:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},gr="input,select,textarea,button",mr="Promise"in window?window.Promise:Fe,hr=function(){var e=this;this.promise=new mr(function(t,a){e.reject=a,e.resolve=t})},yr=0,fr=1,xr=2,_r="setImmediate"in window?e:setTimeout;Fe.reject=function(e){return new Fe(function(t,a){a(e)})},Fe.resolve=function(e){return new Fe(function(t){t(e)})},Fe.all=function(e){return new Fe(function(t,a){function o(a){return function(o){r[a]=o,n+=1,n===e.length&&t(r)}}var r=[],n=0;0===e.length&&t(r);for(var l=0;l<e.length;l+=1)Fe.resolve(e[l]).then(o(l),a)})},Fe.race=function(e){return new Fe(function(t,a){for(var o=0;o<e.length;o+=1)Fe.resolve(e[o]).then(t,a)})};var br=Fe.prototype;br.resolve=function(e){var t=this;if(t.state===xr){if(e===t)throw new TypeError("Promise settled with itself.");var a=!1;try{var o=e&&e.then;if(null!==e&&k(e)&&w(o))return void o.call(e,function(e){a||t.resolve(e),a=!0},function(e){a||t.reject(e),a=!0})}catch(o){return void(a||t.reject(o))}t.state=yr,t.value=e,t.notify()}},br.reject=function(e){var t=this;if(t.state===xr){if(e===t)throw new TypeError("Promise settled with itself.");t.state=fr,t.value=e,t.notify()}},br.notify=function(){var e=this;_r(function(){if(e.state!==xr)for(;e.deferred.length;){var t=e.deferred.shift(),a=t[0],o=t[1],r=t[2],i=t[3];try{e.state===yr?w(a)?r(a.call(void 0,e.value)):r(e.value):e.state===fr&&(w(o)?r(o.call(void 0,e.value)):i(e.value))}catch(t){i(t)}}})},br.then=function(e,t){var a=this;return new Fe(function(o,r){a.deferred.push([e,t,o,r]),a.notify()})},br.catch=function(e){return this.then(void 0,e)};var p=/^\s*<(\w+|!)[^>]*>/,vr=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,wr={get Multiple(){return this.get("_multiple")},get Force(){return this.get("_force")},get:function(e){if(!t(this,e)){var a=document.createElement("_"),o=a.classList;o.add("a","b"),o.toggle("c",!1),this._multiple=o.contains("b"),this._force=!o.contains("c")}return this[e]}},kr={"animation-iteration-count":!0,"column-count":!0,"fill-opacity":!0,"flex-grow":!0,"flex-shrink":!0,"font-weight":!0,"line-height":!0,opacity:!0,order:!0,orphans:!0,"stroke-dasharray":!0,"stroke-dashoffset":!0,widows:!0,"z-index":!0,zoom:!0},Tr={},Ar={},Sr=["webkit","moz","ms"],Cr={start:_t,stop:function(e){return Ce(e,"transitionend"),mr.resolve()},cancel:function(e){Ce(e,"transitioncanceled")},inProgress:function(e){return dt(e,"uk-transition")}},Lr=new RegExp("uk-animation-"+"(enter|leave)"),Er={in:function(e,t,a,o){return bt(e,t,a,o,!1)},out:function(e,t,a,o){return bt(e,t,a,o,!0)},inProgress:function(e){return Lr.test(ae(e,"class"))},cancel:function(e){Ce(e,"animationcancel")}},Ir={width:["x","left","right"],height:["y","top","bottom"]},Pr=St("height"),zr=St("width"),Dr={reads:[],writes:[],read:function(e){return this.reads.push(e),Rt(),e},write:function(e){return this.writes.push(e),Rt(),e},clear:function(e){return jt(this.reads,e)||jt(this.writes,e)},flush:Ot};Bt.prototype={positions:[],init:function(){var e=this;this.positions=[];var t;this.unbind=Ae(document,"mousemove",function(a){return t=Be(a)}),this.interval=setInterval(function(){t&&(e.positions.push(t),5<e.positions.length&&e.positions.shift())},50)},cancel:function(){this.unbind&&this.unbind(),this.interval&&clearInterval(this.interval)},movesTo:function(e){if(2>this.positions.length)return!1;var t=e.getBoundingClientRect(),a=t.left,o=t.right,r=t.top,i=t.bottom,n=this.positions,l=n[0],s=W(this.positions),d=[l,s];if(te(s,t))return!1;return[[{x:a,y:r},{x:o,y:i}],[{x:a,y:i},{x:o,y:r}]].some(function(e){var a=Ft(d,e);return a&&te(a,t)})}};var Or={};Or.events=Or.created=Or.beforeConnect=Or.connected=Or.beforeDisconnect=Or.disconnected=Or.destroy=Vt,Or.args=function(e,t){return!1!==t&&Vt(t||e)},Or.update=function(e,t){return Z(Vt(e,w(t)?{read:t}:t),"order")},Or.props=function(e,t){return qo(t)&&(t=t.reduce(function(e,t){return e[t]=String,e},{})),Or.methods(e,t)},Or.computed=Or.methods=function(e,t){return t?e?Yo({},e,t):t:e},Or.data=function(e,t,a){return a?Nt(e,t,a):t?e?function(a){return Nt(e,t,a)}:t:e};var Rr=0,Mr=function(e){this.id=++Rr,this.el=N(e)};Mr.prototype.isVideo=function(){return this.isYoutube()||this.isVimeo()||this.isHTML5()},Mr.prototype.isHTML5=function(){return"VIDEO"===this.el.tagName},Mr.prototype.isIFrame=function(){return"IFRAME"===this.el.tagName},Mr.prototype.isYoutube=function(){return this.isIFrame()&&!!this.el.src.match(/\/\/.*?youtube(-nocookie)?\.[a-z]+\/(watch\?v=[^&\s]+|embed)|youtu\.be\/.*/)},Mr.prototype.isVimeo=function(){return this.isIFrame()&&!!this.el.src.match(/vimeo\.com\/video\/.*/)},Mr.prototype.enableApi=function(){var e=this;if(this.ready)return this.ready;var t=this.isYoutube(),a=this.isVimeo(),o;return t||a?this.ready=new mr(function(r){Se(e.el,"load",function(){if(t){var a=function(){return Gt(e.el,{event:"listening",id:e.id})};o=setInterval(a,100),a()}}),Yt(function(o){return t&&o.id===e.id&&"onReady"===o.event||a&&+o.player_id===e.id}).then(function(){r(),o&&clearInterval(o)}),ae(e.el,"src",""+e.el.src+(b(e.el.src,"?")?"&":"?")+(t?"enablejsapi=1":"api=1&player_id="+e.id))}):mr.resolve()},Mr.prototype.play=function(){var e=this;if(this.isVideo())if(this.isIFrame())this.enableApi().then(function(){return Gt(e.el,{func:"playVideo",method:"play"})});else if(this.isHTML5())try{var t=this.el.play();t&&t.catch(Q)}catch(t){}},Mr.prototype.pause=function(){var e=this;this.isVideo()&&(this.isIFrame()?this.enableApi().then(function(){return Gt(e.el,{func:"pauseVideo",method:"pause"})}):this.isHTML5()&&this.el.pause())},Mr.prototype.mute=function(){var e=this;this.isVideo()&&(this.isIFrame()?this.enableApi().then(function(){return Gt(e.el,{func:"mute",method:"setVolume",value:0})}):this.isHTML5()&&(this.el.muted=!0,ae(this.el,"muted","")))};var jr="IntersectionObserver"in window?window.IntersectionObserver:function(){function e(e,t){var a=this;void 0===t&&(t={});var o=t.rootMargin;void 0===o&&(o="0 0"),this.targets=[];var r=(o||"0 0").split(" ").map(F),i=r[0],n=r[1];this.offsetTop=i,this.offsetLeft=n;var l;this.apply=function(){l||(l=requestAnimationFrame(function(){return setTimeout(function(){var t=a.takeRecords();t.length&&e(t,a),l=!1})}))},this.off=Ae(window,"scroll resize load",this.apply,{passive:!0,capture:!0})}return e.prototype.takeRecords=function(){var e=this;return this.targets.filter(function(t){var a=Wt(t.target,e.offsetTop,e.offsetLeft);if(null===t.isIntersecting||a^t.isIntersecting)return t.isIntersecting=a,!0})},e.prototype.observe=function(e){this.targets.push({target:e,isIntersecting:null}),this.apply()},e.prototype.disconnect=function(){this.targets=[],this.off()},e}(),Br=Object.freeze({__proto__:null,ajax:Ne,getImage:Ve,transition:_t,Transition:Cr,animate:bt,Animation:Er,attr:ae,hasAttr:oe,removeAttr:re,data:ie,addClass:it,removeClass:nt,removeClasses:lt,replaceClass:st,hasClass:dt,toggleClass:ct,positionAt:vt,offset:wt,position:Tt,offsetPosition:At,height:Pr,width:zr,boxModelAdjust:Ct,flipPosition:Pt,toPx:zt,ready:Ue,index:He,getIndex:qe,empty:Ge,html:Ye,prepend:function(e,t){return e=ot(e),e.hasChildNodes()?Ke(t,function(t){return e.insertBefore(t,e.firstChild)}):We(e,t)},append:We,before:Xe,after:Ze,remove:$e,wrapAll:Je,wrapInner:Qe,unwrap:et,fragment:tt,apply:at,$:ot,$$:$,isIE:Xo,isRtl:Zo,hasTouch:Jo,pointerDown:Qo,pointerMove:er,pointerUp:tr,pointerEnter:ar,pointerLeave:or,pointerCancel:rr,on:Ae,off:x,once:Se,trigger:Ce,createEvent:Le,toEventTargets:Me,isTouch:je,getEventPos:Be,fastdom:Dr,isVoidElement:xe,isVisible:_e,selInput:gr,isInput:be,filter:ve,within:we,parents:ke,children:Te,hasOwn:t,hyphenate:a,camelize:i,ucfirst:y,startsWith:f,endsWith:_,includes:b,findIndex:v,isArray:qo,isFunction:w,isObject:k,isPlainObject:T,isWindow:A,isDocument:S,isJQuery:C,isNode:L,isElement:E,isNodeCollection:I,isBoolean:P,isString:z,isNumber:D,isNumeric:O,isEmpty:R,isUndefined:M,toBoolean:j,toNumber:B,toFloat:F,toNode:N,toNodes:V,toWindow:U,toList:H,toMs:q,isEqual:G,swap:Y,assign:Yo,last:W,each:X,sortBy:Z,uniqueBy:K,clamp:J,noop:Q,intersectRect:ee,pointInRect:te,Dimensions:Wo,MouseTracker:Bt,mergeOptions:Ht,parseOptions:qt,Player:Mr,Promise:mr,Deferred:hr,IntersectionObserver:jr,query:ne,queryAll:le,find:de,findAll:ce,matches:me,closest:he,parent:ye,escape:fe,css:gt,getStyles:mt,getStyle:ht,getCssVar:yt,propName:ft,isInView:Wt,scrollTop:Xt,scrollIntoView:Zt,scrolledOver:Kt,scrollParents:$t,getViewport:Jt}),Fr=function(e){this._init(e)};Fr.util=Br,Fr.data="__uikit__",Fr.prefix="uk-",Fr.options={},Fr.version="3.4.2",function(e){function t(t,a){if(t)for(var e in t)t[e]._connected&&t[e]._callUpdate(a)}var a=e.data;e.use=function(e){if(!e.installed)return e.call(null,this),e.installed=!0,this},e.mixin=function(t,a){a=(z(a)?e.component(a):a)||this,a.options=Ht(a.options,t)},e.extend=function(e){e=e||{};var t=this,a=function(e){this._init(e)};return a.prototype=Object.create(t.prototype),a.prototype.constructor=a,a.options=Ht(t.options,e),a.super=t,a.extend=t.extend,a},e.update=function(o,r){o=o?N(o):document.body,ke(o).reverse().forEach(function(e){return t(e[a],r)}),at(o,function(e){return t(e[a],r)})};var o;Object.defineProperty(e,"container",{get:function(){return o||document.body},set:function(e){o=ot(e)}})}(Fr),function(e){e.prototype._callHook=function(e){var t=this,a=this.$options[e];a&&a.forEach(function(e){return e.call(t)})},e.prototype._callConnected=function(){this._connected||(this._data={},this._computeds={},this._frames={reads:{},writes:{}},this._initProps(),this._callHook("beforeConnect"),this._connected=!0,this._initEvents(),this._initObserver(),this._callHook("connected"),this._callUpdate())},e.prototype._callDisconnected=function(){this._connected&&(this._callHook("beforeDisconnect"),this._observer&&(this._observer.disconnect(),this._observer=null),this._unbindEvents(),this._callHook("disconnected"),this._connected=!1)},e.prototype._callUpdate=function(t){var a=this;void 0===t&&(t="update");var o=t.type||t;b(["update","resize"],o)&&this._callWatches();var r=this.$options.update,i=this._frames,n=i.reads,l=i.writes;r&&r.forEach(function(e,t){var r=e.read,i=e.write,s=e.events;("update"===o||b(s,o))&&(r&&!b(Dr.reads,n[t])&&(n[t]=Dr.read(function(){var e=a._connected&&r.call(a,a._data,o);!1===e&&i?Dr.clear(l[t]):T(e)&&Yo(a._data,e)})),i&&!b(Dr.writes,l[t])&&(l[t]=Dr.write(function(){return a._connected&&i.call(a,a._data,o)})))})},e.prototype._callWatches=function(){var e=this,a=this,o=a._frames;if(!o.watch){var r=!t(o,"watch");o.watch=Dr.read(function(){if(e._connected){var a=e,i=a.$options.computed,n=a._computeds;for(var l in i){var s=t(n,l),d=n[l];delete n[l];var c=i[l],p=c.watch,u=c.immediate;p&&(r&&u||s&&!G(d,e[l]))&&p.call(e,e[l],d)}o.watch=null}})}}}(Fr),function(e){function o(e,t){var o={},r=e.args;void 0===r&&(r=[]);var n=e.props;void 0===n&&(n={});var l=e.el;if(!n)return o;for(var d in n){var c=a(d),p=ie(l,c);if(!M(p)){if(p=n[d]===Boolean&&""===p||s(n[d],p),"target"===c&&(!p||f(p,"_")))continue;o[d]=p}}var u=qt(ie(l,t),r);for(var g in u){var m=i(g);void 0!==n[m]&&(o[m]=s(n[m],u[g]))}return o}function r(e,a,o){Object.defineProperty(e,a,{enumerable:!0,get:function(){var r=e._computeds,i=e.$props,n=e.$el;return t(r,a)||(r[a]=(o.get||o).call(e,i,n)),r[a]},set:function(t){var r=e._computeds;r[a]=o.set?o.set.call(e,t):t,M(r[a])&&delete r[a]}})}function n(e,t,a){T(t)||(t={name:a,handler:t});var o=t.name,r=t.el,i=t.handler,l=t.capture,s=t.passive,d=t.delegate,c=t.filter,p=t.self;return r=w(r)?r.call(e):r||e.$el,qo(r)?void r.forEach(function(o){return n(e,Yo({},t,{el:o}),a)}):void(!r||c&&!c.call(e)||e._events.push(Ae(r,o,d?z(d)?d:d.call(e):null,z(i)?e[i]:i.bind(e),{passive:s,capture:l,self:p})))}function l(e,a){return e.every(function(e){return!e||!t(e,a)})}function s(e,t){return e===Boolean?j(t):e===Number?B(t):"list"===e?H(t):e?e(t):t}function d(e,t){var a=e.data,o=e.el,r=t.args,i=t.props;if(void 0===i&&(i={}),a=qo(a)?R(r)?void 0:a.slice(0,r.length).reduce(function(e,t,a){return T(t)?Yo(e,t):e[r[a]]=t,e},{}):a,a)for(var n in a)M(a[n])?delete a[n]:a[n]=i[n]?s(i[n],a[n]):a[n];return a}var c=0;e.prototype._init=function(e){e=e||{},e.data=d(e,this.constructor.options),this.$options=Ht(this.constructor.options,e,this),this.$el=null,this.$props={},this._uid=c++,this._initData(),this._initMethods(),this._initComputeds(),this._callHook("created"),e.el&&this.$mount(e.el)},e.prototype._initData=function(){var e=this.$options,t=e.data;for(var a in void 0===t&&(t={}),t)this.$props[a]=this[a]=t[a]},e.prototype._initMethods=function(){var e=this.$options,t=e.methods;if(t)for(var a in t)this[a]=t[a].bind(this)},e.prototype._initComputeds=function(){var e=this.$options,t=e.computed;if(this._computeds={},t)for(var a in t)r(this,a,t[a])},e.prototype._initProps=function(e){for(var t in e=e||o(this.$options,this.$name),e)M(e[t])||(this.$props[t]=e[t]);var a=[this.$options.computed,this.$options.methods];for(t in this.$props)t in e&&l(a,t)&&(this[t]=this.$props[t])},e.prototype._initEvents=function(){var e=this;this._events=[];var a=this.$options,o=a.events;o&&o.forEach(function(a){if(!t(a,"handler"))for(var o in a)n(e,a[o],o);else n(e,a)})},e.prototype._unbindEvents=function(){this._events.forEach(function(e){return e()}),delete this._events},e.prototype._initObserver=function(){var e=this,t=this.$options,r=t.attrs,i=t.props,n=t.el;if(!this._observer&&i&&!1!==r){r=qo(r)?r:Object.keys(i),this._observer=new MutationObserver(function(){var t=o(e.$options,e.$name);r.some(function(a){return!M(t[a])&&t[a]!==e.$props[a]})&&e.$reset()});var l=r.map(function(e){return a(e)}).concat(this.$name);this._observer.observe(n,{attributes:!0,attributeFilter:l.concat(l.map(function(e){return"data-"+e}))})}}}(Fr),function(e){var t=e.data,o={};e.component=function(t,r){var n=a(t);if(t=i(n),!r)return T(o[t])&&(o[t]=e.extend(o[t])),o[t];e[t]=function(a,o){function r(a){var r=e.getComponent(a,t);if(r){if(!o)return r;r.$destroy()}return new s({el:a,data:o})}for(var n=arguments.length,l=Array(n);n--;)l[n]=arguments[n];var s=e.component(t);return s.options.functional?new s({data:T(a)?a:[].concat(l)}):a?$(a).map(r)[0]:r(a)};var l=T(r)?Yo({},r):r.options;return l.name=t,l.install&&l.install(e,l,t),e._initialized&&!l.functional&&Dr.read(function(){return e[t]("[uk-"+n+"],[data-uk-"+n+"]")}),o[t]=T(r)?l:r},e.getComponents=function(e){return e&&e[t]||{}},e.getComponent=function(t,a){return e.getComponents(t)[a]},e.connect=function(a){if(a[t])for(var r in a[t])a[t][r]._callConnected();for(var n=0,l;n<a.attributes.length;n++)l=ta(a.attributes[n].name),l&&l in o&&e[l](a)},e.disconnect=function(e){for(var a in e[t])e[t][a]._callDisconnected()}}(Fr),function(t){var o=t.data;t.prototype.$create=function(e,a,o){return t[e](a,o)},t.prototype.$mount=function(e){var t=this.$options,a=t.name;e[o]||(e[o]={}),e[o][a]||(e[o][a]=this,this.$el=this.$options.el=this.$options.el||e,we(e,document)&&this._callConnected())},t.prototype.$reset=function(){this._callDisconnected(),this._callConnected()},t.prototype.$destroy=function(e){void 0===e&&(e=!1);var t=this.$options,a=t.el,r=t.name;a&&this._callDisconnected(),this._callHook("destroy"),a&&a[o]&&(delete a[o][r],!R(a[o])&&delete a[o],e&&$e(this.$el))},t.prototype.$emit=function(t){this._callUpdate(t)},t.prototype.$update=function(a,o){void 0===a&&(a=this.$el),t.update(a,o)},t.prototype.$getComponent=t.getComponent;var r={};Object.defineProperties(t.prototype,{$container:Object.getOwnPropertyDescriptor(t,"container"),$name:{get:function(){var e=this.$options,o=e.name;return r[o]||(r[o]=t.prefix+a(o)),r[o]}}})}(Fr);var Nr={connected:function(){dt(this.$el,this.$name)||it(this.$el,this.$name)}},Vr={props:{cls:Boolean,animation:"list",duration:Number,origin:String,transition:String,queued:Boolean},data:{cls:!1,animation:[!1],duration:200,origin:!1,transition:"linear",queued:!1,initProps:{overflow:"",height:"",paddingTop:"",paddingBottom:"",marginTop:"",marginBottom:""},hideProps:{overflow:"hidden",height:0,paddingTop:0,paddingBottom:0,marginTop:0,marginBottom:0}},computed:{hasAnimation:function(e){var t=e.animation;return!!t[0]},hasTransition:function(e){var t=e.animation;return this.hasAnimation&&!0===t[0]}},methods:{toggleElement:function(e,t,a){var o=this;return new mr(function(r){e=V(e);var i=function(e){return mr.all(e.map(function(e){return o._toggleElement(e,t,a)}))},n;if(!o.queued||!M(t)||!o.hasAnimation||2>e.length)n=i(e);else{var l=e.filter(function(e){return o.isToggled(e)}),s=e.filter(function(e){return!b(l,e)}),d=document.body,c=d.scrollTop,u=l[0],g=Er.inProgress(u)&&dt(u,"uk-animation-leave")||Cr.inProgress(u)&&"0px"===u.style.height;n=i(l),g||(n=n.then(function(){var e=i(s);return d.scrollTop=c,e}))}n.then(r,Q)})},isToggled:function(e){var t=V(e||this.$el);return this.cls?dt(t,this.cls.split(" ")[0]):!oe(t,"hidden")},updateAria:function(e){!1===this.cls&&ae(e,"aria-hidden",!this.isToggled(e))},_toggleElement:function(e,t,a){var o=this;if(t=P(t)?t:Er.inProgress(e)?dt(e,"uk-animation-leave"):Cr.inProgress(e)?"0px"===e.style.height:!this.isToggled(e),!Ce(e,"before"+(t?"show":"hide"),[this]))return mr.reject();var r=(w(a)?a:!1!==a&&this.hasAnimation?this.hasTransition?ra(this):ia(this):this._toggle)(e,t);Ce(e,t?"show":"hide",[this]);var i=function(){Ce(e,t?"shown":"hidden",[o]),o.$update(e)};return r?r.then(i):mr.resolve(i())},_toggle:function(e,t){if(e){t=!!t;var a;this.cls?(a=b(this.cls," ")||t!==dt(e,this.cls),a&&ct(e,this.cls,b(this.cls," ")?void 0:t)):(a=t===oe(e,"hidden"),a&&ae(e,"hidden",t?null:"")),$("[autofocus]",e).some(function(e){return _e(e)?e.focus()||!0:e.blur()}),this.updateAria(e),a&&(Ce(e,"toggled",[this]),this.$update(e))}}}},Ur={mixins:[Nr,Vr],props:{targets:String,active:null,collapsible:Boolean,multiple:Boolean,toggle:String,content:String,transition:String,offset:Number},data:{targets:"> *",active:!1,animation:[!0],collapsible:!0,multiple:!1,clsOpen:"uk-open",toggle:"> .uk-accordion-title",content:"> .uk-accordion-content",transition:"ease",offset:0},computed:{items:{get:function(e,t){var a=e.targets;return $(a,t)},watch:function(e,t){var a=this;if(e.forEach(function(e){return na(ot(a.content,e),!dt(e,a.clsOpen))}),!(t||dt(e,this.clsOpen))){var o=!1!==this.active&&e[+this.active]||!this.collapsible&&e[0];o&&this.toggle(o,!1)}},immediate:!0}},events:[{name:"click",delegate:function(){return this.targets+" "+this.$props.toggle},handler:function(t){t.preventDefault(),this.toggle(He($(this.targets+" "+this.$props.toggle,this.$el),t.current))}}],methods:{toggle:function(e,t){var a=this,o=[this.items[qe(e,this.items)]],r=ve(this.items,"."+this.clsOpen);this.multiple||b(r,o[0])||(o=o.concat(r)),(this.collapsible||ve(o,":not(."+this.clsOpen+")").length)&&o.forEach(function(e){return a.toggleElement(e,!dt(e,a.clsOpen),function(e,o){ct(e,a.clsOpen,o);var r=ot(""+(e._wrapper?"> * ":"")+a.content,e);return!1!==t&&a.hasTransition?(e._wrapper||(e._wrapper=Je(r,"<div"+(o?" hidden":"")+">")),na(r,!1),ra(a)(e._wrapper,o).then(function(){if(na(r,!o),delete e._wrapper,et(r),o){var t=ot(a.$props.toggle,e);Wt(t)||Zt(t,{offset:a.offset})}})):void na(r,!o)})})}}},Hr={mixins:[Nr,Vr],args:"animation",props:{close:String},data:{animation:[!0],selClose:".uk-alert-close",duration:150,hideProps:Yo({opacity:0},Vr.data.hideProps)},events:[{name:"click",delegate:function(){return this.selClose},handler:function(t){t.preventDefault(),this.close()}}],methods:{close:function(){var e=this;this.toggleElement(this.$el).then(function(){return e.$destroy(!0)})}}},qr={args:"autoplay",props:{automute:Boolean,autoplay:Boolean},data:{automute:!1,autoplay:!0},computed:{inView:function(e){var t=e.autoplay;return"inview"===t}},connected:function(){this.inView&&!oe(this.$el,"preload")&&(this.$el.preload="none"),this.player=new Mr(this.$el),this.automute&&this.player.mute()},update:{read:function(){return!!this.player&&{visible:_e(this.$el)&&"hidden"!==gt(this.$el,"visibility"),inView:this.inView&&Wt(this.$el)}},write:function(e){var t=e.visible,a=e.inView;t&&(!this.inView||a)?(!0===this.autoplay||this.inView&&a)&&this.player.play():this.player.pause()},events:["resize","scroll"]}},Gr={mixins:[Nr,qr],props:{width:Number,height:Number},data:{automute:!0},update:{read:function(){var e=this.$el,t=la(e)||e.parentNode,a=t.offsetHeight,o=t.offsetWidth,r=Wo.cover({width:this.width||e.naturalWidth||e.videoWidth||e.clientWidth,height:this.height||e.naturalHeight||e.videoHeight||e.clientHeight},{width:o+(o%2?1:0),height:a+(a%2?1:0)});return!!(r.width&&r.height)&&r},write:function(e){var t=e.height,a=e.width;gt(this.$el,{height:t,width:a})},events:["resize"]}},Yr={props:{pos:String,offset:null,flip:Boolean,clsPos:String},data:{pos:"bottom-"+(Zo?"right":"left"),flip:!0,offset:!1,clsPos:""},computed:{pos:function(e){var t=e.pos;return(t+(b(t,"-")?"":"-center")).split("-")},dir:function(){return this.pos[0]},align:function(){return this.pos[1]}},methods:{positionAt:function(e,t,a){lt(e,this.clsPos+"-(top|bottom|left|right)(-[a-z]+)?"),gt(e,{top:"",left:""});var o=this,r=o.offset,i=this.getAxis(),n;O(r)||(n=ot(r),r=n?wt(n)["x"===i?"left":"top"]-wt(t)["x"===i?"right":"bottom"]:0);var l=vt(e,t,"x"===i?Pt(this.dir)+" "+this.align:this.align+" "+Pt(this.dir),"x"===i?this.dir+" "+this.align:this.align+" "+this.dir,"x"===i?""+("left"===this.dir?-r:r):" "+("top"===this.dir?-r:r),null,this.flip,a).target,s=l.x,d=l.y;this.dir="x"===i?s:d,this.align="x"===i?d:s,ct(e,this.clsPos+"-"+this.dir+"-"+this.align,!1===this.offset)},getAxis:function(){return"top"===this.dir||"bottom"===this.dir?"y":"x"}}},Wr={mixins:[Yr,Vr],args:"pos",props:{mode:"list",toggle:Boolean,boundary:Boolean,boundaryAlign:Boolean,delayShow:Number,delayHide:Number,clsDrop:String},data:{mode:["click","hover"],toggle:"- *",boundary:window,boundaryAlign:!1,delayShow:0,delayHide:800,clsDrop:!1,animation:["uk-animation-fade"],cls:"uk-open"},computed:{boundary:function(e,t){var a=e.boundary;return ne(a,t)},clsDrop:function(e){var t=e.clsDrop;return t||"uk-"+this.$options.name},clsPos:function(){return this.clsDrop}},created:function(){this.tracker=new Bt},connected:function(){it(this.$el,this.clsDrop);var e=this.$props,t=e.toggle;this.toggle=t&&this.$create("toggle",ne(t,this.$el),{target:this.$el,mode:this.mode}),this.toggle||Ce(this.$el,"updatearia")},disconnected:function(){this.isActive()&&(hi=null)},events:[{name:"click",delegate:function(){return"."+this.clsDrop+"-close"},handler:function(t){t.preventDefault(),this.hide(!1)}},{name:"click",delegate:function(){return"a[href^=\"#\"]"},handler:function(e){var t=e.defaultPrevented,a=e.current.hash;t||!a||we(a,this.$el)||this.hide(!1)}},{name:"beforescroll",handler:function(){this.hide(!1)}},{name:"toggle",self:!0,handler:function(t,e){t.preventDefault(),this.isToggled()?this.hide(!1):this.show(e,!1)}},{name:"toggleshow",self:!0,handler:function(t,e){t.preventDefault(),this.show(e)}},{name:"togglehide",self:!0,handler:function(t){t.preventDefault(),this.hide()}},{name:ar,filter:function(){return b(this.mode,"hover")},handler:function(t){je(t)||this.clearTimers()}},{name:or,filter:function(){return b(this.mode,"hover")},handler:function(t){je(t)||this.hide()}},{name:"toggled",self:!0,handler:function(){this.isToggled()&&(this.clearTimers(),Er.cancel(this.$el),this.position())}},{name:"show",self:!0,handler:function(){var t=this;hi=this,this.tracker.init(),Ce(this.$el,"updatearia"),Se(this.$el,"hide",Ae(document,Qo,function(e){var a=e.target;return!we(a,t.$el)&&Se(document,tr+" "+rr+" scroll",function(e){var o=e.defaultPrevented,r=e.type,i=e.target;o||r!==tr||a!==i||t.toggle&&we(a,t.toggle.$el)||t.hide(!1)},!0)}),{self:!0}),Se(this.$el,"hide",Ae(document,"keydown",function(a){27===a.keyCode&&(a.preventDefault(),t.hide(!1))}),{self:!0})}},{name:"beforehide",self:!0,handler:function(){this.clearTimers()}},{name:"hide",handler:function(e){var t=e.target;return this.$el===t?void(hi=this.isActive()?null:hi,Ce(this.$el,"updatearia"),this.tracker.cancel()):void(hi=null===hi&&we(t,this.$el)&&this.isToggled()?this:hi)}},{name:"updatearia",self:!0,handler:function(t,e){t.preventDefault(),this.updateAria(this.$el),(e||this.toggle)&&(ae((e||this.toggle).$el,"aria-expanded",this.isToggled()),ct(this.toggle.$el,this.cls,this.isToggled()))}}],update:{write:function(){this.isToggled()&&!Er.inProgress(this.$el)&&this.position()},events:["resize"]},methods:{show:function(e,t){var a=this;if(void 0===e&&(e=this.toggle),void 0===t&&(t=!0),this.isToggled()&&e&&this.toggle&&e.$el!==this.toggle.$el&&this.hide(!1),this.toggle=e,this.clearTimers(),!this.isActive()){if(hi){if(t&&hi.isDelaying)return void(this.showTimer=setTimeout(this.show,10));for(;hi&&!we(this.$el,hi.$el);)hi.hide(!1)}this.showTimer=setTimeout(function(){return!a.isToggled()&&a.toggleElement(a.$el,!0)},t&&this.delayShow||0)}},hide:function(e){var t=this;void 0===e&&(e=!0);var a=function(){return t.toggleElement(t.$el,!1,!1)};this.clearTimers(),this.isDelaying=sa(this.$el).some(function(e){return t.tracker.movesTo(e)}),e&&this.isDelaying?this.hideTimer=setTimeout(this.hide,50):e&&this.delayHide?this.hideTimer=setTimeout(a,this.delayHide):a()},clearTimers:function(){clearTimeout(this.showTimer),clearTimeout(this.hideTimer),this.showTimer=null,this.hideTimer=null,this.isDelaying=!1},isActive:function(){return hi===this},position:function(){lt(this.$el,this.clsDrop+"-(stack|boundary)"),ct(this.$el,this.clsDrop+"-boundary",this.boundaryAlign);var e=wt(this.boundary),t=this.boundaryAlign?e:wt(this.toggle.$el);if("justify"===this.align){var a="y"===this.getAxis()?"width":"height";gt(this.$el,a,t[a])}else this.$el.offsetWidth>g(e.right-t.left,t.right-e.left)&&it(this.$el,this.clsDrop+"-stack");this.positionAt(this.$el,this.boundaryAlign?this.boundary:this.toggle.$el,this.boundary)}}},Xr={mixins:[Nr],args:"target",props:{target:Boolean},data:{target:!1},computed:{input:function(e,t){return ot(gr,t)},state:function(){return this.input.nextElementSibling},target:function(e,t){var a=e.target;return a&&(!0===a&&this.input.parentNode===t&&this.input.nextElementSibling||ne(a,t))}},update:function(){var e=this,t=e.target,a=e.input;if(t){var o=be(t)?"value":"textContent",r=t[o],i=a.files&&a.files[0]?a.files[0].name:me(a,"select")&&(n=$("option",a).filter(function(e){return e.selected})[0])?n.textContent:a.value,n;r!==i&&(t[o]=i)}},events:[{name:"change",handler:function(){this.$update()}},{name:"reset",el:function(){return he(this.$el,"form")},handler:function(){this.$update()}}]},Zr={props:{margin:String,firstColumn:Boolean},data:{margin:"uk-margin-small-top",firstColumn:"uk-first-column"},update:{read:function(){return{rows:da(this.$el.children)}},write:function(e){var t=this,a=e.rows;a.forEach(function(e,a){return e.forEach(function(e,o){ct(e,t.margin,0!==a),ct(e,t.firstColumn,0===o)})})},events:["resize"]}},Kr={extends:Zr,mixins:[Nr],name:"grid",props:{masonry:Boolean,parallax:Number},data:{margin:"uk-grid-margin",clsStack:"uk-grid-stack",masonry:!1,parallax:0},computed:{length:function(e,t){return t.children.length},parallax:function(e){var t=e.parallax;return t&&this.length?u(t):""}},connected:function(){this.masonry&&it(this.$el,"uk-flex-top uk-flex-wrap-top")},update:[{read:function(e){var t=e.rows;return{stacks:!t.some(function(e){return 1<e.length})}},write:function(e){var t=e.stacks;ct(this.$el,this.clsStack,t)},events:["resize"]},{read:function(e){var t=e.rows;if(!this.masonry&&!this.parallax)return!1;t=t.map(function(e){return Z(e,"offsetLeft")}),Zo&&t.map(function(e){return e.reverse()});var a=t.some(function(e){return e.some(Cr.inProgress)}),o=!1,r="";if(this.masonry&&this.length){var n=0;o=t.reduce(function(e,a,o){return e[o]=a.map(function(a,r){return 0===o?0:F(e[o-1][r])+(n-F(t[o-1][r]&&t[o-1][r].offsetHeight))}),n=a.reduce(function(e,t){return g(e,t.offsetHeight)},0),e},[]),r=ga(t)+ua(this.$el,this.margin)*(t.length-1)}var l=this.parallax&&pa(this.parallax,t,o);return{padding:l,rows:t,translates:o,height:!a&&r}},write:function(e){var t=e.height,a=e.padding;gt(this.$el,"paddingBottom",a),!1!==t&&gt(this.$el,"height",t)},events:["resize"]},{read:function(e){var t=e.height;return{scrolled:!!this.parallax&&Kt(this.$el,t?t-Pr(this.$el):0)*this.parallax}},write:function(e){var t=e.rows,a=e.scrolled,o=e.translates;(!1!==a||o)&&t.forEach(function(e,t){return e.forEach(function(e,r){return gt(e,"transform",a||o?"translateY("+((o&&-o[t][r])+(a?r%2?a:a/8:0))+"px)":"")})})},events:["scroll","resize"]}]},$r=Xo?{props:{selMinHeight:String},data:{selMinHeight:!1,forceHeight:!1},computed:{elements:function(e,t){var a=e.selMinHeight;return a?$(a,t):[t]}},update:[{read:function(){gt(this.elements,"height","")},order:-5,events:["resize"]},{write:function(){var e=this;this.elements.forEach(function(t){var a=F(gt(t,"minHeight"));a&&(e.forceHeight||l(a+Ct(t,"height","content-box"))>=t.offsetHeight)&&gt(t,"height",a)})},order:5,events:["resize"]}]}:{},Jr={mixins:[$r],args:"target",props:{target:String,row:Boolean},data:{target:"> *",row:!0,forceHeight:!0},computed:{elements:function(e,t){var a=e.target;return $(a,t)}},update:{read:function(){return{rows:(this.row?da(this.elements):[this.elements]).map(ma)}},write:function(e){var t=e.rows;t.forEach(function(e){var t=e.heights,a=e.elements;return a.forEach(function(e,a){return gt(e,"minHeight",t[a])})})},events:["resize"]}},Qr={mixins:[$r],props:{expand:Boolean,offsetTop:Boolean,offsetBottom:Boolean,minHeight:Number},data:{expand:!1,offsetTop:!1,offsetBottom:!1,minHeight:0},update:{read:function(e){var t=e.minHeight;if(!_e(this.$el))return!1;var a="",o=Ct(this.$el,"height","content-box");if(this.expand){if(this.$el.dataset.heightExpand="",ot("[data-height-expand]")!==this.$el)return!1;a=Pr(window)-(ya(document.documentElement)-ya(this.$el))-o||""}else{if(a="calc(100vh",this.offsetTop){var r=wt(this.$el),i=r.top;a+=0<i&&i<Pr(window)/2?" - "+i+"px":""}!0===this.offsetBottom?a+=" - "+ya(this.$el.nextElementSibling)+"px":O(this.offsetBottom)?a+=" - "+this.offsetBottom+"vh":this.offsetBottom&&_(this.offsetBottom,"px")?a+=" - "+F(this.offsetBottom)+"px":z(this.offsetBottom)&&(a+=" - "+ya(ne(this.offsetBottom,this.$el))+"px"),a+=(o?" - "+o+"px":"")+")"}return{minHeight:a,prev:t}},write:function(e){var t=e.minHeight,a=e.prev;gt(this.$el,{minHeight:t}),t!==a&&this.$update(this.$el,"resize"),this.minHeight&&F(gt(this.$el,"minHeight"))<this.minHeight&&gt(this.$el,"minHeight",this.minHeight)},events:["resize"]}},ei={args:"src",props:{id:Boolean,icon:String,src:String,style:String,width:Number,height:Number,ratio:Number,class:String,strokeAnimation:Boolean,focusable:Boolean,attributes:"list"},data:{ratio:1,include:["style","class","focusable"],class:"",strokeAnimation:!1},beforeConnect:function(){var e=this,t;if(this.class+=" uk-svg",!this.icon&&b(this.src,"#")){var a=this.src.split("#");1<a.length&&(t=a,this.src=t[0],this.icon=t[1])}this.svg=this.getSvg().then(function(t){return e.applyAttributes(t),e.svgEl=wa(t,e.$el)},Q)},disconnected:function(){var e=this;xe(this.$el)&&ae(this.$el,"hidden",null),this.svg&&this.svg.then(function(t){return(!e._connected||t!==e.svgEl)&&$e(t)},Q),this.svg=this.svgEl=null},update:{read:function(){return!!(this.strokeAnimation&&this.svgEl&&_e(this.svgEl))},write:function(){ba(this.svgEl)},type:["resize"]},methods:{getSvg:function(){var e=this;return fa(this.src).then(function(t){return xa(t,e.icon)||mr.reject("SVG not found.")})},applyAttributes:function(e){var t=this;for(var a in this.$options.props)this[a]&&b(this.include,a)&&ae(e,a,this[a]);for(var o in this.attributes){var r=this.attributes[o].split(":",2),i=r[0],n=r[1];ae(e,i,n)}this.id||re(e,"id");var l=["width","height"],s=[this.width,this.height];s.some(function(e){return e})||(s=l.map(function(t){return ae(e,t)}));var d=ae(e,"viewBox");d&&!s.some(function(e){return e})&&(s=d.split(" ").slice(2)),s.forEach(function(a,o){a=(0|a)*t.ratio,a&&ae(e,l[o],a),a&&!s[1^o]&&re(e,l[1^o])}),ae(e,"data-svg",this.icon||this.src)}}},ti={},ai=/<symbol([^]*?id=(['"])(.+?)\2[^]*?<\/)symbol>/g,oi={},ri={spinner:"<svg width=\"30\" height=\"30\" viewBox=\"0 0 30 30\" xmlns=\"http://www.w3.org/2000/svg\"><circle fill=\"none\" stroke=\"#000\" cx=\"15\" cy=\"15\" r=\"14\"/></svg>",totop:"<svg width=\"18\" height=\"10\" viewBox=\"0 0 18 10\" xmlns=\"http://www.w3.org/2000/svg\"><polyline fill=\"none\" stroke=\"#000\" stroke-width=\"1.2\" points=\"1 9 9 1 17 9 \"/></svg>",marker:"<svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" xmlns=\"http://www.w3.org/2000/svg\"><rect x=\"9\" y=\"4\" width=\"1\" height=\"11\"/><rect x=\"4\" y=\"9\" width=\"11\" height=\"1\"/></svg>","close-icon":"<svg width=\"14\" height=\"14\" viewBox=\"0 0 14 14\" xmlns=\"http://www.w3.org/2000/svg\"><line fill=\"none\" stroke=\"#000\" stroke-width=\"1.1\" x1=\"1\" y1=\"1\" x2=\"13\" y2=\"13\"/><line fill=\"none\" stroke=\"#000\" stroke-width=\"1.1\" x1=\"13\" y1=\"1\" x2=\"1\" y2=\"13\"/></svg>","close-large":"<svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" xmlns=\"http://www.w3.org/2000/svg\"><line fill=\"none\" stroke=\"#000\" stroke-width=\"1.4\" x1=\"1\" y1=\"1\" x2=\"19\" y2=\"19\"/><line fill=\"none\" stroke=\"#000\" stroke-width=\"1.4\" x1=\"19\" y1=\"1\" x2=\"1\" y2=\"19\"/></svg>","navbar-toggle-icon":"<svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" xmlns=\"http://www.w3.org/2000/svg\"><rect y=\"9\" width=\"20\" height=\"2\"/><rect y=\"3\" width=\"20\" height=\"2\"/><rect y=\"15\" width=\"20\" height=\"2\"/></svg>","overlay-icon":"<svg width=\"40\" height=\"40\" viewBox=\"0 0 40 40\" xmlns=\"http://www.w3.org/2000/svg\"><rect x=\"19\" y=\"0\" width=\"1\" height=\"40\"/><rect x=\"0\" y=\"19\" width=\"40\" height=\"1\"/></svg>","pagination-next":"<svg width=\"7\" height=\"12\" viewBox=\"0 0 7 12\" xmlns=\"http://www.w3.org/2000/svg\"><polyline fill=\"none\" stroke=\"#000\" stroke-width=\"1.2\" points=\"1 1 6 6 1 11\"/></svg>","pagination-previous":"<svg width=\"7\" height=\"12\" viewBox=\"0 0 7 12\" xmlns=\"http://www.w3.org/2000/svg\"><polyline fill=\"none\" stroke=\"#000\" stroke-width=\"1.2\" points=\"6 1 1 6 6 11\"/></svg>","search-icon":"<svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" xmlns=\"http://www.w3.org/2000/svg\"><circle fill=\"none\" stroke=\"#000\" stroke-width=\"1.1\" cx=\"9\" cy=\"9\" r=\"7\"/><path fill=\"none\" stroke=\"#000\" stroke-width=\"1.1\" d=\"M14,14 L18,18 L14,14 Z\"/></svg>","search-large":"<svg width=\"40\" height=\"40\" viewBox=\"0 0 40 40\" xmlns=\"http://www.w3.org/2000/svg\"><circle fill=\"none\" stroke=\"#000\" stroke-width=\"1.8\" cx=\"17.5\" cy=\"17.5\" r=\"16.5\"/><line fill=\"none\" stroke=\"#000\" stroke-width=\"1.8\" x1=\"38\" y1=\"39\" x2=\"29\" y2=\"30\"/></svg>","search-navbar":"<svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\"><circle fill=\"none\" stroke=\"#000\" stroke-width=\"1.1\" cx=\"10.5\" cy=\"10.5\" r=\"9.5\"/><line fill=\"none\" stroke=\"#000\" stroke-width=\"1.1\" x1=\"23\" y1=\"23\" x2=\"17\" y2=\"17\"/></svg>","slidenav-next":"<svg width=\"14px\" height=\"24px\" viewBox=\"0 0 14 24\" xmlns=\"http://www.w3.org/2000/svg\"><polyline fill=\"none\" stroke=\"#000\" stroke-width=\"1.4\" points=\"1.225,23 12.775,12 1.225,1 \"/></svg>","slidenav-next-large":"<svg width=\"25px\" height=\"40px\" viewBox=\"0 0 25 40\" xmlns=\"http://www.w3.org/2000/svg\"><polyline fill=\"none\" stroke=\"#000\" stroke-width=\"2\" points=\"4.002,38.547 22.527,20.024 4,1.5 \"/></svg>","slidenav-previous":"<svg width=\"14px\" height=\"24px\" viewBox=\"0 0 14 24\" xmlns=\"http://www.w3.org/2000/svg\"><polyline fill=\"none\" stroke=\"#000\" stroke-width=\"1.4\" points=\"12.775,1 1.225,12 12.775,23 \"/></svg>","slidenav-previous-large":"<svg width=\"25px\" height=\"40px\" viewBox=\"0 0 25 40\" xmlns=\"http://www.w3.org/2000/svg\"><polyline fill=\"none\" stroke=\"#000\" stroke-width=\"2\" points=\"20.527,1.5 2,20.024 20.525,38.547 \"/></svg>"},ii={install:function(e){e.icon.add=function(t,a){var o=z(t)?(r={},r[t]=a,r):t,r;X(o,function(e,t){ri[t]=e,delete si[t]}),e._initialized&&at(document.body,function(t){return X(e.getComponents(t),function(e){e.$options.isIcon&&e.icon in o&&e.$reset()})})}},extends:ei,args:"icon",props:["icon"],data:{include:["focusable"]},isIcon:!0,beforeConnect:function(){it(this.$el,"uk-icon")},methods:{getSvg:function(){var e=Ta(this.icon);return e?mr.resolve(e):mr.reject("Icon not found.")}}},ni={args:!1,extends:ii,data:function(e){return{icon:a(e.constructor.options.name)}},beforeConnect:function(){it(this.$el,this.$name)}},li={extends:ni,beforeConnect:function(){it(this.$el,"uk-slidenav")},computed:{icon:function(e,t){var a=e.icon;return dt(t,"uk-slidenav-large")?a+"-large":a}}},si={},di={args:"dataSrc",props:{dataSrc:String,dataSrcset:Boolean,sizes:String,width:Number,height:Number,offsetTop:String,offsetLeft:String,target:String},data:{dataSrc:"",dataSrcset:!1,sizes:!1,width:!1,height:!1,offsetTop:"50vh",offsetLeft:0,target:!1},computed:{cacheKey:function(e){var t=e.dataSrc;return this.$name+"."+t},width:function(e){var t=e.width,a=e.dataWidth;return t||a},height:function(e){var t=e.height,a=e.dataHeight;return t||a},sizes:function(e){var t=e.sizes,a=e.dataSizes;return t||a},isImg:function(e,t){return Pa(t)},target:{get:function(e){var t=e.target;return[this.$el].concat(le(t,this.$el))},watch:function(){this.observe()}},offsetTop:function(e){var t=e.offsetTop;return zt(t,"height")},offsetLeft:function(e){var t=e.offsetLeft;return zt(t,"width")}},connected:function(){yi[this.cacheKey]?Sa(this.$el,yi[this.cacheKey]||this.dataSrc,this.dataSrcset,this.sizes):this.isImg&&this.width&&this.height&&Sa(this.$el,Ca(this.width,this.height,this.sizes)),this.observer=new jr(this.load,{rootMargin:this.offsetTop+"px "+this.offsetLeft+"px"}),requestAnimationFrame(this.observe)},disconnected:function(){this.observer.disconnect()},update:{read:function(e){var t=this,a=e.image;return a||"complete"!==document.readyState||this.load(this.observer.takeRecords()),!this.isImg&&void(a&&a.then(function(e){return e&&""!==e.currentSrc&&Sa(t.$el,za(e))}))},write:function(e){if(this.dataSrcset&&1!==window.devicePixelRatio){var t=gt(this.$el,"backgroundSize");(t.match(/^(auto\s?)+$/)||F(t)===e.bgSize)&&(e.bgSize=Ia(this.dataSrcset,this.sizes),gt(this.$el,"backgroundSize",e.bgSize+"px"))}},events:["resize"]},methods:{load:function(e){var t=this;e.some(function(e){return M(e.isIntersecting)||e.isIntersecting})&&(this._data.image=Ve(this.dataSrc,this.dataSrcset,this.sizes).then(function(e){return Sa(t.$el,za(e),e.srcset,e.sizes),yi[t.cacheKey]=za(e),e},Q),this.observer.disconnect())},observe:function(){var e=this;this._connected&&!this._data.image&&this.target.forEach(function(t){return e.observer.observe(t)})}}},ci=/\s*(.*?)\s*(\w+|calc\(.*?\))\s*(?:,|$)/g,pi=/\d+(?:\w+|%)/g,ui=/[+-]?(\d+)/g,gi=/\s+\d+w\s*(?:,|$)/g,mi="__test__",hi,yi;try{yi=window.sessionStorage||{},yi[mi]=1,delete yi[mi]}catch(t){yi={}}var fi={props:{media:Boolean},data:{media:!1},computed:{matchMedia:function(){var e=Da(this.media);return!e||window.matchMedia(e).matches}}},xi={mixins:[Nr,fi],props:{fill:String},data:{fill:"",clsWrapper:"uk-leader-fill",clsHide:"uk-leader-hide",attrFill:"data-fill"},computed:{fill:function(e){var t=e.fill;return t||yt("leader-fill-content")}},connected:function(){var e;e=Qe(this.$el,"<span class=\""+this.clsWrapper+"\">"),this.wrapper=e[0]},disconnected:function(){et(this.wrapper.childNodes)},update:{read:function(e){var t=e.changed,a=e.width,o=a;return a=m(this.$el.offsetWidth/2),{width:a,fill:this.fill,changed:t||o!==a,hide:!this.matchMedia}},write:function(e){ct(this.wrapper,this.clsHide,e.hide),e.changed&&(e.changed=!1,ae(this.wrapper,this.attrFill,Array(e.width).join(e.fill)))},events:["resize"]}},_i={props:{container:Boolean},data:{container:!0},computed:{container:function(e){var t=e.container;return!0===t&&this.$container||t&&ot(t)}}},bi=[],vi={mixins:[Nr,_i,Vr],props:{selPanel:String,selClose:String,escClose:Boolean,bgClose:Boolean,stack:Boolean},data:{cls:"uk-open",escClose:!0,bgClose:!0,overlay:!0,stack:!1},computed:{panel:function(e,t){var a=e.selPanel;return ot(a,t)},transitionElement:function(){return this.panel},bgClose:function(e){var t=e.bgClose;return t&&this.panel}},beforeDisconnect:function(){this.isToggled()&&this.toggleElement(this.$el,!1,!1)},events:[{name:"click",delegate:function(){return this.selClose},handler:function(t){t.preventDefault(),this.hide()}},{name:"toggle",self:!0,handler:function(t){t.defaultPrevented||(t.preventDefault(),this.isToggled()===b(bi,this)&&this.toggle())}},{name:"beforeshow",self:!0,handler:function(t){return!b(bi,this)&&void(!this.stack&&bi.length?(mr.all(bi.map(function(e){return e.hide()})).then(this.show),t.preventDefault()):bi.push(this))}},{name:"show",self:!0,handler:function(){var t=this;zr(window)-zr(document)&&this.overlay&&gt(document.body,"overflowY","scroll"),this.stack&&gt(this.$el,"zIndex",gt(this.$el,"zIndex")+bi.length),it(document.documentElement,this.clsPage),this.bgClose&&Se(this.$el,"hide",Ae(document,Qo,function(e){var a=e.target;W(bi)!==t||t.overlay&&!we(a,t.$el)||we(a,t.panel)||Se(document,tr+" "+rr+" scroll",function(e){var o=e.defaultPrevented,r=e.type,i=e.target;o||r!==tr||a!==i||t.hide()},!0)}),{self:!0}),this.escClose&&Se(this.$el,"hide",Ae(document,"keydown",function(a){27===a.keyCode&&W(bi)===t&&(a.preventDefault(),t.hide())}),{self:!0})}},{name:"hidden",self:!0,handler:function(){var e=this;bi.splice(bi.indexOf(this),1),bi.length||gt(document.body,"overflowY",""),gt(this.$el,"zIndex",""),bi.some(function(t){return t.clsPage===e.clsPage})||nt(document.documentElement,this.clsPage)}}],methods:{toggle:function(){return this.isToggled()?this.hide():this.show()},show:function(){var e=this;return this.container&&this.$el.parentNode!==this.container?(We(this.container,this.$el),new mr(function(t){return requestAnimationFrame(function(){return e.show().then(t)})})):this.toggleElement(this.$el,!0,Oa(this))},hide:function(){return this.toggleElement(this.$el,!1,Oa(this))}}},wi={mixins:[Nr,$r],props:{dropdown:String,mode:"list",align:String,offset:Number,boundary:Boolean,boundaryAlign:Boolean,clsDrop:String,delayShow:Number,delayHide:Number,dropbar:Boolean,dropbarMode:String,dropbarAnchor:Boolean,duration:Number},data:{dropdown:".uk-navbar-nav > li",align:Zo?"right":"left",clsDrop:"uk-navbar-dropdown",mode:void 0,offset:void 0,delayShow:void 0,delayHide:void 0,boundaryAlign:void 0,flip:"x",boundary:!0,dropbar:!1,dropbarMode:"slide",dropbarAnchor:!1,duration:200,forceHeight:!0,selMinHeight:".uk-navbar-nav > li > a, .uk-navbar-item, .uk-navbar-toggle"},computed:{boundary:function(e,t){var a=e.boundary,o=e.boundaryAlign;return!0===a||o?t:a},dropbarAnchor:function(e,t){var a=e.dropbarAnchor;return ne(a,t)},pos:function(e){var t=e.align;return"bottom-"+t},dropbar:{get:function(e){var t=e.dropbar;return t?(t=this._dropbar||ne(t,this.$el)||ot("+ .uk-navbar-dropbar",this.$el),t?t:this._dropbar=ot("<div></div>")):null},watch:function(e){it(e,"uk-navbar-dropbar")},immediate:!0},dropdowns:{get:function(e,t){var a=e.dropdown,o=e.clsDrop;return $(a+" ."+o,t)},watch:function(e){var t=this;this.$create("drop",e.filter(function(e){return!t.getDropdown(e)}),Yo({},this.$props,{boundary:this.boundary,pos:this.pos,offset:this.dropbar||this.offset}))},immediate:!0}},disconnected:function(){this.dropbar&&$e(this.dropbar),delete this._dropbar},events:[{name:"mouseover",delegate:function(){return this.dropdown},handler:function(e){var t=e.current,a=this.getActive();a&&a.toggle&&!we(a.toggle.$el,t)&&!a.tracker.movesTo(a.$el)&&a.hide(!1)}},{name:"mouseleave",el:function(){return this.dropbar},handler:function(){var e=this.getActive();e&&!this.dropdowns.some(function(e){return me(e,":hover")})&&e.hide()}},{name:"beforeshow",capture:!0,filter:function(){return this.dropbar},handler:function(){this.dropbar.parentNode||Ze(this.dropbarAnchor||this.$el,this.dropbar)}},{name:"show",capture:!0,filter:function(){return this.dropbar},handler:function(e,t){var a=t.$el,o=t.dir;ct(this.dropbar,"uk-navbar-dropbar-slide","slide"===this.dropbarMode||ke(this.$el).some(function(e){return"static"!==gt(e,"position")})),this.clsDrop&&it(a,this.clsDrop+"-dropbar"),"bottom"===o&&this.transitionTo(a.offsetHeight+F(gt(a,"marginTop"))+F(gt(a,"marginBottom")),a)}},{name:"beforehide",filter:function(){return this.dropbar},handler:function(t,e){var a=e.$el,o=this.getActive();me(this.dropbar,":hover")&&o&&o.$el===a&&t.preventDefault()}},{name:"hide",filter:function(){return this.dropbar},handler:function(e,t){var a=t.$el,o=this.getActive();(!o||o&&o.$el===a)&&this.transitionTo(0)}}],methods:{getActive:function(){var e=this.dropdowns.map(this.getDropdown).filter(function(e){return e&&e.isActive()}),t=e[0];return t&&b(t.mode,"hover")&&we(t.toggle.$el,this.$el)&&t},transitionTo:function(e,t){var a=this,o=this,r=o.dropbar,i=_e(r)?Pr(r):0;return t=i<e&&t,gt(t,"clip","rect(0,"+t.offsetWidth+"px,"+i+"px,0)"),Pr(r,i),Cr.cancel([t,r]),mr.all([Cr.start(r,{height:e},this.duration),Cr.start(t,{clip:"rect(0,"+t.offsetWidth+"px,"+e+"px,0)"},this.duration)]).catch(Q).then(function(){gt(t,{clip:""}),a.$update(r)})},getDropdown:function(e){return this.$getComponent(e,"drop")||this.$getComponent(e,"dropdown")}}},ki={mixins:[vi],args:"mode",props:{mode:String,flip:Boolean,overlay:Boolean},data:{mode:"slide",flip:!1,overlay:!1,clsPage:"uk-offcanvas-page",clsContainer:"uk-offcanvas-container",selPanel:".uk-offcanvas-bar",clsFlip:"uk-offcanvas-flip",clsContainerAnimation:"uk-offcanvas-container-animation",clsSidebarAnimation:"uk-offcanvas-bar-animation",clsMode:"uk-offcanvas",clsOverlay:"uk-offcanvas-overlay",selClose:".uk-offcanvas-close",container:!1},computed:{clsFlip:function(e){var t=e.flip,a=e.clsFlip;return t?a:""},clsOverlay:function(e){var t=e.overlay,a=e.clsOverlay;return t?a:""},clsMode:function(e){var t=e.mode,a=e.clsMode;return a+"-"+t},clsSidebarAnimation:function(e){var t=e.mode,a=e.clsSidebarAnimation;return"none"===t||"reveal"===t?"":a},clsContainerAnimation:function(e){var t=e.mode,a=e.clsContainerAnimation;return"push"!==t&&"reveal"!==t?"":a},transitionElement:function(e){var t=e.mode;return"reveal"===t?this.panel.parentNode:this.panel}},events:[{name:"click",delegate:function(){return"a[href^=\"#\"]"},handler:function(e){var t=e.current.hash,a=e.defaultPrevented;!a&&t&&ot(t,document.body)&&this.hide()}},{name:"touchstart",passive:!0,el:function(){return this.panel},handler:function(e){var t=e.targetTouches;1===t.length&&(this.clientY=t[0].clientY)}},{name:"touchmove",self:!0,passive:!1,filter:function(){return this.overlay},handler:function(t){t.cancelable&&t.preventDefault()}},{name:"touchmove",passive:!1,el:function(){return this.panel},handler:function(t){if(1===t.targetTouches.length){var e=event.targetTouches[0].clientY-this.clientY,a=this.panel,o=a.scrollTop,r=a.scrollHeight,i=a.clientHeight;(i>=r||0===o&&0<e||r-o<=i&&0>e)&&t.cancelable&&t.preventDefault()}}},{name:"show",self:!0,handler:function(){"reveal"!==this.mode||dt(this.panel.parentNode,this.clsMode)||(Je(this.panel,"<div>"),it(this.panel.parentNode,this.clsMode)),gt(document.documentElement,"overflowY",this.overlay?"hidden":""),it(document.body,this.clsContainer,this.clsFlip),gt(document.body,"touch-action","pan-y pinch-zoom"),gt(this.$el,"display","block"),it(this.$el,this.clsOverlay),it(this.panel,this.clsSidebarAnimation,"reveal"===this.mode?"":this.clsMode),Pr(document.body),it(document.body,this.clsContainerAnimation),this.clsContainerAnimation&&Ra()}},{name:"hide",self:!0,handler:function(){nt(document.body,this.clsContainerAnimation),gt(document.body,"touch-action","")}},{name:"hidden",self:!0,handler:function(){this.clsContainerAnimation&&Ma(),"reveal"===this.mode&&et(this.panel),nt(this.panel,this.clsSidebarAnimation,this.clsMode),nt(this.$el,this.clsOverlay),gt(this.$el,"display",""),nt(document.body,this.clsContainer,this.clsFlip),gt(document.documentElement,"overflowY","")}},{name:"swipeLeft swipeRight",handler:function(t){this.isToggled()&&_(t.type,"Left")^this.flip&&this.hide()}}]},Ti={mixins:[Nr],props:{selContainer:String,selContent:String},data:{selContainer:".uk-modal",selContent:".uk-modal-dialog"},computed:{container:function(e,t){var a=e.selContainer;return he(t,a)},content:function(e,t){var a=e.selContent;return he(t,a)}},connected:function(){gt(this.$el,"minHeight",150)},update:{read:function(){return!!(this.content&&this.container)&&{current:F(gt(this.$el,"maxHeight")),max:g(150,Pr(this.container)-(wt(this.content).height-Pr(this.$el)))}},write:function(e){var t=e.current,a=e.max;gt(this.$el,"maxHeight",a),l(t)!==l(a)&&Ce(this.$el,"resize")},events:["resize"]}},Ai={props:{offset:Number},data:{offset:0},methods:{scrollTo:function(e){var t=this;e=e&&ot(e)||document.body,Ce(this.$el,"beforescroll",[this,e])&&Zt(e,{offset:this.offset}).then(function(){return Ce(t.$el,"scrolled",[t,e])})}},events:{click:function(t){t.defaultPrevented||(t.preventDefault(),this.scrollTo(fe(decodeURIComponent(this.$el.hash)).substr(1)))}}},Si={args:"cls",props:{cls:String,target:String,hidden:Boolean,offsetTop:Number,offsetLeft:Number,repeat:Boolean,delay:Number},data:function(){return{cls:!1,target:!1,hidden:!0,offsetTop:0,offsetLeft:0,repeat:!1,delay:0,inViewClass:"uk-scrollspy-inview"}},computed:{elements:{get:function(e,t){var a=e.target;return a?$(a,t):[t]},watch:function(e){this.hidden&&gt(ve(e,":not(."+this.inViewClass+")"),"visibility","hidden")},immediate:!0}},update:[{read:function(e){var t=this,a=e.update;a&&this.elements.forEach(function(e){var a=e._ukScrollspyState;a||(a={cls:ie(e,"uk-scrollspy-class")||t.cls}),a.show=Wt(e,t.offsetTop,t.offsetLeft),e._ukScrollspyState=a})},write:function(e){var t=this;return e.update?void this.elements.forEach(function(a){var o=a._ukScrollspyState,r=function(e){gt(a,"visibility",!e&&t.hidden?"hidden":""),ct(a,t.inViewClass,e),ct(a,o.cls),Ce(a,e?"inview":"outview"),o.inview=e,t.$update(a)};!o.show||o.inview||o.queued?!o.show&&o.inview&&!o.queued&&t.repeat&&r(!1):(o.queued=!0,e.promise=(e.promise||mr.resolve()).then(function(){return new mr(function(e){return setTimeout(e,t.delay)})}).then(function(){r(!0),setTimeout(function(){return o.queued=!1},300)}))}):(this.$update(),e.update=!0)},events:["scroll","resize"]}]},Ci={props:{cls:String,closest:String,scroll:Boolean,overflow:Boolean,offset:Number},data:{cls:"uk-active",closest:!1,scroll:!1,overflow:!0,offset:0},computed:{links:{get:function(e,t){return $("a[href^=\"#\"]",t).filter(function(e){return e.hash})},watch:function(e){this.scroll&&this.$create("scroll",e,{offset:this.offset||0})},immediate:!0},targets:function(){return $(this.links.map(function(e){return fe(e.hash).substr(1)}).join(","))},elements:function(e){var t=e.closest;return he(this.links,t||"*")}},update:[{read:function(){var e=this,t=this.targets,a=t.length;if(!a||!_e(this.$el))return!1;var o=W($t(this.targets[0])),r=o.scrollTop,i=o.scrollHeight,n=Jt(o),l=i-wt(n).height,s=!1;return r===l?s=a-1:(this.targets.every(function(t,a){if(0>=Tt(t,n).top-e.offset)return s=a,!0}),!1===s&&this.overflow&&(s=0)),{active:s}},write:function(e){var t=e.active;this.links.forEach(function(e){return e.blur()}),nt(this.elements,this.cls),!1!==t&&Ce(this.$el,"active",[t,it(this.elements[t],this.cls)])},events:["scroll","resize"]}]},Li={mixins:[Nr,fi],props:{top:null,bottom:Boolean,offset:String,animation:String,clsActive:String,clsInactive:String,clsFixed:String,clsBelow:String,selTarget:String,widthElement:Boolean,showOnUp:Boolean,targetOffset:Number},data:{top:0,bottom:!1,offset:0,animation:"",clsActive:"uk-active",clsInactive:"",clsFixed:"uk-sticky-fixed",clsBelow:"uk-sticky-below",selTarget:"",widthElement:!1,showOnUp:!1,targetOffset:!1},computed:{offset:function(e){var t=e.offset;return zt(t)},selTarget:function(e,t){var a=e.selTarget;return a&&ot(a,t)||t},widthElement:function(e,t){var a=e.widthElement;return ne(a,t)||this.placeholder},isActive:{get:function(){return dt(this.selTarget,this.clsActive)},set:function(e){e&&!this.isActive?(st(this.selTarget,this.clsInactive,this.clsActive),Ce(this.$el,"active")):!e&&!dt(this.selTarget,this.clsInactive)&&(st(this.selTarget,this.clsActive,this.clsInactive),Ce(this.$el,"inactive"))}}},connected:function(){this.placeholder=ot("+ .uk-sticky-placeholder",this.$el)||ot("<div class=\"uk-sticky-placeholder\"></div>"),this.isFixed=!1,this.isActive=!1},disconnected:function(){this.isFixed&&(this.hide(),nt(this.selTarget,this.clsInactive)),$e(this.placeholder),this.placeholder=null,this.widthElement=null},events:[{name:"load hashchange popstate",el:window,handler:function(){var e=this;if(!1!==this.targetOffset&&location.hash&&0<window.pageYOffset){var t=ot(location.hash);t&&Dr.read(function(){var a=wt(t),o=a.top,r=wt(e.$el).top,i=e.$el.offsetHeight;e.isFixed&&r+i>=o&&r<=o+t.offsetHeight&&Xt(window,o-i-(O(e.targetOffset)?e.targetOffset:0)-e.offset)})}}}],update:[{read:function(e,t){var a=e.height;this.isActive&&"update"!==t&&(this.hide(),a=this.$el.offsetHeight,this.show()),a=this.isActive?a:this.$el.offsetHeight,this.topOffset=wt(this.isFixed?this.placeholder:this.$el).top,this.bottomOffset=this.topOffset+a;var o=Ba("bottom",this);return this.top=g(F(Ba("top",this)),this.topOffset)-this.offset,this.bottom=o&&o-this.$el.offsetHeight,this.inactive=!this.matchMedia,{lastScroll:!1,height:a,margins:gt(this.$el,["marginTop","marginBottom","marginLeft","marginRight"])}},write:function(e){var t=e.height,a=e.margins,o=this,r=o.placeholder;gt(r,Yo({height:t},a)),we(r,document)||(Ze(this.$el,r),ae(r,"hidden","")),this.isActive=this.isActive},events:["resize"]},{read:function(e){var t=e.scroll;return void 0===t&&(t=0),this.width=wt(_e(this.widthElement)?this.widthElement:this.$el).width,this.scroll=window.pageYOffset,{dir:t<=this.scroll?"down":"up",scroll:this.scroll,visible:_e(this.$el),top:At(this.placeholder)[0]}},write:function(e,t){var a=this,o=e.initTimestamp;void 0===o&&(o=0);var r=e.dir,i=e.lastDir,n=e.lastScroll,l=e.scroll,s=e.top,d=e.visible,c=performance.now();if((e.lastScroll=l,!(0>l||l===n||!d||this.disabled||this.showOnUp&&"scroll"!==t))&&((300<c-o||r!==i)&&(e.initScroll=l,e.initTimestamp=c),e.lastDir=r,!(this.showOnUp&&!this.isFixed&&30>=u(e.initScroll-l)&&10>=u(n-l))))if(this.inactive||l<this.top||this.showOnUp&&(l<=this.top||"down"===r||"up"===r&&!this.isFixed&&l<=this.bottomOffset)){if(!this.isFixed)return void(Er.inProgress(this.$el)&&s>l&&(Er.cancel(this.$el),this.hide()));this.isFixed=!1,this.animation&&l>this.topOffset?(Er.cancel(this.$el),Er.out(this.$el,this.animation).then(function(){return a.hide()},Q)):this.hide()}else this.isFixed?this.update():this.animation?(Er.cancel(this.$el),this.show(),Er.in(this.$el,this.animation).catch(Q)):this.show()},events:["resize","scroll"]}],methods:{show:function(){this.isFixed=!0,this.update(),ae(this.placeholder,"hidden",null)},hide:function(){this.isActive=!1,nt(this.$el,this.clsFixed,this.clsBelow),gt(this.$el,{position:"",top:"",width:""}),ae(this.placeholder,"hidden","")},update:function(){var e=0!==this.top||this.scroll>this.top,t=g(0,this.offset);O(this.bottom)&&this.scroll>this.bottom-this.offset&&(t=this.bottom-this.scroll),gt(this.$el,{position:"fixed",top:t+"px",width:this.width}),this.isActive=e,ct(this.$el,this.clsBelow,this.scroll>this.bottomOffset),it(this.$el,this.clsFixed)}}},Ei={mixins:[Vr],args:"connect",props:{connect:String,toggle:String,active:Number,swiping:Boolean},data:{connect:"~.uk-switcher",toggle:"> * > :first-child",active:0,swiping:!0,cls:"uk-active",clsContainer:"uk-switcher",attrItem:"uk-switcher-item",queued:!0},computed:{connects:{get:function(e,t){var a=e.connect;return le(a,t)},watch:function(e){var t=this;e.forEach(function(e){return t.updateAria(e.children)}),this.swiping&&gt(e,"touch-action","pan-y pinch-zoom")},immediate:!0},toggles:{get:function(e,t){var a=e.toggle;return $(a,t).filter(function(e){return!me(e,".uk-disabled *, .uk-disabled, [disabled]")})},watch:function(e){var t=this.index();this.show(~t&&t||e[this.active]||e[0])},immediate:!0}},events:[{name:"click",delegate:function(){return this.toggle},handler:function(t){b(this.toggles,t.current)&&(t.preventDefault(),this.show(t.current))}},{name:"click",el:function(){return this.connects},delegate:function(){return"["+this.attrItem+"],[data-"+this.attrItem+"]"},handler:function(t){t.preventDefault(),this.show(ie(t.current,this.attrItem))}},{name:"swipeRight swipeLeft",filter:function(){return this.swiping},el:function(){return this.connects},handler:function(e){var t=e.type;this.show(_(t,"Left")?"next":"previous")}},{name:"show",el:function(){return this.connects},handler:function(){var e=this,t=this.index();this.toggles.forEach(function(a,o){ct(Te(e.$el).filter(function(e){return we(a,e)}),e.cls,t===o),ae(a,"aria-expanded",t===o)})}}],methods:{index:function(){return He(Te(this.connects[0],"."+this.cls)[0])},show:function(e){var t=this,a=this.index(),o=qe(e,this.toggles,a);this.connects.forEach(function(e){var r=e.children;return t.toggleElement([r[a],r[o]],void 0,0<=a)})}}},Ii={mixins:[Nr],extends:Ei,props:{media:Boolean},data:{media:960,attrItem:"uk-tab-item"},connected:function(){var e=dt(this.$el,"uk-tab-left")?"uk-tab-left":!!dt(this.$el,"uk-tab-right")&&"uk-tab-right";e&&this.$create("toggle",this.$el,{cls:e,mode:"media",media:this.media})}},Pi={mixins:[fi,Vr],args:"target",props:{href:String,target:null,mode:"list"},data:{href:!1,target:!1,mode:"click",queued:!0},computed:{target:{get:function(e,t){var a=e.href,o=e.target;return o=le(o||a,t),o.length&&o||[t]},watch:function(){Ce(this.target,"updatearia",[this])},immediate:!0}},events:[{name:ar+" "+or,filter:function(){return b(this.mode,"hover")},handler:function(t){je(t)||this.toggle("toggle"+(t.type===ar?"show":"hide"))}},{name:"click",filter:function(){return b(this.mode,"click")||Jo&&b(this.mode,"hover")},handler:function(t){var e;(he(t.target,"a[href=\"#\"], a[href=\"\"]")||(e=he(t.target,"a[href]"))&&(this.cls&&!dt(this.target,this.cls.split(" ")[0])||!_e(this.target)||e.hash&&me(this.target,e.hash)))&&t.preventDefault(),this.toggle()}}],update:{read:function(){return!!(b(this.mode,"media")&&this.media)&&{match:this.matchMedia}},write:function(e){var t=e.match,a=this.isToggled(this.target);(t?!a:a)&&this.toggle()},events:["resize"]},methods:{toggle:function(e){Ce(this.target,e||"toggle",[this])&&this.toggleElement(this.target)}}},zi=Object.freeze({__proto__:null,Accordion:Ur,Alert:Hr,Cover:Gr,Drop:Wr,Dropdown:Wr,FormCustom:Xr,Gif:{update:{read:function(e){var t=Wt(this.$el);return!!(t&&e.isInView!==t)&&void(e.isInView=t)},write:function(){this.$el.src=this.$el.src},events:["scroll","resize"]}},Grid:Kr,HeightMatch:Jr,HeightViewport:Qr,Icon:ii,Img:di,Leader:xi,Margin:Zr,Modal:{install:function(e){function t(e,t,o,r){t=Yo({bgClose:!1,escClose:!0,labels:a.labels},t);var i=a.dialog(e(t),t),n=new hr,l=!1;return Ae(i.$el,"submit","form",function(t){t.preventDefault(),n.resolve(r&&r(i)),l=!0,i.hide()}),Ae(i.$el,"hide",function(){return!l&&o(n)}),n.promise.dialog=i,n.promise}var a=e.modal;a.dialog=function(e,t){var o=a("<div class=\"uk-modal\"> <div class=\"uk-modal-dialog\">"+e+"</div> </div>",t);return o.show(),Ae(o.$el,"hidden",function(){return mr.resolve().then(function(){return o.$destroy(!0)})},{self:!0}),o},a.alert=function(e,a){return t(function(t){var a=t.labels;return"<div class=\"uk-modal-body\">"+(z(e)?e:Ye(e))+"</div> <div class=\"uk-modal-footer uk-text-right\"> <button class=\"uk-button uk-button-primary uk-modal-close\" autofocus>"+a.ok+"</button> </div>"},a,function(e){return e.resolve()})},a.confirm=function(e,a){return t(function(t){var a=t.labels;return"<form> <div class=\"uk-modal-body\">"+(z(e)?e:Ye(e))+"</div> <div class=\"uk-modal-footer uk-text-right\"> <button class=\"uk-button uk-button-default uk-modal-close\" type=\"button\">"+a.cancel+"</button> <button class=\"uk-button uk-button-primary\" autofocus>"+a.ok+"</button> </div> </form>"},a,function(e){return e.reject()})},a.prompt=function(e,a,o){return t(function(t){var o=t.labels;return"<form class=\"uk-form-stacked\"> <div class=\"uk-modal-body\"> <label>"+(z(e)?e:Ye(e))+"</label> <input class=\"uk-input\" value=\""+(a||"")+"\" autofocus> </div> <div class=\"uk-modal-footer uk-text-right\"> <button class=\"uk-button uk-button-default uk-modal-close\" type=\"button\">"+o.cancel+"</button> <button class=\"uk-button uk-button-primary\">"+o.ok+"</button> </div> </form>"},o,function(e){return e.resolve(null)},function(e){return ot("input",e.$el).value})},a.labels={ok:"Ok",cancel:"Cancel"}},mixins:[vi],data:{clsPage:"uk-modal-page",selPanel:".uk-modal-dialog",selClose:".uk-modal-close, .uk-modal-close-default, .uk-modal-close-outside, .uk-modal-close-full"},events:[{name:"show",self:!0,handler:function(){dt(this.panel,"uk-margin-auto-vertical")?it(this.$el,"uk-flex"):gt(this.$el,"display","block"),Pr(this.$el)}},{name:"hidden",self:!0,handler:function(){gt(this.$el,"display",""),nt(this.$el,"uk-flex")}}]},Nav:{extends:Ur,data:{targets:"> .uk-parent",toggle:"> a",content:"> ul"}},Navbar:wi,Offcanvas:ki,OverflowAuto:Ti,Responsive:{props:["width","height"],connected:function(){it(this.$el,"uk-responsive-width")},update:{read:function(){return!!(_e(this.$el)&&this.width&&this.height)&&{width:zr(this.$el.parentNode),height:this.height}},write:function(e){Pr(this.$el,Wo.contain({height:this.height,width:this.width},e).height)},events:["resize"]}},Scroll:Ai,Scrollspy:Si,ScrollspyNav:Ci,Sticky:Li,Svg:ei,Switcher:Ei,Tab:Ii,Toggle:Pi,Video:qr,Close:{extends:ni,computed:{icon:function(){return"close-"+(dt(this.$el,"uk-close-large")?"large":"icon")}}},Spinner:{extends:ni,connected:function(){var e=this;this.svg.then(function(t){return 1!==e.ratio&&gt(ot("circle",t),"strokeWidth",1/e.ratio)},Q)}},SlidenavNext:li,SlidenavPrevious:li,SearchIcon:{extends:ni,computed:{icon:function(e,t){var a=e.icon;return dt(t,"uk-search-icon")&&ke(t,".uk-search-large").length?"search-large":ke(t,".uk-search-navbar").length?"search-navbar":a}}},Marker:ni,NavbarToggleIcon:ni,OverlayIcon:ni,PaginationNext:ni,PaginationPrevious:ni,Totop:ni}),Di={mixins:[Nr],props:{date:String,clsWrapper:String},data:{date:"",clsWrapper:".uk-countdown-%unit%"},computed:{date:function(e){var t=e.date;return Date.parse(t)},days:function(e,t){var a=e.clsWrapper;return ot(a.replace("%unit%","days"),t)},hours:function(e,t){var a=e.clsWrapper;return ot(a.replace("%unit%","hours"),t)},minutes:function(e,t){var a=e.clsWrapper;return ot(a.replace("%unit%","minutes"),t)},seconds:function(e,t){var a=e.clsWrapper;return ot(a.replace("%unit%","seconds"),t)},units:function(){var e=this;return["days","hours","minutes","seconds"].filter(function(t){return e[t]})}},connected:function(){this.start()},disconnected:function(){var e=this;this.stop(),this.units.forEach(function(t){return Ge(e[t])})},events:[{name:"visibilitychange",el:document,handler:function(){document.hidden?this.stop():this.start()}}],update:{write:function(){var e=this,t=Fa(this.date);0>=t.total&&(this.stop(),t.days=t.hours=t.minutes=t.seconds=0),this.units.forEach(function(a){var o=m(t[a])+"";o=2>o.length?"0"+o:o;var r=e[a];r.textContent!==o&&(o=o.split(""),o.length!==r.children.length&&Ye(r,o.map(function(){return"<span></span>"}).join("")),o.forEach(function(e,t){return r.children[t].textContent=e}))})}},methods:{start:function(){this.stop(),this.date&&this.units.length&&(this.$update(),this.timer=setInterval(this.$update,1e3))},stop:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}}},Oi={props:{animation:Number},data:{animation:150},computed:{target:function(){return this.$el}},methods:{animate:function(e){var t=this;Ha();var a=Te(this.target),o=a.map(function(e){return Na(e,!0)}),r=Pr(this.target),i=window.pageYOffset;e(),Cr.cancel(this.target),a.forEach(Cr.cancel),Va(this.target),this.$update(this.target,"resize"),Dr.flush();var n=Pr(this.target);a=a.concat(Te(this.target).filter(function(e){return!b(a,e)}));var l=a.map(function(e,t){return!!(e.parentNode&&t in o)&&(o[t]?_e(e)?Ua(e):{opacity:0}:{opacity:_e(e)?1:0})});return o=l.map(function(e,r){var i=a[r].parentNode===t.target&&(o[r]||Na(a[r]));if(i)if(!e)delete i.opacity;else if(!("opacity"in e)){var n=i.opacity;n%1?e.opacity=1:delete i.opacity}return i}),it(this.target,"uk-animation-target"),a.forEach(function(e,t){return o[t]&&gt(e,o[t])}),gt(this.target,{height:r,display:"block"}),Xt(window,i),mr.all(a.map(function(e,a){return["top","left","height","width"].some(function(e){return o[a][e]!==l[a][e]})&&Cr.start(e,l[a],t.animation,"ease")}).concat(r!==n&&Cr.start(this.target,{height:n},this.animation,"ease"))).then(function(){a.forEach(function(e,t){return gt(e,{display:0===l[t].opacity?"none":"",zIndex:""})}),Va(t.target),t.$update(t.target,"resize"),Dr.flush()},Q)}}},Ri={mixins:[Oi],args:"target",props:{target:Boolean,selActive:Boolean},data:{target:null,selActive:!1,attrItem:"uk-filter-control",cls:"uk-active",animation:250},computed:{toggles:{get:function(e,t){e.attrItem;return $("["+this.attrItem+"],[data-"+this.attrItem+"]",t)},watch:function(){var e=this;if(this.updateState(),!1!==this.selActive){var t=$(this.selActive,this.$el);this.toggles.forEach(function(a){return ct(a,e.cls,b(t,a))})}},immediate:!0},target:function(e,t){var a=e.target;return ot(a,t)},children:{get:function(){return Te(this.target)},watch:function(e,t){Wa(e,t)||this.updateState()}}},events:[{name:"click",delegate:function(){return"["+this.attrItem+"],[data-"+this.attrItem+"]"},handler:function(t){t.preventDefault(),this.apply(t.current)}}],methods:{apply:function(e){this.setState(Ga(e,this.attrItem,this.getState()))},getState:function(){var e=this;return this.toggles.filter(function(t){return dt(t,e.cls)}).reduce(function(t,a){return Ga(a,e.attrItem,t)},{filter:{"":""},sort:[]})},setState:function(e,t){var a=this;void 0===t&&(t=!0),e=Yo({filter:{"":""},sort:[]},e),Ce(this.$el,"beforeFilter",[this,e]);var o=this,r=o.children;this.toggles.forEach(function(t){return ct(t,a.cls,!!Ya(t,a.attrItem,e))});var i=function(){var t=Xa(e);r.forEach(function(e){return gt(e,"display",t&&!me(e,t)?"none":"")});var o=e.sort,i=o[0],n=o[1];if(i){var l=Za(r,i,n);G(l,r)||l.forEach(function(e){return We(a.target,e)})}};t?this.animate(i).then(function(){return Ce(a.$el,"afterFilter",[a])}):(i(),Ce(this.$el,"afterFilter",[this]))},updateState:function(){var e=this;Dr.write(function(){return e.setState(e.getState(),!1)})}}},Mi={slide:{show:function(e){return[{transform:$a(-100*e)},{transform:$a()}]},percent:function(e){return Ka(e)},translate:function(e,t){return[{transform:$a(-100*t*e)},{transform:$a(100*t*(1-e))}]}}},ji=Yo({},Mi,{fade:{show:function(){return[{opacity:0},{opacity:1}]},percent:function(e){return 1-gt(e,"opacity")},translate:function(e){return[{opacity:1-e},{opacity:e}]}},scale:{show:function(){return[{opacity:0,transform:Ja(1-.2)},{opacity:1,transform:Ja(1)}]},percent:function(e){return 1-gt(e,"opacity")},translate:function(e){return[{opacity:1-e,transform:Ja(1-.2*e)},{opacity:e,transform:Ja(1-.2+.2*e)}]}}}),Bi={props:{autoplay:Boolean,autoplayInterval:Number,pauseOnHover:Boolean},data:{autoplay:!1,autoplayInterval:7e3,pauseOnHover:!0},connected:function(){this.autoplay&&this.startAutoplay()},disconnected:function(){this.stopAutoplay()},update:function(){ae(this.slides,"tabindex","-1")},events:[{name:"visibilitychange",el:document,filter:function(){return this.autoplay},handler:function(){document.hidden?this.stopAutoplay():this.startAutoplay()}}],methods:{startAutoplay:function(){var e=this;this.stopAutoplay(),this.interval=setInterval(function(){return(!e.draggable||!ot(":focus",e.$el))&&(!e.pauseOnHover||!me(e.$el,":hover"))&&!e.stack.length&&e.show("next")},this.autoplayInterval)},stopAutoplay:function(){this.interval&&clearInterval(this.interval)}}},Fi={props:{draggable:Boolean},data:{draggable:!0,threshold:10},created:function(){var t=this;["start","move","end"].forEach(function(e){var a=t[e];t[e]=function(o){var e=Be(o).x*(Zo?-1:1);t.prevPos=e===t.pos?t.prevPos:t.pos,t.pos=e,a(o)}})},events:[{name:Qo,delegate:function(){return this.selSlides},handler:function(t){!this.draggable||!je(t)&&eo(t.target)||he(t.target,gr)||0<t.button||2>this.length||this.start(t)}},{name:"touchmove",passive:!1,handler:"move",filter:function(){return"touchmove"===er},delegate:function(){return this.selSlides}},{name:"dragstart",handler:function(t){t.preventDefault()}}],methods:{start:function(){var e=this;this.drag=this.pos,this._transitioner?(this.percent=this._transitioner.percent(),this.drag+=this._transitioner.getDistance()*this.percent*this.dir,this._transitioner.cancel(),this._transitioner.translate(this.percent),this.dragging=!0,this.stack=[]):this.prevIndex=this.index;var t="touchmove"===er?Q:Ae(document,er,this.move,{passive:!1});this.unbindMove=function(){t(),e.unbindMove=null},Ae(window,"scroll",this.unbindMove),Ae(window.visualViewport,"resize",this.unbindMove),Ae(document,tr+" "+rr,this.end,!0),gt(this.list,"userSelect","none")},move:function(t){var e=this;if(this.unbindMove){var a=this.pos-this.drag;if(0!=a&&this.prevPos!==this.pos&&(this.dragging||!(u(a)<this.threshold))){gt(this.list,"pointerEvents","none"),t.cancelable&&t.preventDefault(),this.dragging=!0,this.dir=0>a?1:-1;for(var o=this,r=o.slides,i=this,n=i.prevIndex,l=u(a),s=this.getIndex(n+this.dir,n),d=this._getDistance(n,s)||r[n].offsetWidth;s!==n&&l>d;)this.drag-=d*this.dir,n=s,l-=d,s=this.getIndex(n+this.dir,n),d=this._getDistance(n,s)||r[n].offsetWidth;this.percent=l/d;var c=r[n],p=r[s],g=this.index!==s,m=n===s,h;[this.index,this.prevIndex].filter(function(e){return!b([s,n],e)}).forEach(function(t){Ce(r[t],"itemhidden",[e]),m&&(h=!0,e.prevIndex=n)}),(this.index===n&&this.prevIndex!==n||h)&&Ce(r[this.index],"itemshown",[this]),g&&(this.prevIndex=n,this.index=s,!m&&Ce(c,"beforeitemhide",[this]),Ce(p,"beforeitemshow",[this])),this._transitioner=this._translate(u(this.percent),c,!m&&p),g&&(!m&&Ce(c,"itemhide",[this]),Ce(p,"itemshow",[this]))}}},end:function(){if(x(window,"scroll",this.unbindMove),x(window.visualViewport,"resize",this.unbindMove),this.unbindMove&&this.unbindMove(),x(document,tr,this.end,!0),this.dragging)if(this.dragging=null,this.index===this.prevIndex)this.percent=1-this.percent,this.dir*=-1,this._show(!1,this.index,!0),this._transitioner=null;else{var e=0>(Zo?this.dir*(Zo?1:-1):this.dir)==this.prevPos>this.pos;this.index=e?this.index:this.prevIndex,e&&(this.percent=1-this.percent),this.show(0<this.dir&&!e||0>this.dir&&e?"next":"previous",!0)}gt(this.list,{userSelect:"",pointerEvents:""}),this.drag=this.percent=null}}},Ni={mixins:[Bi,Fi,{data:{selNav:!1},computed:{nav:function(e,t){var a=e.selNav;return ot(a,t)},selNavItem:function(e){var t=e.attrItem;return"["+t+"],[data-"+t+"]"},navItems:function(e,t){return $(this.selNavItem,t)}},update:{write:function(){var e=this;this.nav&&this.length!==this.nav.children.length&&Ye(this.nav,this.slides.map(function(t,a){return"<li "+e.attrItem+"=\""+a+"\"><a href></a></li>"}).join("")),ct($(this.selNavItem,this.$el).concat(this.nav),"uk-hidden",!this.maxIndex),this.updateNav()},events:["resize"]},events:[{name:"click",delegate:function(){return this.selNavItem},handler:function(t){t.preventDefault(),this.show(ie(t.current,this.attrItem))}},{name:"itemshow",handler:"updateNav"}],methods:{updateNav:function(){var e=this,t=this.getValidIndex();this.navItems.forEach(function(a){var o=ie(a,e.attrItem);ct(a,e.clsActive,B(o)===t),ct(a,"uk-invisible",e.finite&&("previous"===o&&0===t||"next"===o&&t>=e.maxIndex))})}}}],props:{clsActivated:Boolean,easing:String,index:Number,finite:Boolean,velocity:Number,selSlides:String},data:function(){return{easing:"ease",finite:!1,velocity:1,index:0,prevIndex:-1,stack:[],percent:0,clsActive:"uk-active",clsActivated:!1,Transitioner:!1,transitionOptions:{}}},connected:function(){this.prevIndex=-1,this.index=this.getValidIndex(this.index),this.stack=[]},disconnected:function(){nt(this.slides,this.clsActive)},computed:{duration:function(e,t){var a=e.velocity;return ao(t.offsetWidth/a)},list:function(e,t){var a=e.selList;return ot(a,t)},maxIndex:function(){return this.length-1},selSlides:function(e){var t=e.selList,a=e.selSlides;return t+" "+(a||"> *")},slides:{get:function(){return $(this.selSlides,this.$el)},watch:function(){this.$reset()}},length:function(){return this.slides.length}},events:{itemshown:function(){this.$update(this.list)}},methods:{show:function(e,t){var a=this;if(void 0===t&&(t=!1),!this.dragging&&this.length){var o=this,r=o.stack,i=t?0:r.length,n=function(){r.splice(i,1),r.length&&a.show(r.shift(),!0)};if(r[t?"unshift":"push"](e),!t&&1<r.length)return void(2===r.length&&this._transitioner.forward(d(this.duration,200)));var l=this.getIndex(this.index),s=dt(this.slides,this.clsActive)&&this.slides[l],c=this.getIndex(e,this.index),p=this.slides[c];if(s===p)return void n();if(this.dir=to(e,l),this.prevIndex=l,this.index=c,s&&!Ce(s,"beforeitemhide",[this])||!Ce(p,"beforeitemshow",[this,s]))return this.index=this.prevIndex,void n();var u=this._show(s,p,t).then(function(){return s&&Ce(s,"itemhidden",[a]),Ce(p,"itemshown",[a]),new mr(function(e){Dr.write(function(){r.shift(),r.length?a.show(r.shift(),!0):a._transitioner=null,e()})})});return s&&Ce(s,"itemhide",[this]),Ce(p,"itemshow",[this]),u}},getIndex:function(e,t){return void 0===e&&(e=this.index),void 0===t&&(t=this.index),J(qe(e,this.slides,t,this.finite),0,this.maxIndex)},getValidIndex:function(e,t){return void 0===e&&(e=this.index),void 0===t&&(t=this.prevIndex),this.getIndex(e,t)},_show:function(e,t,a){if(this._transitioner=this._getTransitioner(e,t,this.dir,Yo({easing:a?600>t.offsetWidth?"cubic-bezier(0.25, 0.46, 0.45, 0.94)":"cubic-bezier(0.165, 0.84, 0.44, 1)":this.easing},this.transitionOptions)),!a&&!e)return this._translate(1),mr.resolve();var o=this.stack,r=o.length;return this._transitioner[1<r?"forward":"show"](1<r?d(this.duration,75+75/(r-1)):this.duration,this.percent)},_getDistance:function(e,t){return this._getTransitioner(e,e!==t&&t).getDistance()},_translate:function(e,t,a){void 0===t&&(t=this.prevIndex),void 0===a&&(a=this.index);var o=this._getTransitioner(t!==a&&t,a);return o.translate(e),o},_getTransitioner:function(e,t,a,o){return void 0===e&&(e=this.prevIndex),void 0===t&&(t=this.index),void 0===a&&(a=this.dir||1),void 0===o&&(o=this.transitionOptions),new this.Transitioner(D(e)?this.slides[e]:e,D(t)?this.slides[t]:t,a*(Zo?-1:1),o)}}},Vi={mixins:[Ni],props:{animation:String},data:{animation:"slide",clsActivated:"uk-transition-active",Animations:Mi,Transitioner:function(e,t,a,o){var r=o.animation,i=o.easing,n=r.percent,s=r.translate,d=r.show;void 0===d&&(d=Q);var c=d(a),p=new hr;return{dir:a,show:function(o,r,n){var s=this;void 0===r&&(r=0);var d=n?"linear":i;return o-=l(o*J(r,-1,1)),this.translate(r),Qa(t,"itemin",{percent:r,duration:o,timing:d,dir:a}),Qa(e,"itemout",{percent:1-r,duration:o,timing:d,dir:a}),mr.all([Cr.start(t,c[1],o,d),Cr.start(e,c[0],o,d)]).then(function(){s.reset(),p.resolve()},Q),p.promise},stop:function(){return Cr.stop([t,e])},cancel:function(){Cr.cancel([t,e])},reset:function(){for(var a in c[0])gt([t,e],a,"")},forward:function(a,o){return void 0===o&&(o=this.percent()),Cr.cancel([t,e]),this.show(a,o,!0)},translate:function(o){this.reset();var r=s(o,a);gt(t,r[1]),gt(e,r[0]),Qa(t,"itemtranslatein",{percent:o,dir:a}),Qa(e,"itemtranslateout",{percent:1-o,dir:a})},percent:function(){return n(e||t,t,a)},getDistance:function(){return e&&e.offsetWidth}}}},computed:{animation:function(e){var t=e.animation,a=e.Animations;return Yo(a[t]||a.slide,{name:t})},transitionOptions:function(){return{animation:this.animation}}},events:{"itemshow itemhide itemshown itemhidden":function(e){var t=e.target;this.$update(t)},beforeitemshow:function(e){var t=e.target;it(t,this.clsActive)},itemshown:function(e){var t=e.target;it(t,this.clsActivated)},itemhidden:function(e){var t=e.target;nt(t,this.clsActive,this.clsActivated)}}},Ui={mixins:[_i,vi,Vr,Vi],functional:!0,props:{delayControls:Number,preload:Number,videoAutoplay:Boolean,template:String},data:function(){return{preload:1,videoAutoplay:!1,delayControls:3e3,items:[],cls:"uk-open",clsPage:"uk-lightbox-page",selList:".uk-lightbox-items",attrItem:"uk-lightbox-item",selClose:".uk-close-large",selCaption:".uk-lightbox-caption",pauseOnHover:!1,velocity:2,Animations:ji,template:"<div class=\"uk-lightbox uk-overflow-hidden\"> <ul class=\"uk-lightbox-items\"></ul> <div class=\"uk-lightbox-toolbar uk-position-top uk-text-right uk-transition-slide-top uk-transition-opaque\"> <button class=\"uk-lightbox-toolbar-icon uk-close-large\" type=\"button\" uk-close></button> </div> <a class=\"uk-lightbox-button uk-position-center-left uk-position-medium uk-transition-fade\" href uk-slidenav-previous uk-lightbox-item=\"previous\"></a> <a class=\"uk-lightbox-button uk-position-center-right uk-position-medium uk-transition-fade\" href uk-slidenav-next uk-lightbox-item=\"next\"></a> <div class=\"uk-lightbox-toolbar uk-lightbox-caption uk-position-bottom uk-text-center uk-transition-slide-bottom uk-transition-opaque\"></div> </div>"}},created:function(){var e=ot(this.template),t=ot(this.selList,e);this.items.forEach(function(){return We(t,"<li>")}),this.$mount(We(this.container,e))},computed:{caption:function(e,t){e.selCaption;return ot(".uk-lightbox-caption",t)}},events:[{name:er+" "+Qo+" keydown",handler:"showControls"},{name:"click",self:!0,delegate:function(){return this.selSlides},handler:function(t){t.defaultPrevented||this.hide()}},{name:"shown",self:!0,handler:function(){this.showControls()}},{name:"hide",self:!0,handler:function(){this.hideControls(),nt(this.slides,this.clsActive),Cr.stop(this.slides)}},{name:"hidden",self:!0,handler:function(){this.$destroy(!0)}},{name:"keyup",el:document,handler:function(t){if(this.isToggled(this.$el)&&this.draggable)switch(t.keyCode){case 37:this.show("previous");break;case 39:this.show("next");}}},{name:"beforeitemshow",handler:function(t){this.isToggled()||(this.draggable=!1,t.preventDefault(),this.toggleElement(this.$el,!0,!1),this.animation=ji.scale,nt(t.target,this.clsActive),this.stack.splice(1,0,this.index))}},{name:"itemshow",handler:function(){Ye(this.caption,this.getItem().caption||"");for(var e=-this.preload;e<=this.preload;e++)this.loadItem(this.index+e)}},{name:"itemshown",handler:function(){this.draggable=this.$props.draggable}},{name:"itemload",handler:function(e,t){var a=this,o=t.source,r=t.type,i=t.alt;void 0===i&&(i="");var n=t.poster,l=t.attrs;if(void 0===l&&(l={}),this.setItem(t,"<span uk-spinner></span>"),!!o){var s={frameborder:"0",allow:"autoplay",allowfullscreen:"",style:"max-width: 100%; box-sizing: border-box;","uk-responsive":"","uk-video":""+this.videoAutoplay},d;if("image"===r||o.match(/\.(jpe?g|png|gif|svg|webp)($|\?)/i))Ve(o,l.srcset,l.size).then(function(e){var r=e.width,n=e.height;return a.setItem(t,oo("img",Yo({src:o,width:r,height:n,alt:i},l)))},function(){return a.setError(t)});else if("video"===r||o.match(/\.(mp4|webm|ogv)($|\?)/i)){var c=oo("video",Yo({src:o,poster:n,controls:"",playsinline:"","uk-video":""+this.videoAutoplay},l));Ae(c,"loadedmetadata",function(){ae(c,{width:c.videoWidth,height:c.videoHeight}),a.setItem(t,c)}),Ae(c,"error",function(){return a.setError(t)})}else"iframe"===r||o.match(/\.(html|php)($|\?)/i)?this.setItem(t,oo("iframe",Yo({src:o,frameborder:"0",allowfullscreen:"",class:"uk-lightbox-iframe"},l))):(d=o.match(/\/\/(?:.*?youtube(-nocookie)?\..*?[?&]v=|youtu\.be\/)([\w-]{11})[&?]?(.*)?/))?this.setItem(t,oo("iframe",Yo({src:"https://www.youtube"+(d[1]||"")+".com/embed/"+d[2]+(d[3]?"?"+d[3]:""),width:1920,height:1080},s,l))):(d=o.match(/\/\/.*?vimeo\.[a-z]+\/(\d+)[&?]?(.*)?/))&&Ne("https://vimeo.com/api/oembed.json?maxwidth=1920&url="+encodeURI(o),{responseType:"json",withCredentials:!1}).then(function(e){var o=e.response,r=o.height,i=o.width;return a.setItem(t,oo("iframe",Yo({src:"https://player.vimeo.com/video/"+d[1]+(d[2]?"?"+d[2]:""),width:i,height:r},s,l)))},function(){return a.setError(t)})}}}],methods:{loadItem:function(e){void 0===e&&(e=this.index);var t=this.getItem(e);this.getSlide(t).childElementCount||Ce(this.$el,"itemload",[t])},getItem:function(e){return void 0===e&&(e=this.index),this.items[qe(e,this.slides)]},setItem:function(e,t){Ce(this.$el,"itemloaded",[this,Ye(this.getSlide(e),t)])},getSlide:function(e){return this.slides[this.items.indexOf(e)]},setError:function(e){this.setItem(e,"<span uk-icon=\"icon: bolt; ratio: 2\"></span>")},showControls:function(){clearTimeout(this.controlsTimer),this.controlsTimer=setTimeout(this.hideControls,this.delayControls),it(this.$el,"uk-active","uk-transition-active")},hideControls:function(){nt(this.$el,"uk-active","uk-transition-active")}}},Hi={install:function(e,t){e.lightboxPanel||e.component("lightboxPanel",Ui),Yo(t.props,e.component("lightboxPanel").options.props)},props:{toggle:String},data:{toggle:"a"},computed:{toggles:{get:function(e,t){var a=e.toggle;return $(a,t)},watch:function(){this.hide()}}},disconnected:function(){this.hide()},events:[{name:"click",delegate:function(){return this.toggle+":not(.uk-disabled)"},handler:function(t){t.preventDefault(),this.show(t.current)}}],methods:{show:function(e){var t=this,a=K(this.toggles.map(ro),"source");if(E(e)){var o=ro(e),r=o.source;e=v(a,function(e){var t=e.source;return r===t})}return this.panel=this.panel||this.$create("lightboxPanel",Yo({},this.$props,{items:a})),Ae(this.panel.$el,"hidden",function(){return t.panel=!1}),this.panel.show(e)},hide:function(){return this.panel&&this.panel.hide()}}},qi={functional:!0,args:["message","status"],data:{message:"",status:"",timeout:5e3,group:null,pos:"top-center",clsContainer:"uk-notification",clsClose:"uk-notification-close",clsMsg:"uk-notification-message"},install:function(e){e.notification.closeAll=function(t,a){at(document.body,function(o){var r=e.getComponent(o,"notification");r&&(!t||t===r.group)&&r.close(a)})}},computed:{marginProp:function(e){var t=e.pos;return"margin"+(f(t,"top")?"Top":"Bottom")},startProps:function(){var e;return e={opacity:0},e[this.marginProp]=-this.$el.offsetHeight,e}},created:function(){var e=ot("."+this.clsContainer+"-"+this.pos,this.$container)||We(this.$container,"<div class=\""+this.clsContainer+" "+this.clsContainer+"-"+this.pos+"\" style=\"display: block\"></div>");this.$mount(We(e,"<div class=\""+this.clsMsg+(this.status?" "+this.clsMsg+"-"+this.status:"")+"\"> <a href class=\""+this.clsClose+"\" data-uk-close></a> <div>"+this.message+"</div> </div>"))},connected:function(){var e=this,t=F(gt(this.$el,this.marginProp)),a;Cr.start(gt(this.$el,this.startProps),(a={opacity:1},a[this.marginProp]=t,a)).then(function(){e.timeout&&(e.timer=setTimeout(e.close,e.timeout))})},events:(nn={click:function(t){he(t.target,"a[href=\"#\"],a[href=\"\"]")&&t.preventDefault(),this.close()}},nn[ar]=function(){this.timer&&clearTimeout(this.timer)},nn[or]=function(){this.timeout&&(this.timer=setTimeout(this.close,this.timeout))},nn),methods:{close:function(e){var t=this,a=function(){var e=t.$el.parentNode;Ce(t.$el,"close",[t]),$e(t.$el),e&&!e.hasChildNodes()&&$e(e)};this.timer&&clearTimeout(this.timer),e?a():Cr.start(this.$el,this.startProps).then(a)}}},Gi=["x","y","bgx","bgy","rotate","scale","color","backgroundColor","borderColor","opacity","blur","hue","grayscale","invert","saturate","sepia","fopacity","stroke"],Yi={mixins:[fi],props:Gi.reduce(function(e,t){return e[t]="list",e},{}),data:Gi.reduce(function(e,t){return e[t]=void 0,e},{}),computed:{props:function(e,t){var a=this;return Gi.reduce(function(o,r){if(M(e[r]))return o;var i=r.match(/color/i),n=i||"opacity"===r,l=e[r].slice(0),s,c,p;n&&gt(t,r,""),2>l.length&&l.unshift(("scale"===r?1:n?gt(t,r):0)||0);var u=so(l);if(i){var m=t.style,h=m.color;l=l.map(function(e){return io(t,e)}),t.style.color=h}else if(f(r,"bg")){var y="bgy"===r?"height":"width";if(l=l.map(function(e){return zt(e,y,a.$el)}),gt(t,"background-position-"+r[2],""),c=gt(t,"backgroundPosition").split(" ")["x"===r[2]?0:1],a.covers){var x=d.apply(Math,l),_=g.apply(Math,l),b=l.indexOf(x)<l.indexOf(_);p=_-x,l=l.map(function(e){return e-(b?x:_)}),s=(b?-p:0)+"px"}else s=c}else l=l.map(F);if("stroke"===r){if(!l.some(function(e){return e}))return o;var v=va(a.$el);gt(t,"strokeDasharray",v),"%"===u&&(l=l.map(function(e){return e*v/100})),l=l.reverse(),r="strokeDashoffset"}return o[r]={steps:l,unit:u,pos:s,bgPos:c,diff:p},o},{})},bgProps:function(){var e=this;return["bgx","bgy"].filter(function(t){return t in e.props})},covers:function(e,t){return co(t)}},disconnected:function(){delete this._image},update:{read:function(e){var t=this;if(e.active=this.matchMedia,!!e.active){if(!e.image&&this.covers&&this.bgProps.length){var a=gt(this.$el,"backgroundImage").replace(/^none|url\(["']?(.+?)["']?\)$/,"$1");if(a){var o=new Image;o.src=a,e.image=o,o.naturalWidth||(o.onload=function(){return t.$update()})}}var r=e.image;if(r&&r.naturalWidth){var i={width:this.$el.offsetWidth,height:this.$el.offsetHeight},n={width:r.naturalWidth,height:r.naturalHeight},l=Wo.cover(n,i);this.bgProps.forEach(function(e){var a=t.props[e],o=a.diff,r=a.bgPos,s=a.steps,d="bgy"===e?"height":"width",c=l[d]-i[d];if(c<o)i[d]=l[d]+o-c;else if(c>o){var p=i[d]/zt(r,d,t.$el);p&&(t.props[e].steps=s.map(function(e){return e-(c-o)/p}))}l=Wo.cover(n,i)}),e.dim=l}}},write:function(e){var t=e.dim,a=e.active;return a?void(t&&gt(this.$el,{backgroundSize:t.width+"px "+t.height+"px",backgroundRepeat:"no-repeat"})):void gt(this.$el,{backgroundSize:"",backgroundRepeat:""})},events:["resize"]},methods:{reset:function(){var e=this;X(this.getCss(0),function(t,a){return gt(e.$el,a,"")})},getCss:function(e){var t=this,a=t.props;return Object.keys(a).reduce(function(t,o){var r=a[o],i=r.steps,n=r.unit,l=r.pos,s=lo(i,e);switch(o){case"x":case"y":{n=n||"px",t.transform+=" translate"+y(o)+"("+F(s).toFixed("px"===n?0:2)+n+")";break}case"rotate":n=n||"deg",t.transform+=" rotate("+(s+n)+")";break;case"scale":t.transform+=" scale("+s+")";break;case"bgy":case"bgx":t["background-position-"+o[2]]="calc("+l+" + "+s+"px)";break;case"color":case"backgroundColor":case"borderColor":{var d=no(i,e),c=d[0],u=d[1],g=d[2];t[o]="rgba("+c.map(function(e,t){return e+=g*(u[t]-e),3===t?F(e):parseInt(e,10)}).join(",")+")";break}case"blur":n=n||"px",t.filter+=" blur("+(s+n)+")";break;case"hue":n=n||"deg",t.filter+=" hue-rotate("+(s+n)+")";break;case"fopacity":n=n||"%",t.filter+=" opacity("+(s+n)+")";break;case"grayscale":case"invert":case"saturate":case"sepia":n=n||"%",t.filter+=" "+o+"("+(s+n)+")";break;default:t[o]=s;}return t},{transform:"",filter:""})}}},Wi={mixins:[Yi],props:{target:String,viewport:Number,easing:Number},data:{target:!1,viewport:1,easing:1},computed:{target:function(e,t){var a=e.target;return uo(a&&ne(a,t)||t)}},update:{read:function(e,t){var a=e.percent,o=e.active;if("scroll"!==t&&(a=!1),!!o){var r=a;return a=po(Kt(this.target)/(this.viewport||1),this.easing),{percent:a,style:r!==a&&this.getCss(a)}}},write:function(e){var t=e.style,a=e.active;return a?void(t&&gt(this.$el,t)):void this.reset()},events:["scroll","resize"]}},Xi={update:{write:function(){if(!(this.stack.length||this.dragging)){var e=this.getValidIndex(this.index);~this.prevIndex&&this.index===e||this.show(e)}},events:["resize"]}},Zi={mixins:[Nr,Ni,Xi],props:{center:Boolean,sets:Boolean},data:{center:!1,sets:!1,attrItem:"uk-slider-item",selList:".uk-slider-items",selNav:".uk-slider-nav",clsContainer:"uk-slider-container",Transitioner:function(e,t,a,o){var r=o.center,i=o.easing,n=o.list,s=new hr,d=e?go(e,n,r):go(t,n,r)+wt(t).width*a,c=t?go(t,n,r):d+wt(e).width*a*(Zo?-1:1);return{dir:a,show:function(t,o,r){void 0===o&&(o=0);var d=r?"linear":i;return t-=l(t*J(o,-1,1)),this.translate(o),e&&this.updateTranslates(),o=e?o:J(o,0,1),_o(this.getItemIn(),"itemin",{percent:o,duration:t,timing:d,dir:a}),e&&_o(this.getItemIn(!0),"itemout",{percent:1-o,duration:t,timing:d,dir:a}),Cr.start(n,{transform:$a(-c*(Zo?-1:1),"px")},t,d).then(s.resolve,Q),s.promise},stop:function(){return Cr.stop(n)},cancel:function(){Cr.cancel(n)},reset:function(){gt(n,"transform","")},forward:function(e,t){return void 0===t&&(t=this.percent()),Cr.cancel(n),this.show(e,t,!0)},translate:function(t){var o=this.getDistance()*a*(Zo?-1:1);gt(n,"transform",$a(J(-c+(o-o*t),-ho(n),wt(n).width)*(Zo?-1:1),"px")),this.updateTranslates(),e&&(t=J(t,-1,1),_o(this.getItemIn(),"itemtranslatein",{percent:t,dir:a}),_o(this.getItemIn(!0),"itemtranslateout",{percent:1-t,dir:a}))},percent:function(){return u((gt(n,"transform").split(",")[4]*(Zo?-1:1)+d)/(c-d))},getDistance:function(){return u(c-d)},getItemIn:function(t){void 0===t&&(t=!1);var o=this.getActives(),r=Z(bo(n),"offsetLeft"),l=He(r,o[0<a*(t?-1:1)?o.length-1:0]);return~l&&r[l+(e&&!t?a:0)]},getActives:function(){var a=go(e||t,n,r);return Z(bo(n).filter(function(e){var t=xo(e,n);return t>=a&&t+wt(e).width<=wt(n).width+a}),"offsetLeft")},updateTranslates:function(){var e=this.getActives();bo(n).forEach(function(a){var o=b(e,a);_o(a,"itemtranslate"+(o?"in":"out"),{percent:o?1:0,dir:a.offsetLeft<=t.offsetLeft?1:-1})})}}}},computed:{avgWidth:function(){return ho(this.list)/this.length},finite:function(e){var t=e.finite;return t||n(ho(this.list))<wt(this.list).width+yo(this.list)+this.center},maxIndex:function(){if(!this.finite||this.center&&!this.sets)return this.length-1;if(this.center)return W(this.sets);gt(this.slides,"order","");for(var e=mo(this.list),t=this.length;t--;)if(xo(this.list.children[t],this.list)<e)return d(t+1,this.length-1);return 0},sets:function(e){var t=this,a=e.sets,o=wt(this.list).width/(this.center?2:1),r=0,n=o,l=0;return a=a&&this.slides.reduce(function(e,a,s){var d=wt(a),c=d.width,p=l+c;if(p>r&&(!t.center&&s>t.maxIndex&&(s=t.maxIndex),!b(e,s))){var u=t.slides[s+1];t.center&&u&&c<n-wt(u).width/2?n-=c:(n=o,e.push(s),r=l+o+(t.center?c/2:0))}return l+=c,e},[]),!R(a)&&a},transitionOptions:function(){return{center:this.center,list:this.list}}},connected:function(){ct(this.$el,this.clsContainer,!ot("."+this.clsContainer,this.$el))},update:{write:function(){var e=this;$("["+this.attrItem+"],[data-"+this.attrItem+"]",this.$el).forEach(function(t){var a=ie(t,e.attrItem);e.maxIndex&&ct(t,"uk-hidden",O(a)&&(e.sets&&!b(e.sets,F(a))||a>e.maxIndex))}),!this.length||this.dragging||this.stack.length||this._translate(1)},events:["resize"]},events:{beforeitemshow:function(t){!this.dragging&&this.sets&&2>this.stack.length&&!b(this.sets,this.index)&&(this.index=this.getValidIndex());var e=u(this.index-this.prevIndex+(0<this.dir&&this.index<this.prevIndex||0>this.dir&&this.index>this.prevIndex?(this.maxIndex+1)*this.dir:0));if(!this.dragging&&1<e){for(var a=0;a<e;a++)this.stack.splice(1,0,0<this.dir?"next":"previous");return void t.preventDefault()}this.duration=ao(this.avgWidth/this.velocity)*(wt(0>this.dir||!this.slides[this.prevIndex]?this.slides[this.index]:this.slides[this.prevIndex]).width/this.avgWidth),this.reorder()},itemshow:function(){M(this.prevIndex)||it(this._getTransitioner().getItemIn(),this.clsActive)},itemshown:function(){var e=this,t=this._getTransitioner(this.index).getActives();this.slides.forEach(function(a){return ct(a,e.clsActive,b(t,a))}),(!this.sets||b(this.sets,F(this.index)))&&this.slides.forEach(function(a){return ct(a,e.clsActivated,b(t,a))})}},methods:{reorder:function(){var e=this;if(gt(this.slides,"order",""),!this.finite){var t=0<this.dir&&this.slides[this.prevIndex]?this.prevIndex:this.index;if(this.slides.forEach(function(a,o){return gt(a,"order",0<e.dir&&o<t?1:0>e.dir&&o>=e.index?-1:"")}),!!this.center)for(var a=this.slides[t],o=wt(this.list).width/2-wt(a).width/2,r=0;0<o;){var i=this.getIndex(--r+t,t),n=this.slides[i];gt(n,"order",i>t?-2:-1),o-=wt(n).width}}},getValidIndex:function(e,t){if(void 0===e&&(e=this.index),void 0===t&&(t=this.prevIndex),e=this.getIndex(e,t),!this.sets)return e;var a;do{if(b(this.sets,e))return e;a=e,e=this.getIndex(e+this.dir,t)}while(e!==a);return e}}},Ki={mixins:[Yi],data:{selItem:"!li"},computed:{item:function(e,t){var a=e.selItem;return ne(a,t)}},events:[{name:"itemshown",self:!0,el:function(){return this.item},handler:function(){gt(this.$el,this.getCss(.5))}},{name:"itemin itemout",self:!0,el:function(){return this.item},handler:function(e){var t=e.type,a=e.detail,o=a.percent,r=a.duration,i=a.timing,n=a.dir;Cr.cancel(this.$el),gt(this.$el,this.getCss(wo(t,n,o))),Cr.start(this.$el,this.getCss(vo(t)?.5:0<n?1:0),r,i).catch(Q)}},{name:"transitioncanceled transitionend",self:!0,el:function(){return this.item},handler:function(){Cr.cancel(this.$el)}},{name:"itemtranslatein itemtranslateout",self:!0,el:function(){return this.item},handler:function(e){var t=e.type,a=e.detail,o=a.percent,r=a.dir;Cr.cancel(this.$el),gt(this.$el,this.getCss(wo(t,r,o)))}}]},$i=Yo({},Mi,{fade:{show:function(){return[{opacity:0,zIndex:0},{zIndex:-1}]},percent:function(e){return 1-gt(e,"opacity")},translate:function(e){return[{opacity:1-e,zIndex:0},{zIndex:-1}]}},scale:{show:function(){return[{opacity:0,transform:Ja(1+.5),zIndex:0},{zIndex:-1}]},percent:function(e){return 1-gt(e,"opacity")},translate:function(e){return[{opacity:1-e,transform:Ja(1+.5*e),zIndex:0},{zIndex:-1}]}},pull:{show:function(e){return 0>e?[{transform:$a(30),zIndex:-1},{transform:$a(),zIndex:0}]:[{transform:$a(-100),zIndex:0},{transform:$a(),zIndex:-1}]},percent:function(e,t,a){return 0>a?1-Ka(t):Ka(e)},translate:function(e,t){return 0>t?[{transform:$a(30*e),zIndex:-1},{transform:$a(-100*(1-e)),zIndex:0}]:[{transform:$a(100*-e),zIndex:0},{transform:$a(30*(1-e)),zIndex:-1}]}},push:{show:function(e){return 0>e?[{transform:$a(100),zIndex:0},{transform:$a(),zIndex:-1}]:[{transform:$a(-30),zIndex:-1},{transform:$a(),zIndex:0}]},percent:function(e,t,a){return 0<a?1-Ka(t):Ka(e)},translate:function(e,t){return 0>t?[{transform:$a(100*e),zIndex:0},{transform:$a(-30*(1-e)),zIndex:-1}]:[{transform:$a(-30*e),zIndex:-1},{transform:$a(100*(1-e)),zIndex:0}]}}}),Ji={mixins:[Nr,Vi,Xi],props:{ratio:String,minHeight:Number,maxHeight:Number},data:{ratio:"16:9",minHeight:!1,maxHeight:!1,selList:".uk-slideshow-items",attrItem:"uk-slideshow-item",selNav:".uk-slideshow-nav",Animations:$i},update:{read:function(){var e=this.ratio.split(":").map(Number),t=e[0],a=e[1];return a=a*this.list.offsetWidth/t||0,this.minHeight&&(a=g(this.minHeight,a)),this.maxHeight&&(a=d(this.maxHeight,a)),{height:a-Ct(this.list,"height","content-box")}},write:function(e){var t=e.height;0<t&&gt(this.list,"minHeight",t)},events:["resize"]}},Qi={mixins:[Nr,Oi],props:{group:String,threshold:Number,clsItem:String,clsPlaceholder:String,clsDrag:String,clsDragState:String,clsBase:String,clsNoDrag:String,clsEmpty:String,clsCustom:String,handle:String},data:{group:!1,threshold:5,clsItem:"uk-sortable-item",clsPlaceholder:"uk-sortable-placeholder",clsDrag:"uk-sortable-drag",clsDragState:"uk-drag",clsBase:"uk-sortable",clsNoDrag:"uk-sortable-nodrag",clsEmpty:"uk-sortable-empty",clsCustom:"",handle:!1,pos:{}},created:function(){var t=this;["init","start","move","end"].forEach(function(e){var a=t[e];t[e]=function(o){Yo(t.pos,Be(o)),a(o)}})},events:{name:Qo,passive:!1,handler:"init"},computed:{target:function(){return(this.$el.tBodies||[this.$el])[0]},items:function(){return Te(this.target)},isEmpty:{get:function(){return R(this.items)},watch:function(e){ct(this.target,this.clsEmpty,e)},immediate:!0},handles:{get:function(e,t){var a=e.handle;return a?$(a,t):this.items},watch:function(e,t){gt(t,{touchAction:"",userSelect:""}),gt(e,{touchAction:Jo?"none":"",userSelect:"none"})},immediate:!0}},update:{write:function(){if(this.drag&&ye(this.placeholder)){var e=this.pos,t=e.x,a=e.y,o=this.origin,r=o.offsetTop,i=o.offsetLeft,n=this.drag,l=n.offsetHeight,s=n.offsetWidth,d=wt(window),c=d.right,p=d.bottom,u=document.elementFromPoint(t,a);gt(this.drag,{top:J(a-r,0,p-l),left:J(t-i,0,c-s)});var g=this.getSortable(u),m=this.getSortable(this.placeholder),h=g!==m;if(g&&!we(u,this.placeholder)&&(!h||g.group&&g.group===m.group)){if(u=g.target===u.parentNode&&u||g.items.filter(function(e){return we(u,e)})[0],h)m.remove(this.placeholder);else if(!u)return;g.insert(this.placeholder,u),b(this.touched,g)||this.touched.push(g)}}},events:["move"]},methods:{init:function(t){var e=t.target,a=t.button,o=t.defaultPrevented,r=this.items.filter(function(t){return we(e,t)}),i=r[0];!i||o||0<a||be(e)||we(e,"."+this.clsNoDrag)||this.handle&&!we(e,this.handle)||(t.preventDefault(),this.touched=[this],this.placeholder=i,this.origin=Yo({target:e,index:He(i)},this.pos),Ae(document,er,this.move),Ae(document,tr,this.end),!this.threshold&&this.start(t))},start:function(t){this.drag=So(this.$container,this.placeholder);var e=this.placeholder.getBoundingClientRect(),a=e.left,o=e.top;Yo(this.origin,{offsetLeft:this.pos.x-a,offsetTop:this.pos.y-o}),it(this.drag,this.clsDrag,this.clsCustom),it(this.placeholder,this.clsPlaceholder),it(this.items,this.clsItem),it(document.documentElement,this.clsDragState),Ce(this.$el,"start",[this,this.placeholder]),To(this.pos),this.move(t)},move:function(t){this.drag?this.$emit("move"):(u(this.pos.x-this.origin.x)>this.threshold||u(this.pos.y-this.origin.y)>this.threshold)&&this.start(t)},end:function(t){if(x(document,er,this.move),x(document,tr,this.end),x(window,"scroll",this.scroll),!this.drag)return void("touchend"===t.type&&t.target.click());Ao();var e=this.getSortable(this.placeholder);this===e?this.origin.index!==He(this.placeholder)&&Ce(this.$el,"moved",[this,this.placeholder]):(Ce(e.$el,"added",[e,this.placeholder]),Ce(this.$el,"removed",[this,this.placeholder])),Ce(this.$el,"stop",[this,this.placeholder]),$e(this.drag),this.drag=null;var a=this.touched.map(function(e){return e.clsPlaceholder+" "+e.clsItem}).join(" ");this.touched.forEach(function(e){return nt(e.items,a)}),nt(document.documentElement,this.clsDragState)},insert:function(e,t){var a=this;it(this.items,this.clsItem);var o=function(){t?!we(e,a.target)||ko(e,t)?Xe(t,e):Ze(t,e):We(a.target,e)};this.animation?this.animate(o):o()},remove:function(e){we(e,this.target)&&(this.animation?this.animate(function(){return $e(e)}):$e(e))},getSortable:function(e){return e&&(this.$getComponent(e,"sortable")||this.getSortable(e.parentNode))}}},en=[],tn={mixins:[_i,Vr,Yr],args:"title",props:{delay:Number,title:String},data:{pos:"top",title:"",delay:0,animation:["uk-animation-scale-up"],duration:100,cls:"uk-active",clsPos:"uk-tooltip"},beforeConnect:function(){this._hasTitle=oe(this.$el,"title"),ae(this.$el,{title:"","aria-expanded":!1})},disconnected:function(){this.hide(),ae(this.$el,{title:this._hasTitle?this.title:null,"aria-expanded":null})},methods:{show:function(){var t=this;this.isActive()||!this.title||(en.forEach(function(e){return e.hide()}),en.push(this),this._unbind=Ae(document,tr,function(a){return!we(a.target,t.$el)&&t.hide()}),clearTimeout(this.showTimer),this.showTimer=setTimeout(this._show,this.delay))},hide:function(){var e=this;!this.isActive()||me(this.$el,"input:focus")||this.toggleElement(this.tooltip,!1,!1).then(function(){en.splice(en.indexOf(e),1),clearTimeout(e.showTimer),e.tooltip=$e(e.tooltip),e._unbind()})},_show:function(){var e=this;this.tooltip=We(this.container,"<div class=\""+this.clsPos+"\"> <div class=\""+this.clsPos+"-inner\">"+this.title+"</div> </div>"),Ae(this.tooltip,"toggled",function(){var t=e.isToggled(e.tooltip);ae(e.$el,"aria-expanded",t),t&&(e.positionAt(e.tooltip,e.$el),e.origin="y"===e.getAxis()?Pt(e.dir)+"-"+e.align:e.align+"-"+Pt(e.dir))}),this.toggleElement(this.tooltip,!0)},isActive:function(){return b(en,this)}},events:(sn={focus:"show",blur:"hide"},sn[ar+" "+or]=function(t){je(t)||(t.type===ar?this.show():this.hide())},sn[Qo]=function(t){je(t)&&(this.isActive()?this.hide():this.show())},sn)},an={props:{allow:String,clsDragover:String,concurrent:Number,maxSize:Number,method:String,mime:String,msgInvalidMime:String,msgInvalidName:String,msgInvalidSize:String,multiple:Boolean,name:String,params:Object,type:String,url:String},data:{allow:!1,clsDragover:"uk-dragover",concurrent:1,maxSize:0,method:"POST",mime:!1,msgInvalidMime:"Invalid File Type: %s",msgInvalidName:"Invalid File Name: %s",msgInvalidSize:"Invalid File Size: %s Kilobytes Max",multiple:!1,name:"files[]",params:{},type:"",url:"",abort:Q,beforeAll:Q,beforeSend:Q,complete:Q,completeAll:Q,error:Q,fail:Q,load:Q,loadEnd:Q,loadStart:Q,progress:Q},events:{change:function(t){me(t.target,"input[type=\"file\"]")&&(t.preventDefault(),t.target.files&&this.upload(t.target.files),t.target.value="")},drop:function(t){Eo(t);var e=t.dataTransfer;e&&e.files&&(nt(this.$el,this.clsDragover),this.upload(e.files))},dragenter:function(t){Eo(t)},dragover:function(t){Eo(t),it(this.$el,this.clsDragover)},dragleave:function(t){Eo(t),nt(this.$el,this.clsDragover)}},methods:{upload:function(e){var t=this;if(e.length){Ce(this.$el,"upload",[e]);for(var a=0;a<e.length;a++){if(this.maxSize&&1e3*this.maxSize<e[a].size)return void this.fail(this.msgInvalidSize.replace("%s",this.maxSize));if(this.allow&&!Co(this.allow,e[a].name))return void this.fail(this.msgInvalidName.replace("%s",this.allow));if(this.mime&&!Co(this.mime,e[a].type))return void this.fail(this.msgInvalidMime.replace("%s",this.mime))}this.multiple||(e=[e[0]]),this.beforeAll(this,e);var o=Lo(e,this.concurrent),r=function(e){var a=new FormData;for(var i in e.forEach(function(e){return a.append(t.name,e)}),t.params)a.append(i,t.params[i]);Ne(t.url,{data:a,method:t.method,responseType:t.type,beforeSend:function(e){var a=e.xhr;a.upload&&Ae(a.upload,"progress",t.progress),["loadStart","load","loadEnd","abort"].forEach(function(e){return Ae(a,e.toLowerCase(),t[e])}),t.beforeSend(e)}}).then(function(e){t.complete(e),o.length?r(o.shift()):t.completeAll(e)},function(a){return t.error(a)})};r(o.shift())}}}},on=Object.freeze({__proto__:null,Countdown:Di,Filter:Ri,Lightbox:Hi,LightboxPanel:Ui,Notification:qi,Parallax:Wi,Slider:Zi,SliderParallax:Ki,Slideshow:Ji,SlideshowParallax:Ki,Sortable:Qi,Tooltip:tn,Upload:an}),rn,nn,ln,sn;return X(zi,Io),X(on,Io),Fr.use(function(t){Ue(function(){t.update(),Ae(window,"load resize",function(){return t.update(null,"resize")}),Ae(document,"loadedmetadata load",function(e){var a=e.target;return t.update(a,"resize")},!0);var a;Ae(window,"scroll",function(o){a||(a=!0,Dr.write(function(){return a=!1}),t.update(null,o.type))},{passive:!0,capture:!0});var o=0;Ae(document,"animationstart",function(e){var t=e.target;(gt(t,"animationName")||"").match(/^uk-.*(left|right)/)&&(o++,gt(document.body,"overflowX","hidden"),setTimeout(function(){--o||gt(document.body,"overflowX","")},q(gt(t,"animationDuration"))+100))},!0);var r;Ae(document,Qo,function(t){if(r&&r(),!!je(t)){var a=Be(t),o="tagName"in t.target?t.target:t.target.parentNode;r=Se(document,tr+" "+rr,function(t){var e=Be(t),r=e.x,i=e.y;(o&&r&&100<u(a.x-r)||i&&100<u(a.y-i))&&setTimeout(function(){Ce(o,"swipe"),Ce(o,"swipe"+aa(a.x,a.y,r,i))})})}},{passive:!0})})}),oa(Fr),Fr})}).call(this,e("timers").setImmediate)},{timers:1426}],1330:[function(e,t){"use strict";"use restrict";function a(e){this.roots=Array(e),this.ranks=Array(e);for(var t=0;t<e;++t)this.roots[t]=t,this.ranks[t]=0}t.exports=a;var o=a.prototype;Object.defineProperty(o,"length",{get:function(){return this.roots.length}}),o.makeSet=function(){var e=this.roots.length;return this.roots.push(e),this.ranks.push(0),e},o.find=function(e){for(var t=e,a=this.roots;a[e]!==e;)e=a[e];for(;a[t]!==e;){var o=a[t];a[t]=e,t=o}return e},o.link=function(e,t){var a=this.find(e),o=this.find(t);if(a!==o){var r=this.ranks,i=this.roots,n=r[a],l=r[o];n<l?i[a]=o:l<n?i[o]=a:(i[o]=a,++r[a])}}},{}],1331:[function(e,t){"use strict";function a(e,t){for(var o=1,r=e.length,n=e[0],l=e[0],s=1;s<r;++s)if(l=n,n=e[s],t(n,l)){if(s===o){o++;continue}e[o++]=n}return e.length=o,e}function o(e){for(var t=1,o=e.length,r=e[0],n=e[0],l=1;l<o;++l,n=r)if(n=r,r=e[l],r!==n){if(l===t){t++;continue}e[t++]=r}return e.length=t,e}t.exports=function(e,t,r){return 0===e.length?e:t?(r||e.sort(t),a(e,t)):(r||e.sort(),o(e))}},{}],1332:[function(e,t){(function(a){function o(){var e=Date.now(),t=o.last||e;return o.last=e>t?e:t+1}var r=a&&a.pid?a.pid.toString(36):"",n="";if("function"!=typeof __webpack_require__){var l="",s=e("os").networkInterfaces();for(let e in s){const t=s[e],a=t.length;for(var d=0;d<a;d++)if(t[d].mac&&"00:00:00:00:00:00"!=t[d].mac){l=t[d].mac;break}}n=l?parseInt(l.replace(/\:|\D+/gi,"")).toString(36):""}t.exports=t.exports.default=function(e,t){return(e?e:"")+n+r+o().toString(36)+(t?t:"")},t.exports.process=function(e,t){return(e?e:"")+r+o().toString(36)+(t?t:"")},t.exports.time=function(e,t){return(e?e:"")+o().toString(36)+(t?t:"")}}).call(this,e("_process"))},{_process:1425,os:1424}],1333:[function(e,t){var a=/[\'\"]/;t.exports=function(e){return e?(a.test(e.charAt(0))&&(e=e.substr(1)),a.test(e.charAt(e.length-1))&&(e=e.substr(0,e.length-1)),e):""}},{}],1334:[function(e,t){'use strict';t.exports=function(e,t,a){Array.isArray(a)||(a=[].slice.call(arguments,2));for(var o=0,r=a.length,n;o<r;o++)for(var l in n=a[o],n)if((void 0===t[l]||Array.isArray(t[l])||e[l]!==t[l])&&l in t){var s;if(!0===n[l])s=t[l];else if(!1===n[l])continue;else if("function"==typeof n[l]&&(s=n[l](t[l],e,t),void 0===s))continue;e[l]=s}return e}},{}],1335:[function(e,t){"use strict";function a(e,t){return("object"!=typeof t||null===t)&&(t={}),o(e,t.canvas||r,t.context||i,t)}t.exports=a;var o=e("./lib/vtext"),r=null,i=null;"undefined"!=typeof document&&(r=document.createElement("canvas"),r.width=8192,r.height=1024,i=r.getContext("2d"))},{"./lib/vtext":1336}],1336:[function(e,t){var d=Math.round,c=Math.min,p=Math.pow,u=Math.max;function a(e,t,o,r){for(var n="<"+e+">",l="</"+e+">",s=n.length,d=l.length,p="+"===t[0]||"-"===t[0],u=0,g=-d;-1<u&&(u=o.indexOf(n,u),-1!==u)&&!(g=o.indexOf(l,u+s),-1===g);){if(g<=u)break;for(var m=u;m<g+d;++m)if(m<u+s||m>=g)r[m]=null,o=o.substr(0,m)+" "+o.substr(m+1);else if(null!==r[m]){var h=r[m].indexOf(t[0]);-1===h?r[m]+=t:p&&(r[m]=r[m].substr(0,h+1)+(1+parseInt(r[m][h+1]))+r[m].substr(h+2))}var y=u+s,f=o.substr(y,g-y),x=f.indexOf(n);u=-1===x?g+d:x}return r}function o(e,t,a){for(var o=t.textAlign||"start",r=t.textBaseline||"alphabetic",l=[1073741824,1073741824],s=[0,0],d=e.length,n=0,g;n<d;++n){g=e[n];for(var m=0;2>m;++m)l[m]=0|c(l[m],g[m]),s[m]=0|u(s[m],g[m])}var h=0;switch(o){case"center":h=-.5*(l[0]+s[0]);break;case"right":case"end":h=-s[0];break;case"left":case"start":h=-l[0];break;default:throw new Error("vectorize-text: Unrecognized textAlign: '"+o+"'");}var y=0;switch(r){case"hanging":case"top":y=-l[1];break;case"middle":y=-.5*(l[1]+s[1]);break;case"alphabetic":case"ideographic":y=-3*a;break;case"bottom":y=-s[1];break;default:throw new Error("vectorize-text: Unrecoginized textBaseline: '"+r+"'");}var f=1/a;return"lineHeight"in t?f*=+t.lineHeight:"width"in t?f=t.width/(s[0]-l[0]):"height"in t&&(f=t.height/(s[1]-l[1])),e.map(function(e){return[f*(e[0]+h),f*(e[1]+y)]})}function r(e,t,o,r,n,l){function s(){if(""!==S){var e=t.measureText(S).width;t.fillText(S,v+E,w+I),E+=e}}function c(){return""+d(P)+"px "}function u(e,a){var o=""+t.font;if(!0===l.subscripts){var r=e.indexOf("-"),i=a.indexOf("-"),n=-1<r?parseInt(e[1+r]):0,s=-1<i?parseInt(a[1+i]):0;n!==s&&(o=o.replace(c(),"?px "),P*=p(.75,s-n),o=o.replace("?px ",c())),I+=.25*b*(s-n)}if(!0===l.superscripts){var d=e.indexOf("+"),u=a.indexOf("+"),g=-1<d?parseInt(e[1+d]):0,m=-1<u?parseInt(a[1+u]):0;g!==m&&(o=o.replace(c(),"?px "),P*=p(.75,m-g),o=o.replace("?px ",c())),I-=.25*b*(m-g)}if(!0===l.bolds){var h=-1<e.indexOf("b|"),y=-1<a.indexOf("b|");!h&&y&&(f?o=o.replace("italic ","italic bold "):o="bold "+o),h&&!y&&(o=o.replace("bold ",""))}if(!0===l.italics){var f=-1<e.indexOf("i|"),x=-1<a.indexOf("i|");!f&&x&&(o="italic "+o),f&&!x&&(o=o.replace("italic ",""))}t.font=o}o=o.replace(/\n/g,""),o=!0===l.breaklines?o.replace(/\<br\>/g,"\n"):o.replace(/\<br\>/g," ");var g="",h=[];for(L=0;L<o.length;++L)h[L]=g;!0===l.bolds&&(h=a("b","b|",o,h)),!0===l.italics&&(h=a("i","i|",o,h)),!0===l.superscripts&&(h=a("sup","+1",o,h)),!0===l.subscripts&&(h=a("sub","-1",o,h));var y=[],f="";for(L=0;L<o.length;++L)null!==h[L]&&(f+=o[L],y.push(h[L]));var x=f.split("\n"),_=x.length,b=d(n*r),v=r,w=2*r,k=0,T=_*b+w;e.height<T&&(e.height=T),t.fillStyle="#000",t.fillRect(0,0,e.width,e.height),t.fillStyle="#fff";var A=0,S="",C,L,E,I,P;for(C=0;C<_;++C){var z=x[C]+"\n";for(E=0,I=C*b,P=r,S="",L=0;L<z.length;++L){var D=L+A<y.length?y[L+A]:y[y.length-1];g===D?S+=z[L]:(s(),S=z[L],D!==void 0&&(u(g,D),g=D))}s(),A+=z.length;var O=0|d(E+2*v);k<O&&(k=O)}var R=k,M=w+b*_,B=m(t.getImageData(0,0,R,M).data,[M,R,4]);return B.pick(-1,-1,0).transpose(1,0)}function n(e,t){var a=g(e,128);return t?h(a.cells,a.positions,.25):{edges:a.cells,positions:a.positions}}function l(e,t,a,r){var l=n(e,r),s=o(l.positions,t,a),d=l.edges,c="ccw"===t.orientation;if(y(s,d),t.polygons||t.polygon||t.polyline){for(var p=x(d,s),u=Array(p.length),g=0;g<p.length;++g){for(var m=p[g],h=Array(m.length),_=0;_<m.length;++_){for(var b=m[_],v=Array(b.length),w=0;w<b.length;++w)v[w]=s[b[w]].slice();c&&v.reverse(),h[_]=v}u[g]=h}return u}return t.triangles||t.triangulate||t.triangle?{cells:f(s,d,{delaunay:!1,exterior:!1,interior:!0}),positions:s}:{edges:d,positions:s}}function s(e,t,a){try{return l(e,t,a,!0)}catch(t){}try{return l(e,t,a,!1)}catch(t){}return t.polygons||t.polyline||t.polygon?[]:t.triangles||t.triangulate||t.triangle?{cells:[],positions:[]}:{edges:[],positions:[]}}t.exports=function(e,t,a,o){var i=64,n=1.25,l={breaklines:!1,bolds:!1,italics:!1,subscripts:!1,superscripts:!1};o&&(o.size&&0<o.size&&(i=o.size),o.lineSpacing&&0<o.lineSpacing&&(n=o.lineSpacing),o.styletags&&o.styletags.breaklines&&(l.breaklines=!!o.styletags.breaklines),o.styletags&&o.styletags.bolds&&(l.bolds=!!o.styletags.bolds),o.styletags&&o.styletags.italics&&(l.italics=!!o.styletags.italics),o.styletags&&o.styletags.subscripts&&(l.subscripts=!!o.styletags.subscripts),o.styletags&&o.styletags.superscripts&&(l.superscripts=!!o.styletags.superscripts)),a.font=[o.fontStyle,o.fontVariant,o.fontWeight,i+"px",o.font].filter(function(e){return e}).join(" "),a.textAlign="start",a.textBaseline="alphabetic",a.direction="ltr";var d=r(t,a,e,i,n,l);return s(d,o,i)},t.exports.processPixels=s;var g=e("surface-nets"),m=e("ndarray"),h=e("simplify-planar-graph"),y=e("clean-pslg"),f=e("cdt2d"),x=e("planar-graph-to-polyline")},{cdt2d:54,"clean-pslg":63,ndarray:425,"planar-graph-to-polyline":452,"simplify-planar-graph":1295,"surface-nets":1303}],1337:[function(e,t,a){arguments[4][433][0].apply(a,arguments)},{dup:433}],1338:[function(e,t){function a(e,t,a){if(e.hasOwnProperty(a)){if("function"==typeof t[a])return;t[a]=function(o){return void 0===o?e[a]:(e[a]=o,t)}}}t.exports=function(e,t,o){var r="[object Array]"===Object.prototype.toString.call(o);if(r)for(var n=0;n<o.length;++n)a(e,t,o[n]);else for(var l in e)a(e,t,l)}},{}],1339:[function(e,t){var o=Math.min;function a(){}t.exports=function(t,i){function n(e){T.fire("stable",e)}function l(e){for(var a=0,o;a<e.length;++a)o=e[a],"add"===o.changeType?(o.node&&s(o.node.id),o.link&&c(o.link)):"remove"===o.changeType&&(o.node&&d(o.node),o.link&&p(o.link));v=t.getNodesCount()}function s(e){var a=_[e];if(!a){var o=t.getNode(e);if(!o)throw new Error("initBody() was called with unknown node id");var r=o.position;if(!r){var i=u(o);r=f.getBestNewBodyPosition(i)}a=f.addBodyAt(r),a.id=e,_[e]=a,g(e),m(o)&&(a.isPinned=!0)}}function d(e){var t=e.id,a=_[t];a&&(_[t]=null,delete _[t],f.removeBody(a))}function c(e){g(e.fromId),g(e.toId);var t=_[e.fromId],a=_[e.toId],o=f.addSpring(t,a,e.length);w(e,o),b[e.id]=o}function p(e){var a=b[e.id];if(a){var o=t.getNode(e.fromId),r=t.getNode(e.toId);o&&g(o.id),r&&g(r.id),delete b[e.id],f.removeSpring(a)}}function u(e){var t=[];if(!e.links)return t;for(var a=o(e.links.length,2),r=0;r<a;++r){var n=e.links[r],l=n.fromId===e.id?_[n.toId]:_[n.fromId];l&&l.pos&&t.push(l)}return t}function g(e){var t=Number.isNaN,a=_[e];if(a.mass=x(e),t(a.mass))throw new Error("Node mass should be a number")}function m(e){return e&&(e.isPinned||e.data&&e.data.isPinned)}function h(e){var t=_[e];return t||(s(e),t=_[e]),t}if(!t)throw new Error("Graph structure cannot be undefined");var y=e("ngraph.physics.simulator"),f=y(i),x=function(e){var a=t.getLinks(e);return a?1+a.length/3:1};i&&"function"==typeof i.nodeMass&&(x=i.nodeMass);var _=Object.create(null),b={},v=0,w=f.settings.springTransform||a;(function(){v=0,t.forEachNode(function(e){s(e.id),v+=1}),t.forEachLink(c)})(),function(){t.on("changed",l)}();var k=!1,T={step:function(){if(0===v)return!0;var e=f.step();T.lastMove=e,T.fire("step");var t=e/v,a=.01>=t;return k!==a&&(k=a,n(a)),a},getNodePosition:function(e){return h(e).pos},setNodePosition:function(e){var t=h(e);t.setPosition.apply(t,Array.prototype.slice.call(arguments,1)),f.invalidateBBox()},getLinkPosition:function(e){var t=b[e];if(t)return{from:t.from.pos,to:t.to.pos}},getGraphRect:function(){return f.getBBox()},forEachBody:function(e){Object.keys(_).forEach(function(t){e(_[t],t)})},pinNode:function(e,t){var a=h(e.id);a.isPinned=!!t},isNodePinned:function(e){return h(e.id).isPinned},dispose:function(){t.off("changed",l),T.fire("disposed")},getBody:function(e){return _[e]},getSpring:function(e,a){var o;if(void 0===a)o="object"==typeof e?e.id:e;else{var r=t.hasLink(e,a);if(!r)return;o=r.id}return b[o]},simulator:f,graph:t,lastMove:0};return r(T),T},t.exports.simulator=e("ngraph.physics.simulator");var r=e("ngraph.events")},{"ngraph.events":1340,"ngraph.physics.simulator":1346}],1340:[function(e,t,a){arguments[4][433][0].apply(a,arguments)},{dup:433}],1341:[function(e,t){function a(t){function a(e){if(!e||0>e)throw new Error("Invalid number of nodes");var a=t(),o;for(o=0;o<e-1;++o)a.addLink(o,o+1),a.addLink(e+o,e+o+1),a.addLink(o,e+o);return a.addLink(e-1,2*e-1),a}return{ladder:a,complete:function(e){if(!e||1>e)throw new Error("At least two nodes are expected for complete graph");var a=t(),o,r;for(o=0;o<e;++o)for(r=o+1;r<e;++r)o!==r&&a.addLink(o,r);return a},completeBipartite:function(e,a){if(!e||!a||0>e||0>a)throw new Error("Graph dimensions are invalid. Number of nodes in each partition should be greater than 0");var o=t(),r,n;for(r=0;r<e;++r)for(n=e;n<e+a;++n)o.addLink(r,n);return o},balancedBinTree:function(e){if(0>e)throw new Error("Invalid number of nodes in balanced tree");var a=t(),o=Math.pow(2,e),r;for(0===e&&a.addNode(1),r=1;r<o;++r){var i=r;a.addLink(i,2*i),a.addLink(i,2*i+1)}return a},path:function(e){if(!e||0>e)throw new Error("Invalid number of nodes");var a=t(),o;for(a.addNode(0),o=1;o<e;++o)a.addLink(o-1,o);return a},circularLadder:function(e){if(!e||0>e)throw new Error("Invalid number of nodes");var t=a(e);return t.addLink(0,e-1),t.addLink(e,2*e-1),t},grid:function(e,a){if(1>e||1>a)throw new Error("Invalid number of nodes in grid graph");var o=t(),r,n;if(1===e&&1===a)return o.addNode(0),o;for(r=0;r<e;++r)for(n=0;n<a;++n){var l=r+n*e;0<r&&o.addLink(l,r-1+n*e),0<n&&o.addLink(l,r+(n-1)*e)}return o},grid3:function(e,a,o){if(1>e||1>a||1>o)throw new Error("Invalid number of nodes in grid3 graph");var r=t(),n,l,s;if(1===e&&1===a&&1===o)return r.addNode(0),r;for(s=0;s<o;++s)for(n=0;n<e;++n)for(l=0;l<a;++l){var d=s*e*a,c=n+l*e+d;0<n&&r.addLink(c,n-1+l*e+d),0<l&&r.addLink(c,n+(l-1)*e+d),0<s&&r.addLink(c,n+l*e+(s-1)*e*a)}return r},noLinks:function(e){if(0>e)throw new Error("Number of nodes should be >= 0");var a=t(),o;for(o=0;o<e;++o)a.addNode(o);return a},wattsStrogatz:function(a,o,r,n){if(o>=a)throw new Error("Choose smaller `k`. It cannot be larger than number of nodes `n`");var l=e("ngraph.random").random(n||42),s=t(),d,c;for(d=0;d<a;++d)s.addNode(d);for(var p=Math.floor(o/2+1),u=1;u<p;++u)for(d=0;d<a;++d)c=(u+d)%a,s.addLink(d,c);for(u=1;u<p;++u)for(d=0;d<a;++d)if(l.nextDouble()<r){var g=d;c=(u+d)%a;var m=l.next(a),h=m===g||s.hasLink(g,m);if(h&&s.getLinks(g).length===a-1)continue;for(;h;)m=l.next(a),h=m===g||s.hasLink(g,m);var y=s.hasLink(g,c);s.removeLink(y),s.addLink(g,m)}return s},cliqueCircle:function(e,a){function o(e,t){for(var a=0;a<e;++a)r.addNode(a+t);for(var a=0;a<e;++a)for(var o=a+1;o<e;++o)r.addLink(a+t,o+t)}if(1>e)throw new Error("Invalid number of cliqueCount in cliqueCircle");if(1>a)throw new Error("Invalid number of cliqueSize in cliqueCircle");for(var r=t(),n=0;n<e;++n)o(a,n*a),0<n&&r.addLink(n*a,n*a-1);return r.addLink(0,r.getNodesCount()-1),r}}}var o=e("ngraph.graph");t.exports=a(o),t.exports.factory=a},{"ngraph.graph":1343,"ngraph.random":1342}],1342:[function(e,t){function a(e){var t="number"==typeof e?e:+new Date;return new o(t)}function o(e){this.seed=e}function r(){var e=this.seed;return e=4294967295&e+2127912214+(e<<12),e=4294967295&(3345072700^e^e>>>19),e=4294967295&e+374761393+(e<<5),e=4294967295&(e+3550635116^e<<9),e=4294967295&e+4251993797+(e<<3),e=4294967295&(3042594569^e^e>>>16),this.seed=e,(268435455&e)/268435456}t.exports=a,t.exports.random=a,t.exports.randomIterator=function(e,t){var o=t||a();if("function"!=typeof o.next)throw new Error("customRandom does not match expected API: next() function is missing");return{forEach:function(a){var r,n,l;for(r=e.length-1;0<r;--r)n=o.next(r+1),l=e[n],e[n]=e[r],e[r]=l,a(l);e.length&&a(e[0])},shuffle:function(){var a,r,n;for(a=e.length-1;0<a;--a)r=o.next(a+1),n=e[r],e[r]=e[a],e[a]=n;return e}}},o.prototype.next=function(e){return Math.floor(this.nextDouble()*e)},o.prototype.nextDouble=r,o.prototype.uniform=r,o.prototype.gaussian=function(){var e,t,a;do t=2*this.nextDouble()-1,a=2*this.nextDouble()-1,e=t*t+a*a;while(1<=e||0===e);return t*Math.sqrt(-2*Math.log(e)/e)}},{}],1343:[function(e,t,a){arguments[4][434][0].apply(a,arguments)},{dup:434,"ngraph.events":1337}],1344:[function(e,t){function a(e,t){if(e||(e={}),t)for(var o in t)if(t.hasOwnProperty(o)){var r=e.hasOwnProperty(o),i=typeof t[o],n=!r||typeof e[o]!==i;n?e[o]=t[o]:"object"===i&&(e[o]=a(e[o],t[o]))}return e}t.exports=a},{}],1345:[function(e,t){function a(e,t){this.pos=new o(e,t),this.prevPos=new o(e,t),this.force=new o,this.velocity=new o,this.mass=1}function o(e,t){e&&"number"!=typeof e?(this.x="number"==typeof e.x?e.x:0,this.y="number"==typeof e.y?e.y:0):(this.x="number"==typeof e?e:0,this.y="number"==typeof t?t:0)}function r(e,t,a){this.pos=new i(e,t,a),this.prevPos=new i(e,t,a),this.force=new i,this.velocity=new i,this.mass=1}function i(e,t,a){e&&"number"!=typeof e?(this.x="number"==typeof e.x?e.x:0,this.y="number"==typeof e.y?e.y:0,this.z="number"==typeof e.z?e.z:0):(this.x="number"==typeof e?e:0,this.y="number"==typeof t?t:0,this.z="number"==typeof a?a:0)}t.exports={Body:a,Vector2d:o,Body3d:r,Vector3d:i},a.prototype.setPosition=function(e,t){this.prevPos.x=this.pos.x=e,this.prevPos.y=this.pos.y=t},o.prototype.reset=function(){this.x=this.y=0},r.prototype.setPosition=function(e,t,a){this.prevPos.x=this.pos.x=e,this.prevPos.y=this.pos.y=t,this.prevPos.z=this.pos.z=a};i.prototype.reset=function(){this.x=this.y=this.z=0}},{}],1346:[function(e,t){t.exports=function(t){function a(){var e=g.length,t;if(e)for(h.insertBodies(g);e--;)t=g[e],t.isPinned||(t.force.reset(),h.updateBodyForce(t),x.update(t));for(e=m.length;e--;)f.update(m[e])}var o=e("./lib/spring"),r=e("ngraph.expose"),i=e("ngraph.merge"),n=e("ngraph.events");t=i(t,{springLength:30,springCoeff:8e-4,gravity:-1.2,theta:.8,dragCoeff:.02,timeStep:20});var l=t.createQuadTree||e("ngraph.quadtreebh"),s=t.createBounds||e("./lib/bounds"),d=t.createDragForce||e("./lib/dragForce"),c=t.createSpringForce||e("./lib/springForce"),p=t.integrator||e("./lib/eulerIntegrator"),u=t.createBody||e("./lib/createBody"),g=[],m=[],h=l(t),y=s(g,t),f=c(t),x=d(t),_=!0,b={bodies:g,quadTree:h,springs:m,settings:t,step:function(){a();var e=p(g,t.timeStep);return y.update(),e},addBody:function(e){if(!e)throw new Error("Body is required");return g.push(e),e},addBodyAt:function(e){if(!e)throw new Error("Body position is required");var t=u(e);return g.push(t),t},removeBody:function(e){if(e){var t=g.indexOf(e);if(!(0>t))return g.splice(t,1),0===g.length&&y.reset(),!0}},addSpring:function(e,t,a,r,i){if(!e||!t)throw new Error("Cannot add null spring to force simulator");"number"!=typeof a&&(a=-1);var n=new o(e,t,a,0<=i?i:-1,r);return m.push(n),n},getTotalMovement:function(){return 0},removeSpring:function(e){if(e){var t=m.indexOf(e);if(-1<t)return m.splice(t,1),!0}},getBestNewBodyPosition:function(e){return y.getBestNewPosition(e)},getBBox:function(){return _&&(y.update(),_=!1),y.box},invalidateBBox:function(){_=!0},gravity:function(e){return void 0===e?t.gravity:(t.gravity=e,h.options({gravity:e}),this)},theta:function(e){return void 0===e?t.theta:(t.theta=e,h.options({theta:e}),this)}};return r(t,b),n(b),b}},{"./lib/bounds":1347,"./lib/createBody":1348,"./lib/dragForce":1349,"./lib/eulerIntegrator":1350,"./lib/spring":1351,"./lib/springForce":1352,"ngraph.events":1337,"ngraph.expose":1338,"ngraph.merge":1344,"ngraph.quadtreebh":1353}],1347:[function(e,t){var a=Number.MIN_VALUE,o=Number.MAX_VALUE;t.exports=function(t,r){var n=e("ngraph.random").random(42),l={x1:0,y1:0,x2:0,y2:0};return{box:l,update:function(){var e=t.length;if(0!==e){for(var r=o,n=o,s=a,d=a,c;e--;)c=t[e],c.isPinned?(c.pos.x=c.prevPos.x,c.pos.y=c.prevPos.y):(c.prevPos.x=c.pos.x,c.prevPos.y=c.pos.y),c.pos.x<r&&(r=c.pos.x),c.pos.x>s&&(s=c.pos.x),c.pos.y<n&&(n=c.pos.y),c.pos.y>d&&(d=c.pos.y);l.x1=r,l.x2=s,l.y1=n,l.y2=d}},reset:function(){l.x1=l.y1=0,l.x2=l.y2=0},getBestNewPosition:function(e){var t=l,a=0,o=0;if(e.length){for(var s=0;s<e.length;++s)a+=e[s].pos.x,o+=e[s].pos.y;a/=e.length,o/=e.length}else a=(t.x1+t.x2)/2,o=(t.y1+t.y2)/2;var d=r.springLength;return{x:a+n.next(d)-d/2,y:o+n.next(d)-d/2}}}}},{"ngraph.random":1357}],1348:[function(e,t){var a=e("ngraph.physics.primitives");t.exports=function(e){return new a.Body(e)}},{"ngraph.physics.primitives":1345}],1349:[function(e,t){t.exports=function(t){var a=e("ngraph.merge"),o=e("ngraph.expose");t=a(t,{dragCoeff:.02});var r={update:function(e){e.force.x-=t.dragCoeff*e.velocity.x,e.force.y-=t.dragCoeff*e.velocity.y}};return o(t,r,["dragCoeff"]),r}},{"ngraph.expose":1338,"ngraph.merge":1344}],1350:[function(e,t){var a=Math.abs;t.exports=function(e,t){var o=0,r=0,n=0,l=0,s=e.length,d;if(0===s)return 0;for(d=0;d<s;++d){var c=e[d],p=t/c.mass;c.velocity.x+=p*c.force.x,c.velocity.y+=p*c.force.y;var u=c.velocity.x,g=c.velocity.y,m=Math.sqrt(u*u+g*g);1<m&&(c.velocity.x=u/m,c.velocity.y=g/m),o=t*c.velocity.x,n=t*c.velocity.y,c.pos.x+=o,c.pos.y+=n,r+=a(o),l+=a(n)}return(r*r+l*l)/s}},{}],1351:[function(e,t){t.exports=function(e,t,a,o,r){this.from=e,this.to=t,this.length=a,this.coeff=o,this.weight="number"==typeof r?r:1}},{}],1352:[function(e,t){var a=Math.sqrt;t.exports=function(t){var o=e("ngraph.merge"),i=e("ngraph.random").random(42),n=e("ngraph.expose");t=o(t,{springCoeff:2e-4,springLength:80});var l={update:function(e){var o=e.from,n=e.to,l=0>e.length?t.springLength:e.length,s=n.pos.x-o.pos.x,c=n.pos.y-o.pos.y,p=a(s*s+c*c);0===p&&(s=(i.nextDouble()-.5)/50,c=(i.nextDouble()-.5)/50,p=a(s*s+c*c));var u=p-l,d=(!e.coeff||0>e.coeff?t.springCoeff:e.coeff)*u/p*e.weight;o.force.x+=d*s,o.force.y+=d*c,n.force.x-=d*s,n.force.y-=d*c}};return n(t,l,["springCoeff","springLength"]),l}},{"ngraph.expose":1338,"ngraph.merge":1344,"ngraph.random":1357}],1353:[function(e,t){var r=Number.MIN_VALUE,n=Number.MAX_VALUE,l=Math.sqrt;function a(e,t){return 0===t?e.quad0:1===t?e.quad1:2===t?e.quad2:3===t?e.quad3:null}function o(e,t,a){0===t?e.quad0=a:1===t?e.quad1=a:2===t?e.quad2=a:3==t&&(e.quad3=a)}t.exports=function(t){function s(){var e=v[w];return e?(e.quad0=null,e.quad1=null,e.quad2=null,e.quad3=null,e.body=null,e.mass=e.massX=e.massY=0,e.left=e.right=e.top=e.bottom=0):(e=new g,v[w]=e),++w,e}function d(e){var t=f,a=0,o=0,i=1,n=0,s=1,d,c,p,g;for(t[0]=k;i;){var m=t[n],h=m.body;i-=1,n+=1;var x=h!==e;h&&x?(c=h.pos.x-e.pos.x,p=h.pos.y-e.pos.y,g=l(c*c+p*p),0===g&&(c=(u.nextDouble()-.5)/50,p=(u.nextDouble()-.5)/50,g=l(c*c+p*p)),d=y*h.mass*e.mass/(g*g*g),a+=d*c,o+=d*p):x&&(c=m.massX/m.mass-e.pos.x,p=m.massY/m.mass-e.pos.y,g=l(c*c+p*p),0===g&&(c=(u.nextDouble()-.5)/50,p=(u.nextDouble()-.5)/50,g=l(c*c+p*p)),(m.right-m.left)/g<b?(d=y*m.mass*e.mass/(g*g*g),a+=d*c,o+=d*p):(m.quad0&&(t[s]=m.quad0,i+=1,s+=1),m.quad1&&(t[s]=m.quad1,i+=1,s+=1),m.quad2&&(t[s]=m.quad2,i+=1,s+=1),m.quad3&&(t[s]=m.quad3,i+=1,s+=1)))}e.force.x+=a,e.force.y+=o}function c(e){var t=n,a=n,o=r,l=r,d=e.length,c;for(c=d;c--;){var u=e[c].pos.x,g=e[c].pos.y;u<t&&(t=u),u>o&&(o=u),g<a&&(a=g),g>l&&(l=g)}var m=o-t,h=l-a;for(m>h?l=a+m:o=t+h,w=0,k=s(),k.left=t,k.right=o,k.top=a,k.bottom=l,c=d-1,0<=c&&(k.body=e[c]);c--;)p(e[c],k)}function p(e){for(_.reset(),_.push(k,e);!_.isEmpty();){var t=_.pop(),r=t.node,i=t.body;if(!r.body){var n=i.pos.x,l=i.pos.y;r.mass+=i.mass,r.massX+=i.mass*n,r.massY+=i.mass*l;var d=0,c=r.left,p=(r.right+c)/2,g=r.top,m=(r.bottom+g)/2;n>p&&(++d,c=p,p=r.right),l>m&&(d+=2,g=m,m=r.bottom);var y=a(r,d);y?_.push(y,i):(y=s(),y.left=c,y.top=g,y.right=p,y.bottom=m,y.body=i,o(r,d,y))}else{var f=r.body;if(r.body=null,h(f.pos,i.pos)){var x=3;do{var b=u.nextDouble(),v=(r.right-r.left)*b,w=(r.bottom-r.top)*b;f.pos.x=r.left+v,f.pos.y=r.top+w,x-=1}while(0<x&&h(f.pos,i.pos));if(0==x&&h(f.pos,i.pos))return}_.push(r,f),_.push(r,i)}}}t=t||{},t.gravity="number"==typeof t.gravity?t.gravity:-1,t.theta="number"==typeof t.theta?t.theta:.8;var u=e("ngraph.random").random(1984),g=e("./node"),m=e("./insertStack"),h=e("./isSamePosition"),y=t.gravity,f=[],_=new m,b=t.theta,v=[],w=0,k=s();return{insertBodies:c,getRoot:function(){return k},updateBodyForce:d,options:function(e){return e?("number"==typeof e.gravity&&(y=e.gravity),"number"==typeof e.theta&&(b=e.theta),this):{gravity:y,theta:b}}}}},{"./insertStack":1354,"./isSamePosition":1355,"./node":1356,"ngraph.random":1357}],1354:[function(e,t){function a(){this.stack=[],this.popIdx=0}function o(e,t){this.node=e,this.body=t}t.exports=a,a.prototype={isEmpty:function(){return 0===this.popIdx},push:function(e,t){var a=this.stack[this.popIdx];a?(a.node=e,a.body=t):this.stack[this.popIdx]=new o(e,t),++this.popIdx},pop:function(){if(0<this.popIdx)return this.stack[--this.popIdx]},reset:function(){this.popIdx=0}}},{}],1355:[function(e,t){var a=Math.abs;t.exports=function(e,t){var o=a(e.x-t.x),r=a(e.y-t.y);return 1e-8>o&&1e-8>r}},{}],1356:[function(e,t){t.exports=function(){this.body=null,this.quad0=null,this.quad1=null,this.quad2=null,this.quad3=null,this.mass=0,this.massX=0,this.massY=0,this.left=0,this.top=0,this.bottom=0,this.right=0}},{}],1357:[function(e,t){function a(e){var t="number"==typeof e?e:+new Date,a=function(){return t=4294967295&t+2127912214+(t<<12),t=4294967295&(3345072700^t^t>>>19),t=4294967295&t+374761393+(t<<5),t=4294967295&(t+3550635116^t<<9),t=4294967295&t+4251993797+(t<<3),t=4294967295&(3042594569^t^t>>>16),(268435455&t)/268435456};return{next:function(e){return Math.floor(a()*e)},nextDouble:function(){return a()}}}t.exports={random:a,randomIterator:function(e,t){var o=t||a();if("function"!=typeof o.next)throw new Error("customRandom does not match expected API: next() function is missing");return{forEach:function(a){var r,n,l;for(r=e.length-1;0<r;--r)n=o.next(r+1),l=e[n],e[n]=e[r],e[r]=l,a(l);e.length&&a(e[0])},shuffle:function(){var a,r,n;for(a=e.length-1;0<a;--a)r=o.next(a+1),n=e[r],e[r]=e[a],e[a]=n;return e}}}}},{}],1358:[function(e,t){function a(e){var t=i.betweenness(e);return r(t)}function o(e,t){var a=i.degree(e,t);return r(a)}function r(e){return Object.keys(e).sort(function(t,a){return e[a]-e[t]}).map(function(t){return{key:t,value:e[t]}})}var i=e("ngraph.centrality");t.exports=function(){return{betweennessCentrality:a,degreeCentrality:o}}},{"ngraph.centrality":427}],1359:[function(e,t){t.exports=function(){return{density:function(e,t){var a=e.getNodesCount();return 0===a?NaN:t?e.getLinksCount()/(a*(a-1)):2*e.getLinksCount()/(a*(a-1))}}}},{}],1360:[function(e,t){t.exports=function(e,t){var o={};return{bindDragNDrop:function(e,r){var i;if(r){var n=t.getNodeUI(e.id);i=a(n),"function"==typeof r.onStart&&i.onStart(r.onStart),"function"==typeof r.onDrag&&i.onDrag(r.onDrag),"function"==typeof r.onStop&&i.onStop(r.onStop),o[e.id]=i}else(i=o[e.id])&&(i.release(),delete o[e.id])}}};var a=e("./dragndrop.js")},{"./dragndrop.js":1361}],1361:[function(e,t){t.exports=function(t){var i=0,n=0,l=!1,s=0,d=function(t){var a=0,o=0;return t=t||window.event,t.pageX||t.pageY?(a=t.pageX,o=t.pageY):(t.clientX||t.clientY)&&(a=t.clientX+window.document.body.scrollLeft+window.document.documentElement.scrollLeft,o=t.clientY+window.document.body.scrollTop+window.document.documentElement.scrollTop),[a,o]},c=function(t,e,a){A&&A(t,{x:e-i,y:a-n}),i=e,n=a},p=function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},u=function(t){t.preventDefault&&t.preventDefault()},g=function(t){return p(t),!1},m=function(t){t=t||window.event,c(t,t.clientX,t.clientY)},h=function(t){if(t=t||window.event,l)return p(t),!1;var o=1===t.button&&null!==window.event||0===t.button;if(o)return i=t.clientX,n=t.clientY,I=t.target||t.srcElement,T&&T(t,{x:i,y:n}),a.on("mousemove",m),a.on("mouseup",y),p(t),L=window.document.onselectstart,E=window.document.ondragstart,window.document.onselectstart=g,I.ondragstart=g,!1},y=function(t){t=t||window.event,a.off("mousemove",m),a.off("mouseup",y),window.document.onselectstart=L,I.ondragstart=E,I=null,S&&S(t)},f=function(a){if("function"==typeof C){a=a||window.event,a.preventDefault&&a.preventDefault(),a.returnValue=!1;var o=d(a),i=r(t),n={x:o[0]-i[0],y:o[1]-i[1]},l;l=a.wheelDelta?a.wheelDelta/360:a.detail/-9,C(a,l,n)}},x=function(e){!C&&e?"webkit"===o.browser?t.addEventListener("mousewheel",f,!1):t.addEventListener("DOMMouseScroll",f,!1):C&&!e&&("webkit"===o.browser?t.removeEventListener("mousewheel",f,!1):t.removeEventListener("DOMMouseScroll",f,!1)),C=e},_=function(e,t){return(e.clientX-t.clientX)*(e.clientX-t.clientX)+(e.clientY-t.clientY)*(e.clientY-t.clientY)},b=function(t){if(1===t.touches.length){p(t);var e=t.touches[0];c(t,e.clientX,e.clientY)}else if(2===t.touches.length){var a=_(t.touches[0],t.touches[1]),o=0;a<s?o=-1:a>s&&(o=1),C(t,o,{x:t.touches[0].clientX,y:t.touches[0].clientY}),s=a,p(t),u(t)}},v=function(t){l=!1,a.off("touchmove",b),a.off("touchend",v),a.off("touchcancel",v),I=null,S&&S(t)},w=function(t,e){p(t),u(t),i=e.clientX,n=e.clientY,I=t.target||t.srcElement,T&&T(t,{x:i,y:n}),l||(l=!0,a.on("touchmove",b),a.on("touchend",v),a.on("touchcancel",v))},k=function(t){return 1===t.touches.length?w(t,t.touches[0]):void(2===t.touches.length&&(p(t),u(t),s=_(t.touches[0],t.touches[1])))},T,A,S,C,L,E,I;return t.addEventListener("mousedown",h),t.addEventListener("touchstart",k),{onStart:function(e){return T=e,this},onDrag:function(e){return A=e,this},onStop:function(e){return S=e,this},onScroll:function(e){return x(e),this},release:function(){t.removeEventListener("mousedown",h),t.removeEventListener("touchstart",k),a.off("mousemove",m),a.off("mouseup",y),a.off("touchmove",b),a.off("touchend",v),a.off("touchcancel",v),x(null)}}};var a=e("../Utils/documentEvents.js"),o=e("../Utils/browserInfo.js"),r=e("../Utils/findElementPosition.js")},{"../Utils/browserInfo.js":1365,"../Utils/documentEvents.js":1366,"../Utils/findElementPosition.js":1367}],1362:[function(e,t){t.exports=function(e,t){var o=a(t),r=null,i={},n={x:0,y:0};return o.mouseDown(function(t,a){r=t,n.x=a.clientX,n.y=a.clientY,o.mouseCapture(r);var e=i[t.id];return e&&e.onStart&&e.onStart(a,n),!0}).mouseUp(function(e){o.releaseMouseCapture(r),r=null;var t=i[e.id];return t&&t.onStop&&t.onStop(),!0}).mouseMove(function(t,a){if(r){var e=i[r.id];return e&&e.onDrag&&e.onDrag(a,{x:a.clientX-n.x,y:a.clientY-n.y}),n.x=a.clientX,n.y=a.clientY,!0}}),{bindDragNDrop:function(e,t){i[e.id]=t,t||delete i[e.id]}}};var a=e("../WebGL/webglInputEvents.js")},{"../WebGL/webglInputEvents.js":1383}],1363:[function(e,t){var a=Number.MIN_VALUE,o=Number.MAX_VALUE;t.exports=function(e,t){function l(e){return g[e]}t=r(t,{maxX:1024,maxY:1024,seed:"Deterministic randomness made me do this"});var s=i(t.seed),d=new n(o,o,a,a),c={},p=function(){return{x:s.next(t.maxX),y:s.next(t.maxY)}},u=function(e,t){e.x<t.x1&&(t.x1=e.x),e.x>t.x2&&(t.x2=e.x),e.y<t.y1&&(t.y1=e.y),e.y>t.y2&&(t.y2=e.y)},g="function"==typeof Object.create?Object.create(null):{},m=function(e){g[e.id]=p(e),u(g[e.id],d)},h=function(){0===e.getNodesCount()||(d.x1=o,d.y1=o,d.x2=a,d.y2=a,e.forEachNode(m))},y=function(e){c[e.id]=e},f=function(e){for(var t=0,a;t<e.length;++t)a=e[t],a.node&&("add"===a.changeType?m(a.node):delete g[a.node.id]),a.link&&("add"===a.changeType?y(a.link):delete c[a.link.id])};return e.forEachNode(m),e.forEachLink(y),e.on("changed",f),{run:function(){this.step()},step:function(){return h(),!0},getGraphRect:function(){return d},dispose:function(){e.off("change",f)},isNodePinned:function(){return!0},pinNode:function(){},getNodePosition:l,getLinkPosition:function(e){var t=c[e];return{from:l(t.fromId),to:l(t.toId)}},setNodePosition:function(e,t,a){var o=g[e];o&&(o.x=t,o.y=a)},placeNode:function(e){return"function"==typeof e?(p=e,h(),this):p(e)}}};var r=e("ngraph.merge"),i=e("ngraph.random").random,n=e("../Utils/rect.js")},{"../Utils/rect.js":1371,"ngraph.merge":1344,"ngraph.random":1357}],1364:[function(e,t){var a=e("ngraph.events");t.exports=function(e){if(console.log("This method is deprecated. Please use Viva.events() instead"),!e)return e;var t=void 0!==e.on||void 0!==e.off||void 0!==e.fire;return t?{extend:function(){return e},on:e.on,stop:e.off}:{extend:function(){var t=a(e);return t.addEventListener=t.on,t},on:e.on,stop:e.off}}},{"ngraph.events":1337}],1365:[function(e,t){t.exports=function(){if("undefined"==typeof window||!window.hasOwnProperty("navigator"))return{browser:"",version:"0"};var e=window.navigator.userAgent.toLowerCase(),t=/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version)?[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||0>e.indexOf("compatible")&&/(mozilla)(?:.*? rv:([\w.]+))?/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}}()},{}],1366:[function(e,t){function a(e,t){document.addEventListener(e,t)}function o(e,t){document.removeEventListener(e,t)}var r=e("./nullEvents.js");t.exports=function(){return void 0===typeof document?r:{on:a,off:o}}()},{"./nullEvents.js":1370}],1367:[function(e,t){t.exports=function(e){var t=0,a=0;if(e.offsetParent)do t+=e.offsetLeft,a+=e.offsetTop;while(null!==(e=e.offsetParent));return[t,a]}},{}],1368:[function(e,t){t.exports=function(e){if(!e)throw{message:"Cannot get dimensions of undefined container"};var t=e.clientWidth,a=e.clientHeight;return{left:0,top:0,width:t,height:a}}},{}],1369:[function(e,t){var a=e("gintersect");t.exports=function(e,t,o,r,i,n,l,s){return a(e,t,e,r,i,n,l,s)||a(e,r,o,r,i,n,l,s)||a(o,r,o,t,i,n,l,s)||a(o,t,e,t,i,n,l,s)}},{gintersect:211}],1370:[function(e,t){function a(){}t.exports=function(){return{on:a,off:a,stop:a}}()},{}],1371:[function(e,t){t.exports=function(e,t,a,o){this.x1=e||0,this.y1=t||0,this.x2=a||0,this.y2=o||0}},{}],1372:[function(e,t){var a=Math.max;(function(e){function o(){}t.exports=function(){function t(e){var t=new Date().getTime(),o=a(0,16-(t-n)),r=d.setTimeout(function(){e(t+o)},o);return n=t+o,r}function r(e){d.clearTimeout(e)}var n=0,l=["ms","moz","webkit","o"],s,d;for(d="undefined"==typeof window?"undefined"==typeof e?{setTimeout:o,clearTimeout:o}:e:window,s=0;s<l.length&&!d.requestAnimationFrame;++s){var c=l[s];d.requestAnimationFrame=d[c+"RequestAnimationFrame"],d.cancelAnimationFrame=d[c+"CancelAnimationFrame"]||d[c+"CancelRequestAnimationFrame"]}return d.requestAnimationFrame||(d.requestAnimationFrame=t),d.cancelAnimationFrame||(d.cancelAnimationFrame=r),function(e){function t(){r=d.requestAnimationFrame(t),e()||a()}function a(){d.cancelAnimationFrame(r),r=0}function o(){r||t()}var r;return t(),{stop:a,restart:o}}}()}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{}],1373:[function(e,t){function a(e,t){window.addEventListener(e,t)}function o(e,t){window.removeEventListener(e,t)}var r=e("./nullEvents.js");t.exports=function(){return"undefined"==typeof window?r:{on:a,off:o}}()},{"./nullEvents.js":1370}],1374:[function(e,t){var a=Math.pow;t.exports=function(e,t){function p(e){if("string"==typeof F)return 0<=F.indexOf(e);return"boolean"!=typeof F||F}function u(){B=B||window.document.body,M=M||r(e,{springLength:80,springCoeff:2e-4}),j=j||i(e,{container:B}),t.hasOwnProperty("renderLinks")||(t.renderLinks=!0),t.prerender=t.prerender||0,W=(j.inputManager||l)(e,j)}function g(){j.beginRender(),t.renderLinks&&j.renderLinks(),j.renderNodes(),j.endRender()}function m(){return U=M.step()&&!H,g(),!U}function h(e){X||(e===void 0?X=s(m,30):X=s(function(){if(e-=1,0>e){return!1}return m()},30))}function y(){q||(U=!1,X.restart())}function f(){if("number"==typeof t.prerender&&0<t.prerender)for(var e=0;e<t.prerender;e+=1)M.step()}function x(){var e=M.getGraphRect(),t=d(B),a=(e.x2+e.x1)/2,o=(e.y2+e.y1)/2;G.offsetX=t.width/2-(a*G.scale-a),G.offsetY=t.height/2-(o*G.scale-o),j.graphCenterChanged(G.offsetX,G.offsetY),V=!1}function _(e){var t=M.getNodePosition(e.id);j.addNode(e,t)}function b(e){j.releaseNode(e)}function v(e){var t=M.getLinkPosition(e.id);j.addLink(e,t)}function w(e){j.releaseLink(e)}function k(t){if(p("node")){var a=!1;W.bindDragNDrop(t,{onStart:function(){a=M.isNodePinned(t),M.pinNode(t,!0),H=!0,y()},onDrag:function(a,e){var o=M.getNodePosition(t.id);M.setNodePosition(t.id,o.x+e.x/G.scale,o.y+e.y/G.scale),H=!0,g()},onStop:function(){M.pinNode(t,a),H=!1}})}}function T(e){W.bindDragNDrop(e,null)}function A(){j.init(B),e.forEachNode(_),t.renderLinks&&e.forEachLink(v)}function S(){j.release(B)}function C(t){var a=t.node;"add"===t.changeType?(_(a),k(a),V&&x()):"remove"===t.changeType?(T(a),b(a),0===e.getNodesCount()&&(V=!0)):"update"===t.changeType&&(T(a),b(a),_(a),k(a))}function L(e){var a=e.link;if("add"===e.changeType)t.renderLinks&&v(a);else if("remove"===e.changeType)t.renderLinks&&w(a);else if("update"===e.changeType)throw"Update type is not implemented. TODO: Implement me!"}function E(e){var t,a;for(t=0;t<e.length;t+=1)a=e[t],a.node?C(a):a.link&&L(a);y()}function I(){x(),m()}function P(){Z&&(Z.release(),Z=null)}function z(){e.off("changed",E)}function D(e,t){if(!t){var o=d(B);t={x:o.width/2,y:o.height/2}}var r=a(1+.4,e?-.2:.2);return G.scale=j.scale(r,t),g(),Y.fire("scale",G.scale),G.scale}function O(){n.on("resize",I),P(),p("drag")&&(Z=c(B),Z.onDrag(function(t,e){j.translateRel(e.x,e.y),g(),Y.fire("drag",e)})),p("scroll")&&(!Z&&(Z=c(B)),Z.onScroll(function(t,e,a){D(0>e,a)})),e.forEachNode(k),z(),e.on("changed",E)}function R(){N=!1,z(),P(),n.off("resize",I),Y.off(),X.stop(),e.forEachLink(function(e){t.renderLinks&&w(e)}),e.forEachNode(function(e){T(e),b(e)}),M.dispose(),S()}t=t||{};var M=t.layout,j=t.graphics,B=t.container,F=!(t.interactive!==void 0)||t.interactive,N=!1,V=!0,U=!1,H=!1,q=!1,G={offsetX:0,offsetY:0,scale:1},Y=o({}),W,X,Z;return{run:function(e){return N||(u(),f(),A(),x(),O(),N=!0),h(e),this},reset:function(){j.resetScale(),x(),G.scale=1},pause:function(){q=!0,X.stop()},resume:function(){q=!1,X.restart()},rerender:function(){return g(),this},zoomOut:function(){return D(!0)},zoomIn:function(){return D(!1)},getTransform:function(){return G},moveTo:function(e,t){j.graphCenterChanged(G.offsetX-e*G.scale,G.offsetY-t*G.scale),g()},getGraphics:function(){return j},getLayout:function(){return M},dispose:function(){R()},on:function(e,t){return Y.on(e,t),this},off:function(e,t){return Y.off(e,t),this}}};var o=e("ngraph.events"),r=e("ngraph.forcelayout"),i=e("./svgGraphics.js"),n=e("../Utils/windowEvents.js"),l=e("../Input/domInputManager.js"),s=e("../Utils/timer.js"),d=e("../Utils/getDimensions.js"),c=e("../Input/dragndrop.js")},{"../Input/domInputManager.js":1360,"../Input/dragndrop.js":1361,"../Utils/getDimensions.js":1368,"../Utils/timer.js":1372,"../Utils/windowEvents.js":1373,"./svgGraphics.js":1375,"ngraph.events":1337,"ngraph.forcelayout":1339}],1375:[function(e,t){t.exports=function(){function e(){var e=a("svg");return b=a("g").attr("buffered-rendering","dynamic"),e.appendChild(b),e}var i=0,n=0,l=1,s={},d={},c=function(){return a("rect").attr("width",10).attr("height",10).attr("fill","#00a2e8")},p=function(e,t){e.attr("x",t.x-5).attr("y",t.y-5)},u=function(){return a("line").attr("stroke","#999")},g=function(e,t,a){e.attr("x1",t.x).attr("y1",t.y).attr("x2",a.x).attr("y2",a.y)},m=function(e){e.fire("rescaled")},h={x:0,y:0},y={x:0,y:0},f={x:0,y:0},_=function(){if(b){var e="matrix("+l+", 0, 0,"+l+","+i+","+n+")";b.attr("transform",e)}},b,v,w;v=e();var k={getNodeUI:function(e){return s[e]},getLinkUI:function(e){return d[e]},node:function(e){if("function"==typeof e)return c=e,this},link:function(e){if("function"==typeof e)return u=e,this},placeNode:function(e){return p=e,this},placeLink:function(e){return g=e,this},beginRender:function(){},endRender:function(){},graphCenterChanged:function(e,t){i=e,n=t,_()},inputManager:r,translateRel:function(e,a){var o=v.createSVGPoint(),r=b.getCTM(),t=v.createSVGPoint().matrixTransform(r.inverse());o.x=e,o.y=a,o=o.matrixTransform(r.inverse()),o.x=(o.x-t.x)*r.a,o.y=(o.y-t.y)*r.d,r.e+=o.x,r.f+=o.y;var i="matrix("+r.a+", 0, 0,"+r.d+","+r.e+","+r.f+")";b.attr("transform",i)},scale:function(e,a){var o=v.createSVGPoint();o.x=a.x,o.y=a.y,o=o.matrixTransform(b.getCTM().inverse());var r=v.createSVGMatrix().translate(o.x,o.y).scale(e).translate(-o.x,-o.y),s=b.getCTM().multiply(r);l=s.a,i=s.e,n=s.f;var t="matrix("+s.a+", 0, 0,"+s.d+","+s.e+","+s.f+")";return b.attr("transform",t),m(this),l},resetScale:function(){l=1;return b.attr("transform","matrix(1, 0, 0, 1, 0, 0)"),m(this),this},init:function(e){e.appendChild(v),_(),"function"==typeof w&&w(v)},release:function(e){v&&e&&e.removeChild(v)},addLink:function(e,t){var a=u(e);if(a)return a.position=t,a.link=e,d[e.id]=a,0<b.childElementCount?b.insertBefore(a,b.firstChild):b.appendChild(a),a},releaseLink:function(e){var t=d[e.id];t&&(b.removeChild(t),delete d[e.id])},addNode:function(e,t){var a=c(e);if(a)return a.position=t,a.node=e,s[e.id]=a,b.appendChild(a),a},releaseNode:function(e){var t=s[e.id];t&&(b.removeChild(t),delete s[e.id])},renderNodes:function(){for(var e in s)if(s.hasOwnProperty(e)){var t=s[e];h.x=t.position.x,h.y=t.position.y,p(t,h,t.node)}},renderLinks:function(){for(var e in d)if(d.hasOwnProperty(e)){var t=d[e];y.x=t.position.from.x,y.y=t.position.from.y,f.x=t.position.to.x,f.y=t.position.to.y,g(t,y,f,t.link)}},getGraphicsRoot:function(e){return"function"==typeof e&&(v?e(v):w=e),v},getSvgRoot:function(){return v}};return o(k),k};var a=e("simplesvg"),o=e("ngraph.events"),r=e("../Input/domInputManager.js")},{"../Input/domInputManager.js":1360,"ngraph.events":1337,simplesvg:1284}],1376:[function(e,t){var a=Math.max;t.exports=function(e){e=d(e,{enableBlending:!0,preserveDrawingBuffer:!1,clearColor:!1,clearColorValue:{r:1,g:1,b:1,a:1}});var t=0,c=0,u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],g=[],m=[],h={},y={},f=r(),x=i(),_=function(){return n()},b=function(){return l(3014898687)},v=function(){f.updateTransform(u),x.updateTransform(u)},w=function(){u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},k=function(){A&&S&&(L=S.width=a(A.offsetWidth,1),E=S.height=a(A.offsetHeight,1),C&&C.viewport(0,0,L,E),f&&f.updateSize(L/2,E/2),x&&x.updateSize(L/2,E/2))},T=function(e){e.fire("rescaled")},A,S,C,L,E,I,P,z;S=window.document.createElement("canvas");var D={getLinkUI:function(e){return y[e]},getNodeUI:function(e){return h[e]},node:function(e){if("function"==typeof e)return _=e,this},link:function(e){if("function"==typeof e)return b=e,this},placeNode:function(e){return I=e,this},placeLink:function(e){return P=e,this},inputManager:o,beginRender:function(){},endRender:function(){0<c&&f.render(),0<t&&x.render()},bringLinkToFront:function(e){var t=f.getFrontLinkId(),a,o;f.bringToFront(e),t>e.id&&(a=e.id,o=m[t],m[t]=m[a],m[t].id=t,m[a]=o,m[a].id=a)},graphCenterChanged:function(e,t){u[12]=2*e/L-1,u[13]=1-2*t/E,v()},addLink:function(e,t){var a=c++,o=b(e);return o.id=a,o.pos=t,f.createLink(o),m[a]=o,y[e.id]=o,o},addNode:function(e,a){var o=t++,r=_(e);return r.id=o,r.position=a,r.node=e,x.createNode(r),g[o]=r,h[e.id]=r,r},translateRel:function(e,t){u[12]+=2*u[0]*e/L/u[0],u[13]-=2*u[5]*t/E/u[5],v()},scale:function(e,t){var a=2*t.x/L-1,o=1-2*t.y/E;return a-=u[12],o-=u[13],u[12]+=a*(1-e),u[13]+=o*(1-e),u[0]*=e,u[5]*=e,v(),T(this),u[0]},resetScale:function(){return w(),C&&(k(),v()),this},updateSize:k,init:function(t){var a={};if(e.preserveDrawingBuffer&&(a.preserveDrawingBuffer=!0),A=t,k(),w(),A.appendChild(S),C=S.getContext("experimental-webgl",a),!C){throw window.alert("Could not initialize WebGL. Seems like the browser doesn't support it."),"Could not initialize WebGL. Seems like the browser doesn't support it."}if(e.enableBlending&&(C.blendFunc(C.SRC_ALPHA,C.ONE_MINUS_SRC_ALPHA),C.enable(C.BLEND)),e.clearColor){var o=e.clearColorValue;C.clearColor(o.r,o.g,o.b,o.a),this.beginRender=function(){C.clear(C.COLOR_BUFFER_BIT)}}f.load(C),f.updateSize(L/2,E/2),x.load(C),x.updateSize(L/2,E/2),v(),"function"==typeof z&&z(S)},release:function(e){S&&e&&e.removeChild(S)},isSupported:function(){var e=window.document.createElement("canvas"),t=e&&e.getContext&&e.getContext("experimental-webgl");return t},releaseLink:function(e){0<c&&(c-=1);var t=y[e.id];delete y[e.id],f.removeLink(t);var a=t.id;if(a<c){if(0===c||c===a)return;var o=m[c];m[a]=o,o.id=a}},releaseNode:function(e){0<t&&(t-=1);var a=h[e.id];delete h[e.id],x.removeNode(a);var o=a.id;if(o<t){if(0===t||t===o)return;var r=g[t];g[o]=r,r.id=o,x.replaceProperties(a,r)}},renderNodes:function(){for(var e={x:0,y:0},a=0,o;a<t;++a)o=g[a],e.x=o.position.x,e.y=o.position.y,I&&I(o,e),x.position(o,e)},renderLinks:function(){if(!this.omitLinksRendering)for(var e={x:0,y:0},t={x:0,y:0},a=0;a<c;++a){var o=m[a],r=o.pos.from;t.x=r.x,t.y=-r.y,r=o.pos.to,e.x=r.x,e.y=-r.y,P&&P(o,t,e),f.position(o,t,e)}},getGraphicsRoot:function(e){return"function"==typeof e&&(S?e(S):z=e),S},setNodeProgram:function(e){if(!C&&e)x=e;else if(e)throw"Not implemented. Cannot swap shader on the fly... Yet."},setLinkProgram:function(e){if(!C&&e)f=e;else if(e)throw"Not implemented. Cannot swap shader on the fly... Yet."},transformClientToGraphCoordinates:function(e){return e.x=2*e.x/L-1,e.y=1-2*e.y/E,e.x=(e.x-u[12])/u[0],e.y=(e.y-u[13])/u[5],e.x*=L/2,e.y*=-E/2,e},transformGraphToClientCoordinates:function(e){return e.x/=L/2,e.y/=-E/2,e.x=e.x*u[0]+u[12],e.y=e.y*u[5]+u[13],e.x=(e.x+1)*L/2,e.y=(1-e.y)*E/2,e},getNodeAtClientPos:function(e,a){if("function"!=typeof a)return null;this.transformClientToGraphCoordinates(e);for(var o=0;o<t;++o)if(a(g[o],e.x,e.y))return g[o].node;return null}};return s(D),D};var o=e("../Input/webglInputManager.js"),r=e("../WebGL/webglLinkProgram.js"),i=e("../WebGL/webglNodeProgram.js"),n=e("../WebGL/webglSquare.js"),l=e("../WebGL/webglLine.js"),s=e("ngraph.events"),d=e("ngraph.merge")},{"../Input/webglInputManager.js":1362,"../WebGL/webglLine.js":1384,"../WebGL/webglLinkProgram.js":1385,"../WebGL/webglNodeProgram.js":1386,"../WebGL/webglSquare.js":1387,"ngraph.events":1337,"ngraph.merge":1344}],1377:[function(e,t){t.exports=function(e){var t=10414335;if(!("string"==typeof e&&e))"number"==typeof e&&(t=e);else if(4===e.length&&(e=e.replace(/([^#])/g,"$1$1")),9===e.length)t=parseInt(e.substr(1),16);else if(7===e.length)t=255|parseInt(e.substr(1),16)<<8;else throw"Color expected in hex format with preceding \"#\". E.g. #00ff00. Got value: "+e;return t}},{}],1378:[function(e,t){t.exports=function(e){this.canvas=window.document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.isDirty=!1,this.canvas.width=this.canvas.height=e}},{}],1379:[function(e,t){function a(e,t,a,o){for(var r=0;r<o;++r)e[t+r]=e[a+r]}function o(e,t,a,o){for(var r=0,n;r<o;++r)n=e[t+r],e[t+r]=e[a+r],e[a+r]=n}t.exports=function(e){function t(t,a){var o=e.createShader(a);if(e.shaderSource(o,t),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS)){var r=e.getShaderInfoLog(o);throw window.alert(r),r}return o}return{createProgram:function(a,o){var r=e.createProgram(),i=t(a,e.VERTEX_SHADER),n=t(o,e.FRAGMENT_SHADER);if(e.attachShader(r,i),e.attachShader(r,n),e.linkProgram(r),!e.getProgramParameter(r,e.LINK_STATUS)){var l=e.getShaderInfoLog(r);throw window.alert(l),l}return r},extendArray:function(e,t,a){if((t+1)*a>e.length){var o=new Float32Array(2*(e.length*a));return o.set(e),o}return e},copyArrayPart:a,swapArrayPart:o,getLocations:function(t,a){for(var o={},r=0;r<a.length;++r){var n=a[r],l=-1;if("a"===n[0]&&"_"===n[1]){if(l=e.getAttribLocation(t,n),-1===l)throw new Error("Program doesn't have required attribute: "+n);o[n.slice(2)]=l}else if("u"===n[0]&&"_"===n[1]){if(l=e.getUniformLocation(t,n),null===l)throw new Error("Program doesn't have required uniform: "+n);o[n.slice(2)]=l}else throw new Error("Couldn't figure out your intent. All uniforms should start with 'u_' prefix, and attributes with 'a_'")}return o},context:e}}},{}],1380:[function(e,t){function a(e){return 0==(e&e-1)}var o=e("./texture.js");t.exports=function(e){function t(e){var t=m[e];if(!t)return!1;if(delete m[e],g-=1,g===t.offset)return!0;var a=l(t.offset),o=l(g);c(o,a);var r=m[x[g]];return r.offset=t.offset,x[t.offset]=x[g],d(),!0}function r(e,t){if(m.hasOwnProperty(e))t(m[e]);else{var a=new window.Image,o=g;g+=1,a.crossOrigin="anonymous",a.onload=function(){d(),n(o,a,t)},a.src=e}}function i(){var e=new o(p*u);f.push(e)}function n(e,t,a){var o=l(e),r={offset:e};o.textureNumber>=f.length&&i();var n=f[o.textureNumber];n.ctx.drawImage(t,o.col*u,o.row*u,u,u),x[e]=t.src,m[t.src]=r,n.isDirty=!0,a(r)}function l(t){var a=t%e;return{textureNumber:t/e<<0,row:a/p<<0,col:a%p}}function s(){b.isDirty=!0,h=0,_=null}function d(){_&&(window.clearTimeout(_),h+=1,_=null),10<h?s():_=window.setTimeout(s,400)}function c(e,t){var a=f[e.textureNumber].canvas,o=f[t.textureNumber].ctx,r=t.col*u,i=t.row*u;o.drawImage(a,e.col*u,e.row*u,u,u,r,i,u,u),f[e.textureNumber].isDirty=!0,f[t.textureNumber].isDirty=!0}var p=Math.sqrt(e||1024)<<0,u=p,g=1,m={},h=0,f=[],x=[],_;if(!a(e))throw"Tiles per texture should be power of two.";var b={isDirty:!1,clearDirty:function(){var e;for(b.isDirty=!1,e=0;e<f.length;++e)f[e].isDirty=!1},remove:t,getTextures:function(){return f},getCoordinates:function(e){return m[e]},load:r};return b}},{"./texture.js":1378}],1381:[function(e,t){t.exports=function(e,t){return{_texture:0,_offset:0,size:"number"==typeof e?e:32,src:t}}},{}],1382:[function(e,t){function a(){return"precision mediump float;\nvarying vec4 color;\nvarying vec3 vTextureCoord;\nuniform sampler2D u_sampler0;\nuniform sampler2D u_sampler1;\nuniform sampler2D u_sampler2;\nuniform sampler2D u_sampler3;\nvoid main(void) {\n   if (vTextureCoord.z == 0.) {\n     gl_FragColor = texture2D(u_sampler0, vTextureCoord.xy);\n   } else if (vTextureCoord.z == 1.) {\n     gl_FragColor = texture2D(u_sampler1, vTextureCoord.xy);\n   } else if (vTextureCoord.z == 2.) {\n     gl_FragColor = texture2D(u_sampler2, vTextureCoord.xy);\n   } else if (vTextureCoord.z == 3.) {\n     gl_FragColor = texture2D(u_sampler3, vTextureCoord.xy);\n   } else { gl_FragColor = vec4(0, 1, 0, 1); }\n}"}function o(){return"attribute vec2 a_vertexPos;\nattribute float a_customAttributes;\nuniform vec2 u_screenSize;\nuniform mat4 u_transform;\nuniform float u_tilesPerTexture;\nvarying vec3 vTextureCoord;\nvoid main(void) {\n   gl_Position = u_transform * vec4(a_vertexPos/u_screenSize, 0, 1);\nfloat corner = mod(a_customAttributes, 4.);\nfloat tileIndex = mod(floor(a_customAttributes / 4.), u_tilesPerTexture);\nfloat tilesPerRow = sqrt(u_tilesPerTexture);\nfloat tileSize = 1./tilesPerRow;\nfloat tileColumn = mod(tileIndex, tilesPerRow);\nfloat tileRow = floor(tileIndex/tilesPerRow);\nif(corner == 0.0) {\n  vTextureCoord.xy = vec2(0, 1);\n} else if(corner == 1.0) {\n  vTextureCoord.xy = vec2(1, 1);\n} else if(corner == 2.0) {\n  vTextureCoord.xy = vec2(0, 0);\n} else {\n  vTextureCoord.xy = vec2(1, 0);\n}\nvTextureCoord *= tileSize;\nvTextureCoord.x += tileColumn * tileSize;\nvTextureCoord.y += tileRow * tileSize;\nvTextureCoord.z = floor(floor(a_customAttributes / 4.)/u_tilesPerTexture);\n}"}var r=e("./webglAtlas.js"),i=e("./webgl.js");t.exports=function(e){function t(e,t){e.nativeObject&&x.deleteTexture(e.nativeObject);var a=x.createTexture();x.activeTexture(x["TEXTURE"+t]),x.bindTexture(x.TEXTURE_2D,a),x.texImage2D(x.TEXTURE_2D,0,x.RGBA,x.RGBA,x.UNSIGNED_BYTE,e.canvas),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,x.LINEAR),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,x.LINEAR_MIPMAP_NEAREST),x.generateMipmap(x.TEXTURE_2D),x.uniform1i(v["sampler"+t],t),e.nativeObject=a}function n(){if(y.isDirty){var e=y.getTextures(),a;for(a=0;a<e.length;++a)(e[a].isDirty||!e[a].nativeObject)&&t(e[a],a);y.clearDirty()}}function l(t){x=t,b=i(t),y=new r(e),f=b.createProgram(g,u),x.useProgram(f),v=b.getLocations(f,["a_vertexPos","a_customAttributes","u_screenSize","u_transform","u_sampler0","u_sampler1","u_sampler2","u_sampler3","u_tilesPerTexture"]),x.uniform1f(v.tilesPerTexture,e),x.enableVertexAttribArray(v.vertexPos),x.enableVertexAttribArray(v.customAttributes),_=x.createBuffer()}function s(e,t){var a=e.id*18;h[a]=t.x-e.size,h[a+1]=-t.y-e.size,h[a+2]=4*e._offset,h[a+3]=t.x+e.size,h[a+4]=-t.y-e.size,h[a+5]=4*e._offset+1,h[a+6]=t.x-e.size,h[a+7]=-t.y+e.size,h[a+8]=4*e._offset+2,h[a+9]=t.x-e.size,h[a+10]=-t.y+e.size,h[a+11]=4*e._offset+2,h[a+12]=t.x+e.size,h[a+13]=-t.y-e.size,h[a+14]=4*e._offset+1,h[a+15]=t.x+e.size,h[a+16]=-t.y+e.size,h[a+17]=4*e._offset+3}function d(e){h=b.extendArray(h,m,18),m+=1;var t=y.getCoordinates(e.src);t?e._offset=t.offset:(e._offset=0,y.load(e.src,function(t){e._offset=t.offset}))}function c(e){0<m&&(m-=1),e.id<m&&0<m&&(e.src&&y.remove(e.src),b.copyArrayPart(h,e.id*18,m*18,18))}function p(){x.useProgram(f),x.bindBuffer(x.ARRAY_BUFFER,_),x.bufferData(x.ARRAY_BUFFER,h,x.DYNAMIC_DRAW),S&&(S=!1,x.uniformMatrix4fv(v.transform,!1,A),x.uniform2f(v.screenSize,k,T)),x.vertexAttribPointer(v.vertexPos,2,x.FLOAT,!1,3*Float32Array.BYTES_PER_ELEMENT,0),x.vertexAttribPointer(v.customAttributes,1,x.FLOAT,!1,3*Float32Array.BYTES_PER_ELEMENT,8),n(),x.drawArrays(x.TRIANGLES,0,6*m)}var u=a(),g=o(),e=e||1024,m=0,h=new Float32Array(64),y,f,x,_,b,v,k,T,A,S;return{load:l,position:s,createNode:d,removeNode:c,replaceProperties:function(e,t){t._offset=e._offset},updateTransform:function(e){S=!0,A=e},updateSize:function(e,t){k=e,T=t,S=!0},render:p}}},{"./webgl.js":1379,"./webglAtlas.js":1380}],1383:[function(e,t){var a=e("../Utils/documentEvents.js");t.exports=function(e){function t(e,t,a){if(e&&e.size){var o=e.position,r=e.size;return o.x-r<t&&t<o.x+r&&o.y-r<a&&a<o.y+r}return!0}function o(a){return e.getNodeAtClientPos(a,t)}function r(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}function i(t){return r(t),!1}function n(e,t){var a,o;for(a=0;a<e.length;a+=1)if(o=e[a].apply(void 0,t),o)return!0}if(e.webglInputEvents)return e.webglInputEvents;var l=null,s=[],d=[],c=[],p=[],u=[],g=[],m=[],h=e.getGraphicsRoot(),y,f;(function(e){var t={x:0,y:0},h=null,x=1,_=+new Date,b=function(a){n(u,[h,a]),t.x=a.clientX,t.y=a.clientY},v=function(){a.off("mousemove",b),a.off("mouseup",v)},w=function(){f=e.getBoundingClientRect()};window.addEventListener("resize",w),w(),e.addEventListener("mousemove",function(a){if(!l){0==x++%7&&(w(),x=1);var e=!1,i;t.x=a.clientX-f.left,t.y=a.clientY-f.top,i=o(t),i&&h!==i?(h&&n(d,[h]),h=i,e=e||n(s,[h])):null===i&&h!==i&&(e=e||n(d,[h]),h=null),e&&r(a)}}),e.addEventListener("mousedown",function(l){var e=!1,s;w(),t.x=l.clientX-f.left,t.y=l.clientY-f.top,s=[o(t),l],s[0]?(e=n(c,s),a.on("mousemove",b),a.on("mouseup",v),y=window.document.onselectstart,window.document.onselectstart=i,h=s[0]):h=null,e&&r(l)}),e.addEventListener("mouseup",function(a){var e=+new Date,i;t.x=a.clientX-f.left,t.y=a.clientY-f.top;var l=o(t),s=l===h;i=[l||h,a],i[0]&&(window.document.onselectstart=y,400>e-_&&s?n(m,i):n(g,i),_=e,n(p,i)&&r(a))})})(h);var x={mouseEnter:function(e){return"function"==typeof e&&s.push(e),x},mouseLeave:function(e){return"function"==typeof e&&d.push(e),x},mouseDown:function(e){return"function"==typeof e&&c.push(e),x},mouseUp:function(e){return"function"==typeof e&&p.push(e),x},mouseMove:function(e){return"function"==typeof e&&u.push(e),x},click:function(e){return"function"==typeof e&&g.push(e),x},dblClick:function(e){return"function"==typeof e&&m.push(e),x},mouseCapture:function(e){l=e},releaseMouseCapture:function(){l=null}};return e.webglInputEvents=x,x}},{"../Utils/documentEvents.js":1366}],1384:[function(e,t){var a=e("./parseColor.js");t.exports=function(e){return{color:a(e)}}},{"./parseColor.js":1377}],1385:[function(e,t){var a=e("./webgl.js");t.exports=function(){var e=2*(2*Float32Array.BYTES_PER_ELEMENT+Uint32Array.BYTES_PER_ELEMENT),t=0,o=new ArrayBuffer(16*e),r=new Float32Array(o),i=new Uint32Array(o),n=function(){if((t+1)*e>o.byteLength){var a=new ArrayBuffer(2*o.byteLength),n=new Float32Array(a),l=new Uint32Array(a);l.set(i),r=n,i=l,o=a}},l,s,d,c,p,u,g,m,h,y;return{load:function(e){s=e,c=a(e),l=c.createProgram("attribute vec2 a_vertexPos;\nattribute vec4 a_color;\nuniform vec2 u_screenSize;\nuniform mat4 u_transform;\nvarying vec4 color;\nvoid main(void) {\n   gl_Position = u_transform * vec4(a_vertexPos/u_screenSize, 0.0, 1.0);\n   color = a_color.abgr;\n}","precision mediump float;\nvarying vec4 color;\nvoid main(void) {\n   gl_FragColor = color;\n}"),s.useProgram(l),p=c.getLocations(l,["a_vertexPos","a_color","u_screenSize","u_transform"]),s.enableVertexAttribArray(p.vertexPos),s.enableVertexAttribArray(p.color),d=s.createBuffer()},position:function(e,t,a){var o=e.id,n=o*6;r[n]=t.x,r[n+1]=t.y,i[n+2]=e.color,r[n+3]=a.x,r[n+4]=a.y,i[n+5]=e.color},createLink:function(e){n(),t+=1,u=e.id},removeLink:function(e){0<t&&(t-=1),e.id<t&&0<t&&c.copyArrayPart(i,e.id*6,t*6,6)},updateTransform:function(e){y=!0,h=e},updateSize:function(e,t){g=e,m=t,y=!0},render:function(){s.useProgram(l),s.bindBuffer(s.ARRAY_BUFFER,d),s.bufferData(s.ARRAY_BUFFER,o,s.DYNAMIC_DRAW),y&&(y=!1,s.uniformMatrix4fv(p.transform,!1,h),s.uniform2f(p.screenSize,g,m)),s.vertexAttribPointer(p.vertexPos,2,s.FLOAT,!1,3*Float32Array.BYTES_PER_ELEMENT,0),s.vertexAttribPointer(p.color,4,s.UNSIGNED_BYTE,!0,3*Float32Array.BYTES_PER_ELEMENT,8),s.drawArrays(s.LINES,0,2*t),u=t-1},bringToFront:function(e){u>e.id&&c.swapArrayPart(r,e.id*6,u*6,6),0<u&&(u-=1)},getFrontLinkId:function(){return u}}}},{"./webgl.js":1379}],1386:[function(e,t){var a=e("./webgl.js");t.exports=function(){function e(){if((u+1)*n>=d.byteLength){var e=new ArrayBuffer(2*d.byteLength),t=new Float32Array(e),a=new Uint32Array(e);a.set(p),c=t,p=a,d=e}}function t(e){m=e,f=a(e),g=f.createProgram(s,l),m.useProgram(g),y=f.getLocations(g,["a_vertexPos","a_color","u_screenSize","u_transform"]),m.enableVertexAttribArray(y.vertexPos),m.enableVertexAttribArray(y.color),h=m.createBuffer()}function o(e,t){var a=e.id;c[a*4]=t.x,c[a*4+1]=-t.y,c[a*4+2]=e.size,p[a*4+3]=e.color}function r(e){0<u&&(u-=1),e.id<u&&0<u&&f.copyArrayPart(p,e.id*4,u*4,4)}function i(){m.useProgram(g),m.bindBuffer(m.ARRAY_BUFFER,h),m.bufferData(m.ARRAY_BUFFER,d,m.DYNAMIC_DRAW),v&&(v=!1,m.uniformMatrix4fv(y.transform,!1,b),m.uniform2f(y.screenSize,x,_)),m.vertexAttribPointer(y.vertexPos,3,m.FLOAT,!1,4*Float32Array.BYTES_PER_ELEMENT,0),m.vertexAttribPointer(y.color,4,m.UNSIGNED_BYTE,!0,4*Float32Array.BYTES_PER_ELEMENT,12),m.drawArrays(m.POINTS,0,u)}var n=3*Float32Array.BYTES_PER_ELEMENT+Uint32Array.BYTES_PER_ELEMENT,l="precision mediump float;\nvarying vec4 color;\nvoid main(void) {\n   gl_FragColor = color;\n}",s="attribute vec3 a_vertexPos;\nattribute vec4 a_color;\nuniform vec2 u_screenSize;\nuniform mat4 u_transform;\nvarying vec4 color;\nvoid main(void) {\n   gl_Position = u_transform * vec4(a_vertexPos.xy/u_screenSize, 0, 1);\n   gl_PointSize = a_vertexPos.z * u_transform[0][0];\n   color = a_color.abgr;\n}",d=new ArrayBuffer(16*n),c=new Float32Array(d),p=new Uint32Array(d),u=0,g,m,h,y,f,x,_,b,v;return{load:t,position:o,updateTransform:function(e){v=!0,b=e},updateSize:function(e,t){x=e,_=t,v=!0},removeNode:r,createNode:function(){e(),u+=1},replaceProperties:function(){},render:i}}},{"./webgl.js":1379}],1387:[function(e,t){var a=e("./parseColor.js");t.exports=function(e,t){return{size:"number"==typeof e?e:10,color:a(t)}}},{"./parseColor.js":1377}],1388:[function(e,t){t.exports="0.10.1"},{}],1389:[function(e,t){var a=e("ngraph.random"),o={lazyExtend:function(){return e("ngraph.merge").apply(this,arguments)},randomIterator:function(){return a.randomIterator.apply(a,arguments)},random:function(){return a.random.apply(a,arguments)},events:e("ngraph.events")};o.Graph={version:e("./version.js"),graph:e("ngraph.graph"),serializer:function(){return{loadFromJSON:e("ngraph.fromjson"),storeToJSON:e("ngraph.tojson")}},centrality:e("./Algorithms/centrality.js"),operations:e("./Algorithms/operations.js"),geom:function(){return{intersect:e("gintersect"),intersectRect:e("./Utils/intersectRect.js")}},webgl:e("./WebGL/webgl.js"),webglInputEvents:e("./WebGL/webglInputEvents.js"),generator:function(){return e("ngraph.generators")},Input:{domInputManager:e("./Input/domInputManager.js"),webglInputManager:e("./Input/webglInputManager.js")},Utils:{dragndrop:e("./Input/dragndrop.js"),findElementPosition:e("./Utils/findElementPosition.js"),timer:e("./Utils/timer.js"),getDimension:e("./Utils/getDimensions.js"),events:e("./Utils/backwardCompatibleEvents.js")},Layout:{forceDirected:e("ngraph.forcelayout"),constant:e("./Layout/constant.js")},View:{Texture:e("./WebGL/texture.js"),webglAtlas:e("./WebGL/webglAtlas.js"),webglImageNodeProgram:e("./WebGL/webglImageNodeProgram.js"),webglLinkProgram:e("./WebGL/webglLinkProgram.js"),webglNodeProgram:e("./WebGL/webglNodeProgram.js"),webglLine:e("./WebGL/webglLine.js"),webglSquare:e("./WebGL/webglSquare.js"),webglImage:e("./WebGL/webglImage.js"),webglGraphics:e("./View/webglGraphics.js"),_webglUtil:{parseColor:e("./WebGL/parseColor.js")},svgGraphics:e("./View/svgGraphics.js"),renderer:e("./View/renderer.js"),cssGraphics:function(){throw new Error("cssGraphics is deprecated. Please use older version of vivagraph (< 0.7) if you need it")},svgNodeFactory:function(){throw new Error("svgNodeFactory is deprecated. Please use older version of vivagraph (< 0.7) if you need it")},community:function(){throw new Error("community is deprecated. Please use vivagraph < 0.7 if you need it, or `https://github.com/anvaka/ngraph.slpa` module")}},Rect:e("./Utils/rect.js"),svg:e("simplesvg"),BrowserInfo:e("./Utils/browserInfo.js")},t.exports=o},{"./Algorithms/centrality.js":1358,"./Algorithms/operations.js":1359,"./Input/domInputManager.js":1360,"./Input/dragndrop.js":1361,"./Input/webglInputManager.js":1362,"./Layout/constant.js":1363,"./Utils/backwardCompatibleEvents.js":1364,"./Utils/browserInfo.js":1365,"./Utils/findElementPosition.js":1367,"./Utils/getDimensions.js":1368,"./Utils/intersectRect.js":1369,"./Utils/rect.js":1371,"./Utils/timer.js":1372,"./View/renderer.js":1374,"./View/svgGraphics.js":1375,"./View/webglGraphics.js":1376,"./WebGL/parseColor.js":1377,"./WebGL/texture.js":1378,"./WebGL/webgl.js":1379,"./WebGL/webglAtlas.js":1380,"./WebGL/webglImage.js":1381,"./WebGL/webglImageNodeProgram.js":1382,"./WebGL/webglInputEvents.js":1383,"./WebGL/webglLine.js":1384,"./WebGL/webglLinkProgram.js":1385,"./WebGL/webglNodeProgram.js":1386,"./WebGL/webglSquare.js":1387,"./version.js":1388,gintersect:211,"ngraph.events":1337,"ngraph.forcelayout":1339,"ngraph.fromjson":432,"ngraph.generators":1341,"ngraph.graph":1343,"ngraph.merge":1344,"ngraph.random":1357,"ngraph.tojson":435,simplesvg:1284}],1390:[function(e,t){(function(){"use strict";function e(t){t.permitHostObjects___&&t.permitHostObjects___(e)}function a(e){return"weakmap:"!=e.substr(0,8)||"___"!==e.substr(e.length-3)}function o(e){if(e!==Object(e))throw new TypeError("Not an object: "+e);var t=e[h];if(t&&t.key===e)return t;if(g(e)){t={key:e};try{return u(e,h,{value:t,writable:!1,enumerable:!1,configurable:!1}),t}catch(e){}}}function r(e){return e.prototype=null,Object.freeze(e)}function i(){_||"undefined"==typeof console||(_=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}if("undefined"==typeof ses||!ses.ok||ses.ok()){"undefined"!=typeof ses&&(ses.weakMapPermitHostObjects=e);var n=!1;if("function"==typeof WeakMap){var l=WeakMap;if("undefined"!=typeof navigator&&/Firefox/.test(navigator.userAgent));else{var s=new l,d=Object.freeze({});if(s.set(d,1),1!==s.get(d))n=!0;else return void(t.exports=WeakMap)}}var c=Object.prototype.hasOwnProperty,p=Object.getOwnPropertyNames,u=Object.defineProperty,g=Object.isExtensible,m="weakmap:",h=m+"ident:"+Math.random()+"___";if("undefined"!=typeof crypto&&"function"==typeof crypto.getRandomValues&&"function"==typeof ArrayBuffer&&"function"==typeof Uint8Array){var y=new ArrayBuffer(25),f=new Uint8Array(y);crypto.getRandomValues(f),h=m+"rand:"+Array.prototype.map.call(f,function(e){return(e%36).toString(36)}).join("")+"___"}if(u(Object,"getOwnPropertyNames",{value:function(e){return p(e).filter(a)}}),"getPropertyNames"in Object){var x=Object.getPropertyNames;u(Object,"getPropertyNames",{value:function(e){return x(e).filter(a)}})}(function(){var e=Object.freeze;u(Object,"freeze",{value:function(t){return o(t),e(t)}});var t=Object.seal;u(Object,"seal",{value:function(e){return o(e),t(e)}});var a=Object.preventExtensions;u(Object,"preventExtensions",{value:function(e){return o(e),a(e)}})})();var _=!1,b=0,v=function(){function e(e,t){var a=o(e),r;return a?s in a?a[s]:t:(r=n.indexOf(e),0<=r?l[r]:t)}function t(e){var t=o(e);return t?s in t:0<=n.indexOf(e)}function a(e){var t=o(e),a,r;return t?s in t&&delete t[s]:(a=n.indexOf(e),!(0>a))&&(r=n.length-1,n[a]=void 0,l[a]=l[r],n[a]=n[r],n.length=r,l.length=r,!0)}this instanceof v||i();var n=[],l=[],s=b++;return Object.create(v.prototype,{get___:{value:r(e)},has___:{value:r(t)},set___:{value:r(function(e,t){var a=o(e),r;return a?a[s]=t:(r=n.indexOf(e),0<=r?l[r]=t:(r=n.length,l[r]=t,n[r]=e)),this})},delete___:{value:r(a)}})};v.prototype=Object.create(Object.prototype,{get:{value:function(e,t){return this.get___(e,t)},writable:!0,configurable:!0},has:{value:function(e){return this.has___(e)},writable:!0,configurable:!0},set:{value:function(e,t){return this.set___(e,t)},writable:!0,configurable:!0},delete:{value:function(e){return this.delete___(e)},writable:!0,configurable:!0}}),"function"==typeof l?function(){function a(){function t(e,t){return d?s.has(e)?s.get(e):d.get___(e,t):s.get(e,t)}function a(e){return s.has(e)||!!d&&d.has___(e)}function o(e){var t=!!s["delete"](e);return d?d.delete___(e)||t:t}this instanceof v||i();var s=new l,d=void 0,c=!1,p;return p=n?function(e,t){return s.set(e,t),s.has(e)||(!d&&(d=new v),d.set(e,t)),this}:function(t,a){if(c)try{s.set(t,a)}catch(o){d||(d=new v),d.set___(t,a)}else s.set(t,a);return this},Object.create(v.prototype,{get___:{value:r(t)},has___:{value:r(a)},set___:{value:r(p)},delete___:{value:r(o)},permitHostObjects___:{value:r(function(t){if(t===e)c=!0;else throw new Error("bogus call to permitHostObjects___")})}})}n&&"undefined"!=typeof Proxy&&(Proxy=void 0),a.prototype=v.prototype,t.exports=a,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():("undefined"!=typeof Proxy&&(Proxy=void 0),t.exports=v)}})()},{}],1391:[function(e,t){var a=e("./hidden-store.js");t.exports=function(){var e={};return function(t){if(("object"!=typeof t||null===t)&&"function"!=typeof t)throw new Error("Weakmap-shim: Key must be object");var o=t.valueOf(e);return o&&o.identity===e?o:a(t,e)}}},{"./hidden-store.js":1392}],1392:[function(e,t){t.exports=function(e,t){var a={identity:t},o=e.valueOf;return Object.defineProperty(e,"valueOf",{value:function(e){return e===t?a:o.apply(this,arguments)},writable:!0}),a}},{}],1393:[function(e,t){var a=e("./create-store.js");t.exports=function(){var e=a();return{get:function(t,a){var o=e(t);return o.hasOwnProperty("value")?o.value:a},set:function(t,a){return e(t).value=a,this},has:function(t){return"value"in e(t)},delete:function(t){return delete e(t).value}}}},{"./create-store.js":1391}],1394:[function(e,t){var a=e("get-canvas-context");t.exports=function(e){return a("webgl",e)}},{"get-canvas-context":210}],1395:[function(e){var r=Math.round;function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function a(e,t,a,o){var n,l;if("object"==typeof e)n=e,l=t||{};else{if(!("number"==typeof e&&1888<=e&&2111>=e))throw new Error("Solar year outside range 1888-2111");if(!("number"==typeof t&&1<=t&&12>=t))throw new Error("Solar month outside range 1 - 12");if(!("number"==typeof a&&1<=a&&31>=a))throw new Error("Solar day outside range 1 - 31");n={year:e,month:t,day:a},l=o||{}}var s=g[n.year-g[0]],c=n.year<<9|n.month<<5|n.day;l.year=c>=s?n.year:n.year-1,s=g[l.year-g[0]];var p=4095&s>>9,h=15&s>>5,m=31&s,d=new Date(p,h-1,m),y=new Date(n.year,n.month-1,n.day),f;f=r((y-d)/86400000);var x=u[l.year-u[0]],_;for(_=0;13>_;_++){var b=x&1<<12-_?30:29;if(f<b)break;f-=b}var v=x>>13;return!v||_<v?(l.isIntercalary=!1,l.month=1+_):_===v?(l.isIntercalary=!0,l.month=_):(l.isIntercalary=!1,l.month=_),l.day=1+f,l}function o(e,t,a,o,r){var n,l;if("object"==typeof e)l=e,n=t||{};else{if(!("number"==typeof e&&1888<=e&&2111>=e))throw new Error("Lunar year outside range 1888-2111");if(!("number"==typeof t&&1<=t&&12>=t))throw new Error("Lunar month outside range 1 - 12");if(!("number"==typeof a&&1<=a&&30>=a))throw new Error("Lunar day outside range 1 - 30");var s;"object"==typeof o?(s=!1,n=o):(s=!!o,n=r||{}),l={year:e,month:t,day:a,isIntercalary:s}}var d=l.day-1;var c=u[l.year-u[0]],p=c>>13,m;m=p?l.month>p?l.month:l.isIntercalary?l.month:l.month-1:l.month-1;for(var h=0,y;h<m;h++)y=c&1<<12-h?30:29,d+=y;var f=g[l.year-g[0]],x=new Date(4095&f>>9,(15&f>>5)-1,(31&f)+d);return n.year=x.getFullYear(),n.month=1+x.getMonth(),n.day=x.getDate(),n}var i=e("../main"),n=e("object-assign"),l=i.instance();t.prototype=new i.baseCalendar,n(t.prototype,{name:"Chinese",jdEpoch:1721425.5,hasYearZero:!1,minMonth:0,firstMonth:0,minDay:1,regionalOptions:{"":{name:"Chinese",epochs:["BEC","EC"],monthNumbers:function(e,t){if("string"==typeof e){var a=e.match(d);return a?a[0]:""}var o=this._validateYear(e),r=e.month(),i=""+this.toChineseMonth(o,r);return t&&2>i.length&&(i="0"+i),this.isIntercalaryMonth(o,r)&&(i+="i"),i},monthNames:function(e){if("string"==typeof e){var t=e.match(c);return t?t[0]:""}var a=this._validateYear(e),o=e.month(),r=this.toChineseMonth(a,o),i=["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"][r-1];return this.isIntercalaryMonth(a,o)&&(i="\u95F0"+i),i},monthNamesShort:function(e){if("string"==typeof e){var t=e.match(p);return t?t[0]:""}var a=this._validateYear(e),o=e.month(),r=this.toChineseMonth(a,o),i=["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"][r-1];return this.isIntercalaryMonth(a,o)&&(i="\u95F0"+i),i},parseMonth:function(e,t){e=this._validateYear(e);var a=parseInt(t),o;if(!isNaN(a)){var r=t[t.length-1];o="i"===r||"I"===r}else"\u95F0"===t[0]&&(o=!0,t=t.substring(1)),"\u6708"===t[t.length-1]&&(t=t.substring(0,t.length-1)),a=1+["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"].indexOf(t);var i=this.toMonthIndex(e,a,o);return i},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},_validateYear:function(e,t){if(e.year&&(e=e.year()),"number"!=typeof e||1888>e||2111<e)throw t.replace(/\{0\}/,this.local.name);return e},toMonthIndex:function(e,t,a){var o=this.intercalaryMonth(e);if(a&&t!==o||1>t||12<t)throw i.local.invalidMonth.replace(/\{0\}/,this.local.name);var r;return r=o?!a&&t<=o?t-1:t:t-1,r},toChineseMonth:function(e,t){e.year&&(e=e.year(),t=e.month());var a=this.intercalaryMonth(e),o=a?12:11;if(0>t||t>o)throw i.local.invalidMonth.replace(/\{0\}/,this.local.name);var r;return r=a?t<a?t+1:t:t+1,r},intercalaryMonth:function(e){e=this._validateYear(e);var t=u[e-u[0]];return t>>13},isIntercalaryMonth:function(e,t){e.year&&(e=e.year(),t=e.month());var a=this.intercalaryMonth(e);return!!a&&a===t},leapYear:function(e){return 0!==this.intercalaryMonth(e)},weekOfYear:function(e,t,a){var o=this._validateYear(e,i.local.invalidyear),r=g[o-g[0]],n;n=l.newDate(4095&r>>9,15&r>>5,31&r),n.add(4-(n.dayOfWeek()||7),"d");var s=this.toJD(e,t,a)-n.toJD();return 1+Math.floor(s/7)},monthsInYear:function(e){return this.leapYear(e)?13:12},daysInMonth:function(e,t){e.year&&(t=e.month(),e=e.year()),e=this._validateYear(e);var a=u[e-u[0]],o=a>>13?12:11;if(t>o)throw i.local.invalidMonth.replace(/\{0\}/,this.local.name);var r=a&1<<12-t?30:29;return r},weekDay:function(e,t,a){return 6>(this.dayOfWeek(e,t,a)||7)},toJD:function(e,t,a){var r=this._validate(e,void 0,a,i.local.invalidDate);e=this._validateYear(r.year()),t=r.month(),a=r.day();var n=this.isIntercalaryMonth(e,t),s=this.toChineseMonth(e,t),d=o(e,s,a,n);return l.toJD(d.year,d.month,d.day)},fromJD:function(e){var t=l.fromJD(e),o=a(t.year(),t.month(),t.day()),r=this.toMonthIndex(o.year,o.month,o.isIntercalary);return this.newDate(o.year,r,o.day)},fromString:function(e){var t=e.match(s),a=this._validateYear(+t[1]),o=+t[2],r=!!t[3],i=this.toMonthIndex(a,o,r),n=+t[4];return this.newDate(a,i,n)},add:function(e,a,o){var r=e.year(),i=e.month(),n=this.isIntercalaryMonth(r,i),l=this.toChineseMonth(r,i),s=Object.getPrototypeOf(t.prototype).add.call(this,e,a,o);if("y"===o){var d=s.year(),c=s.month(),p=this.isIntercalaryMonth(d,l),u=n&&p?this.toMonthIndex(d,l,!0):this.toMonthIndex(d,l,!1);u!==c&&s.month(u)}return s}});var s=/^\s*(-?\d\d\d\d|\d\d)[-/](\d?\d)([iI]?)[-/](\d?\d)/m,d=/^\d?\d[iI]?/m,c=/^闰?十?[一二三四五六七八九]?月/m,p=/^闰?十?[一二三四五六七八九]?/m;i.calendars.chinese=t;var u=[1887,5780,5802,19157,2742,50359,1198,2646,46378,7466,3412,30122,5482,67949,2396,5294,43597,6732,6954,36181,2772,4954,18781,2396,54427,5274,6730,47781,5800,6868,21210,4790,59703,2350,5270,46667,3402,3496,38325,1388,4782,18735,2350,52374,6804,7498,44457,2906,1388,29294,4700,63789,6442,6804,56138,5802,2772,38235,1210,4698,22827,5418,63125,3476,5802,43701,2484,5302,27223,2646,70954,7466,3412,54698,5482,2412,38062,5294,2636,32038,6954,60245,2772,4826,43357,2394,5274,39501,6730,72357,5800,5844,53978,4790,2358,38039,5270,87627,3402,3496,54708,5484,4782,43311,2350,3222,27978,7498,68965,2904,5484,45677,4700,6444,39573,6804,6986,19285,2772,62811,1210,4698,47403,5418,5780,38570,5546,76469,2420,5302,51799,2646,5414,36501,3412,5546,18869,2412,54446,5276,6732,48422,6822,2900,28010,4826,92509,2394,5274,55883,6730,6820,47956,5812,2778,18779,2358,62615,5270,5450,46757,3492,5556,27318,4718,67887,2350,3222,52554,7498,3428,38252,5468,4700,31022,6444,64149,6804,6986,43861,2772,5338,35421,2650,70955,5418,5780,54954,5546,2740,38074,5302,2646,29991,3366,61011,3412,5546,43445,2412,5294,35406,6732,72998,6820,6996,52586,2778,2396,38045,5274,6698,23333,6820,64338,5812,2746,43355,2358,5270,39499,5450,79525,3492,5548],g=[1887,966732,967231,967733,968265,968766,969297,969798,970298,970829,971330,971830,972362,972863,973395,973896,974397,974928,975428,975929,976461,976962,977462,977994,978494,979026,979526,980026,980558,981059,981559,982091,982593,983124,983624,984124,984656,985157,985656,986189,986690,987191,987722,988222,988753,989254,989754,990286,990788,991288,991819,992319,992851,993352,993851,994383,994885,995385,995917,996418,996918,997450,997949,998481,998982,999483,1000014,1000515,1001016,1001548,1002047,1002578,1003080,1003580,1004111,1004613,1005113,1005645,1006146,1006645,1007177,1007678,1008209,1008710,1009211,1009743,1010243,1010743,1011275,1011775,1012306,1012807,1013308,1013840,1014341,1014841,1015373,1015874,1016404,1016905,1017405,1017937,1018438,1018939,1019471,1019972,1020471,1021002,1021503,1022035,1022535,1023036,1023568,1024069,1024568,1025100,1025601,1026102,1026633,1027133,1027666,1028167,1028666,1029198,1029699,1030199,1030730,1031231,1031763,1032264,1032764,1033296,1033797,1034297,1034828,1035329,1035830,1036362,1036861,1037393,1037894,1038394,1038925,1039427,1039927,1040459,1040959,1041491,1041992,1042492,1043023,1043524,1044024,1044556,1045057,1045558,1046090,1046590,1047121,1047622,1048122,1048654,1049154,1049655,1050187,1050689,1051219,1051720,1052220,1052751,1053252,1053752,1054284,1054786,1055285,1055817,1056317,1056849,1057349,1057850,1058382,1058883,1059383,1059915,1060415,1060947,1061447,1061947,1062479,1062981,1063480,1064012,1064514,1065014,1065545,1066045,1066577,1067078,1067578,1068110,1068611,1069112,1069642,1070142,1070674,1071175,1071675,1072207,1072709,1073209,1073740,1074241,1074741,1075273,1075773,1076305,1076807,1077308,1077839,1078340,1078840,1079372,1079871,1080403,1080904]},{"../main":1409,"object-assign":438}],1396:[function(e){var a=Math.floor;function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}var o=e("../main"),r=e("object-assign");t.prototype=new o.baseCalendar,r(t.prototype,{name:"Coptic",jdEpoch:1825029.5,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Coptic",epochs:["BAM","AM"],monthNames:["Thout","Paopi","Hathor","Koiak","Tobi","Meshir","Paremhat","Paremoude","Pashons","Paoni","Epip","Mesori","Pi Kogi Enavot"],monthNamesShort:["Tho","Pao","Hath","Koi","Tob","Mesh","Pat","Pad","Pash","Pao","Epi","Meso","PiK"],dayNames:["Tkyriaka","Pesnau","Pshoment","Peftoou","Ptiou","Psoou","Psabbaton"],dayNamesShort:["Tky","Pes","Psh","Pef","Pti","Pso","Psa"],dayNamesMin:["Tk","Pes","Psh","Pef","Pt","Pso","Psa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,o.local.invalidYear),e=t.year()+(0>t.year()?1:0);return 3==e%4||-1==e%4},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,o.local.invalidYear||o.regionalOptions[""].invalidYear),13},weekOfYear:function(e,t,o){var r=this.newDate(e,t,o);return r.add(-r.dayOfWeek(),"d"),a((r.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var a=this._validate(e,t,this.minDay,o.local.invalidMonth);return this.daysPerMonth[a.month()-1]+(13===a.month()&&this.leapYear(a.year())?1:0)},weekDay:function(e,t,a){return 6>(this.dayOfWeek(e,t,a)||7)},toJD:function(e,t,r){var i=this._validate(e,t,r,o.local.invalidDate);return e=i.year(),0>e&&e++,i.day()+30*(i.month()-1)+365*(e-1)+a(e/4)+this.jdEpoch-1},fromJD:function(e){var t=a(e)+.5-this.jdEpoch,o=a((t-a((t+366)/1461))/365)+1;0>=o&&o--,t=a(e)+.5-this.newDate(o,1,1).toJD();var r=a(t/30)+1,i=t-30*(r-1)+1;return this.newDate(o,r,i)}}),o.calendars.coptic=t},{"../main":1409,"object-assign":438}],1397:[function(e){var a=Math.floor;function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}var o=e("../main"),r=e("object-assign");t.prototype=new o.baseCalendar,r(t.prototype,{name:"Discworld",jdEpoch:1721425.5,daysPerMonth:[16,32,32,32,32,32,32,32,32,32,32,32,32],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Discworld",epochs:["BUC","UC"],monthNames:["Ick","Offle","February","March","April","May","June","Grune","August","Spune","Sektober","Ember","December"],monthNamesShort:["Ick","Off","Feb","Mar","Apr","May","Jun","Gru","Aug","Spu","Sek","Emb","Dec"],dayNames:["Sunday","Octeday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Oct","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Oc","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:2,isRTL:!1}},leapYear:function(e){return this._validate(e,this.minMonth,this.minDay,o.local.invalidYear),!1},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,o.local.invalidYear),13},daysInYear:function(e){return this._validate(e,this.minMonth,this.minDay,o.local.invalidYear),400},weekOfYear:function(e,t,o){var r=this.newDate(e,t,o);return r.add(-r.dayOfWeek(),"d"),a((r.dayOfYear()-1)/8)+1},daysInMonth:function(e,t){var a=this._validate(e,t,this.minDay,o.local.invalidMonth);return this.daysPerMonth[a.month()-1]},daysInWeek:function(){return 8},dayOfWeek:function(e,t,a){var r=this._validate(e,t,a,o.local.invalidDate);return(r.day()+1)%8},weekDay:function(e,t,a){var o=this.dayOfWeek(e,t,a);return 2<=o&&6>=o},extraInfo:function(e,t,r){var n=this._validate(e,t,r,o.local.invalidDate);return{century:i[a((n.year()-1)/100)+1]||""}},toJD:function(e,t,a){var r=this._validate(e,t,a,o.local.invalidDate);return e=r.year()+(0>r.year()?1:0),t=r.month(),a=r.day(),a+(1<t?16:0)+(2<t?32*(t-2):0)+400*(e-1)+this.jdEpoch-1},fromJD:function(e){e=a(e+.5)-a(this.jdEpoch)-1;var t=a(e/400)+1;e-=400*(t-1),e+=15<e?16:0;var o=a(e/32)+1,r=e-32*(o-1)+1;return this.newDate(0>=t?t-1:t,o,r)}});var i={20:"Fruitbat",21:"Anchovy"};o.calendars.discworld=t},{"../main":1409,"object-assign":438}],1398:[function(e){var a=Math.floor;function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}var o=e("../main"),r=e("object-assign");t.prototype=new o.baseCalendar,r(t.prototype,{name:"Ethiopian",jdEpoch:1724220.5,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Ethiopian",epochs:["BEE","EE"],monthNames:["Meskerem","Tikemet","Hidar","Tahesas","Tir","Yekatit","Megabit","Miazia","Genbot","Sene","Hamle","Nehase","Pagume"],monthNamesShort:["Mes","Tik","Hid","Tah","Tir","Yek","Meg","Mia","Gen","Sen","Ham","Neh","Pag"],dayNames:["Ehud","Segno","Maksegno","Irob","Hamus","Arb","Kidame"],dayNamesShort:["Ehu","Seg","Mak","Iro","Ham","Arb","Kid"],dayNamesMin:["Eh","Se","Ma","Ir","Ha","Ar","Ki"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,o.local.invalidYear),e=t.year()+(0>t.year()?1:0);return 3==e%4||-1==e%4},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,o.local.invalidYear||o.regionalOptions[""].invalidYear),13},weekOfYear:function(e,t,o){var r=this.newDate(e,t,o);return r.add(-r.dayOfWeek(),"d"),a((r.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var a=this._validate(e,t,this.minDay,o.local.invalidMonth);return this.daysPerMonth[a.month()-1]+(13===a.month()&&this.leapYear(a.year())?1:0)},weekDay:function(e,t,a){return 6>(this.dayOfWeek(e,t,a)||7)},toJD:function(e,t,r){var i=this._validate(e,t,r,o.local.invalidDate);return e=i.year(),0>e&&e++,i.day()+30*(i.month()-1)+365*(e-1)+a(e/4)+this.jdEpoch-1},fromJD:function(e){var t=a(e)+.5-this.jdEpoch,o=a((t-a((t+366)/1461))/365)+1;0>=o&&o--,t=a(e)+.5-this.newDate(o,1,1).toJD();var r=a(t/30)+1,i=t-30*(r-1)+1;return this.newDate(o,r,i)}}),o.calendars.ethiopian=t},{"../main":1409,"object-assign":438}],1399:[function(e){var o=Math.floor;function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function a(e,t){return e-t*o(e/t)}var r=e("../main"),i=e("object-assign");t.prototype=new r.baseCalendar,i(t.prototype,{name:"Hebrew",jdEpoch:347995.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29,29],hasYearZero:!1,minMonth:1,firstMonth:7,minDay:1,regionalOptions:{"":{name:"Hebrew",epochs:["BAM","AM"],monthNames:["Nisan","Iyar","Sivan","Tammuz","Av","Elul","Tishrei","Cheshvan","Kislev","Tevet","Shevat","Adar","Adar II"],monthNamesShort:["Nis","Iya","Siv","Tam","Av","Elu","Tis","Che","Kis","Tev","She","Ada","Ad2"],dayNames:["Yom Rishon","Yom Sheni","Yom Shlishi","Yom Revi'i","Yom Chamishi","Yom Shishi","Yom Shabbat"],dayNamesShort:["Ris","She","Shl","Rev","Cha","Shi","Sha"],dayNamesMin:["Ri","She","Shl","Re","Ch","Shi","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,r.local.invalidYear);return this._leapYear(t.year())},_leapYear:function(e){return e=0>e?e+1:e,7>a(7*e+1,19)},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,r.local.invalidYear),this._leapYear(e.year?e.year():e)?13:12},weekOfYear:function(e,t,a){var r=this.newDate(e,t,a);return r.add(-r.dayOfWeek(),"d"),o((r.dayOfYear()-1)/7)+1},daysInYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,r.local.invalidYear);return e=t.year(),this.toJD(-1===e?1:e+1,7,1)-this.toJD(e,7,1)},daysInMonth:function(e,t){return e.year&&(t=e.month(),e=e.year()),this._validate(e,t,this.minDay,r.local.invalidMonth),12===t&&this.leapYear(e)?30:8===t&&5===a(this.daysInYear(e),10)?30:9===t&&3===a(this.daysInYear(e),10)?29:this.daysPerMonth[t-1]},weekDay:function(e,t,a){return 6!==this.dayOfWeek(e,t,a)},extraInfo:function(e,t,a){var o=this._validate(e,t,a,r.local.invalidDate);return{yearType:(this.leapYear(o)?"embolismic":"common")+" "+["deficient","regular","complete"][this.daysInYear(o)%10-3]}},toJD:function(e,t,a){var o=this._validate(e,t,a,r.local.invalidDate);e=o.year(),t=o.month(),a=o.day();var i=0>=e?e+1:e,n=this.jdEpoch+this._delay1(i)+this._delay2(i)+a+1;if(7>t){for(var l=7;l<=this.monthsInYear(e);l++)n+=this.daysInMonth(e,l);for(var l=1;l<t;l++)n+=this.daysInMonth(e,l)}else for(var l=7;l<t;l++)n+=this.daysInMonth(e,l);return n},_delay1:function(e){var t=o((235*e-234)/19),r=29*t+o((12084+13753*t)/25920);return 3>a(3*(r+1),7)&&r++,r},_delay2:function(e){var t=this._delay1(e-1),a=this._delay1(e),o=this._delay1(e+1);return 356==o-a?2:382==a-t?1:0},fromJD:function(e){e=o(e)+.5;for(var t=o(98496*(e-this.jdEpoch)/35975351)-1;e>=this.toJD(-1===t?1:t+1,7,1);)t++;for(var a=e<this.toJD(t,1,1)?7:1;e>this.toJD(t,a,this.daysInMonth(t,a));)a++;var r=e-this.toJD(t,a,1)+1;return this.newDate(t,a,r)}}),r.calendars.hebrew=t},{"../main":1409,"object-assign":438}],1400:[function(e){var a=Math.ceil,o=Math.floor;function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}var r=e("../main"),i=e("object-assign");t.prototype=new r.baseCalendar,i(t.prototype,{name:"Islamic",jdEpoch:1948439.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Islamic",epochs:["BH","AH"],monthNames:["Muharram","Safar","Rabi' al-awwal","Rabi' al-thani","Jumada al-awwal","Jumada al-thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-ahad","Yawm al-ithnayn","Yawm ath-thulaathaa'","Yawm al-arbi'aa'","Yawm al-kham\u012Bs","Yawm al-jum'a","Yawm as-sabt"],dayNamesShort:["Aha","Ith","Thu","Arb","Kha","Jum","Sab"],dayNamesMin:["Ah","It","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,r.local.invalidYear);return 11>(11*t.year()+14)%30},weekOfYear:function(e,t,a){var r=this.newDate(e,t,a);return r.add(-r.dayOfWeek(),"d"),o((r.dayOfYear()-1)/7)+1},daysInYear:function(e){return this.leapYear(e)?355:354},daysInMonth:function(e,t){var a=this._validate(e,t,this.minDay,r.local.invalidMonth);return this.daysPerMonth[a.month()-1]+(12===a.month()&&this.leapYear(a.year())?1:0)},weekDay:function(e,t,a){return 5!==this.dayOfWeek(e,t,a)},toJD:function(e,t,i){var n=this._validate(e,t,i,r.local.invalidDate);return e=n.year(),t=n.month(),i=n.day(),e=0>=e?e+1:e,i+a(29.5*(t-1))+354*(e-1)+o((3+11*e)/30)+this.jdEpoch-1},fromJD:function(e){e=o(e)+.5;var t=o((30*(e-this.jdEpoch)+10646)/10631);t=0>=t?t-1:t;var r=Math.min(12,a((e-29-this.toJD(t,1,1))/29.5)+1),i=e-this.toJD(t,r,1)+1;return this.newDate(t,r,i)}}),r.calendars.islamic=t},{"../main":1409,"object-assign":438}],1401:[function(e){var o=Math.floor;function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}var r=e("../main"),i=e("object-assign");t.prototype=new r.baseCalendar,i(t.prototype,{name:"Julian",jdEpoch:1721423.5,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Julian",epochs:["BC","AD"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,r.local.invalidYear),e=0>t.year()?t.year()+1:t.year();return 0==e%4},weekOfYear:function(e,t,a){var r=this.newDate(e,t,a);return r.add(4-(r.dayOfWeek()||7),"d"),o((r.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var a=this._validate(e,t,this.minDay,r.local.invalidMonth);return this.daysPerMonth[a.month()-1]+(2===a.month()&&this.leapYear(a.year())?1:0)},weekDay:function(e,t,a){return 6>(this.dayOfWeek(e,t,a)||7)},toJD:function(e,t,a){var i=this._validate(e,t,a,r.local.invalidDate);return e=i.year(),t=i.month(),a=i.day(),0>e&&e++,2>=t&&(e--,t+=12),o(365.25*(e+4716))+o(30.6001*(t+1))+a-1524.5},fromJD:function(t){var r=o(t+.5),a=r+1524,i=o((a-122.1)/365.25),n=o(365.25*i),l=o((a-n)/30.6001),e=l-o(14>l?1:13),s=i-o(2<e?4716:4715),d=a-n-o(30.6001*l);return 0>=s&&s--,this.newDate(s,e,d)}}),r.calendars.julian=t},{"../main":1409,"object-assign":438}],1402:[function(e){var n=Math.abs,l=Math.floor;function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function o(e,t){return e-t*l(e/t)}function r(e,t){return o(e-1,t)+1}var s=e("../main"),d=e("object-assign");t.prototype=new s.baseCalendar,d(t.prototype,{name:"Mayan",jdEpoch:584282.5,hasYearZero:!0,minMonth:0,firstMonth:0,minDay:0,regionalOptions:{"":{name:"Mayan",epochs:["",""],monthNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],monthNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],dayNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesMin:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],digits:null,dateFormat:"YYYY.m.d",firstDay:0,isRTL:!1,haabMonths:["Pop","Uo","Zip","Zotz","Tzec","Xul","Yaxkin","Mol","Chen","Yax","Zac","Ceh","Mac","Kankin","Muan","Pax","Kayab","Cumku","Uayeb"],tzolkinMonths:["Imix","Ik","Akbal","Kan","Chicchan","Cimi","Manik","Lamat","Muluc","Oc","Chuen","Eb","Ben","Ix","Men","Cib","Caban","Etznab","Cauac","Ahau"]}},leapYear:function(e){return this._validate(e,this.minMonth,this.minDay,s.local.invalidYear),!1},formatYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,s.local.invalidYear);e=t.year();var a=l(e/400);e%=400,e+=0>e?400:0;var o=l(e/20);return a+"."+o+"."+e%20},forYear:function(e){if(e=e.split("."),3>e.length)throw"Invalid Mayan year";for(var t=0,a=0,o;a<e.length;a++){if(o=parseInt(e[a],10),19<n(o)||0<a&&0>o)throw"Invalid Mayan year";t=20*t+o}return t},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,s.local.invalidYear),18},weekOfYear:function(e,t,a){return this._validate(e,t,a,s.local.invalidDate),0},daysInYear:function(e){return this._validate(e,this.minMonth,this.minDay,s.local.invalidYear),360},daysInMonth:function(e,t){return this._validate(e,t,this.minDay,s.local.invalidMonth),20},daysInWeek:function(){return 5},dayOfWeek:function(e,t,a){var o=this._validate(e,t,a,s.local.invalidDate);return o.day()},weekDay:function(e,t,a){return this._validate(e,t,a,s.local.invalidDate),!0},extraInfo:function(e,t,a){var o=this._validate(e,t,a,s.local.invalidDate),r=o.toJD(),i=this._toHaab(r),n=this._toTzolkin(r);return{haabMonthName:this.local.haabMonths[i[0]-1],haabMonth:i[0],haabDay:i[1],tzolkinDayName:this.local.tzolkinMonths[n[0]-1],tzolkinDay:n[0],tzolkinTrecena:n[1]}},_toHaab:function(e){e-=this.jdEpoch;var t=o(e+8+340,365);return[l(t/20)+1,o(t,20)]},_toTzolkin:function(e){return e-=this.jdEpoch,[r(e+20,20),r(e+4,13)]},toJD:function(e,t,a){var o=this._validate(e,t,a,s.local.invalidDate);return o.day()+20*o.month()+360*o.year()+this.jdEpoch},fromJD:function(e){e=l(e)+.5-this.jdEpoch;var t=l(e/360);e%=360,e+=0>e?360:0;var a=l(e/20),o=e%20;return this.newDate(t,a,o)}}),s.calendars.mayan=t},{"../main":1409,"object-assign":438}],1403:[function(e){var a=Math.floor;function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}var o=e("../main"),r=e("object-assign");t.prototype=new o.baseCalendar;var i=o.instance("gregorian");r(t.prototype,{name:"Nanakshahi",jdEpoch:2257673.5,daysPerMonth:[31,31,31,31,31,30,30,30,30,30,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Nanakshahi",epochs:["BN","AN"],monthNames:["Chet","Vaisakh","Jeth","Harh","Sawan","Bhadon","Assu","Katak","Maghar","Poh","Magh","Phagun"],monthNamesShort:["Che","Vai","Jet","Har","Saw","Bha","Ass","Kat","Mgr","Poh","Mgh","Pha"],dayNames:["Somvaar","Mangalvar","Budhvaar","Veervaar","Shukarvaar","Sanicharvaar","Etvaar"],dayNamesShort:["Som","Mangal","Budh","Veer","Shukar","Sanichar","Et"],dayNamesMin:["So","Ma","Bu","Ve","Sh","Sa","Et"],digits:null,dateFormat:"dd-mm-yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,o.local.invalidYear||o.regionalOptions[""].invalidYear);return i.leapYear(t.year()+(1>t.year()?1:0)+1469)},weekOfYear:function(e,t,o){var r=this.newDate(e,t,o);return r.add(1-(r.dayOfWeek()||7),"d"),a((r.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var a=this._validate(e,t,this.minDay,o.local.invalidMonth);return this.daysPerMonth[a.month()-1]+(12===a.month()&&this.leapYear(a.year())?1:0)},weekDay:function(e,t,a){return 6>(this.dayOfWeek(e,t,a)||7)},toJD:function(e,t,a){var r=this._validate(e,t,a,o.local.invalidMonth),e=r.year();0>e&&e++;for(var n=r.day(),l=1;l<r.month();l++)n+=this.daysPerMonth[l-1];return n+i.toJD(e+1468,3,13)},fromJD:function(e){e=a(e+.5);for(var t=a((e-(this.jdEpoch-1))/366);e>=this.toJD(t+1,1,1);)t++;for(var o=e-a(this.toJD(t,1,1)+.5)+1,r=1;o>this.daysInMonth(t,r);)o-=this.daysInMonth(t,r),r++;return this.newDate(t,r,o)}}),o.calendars.nanakshahi=t},{"../main":1409,"object-assign":438}],1404:[function(e){var a=Math.floor;function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}var o=e("../main"),r=e("object-assign");t.prototype=new o.baseCalendar,r(t.prototype,{name:"Nepali",jdEpoch:1700709.5,daysPerMonth:[31,31,32,32,31,30,30,29,30,29,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,daysPerYear:365,regionalOptions:{"":{name:"Nepali",epochs:["BBS","ABS"],monthNames:["Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Paush","Mangh","Falgun","Chaitra"],monthNamesShort:["Bai","Je","As","Shra","Bha","Ash","Kar","Mang","Pau","Ma","Fal","Chai"],dayNames:["Aaitabaar","Sombaar","Manglbaar","Budhabaar","Bihibaar","Shukrabaar","Shanibaar"],dayNamesShort:["Aaita","Som","Mangl","Budha","Bihi","Shukra","Shani"],dayNamesMin:["Aai","So","Man","Bu","Bi","Shu","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:1,isRTL:!1}},leapYear:function(e){return this.daysInYear(e)!==this.daysPerYear},weekOfYear:function(e,t,o){var r=this.newDate(e,t,o);return r.add(-r.dayOfWeek(),"d"),a((r.dayOfYear()-1)/7)+1},daysInYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,o.local.invalidYear);if(e=t.year(),"undefined"==typeof this.NEPALI_CALENDAR_DATA[e])return this.daysPerYear;for(var a=0,r=this.minMonth;12>=r;r++)a+=this.NEPALI_CALENDAR_DATA[e][r];return a},daysInMonth:function(e,t){return e.year&&(t=e.month(),e=e.year()),this._validate(e,t,this.minDay,o.local.invalidMonth),"undefined"==typeof this.NEPALI_CALENDAR_DATA[e]?this.daysPerMonth[t-1]:this.NEPALI_CALENDAR_DATA[e][t]},weekDay:function(e,t,a){return 6!==this.dayOfWeek(e,t,a)},toJD:function(e,t,a){var r=this._validate(e,t,a,o.local.invalidDate);e=r.year(),t=r.month(),a=r.day();var i=o.instance(),n=0,l=t,s=e;this._createMissingCalendarData(e);var d=e-(9<l||9===l&&a>=this.NEPALI_CALENDAR_DATA[s][0]?56:57);for(9!==t&&(n=a,l--);9!==l;)0>=l&&(l=12,s--),n+=this.NEPALI_CALENDAR_DATA[s][l],l--;return 9===t?(n+=a-this.NEPALI_CALENDAR_DATA[s][0],0>n&&(n+=i.daysInYear(d))):n+=this.NEPALI_CALENDAR_DATA[s][9]-this.NEPALI_CALENDAR_DATA[s][0],i.newDate(d,1,1).add(n,"d").toJD()},fromJD:function(e){var t=o.instance(),a=t.fromJD(e),r=a.year(),i=a.dayOfYear(),n=r+56;this._createMissingCalendarData(n);for(var l=9,s=this.NEPALI_CALENDAR_DATA[n][0],d=this.NEPALI_CALENDAR_DATA[n][l]-s+1;i>d;)l++,12<l&&(l=1,n++),d+=this.NEPALI_CALENDAR_DATA[n][l];var c=this.NEPALI_CALENDAR_DATA[n][l]-(d-i);return this.newDate(n,l,c)},_createMissingCalendarData:function(e){var t=this.daysPerMonth.slice(0);t.unshift(17);for(var a=e-1;a<e+2;a++)"undefined"==typeof this.NEPALI_CALENDAR_DATA[a]&&(this.NEPALI_CALENDAR_DATA[a]=t)},NEPALI_CALENDAR_DATA:{1970:[18,31,31,32,31,31,31,30,29,30,29,30,30],1971:[18,31,31,32,31,32,30,30,29,30,29,30,30],1972:[17,31,32,31,32,31,30,30,30,29,29,30,30],1973:[19,30,32,31,32,31,30,30,30,29,30,29,31],1974:[19,31,31,32,30,31,31,30,29,30,29,30,30],1975:[18,31,31,32,32,30,31,30,29,30,29,30,30],1976:[17,31,32,31,32,31,30,30,30,29,29,30,31],1977:[18,31,32,31,32,31,31,29,30,29,30,29,31],1978:[18,31,31,32,31,31,31,30,29,30,29,30,30],1979:[18,31,31,32,32,31,30,30,29,30,29,30,30],1980:[17,31,32,31,32,31,30,30,30,29,29,30,31],1981:[18,31,31,31,32,31,31,29,30,30,29,30,30],1982:[18,31,31,32,31,31,31,30,29,30,29,30,30],1983:[18,31,31,32,32,31,30,30,29,30,29,30,30],1984:[17,31,32,31,32,31,30,30,30,29,29,30,31],1985:[18,31,31,31,32,31,31,29,30,30,29,30,30],1986:[18,31,31,32,31,31,31,30,29,30,29,30,30],1987:[18,31,32,31,32,31,30,30,29,30,29,30,30],1988:[17,31,32,31,32,31,30,30,30,29,29,30,31],1989:[18,31,31,31,32,31,31,30,29,30,29,30,30],1990:[18,31,31,32,31,31,31,30,29,30,29,30,30],1991:[18,31,32,31,32,31,30,30,29,30,29,30,30],1992:[17,31,32,31,32,31,30,30,30,29,30,29,31],1993:[18,31,31,31,32,31,31,30,29,30,29,30,30],1994:[18,31,31,32,31,31,31,30,29,30,29,30,30],1995:[17,31,32,31,32,31,30,30,30,29,29,30,30],1996:[17,31,32,31,32,31,30,30,30,29,30,29,31],1997:[18,31,31,32,31,31,31,30,29,30,29,30,30],1998:[18,31,31,32,31,31,31,30,29,30,29,30,30],1999:[17,31,32,31,32,31,30,30,30,29,29,30,31],2e3:[17,30,32,31,32,31,30,30,30,29,30,29,31],2001:[18,31,31,32,31,31,31,30,29,30,29,30,30],2002:[18,31,31,32,32,31,30,30,29,30,29,30,30],2003:[17,31,32,31,32,31,30,30,30,29,29,30,31],2004:[17,30,32,31,32,31,30,30,30,29,30,29,31],2005:[18,31,31,32,31,31,31,30,29,30,29,30,30],2006:[18,31,31,32,32,31,30,30,29,30,29,30,30],2007:[17,31,32,31,32,31,30,30,30,29,29,30,31],2008:[17,31,31,31,32,31,31,29,30,30,29,29,31],2009:[18,31,31,32,31,31,31,30,29,30,29,30,30],2010:[18,31,31,32,32,31,30,30,29,30,29,30,30],2011:[17,31,32,31,32,31,30,30,30,29,29,30,31],2012:[17,31,31,31,32,31,31,29,30,30,29,30,30],2013:[18,31,31,32,31,31,31,30,29,30,29,30,30],2014:[18,31,31,32,32,31,30,30,29,30,29,30,30],2015:[17,31,32,31,32,31,30,30,30,29,29,30,31],2016:[17,31,31,31,32,31,31,29,30,30,29,30,30],2017:[18,31,31,32,31,31,31,30,29,30,29,30,30],2018:[18,31,32,31,32,31,30,30,29,30,29,30,30],2019:[17,31,32,31,32,31,30,30,30,29,30,29,31],2020:[17,31,31,31,32,31,31,30,29,30,29,30,30],2021:[18,31,31,32,31,31,31,30,29,30,29,30,30],2022:[17,31,32,31,32,31,30,30,30,29,29,30,30],2023:[17,31,32,31,32,31,30,30,30,29,30,29,31],2024:[17,31,31,31,32,31,31,30,29,30,29,30,30],2025:[18,31,31,32,31,31,31,30,29,30,29,30,30],2026:[17,31,32,31,32,31,30,30,30,29,29,30,31],2027:[17,30,32,31,32,31,30,30,30,29,30,29,31],2028:[17,31,31,32,31,31,31,30,29,30,29,30,30],2029:[18,31,31,32,31,32,30,30,29,30,29,30,30],2030:[17,31,32,31,32,31,30,30,30,30,30,30,31],2031:[17,31,32,31,32,31,31,31,31,31,31,31,31],2032:[17,32,32,32,32,32,32,32,32,32,32,32,32],2033:[18,31,31,32,32,31,30,30,29,30,29,30,30],2034:[17,31,32,31,32,31,30,30,30,29,29,30,31],2035:[17,30,32,31,32,31,31,29,30,30,29,29,31],2036:[17,31,31,32,31,31,31,30,29,30,29,30,30],2037:[18,31,31,32,32,31,30,30,29,30,29,30,30],2038:[17,31,32,31,32,31,30,30,30,29,29,30,31],2039:[17,31,31,31,32,31,31,29,30,30,29,30,30],2040:[17,31,31,32,31,31,31,30,29,30,29,30,30],2041:[18,31,31,32,32,31,30,30,29,30,29,30,30],2042:[17,31,32,31,32,31,30,30,30,29,29,30,31],2043:[17,31,31,31,32,31,31,29,30,30,29,30,30],2044:[17,31,31,32,31,31,31,30,29,30,29,30,30],2045:[18,31,32,31,32,31,30,30,29,30,29,30,30],2046:[17,31,32,31,32,31,30,30,30,29,29,30,31],2047:[17,31,31,31,32,31,31,30,29,30,29,30,30],2048:[17,31,31,32,31,31,31,30,29,30,29,30,30],2049:[17,31,32,31,32,31,30,30,30,29,29,30,30],2050:[17,31,32,31,32,31,30,30,30,29,30,29,31],2051:[17,31,31,31,32,31,31,30,29,30,29,30,30],2052:[17,31,31,32,31,31,31,30,29,30,29,30,30],2053:[17,31,32,31,32,31,30,30,30,29,29,30,30],2054:[17,31,32,31,32,31,30,30,30,29,30,29,31],2055:[17,31,31,32,31,31,31,30,29,30,30,29,30],2056:[17,31,31,32,31,32,30,30,29,30,29,30,30],2057:[17,31,32,31,32,31,30,30,30,29,29,30,31],2058:[17,30,32,31,32,31,30,30,30,29,30,29,31],2059:[17,31,31,32,31,31,31,30,29,30,29,30,30],2060:[17,31,31,32,32,31,30,30,29,30,29,30,30],2061:[17,31,32,31,32,31,30,30,30,29,29,30,31],2062:[17,30,32,31,32,31,31,29,30,29,30,29,31],2063:[17,31,31,32,31,31,31,30,29,30,29,30,30],2064:[17,31,31,32,32,31,30,30,29,30,29,30,30],2065:[17,31,32,31,32,31,30,30,30,29,29,30,31],2066:[17,31,31,31,32,31,31,29,30,30,29,29,31],2067:[17,31,31,32,31,31,31,30,29,30,29,30,30],2068:[17,31,31,32,32,31,30,30,29,30,29,30,30],2069:[17,31,32,31,32,31,30,30,30,29,29,30,31],2070:[17,31,31,31,32,31,31,29,30,30,29,30,30],2071:[17,31,31,32,31,31,31,30,29,30,29,30,30],2072:[17,31,32,31,32,31,30,30,29,30,29,30,30],2073:[17,31,32,31,32,31,30,30,30,29,29,30,31],2074:[17,31,31,31,32,31,31,30,29,30,29,30,30],2075:[17,31,31,32,31,31,31,30,29,30,29,30,30],2076:[16,31,32,31,32,31,30,30,30,29,29,30,30],2077:[17,31,32,31,32,31,30,30,30,29,30,29,31],2078:[17,31,31,31,32,31,31,30,29,30,29,30,30],2079:[17,31,31,32,31,31,31,30,29,30,29,30,30],2080:[16,31,32,31,32,31,30,30,30,29,29,30,30],2081:[17,31,31,32,32,31,30,30,30,29,30,30,30],2082:[17,31,32,31,32,31,30,30,30,29,30,30,30],2083:[17,31,31,32,31,31,30,30,30,29,30,30,30],2084:[17,31,31,32,31,31,30,30,30,29,30,30,30],2085:[17,31,32,31,32,31,31,30,30,29,30,30,30],2086:[17,31,32,31,32,31,30,30,30,29,30,30,30],2087:[16,31,31,32,31,31,31,30,30,29,30,30,30],2088:[16,30,31,32,32,30,31,30,30,29,30,30,30],2089:[17,31,32,31,32,31,30,30,30,29,30,30,30],2090:[17,31,32,31,32,31,30,30,30,29,30,30,30],2091:[16,31,31,32,31,31,31,30,30,29,30,30,30],2092:[16,31,31,32,32,31,30,30,30,29,30,30,30],2093:[17,31,32,31,32,31,30,30,30,29,30,30,30],2094:[17,31,31,32,31,31,30,30,30,29,30,30,30],2095:[17,31,31,32,31,31,31,30,29,30,30,30,30],2096:[17,30,31,32,32,31,30,30,29,30,29,30,30],2097:[17,31,32,31,32,31,30,30,30,29,30,30,30],2098:[17,31,31,32,31,31,31,29,30,29,30,30,31],2099:[17,31,31,32,31,31,31,30,29,29,30,30,30],2100:[17,31,32,31,32,30,31,30,29,30,29,30,30]}}),o.calendars.nepali=t},{"../main":1409,"object-assign":438}],1405:[function(e){var o=Math.ceil,r=Math.floor;function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function a(e,t){return e-t*r(e/t)}var i=e("../main"),n=e("object-assign");t.prototype=new i.baseCalendar,n(t.prototype,{name:"Persian",jdEpoch:1948320.5,daysPerMonth:[31,31,31,31,31,31,30,30,30,30,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Persian",epochs:["BP","AP"],monthNames:["Farvardin","Ordibehesht","Khordad","Tir","Mordad","Shahrivar","Mehr","Aban","Azar","Day","Bahman","Esfand"],monthNamesShort:["Far","Ord","Kho","Tir","Mor","Sha","Meh","Aba","Aza","Day","Bah","Esf"],dayNames:["Yekshambe","Doshambe","Seshambe","Ch\xE6harshambe","Panjshambe","Jom'e","Shambe"],dayNamesShort:["Yek","Do","Se","Ch\xE6","Panj","Jom","Sha"],dayNamesMin:["Ye","Do","Se","Ch","Pa","Jo","Sh"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,i.local.invalidYear);return 682>682*((t.year()-(0<t.year()?474:473))%2820+474+38)%2816},weekOfYear:function(e,t,a){var o=this.newDate(e,t,a);return o.add(-((o.dayOfWeek()+1)%7),"d"),r((o.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var a=this._validate(e,t,this.minDay,i.local.invalidMonth);return this.daysPerMonth[a.month()-1]+(12===a.month()&&this.leapYear(a.year())?1:0)},weekDay:function(e,t,a){return 5!==this.dayOfWeek(e,t,a)},toJD:function(e,t,o){var n=this._validate(e,t,o,i.local.invalidDate);e=n.year(),t=n.month(),o=n.day();var l=e-(0<=e?474:473),s=474+a(l,2820);return o+(7>=t?31*(t-1):30*(t-1)+6)+r((682*s-110)/2816)+365*(s-1)+1029983*r(l/2820)+this.jdEpoch-1},fromJD:function(e){e=r(e)+.5;var t=e-this.toJD(475,1,1),i=r(t/1029983),n=a(t,1029983),l=2820;if(1029982!==n){var s=r(n/366),d=a(n,366);l=r((2134*s+2816*d+2815)/1028522)+s+1}var c=l+2820*i+474;c=0>=c?c-1:c;var p=e-this.toJD(c,1,1)+1,u=186>=p?o(p/31):o((p-6)/30),g=e-this.toJD(c,u,1)+1;return this.newDate(c,u,g)}}),i.calendars.persian=t,i.calendars.jalali=t},{"../main":1409,"object-assign":438}],1406:[function(e){function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}var a=e("../main"),o=e("object-assign"),r=a.instance();t.prototype=new a.baseCalendar,o(t.prototype,{name:"Taiwan",jdEpoch:2419402.5,yearsOffset:1911,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Taiwan",epochs:["BROC","ROC"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear),e=this._t2gYear(t.year());return r.leapYear(e)},weekOfYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear),e=this._t2gYear(t.year());return r.weekOfYear(e,t.month(),t.day())},daysInMonth:function(e,t){var o=this._validate(e,t,this.minDay,a.local.invalidMonth);return this.daysPerMonth[o.month()-1]+(2===o.month()&&this.leapYear(o.year())?1:0)},weekDay:function(e,t,a){return 6>(this.dayOfWeek(e,t,a)||7)},toJD:function(e,t,o){var i=this._validate(e,t,o,a.local.invalidDate),e=this._t2gYear(i.year());return r.toJD(e,i.month(),i.day())},fromJD:function(e){var t=r.fromJD(e),a=this._g2tYear(t.year());return this.newDate(a,t.month(),t.day())},_t2gYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&-1>=e?1:0)},_g2tYear:function(e){return e-this.yearsOffset-(1<=e&&e<=this.yearsOffset?1:0)}}),a.calendars.taiwan=t},{"../main":1409,"object-assign":438}],1407:[function(e){function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}var a=e("../main"),o=e("object-assign"),r=a.instance();t.prototype=new a.baseCalendar,o(t.prototype,{name:"Thai",jdEpoch:1523098.5,yearsOffset:543,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Thai",epochs:["BBE","BE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear),e=this._t2gYear(t.year());return r.leapYear(e)},weekOfYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear),e=this._t2gYear(t.year());return r.weekOfYear(e,t.month(),t.day())},daysInMonth:function(e,t){var o=this._validate(e,t,this.minDay,a.local.invalidMonth);return this.daysPerMonth[o.month()-1]+(2===o.month()&&this.leapYear(o.year())?1:0)},weekDay:function(e,t,a){return 6>(this.dayOfWeek(e,t,a)||7)},toJD:function(e,t,o){var i=this._validate(e,t,o,a.local.invalidDate),e=this._t2gYear(i.year());return r.toJD(e,i.month(),i.day())},fromJD:function(e){var t=r.fromJD(e),a=this._g2tYear(t.year());return this.newDate(a,t.month(),t.day())},_t2gYear:function(e){return e-this.yearsOffset-(1<=e&&e<=this.yearsOffset?1:0)},_g2tYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&-1>=e?1:0)}}),a.calendars.thai=t},{"../main":1409,"object-assign":438}],1408:[function(e){var a=Math.floor;function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}var o=e("../main"),r=e("object-assign");t.prototype=new o.baseCalendar,r(t.prototype,{name:"UmmAlQura",hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Umm al-Qura",epochs:["BH","AH"],monthNames:["Al-Muharram","Safar","Rabi' al-awwal","Rabi' Al-Thani","Jumada Al-Awwal","Jumada Al-Thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-Ahad","Yawm al-Ithnain","Yawm al-Thal\u0101th\u0101\u2019","Yawm al-Arba\u2018\u0101\u2019","Yawm al-Kham\u012Bs","Yawm al-Jum\u2018a","Yawm al-Sabt"],dayNamesMin:["Ah","Ith","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!0}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,o.local.invalidYear);return 355===this.daysInYear(t.year())},weekOfYear:function(e,t,o){var r=this.newDate(e,t,o);return r.add(-r.dayOfWeek(),"d"),a((r.dayOfYear()-1)/7)+1},daysInYear:function(e){for(var t=0,a=1;12>=a;a++)t+=this.daysInMonth(e,a);return t},daysInMonth:function(e,t){for(var a=this._validate(e,t,this.minDay,o.local.invalidMonth),r=a.toJD()-24e5+.5,l=0,s=0;s<n.length;s++){if(n[s]>r)return n[l]-n[l-1];l++}return 30},weekDay:function(e,t,a){return 5!==this.dayOfWeek(e,t,a)},toJD:function(e,t,a){var r=this._validate(e,t,a,o.local.invalidDate),i=12*(r.year()-1)+r.month()-15292,l=r.day()+n[i-1]-1;return l+24e5-.5},fromJD:function(e){for(var t=e-24e5+.5,o=0,r=0;r<n.length&&!(n[r]>t);r++)o++;var l=o+15292,s=a((l-1)/12),d=t-n[o-1]+1;return this.newDate(s+1,l-12*s,d)},isValid:function(e){var t=o.baseCalendar.prototype.isValid.apply(this,arguments);return t&&(e=null==e.year?e:e.year,t=1276<=e&&1500>=e),t},_validate:function(e,t,a,r){var i=o.baseCalendar.prototype._validate.apply(this,arguments);if(1276>i.year||1500<i.year)throw r.replace(/\{0\}/,this.local.name);return i}}),o.calendars.ummalqura=t;var n=[20,50,79,109,138,168,197,227,256,286,315,345,374,404,433,463,492,522,551,581,611,641,670,700,729,759,788,818,847,877,906,936,965,995,1024,1054,1083,1113,1142,1172,1201,1231,1260,1290,1320,1350,1379,1409,1438,1468,1497,1527,1556,1586,1615,1645,1674,1704,1733,1763,1792,1822,1851,1881,1910,1940,1969,1999,2028,2058,2087,2117,2146,2176,2205,2235,2264,2294,2323,2353,2383,2413,2442,2472,2501,2531,2560,2590,2619,2649,2678,2708,2737,2767,2796,2826,2855,2885,2914,2944,2973,3003,3032,3062,3091,3121,3150,3180,3209,3239,3268,3298,3327,3357,3386,3416,3446,3476,3505,3535,3564,3594,3623,3653,3682,3712,3741,3771,3800,3830,3859,3889,3918,3948,3977,4007,4036,4066,4095,4125,4155,4185,4214,4244,4273,4303,4332,4362,4391,4421,4450,4480,4509,4539,4568,4598,4627,4657,4686,4716,4745,4775,4804,4834,4863,4893,4922,4952,4981,5011,5040,5070,5099,5129,5158,5188,5218,5248,5277,5307,5336,5366,5395,5425,5454,5484,5513,5543,5572,5602,5631,5661,5690,5720,5749,5779,5808,5838,5867,5897,5926,5956,5985,6015,6044,6074,6103,6133,6162,6192,6221,6251,6281,6311,6340,6370,6399,6429,6458,6488,6517,6547,6576,6606,6635,6665,6694,6724,6753,6783,6812,6842,6871,6901,6930,6960,6989,7019,7048,7078,7107,7137,7166,7196,7225,7255,7284,7314,7344,7374,7403,7433,7462,7492,7521,7551,7580,7610,7639,7669,7698,7728,7757,7787,7816,7846,7875,7905,7934,7964,7993,8023,8053,8083,8112,8142,8171,8201,8230,8260,8289,8319,8348,8378,8407,8437,8466,8496,8525,8555,8584,8614,8643,8673,8702,8732,8761,8791,8821,8850,8880,8909,8938,8968,8997,9027,9056,9086,9115,9145,9175,9205,9234,9264,9293,9322,9352,9381,9410,9440,9470,9499,9529,9559,9589,9618,9648,9677,9706,9736,9765,9794,9824,9853,9883,9913,9943,9972,10002,10032,10061,10090,10120,10149,10178,10208,10237,10267,10297,10326,10356,10386,10415,10445,10474,10504,10533,10562,10592,10621,10651,10680,10710,10740,10770,10799,10829,10858,10888,10917,10947,10976,11005,11035,11064,11094,11124,11153,11183,11213,11242,11272,11301,11331,11360,11389,11419,11448,11478,11507,11537,11567,11596,11626,11655,11685,11715,11744,11774,11803,11832,11862,11891,11921,11950,11980,12010,12039,12069,12099,12128,12158,12187,12216,12246,12275,12304,12334,12364,12393,12423,12453,12483,12512,12542,12571,12600,12630,12659,12688,12718,12747,12777,12807,12837,12866,12896,12926,12955,12984,13014,13043,13072,13102,13131,13161,13191,13220,13250,13280,13310,13339,13368,13398,13427,13456,13486,13515,13545,13574,13604,13634,13664,13693,13723,13752,13782,13811,13840,13870,13899,13929,13958,13988,14018,14047,14077,14107,14136,14166,14195,14224,14254,14283,14313,14342,14372,14401,14431,14461,14490,14520,14550,14579,14609,14638,14667,14697,14726,14756,14785,14815,14844,14874,14904,14933,14963,14993,15021,15051,15081,15110,15140,15169,15199,15228,15258,15287,15317,15347,15377,15406,15436,15465,15494,15524,15553,15582,15612,15641,15671,15701,15731,15760,15790,15820,15849,15878,15908,15937,15966,15996,16025,16055,16085,16114,16144,16174,16204,16233,16262,16292,16321,16350,16380,16409,16439,16468,16498,16528,16558,16587,16617,16646,16676,16705,16734,16764,16793,16823,16852,16882,16912,16941,16971,17001,17030,17060,17089,17118,17148,17177,17207,17236,17266,17295,17325,17355,17384,17414,17444,17473,17502,17532,17561,17591,17620,17650,17679,17709,17738,17768,17798,17827,17857,17886,17916,17945,17975,18004,18034,18063,18093,18122,18152,18181,18211,18241,18270,18300,18330,18359,18388,18418,18447,18476,18506,18535,18565,18595,18625,18654,18684,18714,18743,18772,18802,18831,18860,18890,18919,18949,18979,19008,19038,19068,19098,19127,19156,19186,19215,19244,19274,19303,19333,19362,19392,19422,19452,19481,19511,19540,19570,19599,19628,19658,19687,19717,19746,19776,19806,19836,19865,19895,19924,19954,19983,20012,20042,20071,20101,20130,20160,20190,20219,20249,20279,20308,20338,20367,20396,20426,20455,20485,20514,20544,20573,20603,20633,20662,20692,20721,20751,20780,20810,20839,20869,20898,20928,20957,20987,21016,21046,21076,21105,21135,21164,21194,21223,21253,21282,21312,21341,21371,21400,21430,21459,21489,21519,21548,21578,21607,21637,21666,21696,21725,21754,21784,21813,21843,21873,21902,21932,21962,21991,22021,22050,22080,22109,22138,22168,22197,22227,22256,22286,22316,22346,22375,22405,22434,22464,22493,22522,22552,22581,22611,22640,22670,22700,22730,22759,22789,22818,22848,22877,22906,22936,22965,22994,23024,23054,23083,23113,23143,23173,23202,23232,23261,23290,23320,23349,23379,23408,23438,23467,23497,23527,23556,23586,23616,23645,23674,23704,23733,23763,23792,23822,23851,23881,23910,23940,23970,23999,24029,24058,24088,24117,24147,24176,24206,24235,24265,24294,24324,24353,24383,24413,24442,24472,24501,24531,24560,24590,24619,24648,24678,24707,24737,24767,24796,24826,24856,24885,24915,24944,24974,25003,25032,25062,25091,25121,25150,25180,25210,25240,25269,25299,25328,25358,25387,25416,25446,25475,25505,25534,25564,25594,25624,25653,25683,25712,25742,25771,25800,25830,25859,25888,25918,25948,25977,26007,26037,26067,26096,26126,26155,26184,26214,26243,26272,26302,26332,26361,26391,26421,26451,26480,26510,26539,26568,26598,26627,26656,26686,26715,26745,26775,26805,26834,26864,26893,26923,26952,26982,27011,27041,27070,27099,27129,27159,27188,27218,27248,27277,27307,27336,27366,27395,27425,27454,27484,27513,27542,27572,27602,27631,27661,27691,27720,27750,27779,27809,27838,27868,27897,27926,27956,27985,28015,28045,28074,28104,28134,28163,28193,28222,28252,28281,28310,28340,28369,28399,28428,28458,28488,28517,28547,28577,28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990]},{"../main":1409,"object-assign":438}],1409:[function(e,t){var l=Math.min,s=Math.abs,p=Math.floor;function a(){this.regionalOptions=[],this.regionalOptions[""]={invalidCalendar:"Calendar {0} not found",invalidDate:"Invalid {0} date",invalidMonth:"Invalid {0} month",invalidYear:"Invalid {0} year",differentCalendars:"Cannot mix {0} and {1} dates"},this.local=this.regionalOptions[""],this.calendars={},this._localCals={}}function o(e,t,a,o){if(this._calendar=e,this._year=t,this._month=a,this._day=o,0===this._calendar._validateLevel&&!this._calendar.isValid(this._year,this._month,this._day))throw(g.local.invalidDate||g.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name)}function r(e,t){return e=""+e,"000000".substring(0,t-e.length)+e}function i(){this.shortYearCutoff="+10"}function n(e){this.local=this.regionalOptions[e]||this.regionalOptions[""]}var u=e("object-assign");u(a.prototype,{instance:function(e,t){e=(e||"gregorian").toLowerCase(),t=t||"";var a=this._localCals[e+"-"+t];if(!a&&this.calendars[e]&&(a=new this.calendars[e](t),this._localCals[e+"-"+t]=a),!a)throw(this.local.invalidCalendar||this.regionalOptions[""].invalidCalendar).replace(/\{0\}/,e);return a},newDate:function(e,t,a,o,r){return o=(null!=e&&e.year?e.calendar():"string"==typeof o?this.instance(o,r):o)||this.instance(),o.newDate(e,t,a)},substituteDigits:function(e){return function(t){return(t+"").replace(/[0-9]/g,function(t){return e[t]})}},substituteChineseDigits:function(e,t){return function(a){for(var o="",r=0,i;0<a;)i=a%10,o=(0==i?"":e[i]+t[r])+o,r++,a=p(a/10);return 0===o.indexOf(e[1]+t[1])&&(o=o.substr(1)),o||e[0]}}}),u(o.prototype,{newDate:function(e,t,a){return this._calendar.newDate(null==e?this:e,t,a)},year:function(e){return 0===arguments.length?this._year:this.set(e,"y")},month:function(e){return 0===arguments.length?this._month:this.set(e,"m")},day:function(e){return 0===arguments.length?this._day:this.set(e,"d")},date:function(e,t,a){if(!this._calendar.isValid(e,t,a))throw(g.local.invalidDate||g.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name);return this._year=e,this._month=t,this._day=a,this},leapYear:function(){return this._calendar.leapYear(this)},epoch:function(){return this._calendar.epoch(this)},formatYear:function(){return this._calendar.formatYear(this)},monthOfYear:function(){return this._calendar.monthOfYear(this)},weekOfYear:function(){return this._calendar.weekOfYear(this)},daysInYear:function(){return this._calendar.daysInYear(this)},dayOfYear:function(){return this._calendar.dayOfYear(this)},daysInMonth:function(){return this._calendar.daysInMonth(this)},dayOfWeek:function(){return this._calendar.dayOfWeek(this)},weekDay:function(){return this._calendar.weekDay(this)},extraInfo:function(){return this._calendar.extraInfo(this)},add:function(e,t){return this._calendar.add(this,e,t)},set:function(e,t){return this._calendar.set(this,e,t)},compareTo:function(e){if(this._calendar.name!==e._calendar.name)throw(g.local.differentCalendars||g.regionalOptions[""].differentCalendars).replace(/\{0\}/,this._calendar.local.name).replace(/\{1\}/,e._calendar.local.name);var t=this._year===e._year?this._month===e._month?this._day-e._day:this.monthOfYear()-e.monthOfYear():this._year-e._year;return 0==t?0:0>t?-1:1},calendar:function(){return this._calendar},toJD:function(){return this._calendar.toJD(this)},fromJD:function(e){return this._calendar.fromJD(e)},toJSDate:function(){return this._calendar.toJSDate(this)},fromJSDate:function(e){return this._calendar.fromJSDate(e)},toString:function(){return(0>this.year()?"-":"")+r(s(this.year()),4)+"-"+r(this.month(),2)+"-"+r(this.day(),2)}}),u(i.prototype,{_validateLevel:0,newDate:function(e,t,a){return null==e?this.today():(e.year&&(this._validate(e,t,a,g.local.invalidDate||g.regionalOptions[""].invalidDate),a=e.day(),t=e.month(),e=e.year()),new o(this,e,t,a))},today:function(){return this.fromJSDate(new Date)},epoch:function(e){var t=this._validate(e,this.minMonth,this.minDay,g.local.invalidYear||g.regionalOptions[""].invalidYear);return 0>t.year()?this.local.epochs[0]:this.local.epochs[1]},formatYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,g.local.invalidYear||g.regionalOptions[""].invalidYear);return(0>t.year()?"-":"")+r(s(t.year()),4)},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,g.local.invalidYear||g.regionalOptions[""].invalidYear),12},monthOfYear:function(e,t){var a=this._validate(e,t,this.minDay,g.local.invalidMonth||g.regionalOptions[""].invalidMonth);return(a.month()+this.monthsInYear(a)-this.firstMonth)%this.monthsInYear(a)+this.minMonth},fromMonthOfYear:function(e,t){var a=(t+this.firstMonth-2*this.minMonth)%this.monthsInYear(e)+this.minMonth;return this._validate(e,a,this.minDay,g.local.invalidMonth||g.regionalOptions[""].invalidMonth),a},daysInYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,g.local.invalidYear||g.regionalOptions[""].invalidYear);return this.leapYear(t)?366:365},dayOfYear:function(e,t,a){var o=this._validate(e,t,a,g.local.invalidDate||g.regionalOptions[""].invalidDate);return o.toJD()-this.newDate(o.year(),this.fromMonthOfYear(o.year(),this.minMonth),this.minDay).toJD()+1},daysInWeek:function(){return 7},dayOfWeek:function(e,t,a){var o=this._validate(e,t,a,g.local.invalidDate||g.regionalOptions[""].invalidDate);return(p(this.toJD(o))+2)%this.daysInWeek()},extraInfo:function(e,t,a){return this._validate(e,t,a,g.local.invalidDate||g.regionalOptions[""].invalidDate),{}},add:function(e,t,a){return this._validate(e,this.minMonth,this.minDay,g.local.invalidDate||g.regionalOptions[""].invalidDate),this._correctAdd(e,this._add(e,t,a),t,a)},_add:function(e,t,a){if(this._validateLevel++,"d"===a||"w"===a){var o=e.toJD()+t*("w"===a?this.daysInWeek():1),r=e.calendar().fromJD(o);return this._validateLevel--,[r.year(),r.month(),r.day()]}try{var i=e.year()+("y"===a?t:0),n=e.monthOfYear()+("m"===a?t:0),r=e.day(),s=function(e){for(;n<e.minMonth;)i--,n+=e.monthsInYear(i);for(var t=e.monthsInYear(i);n>t-1+e.minMonth;)i++,n-=t,t=e.monthsInYear(i)};"y"===a?(e.month()!==this.fromMonthOfYear(i,n)&&(n=this.newDate(i,e.month(),this.minDay).monthOfYear()),n=l(n,this.monthsInYear(i)),r=l(r,this.daysInMonth(i,this.fromMonthOfYear(i,n)))):"m"==a&&(s(this),r=l(r,this.daysInMonth(i,this.fromMonthOfYear(i,n))));var c=[i,this.fromMonthOfYear(i,n),r];return this._validateLevel--,c}catch(t){throw this._validateLevel--,t}},_correctAdd:function(e,t,a,o){if(!this.hasYearZero&&("y"===o||"m"===o)&&(0===t[0]||0<e.year()!=0<t[0])){var r={y:[1,1,"y"],m:[1,this.monthsInYear(-1),"m"],w:[this.daysInWeek(),this.daysInYear(-1),"d"],d:[1,this.daysInYear(-1),"d"]}[o],i=0>a?-1:1;t=this._add(e,a*r[0]+i*r[1],r[2])}return e.date(t[0],t[1],t[2])},set:function(e,t,a){this._validate(e,this.minMonth,this.minDay,g.local.invalidDate||g.regionalOptions[""].invalidDate);var o="y"===a?t:e.year(),r="m"===a?t:e.month(),i="d"===a?t:e.day();return("y"===a||"m"===a)&&(i=l(i,this.daysInMonth(o,r))),e.date(o,r,i)},isValid:function(e,t,a){this._validateLevel++;var o=this.hasYearZero||0!==e;if(o){var r=this.newDate(e,t,this.minDay);o=t>=this.minMonth&&t-this.minMonth<this.monthsInYear(r)&&a>=this.minDay&&a-this.minDay<this.daysInMonth(r)}return this._validateLevel--,o},toJSDate:function(e,t,a){var o=this._validate(e,t,a,g.local.invalidDate||g.regionalOptions[""].invalidDate);return g.instance().fromJD(this.toJD(o)).toJSDate()},fromJSDate:function(e){return this.fromJD(g.instance().fromJSDate(e).toJD())},_validate:function(e,t,a,o){if(e.year){if(0===this._validateLevel&&this.name!==e.calendar().name)throw(g.local.differentCalendars||g.regionalOptions[""].differentCalendars).replace(/\{0\}/,this.local.name).replace(/\{1\}/,e.calendar().local.name);return e}try{if(this._validateLevel++,1===this._validateLevel&&!this.isValid(e,t,a))throw o.replace(/\{0\}/,this.local.name);var r=this.newDate(e,t,a);return this._validateLevel--,r}catch(t){throw this._validateLevel--,t}}}),n.prototype=new i,u(n.prototype,{name:"Gregorian",jdEpoch:1721425.5,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Gregorian",epochs:["BCE","CE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,g.local.invalidYear||g.regionalOptions[""].invalidYear),e=t.year()+(0>t.year()?1:0);return 0==e%4&&(0!=e%100||0==e%400)},weekOfYear:function(e,t,a){var o=this.newDate(e,t,a);return o.add(4-(o.dayOfWeek()||7),"d"),p((o.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var a=this._validate(e,t,this.minDay,g.local.invalidMonth||g.regionalOptions[""].invalidMonth);return this.daysPerMonth[a.month()-1]+(2===a.month()&&this.leapYear(a.year())?1:0)},weekDay:function(e,t,a){return 6>(this.dayOfWeek(e,t,a)||7)},toJD:function(e,t,o){var r=this._validate(e,t,o,g.local.invalidDate||g.regionalOptions[""].invalidDate);e=r.year(),t=r.month(),o=r.day(),0>e&&e++,3>t&&(t+=12,e--);var i=p(e/100),a=2-i+p(i/4);return p(365.25*(e+4716))+p(30.6001*(t+1))+o+a-1524.5},fromJD:function(t){var o=p(t+.5),r=p((o-1867216.25)/36524.25);r=o+1+r-p(r/4);var i=r+1524,n=p((i-122.1)/365.25),l=p(365.25*n),s=p((i-l)/30.6001),e=i-l-p(30.6001*s),d=s-(13.5<s?13:1),c=n-(2.5<d?4716:4715);return 0>=c&&c--,this.newDate(c,d,e)},toJSDate:function(e,t,a){var o=this._validate(e,t,a,g.local.invalidDate||g.regionalOptions[""].invalidDate),r=new Date(o.year(),o.month()-1,o.day());return r.setHours(0),r.setMinutes(0),r.setSeconds(0),r.setMilliseconds(0),r.setHours(12<r.getHours()?r.getHours()+2:0),r},fromJSDate:function(e){return this.newDate(e.getFullYear(),e.getMonth()+1,e.getDate())}});var g=t.exports=new a;g.cdate=o,g.baseCalendar=i,g.calendars.gregorian=n},{"object-assign":438}],1410:[function(e){var t=Math.floor,a=e("object-assign"),o=e("./main");a(o.regionalOptions[""],{invalidArguments:"Invalid arguments",invalidFormat:"Cannot format a date from another calendar",missingNumberAt:"Missing number at position {0}",unknownNameAt:"Unknown name at position {0}",unexpectedLiteralAt:"Unexpected literal at position {0}",unexpectedText:"Additional text found at end"}),o.local=o.regionalOptions[""],a(o.cdate.prototype,{formatDate:function(e,t){return"string"!=typeof e&&(t=e,e=""),this._calendar.formatDate(e||"",this,t)}}),a(o.baseCalendar.prototype,{UNIX_EPOCH:o.instance().newDate(1970,1,1).toJD(),SECS_PER_DAY:86400,TICKS_EPOCH:o.instance().jdEpoch,TICKS_PER_DAY:864000000000,ATOM:"yyyy-mm-dd",COOKIE:"D, dd M yyyy",FULL:"DD, MM d, yyyy",ISO_8601:"yyyy-mm-dd",JULIAN:"J",RFC_822:"D, d M yy",RFC_850:"DD, dd-M-yy",RFC_1036:"D, d M yy",RFC_1123:"D, d M yyyy",RFC_2822:"D, d M yyyy",RSS:"D, d M yy",TICKS:"!",TIMESTAMP:"@",W3C:"yyyy-mm-dd",formatDate:function(e,a,r){if("string"!=typeof e&&(r=a,a=e,e=""),!a)return"";if(a.calendar()!==this)throw o.local.invalidFormat||o.regionalOptions[""].invalidFormat;e=e||this.local.dateFormat,r=r||{};for(var i=r.dayNamesShort||this.local.dayNamesShort,n=r.dayNames||this.local.dayNames,l=r.monthNumbers||this.local.monthNumbers,s=r.monthNamesShort||this.local.monthNamesShort,d=r.monthNames||this.local.monthNames,c=r.calculateWeek||this.local.calculateWeek,p=function(a,o){for(var r=1;v+r<e.length&&e.charAt(v+r)===a;)r++;return v+=r-1,1<t(r/(o||1))},u=function(e,t,a,o){var r=""+t;if(p(e,o))for(;r.length<a;)r="0"+r;return r},g=function(e,t,a,o){return p(e)?o[t]:a[t]},m=this,h=function(e){return"function"==typeof l?l.call(m,e,p("m")):x(u("m",e.month(),2))},y=function(e,t){return t?"function"==typeof d?d.call(m,e):d[e.month()-m.minMonth]:"function"==typeof s?s.call(m,e):s[e.month()-m.minMonth]},f=this.local.digits,x=function(e){return r.localNumbers&&f?f(e):e},_="",b=!1,v=0;v<e.length;v++)if(b)"'"!==e.charAt(v)||p("'")?_+=e.charAt(v):b=!1;else switch(e.charAt(v)){case"d":_+=x(u("d",a.day(),2));break;case"D":_+=g("D",a.dayOfWeek(),i,n);break;case"o":_+=u("o",a.dayOfYear(),3);break;case"w":_+=u("w",a.weekOfYear(),2);break;case"m":_+=h(a);break;case"M":_+=y(a,p("M"));break;case"y":_+=p("y",2)?a.year():(10>a.year()%100?"0":"")+a.year()%100;break;case"Y":p("Y",2),_+=a.formatYear();break;case"J":_+=a.toJD();break;case"@":_+=(a.toJD()-this.UNIX_EPOCH)*this.SECS_PER_DAY;break;case"!":_+=(a.toJD()-this.TICKS_EPOCH)*this.TICKS_PER_DAY;break;case"'":p("'")?_+="'":b=!0;break;default:_+=e.charAt(v);}return _},parseDate:function(e,a,r){if(null==a)throw o.local.invalidArguments||o.regionalOptions[""].invalidArguments;if(a="object"==typeof a?a.toString():a+"",""===a)return null;e=e||this.local.dateFormat,r=r||{};var i=r.shortYearCutoff||this.shortYearCutoff;i="string"==typeof i?this.today().year()%100+parseInt(i,10):i;for(var n=r.dayNamesShort||this.local.dayNamesShort,l=r.dayNames||this.local.dayNames,s=r.parseMonth||this.local.parseMonth,d=r.monthNumbers||this.local.monthNumbers,c=r.monthNamesShort||this.local.monthNamesShort,p=r.monthNames||this.local.monthNames,u=-1,g=-1,m=-1,h=-1,y=-1,f=!1,x=!1,_=function(a,o){for(var r=1;C+r<e.length&&e.charAt(C+r)===a;)r++;return C+=r-1,1<t(r/(o||1))},b=function(e,t){var r=_(e,t),i=[2,3,r?4:2,r?4:2,10,11,20]["oyYJ@!".indexOf(e)+1],n=new RegExp("^-?\\d{1,"+i+"}"),l=a.substring(S).match(n);if(!l)throw(o.local.missingNumberAt||o.regionalOptions[""].missingNumberAt).replace(/\{0\}/,S);return S+=l[0].length,parseInt(l[0],10)},v=this,w=function(){if("function"==typeof d){_("m");var e=d.call(v,a.substring(S));return S+=e.length,e}return b("m")},k=function(e,t,r,n){for(var l=_(e,n)?r:t,s=0;s<l.length;s++)if(a.substr(S,l[s].length).toLowerCase()===l[s].toLowerCase())return S+=l[s].length,s+v.minMonth;throw(o.local.unknownNameAt||o.regionalOptions[""].unknownNameAt).replace(/\{0\}/,S)},T=function(){if("function"==typeof p){var e=_("M")?p.call(v,a.substring(S)):c.call(v,a.substring(S));return S+=e.length,e}return k("M",c,p)},A=function(){if(a.charAt(S)!==e.charAt(C))throw(o.local.unexpectedLiteralAt||o.regionalOptions[""].unexpectedLiteralAt).replace(/\{0\}/,S);S++},S=0,C=0;C<e.length;C++)if(x)"'"!==e.charAt(C)||_("'")?A():x=!1;else switch(e.charAt(C)){case"d":h=b("d");break;case"D":k("D",n,l);break;case"o":y=b("o");break;case"w":b("w");break;case"m":m=w();break;case"M":m=T();break;case"y":var L=C;f=!_("y",2),C=L,g=b("y",2);break;case"Y":g=b("Y",2);break;case"J":u=b("J")+.5,"."===a.charAt(S)&&(S++,b("J"));break;case"@":u=b("@")/this.SECS_PER_DAY+this.UNIX_EPOCH;break;case"!":u=b("!")/this.TICKS_PER_DAY+this.TICKS_EPOCH;break;case"*":S=a.length;break;case"'":_("'")?A():x=!0;break;default:A();}if(S<a.length)throw o.local.unexpectedText||o.regionalOptions[""].unexpectedText;if(-1===g?g=this.today().year():100>g&&f&&(g+=-1===i?1900:this.today().year()-this.today().year()%100-(g<=i?0:100)),"string"==typeof m&&(m=s.call(this,g,m)),-1<y){m=1,h=y;for(var E=this.daysInMonth(g,m);h>E;E=this.daysInMonth(g,m))m++,h-=E}return-1<u?this.fromJD(u):this.newDate(g,m,h)},determineDate:function(e,t,a,o,r){a&&"object"!=typeof a&&(r=o,o=a,a=null),"string"!=typeof o&&(r=o,o="");var i=this,n=function(e){try{return i.parseDate(o,e,r)}catch(t){}e=e.toLowerCase();for(var t=(e.match(/^c/)&&a?a.newDate():null)||i.today(),n=/([+-]?[0-9]+)\s*(d|w|m|y)?/g,l=n.exec(e);l;)t.add(parseInt(l[1],10),l[2]||"d"),l=n.exec(e);return t};return t=t?t.newDate():null,e=null==e?t:"string"==typeof e?n(e):"number"==typeof e?isNaN(e)||e===1/0||e===-Infinity?t:i.today().add(e,"d"):i.newDate(e),e}})},{"./main":1409,"object-assign":438}],1411:[function(e,t){t.exports=e("cwise-compiler")({args:["array",{offset:[1],array:0},"scalar","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\n        var _inline_1_da = _inline_1_arg0_ - _inline_1_arg3_\n        var _inline_1_db = _inline_1_arg1_ - _inline_1_arg3_\n        if((_inline_1_da >= 0) !== (_inline_1_db >= 0)) {\n          _inline_1_arg2_.push(_inline_1_arg4_[0] + 0.5 + 0.5 * (_inline_1_da + _inline_1_db) / (_inline_1_da - _inline_1_db))\n        }\n      }",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg3_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:[],localVars:["_inline_1_da","_inline_1_db"]},funcName:"zeroCrossings"})},{"cwise-compiler":93}],1412:[function(e,t){"use strict";t.exports=function(e,t){var o=[];return t=+t||0,a(e.hi(e.shape[0]-1),o,t),o};var a=e("./lib/zc-core")},{"./lib/zc-core":1411}],1413:[function(e){var t=e("uikit");window.onload=function(){var a=e("matter-js"),o=e("plotly.js"),r=e("vivagraphjs");e("dat.gui");var{InfectiousMatter:i,AgentStates:n,ContactGraph:l}=e("./lib/simulation.js");i.prototype.migrate_event=function(){return()=>{for(let e=0,t;e<s.num_visitors;e++){if(t=a.Common.choose(this.agents),t.migrating)continue;t.migrating=!0;let e=a.Common.choose(residences),o=t.home||t.location;t.home_state={position:t.body.position,velocity:t.body.velocity},t.location.migrate_to(e,t,function(t){t.body.plugin.wrap=e.bounds,a.Body.setPosition(t.body,e.get_random_position()),t.body.frictionAir=e.friction}),this.add_event({time:this.simulation_params.sim_time_per_day,callback:function(){t.location.migrate_to(o,t,function(e){e.body.plugin.wrap=o.bounds,a.Body.setPosition(e.body,o.get_random_position()),a.Body.setVelocity(e.body,e.home_state.velocity),e.body.frictionAir=o.friction,e.migrating=!1})}})}}};let s={num_residences:1,residence_options:[],pop_size:20,num_to_infect:2,num_visitors:0,residence_size:250,residence_padding:20},d={sim_time_per_day:1e3,agent_size:3,link_lifetime:200};d.link_lifetime=7*d.sim_time_per_day;let c={margin:{l:50,r:10,b:50,t:10,pad:10},showlegend:!0,legend:{x:1,xanchor:"right",y:1},xaxis:{title:"Days",rangemode:"nonnegative"},yaxis:{title:"Count",rangemode:"nonnegative"}},p=new i("matterDiv",!1,d,{per_contact_infection:.5,incubation_period_mu:5,incubation_period_sigma:3,infectious_period_mu:7,infectious_period_sigma:4,fraction_asymptomatic:.2,asymptomatic_infectious_period_mu:1.5,asymptomatic_infectious_period_sigma:1.5,fraction_seek_care:.5,fraction_isolate:.2,time_to_seek_care:2.5,movement_scale:.8},{viva_colors:[2473647103,16711935,4294902015,4289003775,65535,2846468607,4278255615,13554175,2566625535,3448061951],matter_colors:["mediumpurple","lime","yellow","orange","blue","darkgrey","fuchsia","darkturquoise","palegreen","peru"]}),u=r.Graph.Layout.forceDirected(l,{springLength:15,springCoeff:5e-5,dragCoeff:.01,gravity:-1.5}),g=r.Graph.View.webglGraphics(),m=r.Graph.View.renderer(l,{container:document.getElementById("graphDiv"),graphics:g,renderLinks:!0,layout:u,interactive:"node drag"});m.run();for(let e=0;30>e;e++)m.zoomOut();var h=function(e,t){residences=[];let o=t||s.residence_padding||20,r=e||s.residence_size||140,i=0,l=0;for(let a=0;a<s.num_residences;a++){o+r+(r+o)*i>p.matter_render.options.height&&(i=0,l+=1);let e=o+(o+r)*l,t=o+(r+o)*i;i+=1;let a=p.add_location("residence",{type:"residence",friction:.02,bounds:{min:{x:e,y:t},max:{x:e+r,y:t+r}}});residences.push(a),s.residence_options[residences.length-1]?s.residence_options[residences.length-1].subpop_size==null&&(s.residence_options[residences.length-1].subpop_size=s.pop_size/s.num_residences):s.residence_options.push({subpop_size:s.pop_size/s.num_residences});for(let e=0,t;e<s.residence_options[residences.length-1].subpop_size;e++)t=p.add_agent(a),"undefined"!=typeof g&&(g.getNodeUI(t.node.id).color=a.viva_node_color,g.getNodeUI(t.node.id).size=20)}p.add_event({time:1e3,callback:p.migrate_event(),recurring:!0}),p.add_event({time:3*p.simulation_params.sim_time_per_day,callback:function(){for(let e=0,t;e<s.num_to_infect;e++)t=a.Common.choose(p.agents),p.expose_org(t.body,n.S_INFECTED)}})},y;let f=function(){return[{x:[0],y:[0],stackgroup:"one",name:"Exposed",marker:{color:"orange"}},{x:[0],y:[0],stackgroup:"one",name:"Infected",marker:{color:"red"}},{x:[0],y:[0],stackgroup:"one",name:"Recovered",marker:{color:"green"}},{x:[0],y:[0],stackgroup:"one",name:"Susceptible",marker:{color:"grey"}}]},x=function(){clearInterval(y),o.purge("plotDiv"),p.clear_simulator(),s.residence_options=[],l.clear()},_=function(){p.setup_matter_env(),h()};t.util.on("#migrationSlider","input",function(t){let e=document.getElementById("migrationBadge");e.innerHTML=t.target.value,s.num_visitors=t.target.value});let b=!1;t.util.on("#page1","inview",function(){document.getElementById("graphDiv").style.visibility="hidden",document.getElementById("plotDiv").style.visibility="hidden"}),t.util.on("#page2","inview",function(){document.getElementById("graphDiv").style.visibility="hidden",document.getElementById("plotDiv").style.visibility="hidden",x(),s.pop_size=11,s.num_residences=1,s.num_visitors=0,s.residence_size=300-2*s.residence_padding,s.num_to_infect=0,_()}),t.util.on("#page3","inview",function(){document.getElementById("graphDiv").style.visibility="hidden",document.getElementById("plotDiv").style.visibility="hidden",x(),s.pop_size=100,s.num_residences=1,s.residence_size=300-2*s.residence_padding,s.num_to_infect=5,s.num_visitors=0,_(),p.infection_params.per_contact_infection=1,document.getElementById("plotDiv").style.visibility="hidden",o.newPlot("plotDiv",f(),c,{responsive:!0}),y=setInterval(function(){o.extendTraces("plotDiv",{x:[[p.cur_sim_time/d.sim_time_per_day],[p.cur_sim_time/d.sim_time_per_day],[p.cur_sim_time/d.sim_time_per_day],[p.cur_sim_time/d.sim_time_per_day]],y:[[p.state_counts[n.EXPOSED]],[p.state_counts[n.S_INFECTED]+p.state_counts[n.A_INFECTED]],[p.state_counts[n.RECOVERED]],[p.state_counts[n.SUSCEPTIBLE]]]},[0,1,2,3])},1e3),b=!0}),t.util.on("#page4","inview",function(){document.getElementById("graphDiv").style.visibility="hidden",document.getElementById("plotDiv").style.width=300,document.getElementById("plotDiv").style.visibility="visible",o.relayout("plotDiv",{width:300}),b=!0}),t.util.on("#page5","inview",function(){document.getElementById("graphDiv").style.visibility="hidden",document.getElementById("plotDiv").style.visibility="visible",x(),s.pop_size=100,s.num_residences=4,s.residence_size=120,s.num_to_infect=2,s.num_visitors=5,_(),p.infection_params.per_contact_infection=1,document.getElementById("plotDiv").style.visibility="visible",o.react("plotDiv",f(),c,{responsive:!0}),y=setInterval(function(){o.extendTraces("plotDiv",{x:[[p.cur_sim_time/d.sim_time_per_day],[p.cur_sim_time/d.sim_time_per_day],[p.cur_sim_time/d.sim_time_per_day],[p.cur_sim_time/d.sim_time_per_day]],y:[[p.state_counts[n.EXPOSED]],[p.state_counts[n.S_INFECTED]+p.state_counts[n.A_INFECTED]],[p.state_counts[n.RECOVERED]],[p.state_counts[n.SUSCEPTIBLE]]]},[0,1,2,3])},1e3),b=!0}),t.util.on("#page6","inview",function(){document.getElementById("graphDiv").style.visibility="visible"}),t.util.on("#page7","inview",function(){document.getElementById("plotDiv").style.visibility="visible",document.getElementById("graphDiv").style.visibility="visible";let e=function(e){x(),s.pop_size=20,s.num_residences=9,s.residence_size=80,s.residence_padding=15,s.agent_size=1.5,s.num_to_infect=2,s.num_visitors=e||3,s.residence_options=[{subpop_size:70},{subpop_size:40},{subpop_size:10},{subpop_size:30},{subpop_size:12},{subpop_size:10},{subpop_size:20},{subpop_size:12},{subpop_size:10}],_(),p.infection_params.per_contact_infection=.5,p.infection_params.movement_scale=1,o.react("plotDiv",f(),c,{responsive:!0}),y=setInterval(function(){o.extendTraces("plotDiv",{x:[[p.cur_sim_time/d.sim_time_per_day],[p.cur_sim_time/d.sim_time_per_day],[p.cur_sim_time/d.sim_time_per_day],[p.cur_sim_time/d.sim_time_per_day]],y:[[p.state_counts[n.EXPOSED]],[p.state_counts[n.S_INFECTED]+p.state_counts[n.A_INFECTED]],[p.state_counts[n.RECOVERED]],[p.state_counts[n.SUSCEPTIBLE]]]},[0,1,2,3])},1e3)};b&&e(s.num_visitors),b=!1,document.getElementById("restart_btn").onclick=function(){e(s.num_visitors)}})}},{"./lib/simulation.js":5,"dat.gui":109,"matter-js":407,"plotly.js":478,uikit:1329,vivagraphjs:1389}],1414:[function(e,t){(function(a){'use strict';/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function o(e,t){if(e===t)return 0;for(var a=e.length,o=t.length,r=0,n=Math.min(a,o);r<n;++r)if(e[r]!==t[r]){a=e[r],o=t[r];break}return a<o?-1:o<a?1:0}function r(e){return a.Buffer&&"function"==typeof a.Buffer.isBuffer?a.Buffer.isBuffer(e):!!(null!=e&&e._isBuffer)}function i(e){return Object.prototype.toString.call(e)}function n(e){return!r(e)&&!("function"!=typeof a.ArrayBuffer)&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(!!(e instanceof DataView)||!!(e.buffer&&e.buffer instanceof ArrayBuffer)))}function l(e){if(w.isFunction(e)){if(A)return e.name;var t=e.toString(),a=t.match(C);return a&&a[1]}}function s(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function d(e){if(A||!w.isFunction(e))return w.inspect(e);var t=l(e),a=t?": "+t:"";return"[Function"+a+"]"}function c(e){return s(d(e.actual),128)+" "+e.operator+" "+s(d(e.expected),128)}function p(e,t,a,o,r){throw new S.AssertionError({message:a,actual:e,expected:t,operator:o,stackStartFunction:r})}function u(e,t){e||p(e,!0,t,"==",S.ok)}function g(e,t,a,l){if(e===t)return!0;if(r(e)&&r(t))return 0===o(e,t);if(w.isDate(e)&&w.isDate(t))return e.getTime()===t.getTime();if(w.isRegExp(e)&&w.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if((null===e||"object"!=typeof e)&&(null===t||"object"!=typeof t))return a?e===t:e==t;if(n(e)&&n(t)&&i(e)===i(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===o(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(r(e)!==r(t))return!1;l=l||{actual:[],expected:[]};var s=l.actual.indexOf(e);return-1!==s&&s===l.expected.indexOf(t)||(l.actual.push(e),l.expected.push(t),h(e,t,a,l))}function m(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function h(e,t,o,r){if(null===e||e===void 0||null===t||t===void 0)return!1;if(w.isPrimitive(e)||w.isPrimitive(t))return e===t;if(o&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var n=m(e),l=m(t);if(n&&!l||!n&&l)return!1;if(n)return e=T.call(e),t=T.call(t),g(e,t,o);var s=L(e),d=L(t),c,p;if(s.length!==d.length)return!1;for(s.sort(),d.sort(),p=s.length-1;0<=p;p--)if(s[p]!==d[p])return!1;for(p=s.length-1;0<=p;p--)if(c=s[p],!g(e[c],t[c],o,r))return!1;return!0}function y(e,t,a){g(e,t,!0)&&p(e,t,a,"notDeepStrictEqual",y)}function f(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(t){}return!Error.isPrototypeOf(t)&&!0===t.call({},e)}function x(e){var t;try{e()}catch(a){t=a}return t}function _(e,t,a,o){var r;if("function"!=typeof t)throw new TypeError("\"block\" argument must be a function");"string"==typeof a&&(o=a,a=null),r=x(t),o=(a&&a.name?" ("+a.name+").":".")+(o?" "+o:"."),e&&!r&&p(r,a,"Missing expected exception"+o);var i="string"==typeof o,n=!e&&w.isError(r),l=!e&&r&&!a;if((n&&i&&f(r,a)||l)&&p(r,a,"Got unwanted exception"+o),e&&r&&a&&!f(r,a)||!e&&r)throw r}function b(e,t){e||p(e,!0,t,"==",b)}var v=e("object-assign"),w=e("util/"),k=Object.prototype.hasOwnProperty,T=Array.prototype.slice,A=function(){return"foo"===function(){}.name}(),S=t.exports=u,C=/\s*function\s+([^\(\s]*)\s*/;S.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=c(this),this.generatedMessage=!0);var t=e.stackStartFunction||p;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var a=new Error;if(a.stack){var o=a.stack,r=l(t),i=o.indexOf("\n"+r);if(0<=i){var n=o.indexOf("\n",i+1);o=o.substring(n+1)}this.stack=o}}},w.inherits(S.AssertionError,Error),S.fail=p,S.ok=u,S.equal=function(e,t,a){e!=t&&p(e,t,a,"==",S.equal)},S.notEqual=function(e,t,a){e==t&&p(e,t,a,"!=",S.notEqual)},S.deepEqual=function(e,t,a){g(e,t,!1)||p(e,t,a,"deepEqual",S.deepEqual)},S.deepStrictEqual=function(e,t,a){g(e,t,!0)||p(e,t,a,"deepStrictEqual",S.deepStrictEqual)},S.notDeepEqual=function(e,t,a){g(e,t,!1)&&p(e,t,a,"notDeepEqual",S.notDeepEqual)},S.notDeepStrictEqual=y,S.strictEqual=function(e,t,a){e!==t&&p(e,t,a,"===",S.strictEqual)},S.notStrictEqual=function(e,t,a){e===t&&p(e,t,a,"!==",S.notStrictEqual)},S.throws=function(e,t,a){_(!0,e,t,a)},S.doesNotThrow=function(e,t,a){_(!1,e,t,a)},S.ifError=function(e){if(e)throw e},S.strict=v(b,S,{equal:S.strictEqual,deepEqual:S.deepStrictEqual,notEqual:S.notStrictEqual,notDeepEqual:S.notDeepStrictEqual}),S.strict.strict=S.strict;var L=Object.keys||function(e){var t=[];for(var a in e)k.call(e,a)&&t.push(a);return t}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"object-assign":1423,"util/":1417}],1415:[function(e,t){t.exports="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var a=function(){};a.prototype=t.prototype,e.prototype=new a,e.prototype.constructor=e}},{}],1416:[function(e,t){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],1417:[function(e,t,a){(function(t,o){function r(e,t){var o={seen:[],stylize:n};return 3<=arguments.length&&(o.depth=arguments[2]),4<=arguments.length&&(o.colors=arguments[3]),h(t)?o.showHidden=t:t&&a._extend(o,t),b(o.showHidden)&&(o.showHidden=!1),b(o.depth)&&(o.depth=2),b(o.colors)&&(o.colors=!1),b(o.customInspect)&&(o.customInspect=!0),o.colors&&(o.stylize=i),s(o,e,o.depth)}function i(e,t){var a=r.styles[t];return a?"\x1B["+r.colors[a][0]+"m"+e+"\x1B["+r.colors[a][1]+"m":e}function n(e){return e}function l(e){var t={};return e.forEach(function(e){t[e]=!0}),t}function s(e,t,o){if(e.customInspect&&t&&A(t.inspect)&&t.inspect!==a.inspect&&!(t.constructor&&t.constructor.prototype===t)){var r=t.inspect(o,e);return _(r)||(r=s(e,r,o)),r}var i=d(e,t);if(i)return i;var h=Object.keys(t),y=l(h);if(e.showHidden&&(h=Object.getOwnPropertyNames(t)),T(t)&&(0<=h.indexOf("message")||0<=h.indexOf("description")))return c(t);if(0===h.length){if(A(t)){var f=t.name?": "+t.name:"";return e.stylize("[Function"+f+"]","special")}if(v(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(k(t))return e.stylize(Date.prototype.toString.call(t),"date");if(T(t))return c(t)}var x="",b=!1,w=["{","}"];if(m(t)&&(b=!0,w=["[","]"]),A(t)){var S=t.name?": "+t.name:"";x=" [Function"+S+"]"}if(v(t)&&(x=" "+RegExp.prototype.toString.call(t)),k(t)&&(x=" "+Date.prototype.toUTCString.call(t)),T(t)&&(x=" "+c(t)),0===h.length&&(!b||0==t.length))return w[0]+x+w[1];if(0>o)return v(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special");e.seen.push(t);var n;return n=b?p(e,t,o,y,h):h.map(function(a){return u(e,t,o,y,a,b)}),e.seen.pop(),g(n,x,w)}function d(e,t){if(b(t))return e.stylize("undefined","undefined");if(_(t)){var a="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,"\"")+"'";return e.stylize(a,"string")}return f(t)?e.stylize(""+t,"number"):h(t)?e.stylize(""+t,"boolean"):y(t)?e.stylize("null","null"):void 0}function c(e){return"["+Error.prototype.toString.call(e)+"]"}function p(e,t,a,o,r){for(var n=[],s=0,d=t.length;s<d;++s)E(t,s+"")?n.push(u(e,t,a,o,s+"",!0)):n.push("");return r.forEach(function(r){r.match(/^\d+$/)||n.push(u(e,t,a,o,r,!0))}),n}function u(e,t,a,o,r,i){var n,l,d;if(d=Object.getOwnPropertyDescriptor(t,r)||{value:t[r]},d.get?d.set?l=e.stylize("[Getter/Setter]","special"):l=e.stylize("[Getter]","special"):d.set&&(l=e.stylize("[Setter]","special")),E(o,r)||(n="["+r+"]"),l||(0>e.seen.indexOf(d.value)?(l=y(a)?s(e,d.value,null):s(e,d.value,a-1),-1<l.indexOf("\n")&&(i?l=l.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):l="\n"+l.split("\n").map(function(e){return"   "+e}).join("\n"))):l=e.stylize("[Circular]","special")),b(n)){if(i&&r.match(/^\d+$/))return l;n=JSON.stringify(""+r),n.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(n=n.substr(1,n.length-2),n=e.stylize(n,"name")):(n=n.replace(/'/g,"\\'").replace(/\\"/g,"\"").replace(/(^"|"$)/g,"'"),n=e.stylize(n,"string"))}return n+": "+l}function g(e,t,a){var o=0,r=e.reduce(function(e,t){return o++,0<=t.indexOf("\n")&&o++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);return 60<r?a[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+a[1]:a[0]+t+" "+e.join(", ")+" "+a[1]}function m(e){return Array.isArray(e)}function h(e){return"boolean"==typeof e}function y(e){return null===e}function f(e){return"number"==typeof e}function _(e){return"string"==typeof e}function b(e){return void 0===e}function v(e){return w(e)&&"[object RegExp]"===S(e)}function w(e){return"object"==typeof e&&null!==e}function k(e){return w(e)&&"[object Date]"===S(e)}function T(t){return w(t)&&("[object Error]"===S(t)||t instanceof Error)}function A(e){return"function"==typeof e}function S(e){return Object.prototype.toString.call(e)}function C(e){return 10>e?"0"+e.toString(10):e.toString(10)}function L(){var e=new Date,t=[C(e.getHours()),C(e.getMinutes()),C(e.getSeconds())].join(":");return[e.getDate(),z[e.getMonth()],t].join(" ")}function E(e,t){return Object.prototype.hasOwnProperty.call(e,t)}a.format=function(e){if(!_(e)){for(var t=[],a=0;a<arguments.length;a++)t.push(r(arguments[a]));return t.join(" ")}for(var a=1,o=arguments,n=o.length,l=(e+"").replace(/%[sdj%]/g,function(e){if("%%"===e)return"%";if(a>=n)return e;switch(e){case"%s":return o[a++]+"";case"%d":return+o[a++];case"%j":try{return JSON.stringify(o[a++])}catch(e){return"[Circular]"}default:return e;}}),s=o[a];a<n;s=o[++a])l+=y(s)||!w(s)?" "+s:" "+r(s);return l},a.deprecate=function(e,r){function i(){if(!n){if(t.throwDeprecation)throw new Error(r);else t.traceDeprecation?console.trace(r):console.error(r);n=!0}return e.apply(this,arguments)}if(b(o.process))return function(){return a.deprecate(e,r).apply(this,arguments)};if(!0===t.noDeprecation)return e;var n=!1;return i};var I={},P;a.debuglog=function(e){if(b(P)&&(P=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!I[e])if(new RegExp("\\b"+e+"\\b","i").test(P)){var o=t.pid;I[e]=function(){var t=a.format.apply(a,arguments);console.error("%s %d: %s",e,o,t)}}else I[e]=function(){};return I[e]},a.inspect=r,r.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},r.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},a.isArray=m,a.isBoolean=h,a.isNull=y,a.isNullOrUndefined=function(e){return null==e},a.isNumber=f,a.isString=_,a.isSymbol=function(e){return"symbol"==typeof e},a.isUndefined=b,a.isRegExp=v,a.isObject=w,a.isDate=k,a.isError=T,a.isFunction=A,a.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e},a.isBuffer=e("./support/isBuffer");var z=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];a.log=function(){console.log("%s - %s",L(),a.format.apply(a,arguments))},a.inherits=e("inherits"),a._extend=function(e,t){if(!t||!w(t))return e;for(var a=Object.keys(t),o=a.length;o--;)e[a[o]]=t[a[o]];return e}}).call(this,e("_process"),"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"./support/isBuffer":1416,_process:1425,inherits:1415}],1418:[function(e,t,a){'use strict';function o(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");var a=e.indexOf("=");-1===a&&(a=t);var o=a===t?0:4-a%4;return[a,o]}function r(e,t,a){return 3*(t+a)/4-a}function n(e){var t=o(e),a=t[0],n=t[1],l=new u(r(e,a,n)),s=0,d=0<n?a-4:a,c,g;for(g=0;g<d;g+=4)c=p[e.charCodeAt(g)]<<18|p[e.charCodeAt(g+1)]<<12|p[e.charCodeAt(g+2)]<<6|p[e.charCodeAt(g+3)],l[s++]=255&c>>16,l[s++]=255&c>>8,l[s++]=255&c;return 2===n&&(c=p[e.charCodeAt(g)]<<2|p[e.charCodeAt(g+1)]>>4,l[s++]=255&c),1===n&&(c=p[e.charCodeAt(g)]<<10|p[e.charCodeAt(g+1)]<<4|p[e.charCodeAt(g+2)]>>2,l[s++]=255&c>>8,l[s++]=255&c),l}function l(e){return c[63&e>>18]+c[63&e>>12]+c[63&e>>6]+c[63&e]}function s(e,t,a){for(var o=[],r=t,n;r<a;r+=3)n=(16711680&e[r]<<16)+(65280&e[r+1]<<8)+(255&e[r+2]),o.push(l(n));return o.join("")}function d(e){for(var t=e.length,a=t%3,o=[],r=16383,n=0,l=t-a,d;n<l;n+=r)o.push(s(e,n,n+r>l?l:n+r));return 1===a?(d=e[t-1],o.push(c[d>>2]+c[63&d<<4]+"==")):2===a&&(d=(e[t-2]<<8)+e[t-1],o.push(c[d>>10]+c[63&d>>4]+c[63&d<<2]+"=")),o.join("")}a.byteLength=function(e){var t=o(e),a=t[0],r=t[1];return 3*(a+r)/4-r},a.toByteArray=n,a.fromByteArray=d;for(var c=[],p=[],u="undefined"==typeof Uint8Array?Array:Uint8Array,g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",m=0,h=g.length;m<h;++m)c[m]=g[m],p[g.charCodeAt(m)]=m;p[45]=62,p[95]=63},{}],1419:[function(){},{}],1420:[function(e,t,a){var o=String.fromCharCode,r=Math.min,n=Math.pow;(function(t){/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */'use strict';function l(e){if(2147483647<e)throw new RangeError("The value \""+e+"\" is invalid for option \"size\"");var a=new Uint8Array(e);return a.__proto__=t.prototype,a}function t(e,a,o){if("number"==typeof e){if("string"==typeof a)throw new TypeError("The \"string\" argument must be of type string. Received type number");return p(e)}return s(e,a,o)}function s(e,a,o){if("string"==typeof e)return u(e,a);if(ArrayBuffer.isView(e))return g(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(X(e,ArrayBuffer)||e&&X(e.buffer,ArrayBuffer))return m(e,a,o);if("number"==typeof e)throw new TypeError("The \"value\" argument must not be of type number. Received type number");var r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return t.from(r,a,o);var i=h(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return t.from(e[Symbol.toPrimitive]("string"),a,o);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function d(e){if("number"!=typeof e)throw new TypeError("\"size\" argument must be of type number");else if(0>e)throw new RangeError("The value \""+e+"\" is invalid for option \"size\"")}function c(e,t,a){return d(e),0>=e?l(e):void 0===t?l(e):"string"==typeof a?l(e).fill(t,a):l(e).fill(t)}function p(e){return d(e),l(0>e?0:0|y(e))}function u(e,a){if(("string"!=typeof a||""===a)&&(a="utf8"),!t.isEncoding(a))throw new TypeError("Unknown encoding: "+a);var o=0|x(e,a),r=l(o),i=r.write(e,a);return i!==o&&(r=r.slice(0,i)),r}function g(e){for(var t=0>e.length?0:0|y(e.length),a=l(t),o=0;o<t;o+=1)a[o]=255&e[o];return a}function m(e,a,o){if(0>a||e.byteLength<a)throw new RangeError("\"offset\" is outside of buffer bounds");if(e.byteLength<a+(o||0))throw new RangeError("\"length\" is outside of buffer bounds");var r;return r=void 0===a&&void 0===o?new Uint8Array(e):void 0===o?new Uint8Array(e,a):new Uint8Array(e,a,o),r.__proto__=t.prototype,r}function h(e){if(t.isBuffer(e)){var a=0|y(e.length),o=l(a);return 0===o.length?o:(e.copy(o,0,0,a),o)}return void 0===e.length?"Buffer"===e.type&&Array.isArray(e.data)?g(e.data):void 0:"number"!=typeof e.length||Z(e.length)?l(0):g(e)}function y(e){if(e>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647 .toString(16)+" bytes");return 0|e}function f(e){return+e!=e&&(e=0),t.alloc(+e)}function x(e,a){if(t.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||X(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError("The \"string\" argument must be one of type string, Buffer, or ArrayBuffer. Received type "+typeof e);var o=e.length,r=2<arguments.length&&!0===arguments[2];if(!r&&0===o)return 0;for(var i=!1;;)switch(a){case"ascii":case"latin1":case"binary":return o;case"utf8":case"utf-8":return H(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*o;case"hex":return o>>>1;case"base64":return Y(e).length;default:if(i)return r?-1:H(e).length;a=(""+a).toLowerCase(),i=!0;}}function _(e,t,a){var o=!1;if((void 0===t||0>t)&&(t=0),t>this.length)return"";if((void 0===a||a>this.length)&&(a=this.length),0>=a)return"";if(a>>>=0,t>>>=0,a<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return O(this,t,a);case"utf8":case"utf-8":return I(this,t,a);case"ascii":return z(this,t,a);case"latin1":case"binary":return D(this,t,a);case"base64":return E(this,t,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,t,a);default:if(o)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),o=!0;}}function b(e,t,a){var o=e[t];e[t]=e[a],e[a]=o}function v(e,a,o,r,i){if(0===e.length)return-1;if("string"==typeof o?(r=o,o=0):2147483647<o?o=2147483647:-2147483648>o&&(o=-2147483648),o=+o,Z(o)&&(o=i?0:e.length-1),0>o&&(o=e.length+o),o>=e.length){if(i)return-1;o=e.length-1}else if(0>o)if(i)o=0;else return-1;if("string"==typeof a&&(a=t.from(a,r)),t.isBuffer(a))return 0===a.length?-1:w(e,a,o,r,i);if("number"==typeof a)return a&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,a,o):Uint8Array.prototype.lastIndexOf.call(e,a,o):w(e,[a],o,r,i);throw new TypeError("val must be string, number or Buffer")}function w(e,t,a,o,r){function n(e,t){return 1===l?e[t]:e.readUInt16BE(t*l)}var l=1,s=e.length,d=t.length;if(void 0!==o&&(o=(o+"").toLowerCase(),"ucs2"===o||"ucs-2"===o||"utf16le"===o||"utf-16le"===o)){if(2>e.length||2>t.length)return-1;l=2,s/=2,d/=2,a/=2}var c;if(r){var p=-1;for(c=a;c<s;c++)if(n(e,c)!==n(t,-1===p?0:c-p))-1!==p&&(c-=c-p),p=-1;else if(-1===p&&(p=c),c-p+1===d)return p*l}else for(a+d>s&&(a=s-d),c=a;0<=c;c--){for(var u=!0,g=0;g<d;g++)if(n(e,c+g)!==n(t,g)){u=!1;break}if(u)return c}return-1}function k(e,t,a,o){a=+a||0;var r=e.length-a;o?(o=+o,o>r&&(o=r)):o=r;var n=t.length;o>n/2&&(o=n/2);for(var l=0,s;l<o;++l){if(s=parseInt(t.substr(2*l,2),16),Z(s))return l;e[a+l]=s}return l}function T(e,t,a,o){return W(H(t,e.length-a),e,a,o)}function A(e,t,a,o){return W(q(t),e,a,o)}function S(e,t,a,o){return A(e,t,a,o)}function C(e,t,a,o){return W(Y(t),e,a,o)}function L(e,t,a,o){return W(G(t,e.length-a),e,a,o)}function E(e,t,a){return 0===t&&a===e.length?K.fromByteArray(e):K.fromByteArray(e.slice(t,a))}function I(e,t,a){a=r(e.length,a);for(var o=[],n=t;n<a;){var l=e[n],s=null,d=239<l?4:223<l?3:191<l?2:1;if(n+d<=a){var c,p,u,g;1===d?128>l&&(s=l):2===d?(c=e[n+1],128==(192&c)&&(g=(31&l)<<6|63&c,127<g&&(s=g))):3===d?(c=e[n+1],p=e[n+2],128==(192&c)&&128==(192&p)&&(g=(15&l)<<12|(63&c)<<6|63&p,2047<g&&(55296>g||57343<g)&&(s=g))):4===d?(c=e[n+1],p=e[n+2],u=e[n+3],128==(192&c)&&128==(192&p)&&128==(192&u)&&(g=(15&l)<<18|(63&c)<<12|(63&p)<<6|63&u,65535<g&&1114112>g&&(s=g))):void 0}null===s?(s=65533,d=1):65535<s&&(s-=65536,o.push(55296|1023&s>>>10),s=56320|1023&s),o.push(s),n+=d}return P(o)}function P(e){var t=e.length;if(t<=4096)return o.apply(String,e);for(var a="",r=0;r<t;)a+=o.apply(String,e.slice(r,r+=4096));return a}function z(e,t,a){var n="";a=r(e.length,a);for(var l=t;l<a;++l)n+=o(127&e[l]);return n}function D(e,t,a){var n="";a=r(e.length,a);for(var l=t;l<a;++l)n+=o(e[l]);return n}function O(e,t,a){var o=e.length;(!t||0>t)&&(t=0),(!a||0>a||a>o)&&(a=o);for(var r="",n=t;n<a;++n)r+=U(e[n]);return r}function R(e,t,a){for(var r=e.slice(t,a),n="",l=0;l<r.length;l+=2)n+=o(r[l]+256*r[l+1]);return n}function M(e,t,a){if(0!=e%1||0>e)throw new RangeError("offset is not uint");if(e+t>a)throw new RangeError("Trying to access beyond buffer length")}function j(e,a,o,r,i,n){if(!t.isBuffer(e))throw new TypeError("\"buffer\" argument must be a Buffer instance");if(a>i||a<n)throw new RangeError("\"value\" argument is out of bounds");if(o+r>e.length)throw new RangeError("Index out of range")}function B(e,t,a,o){if(a+o>e.length)throw new RangeError("Index out of range");if(0>a)throw new RangeError("Index out of range")}function F(e,t,a,o,r){return t=+t,a>>>=0,r||B(e,t,a,4,34028234663852886e22,-34028234663852886e22),$.write(e,t,a,o,23,4),a+4}function N(e,t,a,o,r){return t=+t,a>>>=0,r||B(e,t,a,8,17976931348623157e292,-17976931348623157e292),$.write(e,t,a,o,52,8),a+8}function V(e){if(e=e.split("=")[0],e=e.trim().replace(J,""),2>e.length)return"";for(;0!=e.length%4;)e+="=";return e}function U(e){return 16>e?"0"+e.toString(16):e.toString(16)}function H(e,t){t=t||1/0;for(var a=e.length,o=null,r=[],n=0,l;n<a;++n){if(l=e.charCodeAt(n),55295<l&&57344>l){if(!o){if(56319<l){-1<(t-=3)&&r.push(239,191,189);continue}else if(n+1===a){-1<(t-=3)&&r.push(239,191,189);continue}o=l;continue}if(56320>l){-1<(t-=3)&&r.push(239,191,189),o=l;continue}l=(o-55296<<10|l-56320)+65536}else o&&-1<(t-=3)&&r.push(239,191,189);if(o=null,128>l){if(0>(t-=1))break;r.push(l)}else if(2048>l){if(0>(t-=2))break;r.push(192|l>>6,128|63&l)}else if(65536>l){if(0>(t-=3))break;r.push(224|l>>12,128|63&l>>6,128|63&l)}else if(1114112>l){if(0>(t-=4))break;r.push(240|l>>18,128|63&l>>12,128|63&l>>6,128|63&l)}else throw new Error("Invalid code point")}return r}function q(e){for(var t=[],a=0;a<e.length;++a)t.push(255&e.charCodeAt(a));return t}function G(e,t){for(var a=[],o=0,r,n,l;o<e.length&&!(0>(t-=2));++o)r=e.charCodeAt(o),n=r>>8,l=r%256,a.push(l),a.push(n);return a}function Y(e){return K.toByteArray(V(e))}function W(e,t,a,o){for(var r=0;r<o&&!(r+a>=t.length||r>=e.length);++r)t[r+a]=e[r];return r}function X(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Z(e){return e!==e}var K=e("base64-js"),$=e("ieee754");a.Buffer=t,a.SlowBuffer=f,a.INSPECT_MAX_BYTES=50;a.kMaxLength=2147483647,t.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(t){return!1}}(),t.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(t.prototype,"parent",{enumerable:!0,get:function(){return t.isBuffer(this)?this.buffer:void 0}}),Object.defineProperty(t.prototype,"offset",{enumerable:!0,get:function(){return t.isBuffer(this)?this.byteOffset:void 0}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&t[Symbol.species]===t&&Object.defineProperty(t,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),t.poolSize=8192,t.from=function(e,t,a){return s(e,t,a)},t.prototype.__proto__=Uint8Array.prototype,t.__proto__=Uint8Array,t.alloc=function(e,t,a){return c(e,t,a)},t.allocUnsafe=function(e){return p(e)},t.allocUnsafeSlow=function(e){return p(e)},t.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==t.prototype},t.compare=function(e,o){if(X(e,Uint8Array)&&(e=t.from(e,e.offset,e.byteLength)),X(o,Uint8Array)&&(o=t.from(o,o.offset,o.byteLength)),!t.isBuffer(e)||!t.isBuffer(o))throw new TypeError("The \"buf1\", \"buf2\" arguments must be one of type Buffer or Uint8Array");if(e===o)return 0;for(var n=e.length,l=o.length,s=0,d=r(n,l);s<d;++s)if(e[s]!==o[s]){n=e[s],l=o[s];break}return n<l?-1:l<n?1:0},t.isEncoding=function(e){switch((e+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1;}},t.concat=function(e,a){if(!Array.isArray(e))throw new TypeError("\"list\" argument must be an Array of Buffers");if(0===e.length)return t.alloc(0);var o;if(a===void 0)for(a=0,o=0;o<e.length;++o)a+=e[o].length;var r=t.allocUnsafe(a),n=0;for(o=0;o<e.length;++o){var l=e[o];if(X(l,Uint8Array)&&(l=t.from(l)),!t.isBuffer(l))throw new TypeError("\"list\" argument must be an Array of Buffers");l.copy(r,n),n+=l.length}return r},t.byteLength=x,t.prototype._isBuffer=!0,t.prototype.swap16=function(){var e=this.length;if(0!=e%2)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)b(this,t,t+1);return this},t.prototype.swap32=function(){var e=this.length;if(0!=e%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)b(this,t,t+3),b(this,t+1,t+2);return this},t.prototype.swap64=function(){var e=this.length;if(0!=e%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)b(this,t,t+7),b(this,t+1,t+6),b(this,t+2,t+5),b(this,t+3,t+4);return this},t.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?I(this,0,e):_.apply(this,arguments)},t.prototype.toLocaleString=t.prototype.toString,t.prototype.equals=function(e){if(!t.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===t.compare(this,e)},t.prototype.inspect=function(){var e="",t=a.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},t.prototype.compare=function(e,a,o,n,l){if(X(e,Uint8Array)&&(e=t.from(e,e.offset,e.byteLength)),!t.isBuffer(e))throw new TypeError("The \"target\" argument must be one of type Buffer or Uint8Array. Received type "+typeof e);if(void 0===a&&(a=0),void 0===o&&(o=e?e.length:0),void 0===n&&(n=0),void 0===l&&(l=this.length),0>a||o>e.length||0>n||l>this.length)throw new RangeError("out of range index");if(n>=l&&a>=o)return 0;if(n>=l)return-1;if(a>=o)return 1;if(a>>>=0,o>>>=0,n>>>=0,l>>>=0,this===e)return 0;for(var s=l-n,d=o-a,c=r(s,d),p=this.slice(n,l),u=e.slice(a,o),g=0;g<c;++g)if(p[g]!==u[g]){s=p[g],d=u[g];break}return s<d?-1:d<s?1:0},t.prototype.includes=function(e,t,a){return-1!==this.indexOf(e,t,a)},t.prototype.indexOf=function(e,t,a){return v(this,e,t,a,!0)},t.prototype.lastIndexOf=function(e,t,a){return v(this,e,t,a,!1)},t.prototype.write=function(e,t,a,o){if(void 0===t)o="utf8",a=this.length,t=0;else if(void 0===a&&"string"==typeof t)o=t,a=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(a)?(a>>>=0,void 0===o&&(o="utf8")):(o=a,a=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var r=this.length-t;if((void 0===a||a>r)&&(a=r),0<e.length&&(0>a||0>t)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");o||(o="utf8");for(var i=!1;;)switch(o){case"hex":return k(this,e,t,a);case"utf8":case"utf-8":return T(this,e,t,a);case"ascii":return A(this,e,t,a);case"latin1":case"binary":return S(this,e,t,a);case"base64":return C(this,e,t,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,e,t,a);default:if(i)throw new TypeError("Unknown encoding: "+o);o=(""+o).toLowerCase(),i=!0;}},t.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};t.prototype.slice=function(e,a){var o=this.length;e=~~e,a=void 0===a?o:~~a,0>e?(e+=o,0>e&&(e=0)):e>o&&(e=o),0>a?(a+=o,0>a&&(a=0)):a>o&&(a=o),a<e&&(a=e);var r=this.subarray(e,a);return r.__proto__=t.prototype,r},t.prototype.readUIntLE=function(e,t,a){e>>>=0,t>>>=0,a||M(e,t,this.length);for(var o=this[e],r=1,n=0;++n<t&&(r*=256);)o+=this[e+n]*r;return o},t.prototype.readUIntBE=function(e,t,a){e>>>=0,t>>>=0,a||M(e,t,this.length);for(var o=this[e+--t],r=1;0<t&&(r*=256);)o+=this[e+--t]*r;return o},t.prototype.readUInt8=function(e,t){return e>>>=0,t||M(e,1,this.length),this[e]},t.prototype.readUInt16LE=function(e,t){return e>>>=0,t||M(e,2,this.length),this[e]|this[e+1]<<8},t.prototype.readUInt16BE=function(e,t){return e>>>=0,t||M(e,2,this.length),this[e]<<8|this[e+1]},t.prototype.readUInt32LE=function(e,t){return e>>>=0,t||M(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},t.prototype.readUInt32BE=function(e,t){return e>>>=0,t||M(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},t.prototype.readIntLE=function(e,t,a){e>>>=0,t>>>=0,a||M(e,t,this.length);for(var o=this[e],r=1,l=0;++l<t&&(r*=256);)o+=this[e+l]*r;return r*=128,o>=r&&(o-=n(2,8*t)),o},t.prototype.readIntBE=function(e,t,a){e>>>=0,t>>>=0,a||M(e,t,this.length);for(var o=t,r=1,l=this[e+--o];0<o&&(r*=256);)l+=this[e+--o]*r;return r*=128,l>=r&&(l-=n(2,8*t)),l},t.prototype.readInt8=function(e,t){return e>>>=0,t||M(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},t.prototype.readInt16LE=function(e,t){e>>>=0,t||M(e,2,this.length);var a=this[e]|this[e+1]<<8;return 32768&a?4294901760|a:a},t.prototype.readInt16BE=function(e,t){e>>>=0,t||M(e,2,this.length);var a=this[e+1]|this[e]<<8;return 32768&a?4294901760|a:a},t.prototype.readInt32LE=function(e,t){return e>>>=0,t||M(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},t.prototype.readInt32BE=function(e,t){return e>>>=0,t||M(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},t.prototype.readFloatLE=function(e,t){return e>>>=0,t||M(e,4,this.length),$.read(this,e,!0,23,4)},t.prototype.readFloatBE=function(e,t){return e>>>=0,t||M(e,4,this.length),$.read(this,e,!1,23,4)},t.prototype.readDoubleLE=function(e,t){return e>>>=0,t||M(e,8,this.length),$.read(this,e,!0,52,8)},t.prototype.readDoubleBE=function(e,t){return e>>>=0,t||M(e,8,this.length),$.read(this,e,!1,52,8)},t.prototype.writeUIntLE=function(e,t,a,o){if(e=+e,t>>>=0,a>>>=0,!o){var r=n(2,8*a)-1;j(this,e,t,a,r,0)}var l=1,s=0;for(this[t]=255&e;++s<a&&(l*=256);)this[t+s]=255&e/l;return t+a},t.prototype.writeUIntBE=function(e,t,a,o){if(e=+e,t>>>=0,a>>>=0,!o){var r=n(2,8*a)-1;j(this,e,t,a,r,0)}var l=a-1,s=1;for(this[t+l]=255&e;0<=--l&&(s*=256);)this[t+l]=255&e/s;return t+a},t.prototype.writeUInt8=function(e,t,a){return e=+e,t>>>=0,a||j(this,e,t,1,255,0),this[t]=255&e,t+1},t.prototype.writeUInt16LE=function(e,t,a){return e=+e,t>>>=0,a||j(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},t.prototype.writeUInt16BE=function(e,t,a){return e=+e,t>>>=0,a||j(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},t.prototype.writeUInt32LE=function(e,t,a){return e=+e,t>>>=0,a||j(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},t.prototype.writeUInt32BE=function(e,t,a){return e=+e,t>>>=0,a||j(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},t.prototype.writeIntLE=function(e,t,a,o){if(e=+e,t>>>=0,!o){var r=n(2,8*a-1);j(this,e,t,a,r-1,-r)}var l=0,s=1,d=0;for(this[t]=255&e;++l<a&&(s*=256);)0>e&&0===d&&0!==this[t+l-1]&&(d=1),this[t+l]=255&(e/s>>0)-d;return t+a},t.prototype.writeIntBE=function(e,t,a,o){if(e=+e,t>>>=0,!o){var r=n(2,8*a-1);j(this,e,t,a,r-1,-r)}var l=a-1,s=1,d=0;for(this[t+l]=255&e;0<=--l&&(s*=256);)0>e&&0===d&&0!==this[t+l+1]&&(d=1),this[t+l]=255&(e/s>>0)-d;return t+a},t.prototype.writeInt8=function(e,t,a){return e=+e,t>>>=0,a||j(this,e,t,1,127,-128),0>e&&(e=255+e+1),this[t]=255&e,t+1},t.prototype.writeInt16LE=function(e,t,a){return e=+e,t>>>=0,a||j(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},t.prototype.writeInt16BE=function(e,t,a){return e=+e,t>>>=0,a||j(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},t.prototype.writeInt32LE=function(e,t,a){return e=+e,t>>>=0,a||j(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},t.prototype.writeInt32BE=function(e,t,a){return e=+e,t>>>=0,a||j(this,e,t,4,2147483647,-2147483648),0>e&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},t.prototype.writeFloatLE=function(e,t,a){return F(this,e,t,!0,a)},t.prototype.writeFloatBE=function(e,t,a){return F(this,e,t,!1,a)},t.prototype.writeDoubleLE=function(e,t,a){return N(this,e,t,!0,a)},t.prototype.writeDoubleBE=function(e,t,a){return N(this,e,t,!1,a)},t.prototype.copy=function(e,a,o,r){if(!t.isBuffer(e))throw new TypeError("argument should be a Buffer");if(o||(o=0),r||0===r||(r=this.length),a>=e.length&&(a=e.length),a||(a=0),0<r&&r<o&&(r=o),r===o)return 0;if(0===e.length||0===this.length)return 0;if(0>a)throw new RangeError("targetStart out of bounds");if(0>o||o>=this.length)throw new RangeError("Index out of range");if(0>r)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-a<r-o&&(r=e.length-a+o);var n=r-o;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(a,o,r);else if(this===e&&o<a&&a<r)for(var l=n-1;0<=l;--l)e[l+a]=this[l+o];else Uint8Array.prototype.set.call(e,this.subarray(o,r),a);return n},t.prototype.fill=function(e,a,o,r){if("string"==typeof e){if("string"==typeof a?(r=a,a=0,o=this.length):"string"==typeof o&&(r=o,o=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!t.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){var n=e.charCodeAt(0);("utf8"===r&&128>n||"latin1"===r)&&(e=n)}}else"number"==typeof e&&(e&=255);if(0>a||this.length<a||this.length<o)throw new RangeError("Out of range index");if(o<=a)return this;a>>>=0,o=o===void 0?this.length:o>>>0,e||(e=0);var l;if("number"==typeof e)for(l=a;l<o;++l)this[l]=e;else{var s=t.isBuffer(e)?e:t.from(e,r),d=s.length;if(0===d)throw new TypeError("The value \""+e+"\" is invalid for argument \"value\"");for(l=0;l<o-a;++l)this[l+a]=s[l%d]}return this};var J=/[^+/0-9A-Za-z-_]/g}).call(this,e("buffer").Buffer)},{"base64-js":1418,buffer:1420,ieee754:1422}],1421:[function(e,t){function a(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=_(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}function r(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function n(e,t,a){if(t)e.call(a);else for(var o=e.length,r=f(e,o),n=0;n<o;++n)r[n].call(a)}function l(e,t,a,o){if(t)e.call(a,o);else for(var r=e.length,n=f(e,r),l=0;l<r;++l)n[l].call(a,o)}function s(e,t,a,o,r){if(t)e.call(a,o,r);else for(var n=e.length,l=f(e,n),s=0;s<n;++s)l[s].call(a,o,r)}function d(e,t,a,o,r,n){if(t)e.call(a,o,r,n);else for(var l=e.length,s=f(e,l),d=0;d<l;++d)s[d].call(a,o,r,n)}function c(e,t,a,o){if(t)e.apply(a,o);else for(var r=e.length,n=f(e,r),l=0;l<r;++l)n[l].apply(a,o)}function p(e,t,a,o){var i,n,l;if("function"!=typeof a)throw new TypeError("\"listener\" argument must be a function");if(n=e._events,n?(n.newListener&&(e.emit("newListener",t,a.listener?a.listener:a),n=e._events),l=n[t]):(n=e._events=_(null),e._eventsCount=0),!l)l=n[t]=a,++e._eventsCount;else if("function"==typeof l?l=n[t]=o?[a,l]:[l,a]:o?l.unshift(a):l.push(a),!l.warned&&(i=r(e),i&&0<i&&l.length>i)){l.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+l.length+" \""+(t+"\" listeners added. Use emitter.setMaxListeners() to increase limit."));s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=l.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",s.name,s.message)}return e}function u(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var e=Array(arguments.length),t=0;t<e.length;++t)e[t]=arguments[t];this.listener.apply(this.target,e);}}function g(e,t,a){var o={fired:!1,wrapFn:void 0,target:e,type:t,listener:a},r=v.call(u,o);return r.listener=a,o.wrapFn=r,r}function m(e,t,a){var o=e._events;if(!o)return[];var r=o[t];return r?"function"==typeof r?a?[r.listener||r]:[r]:a?x(r):f(r,r.length):[]}function h(e){var t=this._events;if(t){var a=t[e];if("function"==typeof a)return 1;if(a)return a.length}return 0}function y(e,t){for(var a=t,o=a+1,r=e.length;o<r;a+=1,o+=1)e[a]=e[o];e.pop()}function f(e,t){for(var a=Array(t),o=0;o<t;++o)a[o]=e[o];return a}function x(e){for(var t=Array(e.length),a=0;a<t.length;++a)t[a]=e[a].listener||e[a];return t}var _=Object.create||function(e){var t=function(){};return t.prototype=e,new t},b=Object.keys||function(e){var t=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.push(a);return a},v=Function.prototype.bind||function(e){var t=this;return function(){return t.apply(e,arguments)}};t.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._maxListeners=void 0;var w=10,k;try{var T={};Object.defineProperty&&Object.defineProperty(T,"x",{value:0}),k=0===T.x}catch(e){k=!1}k?Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return w},set:function(e){if("number"!=typeof e||0>e||e!==e)throw new TypeError("\"defaultMaxListeners\" must be a positive number");w=e}}):a.defaultMaxListeners=w,a.prototype.setMaxListeners=function(e){if("number"!=typeof e||0>e||isNaN(e))throw new TypeError("\"n\" argument must be a positive number");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return r(this)},a.prototype.emit=function(e){var t="error"===e,a,o,r,p,u,g;if(g=this._events,g)t=t&&null==g.error;else if(!t)return!1;if(t){if(1<arguments.length&&(a=arguments[1]),a instanceof Error)throw a;else{var m=new Error("Unhandled \"error\" event. ("+a+")");throw m.context=a,m}return!1}if(o=g[e],!o)return!1;var h="function"==typeof o;switch(r=arguments.length,r){case 1:n(o,h,this);break;case 2:l(o,h,this,arguments[1]);break;case 3:s(o,h,this,arguments[1],arguments[2]);break;case 4:d(o,h,this,arguments[1],arguments[2],arguments[3]);break;default:for(p=Array(r-1),u=1;u<r;u++)p[u-1]=arguments[u];c(o,h,this,p);}return!0},a.prototype.addListener=function(e,t){return p(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return p(this,e,t,!0)},a.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError("\"listener\" argument must be a function");return this.on(e,g(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError("\"listener\" argument must be a function");return this.prependListener(e,g(this,e,t)),this},a.prototype.removeListener=function(e,t){var a,o,r,n,l;if("function"!=typeof t)throw new TypeError("\"listener\" argument must be a function");if(o=this._events,!o)return this;if(a=o[e],!a)return this;if(a===t||a.listener===t)0==--this._eventsCount?this._events=_(null):(delete o[e],o.removeListener&&this.emit("removeListener",e,a.listener||t));else if("function"!=typeof a){for(r=-1,n=a.length-1;0<=n;n--)if(a[n]===t||a[n].listener===t){l=a[n].listener,r=n;break}if(0>r)return this;0===r?a.shift():y(a,r),1===a.length&&(o[e]=a[0]),o.removeListener&&this.emit("removeListener",e,l||t)}return this},a.prototype.removeAllListeners=function(e){var t,a,o;if(a=this._events,!a)return this;if(!a.removeListener)return 0===arguments.length?(this._events=_(null),this._eventsCount=0):a[e]&&(0==--this._eventsCount?this._events=_(null):delete a[e]),this;if(0===arguments.length){var r=b(a),n;for(o=0;o<r.length;++o)n=r[o],"removeListener"===n||this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=_(null),this._eventsCount=0,this}if(t=a[e],"function"==typeof t)this.removeListener(e,t);else if(t)for(o=t.length-1;0<=o;o--)this.removeListener(e,t[o]);return this},a.prototype.listeners=function(e){return m(this,e,!0)},a.prototype.rawListeners=function(e){return m(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},a.prototype.listenerCount=h,a.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]}},{}],1422:[function(e,t,a){var o=Math.LN2,r=Math.log,n=Math.pow,l=Math.abs,s=Math.floor;a.read=function(t,a,o,r,l){var c=8*l-r-1,p=(1<<c)-1,u=p>>1,g=-7,h=o?l-1:0,y=o?-1:1,d=t[a+h],f,x;for(h+=y,f=d&(1<<-g)-1,d>>=-g,g+=c;0<g;f=256*f+t[a+h],h+=y,g-=8);for(x=f&(1<<-g)-1,f>>=-g,g+=r;0<g;x=256*x+t[a+h],h+=y,g-=8);if(0===f)f=1-u;else{if(f===p)return x?NaN:(d?-1:1)*(1/0);x+=n(2,r),f-=u}return(d?-1:1)*x*n(2,f-r)},a.write=function(t,a,p,u,g,h){var y=8*h-g-1,f=(1<<y)-1,x=f>>1,_=23===g?n(2,-24)-n(2,-77):0,b=u?0:h-1,v=u?1:-1,d=0>a||0===a&&0>1/a?1:0,w,k,T;for(a=l(a),isNaN(a)||a===1/0?(k=isNaN(a)?1:0,w=f):(w=s(r(a)/o),1>a*(T=n(2,-w))&&(w--,T*=2),a+=1<=w+x?_/T:_*n(2,1-x),2<=a*T&&(w++,T/=2),w+x>=f?(k=0,w=f):1<=w+x?(k=(a*T-1)*n(2,g),w+=x):(k=a*n(2,x-1)*n(2,g),w=0));8<=g;t[p+b]=255&k,b+=v,k/=256,g-=8);for(w=w<<g|k,y+=g;0<y;t[p+b]=255&w,b+=v,w/=256,y-=8);t[p+b-v]|=128*d}},{}],1423:[function(e,t,a){arguments[4][438][0].apply(a,arguments)},{dup:438}],1424:[function(e,t,a){var o=Number.MAX_VALUE;a.endianness=function(){return"LE"},a.hostname=function(){return"undefined"==typeof location?"":location.hostname},a.loadavg=function(){return[]},a.uptime=function(){return 0},a.freemem=function(){return o},a.totalmem=function(){return o},a.cpus=function(){return[]},a.type=function(){return"Browser"},a.release=function(){return"undefined"==typeof navigator?"":navigator.appVersion},a.networkInterfaces=a.getNetworkInterfaces=function(){return{}},a.arch=function(){return"javascript"},a.platform=function(){return"browser"},a.tmpdir=a.tmpDir=function(){return"/tmp"},a.EOL="\n",a.homedir=function(){return"/"}},{}],1425:[function(e,t){function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function r(t){if(p===setTimeout)return setTimeout(t,0);if((p===a||!p)&&setTimeout)return p=setTimeout,setTimeout(t,0);try{return p(t,0)}catch(a){try{return p.call(null,t,0)}catch(a){return p.call(this,t,0)}}}function i(t){if(u===clearTimeout)return clearTimeout(t);if((u===o||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(t);try{return u(t)}catch(a){try{return u.call(null,t)}catch(a){return u.call(this,t)}}}function n(){m&&y&&(m=!1,y.length?g=y.concat(g):h=-1,g.length&&l())}function l(){if(!m){var e=r(n);m=!0;for(var t=g.length;t;){for(y=g,g=[];++h<t;)y&&y[h].run();h=-1,t=g.length}y=null,m=!1,i(e)}}function s(e,t){this.fun=e,this.array=t}function d(){}var c=t.exports={},p,u;(function(){try{p="function"==typeof setTimeout?setTimeout:a}catch(t){p=a}try{u="function"==typeof clearTimeout?clearTimeout:o}catch(t){u=o}})();var g=[],m=!1,h=-1,y;c.nextTick=function(e){var t=Array(arguments.length-1);if(1<arguments.length)for(var a=1;a<arguments.length;a++)t[a-1]=arguments[a];g.push(new s(e,t)),1!==g.length||m||r(l)},s.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=d,c.addListener=d,c.once=d,c.off=d,c.removeListener=d,c.removeAllListeners=d,c.emit=d,c.prependListener=d,c.prependOnceListener=d,c.listeners=function(){return[]},c.binding=function(){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}},{}],1426:[function(e,t,a){(function(t,o){function r(e,t){this._id=e,this._clearFn=t}var i=e("process/browser.js").nextTick,n=Function.prototype.apply,l=Array.prototype.slice,s={},d=0;a.setTimeout=function(){return new r(n.call(setTimeout,window,arguments),clearTimeout)},a.setInterval=function(){return new r(n.call(setInterval,window,arguments),clearInterval)},a.clearTimeout=a.clearInterval=function(e){e.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(window,this._id)},a.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},a.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},a._unrefActive=a.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},a.setImmediate="function"==typeof t?t:function(e){var t=d++,o=!(2>arguments.length)&&l.call(arguments,1);return s[t]=!0,i(function(){s[t]&&(o?e.apply(null,o):e.call(null),a.clearImmediate(t))}),t},a.clearImmediate="function"==typeof o?o:function(e){delete s[e]}}).call(this,e("timers").setImmediate,e("timers").clearImmediate)},{"process/browser.js":1425,timers:1426}]},{},[1413]);